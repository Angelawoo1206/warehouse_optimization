sap.ui.define(["jquery.sap.global","sap/ui/base/Object","sap/m/MessagePopover","sap/m/MessagePopoverItem","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,M,a,F,b,t){"use strict";F=t.observableConstructor(F,true);var p=new F({path:"persistent",operator:b.EQ,value1:false});var v=new F({path:"validation",operator:b.EQ,value1:true});function g(c,C){var m=C.byId("showMessages");var o=c.getDialogFragment("sap.suite.ui.generic.template.fragments.MessagePopover");o.setModel(sap.ui.getCore().getMessageManager().getMessageModel(),"msg");var i;var e;(function(){var y=C.getOwnerComponent();e=new F({path:"target",operator:b.EQ,value1:"/"+y.getEntitySet()});i=o.getBinding("items");var T=y.getModel("_templPriv");T.setProperty("/generic/messageCount",0);var z=c.getText("MESSAGE_BUTTON_TOOLTIP_P",0);T.setProperty("/generic/messageButtonTooltip",z);i.attachChange(function(){var D=i.getLength();T.setProperty("/generic/messageCount",D);z=c.getText(D===1?"MESSAGE_BUTTON_TOOLTIP_S":"MESSAGE_BUTTON_TOOLTIP_P",D);T.setProperty("/generic/messageButtonTooltip",z);});})();var f=[];var s;var d=0;var n;var h;function j(E){if(q.isArray(E)){if(E.length===0){return false;}h=h.concat(E);}else{h.push(E);}return true;}function A(){var y=new F(h,false);var z=[y,p];i.filter(z);}function r(y,E){if(y===d&&j(E)){A();}}function k(P){var E=P();if(E instanceof Promise){E.then(n);return false;}return j(E);}function l(){f.forEach(k);}function u(y){s=y;d++;n=r.bind(null,d);h=[new F({path:"target",operator:b.StartsWith,value1:s}),e,v];l();A();}function w(P){f.push(P);if(s!==undefined&&k(P)){A();}}var S;function x(){S=S||o.openBy.bind(o,m);setTimeout(S,0);}return{adaptToContext:u,toggleMessagePopover:o.toggle.bind(o,m),showMessagePopover:x,registerMessageFilterProvider:w};}return B.extend("sap.suite.ui.generic.template.lib.MessageButtonHelper",{constructor:function(c,C){q.extend(this,(t.testableStatic(g,"MessageButtonHelper"))(c,C));}});});
