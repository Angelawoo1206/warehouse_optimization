sap.ui.define(["sap/ui/base/Object"],function(B){"use strict";function g(f,n){var r={};var l;var t=n.oTemplateContract,R=n.oRouter;function s(E){var V=E.getParameter("config").viewLevel;if(V>2){t.oTemplatePrivateGlobalModel.setProperty("/generic/FCL/flexibleColumnCount",0);t.oTemplatePrivateGlobalModel.setProperty("/generic/FCL/isFullscreen",false);return 0;}t.oNavContainer.to(f);var F=V+1;t.oTemplatePrivateGlobalModel.setProperty("/generic/FCL/flexibleColumnCount",F);switch(V){case 0:f.setMidColumn(null);break;case 1:f.setEndColumn(null);break;case 2:r.endColumn=E.getParameter("config");}var Q=E.getParameter("arguments")["?query"];var i=!!Q&&Q.FCLfullscreen==="true";t.oTemplatePrivateGlobalModel.setProperty("/generic/FCL/isFullscreen",i);var y=null;if(i){switch(V){case 0:y=f.getBeginColumn().getId();break;case 1:y=f.getMidColumn().getId();break;case 2:y=f.getEndColumn().getId();}}f.setFullScreenColumn(y);return F;}function a(i,P,y){var z=t.mRouteToTemplateComponentPromise[y];if(z){return z.then(function(C){return n.activateOneComponent(P,i,C);});}return Promise.resolve();}function b(i){var y=i.substring(i.length-5,i.length);if(y==="query"){i=i.substring(0,i.length-5);}return i;}function A(i){Promise.all(i).then(n.afterActivation);}function d(E,i,F){var y,z,P;E=jQuery.extend(true,{},E);y=E.getParameter("config");z=E.getParameter("name");var C=[];if(F>0){C.push(a(i,null,"root"));}if(F===1){A(C);}else{sap.ui.require(["sap/suite/ui/generic/template/lib/routingHelper"],function(D){P=D.determinePath(y,E);z=b(z);C.push(a(i,P,z));if(F===3){P=D.determinePath(y,E,t.routeViewLevel1.pattern);C.push(a(i,P,t.routeViewLevel1.name));}A(C);});}}function h(E,i){var F=s(E);d(E,i,F);l={name:E.getParameter("name"),arguments:E.getParameter("arguments")};}function c(i,y){return new Promise(function(z){var C=t.mRouteToTemplateComponentPromise[i];C.then(function(D){var E=t.componentRegistry[D.getId()];if(E.methods.getUrlParameterInfo){E.methods.getUrlParameterInfo().then(function(F){jQuery.extend(y,F);z();});}else{z();}});});}function e(y){return c("root",y).then(function(){var D="";var z="";for(var P in y){var V=y[P];for(var i=0;i<V.length;i++){var C=V[i];z=z+D+P+"="+C;D="&";}}return z;});}function j(L){if(L>2||L===0){return Promise.resolve("");}var i={FCLfullscreen:[t.oTemplatePrivateGlobalModel.getProperty("/generic/FCL/isFullscreen")]};var y=(L===2)?c(t.routeViewLevel1.name,i):Promise.resolve();return new Promise(function(z){y.then(function(){e(i).then(z);});});}function k(T){var i=T&&t.mEntityTree[T.entitySet];var y=i?i.level:1;return y;}function m(T){return j(k(T));}function o(){e({}).then(function(P){var H=P?"?"+P:"";n.navigate(H,true);});}function p(){var L=t.mRouteToTemplateComponentPromise[t.routeViewLevel1.name];L.then(function(C){var i=C.getComponentContainer();var y=i.getBindingContext();t.oTemplatePrivateGlobalModel.setProperty("/generic/FCL/isFullscreen",false);n.navigateToContext(y,null,true);});}function q(i){if(l.name.lastIndexOf("query")===l.name.length-"query".length){l.arguments.query=l.arguments["?query"];l.arguments.query.FCLfullscreen=i;}else{l.name=l.name+"query";l.arguments.query={FCLfullscreen:i};}var H=R.getURL(l.name,l.arguments);H=H.replace("/?","?");n.navigate(H,false);}function u(){q(true);}function v(){q(false);}function w(V){if(V>2){return null;}return{onCloseColumnPressed:V===1?o:p,onFullscreenColumnPressed:u,onExitFullscreenColumnPressed:v};}function x(C){return new Promise(function(i,y){var M=C.getModel();M.read(C.getPath()+"/SiblingEntity",{success:function(z){var D=M.getContext("/"+M.getKey(z));i(D);},error:function(E){y(E);}});});}function N(D){if(t.oTemplatePrivateGlobalModel.getProperty("/generic/FCL/flexibleColumnCount")===3){var C=t.mRouteToTemplateComponentPromise[b(r.endColumn.name)];C.then(function(i){var y=i.getBindingContext();var z=x(y,true);z.then(function(E){sap.ui.require(["sap/suite/ui/generic/template/lib/routingHelper"],function(F){var G=r.endColumn.navigationProperty;var H=D.getPath()+"/"+F.determineNavigationPath(E,G).path;n.navigateToContext(H,null,true,2);});});});}else{n.navigateToContext(D,null,true,2);}}t.oTemplatePrivateGlobalModel.setProperty("/generic/FCL",{flexibleColumnCount:1,isFullscreen:false});return{handleRouteMatchedFlexibleColumnLayout:h,getAppStateParStringForNavigation:m,getActionButtonHandlers:w,navigateToDraft:N,getTargetLevel:k};}return B.extend("sap.suite.ui.generic.template.lib.FlexibleColumnLayoutHandler",{constructor:function(f,n){jQuery.extend(this,g(f,n));}});});
