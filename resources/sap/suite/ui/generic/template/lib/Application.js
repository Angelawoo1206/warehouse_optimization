sap.ui.define(["jquery.sap.global","sap/ui/base/Object","sap/ui/Device","sap/ui/model/json/JSONModel","sap/ui/core/routing/History","sap/ui/core/routing/HistoryDirection","sap/m/MessageToast","sap/m/ActionSheet","sap/m/Dialog","sap/m/Popover","sap/suite/ui/generic/template/lib/routingHelper","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,D,J,H,a,M,A,b,P,r,t){"use strict";var c=(t.testableStatic(function(T,o){var C="sapUiSizeCozy",s="sapUiSizeCompact";if(o.hasClass(C)||o.hasClass(s)){return"";}else{return T?C:s;}},"Application_determineContentDensityClass")(D.support.touch,q(document.body)));function f(C,p){q.sap.syncStyleClass(c,p,C);p.addDependent(C);}var f=t.testableStatic(f,"Application_attachControlToParent");function g(T){var C={api:{promise:Promise.resolve()}};var d={};function e(){C.fnResolve();}var R={};function i(E){var N=E.getParameters();if(N.name!==R.name){R=N;return true;}var z=q.extend({},R.arguments,N.arguments);for(var K in z){if(K.indexOf("?")!==0&&z[K]!==R.arguments[K]){R=N;return true;}}return false;}function h(){return C.api||{};}function j(z){q.extend(d,z);}function k(){return C.currentView||(function(){var z=T.oNavContainer&&T.oNavContainer.getPages()[0];if(z&&z instanceof sap.ui.core.ComponentContainer){var E=T.componentRegistry[z.getComponent()];return E&&E.oController&&E.oController.getView();}})()||T.oNavContainer;}function m(z){var O;if(z instanceof b){O="open";}else if(z instanceof P||z instanceof A){O="openBy";}if(O){var E=z[O];z[O]=function(){if(!T.oBusyHelper.isBusy()){var K=arguments;T.oBusyHelper.getUnbusy().then(function(){E.apply(z,K);});}};}}var F={};function l(V,N,z,E,O){V=V||k();var K=V.getId();var L=F[K]||(F[K]={});var Q=L[N];if(!Q){Q=sap.ui.xmlfragment(K,N,z);f(Q,V);var S;if(E){S=new J();Q.setModel(S,E);}(O||q.noop)(Q,S);L[N]=Q;m(Q);}return Q;}function n(){return new Promise(function(z){T.oBusyHelper.getUnbusy().then(function(){C.api.promise.then(z);});});}function s(z){if(T.oShellService){T.oShellService.setBackNavigation(z);}}function o(z){if(T.oShellService){T.oShellService.setTitle(z);}}function p(V){if(!T.oFlexibleColumnLayoutHandler){return{};}return{oActionButtonHandlers:T.oFlexibleColumnLayoutHandler.getActionButtonHandlers(V),navigateToDraft:T.oFlexibleColumnLayoutHandler.navigateToDraft};}var I=false;function u(z){I=z;}function v(z,N){if(!T.oFlexibleColumnLayoutHandler){return true;}var E=T.oTemplatePrivateGlobalModel.getProperty("/generic/FCL/flexibleColumnCount");var K=r.determineNavigationPath(z,N);var L=T.oFlexibleColumnLayoutHandler.getTargetLevel(K);return L>=E;}function w(S){T.aStateChangers.push(S);}var x=H.getInstance();var y;var G;T.oApplicationProxy={onAfterNavigate:function(E){y=E.getParameter("toId");var z=E.getParameter("to");var K=z&&z.getComponent&&z.getComponent();var L=K&&T.componentRegistry[K];C.currentView=L&&L.oController.getView();e();},onBypassed:function(){R={};C.api.outdated=true;C.api={promise:Promise.reject()};C.fnResolve=q.noop;},onRouteMatched:function(E){if(!i(E)){return;}C.api.outdated=true;C.api={isBack:x.getDirection()===a.Backwards,dataFromLastPage:d,promise:new Promise(function(L){C.fnResolve=L;})};d={};var z=E.getParameter("config").target;var K=T.mRouteToTemplateComponentPromise[z];K.then(function(L){G=L.getComponentContainer().getId();if(!y||G===y){y=G;e();}});},getCurrentDisplayObject:h,getCurrentView:k,addDataForNextPage:j,setEditableNDC:u,getDialogFragment:l.bind(null,null),destroyView:function(V){delete F[V];}};return{setEditableNDC:u,getEditableNDC:function(){return I;},getCurrentDisplayObject:h,addDataForNextPage:j,getContentDensityClass:function(){return c;},attachControlToParent:f,getDialogFragmentForView:l,getBusyHelper:function(){return T.oBusyHelper;},isTemplateComponentActive:function(z){return z.getComponentContainer().getId()===G;},showMessageToast:function(){var z=arguments;var E=function(){M.show.apply(M,z);};n().then(E);},setBackNavigation:s,setTitle:o,getFclProxy:p,isNewHistoryEntryRequired:v,registerStateChanger:w};}return B.extend("sap.suite.ui.generic.template.lib.Application",{constructor:function(T){q.extend(this,g(T));}});});
