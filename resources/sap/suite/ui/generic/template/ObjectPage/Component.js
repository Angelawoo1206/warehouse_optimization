sap.ui.define(["sap/m/DraftIndicatorState","sap/suite/ui/generic/template/lib/TemplateAssembler","sap/suite/ui/generic/template/lib/TemplateComponent","sap/suite/ui/generic/template/ObjectPage/controller/ControllerImplementation"],function(D,T,a,C){"use strict";function g(c,o){var v={};function b(){if(!v.bindBreadCrumbs){return;}var r=c.getRouter();var p=r&&r.oHashChanger&&r.oHashChanger.getHash();if(!p){return;}p=p.split("?")[0];var s=p.split("/");if(s[0]===""||s[0]==="#"){s.splice(0,1);}s.pop();v.bindBreadCrumbs(s);}return{oControllerSpecification:{getMethods:C.getMethods.bind(null,v),oControllerDefinition:{onBeforeRebindTableExtension:function(e){}}},init:function(){var t=o.getTemplatePrivateModel();t.setProperty("/objectPage",{displayMode:0});},onActivate:function(B){var u=c.getModel("ui");var t=o.getTemplatePrivateModel();if(o.getEditableNDC()){u.setProperty("/editable",true);var d=o.getCreateMode();u.setProperty("/createMode",d);t.setProperty("/objectPage/displayMode",d?4:2);}else if(!v.isDraftEnabled()){u.setProperty("/editable",false);u.setProperty("/createMode",false);t.setProperty("/objectPage/displayMode",1);}v.onComponentActivate(B);},refreshBinding:function(u,r){if(u){var e=c.getComponentContainer().getElementBinding();if(e){e.refresh(true);}}else{v.refreshFacets(r);}},presetDisplayMode:function(d,i){if(i){return;}var t=o.getTemplatePrivateModel();t.setProperty("/objectPage/displayMode",d);},updateBindingContext:function(){var B=c.getBindingContext();if(B){var t=o.getTemplatePrivateModel();t.setProperty("/generic/draftIndicatorState",D.Clear);v.refreshFacets(null,true);var A=B.getObject();if(A){var u=c.getModel("ui");var d=c.getAppComponent().getTransactionController().getDraftController();var e=d.getDraftContext();var i=e.hasDraft(B)&&!A.IsActiveEntity;var h=A.HasActiveEntity;if(o.getCreateMode()){u.setProperty("/createMode",true);u.setProperty("/editable",true);u.setProperty("/enabled",true);t.setProperty("/objectPage/displayMode",4);}else if(i){u.setProperty("/editable",true);u.setProperty("/enabled",true);if(h){u.setProperty("/createMode",false);t.setProperty("/objectPage/displayMode",2);}else{u.setProperty("/createMode",true);t.setProperty("/objectPage/displayMode",4);}}else{u.setProperty("/createMode",false);var I=o.getEditableNDC();u.setProperty("/editable",I);t.setProperty("/objectPage/displayMode",I?2:1);if(A.hasOwnProperty("HasDraftEntity")&&A.HasDraftEntity&&e.hasSiblingEntity(c.getEntitySet())){u.setProperty("/enabled",false);var m=c.getModel();var r=new Promise(function(R,j){m.read(B.getPath(),{urlParameters:{"$expand":"SiblingEntity,DraftAdministrativeData"},success:R,error:j});});var f=o.getBusyHelper();f.setBusy(r);r.then(function(R){var s=m.getContext("/"+m.getKey(R.SiblingEntity));if(s){v.draftResume(s,A,R.DraftAdministrativeData);}u.setProperty("/enabled",true);},function(E){});}else{u.setProperty("/enabled",true);}}}b();}}};}return T.getTemplateComponent(g,"sap.suite.ui.generic.template.ObjectPage.Component",{metadata:{library:"sap.suite.ui.generic.template",properties:{"templateName":{"type":"string","defaultValue":"sap.suite.ui.generic.template.ObjectPage.view.Details"},"showRelatedApps":{"type":"boolean","defaultValue":"false"},"editableHeaderContent":{"type":"boolean","defaultValue":"false"},"gridTable":"boolean","sections":"object"},"manifest":"json"}});});
