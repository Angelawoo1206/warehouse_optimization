sap.ui.controller("sap.ushell.components.factsheet.views.ThingViewer",{setService:function(u){this.getView().setModel(new sap.ui.model.odata.ODataModel(u));}});
// Copyright (c) 2009-2014 SAP SE, All Rights Reserved
(function(){"use strict";sap.ui.jsview("sap.ushell.components.flp.launchpad.appfinder.AppFinder",{createContent:function(){this.oController=this.getController();this.parentComponent=sap.ui.core.Component.getOwnerComponentFor(this);this.setModel(this.parentComponent.getModel());this.enableEasyAccessSAPMenu=this.getModel().getProperty("/enableEasyAccessSAPMenu");this.enableEasyAccessUserMenu=this.getModel().getProperty("/enableEasyAccessUserMenu");if((!this.enableEasyAccessSAPMenu&&!this.enableEasyAccessUserMenu)||(sap.ui.Device.system.phone||sap.ui.Device.system.tablet&&(!sap.ui.Device.system.combi))){this.showEasyAccessMenu=false;}else{this.showEasyAccessMenu=true;}var r=sap.ushell.resources.i18n;this.oPage=new sap.m.Page("appFinderPage",{showHeader:false,showSubHeader:false,showFooter:false,showNavButton:false,enableScrolling:false,title:{parts:["/groupContext/title"],formatter:function(t){return!t?r.getText("appFinderTitle"):r.getText("appFinder_group_context_title",t);}}});return this.oPage;},_showSearch:function(m){var M="searchFiltering";if(m==="userMenu"){M="enableEasyAccessUserMenuSearch";}else if(m==="sapMenu"){M="enableEasyAccessSAPMenuSearch";}return this.getModel().getProperty("/"+M);},_showSearchTag:function(m){if(m==="userMenu"||m==="sapMenu"){return false;}else{return this.getModel().getProperty("/tagFiltering");}},onAfterHide:function(){var c=this.getController();var r=c.oSubHeaderModel.getProperty("/search/searchMode")||c.oSubHeaderModel.getProperty("/search/searchTerm");if(r){c._resetSubHeaderModel();this.oAppFinderSearchControl.setValue("");}},createSubHeader:function(){if(!this.oToolbar){this.oToolbar=new sap.m.Toolbar("appFinderSubHeader",{});this.oToolbar.addEventDelegate({onsapskipback:function(e){e.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(e);},onsapskipforward:function(e){var o=sap.ui.getCore().byId("openCloseButtonAppFinderSubheader");if(o.getVisible()&&!o.getPressed()){e.preventDefault();sap.ushell.components.flp.ComponentKeysHandler.setFocusOnCatalogTile();}},onAfterRendering:function(){jQuery("#catalog").attr("accesskey","a");}});this.oToolbar.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"role",value:"heading",writeToDom:true}));this.oToolbar.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-level",value:"2",writeToDom:true}));this.oToolbar.addStyleClass('sapUshellAppFinderHeader');this.oPage.setSubHeader(this.oToolbar);this.oPage.setShowSubHeader(true);}if(!this.openCloseSplitAppButton){this.openCloseSplitAppButton=new sap.m.ToggleButton("openCloseButtonAppFinderSubheader",{icon:"sap-icon://menu2",visible:"{/openCloseSplitAppButtonVisible}",pressed:"{/openCloseSplitAppButtonToggled}",press:function(e){this.getController().oSubHeaderModel.setProperty('/openCloseSplitAppButtonToggled',e.getSource().getPressed());}.bind(this)});this.openCloseSplitAppButton.addEventDelegate({onsaptabprevious:function(e){e.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(e);}});this.openCloseSplitAppButton.setModel(this.getController().oSubHeaderModel);this.oToolbar.addContent(this.openCloseSplitAppButton);}},updateSubHeader:function(m,e){this.oToolbar.removeAllContent();this.oToolbar.addContent(this.openCloseSplitAppButton);if(e){var s=this.createSegmentedButtons(m);this.oPage.addStyleClass('sapUshellAppFinderWithEasyAccess');this.oToolbar.addContent(s);}if(this._showSearch(m)){var a=this.createSearchControl(m);this.oToolbar.addContent(a);}this.getController()._updateCurrentMenuName(m);},createSegmentedButtons:function(m){if(this.segmentedButton){this.segmentedButton.setSelectedButton(m);return this.segmentedButton;}var c=this.getController();var r=sap.ushell.resources.i18n;var s=[];s.push(new sap.m.Button("catalog",{text:r.getText("appFinderCatalogTitle"),press:function(e){c.onSegmentButtonClick(e);}}));if(this.enableEasyAccessUserMenu){s.push(new sap.m.Button('userMenu',{text:r.getText("appFinderUserMenuTitle"),press:function(e){c.onSegmentButtonClick(e);}}));}if(this.enableEasyAccessSAPMenu){s.push(new sap.m.Button('sapMenu',{text:r.getText("appFinderSapMenuTitle"),press:function(e){c.onSegmentButtonClick(e);}}));}this.segmentedButton=new sap.m.SegmentedButton("appFinderSegmentedButtons",{buttons:s});this.segmentedButton.addEventDelegate({onsaptabprevious:function(e){var o=sap.ui.getCore().byId("openCloseButtonAppFinderSubheader");if(!o.getVisible()){e.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(e);}}});this.segmentedButton.setSelectedButton(m);var b=this.segmentedButton.getButtons();for(var i=0;i<b.length;i++){var a=b[i];a.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-controls",value:a.getId()+"View",writeToDom:true}));}return this.segmentedButton;},_handleSearch:function(){this.getController().searchHandler.apply(this.getController(),arguments);jQuery('#appFinderSearch input').select();},createSearchControl:function(m){if(!this.oAppFinderSearchContainer){this.oAppFinderSearchContainer=new sap.m.FlexBox("appFinderSearchContainer");}this.oAppFinderSearchContainer.removeAllItems();if(m=='catalog'&&this._showSearchTag('catalog')){this.createTagControl();this.oAppFinderSearchContainer.addItem(this.oAppFinderTagFilter);}if(!this.oAppFinderSearchControl){this.oAppFinderSearchControl=new sap.m.SearchField("appFinderSearch",{search:this._handleSearch.bind(this),value:{path:'subHeaderModel>/search/searchTerm',mode:sap.ui.model.BindingMode.OneWay}}).addStyleClass('help-id-catalogSearch');this.oAppFinderSearchControl.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-controls",value:"",writeToDom:true}));this.oAppFinderSearchControl.addEventDelegate({onsaptabnext:function(e){var o=sap.ui.getCore().byId("openCloseButtonAppFinderSubheader");if(o.getVisible()&&!o.getPressed()){e.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.components.flp.ComponentKeysHandler.setFocusOnCatalogTile();}}});}this.oAppFinderSearchContainer.addItem(this.oAppFinderSearchControl);this._updateSearchWithPlaceHolder(m);return this.oAppFinderSearchContainer;},_updateSearchWithPlaceHolder:function(m){var s="";if(m==='catalog'){s="EasyAccessMenu_SearchPlaceHolder_Catalog";}else if(m==='userMenu'){s="EasyAccessMenu_SearchPlaceHolder_UserMenu";}else if(m==='sapMenu'){s="EasyAccessMenu_SearchPlaceHolder_SAPMenu";}if(s&&this.oAppFinderSearchControl){this.oAppFinderSearchControl.setPlaceholder(sap.ushell.resources.i18n.getText(s));}},createTagControl:function(){if(this.oAppFinderTagFilter){return this.oAppFinderTagFilter;}this.oAppFinderTagFilter=new sap.m.MultiComboBox("appFinderTagFilter",{selectedKeys:{path:"subHeaderModel>/tag/selectedTags"},tooltip:"{i18n>catalogTilesTagfilter_tooltip}",placeholder:"{i18n>catalogTilesTagfilter_HintText}",items:{path:"/tagList",sorter:new sap.ui.model.Sorter("tag",false,false),template:new sap.ui.core.ListItem({text:"{tag}",key:"{tag}"})},selectionChange:[this.oController.onTagsFilter,this.oController]}).addStyleClass('help-id-catalogTagFilter');return this.oAppFinderTagFilter},getControllerName:function(){return"sap.ushell.components.flp.launchpad.appfinder.AppFinder";}});}());(function(){"use strict";sap.ui.controller("sap.ushell.components.flp.launchpad.appfinder.Catalog",{oPopover:null,onInit:function(){this.categoryFilter="";this.oMainModel=this.oView.getModel();this.oSubHeaderModel=this.oView.getModel("subHeaderModel");var t=this,s=this.oSubHeaderModel.bindProperty("/tag/selectedTags"),S=this.oSubHeaderModel.bindProperty("/search"),T=this.oSubHeaderModel.bindProperty("/tag/tagMode");sap.ui.getCore().byId("catalogSelect").addEventDelegate({onBeforeRendering:this.onBeforeSelectRendering},this);var r=this.getView().parentComponent.getRouter();r.getRoute("catalog").attachPatternMatched(function(e){t.onShow(e);});r.getRoute("appFinder").attachPatternMatched(function(e){t.onShow(e);});this.timeoutId=0;document.subHeaderModel=this.oSubHeaderModel;document.mainModel=this.oMainModel;S.attachChange(t.handleSearchModelChanged.bind(this));s.attachChange(t.handleSearchModelChanged.bind(this));T.attachChange(t.handleSearchModelChanged.bind(this));var o=this.oSubHeaderModel.bindProperty("/openCloseSplitAppButtonToggled");o.attachChange(t.handleToggleButtonModelChanged.bind(this));},onBeforeRendering:function(){sap.ui.getCore().getEventBus().publish("renderCatalog");},onAfterRendering:function(){var m=this.getView().getModel(),c=m.getProperty('/catalogs'),t=this;if(!c.length){}else if(c[0].title!=sap.ushell.resources.i18n.getText('catalogsLoading')){}if(!this.PagingManager){this.lastCatalogId=0;jQuery.sap.require("sap.ushell.components.flp.launchpad.PagingManager");this.PagingManager=new sap.ushell.components.flp.launchpad.PagingManager('catalogPaging',{supportedElements:{tile:{className:'sapUshellTile'}},containerHeight:window.innerHeight,containerWidth:window.innerWidth});this.getView().getCatalogContainer().setPagingManager(this.PagingManager);}if(this.PagingManager.currentPageIndex===0){t.allocateNextPage();}jQuery(window).resize(function(){var w=$(window).width(),a=$(window).height();t.PagingManager.setContainerSize(w,a);t.resetPageFilter();});},_decodeUrlFilteringParameters:function(u){var U=u?JSON.parse(u):u,h=(U&&U.tagFilter&&U.tagFilter)||"";if(h){try{this.tagFilter=JSON.parse(h);}catch(e){this.tagFilter=[];}}else{this.tagFilter=[];}this.categoryFilter=(U&&U.catalogSelector&&U.catalogSelector)||this.categoryFilter;if(this.categoryFilter){this.categoryFilter=window.decodeURIComponent(this.categoryFilter);}this.searchFilter=(U&&U.tileFilter&&U.tileFilter)||null;if(this.searchFilter){this.searchFilter=window.decodeURIComponent(this.searchFilter);}},_applyFilters:function(){if(this.categoryFilter){this.categoryFilter=sap.ushell.resources.i18n.getText('all')===this.categoryFilter?'':this.categoryFilter;this.getView().getModel().setProperty("/categoryFilter",this.categoryFilter);return;}if(this.searchFilter&&this.searchFilter.length){this.searchFilter=this.searchFilter.replace(/\*/g,'');this.oSubHeaderModel.setProperty('/search',{searchMode:true,searchTerm:this.searchFilter});}if(this.tagFilter&&this.tagFilter.length){this.oSubHeaderModel.setProperty('/tag',{tagMode:true,selectedTags:this.tagFilter});}},onShow:function(e){var v,u=e.getParameter('arguments').filters;v=sap.ui.getCore().byId("viewPortContainer");if(v){v.shiftCenterTransition(false);}$.extend(this.getView().getViewData(),e);this._decodeUrlFilteringParameters(u);this._applyFilters();},resetPageFilter:function(){this.lastCatalogId=0;this.allocateTiles=this.PagingManager.getNumberOfAllocatedElements();this.getView().getCatalogContainer().setCategoryAllocateTiles(this.allocateTiles);},allocateNextPage:function(){var c=this.getView().getCatalogContainer();if(!this.nAllocatedTiles||this.nAllocatedTiles===0){this.PagingManager.moveToNextPage();this.allocateTiles=this.PagingManager._calcElementsPerPage();c.setCategoryAllocateTiles(this.allocateTiles);}},onBeforeSelectRendering:function(){var s=sap.ui.getCore().byId("catalogSelect"),i=jQuery.grep(s.getItems(),jQuery.proxy(function(I){return I.getBindingContext().getObject().title===this.categoryFilter;},this));if(!i.length&&s.getItems()[0]){i.push(s.getItems()[0]);}},setTagsFilter:function(f){var p={catalogSelector:this.categoryFilter,tileFilter:this.searchFilter?encodeURIComponent(this.searchFilter):"",tagFilter:f,targetGroup:encodeURIComponent(this.getGroupContext())};this.getView().parentComponent.getRouter().navTo('appFinder',{'menu':'catalog',filters:JSON.stringify(p)},true);},setCategoryFilter:function(f){var p={catalogSelector:f,tileFilter:this.searchFilter?encodeURIComponent(this.searchFilter):"",tagFilter:JSON.stringify(this.tagFilter),targetGroup:encodeURIComponent(this.getGroupContext())};this.getView().parentComponent.getRouter().navTo('appFinder',{'menu':'catalog',filters:JSON.stringify(p)},true);},setSearchFilter:function(f){var p={catalogSelector:this.categoryFilter,tileFilter:f?encodeURIComponent(f):"",tagFilter:JSON.stringify(this.tagFilter),targetGroup:encodeURIComponent(this.getGroupContext())};this.getView().parentComponent.getRouter().navTo('appFinder',{'menu':'catalog','filters':JSON.stringify(p)});},getGroupContext:function(){var m=this.getView().getModel(),g=m.getProperty("/groupContext/path");return g?g:"";},_isTagFilteringChanged:function(s){var S=s.length===this.tagFilter.length,i=S;if(!i){return true;}s.some(function(t,I){i=jQuery.inArray(t,this.tagFilter)!==-1;return!i;}.bind(this));return i;},_setUrlWithTagsAndSearchTerm:function(s,S){var u={tileFilter:s&&s.length?encodeURIComponent(s):'',tagFilter:S.length?JSON.stringify(S):[],targetGroup:encodeURIComponent(this.getGroupContext())};this.getView().parentComponent.getRouter().navTo('appFinder',{'menu':'catalog','filters':JSON.stringify(u)});},handleSearchModelChanged:function(){var a=this.oSubHeaderModel.getProperty('/activeMenu'),s=this.oSubHeaderModel.getProperty('/search/searchMode'),t=this.oSubHeaderModel.getProperty('/tag/tagMode'),p,S=this.oSubHeaderModel.getProperty('/search/searchTerm'),b=this.oSubHeaderModel.getProperty('/tag/selectedTags'),o,v,f=[],c,i;if(this.oView.getId().indexOf(a)!==-1){if(s||t){this.oView.setCategoryFilterSelection();if(!this.oView.oCatalogEntrySearchContainer.getBinding("customTilesContainer")){this.oView.oCatalogEntrySearchContainer.bindAggregation("customTilesContainer",{path:"/catalogSearchEntity/customTiles",template:this.oView.oTileTemplate,templateShareable:true});}if(!this.oView.oCatalogEntrySearchContainer.getBinding("appBoxesContainer")){this.oView.oCatalogEntrySearchContainer.bindAggregation("appBoxesContainer",{path:"/catalogSearchEntity/appBoxes",template:this.oView.oAppBoxesTemplate,templateShareable:true});}if(b&&b.length>0){o=new sap.ui.model.Filter('tags','EQ','v');o.fnTest=function(T){var e,g;if(b.length===0){return true;}for(e=0;e<b.length;e++){g=b[e];if(T.indexOf(g)!==-1){return true;}}return false;}.bind(this);f.push(o);}S=S?S.replace(/\*/g,''):S;if(S){var d=S.split(/[\s,]+/);for(i=0;i<d.length;i++){v=d[i];f.push(new sap.ui.model.Filter([new sap.ui.model.Filter("keywords",sap.ui.model.FilterOperator.Contains,v),new sap.ui.model.Filter("title",sap.ui.model.FilterOperator.Contains,v)],false));}}this.oView.oCatalogEntrySearchContainer.getBinding("customTilesContainer").filter(f);this.oView.oCatalogEntrySearchContainer.getBinding("appBoxesContainer").filter(f);c=this.oView.oCatalogEntrySearchContainer.getNumberResults();this.bSearchResults=(c.nAppboxes+c.nCustom>0);this.oView.oCatalogEntrySearchContainer.setAfterHandleElements(function(I){var n=I.getNumberResults();this.bSearchResults=(n.nAppboxes+n.nCustom>0);this.oView.splitApp.toDetail(this.getView()._calculateDetailPageId());}.bind(this));this._showHideSelectedMasterItem(false);if(this._isTagFilteringChanged(b)){this._setUrlWithTagsAndSearchTerm(S,b);}}else{this._showHideSelectedMasterItem(true);this.setCategoryFilter(this.categoryFilter);}p=this.getView()._calculateDetailPageId();this.oView.splitApp.toDetail(p);}else{this._restoreSelectedMasterItem();}},_showHideSelectedMasterItem:function(i){var c=this.oView.splitApp.getMasterPage('catalogSelect'),C=c.getSelectedItem();if(C){C.toggleStyleClass("sapUshellHideSelectedListItem",!i);}},_restoreSelectedMasterItem:function(){var c=this.oView.splitApp.getMasterPage('catalogSelect'),o=sap.ui.getCore().byId(this.selectedCategoryId);if(o){this.categoryFilter=o.getTitle();}c.setSelectedItem(o);},handleToggleButtonModelChanged:function(){var b=this.oSubHeaderModel.getProperty("/openCloseSplitAppButtonVisible"),B=this.oSubHeaderModel.getProperty("/openCloseSplitAppButtonToggled");if(B!=this.bCurrentButtonToggled){if(!sap.ui.Device.system.phone){if(b){if(B&&!this.oView.splitApp.isMasterShown()){this.oView.splitApp.showMaster();}else if(this.oView.splitApp.isMasterShown()){this.oView.splitApp.hideMaster();}}}else{if(b){if(B&&!this.oView.splitApp.isMasterShown()){var c=sap.ui.getCore().byId('catalogSelect');this.oView.splitApp.backMaster(c);}else if(this.oView.splitApp.isMasterShown()){var d=sap.ui.getCore().byId(this.getView()._calculateDetailPageId());this.oView.splitApp.toDetail(d);}}}}this.bCurrentButtonToggled=B;},applyTileFilters:function(){var f=[],s;if(this.tagFilter){this.getView().getModel().setProperty("/tagFilter",this.tagFilter);}this.searchFilter=this.searchFilter?this.searchFilter.replace(/\*/g,''):this.searchFilter;if(this.searchFilter){s=new sap.ui.model.Filter($.map(this.searchFilter.split(/[\s,]+/),function(v){return(v&&new sap.ui.model.Filter("keywords",sap.ui.model.FilterOperator.Contains,v))||(v&&new sap.ui.model.Filter("title",sap.ui.model.FilterOperator.Contains,v))||undefined;}),true);f.push(s);}if(this.categoryFilter){this.getView().getModel().setProperty("/categoryFilter",this.categoryFilter===sap.ushell.resources.i18n.getText("all")?"":this.categoryFilter);}f.push(new sap.ui.model.Filter("isTileIntentSupported",sap.ui.model.FilterOperator.EQ,true));if(this.oRenderingFilter){f.push(this.oRenderingFilter);}},onLiveFilter:function(e){clearTimeout(this.timeoutId);var t=this,q=e.getParameter("newValue"),n=300;this.timeoutId=setTimeout(r,n,q);function r(q){if(q){t.setSearchFilter(q);}else{t.setSearchFilter();}}},onTagsFilter:function(e){var s=e.getParameters("selectedItem").changedItem;var s=e.getParameters("selectedItem").changedItem,a=e.getParameter("selected"),b=[],c=s.getText();if(this.tagFilter){b=this.tagFilter;}if(a){b.push(c);}else{b=b.filter(function(d){return d!==c;});}this.setTagsFilter(b.length>0?JSON.stringify(b):"");},_handleCatalogListItemPress:function(e){this.onCategoryFilter(e);this.oSubHeaderModel.setProperty('/search/searchMode',false);this.oSubHeaderModel.setProperty('/tag/tagMode',false);if(sap.ui.Device.system.phone||sap.ui.Device.system.tablet){this.oSubHeaderModel.setProperty('/openCloseSplitAppButtonToggled',false);}this.handleSearchModelChanged();},onCategoryFilter:function(e){var m=e.getSource(),s=m.getSelectedItem(),S=s.getBindingContext(),M=S.getModel();if(M.getProperty("static",S)){M.setProperty("/showCatalogHeaders",true);this.setCategoryFilter();this.selectedCategoryId=undefined;this.categoryFilter=undefined;}else{M.setProperty("/showCatalogHeaders",false);this.setCategoryFilter(window.encodeURIComponent(s.getBindingContext().getObject().title));this.categoryFilter=s.getTitle();this.selectedCategoryId=s.getId();}},onTileAfterRendering:function(e){var j=jQuery(e.oSource.getDomRef()),a=j.find(".sapMGT");a.attr("tabindex","-1");},catalogTilePress:function(c){sap.ui.getCore().getEventBus().publish("launchpad","catalogTileClick");},onAppBoxPressed:function(e){var a=e.getSource(),t=a.getBindingContext().getObject(),p;if(e.mParameters.srcControl.$().closest(".sapUshellPinButton").length){return;}p=sap.ushell.Container.getService("LaunchPage").getAppBoxPressHandler(t);if(p){p(t);}else{var u=a.getProperty("url");if(u&&u.indexOf("#")===0){hasher.setHash(u);}}},onTilePinButtonClick:function(e){var c=e.getSource(),s=c.getBindingContext(),m=this.getView().getModel(),g=m.getProperty("/groupContext/path");if(g){this._handleTileFooterClickInGroupContext(s,g);}else{var a=m.getProperty("/groups");var l=sap.ushell.Container.getService("LaunchPage");var b=this.getCatalogTileDataFromModel(s);var t=b.tileData.associatedGroups;var d=a.map(function(f){var r=l.getGroupId(f.object);var h=!($.inArray(r,t)==-1);return{selected:h,initiallySelected:h,oGroup:f};});var p=new sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.ushell.components.flp.launchpad.appfinder.GroupListPopover",viewData:{groupData:d,enableHideGroups:m.getProperty("/enableHideGroups"),enableHelp:m.getProperty("/enableHelp")}});p.open(c).then(this._handlePopoverResponse.bind(this,s,b));}},_handlePopoverResponse:function(s,c,r){if(!r.addToGroups.length&&!r.newGroups.length&&!r.removeFromGroups.length){return;}var m=this.getView().getModel();var g=m.getProperty("/groups");var p=[];r.addToGroups.forEach(function(a){var i=g.indexOf(a);var G=new sap.ui.model.Context(m,"/groups/"+i);var b=this._addTile(s,G);p.push(b);}.bind(this));r.removeFromGroups.forEach(function(a){var t=s.getModel().getProperty(s.getPath()).id;var i=g.indexOf(a);var b=this._removeTile(t,i);p.push(b);}.bind(this));r.newGroups.forEach(function(a){var n=(a.length>0)?a:sap.ushell.resources.i18n.getText("new_group_name");var b=this._createGroupAndSaveTile(s,n);p.push(b);}.bind(this));jQuery.when.apply(jQuery,p).then(function(){var a=Array.prototype.slice.call(arguments);this._handlePopoverGroupsActionPromises(c,r,a);}.bind(this));},_handlePopoverGroupsActionPromises:function(c,p,r){var e=r.filter(function(g,i,r){return!g.status;});if(e.length){var E=this.prepareErrorMessage(e,c.tileData.title);var d=sap.ushell.components.flp.launchpad.DashboardManager();d.resetGroupsOnFailure(E.messageId,E.parameters);return;}var t=[];var l=sap.ushell.Container.getService("LaunchPage");p.allGroups.forEach(function(g){if(g.selected){var h=l.getGroupId(g.oGroup.object);t.push(h);}});var m=this.getView().getModel();if(p.newGroups.length){var a=m.getProperty("/groups");var n=a.slice(a.length-p.newGroups.length);n.forEach(function(g){var h=l.getGroupId(g.object);t.push(h);});}m.setProperty(c.bindingContextPath+"/associatedGroups",t);var f=(!!p.addToGroups[0])?p.addToGroups[0].title:"";if(!f.length&&p.newGroups.length){f=p.newGroups[0];}var b=(!!p.removeFromGroups[0])?p.removeFromGroups[0].title:"";var D=this.prepareDetailedMessage(c.tileData.title,p.addToGroups.length+p.newGroups.length,p.removeFromGroups.length,f,b);sap.m.MessageToast.show(D,{duration:3000,width:"15em",my:"center bottom",at:"center bottom",of:window,offset:"0 -50",collision:"fit fit"});},_getCatalogTileIndexInModel:function(s){var t=s.sPath,a=t.split("/"),b=a[a.length-1];return b;},_handleTileFooterClickInGroupContext:function(s,g){var l=sap.ushell.Container.getService("LaunchPage"),m=this.getView().getModel(),c=this.getCatalogTileDataFromModel(s),a=c.tileData.associatedGroups,G=m.getProperty(g),b=l.getGroupId(G.object),C=$.inArray(b,a),t=this._getCatalogTileIndexInModel(s),o,A,r,T,d,e=this;if(c.isBeingProcessed){return;}m.setProperty('/catalogTiles/'+t+'/isBeingProcessed',true);if(C==-1){o=new sap.ui.model.Context(s.getModel(),g);A=this._addTile(s,o);A.done(function(f){if(f.status==1){e._groupContextOperationSucceeded(s,c,G,true);}else{e._groupContextOperationFailed(c,G,true);}});A.always(function(){m.setProperty('/catalogTiles/'+t+'/isBeingProcessed',false);});}else{T=s.getModel().getProperty(s.getPath()).id;d=g.split('/')[2];r=this._removeTile(T,d);r.done(function(f){if(f.status==1){e._groupContextOperationSucceeded(s,c,G,false);}else{e._groupContextOperationFailed(c,G,false);}});r.always(function(){m.setProperty('/catalogTiles/'+t+'/isBeingProcessed',false);});}},_groupContextOperationSucceeded:function(s,c,g,t){var l=sap.ushell.Container.getService("LaunchPage"),G=l.getGroupId(g.object),a=c.tileData.associatedGroups,d,i;if(t){a.push(G);s.getModel().setProperty(c.bindingContextPath+"/associatedGroups",a);d=this.prepareDetailedMessage(c.tileData.title,1,0,g.title,"");}else{for(i in a){if(a[i]==G){a.splice(i,1);break;}}s.getModel().setProperty(c.bindingContextPath+"/associatedGroups",a);d=this.prepareDetailedMessage(c.tileData.title,0,1,"",g.title);}sap.m.MessageToast.show(d,{duration:3000,width:"15em",my:"center bottom",at:"center bottom",of:window,offset:"0 -50",collision:"fit fit"});},_groupContextOperationFailed:function(c,g,t){var d=sap.ushell.components.flp.launchpad.getDashboardManager(),e;if(t){e=sap.ushell.resources.i18n.getText({messageId:"fail_tile_operation_add_to_group",parameters:[c.tileData.title,g.title]});}else{e=sap.ushell.resources.i18n.getText({messageId:"fail_tile_operation_remove_from_group",parameters:[c.tileData.title,g.title]});}d.resetGroupsOnFailure(e.messageId,e.parameters);},prepareErrorMessage:function(e,t){var g,a,f,F,n=0,N=0,c=false,m;for(var i in e){g=e[i].group;a=e[i].action;if(a=='add'){n++;if(n==1){f=g.title;}}else if(a=='remove'){N++;if(N==1){F=g.title;}}else if(a=='addTileToNewGroup'){n++;if(n==1){f=g.title;}}else{c=true;}}if(c){if(e.length==1){m=sap.ushell.resources.i18n.getText({messageId:"fail_tile_operation_create_new_group"});}else{m=sap.ushell.resources.i18n.getText({messageId:"fail_tile_operation_some_actions"});}}else if(e.length==1){if(n){m=sap.ushell.resources.i18n.getText({messageId:"fail_tile_operation_add_to_group",parameters:[t,f]});}else{m=sap.ushell.resources.i18n.getText({messageId:"fail_tile_operation_remove_from_group",parameters:[t,F]});}}else{if(N==0){m=sap.ushell.resources.i18n.getText({messageId:"fail_tile_operation_add_to_several_groups",parameters:[t]});}else if(n==0){m=sap.ushell.resources.i18n.getText({messageId:"fail_tile_operation_remove_from_several_groups",parameters:[t]});}else{m=sap.ushell.resources.i18n.getText({messageId:"fail_tile_operation_some_actions"});}}return m;},prepareDetailedMessage:function(t,n,a,f,b){var m;if(n==0){if(a==1){m=sap.ushell.resources.i18n.getText("tileRemovedFromSingleGroup",[t,b]);}else if(a>1){m=sap.ushell.resources.i18n.getText("tileRemovedFromSeveralGroups",[t,a]);}}else if(n==1){if(a==0){m=sap.ushell.resources.i18n.getText("tileAddedToSingleGroup",[t,f]);}else if(a==1){m=sap.ushell.resources.i18n.getText("tileAddedToSingleGroupAndRemovedFromSingleGroup",[t,f,b]);}else if(a>1){m=sap.ushell.resources.i18n.getText("tileAddedToSingleGroupAndRemovedFromSeveralGroups",[t,f,a]);}}else if(n>1){if(a==0){m=sap.ushell.resources.i18n.getText("tileAddedToSeveralGroups",[t,n]);}else if(a==1){m=sap.ushell.resources.i18n.getText("tileAddedToSeveralGroupsAndRemovedFromSingleGroup",[t,n,b]);}else if(a>1){m=sap.ushell.resources.i18n.getText("tileAddedToSeveralGroupsAndRemovedFromSeveralGroups",[t,n,a]);}}return m;},getCatalogTileDataFromModel:function(s){var b=s.getPath(),m=s.getModel(),t=m.getProperty(b);return{tileData:t,bindingContextPath:b,isBeingProcessed:t.isBeingProcessed?true:false};},_addTile:function(t,g){var d=sap.ushell.components.flp.launchpad.getDashboardManager(),a=jQuery.Deferred(),p=d.createTile({catalogTileContext:t,groupContext:g});p.done(function(b){a.resolve(b);});return a;},_removeTile:function(t,i){var d=sap.ushell.components.flp.launchpad.getDashboardManager(),a=jQuery.Deferred(),p=d.deleteCatalogTileFromGroup({tileId:t,groupIndex:i});p.done(function(b){a.resolve(b);});return a;},_createGroupAndSaveTile:function(t,n){var d=sap.ushell.components.flp.launchpad.getDashboardManager(),a=jQuery.Deferred(),p=d.createGroupAndSaveTile({catalogTileContext:t,newGroupName:n});p.done(function(b){a.resolve(b);});return a;}});}());(function(){"use strict";sap.ui.controller("sap.ushell.components.flp.launchpad.appfinder.EasyAccess",{DEFAULT_URL:"/sap/opu/odata/UI2",DEFAULT_NUMBER_OF_LEVELS:3,SEARCH_RESULTS_PER_REQUEST:100,onInit:function(){var t=this;this.translationBundle=sap.ushell.resources.i18n;this.oView=this.getView();var e=this.oView.getModel("easyAccessSystemsModel");var s=e.bindProperty("/systemSelected");s.attachChange(t.adjustUiOnSystemChange.bind(this));this.menuName=this.oView.getViewData().menuName;this.systemId=null;this.easyAccessCache={};this.easyAccessModel=new sap.ui.model.json.JSONModel();this.oView.hierarchyFolders.setModel(this.easyAccessModel,"easyAccess");this.oView.hierarchyApps.setModel(this.easyAccessModel,"easyAccess");var S=this.oView.getModel("subHeaderModel");var T=S.bindProperty("/openCloseSplitAppButtonToggled");T.attachChange(t.handleToggleButtonModelChanged.bind(this));if(this.oView.getViewData().enableSearch){var o=S.bindProperty("/search");o.attachChange(t.handleSearchModelChanged.bind(this));}this.checkIfSystemSelectedAndLoadData();},onAfterRendering:function(){setTimeout(function(){this.oView.hierarchyApps.getController()._updateAppBoxedWithPinStatuses();}.bind(this),0);},checkIfSystemSelectedAndLoadData:function(){var s=this.oView.getModel("easyAccessSystemsModel").getProperty("/systemSelected");if(s){this.systemId=s.systemId;this.loadMenuItemsFirstTime(this.oView.getViewData().menuName,s);}},navigateHierarchy:function(p,f){this.oView.hierarchyFolders.setBusy(false);var e=this.easyAccessModel.getProperty(p?p:"/");if(typeof e.folders!="undefined"){this.oView.hierarchyFolders.updatePageBindings(p,f);this.oView.hierarchyApps.getController().updatePageBindings(p);return;}this.oView.hierarchyFolders.setBusy(true);this.getMenuItems(this.menuName,this.systemId,e.id,e.level).then(function(p,r){this.easyAccessModel.setProperty(p+"/folders",r.folders);this.easyAccessModel.setProperty(p+"/apps",r.apps);this.oView.hierarchyFolders.updatePageBindings(p,f);this.oView.hierarchyApps.getController().updatePageBindings(p);this.oView.hierarchyFolders.setBusy(false);}.bind(this,p),function(a){this.handleGetMenuItemsError(a);}.bind(this));},handleSearch:function(s){var i=!this.hierarchyAppsSearchResults;if(i){this.hierarchyAppsSearchResults=new sap.ui.view(this.getView().getId()+"hierarchyAppsSearchResults",{type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.ushell.components.flp.launchpad.appfinder.HierarchyApps",height:"100%",viewData:{easyAccessSystemsModel:this.oView.getModel("easyAccessSystemsModel"),getMoreSearchResults:this.getMoreSearchResults.bind(this)}});this.easyAccessSearchResultsModel=new sap.ui.model.json.JSONModel();this.easyAccessSearchResultsModel.setSizeLimit(10000);this.hierarchyAppsSearchResults.setModel(this.easyAccessSearchResultsModel,"easyAccess");this.hierarchyAppsSearchResults.setBusyIndicatorDelay(this.getView().BUSY_INDICATOR_DELAY);this.hierarchyAppsSearchResults.addStyleClass(" sapUshellAppsView sapMShellGlobalInnerBackground");this.hierarchyAppsSearchResults.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"role",value:"region",writeToDom:true}));this.hierarchyAppsSearchResults.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-label",value:this.oView.oResourceBundle.getText("easyAccessTileContainer"),writeToDom:true}));}this.searchResultFrom=0;this.oView.splitApp.getCurrentDetailPage().setBusy(true);this.easyAccessSearchResultsModel.setProperty("/apps",[]);this.easyAccessSearchResultsModel.setProperty("/total",0);this._getSearchResults(s,this.searchResultFrom).then(function(r){this.easyAccessSearchResultsModel.setProperty("/apps",r.results);this.easyAccessSearchResultsModel.setProperty("/total",r.count);this.searchResultFrom=r.results.length+1;if(i){this.oView.splitApp.addDetailPage(this.hierarchyAppsSearchResults);}this.hierarchyAppsSearchResults.updateResultSetMessage(parseInt(r.count,10),true);this.oView.splitApp.getCurrentDetailPage().setBusy(false);if(this.oView.splitApp.getCurrentDetailPage()!==this.hierarchyAppsSearchResults){this.oView.splitApp.toDetail(this.getView().getId()+"hierarchyAppsSearchResults");}}.bind(this),function(e){this.handleGetMenuItemsError(e);this.oView.splitApp.getCurrentDetailPage().setBusy(false);}.bind(this));},getMoreSearchResults:function(){if(this.oView.splitApp.getCurrentDetailPage().setShowMoreResultsBusy){this.oView.splitApp.getCurrentDetailPage().setShowMoreResultsBusy(true)}var s=this.oView.getModel("subHeaderModel");var S=s.getProperty("/search/searchTerm");this._getSearchResults(S,this.searchResultFrom).then(function(r){var c=this.easyAccessSearchResultsModel.getProperty("/apps");var n=c.slice();Array.prototype.push.apply(n,r.results);this.easyAccessSearchResultsModel.setProperty("/apps",n);if(this.oView.splitApp.getCurrentDetailPage().setShowMoreResultsBusy){this.oView.splitApp.getCurrentDetailPage().setShowMoreResultsBusy(false)}this.searchResultFrom=n.length+1;}.bind(this),function(e){this.handleGetMenuItemsError(e);if(this.oView.splitApp.getCurrentDetailPage().setShowMoreResultsBusy){this.oView.splitApp.getCurrentDetailPage().setShowMoreResultsBusy(true)}}.bind(this));},_getSearchResults:function(s,f){var d=new jQuery.Deferred();var S=this._getODataRequestForSearchUrl(this.menuName,this.systemId,s,f);var r={requestUri:S};var c=this._callODataService(r,this.handleSuccessOnReadFilterResults);c.done(function(a){d.resolve(a);});c.fail(function(e){d.reject(e);});return d.promise();},getSystemNameOrId:function(){var s=this.oView.getModel("easyAccessSystemsModel").getProperty("/systemSelected");if(s){return s.name||s.id;}return;},adjustUiOnSystemChange:function(){var c=this.easyAccessModel.getData();if(this.systemId&&c&&c.id){this.easyAccessCache[this.systemId]=c;}var s=this.oView.getModel("easyAccessSystemsModel").getProperty("/systemSelected");if(s){this.systemId=s.systemId;var n=this.easyAccessCache[this.systemId];if(n){this.easyAccessModel.setData(n);this.navigateHierarchy("",false);}else{this.oView.hierarchyFolders.setBusy(true);this.oView.hierarchyApps.setBusy(true);this.loadMenuItemsFirstTime(this.menuName,s);}}},handleToggleButtonModelChanged:function(){var s=this.oView.getModel("subHeaderModel");var b=s.getProperty("/openCloseSplitAppButtonVisible");var B=s.getProperty("/openCloseSplitAppButtonToggled");var S=this.getView().splitApp;if(b){if(B&&!S.isMasterShown()){S.showMaster();}else if(S.isMasterShown()){S.hideMaster();}}},handleSearchModelChanged:function(){var s=this.oView.getModel("subHeaderModel");var a=s.getProperty("/activeMenu");if(this.getView().getId().indexOf(a)===-1){return;}var S=s.getProperty("/search/searchTerm");var b=s.getProperty("/search/searchMode");if(b){sap.ui.getCore().byId('appFinderSearch').getCustomData()[0].setValue(this.getView().getId()+"hierarchyAppsSearchResults");if(S){this.handleSearch(S);}}else{sap.ui.getCore().byId('appFinderSearch').getCustomData()[0].setValue('');this.oView.splitApp.toDetail(this.getView().getId()+"hierarchyApps");}},loadMenuItemsFirstTime:function(m,s){return this.getMenuItems(m,s.systemId,"",0).then(function(r){r.text=s.systemName||s.systemId;this.easyAccessModel.setData(r);this.oView.hierarchyFolders.setBusy(false);this.oView.hierarchyApps.setBusy(false);this.navigateHierarchy("",false);}.bind(this),function(e){this.handleGetMenuItemsError(e);this.oView.hierarchyFolders.updatePageBindings("/",false);this.oView.hierarchyApps.getController().updatePageBindings("/");}.bind(this));},handleGetMenuItemsError:function(e){jQuery.sap.require('sap.m.MessageBox');var E=this.getErrorMessage(e);sap.m.MessageBox.error(E);this.easyAccessModel.setData("");this.oView.hierarchyFolders.setBusy(false);this.oView.hierarchyApps.setBusy(false);},getErrorMessage:function(e){var m="";if(this.menuName=="SAP_MENU"){m=this.translationBundle.getText("easyAccessSapMenuNameParameter");}else if(this.menuName=="USER_MENU"){m=this.translationBundle.getText("easyAccessUserMenuNameParameter");}if(e){if(e.message){return this.translationBundle.getText("easyAccessErrorGetDataErrorMsg",[m,e.message]);}else{return this.translationBundle.getText("easyAccessErrorGetDataErrorMsg",[m,e]);}}else{return this.translationBundle.getText("easyAccessErrorGetDataErrorMsgNoReason",m);}},getMenuItems:function(m,s,e,a,n){var d=new jQuery.Deferred();if(m!="SAP_MENU"&&m!="USER_MENU"){d.reject("Invalid menuType parameter");return d.promise();}if(typeof s!=="string"||s===""){d.reject("Invalid systemId parameter");return d.promise();}if(typeof e!=="string"){d.reject("Invalid entityId parameter");return d.promise();}if(typeof a!=="number"){d.reject("Invalid entityLevel parameter");return d.promise();}if(n&&typeof n!=="number"){d.reject("Invalid numberOfNextLevels parameter");return d.promise();}if(e==""){a=0;}var N;var M=this.getView().getModel();var c=M.getProperty("/easyAccessNumbersOfLevels");if(c){N=c;}else if(n){N=n;}else{N=this.DEFAULT_NUMBER_OF_LEVELS;}var l=a+N+1;var S=this._getODataRequestUrl(m,s,e,l);var r={requestUri:S};var C=this._callODataService(r,this.handleSuccessOnReadMenuItems,{systemId:s,entityId:e,iLevelFilter:l});C.done(function(b){d.resolve(b);});C.fail(function(b){d.reject(b);});return d.promise();},_callODataService:function(r,s,S){jQuery.sap.require("sap.ui.thirdparty.datajs");var t=this;var d=new jQuery.Deferred();if(!S){S={};}OData.read(r,function(R,o){if(R&&R.results&&o&&o.statusCode===200){var a=s.bind(t,R,S)();d.resolve(a);}},function(m){d.reject(m);});return d.promise();},handleSuccessOnReadMenuItems:function(r,p){var R=this._oDataResultFormatter(r.results,p.systemId,p.entityId,p.iLevelFilter);return R;},handleSuccessOnReadFilterResults:function(r){return{results:r.results,count:r.__count}},_appendSystemToUrl:function(d,s){if(d.url){return d.url+(d.url.indexOf('?')>0?'&':'?')+'sap-system='+s;}},_oDataResultFormatter:function(r,s,e,l){var f={};var R={};if(e==""){R={id:"root",text:"root",level:0,folders:[],apps:[]};f.root=R;}else{R={id:e,folders:[],apps:[]};f[e]=R;}var o;for(var i=0;i<r.length;i++){o=r[i];var p;if(o.level=="01"){p=f["root"];}else{p=f[o.parentId];}var m={id:o.Id,text:o.text,subtitle:o.subtitle,icon:o.icon,level:parseInt(o.level,10)};if(o.type=='FL'){m.folders=[];m.apps=[];if(o.level==l-1){m.folders=undefined;m.apps=undefined;}if(p&&p.folders){p.folders.push(m);}f[o.Id]=m;}else{m.url=this._appendSystemToUrl(o,s);if(p&&p.apps){p.apps.push(m);}}}return R;},_getODataRequestUrl:function(m,s,e,l){var S=this._getServiceUrl(m);var L;if(l<10){L="0"+l;}else{L=l.toString();}var a="";if(e){if(decodeURIComponent(e)===e){e=encodeURIComponent(e);}a="('"+e+"')/AllChildren";}S=S+";o="+s+"/MenuItems"+a+"?$filter=level lt '"+L+"'&$orderby=level,text";return S;},_getODataRequestForSearchUrl:function(m,s,t,f){var S=this._getServiceUrl(m);var n=this.SEARCH_RESULTS_PER_REQUEST;var t=this._removeWildCards(t);var f=!f?0:f;S=S+";o="+s+"/MenuItems"+"?$filter=type ne 'FL' and substringof('"+t+"', text) or substringof('"+t+"', subtitle) or substringof('"+t+"', url)&$orderby=text,subtitle,url&$inlinecount=allpages&$skip="+f+"&$top="+n;return S;},_getServiceUrl:function(m){var s;var M=this.getView().getModel();if(m=="SAP_MENU"){var S=M.getProperty("/sapMenuServiceUrl");if(S){s=S;}else{s=this.DEFAULT_URL+"/EASY_ACCESS_MENU";}}else if(m=="USER_MENU"){var u=M.getProperty("/userMenuServiceUrl");if(u){s=u;}else{s=this.DEFAULT_URL+"/USER_MENU";}}return s;},_removeWildCards:function(t){return t.replace(/\*/g,"");}});}());(function(){"use strict";sap.ui.jsview("sap.ushell.components.flp.launchpad.appfinder.EasyAccess",{BUSY_INDICATOR_DELAY:1000,createContent:function(c){this.oResourceBundle=sap.ushell.resources.i18n;this.setModel(this.getViewData().easyAccessSystemsModel,"easyAccessSystemsModel");this.setModel(this.getViewData().subHeaderModel,"subHeaderModel");this.setModel(this.getViewData().parentComponent.getModel());this.hierarchyFolders=sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.ushell.components.flp.launchpad.appfinder.HierarchyFolders",height:"100%",viewData:{navigateHierarchy:this.oController.navigateHierarchy.bind(c),easyAccessSystemsModel:this.getModel("easyAccessSystemsModel"),subHeaderModel:this.getModel("subHeaderModel")}});this.hierarchyFolders.setBusyIndicatorDelay(this.BUSY_INDICATOR_DELAY);this.hierarchyFolders.addStyleClass("sapUshellHierarchyFolders");this.hierarchyFolders.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"role",value:"navigation",writeToDom:true}));this.hierarchyFolders.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-label",value:this.oResourceBundle.getText("easyAccessListNavigationContainer"),writeToDom:true}));this.hierarchyApps=new sap.ui.view(this.getId()+"hierarchyApps",{type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.ushell.components.flp.launchpad.appfinder.HierarchyApps",height:"100%",viewData:{navigateHierarchy:this.oController.navigateHierarchy.bind(c)}});this.hierarchyApps.setBusyIndicatorDelay(this.BUSY_INDICATOR_DELAY);this.hierarchyApps.addStyleClass(" sapUshellAppsView sapMShellGlobalInnerBackground");this.hierarchyApps.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"role",value:"region",writeToDom:true}));this.hierarchyApps.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-label",value:this.oResourceBundle.getText("easyAccessTileContainer"),writeToDom:true}));this.splitApp=new sap.m.SplitApp({masterPages:this.hierarchyFolders,detailPages:this.hierarchyApps});this.splitApp.setInitialMaster(this.hierarchyFolders);this.splitApp.setInitialDetail(this.hierarchyApps);return this.splitApp;},getControllerName:function(){return"sap.ushell.components.flp.launchpad.appfinder.EasyAccess";}});}());(function(){"use strict";sap.ui.controller("sap.ushell.components.flp.launchpad.appfinder.GroupListPopover",{onInit:function(){var v=this.getView();var g=v.getViewData().groupData;this.oPopoverModel=new sap.ui.model.json.JSONModel({userGroupList:g});v.oPopover.setModel(this.oPopoverModel);},okButtonHandler:function(e){e.preventDefault();e._bIsStopHandlers=true;var v=this.getView();var u=this.oPopoverModel.getProperty("/userGroupList");var r={addToGroups:[],removeFromGroups:[],newGroups:[],allGroups:u};u.forEach(function(g){if(g.selected===g.initiallySelected){return;}if(g.selected){r.addToGroups.push(g.oGroup);}else{r.removeFromGroups.push(g.oGroup);}});if(v.newGroupInput&&v.newGroupInput.getValue().length){r.newGroups.push(v.newGroupInput.getValue());}v.oPopover.close();v.deferred.resolve(r);},_cancelButtonHandler:function(e){e.preventDefault();e._bIsStopHandlers=true;var v=this.getView();v.oPopover.close();v.deferred.reject();},_navigateToCreateNewGroupPane:function(){var v=this.getView();if(!v.headBarForNewGroup){v.headBarForNewGroup=v._createHeadBarForNewGroup();}if(!v.newGroupInput){v.newGroupInput=v._createNewGroupInput();}v.oPopover.removeAllContent();v.oPopover.addContent(v.newGroupInput);v.oPopover.setCustomHeader(v.headBarForNewGroup);v.oPopover.setContentHeight("");if(v.getViewData().singleGroupSelection){this._setFooterVisibility(true);}setTimeout(function(){v.newGroupInput.focus();},0);},_afterCloseHandler:function(){var v=this.getView();v.oGroupsContainer.destroy();if(v.headBarForNewGroup){v.headBarForNewGroup.destroy();}if(v.newGroupInput){v.newGroupInput.destroy();}v.oPopover.destroy();v.destroy();},_backButtonHandler:function(){var v=this.getView();v.oPopover.removeAllContent();if(v.getViewData().singleGroupSelection){this._setFooterVisibility(false);}if(!sap.ui.Device.system.phone){v.oPopover.setContentHeight(v.iPopoverDataSectionHeight+"px");}else{v.oPopover.setContentHeight("100%");}v.oPopover.setVerticalScrolling(true);v.oPopover.setHorizontalScrolling(false);v.oPopover.addContent(v.oGroupsContainer);v.oPopover.setTitle(sap.ushell.resources.i18n.getText("addTileToGroups_popoverTitle"));v.oPopover.setCustomHeader();v.newGroupInput.setValue('');},_setFooterVisibility:function(v){var f=sap.ui.getCore().byId("groupsPopover-footer");if(f){f.setVisible(v);}}});}());(function(){"use strict";sap.ui.jsview("sap.ushell.components.flp.launchpad.appfinder.GroupListPopover",{createContent:function(c){this.iPopoverDataSectionHeight=192;this.oGroupsContainer=this._createPopoverContainer(this.iPopoverDataSectionHeight);this.oPopover=new sap.m.ResponsivePopover({id:"groupsPopover",placement:"Auto",title:sap.ushell.resources.i18n.getText("addTileToGroups_popoverTitle"),contentWidth:'20rem',beginButton:this._createOkButton(),endButton:this._createCancelButton(),content:this.oGroupsContainer,afterClose:this.getController()._afterCloseHandler.bind(this.getController())});this.oPopover.setInitialFocus('newGroupItem');},open:function(o){if(document.body.clientHeight-o.getDomRef().getBoundingClientRect().bottom>=310){this.oPopover.setPlacement("Bottom");}this.oPopover.openBy(o);if(this.getViewData().singleGroupSelection){this.getController()._setFooterVisibility(false);}this.deferred=jQuery.Deferred();return this.deferred.promise();},_createPopoverContainer:function(p){var n=this._createNewGroupUiElements();var g=this._createPopoverGroupList();var a=new sap.m.ScrollContainer({id:"popoverContainer",horizontal:false,vertical:true,content:[n,g]});if(!sap.ui.Device.system.phone){a.setHeight((p-2)+"px");}else{a.setHeight("100%");}return a;},_createNewGroupUiElements:function(){var n=new sap.m.StandardListItem({id:"newGroupItem",title:sap.ushell.resources.i18n.getText("newGroup_listItemText"),type:"Navigation",press:this.getController()._navigateToCreateNewGroupPane.bind(this.getController())});var N=new sap.m.List({});if(this.getViewData().enableHelp){n.addStyleClass('help-id-newGroupItem');}N.addItem(n);N.addEventDelegate({onsapdown:function(E){try{E.preventDefault();E._bIsStopHandlers=true;var j=jQuery("#popoverContainer .sapMListModeMultiSelect li, #popoverContainer .sapMListModeSingleSelectMaster li").first();j.focus();}catch(e){}},onsaptabnext:function(E){try{E.preventDefault();E._bIsStopHandlers=true;var j=jQuery("#okButton");j.focus();}catch(e){}}});return N;},_createNewGroupInput:function(){var n=new sap.m.Input({id:"newGroupNameInput",type:"Text",placeholder:sap.ushell.resources.i18n.getText("new_group_name")});n.setValueState(sap.ui.core.ValueState.None);n.setPlaceholder(sap.ushell.resources.i18n.getText("new_group_name"));n.enabled=true;n.addStyleClass("sapUshellCatalogNewGroupInput");return n;},_createHeadBarForNewGroup:function(){var b=new sap.m.Button({icon:sap.ui.core.IconPool.getIconURI("nav-back"),press:this.getController()._backButtonHandler.bind(this.getController()),tooltip:sap.ushell.resources.i18n.getText("newGroupGoBackBtn_tooltip")});b.addStyleClass("sapUshellCatalogNewGroupBackButton");var h=new sap.m.Bar({contentLeft:[b],contentMiddle:[new sap.m.Label({text:sap.ushell.resources.i18n.getText("newGroup_popoverTitle")})]});return h;},getControllerName:function(){return"sap.ushell.components.flp.launchpad.appfinder.GroupListPopover";},_createPopoverGroupList:function(){var l=new sap.m.DisplayListItem({label:"{oGroup/title}",selected:"{selected}",tooltip:"{oGroup/title}",type:sap.m.ListType.Active});var u=[];u.push(new sap.ui.model.Filter("oGroup/isGroupLocked",sap.ui.model.FilterOperator.EQ,false));if(this.getViewData().enableHideGroups){u.push(new sap.ui.model.Filter("oGroup/isGroupVisible",sap.ui.model.FilterOperator.EQ,true));}var s=this.getViewData().singleGroupSelection;var L=new sap.m.List({mode:s?sap.m.ListMode.SingleSelectMaster:sap.m.ListMode.MultiSelect,includeItemInSelection:true,items:{path:"/userGroupList",template:l,filters:u}});if(s){L.attachSelect(this.getController().okButtonHandler.bind(this.getController()));}L.addEventDelegate({onsapup:function(E){try{E.preventDefault();var j,c=jQuery(":focus");if(c.index()==0){j=jQuery("#newGroupItem");j.focus();E._bIsStopHandlers=true;}}catch(e){jQuery.sap.log.error("Groups popup Accessibility `up` key failed");}}});return L;},_createOkButton:function(){var o=new sap.m.Button({id:"okButton",press:this.getController().okButtonHandler.bind(this.getController()),text:sap.ushell.resources.i18n.getText("okBtn")});o.addEventDelegate({onsaptabprevious:function(E){try{E.preventDefault();E._bIsStopHandlers=true;var j=jQuery("#newGroupItem");if(!j.length){j=jQuery("#newGroupNameInput input");}j.focus();}catch(e){jQuery.sap.log.error("Groups popup Accessibility `shift-tab` key failed");}}});return o;},_createCancelButton:function(){return new sap.m.Button({id:"cancelButton",press:this.getController()._cancelButtonHandler.bind(this.getController()),text:sap.ushell.resources.i18n.getText("cancelBtn")});}});}());(function(){"use strict";sap.ui.controller("sap.ushell.components.flp.launchpad.appfinder.HierarchyApps",{onInit:function(){var e=this.getView().getViewData().easyAccessSystemsModel;if(e){this.getView().setModel(e,"easyAccessSystems");}},getCrumbsData:function(p,m){var a=p.split("/");a.splice(a.length-2,2);var n=[];while(a.length){var P=a.join("/");var t=m.getProperty(P+"/text");n.unshift({text:t,path:P});a.splice(a.length-2,2);}return n;},_updateAppBoxedWithPinStatuses:function(p){var v=this.getView();if(!p){p=v.layout.getBinding("items").getPath();}var e=v.getModel("easyAccess");var a=e.getProperty(p);var b=sap.ushell.Container.getService("Bookmark");var c=a.map(function(d){return b.countBookmarks(d.url).then(function(f){d.bookmarkCount=f;return d;});});jQuery.when.apply(jQuery,c).then(function(){var a=Array.prototype.slice.call(arguments);e.setProperty(p,a);});},updatePageBindings:function(p){this.getView().layout.bindAggregation("items","easyAccess>"+p+"/apps",this.getView().oItemTemplate);this._updateAppBoxedWithPinStatuses(p+"/apps");this.getView().breadcrumbs.bindProperty("currentLocationText","easyAccess>"+p+"/text");var c=this.getCrumbsData(p,this.getView().getModel("easyAccess"));this.getView().crumbsModel.setProperty("/crumbs",c);var n=this.getView().getModel("easyAccess").getProperty(p+'/apps');this.getView().updateResultSetMessage(n.length,false);},onAppBoxPressed:function(e){if(e.mParameters.srcControl.$().closest(".sapUshellPinButton").length){return;}var u=e.getSource().getProperty("url");if(u&&u.indexOf("#")===0){hasher.setHash(u);}},_handleSuccessMessage:function(a,p){var m;var n=p.addToGroups?p.addToGroups.length:0;var b=p.newGroups?p.newGroups.length:0;var t=n+b;if(t===1){var g;if(n===1){g=p.addToGroups[0].title;}else{g=p.newGroups[0];}m=sap.ushell.resources.i18n.getText("appAddedToSingleGroup",[a.text,g]);}else{m=sap.ushell.resources.i18n.getText("appAddedToSeveralGroups",[a.text,t]);}if(t>0){sap.m.MessageToast.show(m,{duration:3000,width:"15em",my:"center bottom",at:"center bottom",of:window,offset:"0 -50",collision:"fit fit"});}return m;},_prepareErrorMessage:function(e,a){var g,A,f,n=0,c=false,m;for(var i in e){g=e[i].group;A=e[i].action;if(A=='addBookmark_ToExistingGroup'){n++;if(n==1){f=g.title;}}else if(A=='addBookmark_ToNewGroup'){n++;if(n==1){f=g;}}else{c=true;}}if(c){if(e.length==1){m=sap.ushell.resources.i18n.getText({messageId:"fail_tile_operation_create_new_group"});}else{m=sap.ushell.resources.i18n.getText({messageId:"fail_tile_operation_some_actions"});}}else if(e.length==1){m=sap.ushell.resources.i18n.getText({messageId:"fail_app_operation_add_to_group",parameters:[a,f]});}else{m=sap.ushell.resources.i18n.getText({messageId:"fail_app_operation_add_to_several_groups",parameters:[a]});}return m;},_handleBookmarkAppPopoverResponse:function(a,p){var b=[];p.newGroups.forEach(function(g){b.push(this._createGroupAndAddBookmark(g,a));}.bind(this));p.addToGroups.forEach(function(g){b.push(this._addBookmark(g,a));}.bind(this));jQuery.when.apply(jQuery,b).then(function(){var r=Array.prototype.slice.call(arguments);this._handlePopoverGroupsActionPromises(a,p,r);}.bind(this));},_handlePopoverGroupsActionPromises:function(a,p,r){var e=r.filter(function(b,i,r){return!b.status;});if(e.length){var E=this._prepareErrorMessage(e,a.text);var d=sap.ushell.components.flp.launchpad.getDashboardManager();d.resetGroupsOnFailure(E.messageId,E.parameters);return;}this._updateAppBoxedWithPinStatuses();this._handleSuccessMessage(a,p);},_createGroupAndAddBookmark:function(n,a){var d=sap.ushell.components.flp.launchpad.getDashboardManager();var b=jQuery.Deferred(),r={};var c=d.createGroup(n);c.done(function(e){var f=this._addBookmark(e.getObject(),a,true);f.done(function(g){b.resolve(g);}).fail(function(){r={group:n,status:0,action:'addBookmark_ToNewGroup'};b.resolve(r);});}.bind(this)).fail(function(){r={group:n,status:0,action:'addBookmark_NewGroupCreation'};b.resolve(r);});return b.promise();},_addBookmark:function(g,a,i){var b=sap.ushell.Container.getService("Bookmark");var d=jQuery.Deferred(),r={};var c=b.addBookmark({url:a.url,title:a.text,subtitle:a.subtitle,icon:a.icon},g.object);var e=i?"addBookmark_ToNewGroup":"addBookmark_ToExistingGroup";c.done(function(){r={group:g,status:1,action:e};d.resolve(r);}).fail(function(){r={group:g,status:0,action:e};d.resolve(r);});return d.promise();},showSaveAppPopover:function(e){var m=this.getView().getModel();var a=e.oSource.getParent().getBinding("title").getContext().getObject();if(!!m.getProperty("/groupContext").path){var g=m.getProperty("/groupContext").path;var G=m.getProperty(g);var c={newGroups:[],addToGroups:[G]};this._handleBookmarkAppPopoverResponse(a,c);return;}var b=m.getProperty("/groups").map(function(f){return{selected:false,initiallySelected:false,oGroup:f};});var p=new sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.ushell.components.flp.launchpad.appfinder.GroupListPopover",viewData:{groupData:b,enableHideGroups:m.getProperty("/enableHideGroups"),enableHelp:m.getProperty("/enableHelp"),singleGroupSelection:true}});var d=p.open(e.oSource);d.then(this._handleBookmarkAppPopoverResponse.bind(this,a));},resultTextFormatter:function(s,t){var r=sap.ushell.resources.i18n;if(s){var S=s.systemName?s.systemName:s.systemId;var R="";if(t){R=r.getText('search_easy_access_results',[t,S]);}return R;}return"";},showMoreResultsVisibilityFormatter:function(a,t){if(a&&a.length<t){return true;}return false;},showMoreResultsTextFormatter:function(a,t){if(!a||!t){return"";}var c=a.length;return sap.ushell.resources.i18n.getText('EasyAccessSearchResults_ShowMoreResults',[c,t]);}});}());(function(){"use strict";sap.ui.controller("sap.ushell.components.flp.launchpad.appfinder.HierarchyFolders",{onInit:function(){this.oDialog=null;this.getView().setModel(this.getView().getViewData().easyAccessSystemsModel,"easyAccessSystems");this.getView().setModel(this.getView().getViewData().subHeaderModel,"subHeaderModel");this.getSelectedSystem().then(function(s){if(s){this.setSystemSelected(s);}else{this.setSystemSelected(undefined);this.onSystemSelectionPress();}}.bind(this),function(){this.setSystemSelected(undefined);this.onSystemSelectionPress();});},onExit:function(){if(this.oDialog){this.destroyDialog();}},onAfterRendering:function(){var j=jQuery('#'+this.getView().getId());j.on("click",function(e){this.exitSearchMode();}.bind(this));},getPersonalizer:function(){if(this.oPersonalizer){return this.oPersonalizer;}var p=sap.ushell.Container.getService("Personalization");var c=sap.ui.core.Component.getOwnerComponentFor(this);var s={keyCategory:p.constants.keyCategory.FIXED_KEY,writeFrequency:p.constants.writeFrequency.LOW,clientStorageAllowed:true};var P={container:"flp.launchpad.appfinder.HierarchyFolders",item:"lastSelectedSystem"};this.oPersonalizer=p.getPersonalizer(P,s,c);return this.oPersonalizer;},getSelectedSystem:function(){var d=new jQuery.Deferred();var s=this.getView().getModel("easyAccessSystems").getProperty("/systemsList");if(s&&s.length&&s.length===1){var e=s[0];this.setSystemSelectedInPersonalization(e);d.resolve(e);}else{this.getSelectedSystemInPersonalization().then(function(p){if(p){var S=false;for(var i=0;i<s.length;i++){if((s[i].systemName&&s[i].systemName===p.systemName)||(s[i].systemId===p.systemId)){S=true;d.resolve(p);}}if(!S){d.resolve();this.setSystemSelectedInPersonalization();}}else{d.resolve();}}.bind(this));}return d.promise();},setSystemSelected:function(s){this.getView().getModel("easyAccessSystems").setProperty("/systemSelected",s);this.setSystemSelectedInPersonalization(s);},getSelectedSystemInPersonalization:function(){var d=new jQuery.Deferred();this.getPersonalizer().getPersData().then(function(p){if(p){d.resolve(p);}else{d.resolve();}},function(e){jQuery.sap.log.error("Failed to get selected system from the personalization",e,"sap.ushell.components.flp.launchpad.appfinder.HierarchyFolders");d.reject();});return d.promise();},setSystemSelectedInPersonalization:function(s){this.getPersonalizer().setPersData(s).fail(function(e){jQuery.sap.log.error("Failed to save selected system in the personalization",e,"sap.ushell.components.flp.launchpad.appfinder.HierarchyFolders");});},onSystemSelectionPress:function(){var s=this.getView().getModel("easyAccessSystems").getProperty("/systemsList");if(s&&s.length&&s.length<=1){return;}var d=this.createDialog();d.open();},createDialog:function(){var t=this;if(!this.oDialog){this.oDialog=new sap.m.SelectDialog({id:"systemSelectionDialog",title:t.getView().translationBundle.getText("easyAccessSelectSystemDialogTitle"),multiSelect:false,contentHeight:"20rem",items:{path:"/systemsList",template:new sap.m.StandardListItem({adaptTitleSize:false,title:{parts:["systemName","systemId"],formatter:t.titleFormatter},description:{parts:["systemName","systemId"],formatter:t.descriptionFormatter},selected:{parts:["systemName","systemId"],formatter:t.selectedFormatter.bind(this)}})},confirm:t.systemConfirmHandler.bind(t),search:t.systemSearchHandler.bind(t),cancel:t.destroyDialog.bind(t)});this.oDialog.setModel(this.getView().getModel("easyAccessSystems"));}return this.oDialog;},destroyDialog:function(){this.oDialog.destroyItems();this.oDialog.destroy();this.oDialog=null;},systemConfirmHandler:function(e){var i=e.getParameters().selectedItem;var s=i.getBindingContext().getObject();this.setSystemSelected(s);this.destroyDialog();},systemSearchHandler:function(e){var v=e.getParameter("value");var f=new sap.ui.model.Filter("systemName",sap.ui.model.FilterOperator.Contains,v);var F=new sap.ui.model.Filter("systemId",sap.ui.model.FilterOperator.Contains,v);var s=new sap.ui.model.Filter({filters:[F,f],and:false});var b=e.getSource().getBinding("items");b.filter(s);},titleFormatter:function(s,a){return s||a;},descriptionFormatter:function(s,a){if(s){return a;}return null;},selectedFormatter:function(s,a){var u=this.getView().getModel("easyAccessSystems").getProperty("/systemSelected");if(!u){return false;}if(s){return(u.systemName===s);}else{return(u.systemId===a);}},systemSelectorTextFormatter:function(s){if(s){if(s.systemName){return s.systemName;}else{return s.systemId;}}else{return this.getView().translationBundle.getText("easyAccessSelectSystemTextWithoutSystem");}},exitSearchMode:function(){var s=this.getView().getModel('subHeaderModel');s.setProperty('/search/searchMode',false);s.refresh(true);}});}());(function(){"use strict";sap.ui.jsview("sap.ushell.components.flp.launchpad.appfinder.HierarchyFolders",{createContent:function(c){var t=this;this.translationBundle=sap.ushell.resources.i18n;this.treePath="";this.systemSelectorText=new sap.m.Text({text:{path:"easyAccessSystemsModel>/systemSelected",formatter:c.systemSelectorTextFormatter.bind(c)}});this.oItemTemplate=new sap.m.StandardListItem({title:"{easyAccess>text}",type:"Navigation",press:function(){var p=this.getBindingContextPath();t.getViewData().navigateHierarchy(p,true);}});this.oList=new sap.m.List({showSeparators:sap.m.ListSeparators.None,items:{path:"easyAccess>"+this.treePath+"/folders",template:this.oItemTemplate},updateFinished:function(){var l=this.getItems();t.finishEasyAccessAnimation(true);l.forEach(function(L){L.onsapspace=L.onsapenter;});},noDataText:{path:"easyAccessSystemsModel>/systemSelected",formatter:function(s){if(s){return t.translationBundle.getText("easyAccessFolderWithNoItems");}}}});this.pageMenu=new sap.m.Page({showNavButton:false,enableScrolling:true,headerContent:new sap.m.Bar({contentLeft:[new sap.m.Label({text:{parts:["easyAccessSystemsModel>/systemSelected"],formatter:c.systemSelectorTextFormatter.bind(c)}})],contentRight:[new sap.m.Button({text:this.translationBundle.getText("action_change"),type:sap.m.ButtonType.Transparent,visible:{path:"easyAccessSystemsModel>/systemsList",formatter:function(s){return s.length>1;}},press:[c.onSystemSelectionPress,c]})]}).addStyleClass("sapUshellEasyAccessMasterPageHeader"),content:this.oList});this.pageMenu.attachNavButtonPress(function(){var p=this.treePath.split("/");var n=p.slice(0,p.length-2);this.getViewData().navigateHierarchy(n.join("/"),false);}.bind(this));return this.pageMenu;},getControllerName:function(){return"sap.ushell.components.flp.launchpad.appfinder.HierarchyFolders";},finishEasyAccessAnimation:function(){if(!this.jqFolderClone){return;}if(this.forwardAnimation){this.pageMenu.$().addClass("forwardToViewAnimation");this.jqFolderClone.addClass("forwardOutOfViewAnimation");}else{this.pageMenu.$().addClass("backToViewAnimation");this.jqFolderClone.addClass("backOutOfViewAnimation");}this.jqFolderClone.on("animationend",function(){this.pageMenu.$().removeClass("forwardToViewAnimation backToViewAnimation");var b=this.pageMenu.$().find(".sapMBarLeft button");if(b.length){b.focus();}else{setTimeout(function(){this.pageMenu.$().find("header + header").focus();}.bind(this));}if(this.jqFolderClone){this.jqFolderClone.remove();}}.bind(this));},prepareEasyAccessAnimation:function(f){this.forwardAnimation=f;this.jqFolderClone=this.pageMenu.$().clone().removeAttr("data-sap-ui").css("z-index","1");this.jqFolderClone.find("*").removeAttr("id");this.pageMenu.$().parent().append(this.jqFolderClone);},updatePageBindings:function(p,f){var s=p.split("/").length>2;this.treePath=p;this.pageMenu.setShowNavButton(s);this.pageMenu.setShowSubHeader(!s);this.prepareEasyAccessAnimation(f);this.oList.bindItems("easyAccess>"+p+"/folders",this.oItemTemplate);}});}());(function(){"use strict";sap.ui.controller("sap.ushell.components.flp.launchpad.group_list.GroupList",{onInit:function(){this.sViewId="#"+this.getView().getId();this.sGroupListId="#"+this.getView().oGroupList.getId();this.handleScroll=this._fHandleScroll.bind(this);},onAfterRendering:function(){this.jqView=jQuery(this.sViewId);this.jgGroupList=jQuery(this.sGroupListId);var e=sap.ui.getCore().getEventBus();e.unsubscribe("grouplist","ScrollAnimationEnd",this._handleScrollAnimationEnd,this);e.subscribe("grouplist","ScrollAnimationEnd",this._handleScrollAnimationEnd,this);e.unsubscribe("grouplist","DashboardRerender",this._addScroll,this);e.subscribe("grouplist","DashboardRerender",this._addScroll,this);e.unsubscribe("launchpad","dashboardScroll",this.handleScroll,this);e.subscribe("launchpad","dashboardScroll",this.handleScroll,this);this._addScroll();},_addScroll:function(){var t=this;setTimeout(function(){this.dashboardElement=document.querySelector(".sapUshellDashboardView section");if(this.dashboardElement){this.dashboardElement.removeEventListener('scroll',t.handleScroll);this.dashboardElement.addEventListener('scroll',t.handleScroll);}}.bind(this),0);},_fHandleScroll:function(){var m=this.getView().getModel(),t=m.getProperty("/topGroupInViewPortIndex");if(!m.getProperty("/scrollingToGroup")){if(!m.getProperty("/groupList-skipScrollToGroup")){var g=jQuery('#groupList li.sapUshellGroupLI');var s=g.removeClass('sapUshellSelected').eq(t);s.addClass('sapUshellSelected');var a=document.getElementById('groupListPage-cont');var b=a.scrollTop;var c=b+a.offsetHeight;var d=s[0]?s[0].offsetTop:undefined;if(d<b){jQuery('#groupListPage section').animate({scrollTop:g[t].offsetTop},0);}else if(d+s[0].offsetHeight>c){jQuery('#groupListPage section').animate({scrollTop:b+g[t].offsetHeight},0);}}sap.ushell.utils.handleTilesVisibility();}},_handleGroupListItemPress:function(e){var s=e.getSource(),f;f=e.getParameter("action")==="sapenter";this._handleScrollToGroup(s,false,f);},_handleScrollToGroup:function(g,a,f){if(!g){return;}var t=this;document.querySelector(".sapUshellDashboardView").removeEventListener('scroll',t.handleScroll);this._publishAsync("launchpad","scrollToGroup",{group:g,groupChanged:a,focus:f});},_handleScrollAnimationEnd:function(){var t=this;document.querySelector(".sapUshellDashboardView").addEventListener('scroll',t.handleScroll);this.getView().getModel().setProperty("/scrollingToGroup",false);},_publishAsync:function(c,e,d){var b=sap.ui.getCore().getEventBus();window.setTimeout($.proxy(b.publish,b,c,e,d),1);}});}());(function(){"use strict";sap.ui.jsview("sap.ushell.components.tiles.applauncher.StaticTile",{getControllerName:function(){return"sap.ushell.components.tiles.applauncher.StaticTile";},createContent:function(c){this.setHeight('100%');this.setWidth('100%');},getTileControl:function(){jQuery.sap.require('sap.m.GenericTile');jQuery.sap.require('sap.m.ImageContent');var c=this.getController();return new sap.m.GenericTile({header:'{/config/display_title_text}',subheader:'{/config/display_subtitle_text}',size:"Auto",tileContent:new sap.m.TileContent({size:"Auto",footer:'{/config/display_info_text}',content:new sap.m.ImageContent({src:'{/config/display_icon_url}',width:"100%"})}),press:[c.onPress,c]});},getLinkControl:function(){if(window.location.search.indexOf("new_links_container=true")===-1){jQuery.sap.require('sap.m.Link');return new sap.m.Link({text:"{/config/display_title_text}",href:"{/nav/navigation_target_url}",target:{path:"/nav/navigation_target_url",formatter:function(u){if(u&&u[0]!=='#'){return"_blank";}}}});}else{jQuery.sap.require('sap.m.GenericTile');var c=this.getController();return new sap.m.GenericTile({mode:sap.m.GenericTileMode.LineMode,header:'{/config/display_title_text}',subheader:'{/config/display_subtitle_text}',press:[c.onPress,c]});}}});}());(function(){"use strict";sap.ui.jsview("sap.ushell.components.tiles.applauncherdynamic.DynamicTile",{getControllerName:function(){return"sap.ushell.components.tiles.applauncherdynamic.DynamicTile";},createContent:function(c){this.setHeight('100%');this.setWidth('100%');},getTileControl:function(){jQuery.sap.require('sap.m.GenericTile');var c=this.getController();return new sap.m.GenericTile({header:'{/data/display_title_text}',subheader:'{/data/display_subtitle_text}',size:"Auto",tileContent:[new sap.m.TileContent({size:"Auto",footer:'{/data/display_info_text}',unit:'{/data/display_number_unit}',content:[new sap.m.NumericContent({scale:'{/data/display_number_factor}',value:'{/data/display_number_value}',truncateValueTo:5,indicator:'{/data/display_state_arrow}',valueColor:'{/data/display_number_state}',icon:'{/data/display_icon_url}',width:'100%'})]})],press:[c.onPress,c]});},getLinkControl:function(){if(window.location.search.indexOf("new_links_container=true")===-1){jQuery.sap.require('sap.m.Link');return new sap.m.Link({text:"{/config/display_title_text}",href:"{/nav/navigation_target_url}",target:{path:"/nav/navigation_target_url",formatter:function(u){if(u&&u[0]!=='#'){return"_blank";}}}});}else{jQuery.sap.require('sap.m.GenericTile');var c=this.getController();return new sap.m.GenericTile({mode:sap.m.GenericTileMode.LineMode,header:'{/config/display_title_text}',subheader:'{/config/display_subtitle_text}',press:[c.onPress,c]});}}});}());(function(){"use strict";sap.ui.jsview("sap.ushell.components.tiles.cdm.applauncher.StaticTile",{getControllerName:function(){return"sap.ushell.components.tiles.cdm.applauncher.StaticTile";},createContent:function(c){this.setHeight('100%');this.setWidth('100%');jQuery.sap.require('sap.m.GenericTile');jQuery.sap.require('sap.m.ImageContent');var c=this.getController();return new sap.m.GenericTile({header:'{/properties/title}',subheader:'{/properties/subtitle}',size:'Auto',tileContent:new sap.m.TileContent({size:"Auto",content:new sap.m.ImageContent({src:'{/properties/icon}',width:"100%"})}),press:[c.onPress,c]});}});}());(function(){"use strict";sap.ui.jsview("sap.ushell.components.tiles.cdm.applauncherdynamic.DynamicTile",{getControllerName:function(){return"sap.ushell.components.tiles.cdm.applauncherdynamic.DynamicTile";},createContent:function(c){this.setHeight('100%');this.setWidth('100%');jQuery.sap.require('sap.m.GenericTile');var c=this.getController();return new sap.m.GenericTile({size:'Auto',header:'{/properties/title}',subheader:'{/properties/subtitle}',tileContent:[new sap.m.TileContent({size:'Auto',footer:'{/properties/info}',unit:'{/properties/number_unit}',content:[new sap.m.NumericContent({truncateValueTo:5,scale:'{/properties/number_factor}',value:'{/properties/number_value}',indicator:'{/properties/number_state_arrow}',valueColor:'{/properties/number_value_state}',icon:'{/properties/icon}',width:'100%'})]})],press:[c.onPress,c]});}});}());(function(){"use strict";sap.ui.controller("sap.ushell.components.tiles.indicatorDual.DualTile",{onAfterRendering:function(){this.initProcess();},initProcess:function(r){var t=this;this.oKpiTileView=this.getView();this.oResourceBundle=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();this.viewData={};t.viewData=this.oKpiTileView.getViewData();this.oTileApi=this.viewData.chip;if(this.oTileApi.visible){this.oTileApi.visible.attachVisible(this.visibleHandler.bind(this));}this.deferred_left=new jQuery.Deferred();this.deferred_right=new jQuery.Deferred();$.when(this.deferred_left,this.deferred_right).done(function(){t.setTextInTile();t.oConfig=t.oKpiTileView.oConfig;t.chipCacheTime=sap.ushell.components.tiles.indicatorTileUtils.util.getCachingTime(t.oConfig);t.chipCacheTimeUnit=sap.ushell.components.tiles.indicatorTileUtils.util.getCachingTimeUnit(t.oConfig);var l=t.leftView.getController().cacheWriteData;var a=t.rightView.getController().cacheWriteData;t.oKpiTileView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);var n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oKpiTileView.oConfig,t.system);t.oKpiTileView.oGenericTile.$().wrap("<a href ='"+n+"'/>");var c={};var w={};w.leftData=l;w.rightData=a;c.ChipId=t.oConfig.TILE_PROPERTIES.id;c.Data=JSON.stringify(w);c.CacheMaxAge=Number(t.chipCacheTime);c.CacheMaxAgeUnit=t.chipCacheTimeUnit;c.CacheType=1;var b=t.getLocalCache(c);if(w.leftData&&w.rightData){sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,b);}var d=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(t.chipCacheTime&&w.leftData&&w.rightData){sap.ushell.components.tiles.indicatorTileUtils.util.writeFrontendCacheByChipAndUserId(t.oTileApi,t.oConfig.TILE_PROPERTIES.id,c,false,function(e){if(e){sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,e);t.cacheTime=e.CachedTime;t.setTimeStamp.call(t);}});}if(t.chipCacheTime){if(!t.cacheTime){t.cacheTime=d.CachedTime;}t.setTimeStamp.call(t);sap.ushell.components.tiles.indicatorTileUtils.util.scheduleFetchDataJob.call(t,t.oTileApi.visible.isVisible());}}).fail(function(){t.oKpiTileView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Failed);});t.tileType=t.oKpiTileView.oConfig.TILE_PROPERTIES.tileType;this.oTileApi=t.viewData.chip;if(this.oTileApi.preview.isEnabled()){this.doDummyProcess();}else{this.doProcess(r);}},setTimeStamp:function(){this.updateTimeStampjobScheduled=false;var f=sap.ui.core.format.DateFormat.getDateTimeInstance({relative:true,relativeSource:"auto"});var t=f.format(this.getRelativeTime());var l=this.getView().oGenericTile.getTileContent()[0];l&&l.setRefreshOption&&l.setRefreshOption(true);l&&l.setTimestamp&&l.setTimestamp(t);this.updateTimeStampjobScheduled=false;var k=this.oConfig.TILE_PROPERTIES.id+"time";var r=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(k);if(r){clearTimeout(r);r=undefined;}sap.ushell.components.tiles.indicatorTileUtils.util.scheduleTimeStampJob.call(this,this.oTileApi.visible.isVisible());},getRelativeTime:function(){var c=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();this.cacheTime=(jQuery.type(this.cacheTime)=="date")?this.cacheTime:new Date(parseInt(this.cacheTime.substr(6),10));var r=sap.ushell.components.tiles.indicatorTileUtils.util.getTimeDifference(c-this.cacheTime);var a;switch(r.unit){case"minutes":var o=sap.ushell.components.tiles.indicatorTileUtils.util.getMillisecond(r.time,"minutes");c=c-o;a=new Date(c);break;case"hours":var o=sap.ushell.components.tiles.indicatorTileUtils.util.getMillisecond(r.time,"hours");c=c-o;a=new Date(c);break;case"days":var o=sap.ushell.components.tiles.indicatorTileUtils.util.getMillisecond(r.time,"days");c=c-o;a=new Date(c);break;}return a;},getLocalCache:function(c){var l={};l.ChipId=c.ChipId;l.Data=c.Data;l.CacheMaxAge=c.CacheMaxAgeUnit;l.CacheMaxAgeUnit=c.CacheMaxAgeUnit;l.CacheType=c.CacheType;l.CachedTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();return l;},setNoData:function(){try{this._updateTileModel({value:"",scale:"",unit:"",footerNum:this.oResourceBundle.getText("sb.noDataAvailable"),footerComp:this.oResourceBundle.getText("sb.noDataAvailable")});this.oKpiTileView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);}catch(e){}},doProcess:function(r){sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(this.oKpiTileView.oConfig.TILE_PROPERTIES.id+"defferedLeft",this.deferred_left);sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(this.oKpiTileView.oConfig.TILE_PROPERTIES.id+"defferedRight",this.deferred_right);var t=this;this.getView().oGenericTile.removeAllTileContent();var s=this.getView().oGenericTile;this.leftView;this.rightView;this.system=this.oTileApi.url.getApplicationSystem();this.oKpiTileView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loading);var a=t.tileType.split("-")[1];try{var v;v="sap.ushell.components.tiles.indicatornumeric.NumericTile";this.leftView=t._getView(v,this.deferred_left,r);this.leftView.getController().dataCallInProgress=false;s.addTileContent(this.leftView.oGenericTile.getTileContent()[0]);switch(a){case"CM":v="sap.ushell.components.tiles.indicatorcomparison.ComparisonTile";this.rightView=t._getView(v,this.deferred_right,r);this.rightView.getController().dataCallInProgress=false;s.addTileContent(this.rightView.oGenericTile.getTileContent()[0]);break;case"CT":v="sap.ushell.components.tiles.indicatorcontribution.ContributionTile";this.rightView=t._getView(v,this.deferred_right,r);this.rightView.getController().dataCallInProgress=false;s.addTileContent(this.rightView.oGenericTile.getTileContent()[0]);break;case"AT":v="sap.ushell.components.tiles.indicatordeviation.DeviationTile";this.rightView=t._getView(v,this.deferred_right,r);this.rightView.getController().dataCallInProgress=false;s.addTileContent(this.rightView.oGenericTile.getTileContent()[0]);break;case"TT":v="sap.ushell.components.tiles.indicatorArea.AreaChartTile";this.rightView=t._getView(v,this.deferred_right,r);this.rightView.getController().dataCallInProgress=false;s.addTileContent(this.rightView.oGenericTile.getTileContent()[0]);break;}this.leftView.getController().onAfterTileRendering();this.rightView.getController().onAfterTileRendering();var l=this.getView().oGenericTile.getTileContent()[0];l&&l.attachRefresh&&l.attachRefresh(jQuery.proxy(this.refreshPress,t));}catch(e){this.logError(e);}},getChipConfiguration:function(c){var t=this;try{sap.ushell.components.tiles.indicatorTileUtils.util.getParsedChip(t.oTileApi.configuration.getParameterValueAsString("tileConfiguration"),t.oTileApi.preview.isEnabled(),function(a){t.oConfig=a;c.call();});}catch(e){t.logError(e.message);}},refreshPress:function(){this.initProcess(true);},setTextInTile:function(){var t=this;var a=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.oTileApi);this._updateTileModel({header:a.title||sap.ushell.components.tiles.indicatorTileUtils.util.getChipTitle(t.oConfig),subheader:a.subTitle||sap.ushell.components.tiles.indicatorTileUtils.util.getChipSubTitle(t.oConfig)});},_updateTileModel:function(n){var m=this.getTile().getModel().getData();jQuery.extend(m,n);this.getTile().getModel().setData(m);},getTile:function(){return this.oKpiTileView.oGenericTile;},_getView:function(v,d,r){var a=this.oKpiTileView.getViewData();var b=sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:v,viewData:jQuery.extend(true,{},a,{parentController:this},{deferredObj:d},{refresh:r})});return b;},logError:function(e){this._updateTileModel({value:"",scale:"",unit:""});if(this.getView().getViewData().deferredObj){this.getView().getViewData().deferredObj.reject();}},doDummyProcess:function(){var t=this;try{t.setTextInTile();switch(t.tileType){case"DT-CM":t._updateTileModel({value:1,size:sap.suite.ui.commons.InfoTileSize.Auto,frameType:sap.suite.ui.commons.FrameType.TwoByOne,state:sap.suite.ui.commons.LoadState.Loading,valueColor:sap.suite.ui.commons.InfoTileValueColor.Good,indicator:sap.suite.ui.commons.DeviationIndicator.None,title:"Liquidity Structure",footer:"Current Quarter",description:"Apr 1st 2013 (B$)",data:[{title:"Measure 1",value:1,color:"Good"},{title:"Measure 2",value:2,color:"Good"},{title:"Measure 3",value:3,color:"Good"}]});break;case"DT-AT":t._updateTileModel({valueColor:"Good",value:100,frameType:sap.suite.ui.commons.FrameType.TwoByOne,unit:"USD",actual:{value:120,color:sap.suite.ui.commons.InfoTileValueColor.Good},targetValue:100,thresholds:[{value:0,color:sap.suite.ui.commons.InfoTileValueColor.Error},{value:50,color:sap.suite.ui.commons.InfoTileValueColor.Critical},{value:150,color:sap.suite.ui.commons.InfoTileValueColor.Critical},{value:200,color:sap.suite.ui.commons.InfoTileValueColor.Error}],showActualValue:true,showTargetValue:true});break;case"DT-CT":t._updateTileModel({value:8888,size:sap.suite.ui.commons.InfoTileSize.Auto,frameType:sap.suite.ui.commons.FrameType.TwoByOne,state:sap.suite.ui.commons.LoadState.Loading,valueColor:sap.suite.ui.commons.InfoTileValueColor.Error,indicator:sap.suite.ui.commons.DeviationIndicator.None,title:"US Profit Margin",footer:"Current Quarter",description:"Maximum deviation",data:[{title:"Americas",value:10,color:"Neutral",displayValue:""},{title:"EMEA",value:50,color:"Neutral",displayValue:""},{title:"APAC",value:-20,color:"Neutral",displayValue:""}]});break;case"DT-TT":this._updateTileModel({value:8888,size:sap.suite.ui.commons.InfoTileSize.Auto,frameType:sap.suite.ui.commons.FrameType.TwoByOne,state:sap.suite.ui.commons.LoadState.Loading,valueColor:sap.suite.ui.commons.InfoTileValueColor.Error,indicator:sap.suite.ui.commons.DeviationIndicator.None,title:"Liquidity Structure",footer:"Current Quarter",description:"Apr 1st 2013 (B$)",width:"100%",height:"100%",chart:{color:"Good",data:[{day:0,balance:0},{day:30,balance:20},{day:60,balance:20},{day:100,balance:80}]},target:{color:"Error",data:[{day:0,balance:0},{day:30,balance:30},{day:60,balance:40},{day:100,balance:90}]},maxThreshold:{color:"Good",data:[{day:0,balance:0},{day:30,balance:40},{day:60,balance:50},{day:100,balance:100}]},innerMaxThreshold:{color:"Error",data:[]},innerMinThreshold:{color:"Neutral",data:[]},minThreshold:{color:"Error",data:[{day:0,balance:0},{day:30,balance:20},{day:60,balance:30},{day:100,balance:70}]},minXValue:0,maxXValue:100,minYValue:0,maxYValue:100,firstXLabel:{label:"June 123",color:"Error"},lastXLabel:{label:"June 30",color:"Error"},firstYLabel:{label:"0M",color:"Good"},lastYLabel:{label:"80M",color:"Critical"},minLabel:{},maxLabel:{}});break;}}catch(e){}},visibleHandler:function(i){if(!i){if(this.leftView){this.leftView.getController().firstTimeVisible=false;}if(this.rightView){this.rightView.getController().firstTimeVisible=false;}sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.queryServiceUriODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.trendChartODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.comparisionChartODataRef);}if(i){if(this.leftView){this.leftView.getController().refreshHandler();}if(this.rightView){this.rightView.getController().refreshHandler();}}}});}());sap.ui.controller("tiles.indicatorDualComparison.DualComparison",{onInit:function(){var t=this;this.firstTimeVisible=false;this.oDualComparisonView=this.getView();this.oChip=this.oDualComparisonView.getViewData().chip;if(this.oChip.visible){this.oChip.visible.attachVisible(this.visibleHandler.bind(this));}this.system=this.oChip.url.getApplicationSystem();this.oDualComparisonView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loading);try{sap.ushell.components.tiles.indicatorTileUtils.util.getParsedChip(this.oChip.configuration.getParameterValueAsString("tileConfiguration"),function(c){t.oConfig=c;if(t.oChip.preview){t.oChip.preview.setTargetUrl(sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system));}if(t.oChip.preview.isEnabled()){t.setTitle();t._updateTileModel({value:1,size:sap.suite.ui.commons.InfoTileSize.Auto,frameType:"TwoByOne",state:sap.suite.ui.commons.LoadState.Loading,valueColor:sap.suite.ui.commons.InfoTileValueColor.Good,indicator:sap.suite.ui.commons.DeviationIndicator.None,title:"Liquidity Structure",footer:"Current Quarter",description:"Apr 1st 2013 (B$)",data:[{title:"Measure 1",value:1,color:"Good"},{title:"Measure 2",value:2,color:"Good"},{title:"Measure 3",value:3,color:"Good"}]});t.oDualComparisonView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);}else{t.oConfig.TILE_PROPERTIES.FINALVALUE;t.setTitle();t.oDualComparisonView.oGenericTile.attachPress(function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(t.comparisionChartODataRef);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,null);window.location.hash=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);});if(Number(t.oChip.configuration.getParameterValueAsString("isSufficient"))){sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();}else{t.flowWithDesignTimeCall();}}});}catch(e){this.logError(e);}},getTile:function(){return this.oDualComparisonView.oGenericTile;},setTitle:function(){var t=this;var a=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.oChip);this._updateTileModel({header:a.title||sap.ushell.components.tiles.indicatorTileUtils.util.getChipTitle(t.oConfig),subheader:a.subTitle||sap.ushell.components.tiles.indicatorTileUtils.util.getChipSubTitle(t.oConfig)});},_updateTileModel:function(n){var m=this.getTile().getModel().getData();jQuery.extend(m,n);this.getTile().getModel().setData(m);},flowWithoutDesignTimeCall:function(){var t=this;this.DEFINITION_DATA=this.oConfig;this._updateTileModel(this.DEFINITION_DATA);if(this.oChip.visible.isVisible()&&!this.firstTimeVisible){this.firstTimeVisible=true;this.fetchKpiValue(function(k){this.CALCULATED_KPI_VALUE=k;t.oDualComparisonView.oGenericTile.setFrameType("TwoByOne");t.oDualComparisonView.oGenericTile.removeAllTileContent();t.oDualComparisonView.oGenericTile.addTileContent(t.oDualComparisonView.oNumericTile);t.oDualComparisonView.oGenericTile.addTileContent(t.oDualComparisonView.oComparisonTile);var c=this.CALCULATED_KPI_VALUE;var a,b;for(var i=0;i<c.length;i++){if(c[i].title==t.DEFINITION_DATA.EVALUATION.COLUMN_NAME){b=c[i].value;a=c[i].color||"Neutral";t._updateTileModel({value:sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(b),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION).toString(),valueColor:a});break;}}if(!a&&!b){a=t.DEFINITION_DATA.valueColor;b=t.DEFINITION_DATA.value;}this._updateTileModel({value:sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(b),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION).toString(),data:this.CALCULATED_KPI_VALUE});var n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);t.oDualComparisonView.oGenericTile.$().wrap("<a href ='"+n+"'/>");this.oDualComparisonView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);var s="";if(a=="Error"){s="sb.error";}if(a=="Neutral"){s="sb.neutral";}if(a=="Critical"){s="sb.critical";}if(a=="Good"){s="sb.good";}var T=t.setThresholdValues();var m,d,e,v,f,g,h,j,l;if(this.CALCULATED_KPI_VALUE&&this.CALCULATED_KPI_VALUE[0]){m=this.CALCULATED_KPI_VALUE[0].title;v=this.CALCULATED_KPI_VALUE[0].value;h=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(this.CALCULATED_KPI_VALUE[0].color);}if(this.CALCULATED_KPI_VALUE&&this.CALCULATED_KPI_VALUE[1]){d=this.CALCULATED_KPI_VALUE[1].title;f=this.CALCULATED_KPI_VALUE[1].value;j=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(this.CALCULATED_KPI_VALUE[1].color);}if(this.CALCULATED_KPI_VALUE&&this.CALCULATED_KPI_VALUE[2]){e=this.CALCULATED_KPI_VALUE[2].title;g=this.CALCULATED_KPI_VALUE[2].value;l=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(this.CALCULATED_KPI_VALUE[2].color);}var o={status:s,actual:b,target:T.targetValue,cH:T.criticalHighValue,wH:T.warningHighValue,wL:T.warningLowValue,cL:T.criticalLowValue};var p={m1:m,v1:v,c1:h,m2:d,v2:f,c2:j,m3:e,v3:g,c3:l};var C=t.oDualComparisonView.oGenericTile.getTileContent()[0].getContent();var q=t.oDualComparisonView.oGenericTile.getTileContent()[1].getContent();sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(C,"NT",o);sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(q,"COMP",p);},this.logError);}},flowWithDesignTimeCall:function(){var t=this;try{var a=sap.ushell.components.tiles.indicatorTileUtils.cache.getEvaluationById(this.oConfig.EVALUATION.ID);if(a){t.oConfig.EVALUATION_FILTERS=a.EVALUATION_FILTERS;t.flowWithoutDesignTimeCall();}else{sap.ushell.components.tiles.indicatorTileUtils.util.getFilterFromRunTimeService(this.oConfig,function(f){t.oConfig.EVALUATION_FILTERS=f;sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();});}}catch(e){this.logError(e);}},fetchKpiValue:function(s,E){var t=this;try{var u=this.oConfig.EVALUATION.ODATA_URL;var a=this.oConfig.EVALUATION.ODATA_ENTITYSET;if(this.oConfig.TILE_PROPERTIES.semanticMeasure){var m=this.oConfig.EVALUATION.COLUMN_NAME+","+this.oConfig.TILE_PROPERTIES.semanticMeasure;}else{var m=this.oConfig.EVALUATION.COLUMN_NAME;var b=m;if(this.oConfig.TILE_PROPERTIES.COLUMN_NAMES){for(var j=0;j<this.oConfig.TILE_PROPERTIES.COLUMN_NAMES.length;j++){if(this.oConfig.TILE_PROPERTIES.COLUMN_NAMES[j].COLUMN_NAME!=this.oConfig.EVALUATION.COLUMN_NAME){b=b+","+this.oConfig.TILE_PROPERTIES.COLUMN_NAMES[j].COLUMN_NAME;}}}}var d=this.oConfig.EVALUATION_VALUES;var c=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(!c){var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.oConfig.EVALUATION_FILTERS,this.oConfig.ADDITIONAL_FILTERS);var o={};o["0"]=m+",asc";o["1"]=m+",desc";var f=o[this.oConfig.TILE_PROPERTIES.sortOrder||"0"].split(",");var g=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oChip.url.addSystemToServiceUrl(u),a,b,null,v,3);if(this.oConfig.TILE_PROPERTIES.semanticMeasure){g.uri+="&$orderby="+f[0]+" "+f[2];}else{g.uri+="&$orderby="+f[0]+" "+f[1];}this.writeData={};this.comparisionChartODataRef=g.model.read(g.uri,null,null,true,function(d){if(d&&d.results&&d.results.length){if(g.unit){t.writeData.unit=g.unit;}t.oConfig.TILE_PROPERTIES.FINALVALUE=d;t.oConfig.TILE_PROPERTIES.FINALVALUE=t._processDataForComparisonChart(t.oConfig.TILE_PROPERTIES.FINALVALUE,b.split(",")[0],g.unit);t.writeData.data=d;var k,l;for(var i=0;i<t.oConfig.TILE_PROPERTIES.FINALVALUE.length;i++){if(t.oConfig.TILE_PROPERTIES.FINALVALUE[i].title==t.DEFINITION_DATA.EVALUATION.COLUMN_NAME){t.writeData.numericData=t.oConfig.TILE_PROPERTIES.FINALVALUE[i];calculatedValueforScaling=t.oConfig.TILE_PROPERTIES.FINALVALUE[i].value;t.getTrendIndicator(t.setThresholdValues().trendValue,calculatedValueforScaling);t._updateTileModel({valueColor:t.oConfig.TILE_PROPERTIES.FINALVALUE[i].color,value:sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(l),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION).toString()});break;}}sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,t.writeData);s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else if(d.results.length==0){t.oConfig.TILE_PROPERTIES.FINALVALUE=d;t.writeData.data=d;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,t.writeData);s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else{E.call(t,"no Response from QueryServiceUri");}},function(i){if(i&&i.response){jQuery.sap.log.error(i.message+" : "+i.request.requestUri);E.call(t,i);}});if(!t.writeData.numericData){var h=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(t.DEFINITION_DATA.EVALUATION_FILTERS,t.DEFINITION_DATA.ADDITIONAL_FILTERS);var q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oChip.url.addSystemToServiceUrl(u),a,m,null,h);if(q){t.QUERY_SERVICE_MODEL=q.model;t.queryUriForKpiValue=q.uri;t.numericODataReadRef=t.QUERY_SERVICE_MODEL.read(q.uri,null,null,true,function(d){if(d&&d.results&&d.results.length){if(q.unit){t._updateTileModel({unitNumeric:d.results[0][q.unit.name]});t.writeData.unitNumeric=q.unit;t.writeData.unitNumeric.name=q.unit.name;}t.writeData.numericData=d.results[0];t.DEFINITION_DATA.value=t.writeData.numericData[t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];t.writeData.numericData.color=t.getTrendColor(t.setThresholdValues());t.DEFINITION_DATA.valueColor=t.writeData.numericData.color;var S="";var i=d.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];var k=t.getTrendIndicator(t.setThresholdValues().trendValue,i);if(t.oConfig.EVALUATION.SCALING==-2){i*=100;t.getView().oNumericContent.setFormatterValue(false);}S=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(i),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);if(t.oConfig.EVALUATION.SCALING==-2){t._updateTileModel({scale:"%"});}t._updateTileModel({value:S.toString(),valueColor:t.writeData.numericData.color,indicator:k});}else{E.call(t,"no Response from QueryServiceUri");}});}}}else{if(c.unit){t._updateTileModel({unit:c.data.results[0][c.unit.name]});}if(c.data&&c.data.results&&c.data.results.length){t.oConfig.TILE_PROPERTIES.FINALVALUE=c.data;t._updateTileModel({value:c.data.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME]});t.oConfig.TILE_PROPERTIES.FINALVALUE=t._processDataForComparisonChart(t.oConfig.TILE_PROPERTIES.FINALVALUE,b,t.writeData.unit);s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else if(d.results.length==0){t.oConfig.TILE_PROPERTIES.FINALVALUE=c.data;s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else{E.call(t,"no Response from QueryServiceUri");}}}catch(e){E.call(t,e);}},formSelectStatement:function(o){var t=Object.keys(o);var f="";for(var i=0;i<t.length;i++){if((o[t[i]]!==undefined)&&(o.fullyFormedMeasure)){f+=","+o[t[i]];}}return f;},getTrendIndicator:function(t,v){var a=this;t=Number(t);try{var b=sap.suite.ui.commons.DeviationIndicator.None;if(t>v){b=sap.suite.ui.commons.DeviationIndicator.Down;}else if(t<v){b=sap.suite.ui.commons.DeviationIndicator.Up;}return b;}catch(e){a.logError(e);}},getTrendColor:function(t){var a=this;var c,w,b,d;try{var i=this.DEFINITION_DATA.EVALUATION.GOAL_TYPE;var r=sap.suite.ui.commons.InfoTileValueColor.Neutral;if(i==="MI"){if(t.criticalHighValue&&t.warningHighValue){c=Number(t.criticalHighValue);w=Number(t.warningHighValue);if(this.CALCULATED_KPI_VALUE<w){r=sap.suite.ui.commons.InfoTileValueColor.Good;}else if(this.CALCULATED_KPI_VALUE<=c){r=sap.suite.ui.commons.InfoTileValueColor.Critical;}else{r=sap.suite.ui.commons.InfoTileValueColor.Error;}}}else if(i==="MA"){if(t.criticalLowValue&&t.warningLowValue){b=Number(t.criticalLowValue);d=Number(t.warningLowValue);if(this.CALCULATED_KPI_VALUE<b){r=sap.suite.ui.commons.InfoTileValueColor.Error;}else if(this.CALCULATED_KPI_VALUE<=d){r=sap.suite.ui.commons.InfoTileValueColor.Critical;}else{r=sap.suite.ui.commons.InfoTileValueColor.Good;}}}else{if(t.warningLowValue&&t.warningHighValue&&t.criticalLowValue&&t.criticalHighValue){c=Number(t.criticalHighValue);w=Number(t.warningHighValue);d=Number(t.warningLowValue);b=Number(t.criticalLowValue);if(this.CALCULATED_KPI_VALUE<b||this.CALCULATED_KPI_VALUE>c){r=sap.suite.ui.commons.InfoTileValueColor.Error;}else if((this.CALCULATED_KPI_VALUE>=b&&this.CALCULATED_KPI_VALUE<=d)||(this.CALCULATED_KPI_VALUE>=w&&this.CALCULATED_KPI_VALUE<=c)){r=sap.suite.ui.commons.InfoTileValueColor.Critical;}else{r=sap.suite.ui.commons.InfoTileValueColor.Good;}}}return r;}catch(e){a.logError(e);}},_processDataForComparisonChart:function(d,m,u){var f=[],L={},i,t,l;var a;var T=[];var b=this;for(i=0;i<d.results.length;i++){var e=d.results[i];}T=sap.ushell.components.tiles.indicatorTileUtils.util.getAllMeasuresWithLabelText(this.oConfig.EVALUATION.ODATA_URL,this.oConfig.EVALUATION.ODATA_ENTITYSET);for(i=0,l=T.length;i<l;i++){t=T[i];L[t.key]=t.value;}var c=b.oConfig.TILE_PROPERTIES.COLUMN_NAMES||b.oConfig.EVALUATION.COLUMN_NAMES;for(i=0;i<c.length;i++){var g={};var h=c[i];g.value=Number(e[h.COLUMN_NAME]);var j=Number(e[h.COLUMN_NAME]);if(b.oConfig.EVALUATION.SCALING==-2){j*=100;}a=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(j,b.oConfig.EVALUATION.SCALING,b.oConfig.EVALUATION.DECIMAL_PRECISION);if(b.oConfig.EVALUATION.SCALING==-2){a+=" %";}g.displayValue=a.toString();if(u[i]&&e[u[i].name]){g.displayValue+=" "+e[u[i].name];}g.color=h.semanticColor;g.title=L[h.COLUMN_NAME]||h.COLUMN_NAME;f.push(g);}return f;},setThresholdValues:function(){var t=this;try{var T={};T.fullyFormedMeasure=this.DEFINITION_DATA.EVALUATION.COLUMN_NAME;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){switch(this.DEFINITION_DATA.EVALUATION.GOAL_TYPE){case"MI":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"MA":T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"RA":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;}}else{T.criticalHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","FIXED");T.criticalLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","FIXED");T.warningHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","FIXED");T.warningLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","FIXED");T.targetValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","FIXED");T.trendValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","FIXED");}return T;}catch(e){t.logError(e);}},logError:function(e){this.oDualComparisonView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Failed);this.oDualComparisonView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Failed);sap.ushell.components.tiles.indicatorTileUtils.util.logError(e);},refreshHandler:function(c){if(!c.firstTimeVisible){if(Number(this.oChip.configuration.getParameterValueAsString("isSufficient"))){c.flowWithoutDesignTimeCall();}else{c.flowWithDesignTimeCall();}}},visibleHandler:function(i){if(!i){this.firstTimeVisible=false;sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.comparisionChartODataRef);}if(i){this.refreshHandler(this);}},onExit:function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.comparisionChartODataRef);}});sap.ui.controller("tiles.indicatorDualContribution.DualContribution",{onInit:function(){var t=this;t.writeData={};this.firstTimeVisible=false;this.oDualContributionView=this.getView();this.oChip=this.oDualContributionView.getViewData().chip;if(this.oChip.visible){this.oChip.visible.attachVisible(this.visibleHandler.bind(this));}this.system=this.oChip.url.getApplicationSystem();this.oDualContributionView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loading);try{sap.ushell.components.tiles.indicatorTileUtils.util.getParsedChip(this.oChip.configuration.getParameterValueAsString("tileConfiguration"),function(c){t.oConfig=c;if(t.oChip.preview){t.oChip.preview.setTargetUrl(sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system));}if(t.oChip.preview.isEnabled()){t.setTitle();t._updateTileModel({value:8888,size:sap.suite.ui.commons.InfoTileSize.Auto,frameType:"TwoByOne",state:sap.suite.ui.commons.LoadState.Loading,valueColor:sap.suite.ui.commons.InfoTileValueColor.Error,indicator:sap.suite.ui.commons.DeviationIndicator.None,title:"US Profit Margin",footer:"Current Quarter",description:"Maximum deviation",data:[{title:"Americas",value:10,color:"Neutral",displayValue:""},{title:"EMEA",value:50,color:"Neutral",displayValue:""},{title:"APAC",value:-20,color:"Neutral",displayValue:""}]});t.oDualContributionView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);}else{t.oConfig.TILE_PROPERTIES.FINALVALUE;t.setTitle();t.oDualContributionView.oGenericTile.attachPress(function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(t.comparisionChartODataRef);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,null);window.location.hash=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);});if(Number(t.oChip.configuration.getParameterValueAsString("isSufficient"))){sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();}else{t.flowWithDesignTimeCall();}}});}catch(e){this.logError(e);}},getTile:function(){return this.oDualContributionView.oGenericTile;},setTitle:function(){var t=this;var a=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.oChip);this._updateTileModel({header:a.title||sap.ushell.components.tiles.indicatorTileUtils.util.getChipTitle(t.oConfig),subheader:a.subTitle||sap.ushell.components.tiles.indicatorTileUtils.util.getChipSubTitle(t.oConfig)});},_updateTileModel:function(n){var m=this.getTile().getModel().getData();jQuery.extend(m,n);this.getTile().getModel().setData(m);this.getTile().getModel().updateBindings();},flowWithoutDesignTimeCall:function(){var t=this;this.DEFINITION_DATA=this.oConfig;this._updateTileModel(this.DEFINITION_DATA);if(this.oChip.visible.isVisible()&&!this.firstTimeVisible){this.firstTimeVisible=true;this.fetchKpiValue(function(k,c){this.CALCULATED_KPI_VALUE=k;if(t.oConfig.TILE_PROPERTIES.frameType=="TwoByOne"){t.oDualContributionView.oGenericTile.setFrameType("TwoByOne");t.oDualContributionView.oGenericTile.removeAllTileContent();t.oDualContributionView.oGenericTile.addTileContent(t.oDualContributionView.oNumericTile);t.oDualContributionView.oGenericTile.addTileContent(t.oDualContributionView.oComparisonTile);}else{t.oDualContributionView.oGenericTile.setFrameType("OneByOne");t.oDualContributionView.oGenericTile.removeAllTileContent();t.oDualContributionView.oGenericTile.addTileContent(t.oDualContributionView.oComparisonTile);}var d=this.CALCULATED_KPI_VALUE;var a=this.DEFINITION_DATA.TILE_PROPERTIES.semanticColorContribution;for(var i=0;i<this.CALCULATED_KPI_VALUE.length;i++){d[i].color=a;}this._updateTileModel({data:d});var T=t.setThresholdValues();var n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);t.oDualContributionView.oGenericTile.$().wrap("<a href ='"+n+"'/>");this.oDualContributionView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);var s="";if(a=="Error"){s="sb.error";}if(a=="Neutral"){s="sb.neutral";}if(a=="Critical"){s="sb.critical";}if(a=="Good"){s="sb.good";}var T=t.setThresholdValues();var m,b,e,v,f,g,h,j,l;if(this.CALCULATED_KPI_VALUE&&this.CALCULATED_KPI_VALUE[0]){m=this.CALCULATED_KPI_VALUE[0].title;v=this.CALCULATED_KPI_VALUE[0].value;h=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(this.CALCULATED_KPI_VALUE[0].color);}if(this.CALCULATED_KPI_VALUE&&this.CALCULATED_KPI_VALUE[1]){b=this.CALCULATED_KPI_VALUE[1].title;f=this.CALCULATED_KPI_VALUE[1].value;j=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(this.CALCULATED_KPI_VALUE[1].color);}if(this.CALCULATED_KPI_VALUE&&this.CALCULATED_KPI_VALUE[2]){e=this.CALCULATED_KPI_VALUE[2].title;g=this.CALCULATED_KPI_VALUE[2].value;l=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(this.CALCULATED_KPI_VALUE[2].color);}var o={status:s,actual:c,target:T.targetValue,cH:T.criticalHighValue,wH:T.warningHighValue,wL:T.warningLowValue,cL:T.criticalLowValue};var p={m1:m,v1:v,c1:h,m2:b,v2:f,c2:j,m3:e,v3:g,c3:l};var C=t.oDualContributionView.oGenericTile.getTileContent()[0].getContent();var q=t.oDualContributionView.oGenericTile.getTileContent()[1].getContent();sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(C,"NT",o);sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(q,"CONT",p);},this.logError);}},flowWithDesignTimeCall:function(){var t=this;try{var a=sap.ushell.components.tiles.indicatorTileUtils.cache.getEvaluationById(this.oConfig.EVALUATION.ID);if(a){t.oConfig.EVALUATION_FILTERS=a.EVALUATION_FILTERS;t.flowWithoutDesignTimeCall();}else{sap.ushell.components.tiles.indicatorTileUtils.util.getFilterFromRunTimeService(this.oConfig,function(f){t.oConfig.EVALUATION_FILTERS=f;sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();});}}catch(e){this.logError(e);}},fetchKpiValue:function(s,E){var t=this;try{var u=this.oConfig.EVALUATION.ODATA_URL;var a=this.oConfig.EVALUATION.ODATA_ENTITYSET;if(this.oConfig.TILE_PROPERTIES.semanticMeasure){var m=this.oConfig.EVALUATION.COLUMN_NAME+","+this.oConfig.TILE_PROPERTIES.semanticMeasure;}else{var m=this.oConfig.EVALUATION.COLUMN_NAME;}var d=this.oConfig.TILE_PROPERTIES.dimension;var b=this.oConfig.EVALUATION_VALUES;var c=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(!c){var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.oConfig.EVALUATION_FILTERS,this.oConfig.ADDITIONAL_FILTERS);var o={};o["0"]=m+",asc";o["1"]=m+",desc";o["2"]=d+",asc";o["3"]=d+",desc";var f=o[this.oConfig.TILE_PROPERTIES.sortOrder||"0"].split(",");var g=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oChip.url.addSystemToServiceUrl(u),a,m,d,v,3);if(this.oConfig.TILE_PROPERTIES.semanticMeasure){g.uri+="&$top=3&$orderby="+f[0]+" "+f[2];}else{g.uri+="&$top=3&$orderby="+f[0]+" "+f[1];}this.comparisionChartODataRef=g.model.read(g.uri,null,null,true,function(b){if(g.unit[0]){t._updateTileModel({unitContribution:b.results[0][g.unit[0].name]});t.writeData.unitContribution=g.unit[0];t.writeData.unitContribution.name=g.unit[0].name;}if(b&&b.results&&b.results.length){d=sap.ushell.components.tiles.indicatorTileUtils.util.findTextPropertyForDimension(t.oChip.url.addSystemToServiceUrl(u),a,d);t.writeData.dimension=d;t.oConfig.TILE_PROPERTIES.FINALVALUE=b;t.oConfig.TILE_PROPERTIES.FINALVALUE=t._processDataForComparisonChart(t.oConfig.TILE_PROPERTIES.FINALVALUE,m.split(",")[0],d);t.writeData.data=b;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,t.writeData);s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else if(b.results.length==0){t.oConfig.TILE_PROPERTIES.FINALVALUE=b;t.writeData.data=b;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,t.writeData);}else{E.call(t,"no Response from QueryServiceUri");}},function(k){if(k&&k.response){jQuery.sap.log.error(k.message+" : "+k.request.requestUri);E.call(t,k);}});var h=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(t.DEFINITION_DATA.EVALUATION_FILTERS,t.DEFINITION_DATA.ADDITIONAL_FILTERS);var q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oChip.url.addSystemToServiceUrl(u),a,m,null,h);if(q){t.QUERY_SERVICE_MODEL=q.model;t.queryUriForKpiValue=q.uri;t.numericODataReadRef=t.QUERY_SERVICE_MODEL.read(q.uri,null,null,true,function(b){if(b&&b.results&&b.results.length){if(q.unit){t._updateTileModel({unitNumeric:b.results[0][q.unit.name]});t.writeData.unitNumeric=q.unit;t.writeData.unitNumeric.name=q.unit.name;}t.writeData.numericData=b;var S="";var i=b.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];var j=t.getTrendIndicator(t.setThresholdValues().trendValue,i);if(t.oConfig.EVALUATION.SCALING==-2){i*=100;t.getView().oNumericContent.setFormatterValue(false);}t.DEFINITION_DATA.value=i;S=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(i),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);if(t.oConfig.EVALUATION.SCALING==-2){t._updateTileModel({scale:"%"});}t._updateTileModel({value:S.toString(),valueColor:t.DEFINITION_DATA.TILE_PROPERTIES.semanticColorContribution,indicator:j});s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE,i);}else{E.call(t,"no Response from QueryServiceUri");}});}}else{var T=t.setThresholdValues();var i;if(c.unitContribution){t._updateTileModel({unitContribution:c.data.results[0][c.unitContribution.name]});}if(c.unitNumeric){t._updateTileModel({unitNumeric:c.numericData.results[0][c.unitNumeric.name]});}if(c.data&&c.data.results&&c.data.results.length){d=c.dimension;t.oConfig.TILE_PROPERTIES.FINALVALUE=c.data;t.oConfig.TILE_PROPERTIES.FINALVALUE=t._processDataForComparisonChart(t.oConfig.TILE_PROPERTIES.FINALVALUE,m.split(",")[0],d);s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else if(b.results.length==0){t.oConfig.TILE_PROPERTIES.FINALVALUE=c.data;}else{E.call(t,"no Response from QueryServiceUri");}if(c.numericData&&c.numericData.results&&c.numericData.results.length){i=c.numericData.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];if(t.oConfig.EVALUATION.SCALING==-2){i*=100;t.getView().oNumericContent.setFormatterValue(false);}var S=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(i),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);if(t.oConfig.EVALUATION.SCALING==-2){t._updateTileModel({scale:"%"});}var j=t.getTrendIndicator(T.trendValue,i);t._updateTileModel({value:S.toString(),indicator:j,valueColor:t.DEFINITION_DATA.TILE_PROPERTIES.semanticColorContribution});s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE,i);}else{E.call(t,"no Response from QueryServiceUri");}}}catch(e){E.call(t,e);}},setThresholdValues:function(){var t=this;try{var T={};T.fullyFormedMeasure=this.DEFINITION_DATA.EVALUATION.COLUMN_NAME;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){switch(this.DEFINITION_DATA.EVALUATION.GOAL_TYPE){case"MI":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"MA":T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"RA":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;}}else{T.criticalHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","FIXED");T.criticalLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","FIXED");T.warningHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","FIXED");T.warningLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","FIXED");T.targetValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","FIXED");T.trendValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","FIXED");}return T;}catch(e){t.logError(e);}},formSelectStatement:function(o){var t=Object.keys(o);var f="";for(var i=0;i<t.length;i++){if((o[t[i]]!==undefined)&&(o.fullyFormedMeasure)){f+=","+o[t[i]];}}return f;},getTrendIndicator:function(t,v){var a=this;t=Number(t);try{var b=sap.suite.ui.commons.DeviationIndicator.None;if(t>v){b=sap.suite.ui.commons.DeviationIndicator.Down;}else if(t<v){b=sap.suite.ui.commons.DeviationIndicator.Up;}return b;}catch(e){a.logError(e);}},_processDataForComparisonChart:function(d,m,a){var s=this.oConfig.TILE_PROPERTIES.semanticMeasure;var f=[];var t;for(var i=0;i<d.results.length;i++){var b=d.results[i];var c={};try{c.title=b[a].toString();}catch(e){c.title="";}c.value=Number(b[m]);var g=Number(b[m]);if(this.oConfig.EVALUATION.SCALING==-2){g*=100;}t=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(g,this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION);c.displayValue=t.toString();if(typeof s==='undefined'){c.color="Neutral";}else{if(this.oConfig.EVALUATION.GOAL_TYPE==="MA"){if(c.value>b[s]){c.color="Good";}else{c.color="Error";}}else if(this.oConfig.EVALUATION.GOAL_TYPE==="MI"){if(c.value<b[s]){c.color="Good";}else{c.color="Error";}}else{c.color="Neutral";}}f.push(c);}return f;},logError:function(e){this.oDualContributionView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Failed);this.oDualContributionView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Failed);sap.ushell.components.tiles.indicatorTileUtils.util.logError(e);},refreshHandler:function(c){if(!c.firstTimeVisible){if(Number(this.oChip.configuration.getParameterValueAsString("isSufficient"))){c.flowWithoutDesignTimeCall();}else{c.flowWithDesignTimeCall();}}},visibleHandler:function(i){if(!i){this.firstTimeVisible=false;sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.comparisionChartODataRef);}if(i){this.refreshHandler(this);}},onExit:function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.comparisionChartODataRef);}});(function(){"use strict";sap.ui.controller("tiles.indicatorDualDeviation.DualDeviation",{onInit:function(){var t=this;this.firstTimeVisible=false;this.oDualDeviationView=this.getView();this.oViewData=this.oDualDeviationView.getViewData();this.oTileApi=this.oViewData.chip;if(this.oTileApi.visible){this.oTileApi.visible.attachVisible(this.visibleHandler.bind(this));}this.system=this.oTileApi.url.getApplicationSystem();this.oDualDeviationView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loading);try{sap.ushell.components.tiles.indicatorTileUtils.util.getParsedChip(t.oTileApi.configuration.getParameterValueAsString("tileConfiguration"),function(c){t.oConfig=c;t.setTextInTile();if(t.oTileApi.preview){t.oTileApi.preview.setTargetUrl(sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system));}if(t.oTileApi.preview.isEnabled()){t._updateTileModel({valueColor:"Good",value:100,frameType:"TwoByOne",unit:"USD",actual:{value:120,color:sap.suite.ui.commons.InfoTileValueColor.Good},targetValue:100,thresholds:[{value:0,color:sap.suite.ui.commons.InfoTileValueColor.Error},{value:50,color:sap.suite.ui.commons.InfoTileValueColor.Critical},{value:150,color:sap.suite.ui.commons.InfoTileValueColor.Critical},{value:200,color:sap.suite.ui.commons.InfoTileValueColor.Error}],showActualValue:true,showTargetValue:true});t.oDualDeviationView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);}else{t.oDualDeviationView.oGenericTile.attachPress(function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(t.queryServiceUriODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,null);window.location.hash=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);});if(Number(t.oTileApi.configuration.getParameterValueAsString("isSufficient"))){sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();}else{t.flowWithDesignTimeCall();}}});}catch(e){this.logError(e);}},_setLocalModelToTile:function(){if(!this.getTile().getModel()){this.getTile().setModel(new sap.ui.model.json.JSONModel({}));}},getTile:function(){return this.oDualDeviationView.oGenericTile;},_updateTileModel:function(n){var m=this.getTile().getModel().getData();jQuery.extend(m,n);this.getTile().getModel().setData(m);},fetchKpiValue:function(s,E){var t=this;var k=0;try{var u=this.DEFINITION_DATA.EVALUATION.ODATA_URL;var a=this.DEFINITION_DATA.EVALUATION.ODATA_ENTITYSET;var T=this.setThresholdValues();var m=T.fullyFormedMeasure;var c=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(!c){var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.DEFINITION_DATA.EVALUATION_FILTERS,this.DEFINITION_DATA.ADDITIONAL_FILTERS);var q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oTileApi.url.addSystemToServiceUrl(u),a,m,null,v);if(q){this.QUERY_SERVICE_MODEL=q.model;this.queryUriForKpiValue=q.uri;try{this.queryServiceUriODataReadRef=this.QUERY_SERVICE_MODEL.read(q.uri,null,null,true,function(f){t.writeData={};if(f&&f.results&&f.results.length){k=f.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];if(q.unit[0]){t._updateTileModel({unit:f.results[0][q.unit[0].name]});t.writeData.unit=q.unit[0];t.writeData.unit.name=q.unit[0].name;}t.writeData.numericData=f;var S="",d;var b=k;if(t.oConfig.EVALUATION.SCALING==-2){b*=100;t.getView().oNumericContent.setFormatterValue(false);}S=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(b),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);d=t.getTrendIndicator(T.trendValue,b);if(t.oConfig.EVALUATION.SCALING==-2){t._updateTileModel({scale:"%"});}t._updateTileModel({value:S.toString(),indicator:d,valueColor:t.getThresholdsObjAndColor(T).returnColor});t.writeData.data=f;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,t.writeData);if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){T.criticalHighValue=f.results[0][T.sCriticalHigh];T.criticalLowValue=f.results[0][T.sCriticalLow];T.warningHighValue=f.results[0][T.sWarningHigh];T.warningLowValue=f.results[0][T.sWarningLow];T.targetValue=f.results[0][T.sTarget];T.trendValue=f.results[0][T.sTrend];}s.call(t,k,T);}else{E.call(t,"no Response from QueryServiceUri");}},function(f){if(f&&f.response){E.call(t,f.message);}});}catch(e){t.logError("Error in Query Service URI");}}}else{if(c.data&&c.data.results&&c.data.results.length){var b,S,d,T;T=t.setThresholdValues();b=c.data.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];if(t.oConfig.EVALUATION.SCALING==-2){b*=100;t.getView().oNumericContent.setFormatterValue(true);}if(t.oConfig.EVALUATION.SCALING==-2){t._updateTileModel({scale:"%"});}S=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(b),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);d=t.getTrendIndicator(T.trendValue,b);if(c.unit){t._updateTileModel({unit:c.data.results[0][c.unit.name]});}t._updateTileModel({indicator:d,value:S.toString()});if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){T.criticalHighValue=c.data.results[0][T.sCriticalHigh];T.criticalLowValue=c.data.results[0][T.sCriticalLow];T.warningHighValue=c.data.results[0][T.sWarningHigh];T.warningLowValue=c.data.results[0][T.sWarningLow];T.targetValue=c.data.results[0][T.sTarget];T.trendValue=c.data.results[0][T.sTrend];}s.call(t,c.data.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME],T);}else{E.call(t,"no Response from QueryServiceUri");}}}catch(e){E.call(t,e);}},getTrendIndicator:function(t,v){var a=this;t=Number(t);try{var b=sap.suite.ui.commons.DeviationIndicator.None;if(t>v){b=sap.suite.ui.commons.DeviationIndicator.Down;}else if(t<v){b=sap.suite.ui.commons.DeviationIndicator.Up;}return b;}catch(e){a.logError(e);}},getThresholdsObjAndColor:function(t){try{var T={};T.arrObj=[];T.returnColor=sap.suite.ui.commons.InfoTileValueColor.Neutral;var i=this.DEFINITION_DATA.EVALUATION.GOAL_TYPE;var w,c,a,b;if(i==="MI"){a=Number(t.criticalHighValue)||0;b=Number(t.warningHighValue)||0;if(a&&b){a=window.parseFloat(a);b=window.parseFloat(b);T.arrObj.push({value:a,color:sap.suite.ui.commons.InfoTileValueColor.Error});T.arrObj.push({value:b,color:sap.suite.ui.commons.InfoTileValueColor.Critical});if(this.CALCULATED_KPI_VALUE<b){T.returnColor=sap.suite.ui.commons.InfoTileValueColor.Good;}else if(this.CALCULATED_KPI_VALUE<=a){T.returnColor=sap.suite.ui.commons.InfoTileValueColor.Critical;}else{T.returnColor=sap.suite.ui.commons.InfoTileValueColor.Error;}}}else if(i==="MA"){c=Number(t.criticalLowValue)||0;w=Number(t.warningLowValue)||0;if(c&&w){c=window.parseFloat(c);w=window.parseFloat(w);T.arrObj.push({value:c,color:sap.suite.ui.commons.InfoTileValueColor.Error});T.arrObj.push({value:w,color:sap.suite.ui.commons.InfoTileValueColor.Critical});if(this.CALCULATED_KPI_VALUE<c){T.returnColor=sap.suite.ui.commons.InfoTileValueColor.Error;}else if(this.CALCULATED_KPI_VALUE<=w){T.returnColor=sap.suite.ui.commons.InfoTileValueColor.Critical;}else{T.returnColor=sap.suite.ui.commons.InfoTileValueColor.Good;}}}else{a=Number(t.criticalHighValue)||0;b=Number(t.warningHighValue)||0;c=Number(t.criticalLowValue)||0;w=Number(t.warningLowValue)||0;if(w&&b&&c&&c){a=window.parseFloat(a);b=window.parseFloat(b);w=window.parseFloat(w);c=window.parseFloat(c);T.arrObj.push({value:a,color:sap.suite.ui.commons.InfoTileValueColor.Error});T.arrObj.push({value:b,color:sap.suite.ui.commons.InfoTileValueColor.Critical});T.arrObj.push({value:w,color:sap.suite.ui.commons.InfoTileValueColor.Critical});T.arrObj.push({value:c,color:sap.suite.ui.commons.InfoTileValueColor.Error});if(this.CALCULATED_KPI_VALUE<c||this.CALCULATED_KPI_VALUE>a){T.returnColor=sap.suite.ui.commons.InfoTileValueColor.Error;}else if((this.CALCULATED_KPI_VALUE>=c&&this.CALCULATED_KPI_VALUE<=w)||(this.CALCULATED_KPI_VALUE>=b&&this.CALCULATED_KPI_VALUE<=a)){T.returnColor=sap.suite.ui.commons.InfoTileValueColor.Critical;}else{T.returnColor=sap.suite.ui.commons.InfoTileValueColor.Good;}}}return T;}catch(e){this.logError(e);}},flowWithoutDesignTimeCall:function(){var t=this;var f,a;this.DEFINITION_DATA=this.oConfig;this._updateTileModel(this.DEFINITION_DATA);if(this.oTileApi.visible.isVisible()&&!this.firstTimeVisible){this.firstTimeVisible=true;this.fetchKpiValue(function(k,b){var c=Number(k);if(this.oConfig.EVALUATION.SCALING==-2){c*=100;}f=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(c),this.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);this.CALCULATED_KPI_VALUE=Number(k);var d={};var e=this.getThresholdsObjAndColor(b);var g={value:Number(k),color:e.returnColor};d.valueColor=g.color;d.actualValueLabel=f.toString();d.actual=g;var h=this.DEFINITION_DATA.EVALUATION_VALUES;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){var i=Number(b.targetValue);if(this.oConfig.EVALUATION.SCALING==-2){i*=100;}a=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(i,this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION);d.targetValue=Number(b.targetValue);d.targetValueLabel=a.toString();}else{for(var j=0;j<h.length;j++){if(h[j].TYPE==="TA"){var i=Number(h[j].FIXED);if(this.oConfig.EVALUATION.SCALING==-2){i*=100;}a=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(i);d.targetValue=Number(h[j].FIXED);d.targetValueLabel=a.toString();}}}this._updateTileModel(d);var n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);t.oDualDeviationView.oGenericTile.$().wrap("<a href ='"+n+"'/>");this.oDualDeviationView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);var s="";if(d.valueColor=="Error"){s="sb.error";}if(d.valueColor=="Neutral"){s="sb.neutral";}if(d.valueColor=="Critical"){s="sb.critical";}if(d.valueColor=="Good"){s="sb.good";}var v={status:s,actual:c,target:b.targetValue,cH:b.criticalHighValue,wH:b.warningHighValue,wL:b.warningLowValue,cL:b.criticalLowValue};var l=v;var C=t.oDualDeviationView.oGenericTile.getTileContent()[0].getContent();var o=t.oDualDeviationView.oGenericTile.getTileContent()[1].getContent();sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(C,"NT",v);sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(o,"DT",l);},this.logError);}},flowWithDesignTimeCall:function(){var t=this;try{var a=sap.ushell.components.tiles.indicatorTileUtils.cache.getEvaluationById(this.oConfig.EVALUATION.ID);if(a){t.oConfig.EVALUATION_FILTERS=a.EVALUATION_FILTERS;t.flowWithoutDesignTimeCall();}else{sap.ushell.components.tiles.indicatorTileUtils.util.getFilterFromRunTimeService(this.oConfig,function(f){t.oConfig.EVALUATION_FILTERS=f;sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();});}}catch(e){this.logError(e);}},setTextInTile:function(){var t=this;var a=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.oTileApi);this._updateTileModel({header:a.title||sap.ushell.components.tiles.indicatorTileUtils.util.getChipTitle(t.oConfig),subheader:a.subTitle||sap.ushell.components.tiles.indicatorTileUtils.util.getChipSubTitle(t.oConfig)});},logError:function(e){this.oDualDeviationView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Failed);this.oDualDeviationView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Failed);sap.ushell.components.tiles.indicatorTileUtils.util.logError(e);},setThresholdValues:function(){var t=this;var T={};T.fullyFormedMeasure=this.DEFINITION_DATA.EVALUATION.COLUMN_NAME;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){switch(this.DEFINITION_DATA.EVALUATION.GOAL_TYPE){case"MI":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"MA":T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"RA":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;}}else{T.criticalHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","FIXED");T.criticalLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","FIXED");T.warningHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","FIXED");T.warningLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","FIXED");T.targetValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","FIXED");T.trendValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","FIXED");}return T;},formSelectStatement:function(o){var t=Object.keys(o);var f="";for(var i=0;i<t.length;i++){if((o[t[i]]!==undefined)&&(o.fullyFormedMeasure)){f+=","+o[t[i]];}}return f;},refreshHandler:function(c){if(!c.firstTimeVisible){if(Number(this.oTileApi.configuration.getParameterValueAsString("isSufficient"))){c.flowWithoutDesignTimeCall();}else{c.flowWithDesignTimeCall();}}},visibleHandler:function(i){if(!i){this.firstTimeVisible=false;sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.queryServiceUriODataReadRef);}if(i){this.refreshHandler(this);}},onExit:function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.queryServiceUriODataReadRef);}});}());(function(){"use strict";sap.ui.controller("tiles.indicatorDualTrend.DualTrend",{onInit:function(){var t=this;this.firstTimeVisible=false;this.oDualTrendView=this.getView();this.oViewData=this.oDualTrendView.getViewData();this.oTileApi=this.oViewData.chip;if(this.oTileApi.visible){this.oTileApi.visible.attachVisible(this.visibleHandler.bind(this));}this.system=this.oTileApi.url.getApplicationSystem();this.oDualTrendView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loading);if(this.oTileApi.preview.isEnabled()){this.setTextInTile();this._updateTileModel({value:8888,size:sap.suite.ui.commons.InfoTileSize.Auto,frameType:"TwoByOne",state:sap.suite.ui.commons.LoadState.Loading,valueColor:sap.suite.ui.commons.InfoTileValueColor.Error,indicator:sap.suite.ui.commons.DeviationIndicator.None,title:"Liquidity Structure",footer:"Current Quarter",description:"Apr 1st 2013 (B$)",width:"100%",height:"100%",chart:{color:"Good",data:[{day:0,balance:0},{day:30,balance:20},{day:60,balance:20},{day:100,balance:80}]},target:{color:"Error",data:[{day:0,balance:0},{day:30,balance:30},{day:60,balance:40},{day:100,balance:90}]},maxThreshold:{color:"Good",data:[{day:0,balance:0},{day:30,balance:40},{day:60,balance:50},{day:100,balance:100}]},innerMaxThreshold:{color:"Error",data:[]},innerMinThreshold:{color:"Neutral",data:[]},minThreshold:{color:"Error",data:[{day:0,balance:0},{day:30,balance:20},{day:60,balance:30},{day:100,balance:70}]},minXValue:0,maxXValue:100,minYValue:0,maxYValue:100,firstXLabel:{label:"June 123",color:"Error"},lastXLabel:{label:"June 30",color:"Error"},firstYLabel:{label:"0M",color:"Good"},lastYLabel:{label:"80M",color:"Critical"},minLabel:{},maxLabel:{}});this.oDualTrendView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);}else{try{sap.ushell.components.tiles.indicatorTileUtils.util.getParsedChip(this.oTileApi.configuration.getParameterValueAsString("tileConfiguration"),function(c){t.oConfig=c;t.setTextInTile();t.oDualTrendView.oGenericTile.attachPress(function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(t.trendChartODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,null);window.location.hash=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);});if(Number(t.oTileApi.configuration.getParameterValueAsString("isSufficient"))){sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();}else{t.flowWithDesignTimeCall();}});}catch(e){this.logError(e);}}},getTile:function(){return this.oDualTrendView.oGenericTile;},_setLocalModelToTile:function(){if(!this.getTile().getModel()){this.getTile().setModel(new sap.ui.model.json.JSONModel({}));}},_updateTileModel:function(n){var m=this.getTile().getModel().getData();jQuery.extend(m,n);this.getTile().getModel().setData(m);},setThresholdValues:function(){var t=this;try{var T={};T.fullyFormedMeasure=this.DEFINITION_DATA.EVALUATION.COLUMN_NAME;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){switch(this.DEFINITION_DATA.EVALUATION.GOAL_TYPE){case"MI":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"MA":T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"RA":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;}}else{T.criticalHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","FIXED");T.criticalLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","FIXED");T.warningHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","FIXED");T.warningLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","FIXED");T.targetValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","FIXED");T.trendValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","FIXED");}return T;}catch(e){t.logError(e);}},getTrendIndicator:function(t,v){var a=this;t=Number(t);try{var b=sap.suite.ui.commons.DeviationIndicator.None;if(t>v){b=sap.suite.ui.commons.DeviationIndicator.Down;}else if(t<v){b=sap.suite.ui.commons.DeviationIndicator.Up;}return b;}catch(e){a.logError(e);}},formSelectStatement:function(o){var t=Object.keys(o);var f="";for(var i=0;i<t.length;i++){if((o[t[i]]!==undefined)&&(o.fullyFormedMeasure)){f+=","+o[t[i]];}}return f;},getTrendColor:function(t){var a=this;try{var i=this.DEFINITION_DATA.EVALUATION.GOAL_TYPE;var r=sap.suite.ui.commons.InfoTileValueColor.Neutral;if(i==="MI"){if(t.criticalHighValue&&t.warningHighValue){t.criticalHighValue=Number(t.criticalHighValue);t.warningHighValue=Number(t.warningHighValue);if(this.CALCULATED_KPI_VALUE<t.warningHighValue){r=sap.suite.ui.commons.InfoTileValueColor.Good;}else if(this.CALCULATED_KPI_VALUE<=t.criticalHighValue){r=sap.suite.ui.commons.InfoTileValueColor.Critical;}else{r=sap.suite.ui.commons.InfoTileValueColor.Error;}}}else if(i==="MA"){if(t.criticalLowValue&&t.warningLowValue){t.criticalLowValue=Number(t.criticalLowValue);t.warningLowValue=Number(t.warningLowValue);if(this.CALCULATED_KPI_VALUE<t.criticalLowValue){r=sap.suite.ui.commons.InfoTileValueColor.Error;}else if(this.CALCULATED_KPI_VALUE<=t.warningLowValue){r=sap.suite.ui.commons.InfoTileValueColor.Critical;}else{r=sap.suite.ui.commons.InfoTileValueColor.Good;}}}else{if(t.warningLowValue&&t.warningHighValue&&t.criticalLowValue&&t.criticalHighValue){t.criticalHighValue=Number(t.criticalHighValue);t.warningHighValue=Number(t.warningHighValue);t.warningLowValue=Number(t.warningLowValue);t.criticalLowValue=Number(t.criticalLowValue);if(this.CALCULATED_KPI_VALUE<t.criticalLowValue||this.CALCULATED_KPI_VALUE>t.criticalHighValue){r=sap.suite.ui.commons.InfoTileValueColor.Error;}else if((this.CALCULATED_KPI_VALUE>=t.criticalLowValue&&this.CALCULATED_KPI_VALUE<=t.warningLowValue)||(this.CALCULATED_KPI_VALUE>=t.warningHighValue&&this.CALCULATED_KPI_VALUE<=t.criticalHighValue)){r=sap.suite.ui.commons.InfoTileValueColor.Critical;}else{r=sap.suite.ui.commons.InfoTileValueColor.Good;}}}return r;}catch(e){a.logError(e);}},onAfterFinalEvaluation:function(){var t=this;var u=this.DEFINITION_DATA.EVALUATION.ODATA_URL;var E=this.DEFINITION_DATA.EVALUATION.ODATA_ENTITYSET;var m=this.DEFINITION_DATA.EVALUATION.COLUMN_NAME;var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.DEFINITION_DATA.EVALUATION_FILTERS,this.DEFINITION_DATA.ADDITIONAL_FILTERS);var d=this.DEFINITION_DATA.TILE_PROPERTIES.dimension;if(d==undefined){this.logError();return;}var g=this.DEFINITION_DATA.EVALUATION.GOAL_TYPE;var c=this.DEFINITION_DATA.EVALUATION_VALUES;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){var f=m;switch(g){case"MI":t.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");t.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");t.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");t.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");if(t.sWarningHigh&&t.sCriticalHigh&&t.sTarget){f+=","+t.sWarningHigh+","+t.sCriticalHigh+","+t.sTarget;}break;case"MA":t.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");t.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");t.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");t.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");if(t.sWarningLow&&t.sCriticalLow&&t.sTarget){f+=","+t.sWarningLow+","+t.sCriticalLow+","+t.sTarget;}break;case"RA":t.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");t.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");t.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");t.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");t.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");t.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");if(t.sWarningLow&&t.sCriticalLow&&t.sTarget&&t.sWarningHigh&&t.sCriticalHigh){f+=","+t.sWarningLow+","+t.sCriticalLow+","+t.sTarget+","+t.sWarningHigh+","+t.sCriticalHigh;}break;}var q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oTileApi.url.addSystemToServiceUrl(u),E,f,d,v);}else{var q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oTileApi.url.addSystemToServiceUrl(u),E,m,d,v);}var h=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(!h){if(q){this.queryUriForTrendChart=q.uri;t.writeData={};try{this.trendChartODataReadRef=q.model.read(q.uri,null,null,true,function(a){if(a&&a.results&&a.results.length){if(q.unit[0]){t.unit=a.results[0][q.unit[0].name];t.writeData.unit=q.unit[0];t.writeData.unit.name=q.unit[0].name;}t.queryUriResponseForTrendChart=a;d=sap.ushell.components.tiles.indicatorTileUtils.util.findTextPropertyForDimension(t.oTileApi.url.addSystemToServiceUrl(u),E,d);a.firstXlabel=a.results[0][d];a.lastXlabel=a.results[a.results.length-1][d];t.writeData.data=a;t.writeData.dimensionName=d;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,t.writeData);var n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);t.oDualTrendView.oGenericTile.$().wrap("<a href ='"+n+"'/>");t.oDualTrendView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);_(a,t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE);}else{t.logError("no Response from QueryServiceUri");}},function(a){if(a&&a.response){t.logError("Data call failed");}});}catch(e){t.logError(e);}}else{t.logError();}var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(t.DEFINITION_DATA.EVALUATION_FILTERS,t.DEFINITION_DATA.ADDITIONAL_FILTERS);var q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oTileApi.url.addSystemToServiceUrl(u),E,m,null,v);if(q){t.QUERY_SERVICE_MODEL=q.model;t.queryUriForKpiValue=q.uri;t.numericODataReadRef=t.QUERY_SERVICE_MODEL.read(q.uri,null,null,true,function(a){if(a&&a.results&&a.results.length){var s="";var j=a.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];t.writeData.numericData=a;if(t.oConfig.EVALUATION.SCALING==-2){j*=100;}s=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(j),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);if(t.oConfig.EVALUATION.SCALING==-2){t._updateTileModel({scale:"%"});}var k=t.getTrendIndicator(t.setThresholdValues().trendValue,j);t._updateTileModel({value:s.toString(),valueColor:t.getTrendColor(t.setThresholdValues()),indicator:k});}else{fnError.call(t,"no Response from QueryServiceUri");}});}}else{try{if(h.unit!==undefined){t.unit=h.data.results[0][h.unit.name];}t.queryUriResponseForTrendChart=h.data;d=h.dimensionName;var j=h.numericData.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];var k=t.getTrendIndicator(t.setThresholdValues().trendValue,h.data.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME]);var s=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(j),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);t.oDualTrendView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);_(h.data,t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE);t._updateTileModel({value:s.toString(),valueColor:t.getTrendColor(t.setThresholdValues()),indicator:k});}catch(e){t.logError(e);}}function _(l,n){var o=[];var p=[];var w=[];var r=[];var x=[];var y=[];var z=l.firstXlabel;var A,B,C,D,F;var G=l.lastXlabel;var H=Number(l.results[0][m]);var I=Number(l.results[l.results.length-1][m]);var i;for(i in l.results){l.results[i][d]=Number(i);l.results[i][m]=Number(l.results[i][m]);t.sWarningHigh?l.results[i][t.sWarningHigh]=Number(l.results[i][t.sWarningHigh]):"";t.sCriticalHigh?l.results[i][t.sCriticalHigh]=Number(l.results[i][t.sCriticalHigh]):"";t.sCriticalLow?l.results[i][t.sCriticalLow]=Number(l.results[i][t.sCriticalLow]):"";t.sWarningLow?l.results[i][t.sWarningLow]=Number(l.results[i][t.sWarningLow]):"";t.sTarget?l.results[i][t.sTarget]=Number(l.results[i][t.sTarget]):"";t.sWarningHigh?w.push(l.results[i][t.sWarningHigh]):"";t.sCriticalHigh?r.push(l.results[i][t.sCriticalHigh]):"";t.sCriticalLow?x.push(l.results[i][t.sCriticalLow]):"";t.sWarningLow?y.push(l.results[i][t.sWarningLow]):"";o.push(l.results[i][d]);p.push(l.results[i][m]);}try{z=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(z);G=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(G);}catch(e){t.logError(e);}var J=Number(H);if(t.oConfig.EVALUATION.SCALING==-2){J*=100;}var K=Math.min.apply(Math,p);var L=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(J,t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);if(t.oConfig.EVALUATION.SCALING==-2){L+=" %";}var M=L.toString();var N=Number(I);if(t.oConfig.EVALUATION.SCALING==-2){N*=100;}var O=Math.max.apply(Math,p);var P=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(N,t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);if(t.oConfig.EVALUATION.SCALING==-2){P+=" %";}var Q=P.toString();try{var R=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(Math.min.apply(Math,o));var S=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(Math.max.apply(Math,o));}catch(e){t.logError(e);}if(n=="MEASURE"){(w.length!=0)?(t.firstwH=w[R])&&(t.lastwH=w[S]):"";(r.length!=0)?(t.firstcH=r[R])&&(t.lastcH=r[S]):"";(x.length!=0)?(t.firstcL=x[R])&&(t.lastcL=x[S]):"";(y.length!=0)?(t.firstwL=y[R])&&(t.lastwL=y[S]):"";}var T={width:"100%",height:"100%",unit:t.unit||"",chart:{color:"Neutral",data:l.results},size:"Auto",minXValue:R,maxXValue:S,minYValue:K,maxYValue:O,firstXLabel:{label:z+"",color:"Neutral"},lastXLabel:{label:G+"",color:"Neutral"},firstYLabel:{label:M+"",color:"Neutral"},lastYLabel:{label:Q+"",color:"Neutral"},minLabel:{},maxLabel:{}};switch(g){case"MA":for(i in c){if(c[i].TYPE=="CL"){T.minThreshold={color:"Error"};var U={};U[d]="";U[m]=Number(c[i].FIXED);t.cl=Number(c[i].FIXED);T.minThreshold.data=(n=="MEASURE")?l.results:[U];A=(n=="MEASURE")?t.sCriticalLow:m;}else if(c[i].TYPE=="WL"){T.maxThreshold={color:"Good"};var U={};U[d]="";U[m]=Number(c[i].FIXED);T.maxThreshold.data=(n=="MEASURE")?l.results:[U];B=(n=="MEASURE")?t.sWarningLow:m;t.wl=Number(c[i].FIXED);}else if(c[i].TYPE=="TA"){var U={};U[d]="";U[m]=Number(c[i].FIXED);T.target={color:"Neutral"};T.target.data=(n=="MEASURE")?l.results:[U];F=(n=="MEASURE")?t.sTarget:m;}}T.innerMinThreshold={data:[]};T.innerMaxThreshold={data:[]};if(n=="FIXED"){T.firstYLabel.color=H<t.cl?"Error":((t.cl<=H)&&(H<=t.wl))?"Critical":(H>t.wl)?"Good":"Neutral";T.lastYLabel.color=I<t.cl?"Error":((t.cl<=I)&&(I<=t.wl))?"Critical":(I>t.wl)?"Good":"Neutral";}else if(n=="MEASURE"&&t.firstwL&&t.lastwL&&t.firstcL&&t.lastcL){T.firstYLabel.color=H<t.firstcL?"Error":((t.firstcL<=H)&&(H<=t.firstwL))?"Critical":(H>t.firstwL)?"Good":"Neutral";T.lastYLabel.color=I<t.lastcL?"Error":((t.lastcL<=I)&&(I<=t.lastwL))?"Critical":(I>t.lastwL)?"Good":"Neutral";}break;case"MI":for(i in c){if(c[i].TYPE=="CH"){var U={};U[d]="";U[m]=Number(c[i].FIXED);t.ch=Number(c[i].FIXED);T.maxThreshold={color:"Error"};T.maxThreshold.data=(n=="MEASURE")?l.results:[U];B=(n=="MEASURE")?t.sCriticalHigh:m;}else if(c[i].TYPE=="WH"){var U={};U[d]="";U[m]=Number(c[i].FIXED);t.wh=Number(c[i].FIXED);T.minThreshold={color:"Good"};T.minThreshold.data=(n=="MEASURE")?l.results:[U];A=(n=="MEASURE")?t.sWarningHigh:m;}else if(c[i].TYPE=="TA"){var U={};U[d]="";U[m]=Number(c[i].FIXED);T.target={color:"Neutral"};T.target.data=(n=="MEASURE")?l.results:[U];F=(n=="MEASURE")?t.sTarget:m;}}if(n=="FIXED"){T.firstYLabel.color=H>t.ch?"Error":((t.wh<=H)&&(H<=t.ch))?"Critical":(H<t.wh)?"Good":"Neutral";T.lastYLabel.color=I>t.ch?"Error":((t.wh<=I)&&(I<=t.ch))?"Critical":(I<t.wh)?"Good":"Neutral";}else if(n=="MEASURE"&&t.firstwH&&t.lastwH&&t.firstcH&&t.lastcH){T.firstYLabel.color=H>t.firstcH?"Error":((t.firstwH<=H)&&(H<=t.firstcH))?"Critical":(H<t.firstwH)?"Good":"Neutral";T.lastYLabel.color=I>t.lastcH?"Error":((t.lastwH<=I)&&(I<=t.lastcH))?"Critical":(I<t.lastwH)?"Good":"Neutral";}T.innerMaxThreshold={data:[]};T.innerMinThreshold={data:[]};break;case"RA":for(i in c){if(c[i].TYPE=="CH"){var U={};U[d]="";U[m]=Number(c[i].FIXED);t.ch=Number(c[i].FIXED);T.maxThreshold={color:"Error"};T.maxThreshold.data=(n=="MEASURE")?l.results:[U];B=(n=="MEASURE")?t.sCriticalHigh:m;}else if(c[i].TYPE=="WH"){var U={};U[d]="";U[m]=Number(c[i].FIXED);t.wh=Number(c[i].FIXED);T.innerMaxThreshold={color:"Good"};T.innerMaxThreshold.data=(n=="MEASURE")?l.results:[U];D=(n=="MEASURE")?t.sWarningHigh:m;}else if(c[i].TYPE=="WL"){var U={};U[d]="";U[m]=Number(c[i].FIXED);t.wl=Number(c[i].FIXED);T.innerMinThreshold={color:"Good"};T.innerMinThreshold.data=(n=="MEASURE")?l.results:[U];C=(n=="MEASURE")?t.sWarningLow:m;}else if(c[i].TYPE=="CL"){var U={};U[d]="";U[m]=Number(c[i].FIXED);t.cl=Number(c[i].FIXED);T.minThreshold={color:"Error"};T.minThreshold.data=(n=="MEASURE")?l.results:[U];A=(n=="MEASURE")?t.sCriticalLow:m;}else if(c[i].TYPE=="TA"){var U={};U[d]="";U[m]=Number(c[i].FIXED);T.target={color:"Neutral"};T.target.data=(n=="MEASURE")?l.results:[U];F=(n=="MEASURE")?t.sTarget:m;}}if(n=="FIXED"){T.firstYLabel.color=(H>t.ch||H<t.cl)?"Error":((t.wh<=H)&&(H<=t.ch))||((t.cl<=H)&&(H<=t.wl))?"Critical":((H>=t.wl)&&(H<=t.wh))?"Good":"Neutral";T.lastYLabel.color=(I>t.ch||I<t.cl)?"Error":((t.wh<=I)&&(I<=t.ch))||((t.cl<=I)&&(I<=t.wl))?"Critical":((I>=t.wl)&&(I<=t.wh))?"Good":"Neutral";}else if(n=="MEASURE"&&t.firstwL&&t.lastwL&&t.firstcL&&t.lastcL&&t.firstwH&&t.lastwH&&t.firstcH&&t.lastcH){T.firstYLabel.color=(H>t.firstcH||H<t.firstcL)?"Error":((t.firstwH<=H)&&(H<=t.firstcH))||((t.firstcL<=H)&&(H<=t.firstwL))?"Critical":((H>=t.firstwL)&&(H<=t.firstwH))?"Good":"Neutral";T.lastYLabel.color=(I>t.lastcH||I<t.lastcL)?"Error":((t.lastwH<=I)&&(I<=t.lastcH))||((t.lastcL<=I)&&(I<=t.lastwL))?"Critical":((I>=t.lastwL)&&(I<=t.lastwH))?"Good":"Neutral";}break;}var V=function(W,a,b,n){return new sap.suite.ui.commons.MicroAreaChartItem({color:"{/"+W+"/color}",points:{path:"/"+W+"/data",template:new sap.suite.ui.commons.MicroAreaChartPoint({x:"{"+a+"}",y:"{"+b+"}"})}});};t.getTile().getTileContent()[1].getContent().setTarget(V("target",d,F));t.getTile().getTileContent()[1].getContent().setInnerMinThreshold(V("innerMinThreshold",d,C));t.getTile().getTileContent()[1].getContent().setInnerMaxThreshold(V("innerMaxThreshold",d,D));t.getTile().getTileContent()[1].getContent().setMinThreshold(V("minThreshold",d,A));t.getTile().getTileContent()[1].getContent().setMaxThreshold(V("maxThreshold",d,B));t.getTile().getTileContent()[1].getContent().setChart(V("chart",d,m));t._updateTileModel(T);}},flowWithoutDesignTimeCall:function(){this.DEFINITION_DATA=this.oConfig;this._updateTileModel(this.DEFINITION_DATA);if(this.oTileApi.visible.isVisible()&&!this.firstTimeVisible){this.firstTimeVisible=true;}this.onAfterFinalEvaluation();},flowWithDesignTimeCall:function(){var t=this;try{var a=sap.ushell.components.tiles.indicatorTileUtils.cache.getEvaluationById(this.oConfig.EVALUATION.ID);if(a){t.oConfig.EVALUATION_FILTERS=a.EVALUATION_FILTERS;t.flowWithoutDesignTimeCall();}else{sap.ushell.components.tiles.indicatorTileUtils.util.getFilterFromRunTimeService(this.oConfig,function(f){t.oConfig.EVALUATION_FILTERS=f;sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();});}}catch(e){this.logError(e);}},setTextInTile:function(){var t=this;this._updateTileModel({header:t.oTileApi.preview.getTitle()||sap.ushell.components.tiles.indicatorTileUtils.util.getChipTitle(t.oConfig),subheader:t.oTileApi.preview.getDescription()||sap.ushell.components.tiles.indicatorTileUtils.util.getChipSubTitle(t.oConfig)});},logError:function(e){this.oDualTrendView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Failed);this.oDualTrendView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Failed);sap.ushell.components.tiles.indicatorTileUtils.util.logError(e);},refreshHandler:function(c){if(!c.firstTimeVisible){if(Number(this.oTileApi.configuration.getParameterValueAsString("isSufficient"))){c.flowWithoutDesignTimeCall();}else{c.flowWithDesignTimeCall();}}},visibleHandler:function(i){if(!i){this.firstTimeVisible=false;sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.trendChartODataReadRef);}if(i){this.refreshHandler(this);}},onExit:function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.trendChartODataReadRef);}});}());(function(){"use strict";sap.ui.controller("tiles.indicatorHarveyBall.HarveyBallTile",{onInit:function(){this.getView().setModel(new sap.ui.model.json.JSONModel());this.initializeVariables();this.attachHandlers();this.getVariable("tile").setState(sap.suite.ui.commons.LoadState.Loading);this.readChipConfiguration();},attachHandlers:function(){var t=this;var c=this.getVariable("chip");if(c.visible){c.visible.attachVisible(function(v){if(v){t.onVisible();}else{t.abortAllOpenODataRequests();}});}this.getVariable("tile").attachPress(function(){t.abortAllOpenODataRequests();var i=t.getVariable("indicatorUtils");t.getVariable("cache").setKpivalueById(t.getVariable("chipId"),null);window.location.hash=i.getNavigationTarget(t.getVariable("evalData"),t.getVariable("system"));});},initializeVariables:function(){this._variables={};this._oDataRequests={};var v=this.getView();var V=v.getViewData();var t=v.oTile;var c=V.chip;this.setVariable("indicatorUtils",sap.ushell.components.tiles.indicatorTileUtils.util);this.setVariable("cache",sap.ushell.components.tiles.indicatorTileUtils.cache);this.setVariable("hasAppeared",false);this.setVariable("chip",c);this.setVariable("tile",t);this.setVariable("tileControl",t.getTileContent()[0].getContent());this.setVariable("configurationString",c.configuration.getParameterValueAsString("tileConfiguration"));this.setVariable("system",c.url.getApplicationSystem());},getVariable:function(k){return this._variables[k];},setVariable:function(k,v){this._variables[k]=v;},readChipConfiguration:function(){var t=this;var c=this.getVariable("chip");var u=this.getVariable("indicatorUtils");u.getParsedChip(this.getVariable("configurationString"),function(e){t.setVariable("evalData",e);t.setVariable("chipId",e.TILE_PROPERTIES.id);t.setVariable("tileProperties",e.TILE_PROPERTIES);if(c.preview){c.preview.setTargetUrl(u.getNavigationTarget(e,t.getVariable("system")));t.loadPreviewData();if(c.preview.isEnabled()){t.getVariable("tile").setState(sap.suite.ui.commons.LoadState.Loaded);}else{t.loadActualData();}}});},loadPreviewData:function(){var t=this.getVariable("indicatorUtils").getTileTitleSubtitle(this.getVariable("chip"));this.getView().getModel().setData({fractionValue:34,value:100,size:sap.suite.ui.commons.InfoTileSize.Auto,frameType:"OneByOne",color:"Good",state:sap.suite.ui.commons.LoadState.Loading,header:t.title||this.getVariable("indicatorUtils").getChipTitle(this.getVariable("evalData")),subheader:t.subTitle||this.getVariable("indicatorUtils").getChipSubTitle(this.getVariable("evalData"))});},loadActualData:function(){if(Number(this.getVariable("chip").configuration.getParameterValueAsString("isSufficient"))){this.getVariable("cache").setEvaluationById(this.getVariable("chipId"),this.getVariable("evalData"));this.onEvalFiltersFetched();}else{this.fetchEvalFilters(this.onEvalFiltersFetched);}},registerOpenODataRequest:function(k,r){this._oDataRequests[k]=r;},deregisterOpenODataRequest:function(k){delete this._oDataRequests[k];},abortAllOpenODataRequests:function(){for(var a in this._oDataRequests){try{this.getVariable("indicatorUtils").abortPendingODataCalls(this._oDataRequests[a]);delete this._oDataRequests[a];}catch(e){}}},fetchKpiValue:function(p){function m(o,u,C,S,g){var D=o.read(u,null,null,true,function(h){t.deregisterOpenODataRequest(C.type);if(h&&h.results&&h.results.length){try{if(C.thresholds&&C.thresholds.length){t._setThresholdValues(h.results[0]);}k[C.type]=h.results[0][C.measure];k.unit=k.unit||h.results[0][C.unit]||"";if(--d==0){t.getVariable("cache").setKpivalueById(t.getVariable("chipId"),k);S.call(t,k);}}catch(e){t.logError(e);}}else{g.call(t,"no data");}},function(e){t.deregisterOpenODataRequest(C.type);if(e&&e.response){g.call(t,e.message);}});t.registerOpenODataRequest(C.type,D);}var t=this;var i=this.getVariable("indicatorUtils");var c=this.getVariable("cache").getKpivalueById(this.getVariable("chipId"));if(c){p.fnS.call(t,c);}else{var M=p.measure1,s=p.measure2;var u=p.url,E=p.entitySet;var v=p.filters;var f=p.fractionFilters.concat(v);var q,Q;var a,b,k;var d=2;f.forEach(function(e){e.value=e.value+"";e.valueTo=e.valueTo+"";});if(p.thresholds&&p.thresholds.length){q=i.prepareQueryServiceUri(this.getVariable("chip").url.addSystemToServiceUrl(u),E,M+","+p.thresholds,null,v);}else{q=i.prepareQueryServiceUri(this.getVariable("chip").url.addSystemToServiceUrl(u),E,M,null,v);}Q=i.prepareQueryServiceUri(this.getVariable("chip").url.addSystemToServiceUrl(u),E,s,null,f);a=q.unit[0];b=Q.unit[0];k={kpiValue:null,fractionValue:null,unit:""};if(q){m(q.model,q.uri,{measure:M,type:"kpiValue",unit:a,thresholds:p.thresholds},p.fnS,p.fnE);}if(Q){m(Q.model,Q.uri,{measure:s,type:"fractionValue",unit:b},p.fnS,p.fnE);}if(!(q&&Q)){p.fnE.call(t,"Error Preparing Query Service URI");}}},_setThresholdValues:function(d){var t=this.getVariable("oThreshold");if(t){if(this.getVariable("evalData").EVALUATION.VALUES_SOURCE=="RELATIVE"){if(t["TA"].COLUMN_NAME){t["TA"].VALUE=parseFloat(d[t["TA"].COLUMN_NAME]);for(var e in t){if(!t[e].COLUMN_NAME){t[e].VALUE=t["TA"].VALUE*t[e].VALUE/100;}}}}else{for(var e in t){if(t[e].COLUMN_NAME){t[e].VALUE=parseFloat(d[t[e].COLUMN_NAME]);}}}}this.setVariable("oThreshold",t);},getThresholdObject:function(){var t=this.getVariable("oThreshold");if(!t){var T=this.getVariable("evalData").EVALUATION_VALUES;var t={};for(var i=0,l=T.length;i<l;i++){t[T[i].TYPE]={VALUE:parseFloat(T[i].FIXED),COLUMN_NAME:T[i].COLUMN_NAME};}this.setVariable("oThreshold",t);}return t;},hasSomeValue:function(){var f=true;if(arguments.length){for(var i=0,l=arguments.length;i<l;i++){if(!(arguments[i]||arguments[i]=="0")){f=false;break;}}}else{f=false;}return f;},getTrendColor:function(k){var c="Neutral";var t,g,W,a,C,b;if(this.getVariable("tileProperties").isFractionMeasure){t=this.getThresholdObject();g=this.getVariable("evalData").EVALUATION.GOAL_TYPE;if(g=="MA"){W=t.WL;C=t.CL;if(this.hasSomeValue(W,C)){c="Good";if(k<C.VALUE){c="Error";}else if(k<=W.VALUE){c="Critical";}}}else if(g=='MI'){a=t.WH;b=t.CH;if(this.hasSomeValue(a,b)){c="Error";if(k<a.VALUE){c="Good";}else if(k<=b.VALUE){c="Critical";}}}else{W=t.WL;C=t.CL;a=t.WH;b=t.CH;if(this.hasSomeValue(a,b,C,W)){if(k<=C.VALUE||k>=a.VALUE){c="Error";}else if((W.VALUE>=k&&k>=C.VALUE)||(b.VALUE>=k&&k>=a.VALUE)){c="Critical";}else{c="Good";}}}}return sap.suite.ui.commons.InfoTileValueColor[c];},_getThresholdMeasures:function(){var t=[];var T=this.getThresholdObject();for(var e in T){if(T[e].COLUMN_NAME){t.push(T[e].COLUMN_NAME);}}return t;},onEvalFiltersFetched:function(){var t=this;if(this.getVariable("chip").visible.isVisible()&&!this.getVariable("hasAppeared")){try{var k=this.getVariable("evalData");var u=k.EVALUATION.ODATA_URL;var E=k.EVALUATION.ODATA_ENTITYSET;var a=this.getVariable("tileProperties");var h=[];var v=this.getVariable("indicatorUtils").prepareFilterStructure(k.EVALUATION_FILTERS,k.ADDITIONAL_FILTERS);var f=k.EVALUATION.COLUMN_NAME;var b=f;var c=[];if(a.isFractionMeasure){b=a.harveyTotalMeasure;c=this._getThresholdMeasures();}else{h=this.getVariable("indicatorUtils").prepareFilterStructure(a.harveyFilters||h);}this.setVariable("totalMeasure",b);this.setVariable("fractionMeasure",f);this.fetchKpiValue({measure1:b,measure2:f,entitySet:E,thresholds:c,url:u,filters:v,fractionFilters:h,fnS:function(d){d.kpiValue=Number(d.kpiValue);d.fractionValue=Number(d.fractionValue);t.setVariable("kpiValue",d.kpiValue);t.setVariable("fractionValue",d.fractionValue);t.onKpiValueFetched(d.kpiValue,d.unit,d.fractionValue);},fnE:this.logError});t.setVariable("hasAppeared",true);}catch(e){this.logError(e);}}},fetchEvalFilters:function(s){var t=this;try{var a=this.getVariable("cache").getEvaluationById(this.getVariable("chipId"));if(a){this.getVariable("evalData").EVALUATION_FILTERS=a.EVALUATION_FILTERS;s();}else{var d=this.getVariable("indicatorUtils").getFilterFromRunTimeService(this.getVariable("evalData"),function(f){t.deregisterOpenODataRequest("kpiFilterRequest");t.getVariable("evalData").EVALUATION_FILTERS=f;t.getVariable("cache").setEvaluationById(t.getVariable("chipId"),t.getVariable("evalData"));s.call(t);},function(e){this.logError(e);t.deregisterOpenODataRequest("kpiFilterRequest");});this.registerOpenODataRequest("kpiFilterRequest",d);}}catch(e){this.logError(e);}},onKpiValueFetched:function(k,a,f,b){var i=this.getVariable("indicatorUtils");var s=k;var d=f;var e=this.getVariable("evalData");var g=e.EVALUATION.SCALING;if(g==-2){s*=100;d*=100;}var c=this.isACurrencyMeasure(this.getVariable("totalMeasure"));s=i.getLocaleFormattedValue(Number(s),g,null,c,a);c=this.isACurrencyMeasure(this.getVariable("fractionMeasure"));d=i.getLocaleFormattedValue(Number(d),g,null,c,a);this.getView().getModel().setProperty("/totalLabel",s+" "+a);this.getView().getModel().setProperty("/fractionLabel",d+" "+b);this.getView().getModel().setProperty("/color",this.getTrendColor(f));this.getView().getModel().setProperty("/value",k);this.getView().getModel().setProperty("/fractionValue",f);var n=i.getNavigationTarget(this.getVariable("evalData"),this.getVariable("system"));this.getVariable("tile").$().wrap("<a href ='"+n+"'/>");this.getVariable("tile").setState(sap.suite.ui.commons.LoadState.Loaded);},logError:function(e){this.getVariable("tile").setState(sap.suite.ui.commons.LoadState.Failed);this.getVariable("indicatorUtils").logError(e,this.getVariable("tile"));},onVisible:function(i){if(!this.getVariable("hasAppeared")){if(Number(this.getVariable("chip").configuration.getParameterValueAsString("isSufficient"))){this.onEvalFiltersFetched();}else{this.fetchEvalFilters(this.onEvalFiltersFetched);}}},onExit:function(){this.abortAllOpenODataRequests();}});}());(function(){"use strict";sap.ui.controller("sap.ushell.components.treeview.NavTree",{onInit:function(){var v=this.getView().getViewData(),r=v.data.items,s=v.data.serviceURL||'',t={items:[],entryObject:{}};var m=new sap.ui.model.json.JSONModel(t);this.getView().setModel(m);jQuery.getJSON(s).done(function(r){this.buidModelData(r);}.bind(this)).fail(function(j,a,e){var b=a+", "+e;jQuery.sap.log.error("Request Failed: "+b);this.buidModelData(r);}.bind(this));},buidModelData:function(r){var i,e,g=0,t={items:[],entryObject:{}};for(i in r.nodes){var a=r.nodes[i];if(a.type==='SUBMENU'){var b=a.title;for(e in a.nodes){var c=a.nodes[e];c.groupIndex=g.toString();c.groupName=b;t.items.push(c);t.entryObject[g.toString()]={title:a.title,type:a.type};}}else if(a.type==='URL'||a.type==='APP'){a.groupIndex=g.toString();a.groupName="";t.items.push(a);t.entryObject[g.toString()]={title:a.title,type:a.type,href:a.target};}g++;}var m=new sap.ui.model.json.JSONModel(t);this.getView().setModel(m);},getGroupHeader:function(g){var e=this.getView().getModel().getData().entryObject[g.key];jQuery.sap.require('sap.m.GroupHeaderListItem');if(e.type==="SUBMENU"){var i=new sap.ui.core.Icon({src:'slim-arrow-right',tooltip:e.title}).addStyleClass('sapUshellGroupListItemIcon');var l=new sap.m.Label({text:e.title}).addStyleClass('sapUshellNavTreeLink');return new sap.m.CustomListItem({press:[this.handleClickOnSubMenu,this],type:sap.m.ListType.Active,content:[i,l]}).addStyleClass('sapUshellNavTreeListItem sapUshellNavTreeParent');}else{return new sap.m.CustomListItem({content:new sap.m.Link({text:e.title,href:e.href}).addStyleClass('sapUshellNavTreeLink')}).addEventDelegate({onclick:this.onNavTreeTitleChange.bind(this)}).addStyleClass('sapUshellNavTreeListItem sapUshellNavTreeSingle');}},onNavTreeTitleChange:function(e){if(this._prevSelect){this._prevSelect.removeStyleClass('sapUshellNavTreeItemSelected');}var i=e.srcControl;if(e.srcControl.getContent){window.location.href=e.srcControl.getContent()[0].getHref();i.addStyleClass('sapUshellNavTreeItemSelected');this._prevSelect=i;}else{i.getParent().addStyleClass('sapUshellNavTreeItemSelected');this._prevSelect=i.getParent();}},handleClickOnSubMenu:function(e){var i=e.getSource().getContent()[0];if(i.getSrc()==='slim-arrow-down'){i.setSrc('slim-arrow-right');this.toggleSubItemsState(e,true);}else{i.setSrc('slim-arrow-down');this.toggleSubItemsState(e,false);}},toggleSubItemsState:function(e,i){if(e){var j=jQuery(e.getSource().getDomRef());if(i){j.nextUntil('.sapUshellNavTreeSingle, .sapUshellNavTreeParent').addClass("sapUshellNavTreeChildHide");}else{j.nextUntil('.sapUshellNavTreeSingle, .sapUshellNavTreeParent').removeClass("sapUshellNavTreeChildHide");}}}});}());(function(){"use strict";sap.ui.jsview("sap.ushell.components.treeview.NavTree",{createContent:function(c){jQuery.sap.require('sap.m.List');jQuery.sap.require('sap.m.CustomListItem');var l=new sap.m.CustomListItem({content:new sap.m.Link({text:"{title}",href:"{target}"}).addStyleClass('sapUshellNavTreeLink')}).addEventDelegate({onclick:c.onNavTreeTitleChange.bind(c)}).addStyleClass('sapUshellNavTreeListItem sapUshellNavTreeChild sapUshellNavTreeChildHide sapUshellNavTree_visual_transition');var L=new sap.m.List({items:{path:'/items',groupHeaderFactory:jQuery.proxy(c.getGroupHeader,c),sorter:new sap.ui.model.Sorter("groupIndex",false,true),template:l}});var o=L.onAfterRendering;L.onAfterRendering=function(){o.apply(this,arguments);if(this.getItems().length>0){var f=this.getItems()[0];if(f.getMetadata().getName()==="sap.m.GroupHeaderListItem"&&f.getTitle&&!f.getTitle()){f.destroy();}var O=jQuery('.sapUshellNavTreeParent');O.each(function(){var q=jQuery(this);var i=sap.ui.getCore().byId(q.attr('id'));var I=i.getContent().length&&i.getContent()[0]&&i.getContent()[0].getSrc()||'';if(I==='slim-arrow-down'){q.nextUntil('.sapUshellNavTreeSingle, .sapUshellNavTreeParent').removeClass("sapUshellNavTreeChildHide");}});}};return L;},getControllerName:function(){return"sap.ushell.components.treeview.NavTree";}});}());(function(){"use strict";sap.ui.controller("sap.ushell.renderers.fiori2.compactCozy_selector.CompactCozySelector",{onInit:function(){try{this.userInfoService=sap.ushell.Container.getService("UserInfo");this.oUser=this.userInfoService.getUser();}catch(e){jQuery.sap.log.error("Getting UserInfo service failed.");this.oUser=sap.ushell.Container.getUser();}this.translationBundle=sap.ushell.resources.i18n;this.oModel=new sap.ui.model.json.JSONModel({options:[{id:"cozy",name:this.translationBundle.getText("cozy"),isSelected:true},{id:"compact",name:this.translationBundle.getText("compact"),isSelected:false}]});this.getView().setModel(this.oModel);this.currentContentDensity=this.oUser.getContentDensity();this.origContentDensity=this.currentContentDensity;this.isContentLoaded=false;},getContent:function(){var o=this.oModel.getProperty("/options");for(var i=0;i<o.length;i++){if(o[i].id==this.currentContentDensity){o[i].isSelected=true;}else{o[i].isSelected=false;}}this.oModel.setProperty("/options",o);return jQuery.Deferred().resolve(this.getView());},getValue:function(){return jQuery.Deferred().resolve(this._getModeNameById(this.currentContentDensity));},onCancel:function(){this.currentContentDensity=this.oUser.getContentDensity();},onSave:function(){var d=jQuery.Deferred();var u;if(this.oUser.getContentDensity()!=this.currentContentDensity){if(this.currentContentDensity){this.oUser.setContentDensity(this.currentContentDensity);u=this.userInfoService.updateUserPreferences(this.oUser);u.done(function(){this.oUser.resetChangedProperties();this.origContentDensity=this.currentContentDensity;sap.ui.getCore().getEventBus().publish("launchpad","toggleContentDensity",{contentDensity:this.currentContentDensity});d.resolve();}.bind(this));u.fail(function(e){this.oUser.setContentDensity(this.origContentDensity);this.oUser.resetChangedProperties();this.currentContentDensity=this.origContentDensity;jQuery.sap.log.error(e);d.reject(e);}.bind(this));}else{d.reject("Could not find mode: "+this.currentContentDensity);}}else{d.resolve();}return d.promise();},getCurrentContentDensity:function(){return this.currentContentDensity;},setCurrentContentDensity:function(n){this.currentContentDensity=n;},_getModeNameById:function(c){var d=this.getModel().getProperty('/options');for(var i=0;i<d.length;i++){if(d[i].id==c){return d[i].name;}}return c;},getModel:function(){return this.oModel;}});}());(function(){"use strict";sap.ui.controller("sap.ushell.renderers.fiori2.defaultParameters_selector.DefaultParameters",{onInit:function(){this.oModelRecords={};this.oChangedParameters={};this.oBlockedParameters={};this.aDisplayedUserDefaults=[];this.DefaultParametersService=sap.ushell.Container.getService("UserDefaultParameters");},applyFocus:function(){var t=this;setTimeout(function(){if(!sap.ui.Device.phone){var e=jQuery.sap.byId(t.getView().getId()).firstFocusableDomRef();if(e){jQuery.sap.focus(e);}}},1);},overrideOdataModelValue:function(e){var u=e.getParameter('url'),m=e.getSource(),f,F,t=this;this.aDisplayedUserDefaults.forEach(function(r){if(r.editorMetadata&&r.editorMetadata.editorInfo){F=r.editorMetadata.editorInfo.odataURL+r.editorMetadata.editorInfo.bindingPath;if(F===u){f=r.editorMetadata.editorInfo.bindingPath+"/"+r.editorMetadata.editorInfo.propertyName;if(m.getProperty(f)!==r.valueObject.value){m.setProperty(f,r.valueObject.value);}t.oBlockedParameters[r.parameterName]=false;}}});},getOrCreateModelForODataService:function(u){if(!this.oModelRecords[u]){var p={metadataUrlParams:{"sap-documentation":"heading,quickinfo","sap-value-list":"none"},json:true};var m=new sap.ui.model.odata.ODataModel(u,p);m.setDefaultCountMode("None");m.setDefaultBindingMode("TwoWay");m.attachRequestCompleted(this.overrideOdataModelValue.bind(this));this.oModelRecords[u]=m;}return this.oModelRecords[u];},constructControlSet:function(p){var u=[];for(var P in p){for(var n=0;n<u.length;n++){if(u[n].parameterName===P){u.splice(n,1);}}p[P].parameterName=P;u.push(p[P]);}this.sortParametersByGroupIdParameterIndex(u);this.aDisplayedUserDefaults=u;jQuery.sap.require("sap.ui.comp.smartform.SmartForm");this.sForm=new sap.ui.comp.smartform.SmartForm({editable:true}).addStyleClass("sapUshellShellDefaultValuesForm");this.getView().addContent(this.sForm);},getValue:function(){var d=jQuery.Deferred();var h=sap.ushell.Container.getService("UserDefaultParameters").hasRelevantMaintainableParameters();h.done(function(H){d.resolve({value:H?1:0,displayText:" "});});h.fail(function(e){d.reject(e);});return d.promise();},createPlainModel:function(g,r){r.modelBind.model=this.oMdlParameter;r.modelBind.extendedModel=this.oMdlParameter;g.setModel(r.modelBind.model);var m="/sUserDef_"+r.nr+"_";r.modelBind.sFullPropertyPath=m;r.modelBind.sPropertyName="{"+m+"}";r.modelBind.model.setProperty(r.modelBind.sFullPropertyPath,r.valueObject.value);},revertToPlainModelControls:function(g,r){jQuery.sap.log.error("Metadata loading for parameter "+r.parameterName+" failed"+JSON.stringify(r.editorMetadata));r.modelBind.isOdata=false;this.createPlainModel(g,r);this.createAppropriateControl(g,r);},getContent:function(){var t=this;var d=new jQuery.Deferred();this.DefaultParametersService.editorGetParameters().done(function(p){t.oMdlParameter=new sap.ui.model.json.JSONModel(p);t.oMdlParameter.setDefaultBindingMode("TwoWay");t.getView().setModel(t.oMdlParameter,"MdlParameter");t.oOriginalParameters=jQuery.extend(true,{},p);t.oCurrentParameters=jQuery.extend(true,{},p);t.constructControlSet(p);jQuery.sap.require('sap.ui.model.odata.ODataModel');var l="nevermore";var g;t.aChangedParameters=[];t.oBindingContexts={};t.setPropValue=function(r){r.modelBind.model.setProperty(r.modelBind.sFullPropertyPath,r.valueObject.value);t.oBlockedParameters[r.parameterName]=false;};t.oMdlParameter.setProperty("/sUser");for(var i=0;i<t.aDisplayedUserDefaults.length;++i){var r=t.aDisplayedUserDefaults[i];r.nr=i;r.editorMetadata=r.editorMetadata||{};r.valueObject=r.valueObject||{value:""};var a=new sap.ui.comp.smartform.GroupElement({});if(l!=r.editorMetadata.groupId){var b=r.editorMetadata.groupTitle||undefined;g=new sap.ui.comp.smartform.Group({label:b,"editable":true});l=r.editorMetadata.groupId;t.sForm.addGroup(g);}g.addGroupElement(a);r.modelBind={model:undefined,sModelPath:undefined,sPropertyName:undefined,sFullPropertyPath:undefined};r.valueObject.value=r.valueObject.value||"";if(r.editorMetadata.editorInfo&&r.editorMetadata.editorInfo.propertyName){r.modelBind.isOdata=true;var u=r.editorMetadata.editorInfo.odataURL;r.modelBind.model=t.getOrCreateModelForODataService(u);a.setModel(r.modelBind.model);if(!t.oBindingContexts[u]){a.bindElement(r.editorMetadata.editorInfo.bindingPath);t.oBindingContexts[u]=r.modelBind.model.getContext(r.editorMetadata.editorInfo.bindingPath);}else{a.setBindingContext(t.oBindingContexts[u]);}r.modelBind.sPropertyName="{"+r.editorMetadata.editorInfo.propertyName+"}";r.modelBind.sFullPropertyPath=r.editorMetadata.editorInfo.bindingPath+"/"+r.editorMetadata.editorInfo.propertyName;r.modelBind.extendedModel=t.oMdlParameter;}else{t.createPlainModel(a,r);}r.valueObject.value=r.valueObject.value||"";r.modelBind.model.setProperty(r.modelBind.sFullPropertyPath,r.valueObject.value);if(r.modelBind.isOdata){t.oBlockedParameters[r.parameterName]=true;r.modelBind.model.attachMetadataLoaded(t.createAppropriateControl.bind(t,a,r));r.modelBind.model.attachMetadataFailed(t.revertToPlainModelControls.bind(t,a,r));}else{t.createAppropriateControl(a,r);}r.modelBind.model.bindTree(r.modelBind.sFullPropertyPath).attachChange(t.storeChangedData.bind(t));}t.oMdlParameter.bindTree("/").attachChange(t.storeChangedData.bind(t));d.resolve(t.getView());});return d.promise();},createAppropriateControl:function(g,r){var s,l,e,a;if(r.editorMetadata.extendedUsage){var t=this;e=new sap.m.Button({text:sap.ushell.resources.i18n.getText("userDefaultsExtendedParametersTitle"),tooltip:sap.ushell.resources.i18n.getText("userDefaultsExtendedParametersTooltip"),type:{parts:['MdlParameter>/'+r.parameterName+'/valueObject/extendedValue/Ranges'],formatter:function(R){return R&&R.length?sap.m.ButtonType.Emphasized:sap.m.ButtonType.Default;}},press:function(o){t.openExtendedValueDialog(o,r);}}).addStyleClass('sapUshellExtendedDefaultParamsButton');}jQuery.sap.log.debug("Creating controls for parameter"+r.parameterName+" type "+r.modelBind.isOdata);var E=g.getElements().slice();E.forEach(function(o){g.removeElement(o);});var f=g.getFields().slice();f.forEach(function(o){g.removeField(o);});l=new sap.ui.comp.smartfield.SmartLabel({width:sap.ui.Device.system.phone?"auto":"12rem",textAlign:sap.ui.Device.system.phone?'Left':'Right',text:(r.editorMetadata.displayText||r.parameterName)+":",tooltip:r.editorMetadata.description||r.parameterName});if(r.modelBind.isOdata&&r.editorMetadata.editorInfo){jQuery.sap.require("sap.ui.comp.smartfield.SmartField");s=new sap.ui.comp.smartfield.SmartField({value:r.modelBind.sPropertyName,name:r.parameterName});s.attachInnerControlsCreated({},this.applyFocus,this);}else{s=new sap.m.Input({name:r.parameterName,value:r.modelBind.sPropertyName,type:"Text"});this.setPropValue(r);}l.setLabelFor(s);s.attachChange(this.storeChangedData.bind(this));s.addStyleClass("sapUshellDefaultValuesSmartField");s.setLayoutData(new sap.m.FlexItemData({shrinkFactor:0}));var i=new sap.m.FlexBox({width:sap.ui.Device.system.phone?'100%':'auto',direction:(sap.ui.Device.system.phone&&!e)?'Column':'Row',items:[s,e]});l.setLayoutData(new sap.m.FlexItemData({shrinkFactor:0}));a=new sap.m.FlexBox({alignItems:sap.ui.Device.system.phone?'Start':'Center',direction:sap.ui.Device.system.phone?'Column':'Row',items:[l,i]});g.addElement(a);},openExtendedValueDialog:function(e,d){var t=this,p='/'+d.parameterName+'/valueObject/extendedValue/Ranges',m=d.modelBind.extendedModel,r=m.getProperty(p)||[],l,n;if(d.modelBind.isOdata){n=this._getMetadataNameSpace(d.editorMetadata.editorInfo.odataURL);var E=d.modelBind.model.getMetaModel().getODataEntityType(n+"."+d.editorMetadata.editorInfo.entityName);if(E){l=d.modelBind.model.getMetaModel().getODataProperty(E,d.editorMetadata.editorInfo.propertyName)["sap:label"];}}jQuery.sap.require('sap.ui.comp.valuehelpdialog.ValueHelpDialog');var v=new sap.ui.comp.valuehelpdialog.ValueHelpDialog({basicSearchText:d.editorMetadata.displayText||l||d.parameterName,title:d.editorMetadata.displayText||l||d.parameterName,supportRanges:true,supportRangesOnly:true,key:d.modelBind.sPropertyName,displayFormat:"UpperCase",descriptionKey:d.editorMetadata.displayText||l||d.parameterName,filterMode:true,stretch:sap.ui.Device.system.phone,ok:function(c){t.saveExtendedValue(c,d,m,v);},cancel:function(c){v.close();},afterClose:function(){v.destroy();}});v.setIncludeRangeOperations(this.getListOfSupportedRangeOperations());this.addTokensToValueHelpDialog(v,r,d.parameterName);var k=[];k.push({label:v.getTitle(),key:d.parameterName});v.setRangeKeyFields(k);v.open();},saveExtendedValue:function(c,d,m,v){this.aTokens=c.getParameters().tokens;var t=[],p='/'+d.parameterName+'/valueObject/extendedValue/Ranges',f,a={extendedValue:{"Ranges":[]}};jQuery.extend(this.oCurrentParameters[d.parameterName].valueObject,a);for(var b in this.aTokens){if(this.aTokens.hasOwnProperty(b)){t.push(this.aTokens[b].data("range"));}}f=t.map(function(b){return{Sign:b.exclude?'E':'I',Option:b.operation!=="Contains"?b.operation:"CP",Low:b.value1,High:b.value2||null};});if(!m.getProperty('/'+d.parameterName+'/valueObject/extendedValue')){m.setProperty('/'+d.parameterName+'/valueObject/extendedValue',{});}m.setProperty(p,f);this.oChangedParameters[d.parameterName]=true;v.close();},getListOfSupportedRangeOperations:function(){var s=Object.keys(sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation);return s.filter(function(o){return o!=="StartsWith"&&o!=='EndsWith'&&o!=='Initial';});},_getMetadataNameSpace:function(s){var S=s.split("/"),n;n=S[S.length-1];return n;},addTokensToValueHelpDialog:function(d,r,p){var t=[],f;r.forEach(function(R){if(R){f={};f.exclude=R.Sign==='E';f.keyField=p;f.operation=R.Option!=="CP"?R.Option:"Contains";f.value1=R.Low;f.value2=R.High;t.push(new sap.m.Token({}).data("range",f));}});d.setTokens(t);},sortParametersByGroupIdParameterIndex:function(u){function c(d,D){if(!(D.editorMetadata&&D.editorMetadata.groupId)){return-1;}if(!(d.editorMetadata&&d.editorMetadata.groupId)){return 1;}if(d.editorMetadata.groupId<D.editorMetadata.groupId){return-1;}if(d.editorMetadata.groupId>D.editorMetadata.groupId){return 1;}return 0;}function a(d,D){if(!(D.editorMetadata&&D.editorMetadata.parameterIndex)){return-1;}if(!(d.editorMetadata&&d.editorMetadata.parameterIndex)){return 1;}return d.editorMetadata.parameterIndex-D.editorMetadata.parameterIndex;}u.sort(function(d,D){var r=c(d,D);if(r===0){return a(d,D);}return r;});},storeChangedData:function(){var i=0,t=this,a=t.aDisplayedUserDefaults;for(i=0;i<a.length;++i){var p=a[i].parameterName;if(!t.oBlockedParameters[p]){var o={value:t.oCurrentParameters[p].valueObject&&t.oCurrentParameters[p].valueObject.value,extendedValue:t.oCurrentParameters[p].valueObject&&t.oCurrentParameters[p].valueObject.extendedValue&&t.oCurrentParameters[p].valueObject.extendedValue};if(a[i].modelBind&&a[i].modelBind.model){var m=a[i].modelBind.model;var M=a[i].modelBind.extendedModel;var P=a[i].modelBind.sFullPropertyPath;var A=m.getProperty(P);var n={value:m.getProperty(P),extendedValue:M.getProperty('/'+p+'/valueObject/extendedValue')};if(this.isValueDifferent(n,o)){t.oCurrentParameters[p].valueObject.value=A;if(n.extendedValue){jQuery.extend(t.oCurrentParameters[p].valueObject.extendedValue,n.extendedValue);}t.oChangedParameters[p]=true;}}}}},onCancel:function(){if(sap.ui.getCore().byId("saveButton")){sap.ui.getCore().byId("saveButton").setEnabled(true);}},isValueDifferent:function(v,V){var i=false,s=v?JSON.stringify(v):v,a=V?JSON.stringify(V):V,e,E;if(s===a){return false;}if(v===undefined){return false;}if(V===undefined){return false;}e=v.extendedValue?JSON.stringify(v.extendedValue):v.extendedValue;E=V.extendedValue?JSON.stringify(V.extendedValue):V.extendedValue;if((v.value===""&&V.value===undefined)||(V.value===""&&v.value===undefined)){i=true;}if(i&&(e===E)){return false;}return(!i&&(v.value!==V.value))||(e!==E);},onSave:function(){var t=this,d=new jQuery.Deferred(),i,c=Object.keys(this.oChangedParameters).sort(),s,p;for(i=0;i<c.length;i++){p=c[i];if(this.isValueDifferent(this.oOriginalParameters[p].valueObject,this.oCurrentParameters[p].valueObject)){if((this.oCurrentParameters[p].valueObject&&this.oCurrentParameters[p].valueObject.value===null)||(this.oCurrentParameters[p].valueObject&&this.oCurrentParameters[p].valueObject.value==="")){this.oCurrentParameters[p].valueObject.value=undefined;}if(this.oCurrentParameters[p].valueObject&&this.oCurrentParameters[p].valueObject.extendedValue&&jQuery.isArray(this.oCurrentParameters[p].valueObject.extendedValue.Ranges)&&(this.oCurrentParameters[p].valueObject.extendedValue.Ranges.length===0)){this.oCurrentParameters[p].valueObject.extendedValue=undefined;}s=sap.ushell.Container.getService("UserDefaultParameters").editorSetValue(p,this.oCurrentParameters[p].valueObject);s.done(function(P){t.oChangedParameters={};t.oOriginalParameters[P].valueObject.value=t.oCurrentParameters[P].valueObject.value;d.resolve();});s.fail(d.reject);}}return d.promise();}});}());(function(){"use strict";var m=new sap.ui.model.json.JSONModel({actions:[],userPreferences:{entries:[]},apps:{recentActivities:[],frequentActivities:[]}});sap.ui.controller("sap.ushell.renderers.fiori2.meArea.MeArea",{onInit:function(){var c=(this.getView().getViewData()?this.getView().getViewData().config:{})||{};this.aControlsWithPressHandler=[];this.getView().setModel(m,"meAreaModel");this._addActionItemToOverflowSupport();this.oResourceBundle=sap.ushell.resources.i18n;if(c.enableRecentActivity){this.oUserRecentsSrvc=sap.ushell.Container.getService('UserRecents');}this.lastVisited=null;},onBeforeRendering:function(){if(this.oUserRecentsSrvc){if(!m.getProperty('/apps/recentActivities')||!m.getProperty('/apps/recentActivities').length){this.refreshRecentActivities();}}if(!m.getProperty('/apps/frequentActivities')||!m.getProperty('/apps/frequentActivities').length){this.refreshFrequentActivities();}},refreshRecentActivities:function(){if(this.oUserRecentsSrvc){this.oUserRecentsSrvc.getRecentActivity().done(function(a){a.forEach(function(i){i.timestamp=sap.ushell.utils.formatDate(i.timestamp);});m.setProperty('/apps/recentActivities',a);});}},refreshFrequentActivities:function(c){if(this.oUserRecentsSrvc){this.oUserRecentsSrvc.getFrequentActivity().done(function(a){m.setProperty('/apps/frequentActivities',a);});}},createViewByName:function(e,n,v){var V=v?sap.ui.getCore().byId(v):null;if(!V){var s=e.getSource(),c=s.getBindingContext(),p=c?c.getPath():"",a=n||c.getModel().getProperty(p+"/viewName");v=v||c.getModel().getProperty(p+"/id");V=sap.ui.view(v,{viewName:a,type:'JS',viewData:{}});}return V;},getSettingsDialogContent:function(){var s=sap.ui.getCore().byId("userSettings");if(!s){s=sap.ui.view("userSettings",{viewName:"sap.ushell.renderers.fiori2.user_actions.user_preferences.UserSettings",type:'JS',viewData:this.getView().getViewData()});}s.setModel(this.getView().getModel());return s;},logout:function(){jQuery.sap.require('sap.m.MessageBox');var l=new sap.ushell.ui.launchpad.LoadingDialog({text:""}),s=true,i=false,L={};sap.ushell.Container.getGlobalDirty().done(function(d){s=false;if(i===true){l.exit();l=new sap.ushell.ui.launchpad.LoadingDialog({text:""});}var _=function(d){var L={},r=sap.ushell.resources.i18n;if(d===sap.ushell.Container.DirtyState.DIRTY){L.message=r.getText('unsaved_data_warning_popup_message');L.icon=sap.m.MessageBox.Icon.WARNING;L.messageTitle=r.getText("unsaved_data_warning_popup_title");}else{L.message=r.getText('signoutConfirmationMsg');L.icon=sap.m.MessageBox.Icon.QUESTION;L.messageTitle=r.getText("signoutMsgTitle");}return L;};L=_(d);sap.m.MessageBox.show(L.message,L.icon,L.messageTitle,[sap.m.MessageBox.Action.OK,sap.m.MessageBox.Action.CANCEL],function(a){if(a===sap.m.MessageBox.Action.OK){l.openLoadingScreen();l.showAppInfo(sap.ushell.resources.i18n.getText('beforeLogoutMsg'),null);sap.ushell.Container.logout();}},sap.ui.core.ElementMetadata.uid("confirm"));});if(s===true){l.openLoadingScreen();i=true;}},_addPressHandlerToActions:function(c){var t=this;if(this.aControlsWithPressHandler.indexOf(c.getId())===-1){this.aControlsWithPressHandler.push(c.getId());c.attachPress(function(){sap.ui.getCore().byId("viewPortContainer").switchState("Center");if(c.getId()==="userSettingsBtn"){if(!t.getView().oSettingsDialog.getModel()){t.getView().oSettingsDialog.setModel(t.getView().getModel());}t.getView().oSettingsDialog.open();}});}},_getControlsWithPressHandler:function(){return this.aControlsWithPressHandler;},_addActionItemToOverflowSupport:function(){if(sap.m._overflowToolbarHelpers&&sap.m._overflowToolbarHelpers.OverflowToolbarAssociativePopoverControls._mSupportedControls){var s=sap.m._overflowToolbarHelpers.OverflowToolbarAssociativePopoverControls._mSupportedControls;var p=sap.m._overflowToolbarHelpers.OverflowToolbarAssociativePopoverControls.prototype;var c=["sap.ushell.ui.launchpad.ActionItem","sap.ushell.ui.footerbar.AboutButton","sap.ushell.ui.footerbar.ContactSupportButton","sap.ushell.ui.footerbar.EndUserFeedback","sap.ushell.ui.footerbar.HideGroupsButton","sap.ushell.ui.footerbar.LogoutButton","sap.ushell.ui.footerbar.UserPreferencesButton","sap.m.Button"];var C=function(n){return n.substring(0,1).toUpperCase()+n.substring(1);};var S={canOverflow:true,listenForEvents:["press"],noInvalidationProps:["enabled","type"]};var P=function(o){if(o.setActionType){o.setActionType('standard');}var t=o.getType();if(t!==sap.m.ButtonType.Accept&&t!==sap.m.ButtonType.Reject){o.setType(sap.m.ButtonType.Transparent);}};var f=function(o){if(o.setActionType){o.setActionType('action');}};c.forEach(function(n){s[n]=S;var a=n.split(".").map(C).join("");var b='_preProcess';var d='_postProcess';p[b+a]=P;p[d+a]=f;});}},setLastVisited:function(u){this.lastVisited=u;},updateScrollBar:function(h){if(this.lastVisited&&this.lastVisited!="#"+h){jQuery('.sapUshellViewPortLeft').scrollTop(0);sap.ui.getCore().byId('meAreaIconTabBar').setSelectedKey("sapUshellIconTabBarrecentActivities");var l=sap.ui.getCore().byId('sapUshellActivityListrecentActivities'),L=l.getItems();if(L&&L.length>0){sap.ui.getCore().byId('sapUshellActivityListrecentActivities').setSelectedItem(L[0],true);}this.lastVisited=null;}},_saveUserPrefEntries:function(){var e=this.getView().getModel().getProperty("/userPreferences/entries");var r=jQuery.Deferred();var w;var c;var t=0;var f=0;var s=0;var p=[];var a=[];var b;var d=function(){s++;r.notify();};var g=function(h){a.push({entry:b,message:h});f++;r.notify();};for(var i=0;i<e.length;i++){if(e[i]&&e[i].isDirty===true){c=e[i].onSave();c.done(d);b=e[i].title;c.fail(g);p.push(c);t++;}}w=jQuery.when.apply(null,p);w.done(function(){r.resolve();});r.progress(function(){if(f>0&&(f+s===t)){r.reject(a);}});return r.promise();},_saveButtonHandler:function(){var s;s=this._saveUserPrefEntries();var t=this;var i=this.getView().getModel().getProperty("/userPreferences/isDetailedEntryMode");if(i){this.getView().getModel().setProperty("/userPreferences/activeEntryPath",null);}s.done(function(){t._showSaveMessageToast();});s.fail(function(f){jQuery.sap.require("sap.m.MessageBox");var e;var a="";if(f.length===1){e=t.translationBundle.getText("savingEntryError")+" ";}else{e=t.translationBundle.getText("savingEntriesError")+"\n";}f.forEach(function(b){e+=b.entry+"\n";a+="Entry: "+b.entry+" - Error message: "+b.message+"\n";});sap.m.MessageBox.show(e,{icon:sap.m.MessageBox.Icon.ERROR,title:t.translationBundle.getText("Error"),actions:[sap.m.MessageBox.Action.OK]});jQuery.sap.log.error("Failed to save the following entries",a,"sap.ushell.ui.footerbar.UserPreferencesButton");});},_showSaveMessageToast:function(){jQuery.sap.require("sap.m.MessageToast");var a=this.oResourceBundle.getText("savedChanges");sap.m.MessageToast.show(a,{duration:3000,width:"15em",my:"center bottom",at:"center bottom",of:window,offset:"0 -50",collision:"fit fit"});},createSaveButton:function(){var t=this;return new sap.m.Button({id:"userSettingSaveButton",text:sap.ushell.resources.i18n.getText("saveBtn"),press:function(){t._saveButtonHandler();t._handleSettingsDialogClose.apply(t);},visible:true});},_dialogCancelButtonHandler:function(){var e=this.getView().getModel().getProperty("/userPreferences/entries");for(var i=0;i<e.length;i++){if(e[i]&&e[i].onCancel){e[i].onCancel();}}},_handleSettingsDialogClose:function(){var v=this.getView(),s=this.getSettingsDialogContent(),f=s.oController.oMasterEntryList.getItems()[0];s.oMainApp.toMaster('userSettingMaster');s.oController.oMasterEntryList.setSelectedItem(f);v.oSettingsDialog.close();},createCancelButton:function(){var t=this;return new sap.m.Button({id:"userSettingCancelButton",text:sap.ushell.resources.i18n.getText("cancelBtn"),press:function(){t._dialogCancelButtonHandler();t._handleSettingsDialogClose.apply(t);},visible:true});},onExit:function(){this.getView().aDanglingControls.forEach(function(c){if(c.destroyContent){c.destroyContent();}c.destroy();});}});}());(function(){"use strict";sap.ui.jsview("sap.ushell.renderers.fiori2.meArea.MeArea",{createContent:function(c){jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.OverflowToolbar');jQuery.sap.require('sap.ushell.resources');jQuery.sap.require('sap.ushell.ui.launchpad.UserStatusItem');jQuery.sap.require("sap.ushell.ui.launchpad.AccessibilityCustomData");this.addStyleClass('sapUshellMeAreaView');this.aDanglingControls=[];var u=sap.ushell.Container.getUser().getFullName(),p,t=sap.ushell.resources.i18n,C=(this.getViewData()?this.getViewData().config:{})||{},s=C.appState,b=(s==='embedded'||s==='embedded-home'||s==='standalone'||s==='blank-home'||s==='blank'),U,S=sap.ui.core.service.ServiceFactoryRegistry.get("sap.ushell.ui5service.UserStatus"),o=S.createInstance(),f=function(i){o.then(function(S){S.setStatus(i);p.close();});}.bind(this);U=[new sap.ushell.ui.launchpad.UserStatusItem({status:sap.ushell.ui.launchpad.UserStatusItem.prototype.STATUS_ENUM.AVAILABLE,id:"userStatusItem1",isOpener:false,press:function(E){f(sap.ushell.ui5service.UserStatus.prototype.AvailableStatus.AVAILABLE);}.bind(this)}).addStyleClass('sapUserStatusContainer'),new sap.ushell.ui.launchpad.UserStatusItem({status:sap.ushell.ui.launchpad.UserStatusItem.prototype.STATUS_ENUM.AWAY,id:"userStatusItem2",isOpener:false,press:function(E){f(sap.ushell.ui5service.UserStatus.prototype.AvailableStatus.AWAY);}.bind(this)}).addStyleClass('sapUserStatusContainer'),new sap.ushell.ui.launchpad.UserStatusItem({status:sap.ushell.ui.launchpad.UserStatusItem.prototype.STATUS_ENUM.BUSY,id:"userStatusItem3",isOpener:false,press:function(E){f(sap.ushell.ui5service.UserStatus.prototype.AvailableStatus.BUSY);}.bind(this)}).addStyleClass('sapUserStatusContainer'),new sap.ushell.ui.launchpad.UserStatusItem({status:sap.ushell.ui.launchpad.UserStatusItem.prototype.STATUS_ENUM.APPEAR_OFFLINE,id:"userStatusItem4",isOpener:false,press:function(E){f(sap.ushell.ui5service.UserStatus.prototype.AvailableStatus.APPEAR_OFFLINE);}.bind(this)}).addStyleClass('sapUserStatusContainer')];if(!C.disableSignOut){U.push(new sap.ushell.ui.launchpad.UserStatusItem({status:sap.ushell.ui.launchpad.UserStatusItem.prototype.STATUS_ENUM.SIGNOUT,id:"userStatusLogout",isOpener:false,press:[c.logout,c]}).addStyleClass('sapUserStatusSignOutContainer'));}var a=new sap.m.List({id:"sapUshellUserStatusItemList",showSeparators:"None",items:U});a.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-labelledBy",value:"userStatusItem1",writeToDom:true}));p=new sap.m.Popover("statuses",{placement:sap.m.PlacementType.Bottom,showArrow:false,showHeader:false,content:a}).addStyleClass('sapUserStatusPopOver');p.addStyleClass("sapContrastPlus");p.setOffsetX(-3);U=[new sap.m.Text({text:u}).addStyleClass('sapUshellMeAreaUserName')];var d=new sap.ushell.ui.launchpad.UserStatusItem({id:"userStatusOpener",visible:{path:"/userStatusEnabled",formatter:function(i){if(i){return true;}else{return false;}}.bind(this)},status:{path:"/userStatus",formatter:function(i){return sap.ushell.ui.launchpad.UserStatusItem.prototype.STATUS_ENUM[i];}},tooltip:t.getText("userStatus_tooltip"),image:sap.ui.core.IconPool.getIconURI("account"),press:function(E){var B=sap.ui.getCore().byId(E.mParameters.id);if(p.isOpen()){p.close();}else{p.openBy(B);}}.bind(this),contentList:p}).addStyleClass('sapUserStatusOpener');d.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"tabindex",value:"0",writeToDom:true}));d.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-label",value:sap.ushell.resources.i18n.getText("OnlineStatus")+" "+t.getText("userStatus_tooltip"),writeToDom:true}));d.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"role",value:"listbox",writeToDom:true}));U.push(d);if(!C.disableSignOut){var l;if(!b){l=new sap.m.Button("logoutBtn",{visible:{parts:["/userStatusEnabled","/userStatusUserEnabled"],formatter:function(i,v){if(i&&v){return false;}else{return true;}}.bind(this)},type:sap.m.ButtonType.Transparent,icon:'sap-icon://log',text:sap.ushell.resources.i18n.getText("signoutBtn_title"),press:[c.logout,c]});U.push(l);}else{l=new sap.ushell.ui.launchpad.ActionItem("logoutBtn",{visible:true,type:sap.m.ButtonType.Transparent,icon:'sap-icon://log',text:sap.ushell.resources.i18n.getText("signoutBtn_title"),press:[c.logout,c]});}}var e=new sap.m.VBox({tabindex:"0",items:[U]}).addStyleClass("sapUshellUserArea");var g=sap.ushell.Container.getUser().getImage(),h;if(!g){h=new sap.ui.core.Icon({src:sap.ui.core.IconPool.getIconURI("person-placeholder"),size:'4rem'});}else{h=new sap.m.Image({src:g});}h.addStyleClass("sapUshellMeAreaUserImage");var j=new sap.m.HBox({items:[h,e]});j.addStyleClass('sapUshellMeAreaUserInfo');j.addStyleClass('sapContrastPlus');var k=c.createSaveButton(),m=c.createCancelButton();this.oSettingsDialog=new sap.m.Dialog({id:"userSettingsDialog",showHeader:false,content:null,buttons:[k,m],afterClose:function(){sap.ushell.Container.getUser().resetChangedProperties();},stretch:sap.ui.Device.system.phone}).addStyleClass("sapUshellUserSetting");this.oSettingsDialog.addContent(c.getSettingsDialogContent());this.aDanglingControls.push(m,k,this.oSettingsDialog);j.addEventDelegate({onsapskipback:function(E){E.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(E);},onsaptabprevious:function(E){E.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(E);}});var A=new sap.m.OverflowToolbar({id:"overflowActions",design:sap.m.ToolbarDesign.Transparent,content:{path:"/currentState/actions",factory:function(i,v){var w=sap.ui.getCore().byId(v.getObject());if(w){if(w.setActionType){w.setActionType("action");}c._addPressHandlerToActions(w);}return w;}}}).addStyleClass('sapContrastPlus');A._getOverflowButtonSize=function(){return 82.4;};if(A._getOverflowButton){var n=A._getOverflowButton();if(n){var q=n.onAfterRendering;n.onAfterRendering=function(){if(q){q.apply(this,arguments);}this.addStyleClass('sapUshellActionItem');this.setText(sap.ushell.resources.i18n.getText('meAreaMoreActions'));};}}A.updateAggregation=function(N){var B=this.mBindingInfos[N],w=this.getMetadata().getJSONKeys()[N],x;jQuery.each(this[w._sGetter](),jQuery.proxy(function(i,v){this[w._sRemoveMutator](v);},this));jQuery.each(B.binding.getContexts(),jQuery.proxy(function(i,v){x=B.factory(this.getId()+"-"+i,v)?B.factory(this.getId()+"-"+i,v).setBindingContext(v,B.model):"";this[w._sMutator](x);},this));};if(C.enableRecentActivity){var I=new sap.m.IconTabBar('meAreaIconTabBar',{backgroundDesign:sap.m.BackgroundDesign.Transparent,expandable:false,items:[this.createIconTab("recentActivities",true,c),this.createIconTab("frequentActivities",false,c)]}).addStyleClass('sapUshellMeAreaTabBar');I.addEventDelegate({onsaptabnext:function(E){var O=E.originalEvent,i=O.srcElement,v=i.classList,w;w=jQuery.inArray('sapUshellMeAreaActivityItem',v)>-1;if(w===true){E.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(E);}},onsapskipforward:function(E){E.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(E);}});var r=I.onAfterRendering;I.onAfterRendering=function(){if(r){r.apply(this,arguments);}var T=sap.ui.getCore().byId('meAreaIconTabBar--header');if(T){T.addStyleClass('sapContrastPlus');T.addStyleClass('sapUshellTabBarHeader');}};this.actionBox=A;return new sap.m.ScrollContainer({vertical:true,horizontal:false,height:"100%",content:new sap.m.VBox("sapUshellMeAreaContent",{items:[j,A,I]})});}else{A.addEventDelegate({onsaptabnext:function(E){var O=E.originalEvent,i=O.srcElement,v=jQuery('.sapUshellActionItem:last')[0].id,w;w=v===i.id;if(w===true){E.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(E);}},onsapskipforward:function(E){E.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(E);}});}return new sap.m.ScrollContainer({vertical:true,horizontal:false,height:"100%",content:new sap.m.VBox("sapUshellMeAreaContent",{items:[j,A]})});},createIconTab:function(i,s,c){jQuery.sap.require('sap.m.StandardListItem');var a=function(b,C){var d=C.getProperty("icon");var t=C.getProperty("title");var D=sap.ushell.services.AppType.getDisplayName(C.getProperty("appType"));var l={title:t,description:D,icon:d,type:sap.m.ListType.Active};if(s){l.info=C.getProperty("timestamp");}var L=new sap.m.StandardListItem(l).addStyleClass('sapUshellMeAreaActivityItem');L.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-describedby",value:I.getId(),writeToDom:true}));if(!d){L.addStyleClass('sapUshellMeAreaActivityItemNoIcon');}return L;};var I=new sap.m.IconTabFilter({id:"sapUshellIconTabBar"+i,text:sap.ushell.resources.i18n.getText(i)});var A=new sap.m.List({id:"sapUshellActivityList"+i,showSeparators:"None",items:{path:"meAreaModel>/apps/"+i,factory:a.bind(this)},noDataText:sap.ushell.resources.i18n.getText(i+'NoDataText'),itemPress:function(e){var m=this.getModel('meAreaModel'),v=sap.ui.getCore().byId("viewPortContainer");if(v){v.switchState("Center");}var p=e.getParameter('listItem').getBindingContextPath();c.setLastVisited(m.getProperty(p).url);setTimeout(function(){hasher.setHash(m.getProperty(p).url);},200);}});I.addContent(A);return I;},onViewStateShow:function(){this.getController().refreshRecentActivities();this.getController().refreshFrequentActivities();if(this.actionBox){this.actionBox.updateAggregation("content");}this.getController().updateScrollBar(hasher.getHash());},getControllerName:function(){return"sap.ushell.renderers.fiori2.meArea.MeArea";}});}());(function(){"use strict";sap.ui.controller("sap.ushell.renderers.fiori2.notifications.Settings",{onInit:function(){var t=this,s=sap.ushell.Container.getService("Notifications").readSettings(),m=new sap.ui.model.json.JSONModel(),v,n,r,d;m.setProperty("/aDitryRowsIndicator",[]);m.setProperty("/rows",[]);m.setProperty("/originalRows",[]);s.done(function(R){r=JSON.parse(R);if(r.value&&(r.value.length>0)){m.setProperty("/rows",r.value);d=JSON.parse(JSON.stringify(r.value));m.setProperty("/originalRows",d);}else{n=t.getView().getNoDataUI();t.getView().removeAllContent();t.getView().addContent(n);}});s.fail(function(){n=t.getView().getNoDataUI();t.getView().removeAllContent();t.getView().addContent(n);});this._handleSwitchFlagsDataInitialization(m);v=this.getView();v.setModel(m);},onExit:function(){},onBeforeRendering:function(){},onAfterRendering:function(){var o=this.getView().getModel().getProperty("/flags"),r=this.getView().getModel().getProperty("/rows"),d;if(r!==undefined){d=JSON.parse(JSON.stringify(r));this.getView().getModel().setProperty("/originalRows",d);}this.getView().getModel().setProperty("/originalFlags/previewNotificationEnabled",o.previewNotificationEnabled);this.getView().getModel().setProperty("/originalFlags/highPriorityBannerEnabled",o.highPriorityBannerEnabled);this.getView().getModel().setProperty("/aDitryRowsIndicator",[]);},getContent:function(){var d=jQuery.Deferred();d.resolve(this.getView());return d.promise();},getValue:function(){var d=jQuery.Deferred();d.resolve(" ");return d.promise();},onCancel:function(){var o=this.getView().getModel().getProperty("/originalFlags"),O=this.getView().getModel().getProperty("/originalRows"),d=JSON.parse(JSON.stringify(O));this.getView().getModel().setProperty("/flags/previewNotificationEnabled",o.previewNotificationEnabled);this.getView().getModel().setProperty("/flags/highPriorityBannerEnabled",o.highPriorityBannerEnabled);this.getView().getModel().setProperty("/rows",d);this.getView().getModel().setProperty("/originalFlags",{});this.getView().getModel().setProperty("/originalRows",[]);this.getView().getModel().setProperty("/aDitryRowsIndicator",[]);},onSave:function(){var d=jQuery.Deferred(),r=this.getView().getModel().getProperty("/rows"),o=this.getView().getModel().getProperty("/originalRows"),t,T,i,D=this.getView().getModel().getProperty("/aDitryRowsIndicator");d.resolve();this._handleSwitchFlagsSave();for(i=0;i<r.length;i++){if(D[i]&&D[i]===true){t=r[i];T=o[i];if(!this._identicalRows(t,T)){sap.ushell.Container.getService("Notifications").saveSettingsEntry(t);}}}this.getView().getModel().setProperty("/aDitryRowsIndicator",[]);return d.promise();},setControlDirtyFlag:function(){var c=this.getBindingContext().sPath,i=c.substring(c.lastIndexOf("/")+1,c.length),o=this.getModel().getProperty("/aDitryRowsIndicator");if(o!==undefined){this.getModel().setProperty("/aDitryRowsIndicator/"+i,true);}},_handleSwitchFlagsDataInitialization:function(m){var s=sap.ushell.Container.getService("Notifications").getUserSettingsFlags(),M=sap.ushell.Container.getService("Notifications")._getNotificationSettingsMobileSupport();s.done(function(S){m.setProperty("/flags",{});m.setProperty("/flags/previewNotificationEnabled",S.previewNotificationEnabled);m.setProperty("/flags/highPriorityBannerEnabled",S.highPriorityBannerEnabled);m.setProperty("/flags/mobileNotificationsEnabled",M);m.setProperty("/originalFlags",{});m.setProperty("/originalFlags/previewNotificationEnabled",S.previewNotificationEnabled);m.setProperty("/originalFlags/highPriorityBannerEnabled",S.highPriorityBannerEnabled);});},_handleSwitchFlagsSave:function(){var p=this.getView().getModel().getProperty("/flags/previewNotificationEnabled"),h=this.getView().getModel().getProperty("/flags/highPriorityBannerEnabled"),o=this.getView().getModel().getProperty("/originalFlags/previewNotificationEnabled"),O=this.getView().getModel().getProperty("/originalFlags/highPriorityBannerEnabled");if((o!==p)||(O!==h)){sap.ushell.Container.getService("Notifications").setUserSettingsFlags({previewNotificationEnabled:p,highPriorityBannerEnabled:h});if(p!==o){sap.ui.getCore().getEventBus().publish("sap.ushell.services.Notifications","enablePreviewNotificationChanged",{bPreviewEnabled:p});}this.getView().getModel().setProperty("/originalFlags/previewNotificationEnabled",p);this.getView().getModel().setProperty("/originalFlags/highPriorityBannerEnabled",h);}},_identicalRows:function(r,a){if((r.NotificationTypeId===a.NotificationTypeId)&&(r.PriorityDefault===a.PriorityDefault)&&(r.DoNotDeliver===a.DoNotDeliver)&&(r.DoNotDeliverMob===a.DoNotDeliverMob)){return true;}return false;}});}());(function(){"use strict";sap.ui.jsview("sap.ushell.renderers.fiori2.notifications.Settings",{createContent:function(c){var t=this,n,T,s,v,h,r=sap.ushell.resources.i18n;n=new sap.m.Table("notificationSettingsTable",{backgroundDesign:sap.m.BackgroundDesign.Transparent,showSeparators:sap.m.ListSeparators.All,columns:[new sap.m.Column({header:new sap.m.Text({text:r.getText("notificationType_column"),tooltip:r.getText("notificationType_columnTooltip")})}),new sap.m.Column({header:new sap.m.Text({text:r.getText("iOSNotification_column"),tooltip:r.getText("iOSNotification_columnTooltip")}),visible:"{/flags/mobileNotificationsEnabled}",minScreenWidth:"Tablet",demandPopin:true}),new sap.m.Column({header:new sap.m.Text({text:r.getText("highNotificationsBanner_column"),tooltip:r.getText("highNotificationsBanner_columnTooltip")}),minScreenWidth:"Tablet",demandPopin:true}),new sap.m.Column({header:new sap.m.Text({text:r.getText("notificationTypeEnable_column"),tooltip:r.getText("notificationTypeEnable_columnTooltip")}),hAlign:"Right"})]});n.setFixedLayout(false);T=new sap.m.ColumnListItem({cells:[new sap.m.Label({text:"{NotificationTypeDesc}"}),new sap.m.CheckBox({selected:{parts:["DoNotDeliverMob"],formatter:function(d){return!d;}},select:function(e){t.getController().setControlDirtyFlag.apply(this);var p=e.getSource().getBindingContext().sPath;if(e.mParameters.selected===true){t.getModel().setProperty(p+"/DoNotDeliverMob",false);}else{t.getModel().setProperty(p+"/DoNotDeliverMob",true);}}}),new sap.m.CheckBox({select:function(e){t.getController().setControlDirtyFlag.apply(this);var p=e.getSource().getBindingContext().sPath;if(e.mParameters.selected===true){t.getModel().setProperty(p+"/PriorityDefault","40-HIGH");}else{t.getModel().setProperty(p+"/PriorityDefault","");}},selected:{parts:["PriorityDefault"],formatter:function(p){t.getController().setControlDirtyFlag.apply(this);if(p==="40-HIGH"){return true;}return false;}}}),new sap.m.Switch({state:"{DoNotDeliver}",customTextOn:" ",customTextOff:" ",select:function(e){t.getController().setControlDirtyFlag.apply(this);},change:function(e){t.getController().setControlDirtyFlag.apply(this);}})]});n.bindAggregation("items",{path:"/rows",template:T,sorter:new sap.ui.model.Sorter("NotificationTypeDesc")});v=new sap.m.VBox();s=this.createSwitchControlBar();h=new sap.m.VBox();h.addStyleClass("sapContrastPlus");h.addItem(s);v.addItem(h);v.addItem(n);return[v];},createSwitchControlBar:function(){var d,D,o,p,e,E,s,r=sap.ushell.resources.i18n,a=sap.ui.Device.system,b=a.desktop||a.tablet||a.combi,n=sap.ushell.Container.getService("Notifications");s=new sap.m.FlexBox('notificationSettingsSwitchBar');d=new sap.m.Switch("doNotDisturbSwitch",{tooltip:r.getText("showAlertsForHighNotifications_tooltip"),state:"{/flags/highPriorityBannerEnabled}",customTextOn:" ",customTextOff:" ",mode:sap.ui.model.BindingMode.TwoWay});D=new sap.m.Label("doNotDisturbLabel",{text:r.getText("Show_High_Priority_Alerts_title")});o=new sap.m.HBox({items:[d,D]});s.addItem(o);if((n.getPreviewNotificationEnabledConfig()===true)&&(b===true)){p=new sap.m.Switch("enablePreviewSwitch",{tooltip:r.getText("showNotificationsPreview_tooltip"),state:"{/flags/previewNotificationEnabled}",customTextOn:" ",customTextOff:" ",mode:sap.ui.model.BindingMode.TwoWay});e=new sap.m.Label("enablePreviewLabel",{text:r.getText("Show_Preview_in_Home_Page_title")});E=new sap.m.FlexBox({items:[p,e]});s.addItem(E);}return s;},getNoDataUI:function(){var n,N,o,a,r=sap.ushell.resources.i18n;if(n===undefined){N=new sap.ui.core.Icon("notificationSettingsNoDataIcon",{size:"2.25rem",src:"sap-icon://message-information"});o=new sap.m.Text("notificationSettingsNoDataTextHeader",{text:r.getText("noNotificationTypesEnabledHeader_message")}).setTextAlign(sap.ui.core.TextAlign.Center);a=new sap.m.Text("notificationSettingsNoDataText",{text:r.getText("noNotificationTypesEnabled_message")}).setTextAlign(sap.ui.core.TextAlign.Center);n=new sap.m.VBox("notificationSettingsNoDataInnerBox",{items:[N,o,a]});}return n;},getControllerName:function(){return"sap.ushell.renderers.fiori2.notifications.Settings";}});}());(function(){"use strict";sap.ui.controller("sap.ushell.renderers.fiori2.profiling.UserProfiling",{onInit:function(){this.isContentLoaded=true;},onCancel:function(){var p=this.getView().getModel().getProperty("/userPreferences/profiling"),P,i;for(i=0;i<p.length;i++){P=p[i];if(P.onCancel){P.onCancel();}}},getValue:function(){var d=jQuery.Deferred();var p=this.getView().getModel().getProperty("/userPreferences/profiling");p.forEach(function(e,i){if(e.entryHelpID==="usageAnalytics"){if(!sap.ushell.Container.getService("UsageAnalytics").systemEnabled()||!sap.ushell.Container.getService("UsageAnalytics").isSetUsageAnalyticsPermitted()){p.splice(i,1);}}},this);if(p!==undefined&&p.length>0){d.resolve({value:1,displayText:" "});}else{d.resolve({value:0,displayText:" "});}return d.promise();},onSave:function(){var r=jQuery.Deferred(),p=this.getView().getModel().getProperty("/userPreferences/profiling"),w,P=[],t=0,s=0,f=0,F=[],T,a=function(){s++;r.notify();},b=function(e){F.push({entry:"currEntryTitle",message:e});f++;r.notify();};p.forEach(function(i){T=i.onSave();T.done(a);T.fail(b);P.push(T);t++;});w=jQuery.when.apply(null,P);w.done(function(){r.resolve();});r.progress(function(){if(f>0&&(f+s===t)){r.reject("At least one save action failed");}});return r.promise();},getContent:function(){var t=this,d=jQuery.Deferred(),p=this.getView().getModel().getProperty("/userPreferences/profiling");p.forEach(function(i){var c=i.contentFunc();c.done(function(r){t.getView().profilingContent.addItem(r);});});d.resolve(t.getView());return d.promise();}});}());(function(){"use strict";sap.ui.jsview("sap.ushell.renderers.fiori2.profiling.UserProfiling",{createContent:function(c){this.profilingContent=new sap.m.VBox().addStyleClass("sapUshellUserSettingDetailContent");return this.profilingContent;},getControllerName:function(){return"sap.ushell.renderers.fiori2.profiling.UserProfiling";}});}());(function(){"use strict";sap.ui.base.Object.extend("sap.ushell.renderers.fiori2.search.SearchNavigationObject",{constructor:function(p){if(p){this.setHref(p.href);this.setText(p.text);this.setTarget(p.target);}},getHref:function(){return this._href;},setHref:function(h){this._href=h;},getText:function(){return this._text;},setText:function(t){this._text=t;},getTarget:function(){return this._target;},setTarget:function(t){this._target=t;},performNavigation:function(){if(!this._target){window.open(this._href);}else{window.open(this._href,this._target);}}});})();(function(){"use strict";sap.ui.base.ManagedObject.extend("sap.ushell.renderers.fiori2.search.controls.CustomSearchResultListItemContent",{metadata:{properties:{title:"string",titleUrl:"string",type:"string",imageUrl:"string",attributes:{type:"object",multiple:true},intents:{type:"object",multiple:true}}},init:function(){},getContent:function(){return undefined;},getTitleVisibility:function(){return true;}});})();(function(){"use strict";sap.ui.core.Control.extend("sap.ushell.renderers.fiori2.search.controls.DivContainer",{metadata:{properties:{"cssClass":"string"},aggregations:{"content":{singularName:"content",multiple:true}}},renderer:function(r,c){r.write('<div');r.writeControlData(c);r.addClass(c.getCssClass());r.writeClasses();r.write('>');var C=c.getContent();for(var i=0;i<C.length;i++){r.renderControl(C[i]);}r.write('</div>');}});})();(function(){"use strict";sap.ui.layout.FixFlex.extend("sap.ushell.renderers.fiori2.search.controls.SearchLayout",{metadata:{properties:{isBusy:{type:"boolean",defaultValue:false},showFacets:{type:"boolean",defaultValue:false}},aggregations:{"resultListContainer":{type:"sap.ui.core.Control",multiple:false},"facets":{type:"sap.ui.core.Control",multiple:false},"busyIndicator":{type:"sap.ui.core.Control",multiple:false}}},constructor:function(o,i){var t=this;sap.ui.layout.FixFlex.prototype.constructor.apply(this,[o],i);this.addEventDelegate({onAfterRendering:function(){var $=jQuery(".sapUiFixFlexFixed");if(t.getShowFacets()&&!sap.ui.Device.system.phone){$.addClass('sapUshellSearchFacetPanelOpen');}else{$.removeClass('sapUshellSearchFacetPanelOpen');}}});},getFacets:function(){return this.getFixContent();},setFacets:function(c){this.addFixContent(c);},getResultListContainer:function(){return this.getFlexContent();},setResultListContainer:function(c){this.setFlexContent(c);},setIsBusy:function(i){if(i){this.getBusyIndicator().open();this.busyFlag=true;}else if(this.busyFlag){this.getBusyIndicator().close();this.busyFlag=false;}this.setProperty("isBusy",i,true);},setShowFacets:function(a){var $=jQuery(".sapUiFixFlexFixed");var b=jQuery(".sapUshellSearchResultListsContainer");if(!a){b.removeClass("sapUshellSearchFacetPanelOpen");$.removeClass("sapUshellSearchFacetPanelOpen");$.attr("aria-hidden","true");}else{b.addClass("sapUshellSearchFacetPanelOpen");$.addClass("sapUshellSearchFacetPanelOpen");$.attr("aria-hidden","false");}var h=function(e){sap.ui.getCore().getEventBus().publish("searchLayoutChanged");};$.one("transitionend",h);this.setProperty("showFacets",a,true);return this;},renderer:"sap.ui.layout.FixFlexRenderer"});})();(function(){"use strict";sap.ui.core.Control.extend("sap.ushell.renderers.fiori2.search.controls.SearchMultiSelectionControl",{metadata:{properties:{resultList:"object"},aggregations:{actions:"object"}},renderer:function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapUshellSearchResultList-MultiSelectionControl");r.writeClasses();r.write(">");c._renderer(r);r.write("</div>");},_renderer:function(r){var t=this;var e=new sap.m.ToggleButton({icon:"sap-icon://multi-select",tooltip:sap.ushell.resources.i18n.getText("toggleSelectionModeBtn"),press:function(){if(this.getPressed()){t.getResultList.enableSelectionMode();t.getModel().setProperty("/multiSelectionEnabled",true);}else{t.getResultList.disableSelectionMode();t.getModel().setProperty("/multiSelectionEnabled",false);}},visible:false,pressed:{parts:[{path:'/multiSelectionEnabled'}],formatter:function(l){return l>0;},mode:sap.ui.model.BindingMode.OneWay}});e.setModel(t.getModel());e.addStyleClass("sapUshellSearchResultList-toggleMultiSelectionButton");r.renderControl(e);}});})();(function(){"use strict";sap.ui.core.Control.extend("sap.ushell.renderers.fiori2.search.controls.SearchRelatedObjectsToolbar",{metadata:{properties:{navigationObjects:{type:"object",multiple:true}}},init:function(p){this.oCrossAppNav=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation");},renderer:function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapUshellSearchResultListItem-RelatedObjectsToolbar");r.writeClasses();r.write(">");c._renderToolbar(r);r.write("</div>");},_renderToolbar:function(r){var t=this;var i;var c=function(l){return function(){var m=sap.ushell.renderers.fiori2.search.getModelSingleton();m.analytics.logCustomEvent('FLP: Search','Launch Related Object',[l]);};};var n=t.getNavigationObjects();if(n.length>0){var a=[];for(i=0;i<n.length;i++){var b=n[i];var l=new sap.m.Link({text:b.getText(),href:b.getHref(),layoutData:new sap.m.ToolbarLayoutData({shrinkable:false}),press:c(b.getHref())});var d=b.getTarget();if(d){l.setTarget(d);}l.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-Element");a.push(l);}var e=[];var f=new sap.m.ToolbarSpacer();e.push(f);for(i=0;i<a.length;i++){e.push(a[i]);}t.overFlowButton=new sap.m.Button({icon:sap.ui.core.IconPool.getIconURI("overflow")});t.overFlowButton.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-OverFlowButton");e.push(t.overFlowButton);t.overFlowSheet=new sap.m.ActionSheet({placement:sap.m.PlacementType.Top});t.overFlowButton.attachPress(function(){t.overFlowSheet.openBy(t.overFlowButton);});t.relatedObjectActionsToolbar=new sap.m.Toolbar({design:sap.m.ToolbarDesign.Solid,content:e});t.relatedObjectActionsToolbar.data("sap-ui-fastnavgroup","false",true);t.relatedObjectActionsToolbar.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-Toolbar");r.renderControl(t.relatedObjectActionsToolbar);}},onAfterRendering:function(){var t=this;if(t.overFlowButton){var a=$(t.overFlowButton.getDomRef());a.css("display","none");}$(window).on("resize",function(){t._layoutToolbarElements();});t._layoutToolbarElements();},_layoutToolbarElements:function(){var t=this;if(!(t.getDomRef()&&t.relatedObjectActionsToolbar.getDomRef())){return;}var a=$(t.relatedObjectActionsToolbar.getDomRef());var b=a.innerWidth();if(b===0||(t.toolbarWidth&&t.toolbarWidth===b)){return;}if($(t.getDomRef()).css("display")==="none"||a.css("display")==="none"){return;}t.toolbarWidth=b;var c=$(t.overFlowButton.getDomRef());c.css("display","none");var d=0;var p=function(j,k){k.performNavigation();};var e=a.find(".sapUshellSearchResultListItem-RelatedObjectsToolbar-Element");for(var i=0;i<e.length;i++){var f=$(e[i]);f.css("display","");var _=d+f.outerWidth(true);if(_>b){if(i<e.length){c.css("display","");var o=c.outerWidth(true);for(;i>=0;i--){f=$(e[i]);_-=f.outerWidth(true);if(_+o<=b){break;}}}var n=t.getNavigationObjects();t.overFlowSheet.destroyButtons();for(;i<e.length;i++){f=$(e[i]);f.css("display","none");var g=n[i];var h=new sap.m.Button({text:g.getText()});h.attachPress(g,p);t.overFlowSheet.addButton(h);}break;}d=_;}t._setupItemNavigation();},_setupItemNavigation:function(){var t=this;if(!t.theItemNavigation){t.theItemNavigation=new sap.ui.core.delegate.ItemNavigation();t.addDelegate(t.theItemNavigation);}t.theItemNavigation.setCycling(false);t.theItemNavigation.setRootDomRef(t.getDomRef());var a=[];var c=t.relatedObjectActionsToolbar.getContent();for(var i=0;i<c.length;i++){if(!c[i].hasStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-Element")){continue;}if(!$(c[i].getDomRef()).attr("tabindex")){var b="-1";if(c[i].getPressed&&c[i].getPressed()){b="0";}$(c[i].getDomRef()).attr("tabindex",b);}a.push(c[i].getDomRef());}var _=t.overFlowButton.getDomRef();a.push(_);$(_).attr("tabindex","-1");t.theItemNavigation.setItemDomRefs(a);}});})();(function(){"use strict";sap.ui.core.Control.extend("sap.ushell.renderers.fiori2.search.controls.SearchResultListContainer",{init:function(){this.data("sap-ui-fastnavgroup","true",true);},metadata:{aggregations:{"filterBar":{type:"sap.ui.core.Control",multiple:false},"centerArea":{singularName:"content"},"totalCountBar":{type:"sap.ui.core.Control",multiple:false},"didYouMeanBar":{type:"sap.ui.core.Control",multiple:false},"noResultScreen":{type:"sap.ui.core.Control",multiple:false}}},renderer:function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapUshellSearchResultListsContainer");r.addClass("sapUiResponsiveMargin");if(c.getModel()&&c.getModel().getFacetVisibility()===true){r.addClass("sapUshellSearchFacetPanelOpen");}r.writeClasses();r.write('>');r.renderControl(c.getNoResultScreen());r.renderControl(c.getDidYouMeanBar());r.write('<div class="sapUshellSearchTotalCountBar">');r.renderControl(c.getTotalCountBar());r.write("</div>");for(var i=0;i<c.getCenterArea().length;i++){r.renderControl(c.getCenterArea()[i]);}r.write("</div>");}});})();(function(){"use strict";sap.m.Table.extend('sap.ushell.renderers.fiori2.search.controls.SearchResultTable',{renderer:'sap.m.TableRenderer'});})();(function(){"use strict";sap.ui.controller("sap.ushell.renderers.fiori2.theme_selector.ThemeSelector",{onInit:function(){try{this.userInfoService=sap.ushell.Container.getService("UserInfo");this.oUser=this.userInfoService.getUser();}catch(e){jQuery.sap.log.error("Getting UserInfo service failed.");this.oUser=sap.ushell.Container.getUser();}this.currentThemeId=this.oUser.getTheme();this.origThemeId=this.currentThemeId;this.aThemeList=null;this.isContentLoaded=false;this.aSapThemeMap={"base":"sapUshellBaseIconStyle","sap_bluecrystal":"sapUshellBlueCrystalIconStyle","sap_hcb":"sapUshellHCBIconStyle","sap_belize":"sapUshellBelizeIconStyle","sap_belize_plus":"sapUshellPlusIconStyle"};},getConfigurationModel:function(){var c=new sap.ui.model.json.JSONModel({});c.setData({isRTL:sap.ui.getCore().getConfiguration().getRTL(),sapUiContentIconColor:sap.ui.core.theming.Parameters.get('sapUiContentIconColor'),isContentDensitySwitchEnable:this.isContentDensitySwitchEnable(),flexAlignItems:sap.ui.Device.system.phone?'Stretch':'Center',textAlign:sap.ui.Device.system.phone?'Left':'Right',textDirection:sap.ui.Device.system.phone?'Column':'Row',labelWidth:sap.ui.Device.system.phone?"auto":"12rem"});return c;},_getIsChangeThemePermitted:function(){return this.oUser.isSetThemePermitted();},onAfterRendering:function(){var l=sap.ui.getCore().byId("userPrefThemeSelector--themeList"),i=l.getItems(),I,t,a=this;l.toggleStyleClass("sapUshellThemeListDisabled",!this.isListActive());i.forEach(function(L){t=L.getCustomData()[0].getValue();I=L.getContent()[0].getItems()[0].getItems()[0];if(!a.isListActive()){L.isSelectable=function(){return false;};}if(t===a.currentThemeId){L.setSelected(true);if(!a.isListActive()){L.toggleStyleClass("sapUshellThemeListItemSelected",true);}}else{L.setSelected(false);}I.addStyleClass(a.aSapThemeMap[t]);});if(this.isContentDensitySwitchEnable()){var c=sap.ui.getCore().byId("userPrefThemeSelector--contentDensitySwitch");if(c){c.setState(this.currentContentDensity==="cozy");}}},getContent:function(){var t=this;var d=jQuery.Deferred();var r=sap.ushell.resources.getTranslationModel();this.getView().setModel(r,"i18n");this.getView().setModel(this.getConfigurationModel(),"config");if(this.isContentDensitySwitchEnable()){this.origContentDensity=this.currentContentDensity;if(this.oUser.getContentDensity()){this.currentContentDensity=this.oUser.getContentDensity();}else{this.currentContentDensity="cozy";}}if(this.isContentLoaded===true){d.resolve(this.getView());}else{var a=this._getThemeList();a.done(function(T){if(T.length>0){T.sort(function(b,c){var e=b.name,f=c.name;if(e<f){return-1;}if(e>f){return 1;}return 0;});for(var i=0;i<T.length;i++){if(T[i].id==t.currentThemeId){T[i].isSelected=true;}else{T[i].isSelected=false;}}t.getView().getModel().setProperty("/options",T);d.resolve(t.getView());}else{d.reject();}});a.fail(function(){d.reject();});}return d.promise();},getValue:function(){var d=jQuery.Deferred();var t=this._getThemeList();var a=this;var b;t.done(function(T){a.aThemeList=T;b=a._getThemeNameById(a.currentThemeId);d.resolve(b);});t.fail(function(e){d.reject(e);});return d.promise();},onCancel:function(){this.currentThemeId=this.oUser.getTheme();if(this.isContentDensitySwitchEnable()){this.currentContentDensity=this.oUser.getContentDensity();}},onSave:function(){var r=jQuery.Deferred(),w,p=[],t=0,s=0,f=0,F=[],a=function(){s++;r.notify();},b=function(e){F.push({entry:"currEntryTitle",message:e});f++;r.notify();};var T=this.onSaveThemes();T.done(a);T.fail(b);p.push(T);if(this.isContentDensitySwitchEnable()){var c=this.onSaveContentDensity();c.done(a);c.fail(b);p.push(c);}w=jQuery.when.apply(null,p);w.done(function(){r.resolve();});r.progress(function(){if(f>0&&(f+s===t)){r.reject("At least one save action failed");}});return r.promise();},onSaveThemes:function(){var d=jQuery.Deferred();var u;if(this.oUser.getTheme()!=this.currentThemeIprofilingEntriesd){if(this.currentThemeId){this.oUser.setTheme(this.currentThemeId);u=this.userInfoService.updateUserPreferences(this.oUser);u.done(function(){this.origThemeId=this.currentThemeId;this.oUser.resetChangedProperties();d.resolve();}.bind(this));u.fail(function(e){this.oUser.setTheme(this.origThemeId);this.oUser.resetChangedProperties();this.currentThemeId=this.origThemeId;jQuery.sap.log.error(e);d.reject(e);}.bind(this));}else{d.reject("Could not find theme: "+this.currentThemeId);}}else{d.resolve();}return d.promise();},_getThemeList:function(){var d=jQuery.Deferred();if(this.aThemeList==null){if(this._getIsChangeThemePermitted()==true){var g=this.userInfoService.getThemeList();g.done(function(D){d.resolve(D.options);});g.fail(function(){d.reject("Failed to load theme list.");});}else{d.resolve([this.currentThemeId]);}}else{d.resolve(this.aThemeList);}return d.promise();},getCurrentThemeId:function(){return this.currentThemeId;},setCurrentThemeId:function(n){this.currentThemeId=n;},_getThemeNameById:function(t){if(this.aThemeList){for(var i=0;i<this.aThemeList.length;i++){if(this.aThemeList[i].id==t){return this.aThemeList[i].name;}}}return t;},onSaveContentDensity:function(){var d=jQuery.Deferred();var u;if(this.oUser.getContentDensity()!=this.currentContentDensity){if(this.currentContentDensity){this.oUser.setContentDensity(this.currentContentDensity);u=this.userInfoService.updateUserPreferences(this.oUser);u.done(function(){this.oUser.resetChangedProperties();this.origContentDensity=this.currentContentDensity;sap.ui.getCore().getEventBus().publish("launchpad","toggleContentDensity",{contentDensity:this.currentContentDensity});d.resolve();}.bind(this));u.fail(function(e){this.oUser.setContentDensity(this.origContentDensity);this.oUser.resetChangedProperties();this.currentContentDensity=this.origContentDensity;jQuery.sap.log.error(e);d.reject(e);}.bind(this));}else{d.reject("Could not find mode: "+this.currentContentDensity);}}else{d.resolve();}return d.promise();},getCurrentContentDensity:function(){return this.currentContentDensity;},setCurrentContentDensity:function(e){var n=e.getSource().getState()?"cozy":"compact";this.currentContentDensity=n;},getIconFormatter:function(t){if(this.aSapThemeMap[t]){return"";}else{return"sap-icon://palette";}},onSelectHandler:function(e){var i=e.getParameters().listItem;this.setCurrentThemeId(i.getBindingContext().getProperty("id"));},isContentDensitySwitchEnable:function(){return sap.ui.Device.system.combi&&this.getView().getModel().getProperty("/contentDensity");},isListActive:function(){return this.getView().getModel().getProperty("/setTheme");}});}());(function(){"use strict";sap.ui.controller("sap.ushell.renderers.fiori2.usageAnalytics_selector.UsageAnalyticsSelector",{onInit:function(){this.oUser=sap.ushell.Container.getUser();this.switchStateValue=this.oUser.getTrackUsageAnalytics();this.getView().oSwitchButton.setState(this.switchStateValue);},getContent:function(){var t=this,d=jQuery.Deferred();d.resolve(t.getView());return d.promise();},getValue:function(){var d=jQuery.Deferred(),i=sap.ushell.resources.i18n;d.resolve(this.switchStateValue?i.getText("trackingEnabled"):i.getText("trackingDisabled"));return d.promise();},onSave:function(){var c=this.getView().oSwitchButton.getState();this.switchStateValue=c;return sap.ushell.Container.getService("UsageAnalytics").setTrackUsageAnalytics(c);},onCancel:function(){this.getView().oSwitchButton.setState(this.switchStateValue);}});}());(function(){"use strict";sap.ui.controller("sap.ushell.renderers.fiori2.userAccount.UserAccountSelector",{onInit:function(){var v=this.getView();var m=new sap.ui.model.json.JSONModel();var u=sap.ushell.Container.getUser();var n=u.getFullName();var M=u.getEmail();var a={name:n,mail:M,server:window.location.host};m.setData(a);this.oModel=m;v.setModel(m);},getContent:function(){var d=jQuery.Deferred();d.resolve(this.getView());return d.promise();},getValue:function(){var d=jQuery.Deferred();d.resolve(sap.ushell.Container.getUser().getFullName());return d.promise();},onCancel:function(){},onSave:function(){var d=jQuery.Deferred();d.resolve();return d.promise();}});}());(function(){"use strict";sap.ui.jsview("sap.ushell.renderers.fiori2.userAccount.UserAccountSelector",{createContent:function(c){var i=sap.ushell.resources.i18n;var f=sap.ui.Device.system.phone?'Column':'Row';var F=sap.ui.Device.system.phone?'Stretch':'Center';var t=sap.ui.Device.system.phone?'Left':'Right';var l=sap.ui.Device.system.phone?"auto":"12rem";var n=new sap.m.Label({text:i.getText("UserAccountNameFld")+":",width:l,textAlign:t});var a=new sap.m.Input("userAccountuserName",{value:"{/name}",editable:false}).addAriaLabelledBy(n);a.addEventDelegate({onfocusin:function(){jQuery("#userAccountuserName input").blur();}});var b=new sap.m.FlexBox({alignItems:F,direction:f,items:[n,a]});var e=new sap.m.Label({text:i.getText("UserAccountEmailFld")+":",width:l,textAlign:t});var d=new sap.m.FlexBox({alignItems:F,direction:f,items:[e,new sap.m.Input({value:"{/mail}",editable:false}).addAriaLabelledBy(e)]});var s=new sap.m.Label({text:i.getText("UserAccountServerFld")+":",width:l,textAlign:t});var g=new sap.m.FlexBox({alignItems:F,direction:f,items:[s,new sap.m.Input({value:"{/server}",editable:false}).addAriaLabelledBy(s)]});var v=new sap.m.VBox({items:[b,d,g]});v.addStyleClass("sapUiSmallMargin");return v;},getControllerName:function(){return"sap.ushell.renderers.fiori2.userAccount.UserAccountSelector";}});}());(function(){"use strict";sap.ui.controller("sap.ushell.renderers.fiori2.userPreferences.LanguageRegionSelector",{onInit:function(){var v=this.getView();var m=new sap.ui.model.json.JSONModel();var u=sap.ushell.Container.getUser();var l=u.getLanguage();var a={languageList:[{text:l,key:l}],selectedLanguage:this._getFormatedLanguage(l)};var L=sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale(),o=sap.ui.core.LocaleData.getInstance(L);var d=o.getDatePattern("medium");var t=o.getTimePattern("medium");a.datePatternList=[{text:d,key:d}];a.selectedDatePattern=d;var h=v.hourFormatSegmentedButton.getButtons();var s=(t.indexOf("H")===-1)?h[0]:h[1];v.hourFormatSegmentedButton.setSelectedButton(s);m.setData(a);this.oModel=m;v.setModel(m);},getContent:function(){var d=jQuery.Deferred();d.resolve(this.getView());return d.promise();},getValue:function(){var d=jQuery.Deferred();d.resolve(this.oModel.getProperty("/selectedLanguage"));return d.promise();},onCancel:function(){},onSave:function(){var d=jQuery.Deferred();d.resolve();return d.promise();},_getFormatedLanguage:function(l){if(l&&l.indexOf('-')>-1){l=l.replace('-',' (').concat(')').toUpperCase();}else if(l){l=l.toUpperCase();}return l;}});}());(function(){"use strict";sap.ui.jsview("sap.ushell.renderers.fiori2.userPreferences.LanguageRegionSelector",{createContent:function(c){var i=new sap.ui.core.Item({text:"{text}",key:"{key}"});var a=sap.ushell.resources.i18n;var f=sap.ui.Device.system.phone?'Column':'Row';var F=sap.ui.Device.system.phone?'Stretch':'Center';var t=sap.ui.Device.system.phone?'Left':'Right';var l=sap.ui.Device.system.phone?"auto":"12rem";var C=sap.ui.Device.system.phone?"100%":undefined;var b=new sap.m.Label('languageSelectionLabel',{text:{path:"/selectedLanguage",formatter:function(s){return a.getText(s.indexOf('(')>-1?"languageAndRegionTit":"languageRegionFld")+':';}},width:l,textAlign:t});var d=new sap.m.FlexBox({alignItems:F,direction:f,items:[b,new sap.m.Input('languageSelectionInput',{value:"{/selectedLanguage}",editable:false}).addAriaLabelledBy(b)]});var e=new sap.m.Label({text:a.getText("dateFormatFld")+":",width:l,textAlign:t});var g=new sap.m.FlexBox({alignItems:F,direction:f,items:[e,new sap.m.ComboBox({width:C,items:{path:"/datePatternList",template:i},selectedKey:"{/selectedDatePattern}",editable:false}).addAriaLabelledBy(e)]});this.hourFormatSegmentedButton=new sap.m.SegmentedButton({enabled:false,width:"10rem",buttons:[new sap.m.Button({text:a.getText("btn12h")}),new sap.m.Button({text:a.getText("btn24h")})]});var h=new sap.m.FlexBox({alignItems:F,direction:f,items:[new sap.m.Label({text:a.getText("timeFormatFld")+":",width:l,textAlign:t}),this.hourFormatSegmentedButton]});var v=new sap.m.VBox({items:[d,g,h]});v.addStyleClass("sapUiSmallMargin");return v;},getControllerName:function(){return"sap.ushell.renderers.fiori2.userPreferences.LanguageRegionSelector";}});}());(function(){"use strict";sap.ui.jsview("sap.ushell.renderers.fiori2.user_actions.user_preferences.UserSettings",{createContent:function(c){jQuery.sap.require('sap.ushell.resources');this.aDanglingControls=[];this.translationBundle=sap.ushell.resources.i18n;return this.getMainControl(c);},getMainControl:function(c){this.oMainApp=new sap.m.SplitApp({id:"settingsApp",masterPages:c.createMasterPages(),defaultTransitionNameDetail:"show"});this.splitAppHeaderBar=new sap.m.Bar({contentMiddle:new sap.m.Text({text:sap.ushell.resources.i18n.getText("userSettings")})});var p=new sap.m.Page({content:[this.oMainApp],customHeader:this.splitAppHeaderBar,showHeader:true}).addStyleClass('sapUshellSettingsPage');this.aDanglingControls.push(p);this.oMainApp._oDetailNav.setAutoFocus(false);return p;},getSplitApp:function(){return this.oMainApp;},getControllerName:function(){return"sap.ushell.renderers.fiori2.user_actions.user_preferences.UserSettings";}});}());sap.ui.controller("sap.ushell.ui.footerbar.SaveAsTile",{onExit:function(){"use strict";var v=this.getView();var t=v.getTileView();t.destroy();},onInit:function(){"use strict";var a=sap.ushell.services.AppConfiguration.getMetadata();this.oPageBuilderService=sap.ushell.Container.getService("LaunchPage");this.oView=this.getView();this.appData=this.oView.viewData.appData||{};if(!jQuery.isEmptyObject(this.appData)){this.oModel=new sap.ui.model.json.JSONModel({showGroupSelection:this.appData.showGroupSelection===false?false:true,title:this.appData.title?this.appData.title.substring(0,256):'',subtitle:this.appData.subtitle?this.appData.subtitle.substring(0,256):'',numberValue:'',info:this.appData.info?this.appData.info.substring(0,256):'',icon:this.appData.icon||a.icon,numberUnit:this.appData.numberUnit,keywords:this.appData.keywords||'',groups:[]});this.oView.setModel(this.oModel);}},calcTileDataFromServiceUrl:function(s){"use strict";var t=this;OData.read({requestUri:s},function(r){if(typeof r==="string"){r={number:r};}t.oModel.setProperty('/numberValue',r.number);var k=["infoState","stateArrow","numberState","numberDigits","numberFactor","numberUnit"];for(var i=0;i<k.length;i++){var a=k[i];if(r[a]){t.oModel.setProperty('/'+a,r[a]);}}},function(e){window.console.log(e);},{read:function(r){r.data=JSON.parse(r.body).d;}});},loadPersonalizedGroups:function(){"use strict";var g=this.oPageBuilderService.getGroups(),t=this,d=jQuery.Deferred();g.done(function(G){var p=t.loadGroupsFromArray(G);p.done(function(a){d.resolve(a);});});return d;},loadGroupsFromArray:function(g){"use strict";var t=this,d=jQuery.Deferred(),m=t.oView.getModel();this.oPageBuilderService.getDefaultGroup().done(function(D){g=g.filter(function(a){return(!t.oPageBuilderService.isGroupLocked(a)&&t.oPageBuilderService.isGroupVisible(a));}).map(function(a){return{title:(a===D&&t.getLocalizedText("my_group"))||t.oPageBuilderService.getGroupTitle(a),object:a};});m.setProperty('/groups',g);m.setProperty("/groups/length",g.length);d.resolve();});return d;},getLocalizedText:function(m,p){"use strict";return p?sap.ushell.resources.i18n.getText(m,p):sap.ushell.resources.i18n.getText(m);}});(function(){"use strict";sap.ui.jsview("sap.ushell.ui.footerbar.SaveAsTile",{getControllerName:function(){return"sap.ushell.ui.footerbar.SaveAsTile";},createContent:function(c){this.oResourceBundle=sap.ushell.resources.i18n;this.viewData=this.getViewData()||{};this.appData=this.viewData.appData||{};this.oTitleInput=new sap.m.Input('bookmarkTitleInput',{tooltip:this.oResourceBundle.getText("bookmarkDialogoTitle_tooltip"),value:{path:"/title",mode:sap.ui.model.BindingMode.TwoWay}}).addStyleClass("sapUshellInputField");this.oTitleInput.addAriaLabelledBy("titleLbl");this.oSubTitleInput=new sap.m.Input('bookmarkSubTitleInput',{tooltip:this.oResourceBundle.getText("bookmarkDialogoSubTitle_tooltip"),value:{path:"/subtitle",mode:sap.ui.model.BindingMode.TwoWay}}).addStyleClass("sapUshellInputField");this.oSubTitleInput.addAriaLabelledBy("subtitleLbl");this.oInfoInput=new sap.m.Input('bookmarkInfoInput',{tooltip:this.oResourceBundle.getText("bookmarkDialogoInfo_tooltip"),value:{path:"/info",mode:sap.ui.model.BindingMode.TwoWay}}).addStyleClass("sapUshellInputField");this.oInfoInput.addAriaLabelledBy("infoLbl");var t={numberValue:"{/numberValue}",title:"{/title}",subtitle:"{/subtitle}",info:"{/info}",icon:"{/icon}",infoState:"{/infoState}",numberFactor:"{/numberFactor}",numberUnit:"{/numberUnit}",numberDigits:"{/numberDigits}",numberState:"{/numberState}",stateArrow:"{/stateArrow}",targetURL:"{/targetURL}",keywords:"{/keywords}"},p=function(b){var r=b;switch(b){case"Positive":r="Good";break;case"Negative":r="Critical";break;}return r;};var T,s;if(this.viewData.serviceUrl){T=new sap.m.GenericTile({header:t.title,subheader:t.subtitle,size:"Auto",tileContent:[new sap.m.TileContent({size:"Auto",footer:t.info,unit:t.numberUnit,content:[new sap.m.NumericContent({scale:t.numberFactor,value:t.numberValue,truncateValueTo:5,valueColor:p(t.numberState),indicator:t.stateArrow,icon:t.icon,width:"100%"})]})]});s=(typeof(this.viewData.serviceUrl)==="function")?this.viewData.serviceUrl():this.viewData.serviceUrl;c.calcTileDataFromServiceUrl(s);}else{T=new sap.m.GenericTile({header:t.title,subheader:t.subtitle,size:"Auto",tileContent:[new sap.m.TileContent({size:"Auto",footer:t.info,content:new sap.m.NumericContent({icon:t.icon,value:' ',width:"100%"})})]});}this.setTileView(T);var a=new sap.ushell.ui.launchpad.Tile({"long":false,tileViews:[T],afterRendering:function(e){var j=jQuery(this.getDomRef()),b=j.find(".sapMGT");b.removeAttr("tabindex");}}).addStyleClass("sapUshellBookmarkFormPreviewTileMargin");var P=new sap.m.Label("previewLbl",{text:" "+this.oResourceBundle.getText('previewFld')}),o=new sap.m.Label("titleLbl",{required:true,text:" "+this.oResourceBundle.getText('titleFld'),labelFor:this.oTitleInput}),S=new sap.m.Label("subtitleLbl",{text:this.oResourceBundle.getText('subtitleFld'),labelFor:this.oSubTitleInput}),i=new sap.m.Label("infoLbl",{text:this.oResourceBundle.getText('infoMsg'),labelFor:this.oInfoInput}),h=new sap.m.HBox("saveAsTileHBox",{items:[a],alignItems:sap.m.FlexAlignItems.Center,justifyContent:sap.m.FlexJustifyContent.Center}).addStyleClass("sapUshellShellBG").addStyleClass("sapUshellBookmarkFormPreviewBoxBottomMargin");o.setLabelFor('bookmarkTitleInput');S.setLabelFor('bookmarkSubTitleInput');i.setLabelFor('bookmarkInfoInput');var g=new sap.m.Label("groupLbl",{text:this.oResourceBundle.getText('GroupListItem_label'),visible:"{/showGroupSelection}"});this.oGroupsSelect=new sap.m.Select("groupsSelect",{tooltip:this.oResourceBundle.getText('bookmarkDialogoGroup_tooltip'),items:{path:"/groups",template:new sap.ui.core.ListItem({text:"{title}"})},width:"100%",visible:{parts:["/showGroupSelection","/groups"],formatter:function(b,G){if(b&&!(G&&G.length)){this.oController.loadPersonalizedGroups();}return b;}.bind(this)}});this.oGroupsSelect.addAriaLabelledBy("groupLbl");return[P,h,o,this.oTitleInput,S,this.oSubTitleInput,i,this.oInfoInput,g,this.oGroupsSelect];},getTitleInput:function(){return this.oTitleInput;},getTileView:function(){return this.tileView;},setTileView:function(t){this.tileView=t;},getBookmarkTileData:function(){var s;if(this.oGroupsSelect&&this.oGroupsSelect.getSelectedItem()){s=this.oGroupsSelect.getSelectedItem().getBindingContext().getObject();}var u;if(this.viewData.customUrl){if(typeof(this.viewData.customUrl)==="function"){u=this.viewData.customUrl();}else{u=this.viewData.customUrl;}}else{u=hasher.getHash()?('#'+hasher.getHash()):window.location.href;}return{title:this.oTitleInput.getValue()?this.oTitleInput.getValue().substring(0,256).trim():'',subtitle:this.oSubTitleInput.getValue()?this.oSubTitleInput.getValue().substring(0,256).trim():'',url:u,icon:this.getModel().getProperty('/icon'),info:this.oInfoInput.getValue()?this.oInfoInput.getValue().substring(0,256).trim():'',numberUnit:this.viewData.numberUnit,serviceUrl:typeof(this.viewData.serviceUrl)==="function"?this.viewData.serviceUrl():this.viewData.serviceUrl,serviceRefreshInterval:this.viewData.serviceRefreshInterval,group:s,keywords:this.viewData.keywords};}});}());jQuery.sap.declare('sap.ushell.library-all');jQuery.sap.declare('sap.ushell.components.factsheet.views.ThingViewer.controller');jQuery.sap.declare('sap.ushell.components.flp.launchpad.appfinder.AppFinder.view');jQuery.sap.declare('sap.ushell.components.flp.launchpad.appfinder.Catalog.controller');jQuery.sap.declare('sap.ushell.components.flp.launchpad.appfinder.EasyAccess.controller');jQuery.sap.declare('sap.ushell.components.flp.launchpad.appfinder.EasyAccess.view');jQuery.sap.declare('sap.ushell.components.flp.launchpad.appfinder.GroupListPopover.controller');jQuery.sap.declare('sap.ushell.components.flp.launchpad.appfinder.GroupListPopover.view');jQuery.sap.declare('sap.ushell.components.flp.launchpad.appfinder.HierarchyApps.controller');jQuery.sap.declare('sap.ushell.components.flp.launchpad.appfinder.HierarchyFolders.controller');jQuery.sap.declare('sap.ushell.components.flp.launchpad.appfinder.HierarchyFolders.view');jQuery.sap.declare('sap.ushell.components.flp.launchpad.group_list.GroupList.controller');jQuery.sap.declare('sap.ushell.components.tiles.applauncher.StaticTile.view');jQuery.sap.declare('sap.ushell.components.tiles.applauncherdynamic.DynamicTile.view');jQuery.sap.declare('sap.ushell.components.tiles.cdm.applauncher.StaticTile.view');jQuery.sap.declare('sap.ushell.components.tiles.cdm.applauncherdynamic.DynamicTile.view');jQuery.sap.declare('sap.ushell.components.tiles.indicatorDual.DualTile.controller');jQuery.sap.declare('sap.ushell.components.tiles.indicatorDualComparison.DualComparison.controller');jQuery.sap.declare('sap.ushell.components.tiles.indicatorDualContribution.DualContribution.controller');jQuery.sap.declare('sap.ushell.components.tiles.indicatorDualDeviation.DualDeviation.controller');jQuery.sap.declare('sap.ushell.components.tiles.indicatorDualTrend.DualTrend.controller');jQuery.sap.declare('sap.ushell.components.tiles.indicatorHarveyBall.HarveyBallTile.controller');jQuery.sap.declare('sap.ushell.components.treeview.NavTree.controller');jQuery.sap.declare('sap.ushell.components.treeview.NavTree.view');jQuery.sap.declare('sap.ushell.renderers.fiori2.compactCozy_selector.CompactCozySelector.controller');jQuery.sap.declare('sap.ushell.renderers.fiori2.defaultParameters_selector.DefaultParameters.controller');jQuery.sap.declare('sap.ushell.renderers.fiori2.meArea.MeArea.controller');jQuery.sap.declare('sap.ushell.renderers.fiori2.meArea.MeArea.view');jQuery.sap.declare('sap.ushell.renderers.fiori2.notifications.Settings.controller');jQuery.sap.declare('sap.ushell.renderers.fiori2.notifications.Settings.view');jQuery.sap.declare('sap.ushell.renderers.fiori2.profiling.UserProfiling.controller');jQuery.sap.declare('sap.ushell.renderers.fiori2.profiling.UserProfiling.view');jQuery.sap.declare('sap.ushell.renderers.fiori2.search.SearchNavigationObject');jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.CustomSearchResultListItemContent');jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.DivContainer');jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchLayout');jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchMultiSelectionControl');jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchRelatedObjectsToolbar');jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchResultListContainer');jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchResultTable');jQuery.sap.declare('sap.ushell.renderers.fiori2.theme_selector.ThemeSelector.controller');jQuery.sap.declare('sap.ushell.renderers.fiori2.usageAnalytics_selector.UsageAnalyticsSelector.controller');jQuery.sap.declare('sap.ushell.renderers.fiori2.userAccount.UserAccountSelector.controller');jQuery.sap.declare('sap.ushell.renderers.fiori2.userAccount.UserAccountSelector.view');jQuery.sap.declare('sap.ushell.renderers.fiori2.userPreferences.LanguageRegionSelector.controller');jQuery.sap.declare('sap.ushell.renderers.fiori2.userPreferences.LanguageRegionSelector.view');jQuery.sap.declare('sap.ushell.renderers.fiori2.user_actions.user_preferences.UserSettings.view');jQuery.sap.declare('sap.ushell.ui.footerbar.SaveAsTile.controller');jQuery.sap.declare('sap.ushell.ui.footerbar.SaveAsTile.view');jQuery.sap.declare('sap.ushell.ui.launchpad.ViewPortState');if(!jQuery.sap.isDeclared('sap.ushell.CanvasShapesManager')){(function(){"use strict";jQuery.sap.declare("sap.ushell.CanvasShapesManager");var P=function(x,y){this.x=x||0;this.y=y||0;};P.prototype.getDistance=function(p){var x=this.x-p.x;var y=this.y-p.y;return Math.floor(Math.sqrt(x*x+y*y));};P.prototype.getSegment=function(C){if(this.x<=C.x&&this.y<=C.y){return 1;}if(this.x<=C.x&&this.y>=C.y){return 2;}if(this.x>=C.x&&this.y>=C.y){return 3;}if(this.x>=C.x&&this.y<=C.y){return 4;}};P.prototype.offset=function(o,O){this.x=this.x+o;this.y=this.y+O;};var R=function(x,X,y,Y){this.x={min:x,max:X};this.y={min:y,max:Y};};var c=(window.innerWidth>0)?window.innerWidth:screen.width;var a=(window.innerHeight>0)?window.innerHeight:screen.height;var b={cpr1:new R(0,c/4,0,a/4),cpr2:new R(c/2,c,0,a/4),cpr3:new R(c/4,3*c/4,a*3/4,a)};var r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(d){return setTimeout(d,1);};var m=function(){this.init();};m.prototype={radiusRange:{min:800,max:900},init:function(){this.Id="shell-shapes";var d={cpr1:b.cpr1,cpr2:b.cpr2,cpr3:b.cpr3},e,f,s,g,i=sap.ui.Device.system.phone;this.shapes=[];var h;for(h in d){e=Math.random(this.radiusRange.max-this.radiusRange.min)+this.radiusRange.min;f=this.getRandomPoint(d[h]);s=this._getSquarePoints(e,f);g=this._calculatebezierCurves(e,s);this.shapes.push({bezierCurves:g,centerPoint:f});}for(var j in this.shapes){var v=this._generateRandomAmorphousShapeValues();this.shapes[j]=this.makeAmorphousShape(this.shapes[j],v.edge0.edgeNum,v.edge0.xOffSet,v.edge0.yOffSet,v.edge0.xStretch);this.shapes[j]=this.makeAmorphousShape(this.shapes[j],v.edge1.edgeNum,v.edge1.xOffSet,v.edge1.yOffSet,v.edge1.xStretch);}sap.ui.Device.resize.attachHandler(this.resizeHandler,this);if(!i){sap.ui.getCore().getEventBus().subscribe("launchpad","afterSwitchState",this.startAnimation,this);}},_generateRandomAmorphousShapeValues:function(){var v={edge0:{edgeNum:0,xOffSet:0,yOffSet:0,xStretch:0},edge1:{edgeNum:0,xOffSet:0,yOffSet:0,xStretch:0}};var n=this._getRandomInt(0,3);for(var e in v){v[e].edgeNum=n;v[e].xOffSet=this._getRandomInt(200,400);v[e].yOffSet=this._getRandomInt(-200,-400);n+=this._getRandomInt(0,1)<0.5?-1:1;if(n===-1){n=3;}if(n===4){n=0;}}n=this._getRandomInt(0,1);if(n<0.5){n=n<0.25?0:1;v["edge"+n].xStretch=this._getRandomInt(0,200);}return v;},getPoint:function(x,y){return new P(x,y);},getRandomPoint:function(d){var x=Math.floor(Math.random()*(d.x.max-d.x.min)+d.x.min),y=Math.floor(Math.random()*(d.y.max-d.y.min)+d.y.min);return new P(x,y);},resizeHandler:function(){var d=jQuery('#'+this.Id)[0];if(d){d.width=window.innerWidth;d.height=window.innerHeight;this.drawShapes();}},startAnimation:function(e,d,D){var f=2500;var t,g=this.shapes[0].centerPoint.x,h=this.shapes[1].centerPoint.x,i=this.shapes[2].centerPoint.x,j,k=parseFloat(jQuery("body").css("font-size")),T=D.getParameter('to'),F=D.getParameter('from');if(!this.leftOffset||!this.rigthOffset){this.setTranslateOffset();}if(T==="RightCenter"){j=1;t=this.rigthOffset*k;}if(T==="LeftCenter"){j=-1;t=this.leftOffset*k;}if(T==="Center"){if(F==="RightCenter"){j=-1;t=this.rigthOffset*k;}if(F==="LeftCenter"){j=1;t=this.leftOffset*k;}}this.animateTranslation(g,h,i,t,f,j);},setTranslateOffset:function(){var t=sap.ui.core.theming.Parameters,l,s;if(window.matchMedia('(min-width: 1920px)').matches){l=t.get('sapUshellLeftViewPortWidthLarge');s=t.get('sapUshellRightViewPortWidthXXXLarge');}else if(window.matchMedia('(min-width: 1600px)').matches){l=t.get('sapUshellLeftViewPortWidthMedium');s=t.get('sapUshellRightViewPortWidthXXLarge');}else if(window.matchMedia('(min-width: 1440px)').matches){l=t.get('sapUshellLeftViewPortWidthMedium');s=t.get('sapUshellRightViewPortWidthXLarge');}else if(window.matchMedia('(min-width: 1280px)').matches){l=t.get('sapUshellLeftViewPortWidthMedium');s=t.get('sapUshellRightViewPortWidthLarge');}else if(window.matchMedia('(min-width: 1024px)').matches){l=t.get('sapUshellLeftViewPortWidthSmall');s=t.get('sapUshellRightViewPortWidthMedium');}else if(window.matchMedia('(min-width: 601px)').matches){l=t.get('sapUshellLeftViewPortWidthSmall');s=t.get('sapUshellRightViewPortWidthSmall');}else if(window.matchMedia('(max-width : 600px)').matches){l=(jQuery(window).width()/parseFloat(jQuery("body").css("font-size")))+"";s=(jQuery(window).width()/parseFloat(jQuery("body").css("font-size")))+"";}this.leftOffset=parseInt(l.replace("rem",""),10);this.rigthOffset=parseInt(s.replace("rem",""),10);},animateTranslation:function(d,e,f,t,g,h){var s=new Date().getTime();var i=s+g,j=t,k=t/4,l=t/2,o,n,p,q=this;var u=function(){var v=new Date().getTime(),w=1-Math.pow(1-Math.min((g-(i-v))/g,1),5);o=d+h*k*w;n=e+h*l*w;p=f+h*j*w;q.updateShapes(o,n,p);q.drawShapes();if(w<1){r(u);}};return u();},updateShapes:function(o,d,e){var t=this,f=this.shapes[0].centerPoint.x-o,g=this.shapes[1].centerPoint.x-d,h=this.shapes[2].centerPoint.x-e;this.shapes[0].centerPoint=new P(o,this.shapes[0].centerPoint.y);this.shapes[1].centerPoint=new P(d,this.shapes[1].centerPoint.y);this.shapes[2].centerPoint=new P(e,this.shapes[2].centerPoint.y);this.shapes[0].bezierCurves.forEach(function(C,i){t.shapes[0].bezierCurves[i].controlPoint1=new P(C.controlPoint1.x+f,C.controlPoint1.y);t.shapes[0].bezierCurves[i].controlPoint2=new P(C.controlPoint2.x+f,C.controlPoint2.y);t.shapes[0].bezierCurves[i].startPoint=new P(C.startPoint.x+f,C.startPoint.y);t.shapes[0].bezierCurves[i].endPoint=new P(C.endPoint.x+f,C.endPoint.y);});this.shapes[1].bezierCurves.forEach(function(C,i){t.shapes[1].bezierCurves[i].controlPoint1=new P(C.controlPoint1.x+g,C.controlPoint1.y);t.shapes[1].bezierCurves[i].controlPoint2=new P(C.controlPoint2.x+g,C.controlPoint2.y);t.shapes[1].bezierCurves[i].startPoint=new P(C.startPoint.x+g,C.startPoint.y);t.shapes[1].bezierCurves[i].endPoint=new P(C.endPoint.x+g,C.endPoint.y);});this.shapes[2].bezierCurves.forEach(function(C,i){t.shapes[2].bezierCurves[i].controlPoint1=new P(C.controlPoint1.x+h,C.controlPoint1.y);t.shapes[2].bezierCurves[i].controlPoint2=new P(C.controlPoint2.x+h,C.controlPoint2.y);t.shapes[2].bezierCurves[i].startPoint=new P(C.startPoint.x+h,C.startPoint.y);t.shapes[2].bezierCurves[i].endPoint=new P(C.endPoint.x+h,C.endPoint.y);});},makeAmorphousShape:function(s,d,x,y,e){var f,g,h;switch(d){case 0:f=s.bezierCurves[0].controlPoint1;g=s.bezierCurves[3].controlPoint2;h=this._rotatePoints(x,y,f,g);s.bezierCurves[0].controlPoint1=h[0];s.bezierCurves[3].controlPoint2=h[1];break;case 1:f=s.bezierCurves[0].controlPoint2;g=s.bezierCurves[1].controlPoint1;h=this._rotatePoints(x,y,f,g);s.bezierCurves[0].controlPoint2=h[0];s.bezierCurves[1].controlPoint1=h[1];break;case 2:f=s.bezierCurves[1].controlPoint2;g=s.bezierCurves[2].controlPoint1;h=this._rotatePoints(x,y,f,g);s.bezierCurves[1].controlPoint2=h[0];s.bezierCurves[2].controlPoint1=h[1];break;case 3:f=s.bezierCurves[2].controlPoint2;g=s.bezierCurves[3].controlPoint1;h=this._rotatePoints(x,y,f,g);s.bezierCurves[2].controlPoint2=h[0];s.bezierCurves[3].controlPoint1=h[1];break;}return s;},_rotatePoints:function(d,e,f,g){var x,y,h=[];x=f.x+d;y=f.y+e;h.push(new P(x,y));x=g.x-d;y=g.y-e;h.push(new P(x,y));return h;},_getSquarePoints:function(d,e){var s=[];s[0]=new P(e.x+d,e.y);s[1]=new P(e.x,e.y-d);s[2]=new P(e.x-d,e.y);s[3]=new P(e.x,e.y+d);return s;},_getRandomInt:function(d,e){if(d==0&&e==1){return Math.random();}return Math.floor(Math.random()*(e-d+1))+d;},_calculatebezierCurves:function(d,s){var e=[];var f;var g;var h,i;i=s[0];h=s[1];f=new P(i.x,i.y-d/2);g=new P(i.x-d/2,i.y-d);e.push({startPoint:i,endPoint:h,controlPoint1:f,controlPoint2:g});i=s[1];h=s[2];f=new P(i.x-d/2,i.y);g=new P(i.x-d,i.y+d/2);e.push({startPoint:i,endPoint:h,controlPoint1:f,controlPoint2:g});i=s[2];h=s[3];f=new P(i.x,i.y+d/2);g=new P(i.x+d/2,i.y+d);e.push({startPoint:i,endPoint:h,controlPoint1:f,controlPoint2:g});i=s[3];h=s[0];f=new P(i.x+d/2,i.y);g=new P(i.x+d,i.y-d/2);e.push({startPoint:i,endPoint:h,controlPoint1:f,controlPoint2:g});return e;},drawShapes:function(){var d=jQuery('#'+this.Id)[0],B=sap.ui.core.theming.Parameters.get("sapUshellShellBackgroundShapesColor");if(d&&d.getContext){var e=d.getContext('2d'),s,f,g,h;e.clearRect(0,0,c*2,a*2);if(B){for(var j=0;j<this.shapes.length;j++){e.beginPath();s=this.shapes[j].bezierCurves[0].startPoint;e.moveTo(s.x,s.y);for(var i=0;i<this.shapes[j].bezierCurves.length;i++){f=this.shapes[j].bezierCurves[i].endPoint;g=this.shapes[j].bezierCurves[i].controlPoint1;h=this.shapes[j].bezierCurves[i].controlPoint2;e.bezierCurveTo(Math.floor(g.x),Math.floor(g.y),Math.floor(h.x),Math.floor(h.y),Math.floor(f.x),Math.floor(f.y));}e.closePath();e.fillStyle=B;e.fill();}}}}};sap.ushell.CanvasShapesManager=new m();})();};if(!jQuery.sap.isDeclared('sap.ushell.Fiori20AdapterTest')){(function(){"use strict";jQuery.sap.declare("sap.ushell.Fiori20AdapterTest");jQuery.sap.require('sap.ui.core.UIComponent');var F={I_DEFAULT_SEARCH_DEPTH:5,B_DEFAULT_LATE_ADAPTATION:false,S_FIORI20ADAPTER_URL_PARAM_NAME:"sap-ui-xx-fiori2Adaptation",S_FIORI20ADAPTER_METADATA_PARAM_NAME:"sapFiori2Adaptation",A_WHITELIST:["fin.*","ssuite.fin.*","fscm.*","sap.fin.*","cus.sd.*","cus.o2c.*","sap.apf.*","tl.ibp.*","ux.fnd.apf.o2c.*","fnd.apf.*","fcg.sll.*","ux.fnd.generic-apf-application.*","hpa.cei.*","query.viewbrowser.s1.*","ssuite.vdm.viewbrowser.s1.*","ssuite.smartbusiness.kpi.s1.*","ssuite.smartbusiness.evaluation.s1.*","ssuite.smartbusiness.association.s1.*","ssuite.smartbusiness.drilldown.s1.*","ssuite.smartbusiness.tile.s1.*","ssuite.smartbusiness.tile.ce.s1.*","ssuite.smartbusiness.workspace.s1.*","ssuite.smartbusiness.runtime.s1.*","gs.fin.customersummarycn.display.*","gs.fin.financialstatement.structure.manage.*","gs.fin.financialstatement.display.*","uipsm.*","publicservices.her.*"],getConfiguration:function(c){var C=this._getURLParamConfiguration();if(!C){C=this._getMetadataConfiguration(c);}if(!C){C=this._getDefaultConfiguration(c);}C.iSearchDepth=C.iSearchDepth||F.I_DEFAULT_SEARCH_DEPTH;if((typeof C.iSearchDepth==="string")&&!isNaN(C.iSearchDepth)){C.iSearchDepth=parseInt(C.iSearchDepth,10);}return C;},_getURLParamConfiguration:function(){if(typeof sap.ui.getCore().getConfiguration().getFiori2Adaptation!=="function"){return;}if(!this._isURLParameterSpecified(F.S_FIORI20ADAPTER_URL_PARAM_NAME)){return;}var u=sap.ui.getCore().getConfiguration().getFiori2Adaptation(),U,s;if(typeof(u)==="boolean"){U=u;}else if(u&&(u.length>=1)){s=u;}if(!s&&(U===undefined)){return;}return{bStylePage:s?s.indexOf("style")>-1:U,bMoveTitle:s?s.indexOf("title")>-1:U,bHideBackButton:s?s.indexOf("back")>-1:U,bCollapseHeader:s?s.indexOf("collapse")>-1:U,bHierarchy:s?s.indexOf("hierarchy")>-1:U};},_getMetadataConfiguration:function(c){var a=c.getMetadata("config").getConfig(F.S_FIORI20ADAPTER_METADATA_PARAM_NAME),A,b;if(typeof(a)==="boolean"){A=a;}else if((typeof a==="object")&&!jQuery.isEmptyObject(a)){b=a;}if(!b&&(A===undefined)){return;}return{bStylePage:b?this._isSgnTrue(b["style"]):A,bMoveTitle:b?this._isSgnTrue(b["title"]):A,bHideBackButton:b?this._isSgnTrue(b["back"]):A,bCollapseHeader:b?this._isSgnTrue(b["collapse"]):A,bHierarchy:b?this._isSgnTrue(b["hierarchy"]):A,bLateAdaptation:b?this._isSgnTrue(b["lateAdaptation"]):F.B_DEFAULT_LATE_ADAPTATION};},_getDefaultConfiguration:function(c){var e=this._hasMinVersionSmallerThan(c,"1.42")&&this._isWhitelisted(c);return{bStylePage:e,bMoveTitle:e,bHideBackButton:e,bCollapseHeader:e,bHierarchy:e};},_isURLParameterSpecified:function(p){var a=jQuery.sap.getUriParameters().mParams&&jQuery.sap.getUriParameters().mParams[p];return a&&(a.length>0);},_isWhitelisted:function(c){var C=c.getMetadata().getName();for(var i=0;i<F.A_WHITELIST.length;i++){var n=F.A_WHITELIST[i].substring(0,F.A_WHITELIST[i].length-2);if(this._isPrefixedString(C,n)){return true;}}return false;},_isAdaptationRequired:function(a){for(var o in a){if(a[o]===true){return true;}}return false;},_isPrefixedString:function(s,p){return s&&p&&(s.substring(0,p.length)===p);},_hasMinVersionSmallerThan:function(c,v){var i=c.getMetadata().getManifestEntry("sap.ui5"),m=true;if(i&&i.dependencies&&i.dependencies.minUI5Version){var M=new jQuery.sap.Version(i.dependencies.minUI5Version);m=M.compareTo(new jQuery.sap.Version(v))<0;}return m;},_isSgnTrue:function(v){return(v===true)||(v==="true");}};sap.ui.core.UIComponent._fnOnInstanceInitialized=function(c){var C=c.getAggregation("rootControl");if(!C||C.getId()==="navContainerFlp"||c.getId().indexOf("application-")!==0){return;}var o=F.getConfiguration(c);if(!F._isAdaptationRequired(o)){return;}if(!sap.ui.core.service||!sap.ui.core.service.ServiceFactoryRegistry||typeof sap.ui.core.service.ServiceFactoryRegistry.get!=="function"){jQuery.sap.log.warning("Fiori20Adapter not loaded because static FactoryRegistry is not available","sap.ui.core.service.ServiceFactoryRegistry should be a function","sap.ushell.Fiori20AdapterTest");return;}var d={onBeforeRendering:function(){C.removeEventDelegate(d);var s=sap.ui.core.service.ServiceFactoryRegistry.get("sap.ushell.ui5service.ShellUIService"),S=s&&s.createInstance();if(!s||!S){jQuery.sap.log.warning("Fiori20Adapter not loaded because ShellUIService is not available","sap.ushell.ui5service.ShellUIService should be declared by configuration","sap.ushell.Fiori20AdapterTest");return;}S.then(function(s){if(s&&(s.getUxdVersion()===2)){jQuery.sap.require("sap.ushell.Fiori20Adapter");sap.ushell.Fiori20Adapter.applyTo(C,c,o,s);}},function(e){jQuery.sap.log.warning("Fiori20Adapter not loaded as ShellUIService is not available",e,"sap.ushell.Fiori20AdapterTest");});}};C.addEventDelegate(d);};})();};if(!jQuery.sap.isDeclared('sap.ushell.Layout')){(function(){"use strict";jQuery.sap.declare("sap.ushell.Layout");var C=function(s){this.init(s);};C.prototype={settings:null,tileWidth:0,tileHeight:0,tileMargin:0,curTouchMatrixCords:null,tilesInRow:null,groupsList:null,item:null,matrix:null,tiles:null,collisionLeft:false,startGroup:null,currentGroup:null,endGroup:null,init:function(s){this.curTouchMatrixCords={column:null,row:null};this.endGroup=null;this.item=null;this.matrix=null;this.tiles=null;this.collisionLeft=false;this.startGroup=null;this.currentGroup=null;this.groupsList=null;this.settings=this.settings||s;jQuery.extend(this,this.settings);this.tileWidth=this.thisLayout.styleInfo.tileWidth;this.tileHeight=this.thisLayout.styleInfo.tileHeight;this.tileMargin=this.thisLayout.styleInfo.tileMarginWidth;this.aExcludedControlClass=this.aExcludedControlClass||[];this.reorderElementsCallback=this.reorderElementsCallback||function(){};this.rightToLeft=sap.ui.getCore().getConfiguration().getRTL();},moveDraggable:function(m,a){var i=this.detectCollision(m,a);if(i){this.changePlaceholder();}},changePlaceholder:function(){var c=this.currentGroup;var t=(this.endGroup!==this.currentGroup);if(t){var a=this.thisLayout.getGroupTiles(this.currentGroup);if(this.currentGroup===this.startGroup){a=a.slice(0);a.splice(a.indexOf(this.item),1);}this.tiles=this.thisLayout.getGroupTiles(this.endGroup).slice(0);if(this.startGroup===this.endGroup){this.tiles.splice(this.tiles.indexOf(this.item),1);}this.matrix=this.thisLayout.organizeGroup(this.tiles);this.endGroup.getInnerContainerDomRef().appendChild(this.item.getDomRef());this.currentGroup=this.endGroup;if(this.thisLayout.isAnimationsEnabled()){this.thisLayout.initGroupDragMode(this.endGroup);var b=this.thisLayout.organizeGroup(a);this.thisLayout.renderLayoutGroup(c,b);}}this.removeExcludedElementsFromMatrix(this.aExcludedControlClass);var d=this.tiles||this.thisLayout.getGroupTiles(this.endGroup).slice(0);var n;if(this.matrix[this.curTouchMatrixCords.row]&&typeof this.matrix[this.curTouchMatrixCords.row][this.curTouchMatrixCords.column]=="object"){var r=this.matrix[this.curTouchMatrixCords.row][this.curTouchMatrixCords.column];var e=d.indexOf(r);var f=d.indexOf(this.item);if(this.rightToLeft){this.collisionLeft=!this.collisionLeft;}if(f>-1&&f<e){r=d[e+1];}if(r===this.item){if(t){this.reorderElementsCallback({currentGroup:c,endGroup:this.endGroup,tiles:this.tiles,item:this.item});this.reorderTilesView(d,this.endGroup);this.reorderTilesInDom();if(this.thisLayout.isAnimationsEnabled()){this.thisLayout.renderLayoutGroup(this.endGroup,this.matrix);}}return;}n=this.changeTilesOrder(this.item,r,d,this.matrix);if(n){this.reorderElementsCallback({currentGroup:c,endGroup:this.endGroup,tiles:this.tiles,item:this.item});this.reorderTilesView(n,this.endGroup);this.reorderTilesInDom();if(this.thisLayout.isAnimationsEnabled()){this.thisLayout.renderLayoutGroup(this.endGroup,this.matrix);}}return;}var m=this.findTileToPlaceAfter(this.matrix,d);if(d[m+1]==this.item){return;}if(d[m+1]){r=d[m+1];}else if(this.currentGroup.getShowPlaceholder()){r=d[0];}n=this.changeTilesOrder(this.item,r,d,this.matrix);if(n){this.reorderElementsCallback({currentGroup:c,endGroup:this.endGroup,tiles:this.tiles,item:this.item});this.reorderTilesView(n,this.endGroup);this.reorderTilesInDom();if(this.thisLayout.isAnimationsEnabled()){this.thisLayout.renderLayoutGroup(this.endGroup,this.matrix);}}},reorderTilesInDom:function(){var j=this.item.getDomRef(),s=jQuery(j).index(),a=jQuery(j).closest(".sapUshellTilesContainer-sortable"),d=this.calcDestIndexInGroup(),b=jQuery(this.endGroup.getDomRef()).find(".sapUshellTilesContainer-sortable"),c=b.find(".sapUshellTile");a.find(c[s]).remove();c=b.find(".sapUshellTile");b[0].insertBefore(j,c[d]);},calcDestIndexInGroup:function(){var l,t=0,i,j,I=false;for(i=0;i<this.matrix.length&&!I;i++){for(j=0;j<this.matrix[i].length;j++){if(this.matrix[i][j]!=undefined){if(this.item.sId!==this.matrix[i][j].sId){if(l!==this.matrix[i][j].sId){l=this.matrix[i][j].sId;t++;}}else{I=true;break;}}}}return t;},layoutStartCallback:function(e){this.init();this.item=sap.ui.getCore().byId(e.id);this.tilesInRow=this.thisLayout.getTilesInRow();this.groupsList=this.thisLayout.getGroups();this.startGroup=this.currentGroup=this.item.getParent();},layoutEndCallback:function(){if(!this.tiles){return{tile:this.item};}var r={srcGroup:this.startGroup,dstGroup:this.endGroup,tile:this.item,dstTileIndex:this.tiles.indexOf(this.item),tileMovedFlag:true};return r;},compareArrays:function(a,b){if(a.length!==b.length){return false;}for(var i=0;i<a.length;i++){if(a[i]!==b[i]){return false;}}return true;},reorderTilesView:function(t,g){this.tiles=t;this.matrix=this.thisLayout.organizeGroup(t);},changeTilesOrder:function(i,r,t,m){var n=t.slice(0);var d=n.indexOf(i);if(d>-1){n.splice(d,1);}if(r){n.splice(n.indexOf(r),0,this.item);}else{n.push(i);}if(this.currentGroup==this.endGroup){if(this.compareArrays(t,n)){return false;}var a=this.thisLayout.organizeGroup(n);var c=this.thisLayout.getTilePositionInMatrix(i,m);var b=this.thisLayout.getTilePositionInMatrix(i,a);if((c.row==b.row)&&(c.col==b.col)){return false;}}this.tiles=n;this.currentGroup=this.endGroup;return n;},setMatrix:function(n){this.matrix=n;},findTileToPlaceAfter:function(c,t){var x=(this.thisLayout.rightToLeft)?0:this.curTouchMatrixCords.column,I=(this.thisLayout.rightToLeft)?1:-1,m=0,r=c[0].length;for(var i=this.curTouchMatrixCords.row;i>=0;i--){for(var j=x;j>=0&&j<r;j+=I){if(!c[i]||typeof c[i][j]!="object"){continue;}var a=t.indexOf(c[i][j]);m=a>m?a:m;}x=c[0].length-1;}return m||(t.length-1);},detectCollision:function(m,a){var r,b,c,d=false;for(var i=0;i<this.groupsList.length;i++){var e=this.groupsList[i].getInnerContainerDomRef();r=e.getBoundingClientRect();b=!(r.right<m||r.left>m);c=!(r.bottom<a||r.top>a);if(b&&c){d=this.groupsList[i];break;}}var f=jQuery.extend({},this.curTouchMatrixCords);if(!d||d.getIsGroupLocked()){return false;}if(d){this.matrix=this.matrix||this.thisLayout.organizeGroup(this.thisLayout.getGroupTiles(d));var o=this.rightToLeft?(r.right+(-1)*m):(r.left*(-1)+m),g=(r.top*(-1)+a)/(this.tileHeight+this.tileMargin),h=o/(this.tileWidth+this.tileMargin);f={row:Math.floor(g),column:Math.floor(h)};}if((d===this.endGroup)&&(f.column===this.curTouchMatrixCords.column)&&(f.row===this.curTouchMatrixCords.row)){return false;}if(sap.ui.getCore().getConfiguration().getRTL()){this.collisionLeft=(this.curTouchMatrixCords.column-f.column)>0;}else{this.collisionLeft=(f.column-this.curTouchMatrixCords.column)>0;}if(f.column===this.curTouchMatrixCords.column){this.collisionLeft=false;}jQuery.extend(this.curTouchMatrixCords,f);this.endGroup=d;return true;},removeExcludedElementsFromMatrix:function(e){if(!e.length){return;}var n=this.matrix.map(function(r){return r.map(function(i){var a=e.some(function(c){return i instanceof c;});return(a)?undefined:i;});});this.setMatrix(n);},setExcludedControl:function(c){if(c){this.aExcludedControlClass.push(c);}},setReorderTilesCallback:function(f){if(typeof f==="function"){this.reorderElementsCallback=f;}}};var L=function(){};L.prototype={_initDeferred:jQuery.Deferred(),init:function(c){var t=function(){var s=this.getStyleInfo(this.container);if(s.tileWidth>0){this.isInited=true;this.reRenderGroupsLayout();this.layoutEngine=new C({thisLayout:this});this._initDeferred.resolve();return;}setTimeout(t,100);}.bind(this);this.cfg=c||this.cfg;this.cfg.animationsEnabled=!!this.cfg.animationsEnabled;this.minTilesinRow=2;this.container=this.cfg.container||document.getElementById('dashboardGroups');t();return this.getInitPromise();},getInitPromise:function(){return this._initDeferred.promise();},isAnimationsEnabled:function(){return this.cfg.animationsEnabled;},getLayoutEngine:function(){return this.layoutEngine;},getStyleInfo:function(c){var t=document.createElement('div'),a=c.getAttribute('id');c=a?document.getElementById(a):c;t.className="sapUshellTile";t.setAttribute('style','position: absolute; visibility: hidden;');c.appendChild(t);var b=window.getComputedStyle(t);var i={"tileMarginHeight":parseFloat(b.marginBottom,10)+parseFloat(b.marginTop,10),"tileMarginWidth":parseFloat(b.marginLeft,10)+parseFloat(b.marginRight,10),"tileWidth":t.offsetWidth,"tileHeight":t.offsetHeight,"containerWidth":c.offsetWidth-(c.style.marginLeft?parseFloat(c.style.marginLeft,10):0)};t.parentNode.removeChild(t);return i;},getGroups:function(){return this.cfg.getGroups();},getTilesInRow:function(i){return this.tilesInRow;},setTilesInRow:function(t){this.tilesInRow=t;},checkPlaceForTile:function(t,m,a,l,i){if(typeof m[a.y]==="undefined"){m.push(new Array(m[0].length));}if(typeof m[a.y+1]==="undefined"){m.push(new Array(m[0].length));}if(typeof m[a.y][a.x]!=="undefined"){return false;}var p=jQuery.extend({},a);if(i||!t.getLong()){return[p];}var c=[p];if(t.getLong()){if((a.x+1)>=m[0].length||(typeof m[p.y][p.x+1]!=="undefined")){return false;}c.push({y:p.y,x:p.x+1});}return c;},placeTile:function(t,m,c){for(var i=0;i<c.length;i++){m[c[i].y][c[i].x]=t;}},getTilePositionInMatrix:function(t,m){for(var r=0;r<m.length;r++){for(var c=0;c<m[0].length;c++){if(m[r][c]==t){return{row:r,col:c};}}}return false;},fillRowsInLine:function(m,t,s,e,I){if(!t.length){return 0;}var p=[],c,i;var a=e||s;for(i=s;i<=a&&t.length;i++){for(var j=0;j<m[0].length&&t.length;j++){c=this.checkPlaceForTile(t[0],m,{x:j,y:i},e,I);if(c){this.placeTile(t[0],m,c);p.push(t.shift());}}}var b=1,h=1;for(i=0;i<p.length;i++){b=h>b?h:b;}return b;},organizeGroup:function(t,I){var a=t.slice(0);var b=[];var c=0;b.push(new Array(I?Math.floor(this.tilesInRow/2):this.tilesInRow));while(a.length){var l=this.fillRowsInLine(b,a,c,undefined,I);c++;if(l<=1){continue;}this.fillRowsInLine(b,a,c,c+l-2);c+=(l-1)||1;}if(this.rightToLeft){for(var i=0;i<b.length;i++){b[i].reverse();}}b=this.cleanRows(b);return b;},cleanRows:function(t){var d=false;for(var r=t.length-1;r>0&&!d;r--){for(var c=0;c<t[r].length&&!d;c++){if(typeof t[r][c]==="object"){d=true;}}if(!d){t.pop();}}return t;},setGroupsLayout:function(g,m){var i;if(this.cfg.isLockedGroupsCompactLayoutEnabled&&g.getIsGroupLocked()&&m.length>0){var p=g.getDomRef().parentElement;if(this.cfg.isLockedGroupsCompactLayoutEnabled()){var t=m[0].length;if(this.rightToLeft){for(i=m[0].length-1;i>=0;i--){if(!m[0][i]){t=(m[0].length-1)-i;break;}}}else{for(i=0;i<m[0].length;i++){if(!m[0][i]){t=i;break;}}}var c=t>0?t*(this.styleInfo.tileWidth+this.styleInfo.tileMarginWidth)+this.styleInfo.tileMarginWidth:0;g.getDomRef().style.width="auto";p.style.width=c+"px";p.style.display="inline-block";}else{g.getDomRef().style.width="";p.style.width="";p.style.display="";}}},calcTilesInRow:function(c,t,a){var b=Math.floor(c/(t+a));b=(b<this.minTilesinRow?this.minTilesinRow:b);return b;},getGroupTiles:function(g){var t=g.getTiles();if(g.getShowPlaceholder()){t.push(g.oPlusTile);}return t;},reRenderGroupsLayout:function(g){if(!this.isInited){return;}var s=this.getStyleInfo(this.container);if(!s.tileWidth){return;}this.styleInfo=s;this.tilesInRow=this.calcTilesInRow(s.containerWidth,s.tileWidth,s.tileMarginWidth);g=g||this.getGroups();for(var i=0;i<g.length;i++){var t=this.getGroupTiles(g[i]);var a=this.organizeGroup(t);this.setGroupsLayout(g[i],a);}},initDragMode:function(){this.initGroupDragMode(this.layoutEngine.currentGroup);},endDragMode:function(){var g=this.getGroups();for(var i=0;i<g.length;i++){var a=g[i].$();if(!a.hasClass("sapUshellInDragMode")){continue;}a.removeClass("sapUshellInDragMode sapUshellEnableTransition");var t=this.getGroupTiles(g[i]);for(var j=0;j<t.length;j++){t[j].$().removeAttr("style");}a.find('.sapUshellInner').removeAttr("style");}},initGroupDragMode:function(g){if(g.$().hasClass("sapUshellInDragMode")){return;}var t=this.getGroupTiles(g);var a=this.organizeGroup(t);g.$().addClass("sapUshellInDragMode");this.renderLayoutGroup(g,a);setTimeout(function(){g.$().addClass("sapUshellEnableTransition");});},calcTranslate:function(r,c){var t=c*(this.styleInfo.tileWidth+this.styleInfo.tileMarginWidth);var a=r*(this.styleInfo.tileHeight+this.styleInfo.tileMarginHeight);if(this.layoutEngine.rightToLeft){t=-t;}return{x:t,y:a};},renderLayoutGroup:function(g,a){var h=a.length*(this.styleInfo.tileHeight+this.styleInfo.tileMarginHeight);g.$().find('.sapUshellInner').height(h);var c;for(var i=0;i<a.length;i++){for(var j=0;j<a[i].length;j++){if(c==a[i][j]){continue;}else{c=a[i][j];}if(typeof c=="undefined"){break;}var t=this.calcTranslate(i,j);var b="translate("+t.x+"px,"+t.y+"px) translatez(0)";a[i][j].getDomRef().style.transform=b;}}}};sap.ushell.Layout=new L();})();};if(!jQuery.sap.isDeclared('sap.ushell.System')){(function(){"use strict";jQuery.sap.declare("sap.ushell.System");sap.ushell.System=function(d){this.getAlias=function(){return d.alias;};this.getBaseUrl=function(){return d.baseUrl;};this.getClient=function(){return d.client;};this.getName=function(){return d.system;};this.getPlatform=function(){return d.platform;};this.adjustUrl=function(u){if(u.indexOf('/')!==0||u==='/'){throw new Error("Invalid URL: "+u);}if(d.baseUrl===";o="){if(d.alias){u=u+";o="+d.alias;}}else if(d.baseUrl){u=d.baseUrl.replace(/\/$/,"")+u;}if(d.client){u+=(u.indexOf("?")>=0?"&":"?")+"sap-client="+d.client;}return u;};this.toString=function(){return JSON.stringify(d);};};}());};if(!jQuery.sap.isDeclared('sap.ushell.UIActions')){(function(){"use strict";jQuery.sap.declare("sap.ushell.UIActions");sap.ushell.UIActions=function(c){if(!c||!c.rootSelector||!c.containerSelector||!c.draggableSelector){throw new Error("No configuration object to initialize User Interaction module.");}this.animationDuration=null;this.captureStart=null;this.captureMove=null;this.captureEnd=null;this.clickCallback=null;this.clickEvent=null;this.clickHandler=null;this.clone=null;this.cloneClass=null;this.container=null;this.contextMenuEvent=null;this.debug=null;this.defaultDragStartEvent=null;this.deltaTop=0;this.disabledDraggableSelector=null;this.dragAndScrollCallback=null;this.dragAndScrollDuration=null;this.dragAndScrollTimer=null;this.draggable=null;this.placeHolderClass=null;this.draggableSelector=null;this.draggableSelectorExclude=null;this.doubleTapCallback=null;this.doubleTapDelay=null;this.element=null;this.endX=null;this.endY=null;this.isLayoutEngine=null;this.isTouch=null;this.isCombi=null;this.lastElement=null;this.lastTapTime=null;this.lockMode=null;this.log=null;this.mode=null;this.mouseDownEvent=null;this.mouseMoveEvent=null;this.mouseUpEvent=null;this.moveTolerance=null;this.moveX=null;this.moveY=null;this.noop=null;this.onDragStartUIHandler=null;this.onDragEndUIHandler=null;this.preventClickFlag;this.preventClickTimeoutId;this.scrollContainer=null;this.scrollContainerSelector=null;this.scrollEvent=null;this.scrollTimer=null;this.startX=null;this.startY=null;this.switchModeDelay=null;this.tapsNumber=null;this.timer=null;this.scrollHandler=null;this.touchCancelEvent=null;this.dragCallback=null;this.endCallback=null;this.touchEndEvent=null;this.touchMoveEvent=null;this.startCallback=null;this.touchStartEvent=null;this.wrapper=null;this.wrapperRect=null;this.scrollCallback=null;this.draggableElement;this.offsetLeft=0;this.elementsToCapture=null;this.init=function(c){this.startX=-1;this.startY=-1;this.moveX=-1;this.moveY=-1;this.endX=-1;this.endY=-1;this.noop=function(){};this.isLayoutEngine=c.isLayoutEngine||false;if(this.isLayoutEngine){this.moveDraggable=this.noop;}this.isTouch=c.isTouch?!!c.isTouch:false;this.isCombi=c.isCombi?!!c.isCombi:false;this.container=document.querySelector(c.containerSelector);this.scrollContainerSelector=c.scrollContainerSelector||c.containerSelector;this.switchModeDelay=c.switchModeDelay||1500;this.dragAndScrollDuration=c.dragAndScrollDuration||230;this.moveTolerance=c.moveTolerance===0?0:c.moveTolerance||10;this.draggableSelector=c.draggableSelector;this.draggableSelectorBlocker=c.draggableSelectorBlocker||c.rootSelector;this.draggableSelectorExclude=c.draggableSelectorExclude;this.mode='normal';this.debug=c.debug||false;this.root=document.querySelector(c.rootSelector);this.animationDuration=c.animationDuration||330;this.tapsNumber=0;this.lastTapTime=0;this.log=this.debug?this.logToConsole:this.noop;this.lockMode=false;this.placeHolderClass=c.placeHolderClass||"";this.cloneClass=c.cloneClass||"";this.deltaTop=c.deltaTop||0;this.wrapper=c.wrapperSelector?document.querySelector(c.wrapperSelector):this.container.parentNode;this.clickCallback=typeof c.clickCallback==='function'?c.clickCallback:this.noop;this.startCallback=typeof c.startCallback==='function'?c.startCallback:this.noop;this.doubleTapCallback=typeof c.doubleTapCallback==='function'?c.doubleTapCallback:this.noop;this.endCallback=typeof c.endCallback==='function'?c.endCallback:this.noop;this.dragCallback=typeof c.dragCallback==='function'?c.dragCallback:this.noop;this.dragAndScrollCallback=typeof c.dragAndScrollCallback==='function'?c.dragAndScrollCallback:this.noop;this.scrollCallback=typeof c.scrollCallback==='function'?c.scrollCallback:this.noop;this.doubleTapDelay=c.doubleTapDelay||500;this.wrapperRect=this.wrapper.getBoundingClientRect();this.scrollEvent='scroll';this.touchStartEvent='touchstart';this.touchMoveEvent='touchmove';this.touchEndEvent='touchend';this.mouseDownEvent='mousedown';this.mouseMoveEvent='mousemove';this.mouseUpEvent='mouseup';this.contextMenuEvent='contextmenu';this.touchCancelEvent='touchcancel';this.defaultDragStartEvent='dragstart';this.clickEvent='click';this.isVerticalDragOnly=c.isVerticalDragOnly||false;this.draggableElement=c.draggableElement;this.offsetLeft=c.offsetLeft;this.elementsToCapture=c.elementToCapture?jQuery(c.elementToCapture):this.root;this.disabledDraggableSelector=c.disabledDraggableSelector;this.onDragStartUIHandler=typeof c.onDragStartUIHandler==='function'?c.onDragStartUIHandler:this.noop;this.onDragEndUIHandler=typeof c.onDragEndUIHandler==='function'?c.onDragEndUIHandler:this.noop;};this.forEach=function(s,a){return Array.prototype.forEach.call(s,a);};this.indexOf=function(s,i){return Array.prototype.indexOf.call(s,i);};this.insertBefore=function(s,i,r){var a,b,d;d=Array.prototype.splice;a=this.indexOf(s,i);b=this.indexOf(s,r);d.call(s,b-(a<b?1:0),0,d.call(s,a,1)[0]);};this.logToConsole=function(){window.console.log.apply(console,arguments);};this.getDraggableElement=function(a){var e,i=false,I=false;this.draggable=jQuery(this.draggableSelector,this.container);while(typeof e==='undefined'&&a!==this.root&&!jQuery(a).is(this.draggableSelectorBlocker)){i=i||jQuery(a).is(this.draggableElement)||this.draggableElement===undefined;if(!(jQuery(a).not(this.draggableSelectorExclude).length>0)){I=true;}if(!I&&i&&this.indexOf(this.draggable,a)>=0){e=a;}a=a.parentNode;}return e;};this.captureStart=function(e){var a;if(e.type==='touchstart'&&e.touches.length===1){a=e.touches[0];}else if(e.type==='mousedown'){a=e;if(e.which!=1){return;}}if(a){this.element=this.getDraggableElement(a.target);this.startX=this.moveX=a.pageX;this.startY=this.moveY=a.pageY;this.lastMoveX=0;this.lastMoveY=0;if(this.lastTapTime&&this.lastElement&&this.element&&(this.lastElement===this.element)&&Math.abs(Date.now()-this.lastTapTime)<this.doubleTapDelay){this.lastTapTime=0;this.tapsNumber=2;}else{this.lastTapTime=Date.now();this.tapsNumber=1;this.lastElement=this.element;}this.log('captureStart('+this.startX+', '+this.startY+')');}};this.startHandler=function(e){this.log('startHandler');if(this.isCombi&&!(e instanceof MouseEvent)){this.isTouchEvent=true;}clearTimeout(this.timer);delete this.timer;this.captureStart(e);if(this.element){this.startCallback(e,this.element);if(this.lockMode===false){if(this.tapsNumber===2){this.mode='double-tap';return;}if(this.isTouch||this.isTouchEvent){this.timer=setTimeout(function(){if(!jQuery(this.element).hasClass(this.disabledDraggableSelector)){this.log('mode switched to drag');this.mode='drag';this.createClone();this.dragCallback(e,this.element);}else{this.onDragStartUIHandler();}this.isTouchEvent=false;}.bind(this),this.switchModeDelay);}}}}.bind(this);this.captureMove=function(e){var a;if(e.type==='touchmove'&&e.touches.length===1){a=e.touches[0];}else if(e.type==='mousemove'){a=e;}if(a){this.moveX=a.pageX;this.moveY=a.pageY;this.log('captureMove('+this.moveX+', '+this.moveY+')');}};this.moveHandler=function(e){var i;this.log('moveHandler');this.captureMove(e);switch(this.mode){case'normal':if((Math.abs(this.startX-this.moveX)>this.moveTolerance||Math.abs(this.startY-this.moveY)>this.moveTolerance)){if(this.isTouch||this.isTouchEvent){this.log('-> normal');clearTimeout(this.timer);delete this.timer;}else if(this.element){this.onDragStartUIHandler();if(!jQuery(this.element).hasClass(this.disabledDraggableSelector)){this.log('mode switched to drag');this.mode='drag';this.createClone();}else{this.preventClick();this.element=null;}}}break;case'drag':e.preventDefault();this.onDragStartUIHandler();this.log('-> drag');if(this.isVerticalDragOnly){this.mode='vertical-drag';}else{this.mode='drag-and-scroll';}window.addEventListener(this.mouseUpEvent,this.endHandler,true);this.translateClone();this.scrollContainer=document.querySelector(this.scrollContainerSelector);this.dragAndScroll();if(!this.isTouch){this.dragCallback(e,this.element);}break;case'drag-and-scroll':e.stopPropagation();e.preventDefault();this.log('-> drag-and-scroll');i=this.dragAndScroll();this.translateClone();if(!i){this.moveDraggable();}this.dragAndScrollCallback({evt:e,clone:this.clone,isScrolling:i,moveX:this.moveX,moveY:this.moveY});break;case'vertical-drag':e.stopPropagation();e.preventDefault();i=this.dragAndScroll();this.translateClone();if(!i){this.moveDraggableVerticalOnly(this.moveX,this.moveY);}this.dragAndScrollCallback({evt:e,clone:this.clone,isScrolling:i,moveX:this.moveX,moveY:this.moveY});break;default:break;}}.bind(this);this.captureEnd=function(e){var a;if((e.type==='touchend'||e.type==='touchcancel')&&(e.changedTouches.length===1)){a=e.changedTouches[0];}else if(e.type==='mouseup'){a=e;}if(a){this.endX=a.pageX;this.endY=a.pageY;this.log('captureEnd('+this.endX+', '+this.endY+')');}};this.contextMenuHandler=function(e){if(this.isTouch||this.isCombi){e.preventDefault();}}.bind(this);this.clickHandler=function(e){if(this.preventClickFlag){this.preventClickFlag=false;e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();clearTimeout(this.preventClickTimeoutId);}this.clickCallback();}.bind(this);this.preventClick=function(){this.preventClickFlag=true;this.preventClickTimeoutId=setTimeout(function(){this.preventClickFlag=false;}.bind(this),100);};this.endCallbackAdapter=function(e,a,o){var b=this.endCallback.apply(null,arguments);jQuery.when(b).then(function(){this.removeClone(a,o.clone);this.onDragEndUIHandler();}.bind(this));this.preventClick();};this.endHandler=function(e){this.log('endHandler');this.captureEnd(e);switch(this.mode){case'normal':this.onDragEndUIHandler();this.log('-> normal');break;case'drag':this.log('-> drag');this.endCallbackAdapter(e,this.element,{clone:this.clone});break;case'drag-and-scroll':this.log('-> drag-and-scroll');window.removeEventListener(this.mouseUpEvent,this.endHandler,true);this.endCallbackAdapter(e,this.element,{deltaX:this.moveX-this.startX,deltaY:this.moveY-this.startY,clone:this.clone});e.stopPropagation();e.preventDefault();break;case'vertical-drag':this.log('-> vertical-drag');window.removeEventListener(this.mouseUpEvent,this.endHandler,true);this.endCallbackAdapter(e,this.element,{clone:this.clone});e.stopPropagation();e.preventDefault();break;case'double-tap':this.log('-> double-tap');this.doubleTapCallback(e,this.element);break;default:break;}clearTimeout(this.timer);delete this.timer;this.lastMoveX=0;this.lastMoveY=0;this.element=null;this.clone=null;this.mode='normal';}.bind(this);this.defaultDragStartHandler=function(e){e.preventDefault();};this.scrollHandler=function(){clearTimeout(this.scrollTimer);this.lockMode=true;this.scrollTimer=setTimeout(function(){this.lockMode=false;}.bind(this),500);}.bind(this);this.createClone=function(){var s,r;this.preventClickFlag=true;r=this.element.getBoundingClientRect();this.clone=this.element.cloneNode(true);this.clone.className+=(' '+this.cloneClass);this.element.className+=(' '+this.placeHolderClass);s=this.clone.style;s.position='fixed';s.display='block';s.top=(r.top+this.deltaTop)+'px';s.left=r.left+'px';s.width=r.width+'px';s.zIndex='100';s.webkitTransition='-webkit-transform 0ms cubic-bezier(0.33, 0.66, 0.66, 1)';s.mozTransition='-moz-transform 0ms cubic-bezier(0.33, 0.66, 0.66, 1)';s.msTransition='-ms-transform 0ms cubic-bezier(0.33, 0.66, 0.66, 1)';s.transition='transform 0ms cubic-bezier(0.33, 0.66, 0.66, 1)';s.webkitTransform='translate3d(0px, 0px, 0px) ';s.mozTransform='translate3d(0px, 0px, 0px) ';s.msTransform='translate3d(0px, 0px, 0px) ';s.transform='translate3d(0px, 0px, 0px) ';this.root.appendChild(this.clone);this.log('createClone');};this.removeClone=function(e,a){this.preventClick();e.className=e.className.split(' '+this.placeHolderClass).join('');a.parentElement.removeChild(a);this.log('removeClone');};this.translateClone=function(){var d,a;d=this.moveX-this.startX;a=this.moveY-this.startY;this.clone.style.webkitTransform='translate3d('+d+'px, '+a+'px, 0px)';this.clone.style.mozTransform='translate3d('+d+'px, '+a+'px, 0px)';this.clone.style.msTransform='translate('+d+'px, '+a+'px)';this.clone.style.transform='translate3d('+d+'px, '+a+'px, 0px)';this.log('translateClone ('+d+', '+a+')');};this.dragAndScroll=function(){var d,a,s,t=this;function b(){s.webkitTransition='-webkit-transform '+a+'ms linear';s.transition='transform '+a+'ms linear';s.mozTransition='-moz-transform '+a+'ms linear';s.msTransition='-ms-transform '+a+'ms linear';s.webkitTransform='translate3d(0px, '+d+'px 0px)';s.mozTransform='translate3d(0px, '+d+'px 0px)';s.msTransform='translate3d(0px, '+d+'px 0px)';s.transform='translate3d(0px, '+d+'px 0px)';}function e(){s.webkitTransition='';s.mozTransition='';s.msTransition='';s.transition='';s.webkitTransform='';s.mozTransform='';s.msTransform='';s.transform='';t.wrapper.scrollTop-=d;}function g(){var r,h;if(t.clone){r=t.clone.getBoundingClientRect();h=t.wrapperRect.top-r.top;if(h>0){return h;}h=t.wrapper.offsetTop+t.wrapper.offsetHeight-(r.top+t.clone.offsetHeight);if(h<0){return h;}}return 0;}function i(){if(d<0){return t.wrapper.getBoundingClientRect().top-(t.container.getBoundingClientRect().top+t.container.offsetHeight)+t.wrapper.offsetHeight<0;}return t.container.getBoundingClientRect().top-(t.wrapper.getBoundingClientRect().top+t.container.offsetTop)<0;}function f(){b();t.dragAndScrollTimer=setTimeout(function(){e();t.dragAndScrollTimer=undefined;if((d=g())!==0&&i()){f();}t.scrollCallback();},a);}d=g();if(d!==0&&!this.dragAndScrollTimer&&i()){a=this.dragAndScrollDuration;this.scrollContainer=this.scrollContainer||document.querySelector(this.scrollContainerSelector);s=this.scrollContainer.style;f();}this.log('dragAndScroll ('+d+')');return(d!=0)&&i();};this.moveDraggableVerticalOnly=function(){var h,i,r,m=true;this.forEach(this.draggable,function(a,b){if(!h){r=a.getBoundingClientRect();i=!(r.bottom<this.moveY||r.top>this.moveY);if(i){h=a;if(r.top+r.height/2<this.moveY){m=false;}}}}.bind(this));if(h&&this.element!==h){if(m){this.insertBefore(this.draggable,this.element,h);h.parentNode.insertBefore(this.element,h);}else{this.insertBefore(this.draggable,this.element,h.nextSibling);h.parentNode.insertBefore(this.element,h.nextSibling);}this.lastMoveX=this.moveX;this.lastMoveY=this.moveY;}this.log('moveDraggableVerticalonly');};this.moveDraggable=function(m,a){var e,h,b,i,d,r;this.forEach(this.draggable,function(f,g){if(!h){r=f.getBoundingClientRect();i=!(r.right<this.moveX||r.left>this.moveX);d=!(r.bottom<this.moveY||r.top>this.moveY);if(i&&d){h=f;b=g;}}}.bind(this));if(h&&this.element!==h){e=this.indexOf(this.draggable,this.element);if(Math.abs(this.lastMoveX-this.moveX)>=this.moveTolerance||Math.abs(this.lastMoveY-this.moveY)>=this.moveTolerance){if(b<=e){h.parentNode.insertBefore(this.element,h);this.insertBefore(this.draggable,this.element,h);}else if(b>e){h.parentNode.insertBefore(this.element,h.nextSibling);this.insertBefore(this.draggable,this.element,this.draggable[b+1]);}this.lastMoveX=this.moveX;this.lastMoveY=this.moveY;}}this.log('moveDraggable');};this.enable=function(){this.log('enable');this.root.addEventListener(this.touchMoveEvent,this.moveHandler,true);this.root.addEventListener(this.mouseMoveEvent,this.moveHandler,true);this.root.addEventListener(this.contextMenuEvent,this.contextMenuHandler,false);this.root.addEventListener(this.clickEvent,this.clickHandler,true);this.root.addEventListener(this.defaultDragStartEvent,this.defaultDragStartHandler,true);this.wrapper.addEventListener(this.scrollEvent,this.scrollHandler,false);if(this.elementsToCapture.length){var t=this;this.elementsToCapture.each(function(){this.addEventListener(t.touchStartEvent,t.startHandler,false);this.addEventListener(t.touchEndEvent,t.endHandler,false);this.addEventListener(t.touchCancelEvent,t.endHandler,false);this.addEventListener(t.mouseDownEvent,t.startHandler,false);this.addEventListener(t.mouseUpEvent,t.endHandler,false);});}else{this.elementsToCapture.addEventListener(this.touchStartEvent,this.startHandler,false);this.elementsToCapture.addEventListener(this.touchEndEvent,this.endHandler,false);this.elementsToCapture.addEventListener(this.touchCancelEvent,this.endHandler,false);this.elementsToCapture.addEventListener(this.mouseDownEvent,this.startHandler,false);this.elementsToCapture.addEventListener(this.mouseUpEvent,this.endHandler,false);}return this;};this.delete=function(){this.log('delete');this.disable();this.dragCallback=null;this.endCallback=null;this.startCallback=null;this.scrollCallback=null;this.doubleTapCallback=null;this.clickCallback=null;this.dragAndScrollCallback=null;delete this;};this.disable=function(){this.log('disable');if(this.elementsToCapture.length){var t=this;this.elementsToCapture.each(function(){this.removeEventListener(t.touchStartEvent,t.startHandler,false);this.removeEventListener(t.touchEndEvent,t.endHandler,false);this.removeEventListener(t.touchCancelEvent,t.endHandler,false);this.removeEventListener(t.mouseDownEvent,t.startHandler,false);this.removeEventListener(t.mouseUpEvent,t.endHandler,false);});}else{this.elementsToCapture.removeEventListener(this.touchStartEvent,this.startHandler,false);this.elementsToCapture.removeEventListener(this.touchEndEvent,this.endHandler,false);this.elementsToCapture.removeEventListener(this.touchCancelEvent,this.endHandler,false);this.elementsToCapture.removeEventListener(this.mouseDownEvent,this.startHandler,false);this.elementsToCapture.removeEventListener(this.mouseUpEvent,this.endHandler,false);}this.root.removeEventListener(this.touchMoveEvent,this.moveHandler,true);this.root.removeEventListener(this.mouseMoveEvent,this.moveHandler,true);this.root.removeEventListener(this.contextMenuEvent,this.contextMenuHandler,false);this.root.removeEventListener(this.clickEvent,this.clickHandler,true);this.wrapper.removeEventListener(this.scrollEvent,this.scrollHandler,false);return this;};this.init(c);this.getMove=function(){return{x:this.moveX,y:this.moveY};};};})();};if(!jQuery.sap.isDeclared('sap.ushell.UIActionsWin8')){(function(){"use strict";function n(){}var U=function(){};U.prototype={init:function(c){this.cfg=c;this.forGroups=this.cfg.forGroups||false;this.wrapper=jQuery(c.wrapperSelector).get(0);this.container=jQuery(c.containerSelector).get(0);this.dragAndScrollCallback=c.dragAndScrollCallback||n;this.dragAndScrollDuration=100;this.dragCallback=c.dragCallback||n;this.draggableSelector=c.draggableSelector;this.endCallback=typeof c.endCallback==='function'?c.endCallback:n;this.placeHolderClass=c.placeHolderClass||"";this.$root=jQuery(c.rootSelector);this.startCallback=typeof c.startCallback==='function'?c.startCallback:n;this.onDragStartUIHandler=typeof c.onDragStartUIHandler==='function'?c.onDragStartUIHandler:n;this.onDragEndUIHandler=typeof c.onDragEndUIHandler==='function'?c.onDragEndUIHandler:n;this._publishAsync=typeof c._publishAsync==='function'?c._publishAsync:n;},enable:function(){if(this.enabled){return this;}this.enabled=true;this.$root.on('dragstart',this.draggableSelector,this,this.dragStartHandler).on('dragend',this.draggableSelector,this,this.dragEndHandler);return this;},disable:function disable(){this.enabled=false;this.$root.off('dragstart',this.draggableSelector).off('dragend',this.draggableSelector);return this;},dragLeaveHandler:function(e){var c=window.getComputedStyle(e.data.container).transform;e.data.container.style.transform=c;e.data.container.style.transition='';var t;var b=c.split(",");if(c.substr(0,8)=="matrix3d"){t=parseInt(b[13],10);}else if(c.substr(0,6)=="matrix"){t=parseInt(b[5],10);}if(isNaN(t)){return;}e.data.container.style.transform="none";e.data.wrapper.scrollTop+=~t+1;},dragEnterHandler:function dragEnterHandler(e){if(e.target==e.data.$bottomScroller.get(0)){e.data.startScroll("down");}if(e.target==e.data.$topScroller.get(0)){e.data.startScroll("up");}},startScroll:function(d){var l;if(d=="up"){l=this.wrapper.scrollTop;if(l<=0){return;}}else{l=this.wrapper.scrollHeight-this.wrapper.offsetHeight-this.wrapper.scrollTop;if(l<=0){return;}}var s=l*3;var t=(d=="up")?l:~l+1;this.container.style.transition='transform '+s+'ms linear';this.container.style.transform='translate(0px, '+t+'px) scale(1) translateZ(0px)';},initScrollRegions:function(){this.$topScroller=jQuery("<div class='UiActionsTopScroller' style='position:absolute; top: 0; height: 70px; left:0; right:0;'></div>");this.$bottomScroller=jQuery("<div class='UiActionsBottomScroller' style='position:absolute; bottom: 0; height: 70px; left:0; right:0;'></div>");jQuery(document.body).append(this.$topScroller).append(this.$bottomScroller);this.$topScroller.add(this.$bottomScroller).on('dragenter',this,this.dragEnterHandler).on('dragleave',this,this.dragLeaveHandler);},removeScrollRegions:function(){jQuery('.UiActionsTopScroller, .UiActionsBottomScroller').remove();}};function G(c){this.init(c);}G.prototype=new U();jQuery.extend(G.prototype,{dragOverTimeout:null,dragStartHandler:function(e){var _=e.data;if(sap.ui.Device.system.phone){_.$root.find(".sapUshellTilesContainer-sortable").addClass("sapUshellTileContainerRemoveContent");_.$root.find(".sapUshellTileContainerBeforeContent").addClass("sapUshellTileContainerRemoveContent");_.$root.find(".sapUshellContainerHeaderActions").addClass("sapUshellTileContainerHidden");}else{_.$root.find(".sapUshellTileContainerBeforeContent").addClass("sapUshellTileContainerHidden");}_.$originalElement=jQuery(e.target).closest(".sapUshellDashboardGroupsContainerItem");_.originalIndex=_.$originalElement.index();_.$element=_.$originalElement.clone().css("display","none").addClass('sapUshellDashboardGroupsContainerItem-placeholder');_.$element.insertAfter(_.$originalElement);_.$originalElement.addClass("sapUshellDashboardGroupsContainerItem-orignal");_.$root.find('.sapUshellTileContainerAfterContent').last().addClass("sapUshellTileContainerRemoveContent");_.initScrollRegions();setTimeout(function(){_.$originalElement.css("display","none");_.$element.css("display","block");},0);_.$root.on('dragover',".sapUshellDashboardGroupsContainerItem:not(.sapUshellDisableDragAndDrop)",_,_.dragOverHandler);},dragEndHandler:function(e){var _=e.data;_.removeScrollRegions();_.$root.off('dragover',".sapUshellDashboardGroupsContainerItem:not(.sapUshellDisableDragAndDrop)");_.$root.find(".sapUshellTilesContainer-sortable").removeClass("sapUshellTileContainerRemoveContent");_.$root.find(".sapUshellTileContainerBeforeContent").removeClass("sapUshellTileContainerRemoveContent");_.$root.find(".sapUshellContainerHeaderActions").removeClass("sapUshellTileContainerHidden");_.$root.find(".sapUshellTileContainerBeforeContent").removeClass("sapUshellTileContainerHidden");_.$element.replaceWith(_.$originalElement);var b=_.$originalElement.index();_.$originalElement.css('display','block').removeClass("sapUshellDashboardGroupsContainerItem-orignal");var B=sap.ui.getCore().getEventBus(),f=_.$originalElement.children().eq(0).attr("id"),g=sap.ui.getCore().byId(f),d=sap.ui.getCore().byId("dashboardGroups"),D={group:g,groupChanged:false,focus:false};d.removeAggregation('groups',g,true);d.insertAggregation('groups',g,b,true);_._publishAsync("launchpad","moveGroup",{fromIndex:_.originalIndex,toIndex:b});window.setTimeout(jQuery.proxy(B.publish,B,"launchpad","scrollToGroup",D),1);},dragOverHandler:function dragOverHandler(e){if(e.data.dragOverTimeout){return;}e.data.dragOverTimeout=setTimeout(function(){e.data.dragOverTimeout=null;var o=e.currentTarget;if(e.data.$element.get(0)===o){return;}var b=e.data.isOverAboveMiddle(o,e.originalEvent.pageY);if(o===e.data.overElement&&b===e.data.overAboveMiddle){return;}e.data.overElement=o;e.data.overAboveMiddle=b;e.data.movePlaceholder(e.data.$element,o,b);},50);},isOverAboveMiddle:function(e,p){var m=true;var r=e.getBoundingClientRect();if(r.top+r.height/2<p){m=false;}return m;},movePlaceholder:function(p,e,i){if(i){jQuery(p).insertBefore(jQuery(e));}else{jQuery(p).insertAfter(jQuery(e));}}});function T(c){this.init(c);}T.prototype=new U();jQuery.extend(T.prototype,{dragOverTimeout:null,dragStartHandler:function dragStartHandler(e){var _=e.data;_.element=e.target;_.$root.on('dragover',_.draggableSelector+", .sapUshellTileContainer",_,_.dragOverHandler);var i=e.target.getAttribute("id");_.oTile=sap.ui.getCore().byId(i);if(_.oTile.getParent().getIsGroupLocked()&&_.oTile.getParent().getDefaultGroup()){_.onDragStartUIHandler();e.preventDefault();var m=function m(){_.onDragEndUIHandler();document.removeEventListener("mouseup",m);};document.addEventListener("mouseup",m);return false;}_.initScrollRegions();var $=jQuery(e.target).clone();$.addClass(_.placeHolderClass).css('z-index',"-1");var c=$.get(0);_.$cloned=$;jQuery(e.target).after($);_.getDomRefOriginal=_.oTile.getDomRef;_.oTile.getDomRef=function(){return c;};_.startCallback(e,_.element);_.onDragStartUIHandler();_.dragCallback(e,_.element);setTimeout(function(){jQuery(e.target).css("visibility","hidden");},0);},dragEndHandler:function dragEndHandler(e){var _=e.data;_.$root.off('dragover',_.draggableSelector+", .sapUshellTileContainer",_.dragOverHandler);_.removeScrollRegions();_.oTile.getDomRef=_.getDomRefOriginal;jQuery(_.element).css('visibility','visible');_.$cloned.remove();_.endCallback(e,_.element);_.onDragEndUIHandler();_.element=null;},dragOverHandler:function dragOverHandler(e){if(e.data.dragOverTimeout){return;}e.data.dragOverTimeout=setTimeout(function(){e.data.dragOverTimeout=null;e.data.overElement=this;e.data.dragAndScrollCallback({moveX:e.originalEvent.pageX,moveY:e.originalEvent.pageY});},50);}});var a={getInstance:function(c){return c.forGroups?new G(c):new T(c);}};jQuery.sap.declare("sap.ushell.UIActionsWin8");sap.ushell.UIActionsWin8=a;}());};if(!jQuery.sap.isDeclared('sap.ushell.adapters.cdm.ClientSideTargetResolutionAdapter')){(function(){"use strict";jQuery.sap.declare("sap.ushell.adapters.cdm.ClientSideTargetResolutionAdapter");sap.ushell.adapters.cdm.ClientSideTargetResolutionAdapter=function(s,p,a){this._oAdapterConfig=a&&a.config;jQuery.sap.require("sap.ushell.utils");this._oLocalSystemAlias={http:{host:"",port:"",pathPrefix:"/sap/bc/"},https:{host:"",port:"",pathPrefix:"/sap/bc/"},rfc:{systemId:"",host:"",service:0,loginGroup:"",sncNameR3:"",sncQoPR3:""},id:"",client:"",language:""};};sap.ushell.adapters.cdm.ClientSideTargetResolutionAdapter.prototype.getInbounds=function(){var t=this;if(!this._getInboundsDeferred){this._getInboundsDeferred=new jQuery.Deferred();sap.ushell.Container.getService("CommonDataModel").getSite().done(function(s){var i=t._formatOSite(s)||[];t._getInboundsDeferred.resolve(i);}).fail(function(e){t._getInboundsDeferred.reject(e);});}return this._getInboundsDeferred.promise();};sap.ushell.adapters.cdm.ClientSideTargetResolutionAdapter.prototype._getSystemAliases=function(){var t=this;if(!this._getSystemAliasesDeferred){this._getSystemAliasesDeferred=new jQuery.Deferred();sap.ushell.Container.getService("CommonDataModel").getSite().done(function(s){var S=jQuery.extend(true,{},s.systemAliases||{});Object.keys(S).forEach(function(i){S[i].id=i;});t._getSystemAliasesDeferred.resolve(S);}).fail(function(e){t._getSystemAliasesDeferred.reject(e);});}return this._getSystemAliasesDeferred.promise();};sap.ushell.adapters.cdm.ClientSideTargetResolutionAdapter.prototype._getMember=function(o,a){return sap.ushell.utils.getMember(o,a);};sap.ushell.adapters.cdm.ClientSideTargetResolutionAdapter.prototype._formatOSite=function(s){var t=this;if(!s){return[];}function m(k,o,a){var I={};I.semanticObject=o.semanticObject;I.action=o.action;I.title=o.title||t._getMember(a,"sap|app.title");var T,b,c=false;I.resolutionResult=jQuery.extend(true,{},t._getMember(a,"sap|platform|runtime"));I.resolutionResult=I.resolutionResult||{};if(t._getMember(a,"sap|platform|runtime")){I.resolutionResult["sap.platform.runtime"]=jQuery.extend(true,{},t._getMember(a,"sap|platform|runtime"));}if(t._getMember(a,"sap|ui.technology")==="GUI"){I.resolutionResult["sap.gui"]=t._getMember(a,"sap|gui");}if(t._getMember(a,"sap|ui.technology")==="WDA"){I.resolutionResult["sap.wda"]=t._getMember(a,"sap|wda");}if(t._getMember(a,"sap|ui.technology")==="URL"&&I.resolutionResult["sap.platform.runtime"]){if(I.resolutionResult["sap.platform.runtime"].uri){I.resolutionResult["sap.platform.runtime"].url=I.resolutionResult["sap.platform.runtime"].uri;I.resolutionResult.url=I.resolutionResult["sap.platform.runtime"].uri;}}I.resolutionResult.applicationType=t._formatApplicationType(I.resolutionResult,a);I.resolutionResult.systemAlias=I.resolutionResult.systemAlias||o.systemAlias;I.resolutionResult.text=I.title;I.deviceTypes=t._getMember(a,"sap|ui.deviceTypes")||{};["desktop","tablet","phone"].forEach(function(M){if(Object.prototype.hasOwnProperty.call(o.deviceTypes||{},M)){I.deviceTypes[M]=o.deviceTypes[M];}if(!Object.prototype.hasOwnProperty.call(I.deviceTypes,M)){I.deviceTypes[M]=true;}I.deviceTypes[M]=!!I.deviceTypes[M];});I.signature=o.signature||{};I.signature.parameters=I.signature.parameters||{};I.signature.additionalParameters=(o.signature||{}).additionalParameters||"allowed";var d=o.indicatorDataSource||t._getMember(a,"sap|app.indicatorDataSource");var f=d?"#Shell-dynamicTile":"#Shell-staticTile";if(t._getMember(a,"sap|app.type")==="tile"||t._getMember(a,"sap|flp.type")==="tile"){f=I.resolutionResult;f.url=t._getMember(a,"sap|platform|runtime.componentProperties.url");f.componentName=t._getMember(a,"sap|ui5.componentName");b=t._getMember(a,"sap|app.crossNavigation.outbounds.target");c=true;}if(t._getMember(a,"sap|app.type")==="plugin"||t._getMember(a,"sap|flp.type")==="plugin"){return undefined;}if(t._getMember(a,"sap|flp.tileSize")){T=t._getMember(a,"sap|flp.tileSize");}I.tileResolutionResult={title:I.title,subTitle:o.subTitle||t._getMember(a,"sap|app.subTitle"),icon:o.icon||t._getMember(a,"sap|ui.icons.icon"),size:T,tileComponentLoadInfo:f,indicatorDataSource:d};I.tileResolutionResult.isCustomTile=c;if(b){I.tileResolutionResult.targetOutbound=b;}return I;}var i=[];try{var S=Object.keys(s.applications).sort();S.forEach(function(a){try{var A=s.applications[a];var o=t._getMember(A,"sap|app.crossNavigation.inbounds");if(o){var l=Object.keys(o).sort();l.forEach(function(I){var b=o[I];var r=m(I,b,A);if(r){i.push(r);}});}}catch(E){jQuery.sap.log.error("Error in application "+a+": "+E,E.stack);}});}catch(e){jQuery.sap.log.error(e);jQuery.sap.log.error(e.stack);return[];}return i;};sap.ushell.adapters.cdm.ClientSideTargetResolutionAdapter.prototype._formatApplicationType=function(r,a){var A=r.applicationType;if(A){return A;}var c=this._getMember(a,"sap|platform|runtime.componentProperties.self.name")||this._getMember(a,"sap|ui5.componentName");if(this._getMember(a,"sap|flp.appType")==="UI5"||this._getMember(a,"sap|ui.technology")==="UI5"){r.applicationType="SAPUI5";r.additionalInformation="SAPUI5.Component="+c;r.url=this._getMember(a,"sap|platform|runtime.componentProperties.url");r.applicationDependencies=this._getMember(a,"sap|platform|runtime.componentProperties");return"SAPUI5";}if(this._getMember(a,"sap|ui.technology")==="GUI"){r.applicationType="TR";r["sap.gui"]=this._getMember(a,"sap|gui");r.systemAlias=this._getMember(a,"sap|app.destination.name");return"TR";}if(this._getMember(a,"sap|ui.technology")==="WDA"){r.applicationType="WDA";r["sap.wda"]=this._getMember(a,"sap|wda");r.systemAlias=this._getMember(a,"sap|app.destination.name");return"WDA";}return"URL";};sap.ushell.adapters.cdm.ClientSideTargetResolutionAdapter.prototype.resolveSystemAlias=function(s){var d=new jQuery.Deferred(),t=this;this._getSystemAliases().done(function(S){var m,o=s===""?t._oLocalSystemAlias:S[s];if(o){d.resolve(o);}else{m="Cannot resolve system alias "+s;jQuery.sap.log.warning(m,"The system alias cannot be found in the site response","sap.ushell.adapters.cdm.ClientSideTargetResolutionAdapter");d.reject(m);}}).fail(function(){d.reject();});return d.promise();};}());};if(!jQuery.sap.isDeclared('sap.ushell.adapters.cdm.CommonDataModelAdapter')){(function(){"use strict";jQuery.sap.declare("sap.ushell.adapters.cdm.CommonDataModelAdapter");sap.ushell.adapters.cdm.CommonDataModelAdapter=function(u,p,a){jQuery.sap.require("sap.ushell.adapters.cdm.ClientSideTargetResolutionAdapter");this.oAdapterConfiguration=a;if(a&&a.config&&a.config.siteData){this.oCdmSiteDataRequestPromise=new jQuery.Deferred().resolve(a.config.siteData);}else if(a&&a.config&&a.config.siteDataPromise){this.oCdmSiteDataRequestPromise=a.config.siteDataPromise;}else{this.sCdmSiteUrl=jQuery.sap.getModulePath("sap.ushell.cdmSiteData")+"/CommonDataModelAdapterData.json";if(a&&a.config&&a.config.cdmSiteUrl){this.sCdmSiteUrl=a.config.cdmSiteUrl;}this.oCdmSiteDataRequestPromise=this._requestSiteData(this.sCdmSiteUrl);}};sap.ushell.adapters.cdm.CommonDataModelAdapter.prototype._requestSiteData=function(u){var s=new jQuery.Deferred();jQuery.ajax({type:"GET",dataType:"json",url:u}).done(function(r){s.resolve(r);}).fail(function(e){jQuery.sap.log.error(e.responseText);s.reject("CDM Site was requested but could not be loaded.");});return s.promise();};sap.ushell.adapters.cdm.CommonDataModelAdapter.prototype.getSite=function(){var d=new jQuery.Deferred();this.oCdmSiteDataRequestPromise.done(function(s){var S=jQuery.extend({},s);delete S.personalization;d.resolve(S);}).fail(function(m){d.reject(m);});return d.promise();};sap.ushell.adapters.cdm.CommonDataModelAdapter.prototype.getPersonalization=function(){var d=new jQuery.Deferred(),t=this;this.oCdmSiteDataRequestPromise.done(function(s){var S=jQuery.extend({},s);if(t.oAdapterConfiguration&&t.oAdapterConfiguration.config&&t.oAdapterConfiguration.config.ignoreSiteDataPersonalization){delete S.personalization;}if(S.personalization){d.resolve(S.personalization);}else{t._readPersonalizationDataFromStorage().done(function(p){d.resolve(p);}).fail(function(m){d.reject(m);});}}).fail(function(m){d.reject(m);});return d.promise();};sap.ushell.adapters.cdm.CommonDataModelAdapter.prototype._storePersonalizationData=function(p){var P=new jQuery.Deferred(),o=sap.ushell.Container.getService("Personalization"),c,s={keyCategory:o.constants.keyCategory.FIXED_KEY,writeFrequency:o.constants.writeFrequency.LOW,clientStorageAllowed:true},a={container:"sap.ushell.cdm.personalization",item:"data"},b=o.getPersonalizer(a,s,c);b.setPersData(p).done(function(){jQuery.sap.log.info("Personalization data has been stored successfully.");P.resolve();}).fail(function(){P.reject("Writing personalization data failed.");});return P.promise();};sap.ushell.adapters.cdm.CommonDataModelAdapter.prototype._readPersonalizationDataFromStorage=function(){var p=new jQuery.Deferred(),P=sap.ushell.Container.getService("Personalization"),c,s={keyCategory:P.constants.keyCategory.FIXED_KEY,writeFrequency:P.constants.writeFrequency.LOW,clientStorageAllowed:true},o={container:"sap.ushell.cdm.personalization",item:"data"},a=P.getPersonalizer(o,s,c);a.getPersData().done(function(b){if(!b){b={};}p.resolve(b);}).fail(function(){p.reject("Fetching personalization data failed.");});return p.promise();};}());};if(!jQuery.sap.isDeclared('sap.ushell.adapters.local.ClientSideTargetResolutionAdapter')){(function(){"use strict";jQuery.sap.declare("sap.ushell.adapters.local.ClientSideTargetResolutionAdapter");sap.ushell.adapters.local.ClientSideTargetResolutionAdapter=function(s,p,c){this._oConfig=c&&c.config;this._aInbounds=[];if(!this._oConfig){this._oSystemAliases={};jQuery.sap.log.warning("No configuration supplied!","","sap.ushell.adapters.local.ClientSideTargetResolutionAdapter");}else{if(this._oConfig.inbounds){this._aInbounds=this._transformInboundsObjectToInboundsArray(this._oConfig.inbounds);}if(this._oConfig.applications){Array.prototype.push.apply(this._aInbounds,this._transformApplicationsToInbounds(this._oConfig.applications));}if(this._aInbounds.length===0){jQuery.sap.log.warning("Adapter got no inbounds via configuration!","","sap.ushell.adapters.local.ClientSideTargetResolutionAdapter");}this._oSystemAliases=this._oConfig.systemAliases||{};jQuery.sap.log.debug("Adapter got no system aliases via configuration","","sap.ushell.adapters.local.ClientSideTargetResolutionAdapter");}};sap.ushell.adapters.local.ClientSideTargetResolutionAdapter.prototype.getInbounds=function(){var d=new jQuery.Deferred(),t=this;setTimeout(function(){d.resolve(t._aInbounds);},0);return d.promise();};sap.ushell.adapters.local.ClientSideTargetResolutionAdapter.prototype.resolveSystemAlias=function(s){var d=new jQuery.Deferred(),t=this;setTimeout(function(){var r={};if(t._oSystemAliases.hasOwnProperty(s)){r=t._oSystemAliases[s];d.resolve(r);}else{d.reject("No system alias value available");}},0);return d.promise();};sap.ushell.adapters.local.ClientSideTargetResolutionAdapter.prototype._transformApplicationsToInbounds=function(a){var i,I=[],A,o,b;function c(s,u){if(s==="NWBC"&&u){if(u.indexOf("/~canvas;window=app/wda")>=0){return"WDA";}return"TR";}return s;}for(i in a){if(a.hasOwnProperty(i)&&i.indexOf("_")!==0){o={};if(i.indexOf("-")>-1){b=i.split("-",2);o.semanticObject=b[0];o.action=b[1];}else if(i===""){o.semanticObject="";o.action="";}else{jQuery.sap.log.warning("Excluded syntactically incorrect intent '"+i+"' from inbounds array","","sap.ushell.adapters.local.ClientSideTargetResolutionAdapter");continue;}A=a[i];o.title=A.description||"";o.signature={parameters:{}};o.signature.additionalParameters="allowed";o.resolutionResult={};o.resolutionResult.applicationType=c(A.applicationType,A.url);o.resolutionResult.additionalInformation=A.additionalInformation||"";if(o.resolutionResult.additionalInformation&&o.resolutionResult.additionalInformation.indexOf("SAPUI5.Component=")!==-1){o.resolutionResult.applicationType="SAPUI5";o.resolutionResult.ui5ComponentName=o.resolutionResult.additionalInformation.split("SAPUI5.Component=",2)[1];o.resolutionResult.applicationDependencies={self:{name:o.resolutionResult.ui5ComponentName},asyncHints:{libs:[{name:"sap.ui.core"},{name:"sap.ui.unified"}]}};}o.resolutionResult.url=A.url;I.push(o);}}return I;};sap.ushell.adapters.local.ClientSideTargetResolutionAdapter.prototype._transformInboundsObjectToInboundsArray=function(i){var I,a=[],o;for(I in i){if(i.hasOwnProperty(I)){o=i[I];if(o.resolutionResult.additionalInformation&&o.resolutionResult.additionalInformation.indexOf("SAPUI5.Component=")!==-1){o.resolutionResult.ui5ComponentName=o.resolutionResult.additionalInformation.split("SAPUI5.Component=",2)[1];if(!o.resolutionResult.hasOwnProperty("applicationDependencies")){o.resolutionResult.applicationDependencies={self:{name:o.resolutionResult.ui5ComponentName},asyncHints:{libs:[{name:"sap.ui.core"},{name:"sap.ui.unified"}]}};}}a.push(i[I]);}}return a;};}());};if(!jQuery.sap.isDeclared('sap.ushell.adapters.local.EndUserFeedbackAdapter')){(function(){"use strict";jQuery.sap.declare("sap.ushell.adapters.local.EndUserFeedbackAdapter");jQuery.sap.require('jquery.sap.storage');var e;sap.ushell.adapters.local.EndUserFeedbackAdapter=function(s,p,a){var S="com.sap.ushell.adapters.local.EndUserFeedback";this.sendFeedback=function(f){var d,o,n;n=333;d=new jQuery.Deferred();setTimeout(function(){o=jQuery.sap.storage(jQuery.sap.storage.Type.session,S);if(o.put(n,JSON.stringify(f))===true){jQuery.sap.log.info("User Feedback "+JSON.stringify(f)+" has been sent.");d.resolve(n);}else{d.reject("Failed to save end user feedback");}},0);return d.promise();};this.getLegalText=function(){var d,l;l="This is the legal text \n in the users language.\n with multiple line breaks.";d=new jQuery.Deferred();setTimeout(function(){jQuery.sap.log.info("Legal text "+l+" for user feedback dialog has been sent.");d.resolve(l);},0);return d.promise();};this.isEnabled=function(){var d=new jQuery.Deferred();setTimeout(function(){if(e){d.resolve();}else{d.reject();}},0);return d.promise();};e=jQuery.sap.getObject("config.enabled",undefined,a);if(e===undefined){e=true;}};}());};if(!jQuery.sap.isDeclared('sap.ushell.adapters.local.NavTargetResolutionAdapter')){(function(){"use strict";jQuery.sap.declare("sap.ushell.adapters.local.NavTargetResolutionAdapter");jQuery.sap.require('sap.ui.thirdparty.datajs');sap.ushell.adapters.local.NavTargetResolutionAdapter=function(u,p,a){var A=jQuery.sap.getObject("config.applications",0,a);this.resolveHashFragment=function(h){var d=new jQuery.Deferred(),i,r,R,P;if(h&&h.charAt(0)!=="#"){throw new sap.ushell.utils.Error("Hash fragment expected","sap.ushell.renderers.minimal.Shell");}h=h.substring(1);if(!h&&!A[h]){d.resolve(undefined);}else{jQuery.sap.log.info("Hash Fragment: "+h);i=h.indexOf("?");if(i>=0){P=h.slice(i+1);h=h.slice(0,i);}r=A[h];if(r){R={additionalInformation:r.additionalInformation,applicationType:r.applicationType,url:r.url,text:r.text,fullWidth:r.fullWidth};if(P){R.url+=(R.url.indexOf("?")<0)?"?":"&";R.url+=P;}if(r.navigationMode!==undefined){R.navigationMode=r.navigationMode;}d.resolve(R);}else{d.reject("Could not resolve link '"+h+"'");}}return d.promise();};this.getSemanticObjectLinks=function(s,P){var I,r=[],i=0,d=new jQuery.Deferred(),b;if(!s){setTimeout(function(){d.resolve([]);},0);}else{b=sap.ushell.Container.getService("URLParsing").paramsToString(P);jQuery.sap.log.info("getSemanticObjectLinks: "+s);for(I in A){if(A.hasOwnProperty(I)&&I.substring(0,I.indexOf('-'))===s){r[i]=A[I];r[i].id=I;r[i].text=r[i].text||r[i].description||"no text";r[i].intent="#"+I;if(b!==""){if(r[i].intent.indexOf("?")!==-1){r[i].intent+="&"+b;}else{r[i].intent+="?"+b;}}i+=1;}}if(r){setTimeout(function(){d.resolve(r);},0);}else{setTimeout(function(){d.reject("Could not get links for  '"+s+"'");},0);}}return d.promise();};this.isIntentSupported=function(I){var d=new jQuery.Deferred(),s={},D=[],t=this;function b(i,S){s[i]={supported:S};}I.forEach(function(c,i){var o=new jQuery.Deferred();D.push(o.promise());t.resolveHashFragment(c).fail(function(e){b(c,false);o.resolve();}).done(function(e){b(c,true);o.resolve();});});if(I.length>0){jQuery.when.apply(jQuery,D).always(function(){d.resolve(s);});}else{d.resolve(s);}return d.promise();};};}());};if(!jQuery.sap.isDeclared('sap.ushell.adapters.local.SearchAdapter')){(function(){"use strict";jQuery.sap.declare("sap.ushell.adapters.local.SearchAdapter");jQuery.sap.require('sap.ushell.renderers.fiori2.search.esh.api.release.sina');sap.ushell.adapters.local.SearchAdapter=function(s,p,a){this.isSearchAvailable=function(){var d=jQuery.Deferred();d.resolve(true);return d.promise();};this.getSina=function(){return window.sina.getSina({systemType:"ABAP",startWithSearch:"false",noSapClientFromUrl:true});};};}());};if(!jQuery.sap.isDeclared('sap.ushell.adapters.local.SupportTicketAdapter')){(function(){"use strict";jQuery.sap.declare("sap.ushell.adapters.local.SupportTicketAdapter");sap.ushell.adapters.local.SupportTicketAdapter=function(s,p,a){this.createTicket=function(S){var d=new jQuery.Deferred(),t="1234567";d.resolve(t);return d.promise();};};}());};if(!jQuery.sap.isDeclared('sap.ushell.adapters.local.UserInfoAdapter')){(function(){"use strict";jQuery.sap.declare("sap.ushell.adapters.local.UserInfoAdapter");jQuery.sap.require('sap.ui.thirdparty.datajs');sap.ushell.adapters.local.UserInfoAdapter=function(u,p,a){var U;function g(A){var d=[{id:"sap_bluecrystal",name:"sap_bluecrystal"}],e=jQuery.sap.getObject("config.themes",undefined,A);return e===undefined?d:e;}this.updateUserPreferences=function(o){var d=new jQuery.Deferred();jQuery.sap.log.info("updateUserPreferences: "+o);d.resolve({status:200});return d.promise();};this.getThemeList=function(){var d=new jQuery.Deferred();jQuery.sap.log.info("getThemeList");if(U===undefined){U=g(a);}if(U.length===0){d.reject("no themes were configured");}else{d.resolve({options:U});}return d.promise();};};}());};if(!jQuery.sap.isDeclared('sap.ushell.components.factsheet.Component')){jQuery.sap.declare("sap.ushell.components.factsheet.Component");jQuery.sap.require('sap.ui.core.UIComponent');sap.ui.core.UIComponent.extend("sap.ushell.components.factsheet.Component",{oMainView:null,metadata:{version:"1.44.6",library:"sap.ushell.components.factsheet",dependencies:{libs:["sap.m","sap.ui.vbm","sap.suite.ui.commons","sap.ui.layout","sap.viz"],components:[]}},createContent:function(){"use strict";var c=this.getComponentData();var s=(c&&c.startupParameters)||{};this.oMainView=sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.ushell.components.factsheet.views.ThingViewer",viewData:s,height:"100%"}).addStyleClass("ThingViewer");return this.oMainView;},exit:function(){"use strict";window.console.log("On Exit of factsheet Component.js called : this.getView().getId()"+this.getId());},onExit:function(){"use strict";window.console.log("On Exit of factsheet Component.js called : this.getView().getId()"+this.getId());}});jQuery.sap.setObject("factsheet.Component",sap.ushell.components.factsheet.Component);};if(!jQuery.sap.isDeclared('sap.ushell.components.factsheet.annotation.Mapping')){(function(){"use strict";jQuery.sap.declare("sap.ushell.components.factsheet.annotation.Mapping");sap.ushell.components.factsheet.annotation.Mapping={};sap.ushell.components.factsheet.annotation.Mapping.initialized=[];sap.ushell.components.factsheet.annotation.Mapping.parse=function(m,a){var x={},g,b,s,c,d,r,e,f,h,n,o,A,q={},t,u,S={},i,v,w={},y={},z="",B,C,D,E,F,G,H,T,I,J,K,M,L,j,N,O,P,Q,R,U,V,W,X,Y,Z,$,_,a1,b1,c1,d1,e1,f1;if(sap.ui.Device.browser.internet_explorer){x={setNameSpace:function(k){k.setProperty("SelectionNamespaces",'xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" xmlns:d="http://docs.oasis-open.org/odata/ns/edm"');k.setProperty("SelectionLanguage","XPath");return k;},selectNodes:function(k,x,l){return l.selectNodes(x);},nextNode:function(k){return k.nextNode();},getNodeText:function(k){return k.text;}};}else{x={setNameSpace:function(k){return k;},nsResolver:function(p){var k={"edmx":"http://docs.oasis-open.org/odata/ns/edmx","d":"http://docs.oasis-open.org/odata/ns/edm"};return k[p]||null;},selectNodes:function(k,p,l){var g1=k.evaluate(p,l,this.nsResolver,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);g1.length=g1.snapshotLength;return g1;},nextNode:function(k,l){return k.snapshotItem(l);},getNodeText:function(k){return k.textContent;}};}g=function(k){var l;if(sap.ui.Device.browser.internet_explorer){l=new ActiveXObject("Microsoft.XMLHTTP");l.open("GET",k,false);l.send(null);return l.responseXML;}else{l=jQuery.sap.sjax({url:k,dataType:"xml"});if(l.success){return l.data;}}};b=function(m){var g1={},h1={},i1={},j1=false,i,k1,l1,m1,n1={},j,o1={},p1={},q1=false,r1,l,k,s1,t1,u1,v1,p,w1;for(i=m.dataServices.schema.length-1;i>=0;i-=1){g1=m.dataServices.schema[i];if(g1.entityType){k1=g1.namespace;l1=g1.entityType;m1=g1.complexType;for(j in l1){if(l1.hasOwnProperty(j)){n1=l1[j];p1={};if(n1.hasStream&&n1.hasStream==="true"){continue;}o1={};for(k in n1.property){r1=n1.property[k];if(r1.type.substring(0,k1.length)===k1){for(l in m1){if(m1[l].name===r1.type.substring(k1.length+1)){for(k in m1[l].property){s1=m1[l].property[k];o1[m1[l].name+"/"+s1.name]=s1.type;}}}}else{t1=r1.name;u1=r1.type;for(p in r1.extensions){v1=r1.extensions[p];if((v1.name==="display-format")&&(v1.value==="Date")){u1="Edm.Date";}else{q1=true;if(!p1[t1]){p1[t1]={};}if(v1.namespace&&!p1[t1][v1.namespace]){p1[t1][v1.namespace]={};}p1[t1][v1.namespace][v1.name]=v1.value;}}o1[t1]=u1;}}if(!h1[k1+"."+n1.name]){h1[k1+"."+n1.name]={};}h1[k1+"."+n1.name]=o1;if(q1){if(!i1[k1+"."+n1.name]){j1=true;}i1[k1+"."+n1.name]={};i1[k1+"."+n1.name]=p1;}}}}}if(j1){w1={types:h1,extensions:i1};}else{w1={types:h1};}return w1;};s=function(p,k,l,S){var g1,h1,i1='';for(g1 in p){if(p.hasOwnProperty(g1)){if(p[g1]){h1=p[g1];if(h1.Value&&h1.Value.Path){i1=c(h1.Value.Path,k,l,S);if(i1){p[g1].EdmType=i1;}continue;}if(h1.Path){i1=c(h1.Path,k,l,S);if(i1){p[g1].EdmType=i1;}continue;}if(h1.Facets){p[g1].Facets=s(h1.Facets,k,l,S);continue;}if(h1.Data){p[g1].Data=s(h1.Data,k,l,S);continue;}if(g1==="Data"){p.Data=s(h1,k,l,S);continue;}if(h1.Value&&h1.Value.Apply){p[g1].Value.Apply.Parameters=s(h1.Value.Apply.Parameters,k,l,S);continue;}if(h1.Value&&h1.Type&&(h1.Type==="Path")){i1=c(h1.Value,k,l,S);if(i1){p[g1].EdmType=i1;}}}}}return p;};c=function(p,k,l,S){var g1;if((p.charAt(0)==="@")&&(p.indexOf(S.Alias)===1)){p=p.slice(S.Alias.length+2);}if(p.indexOf("/")>=0){if(k[p.slice(0,p.indexOf("/"))]){l=p.slice(0,p.indexOf("/"));p=p.slice(p.indexOf("/")+1);}}for(g1 in k[l]){if(k[l].hasOwnProperty(g1)){if(p===g1){return k[l][g1];}}}};d=function(k){var l="",p="",i,g1={};for(i=0;i<k.attributes.length;i+=1){if((k.attributes[i].name!=="Property")&&(k.attributes[i].name!=="Term")){l=k.attributes[i].name;p=k.attributes[i].value;}}if(l.length>0){g1[l]=r(p);}return g1;};e=function(t,k){var l={},p,g1,h1,i1,j1,k1;if(k.hasChildNodes()){p=x.selectNodes(t,"./d:String",k);if(p.length>0){g1=x.nextNode(p,0);l["String"]=x.getNodeText(g1);}else{h1=x.selectNodes(t,"./d:Path",k);if(h1.length>0){i1=x.nextNode(h1,0);l["Path"]=x.getNodeText(i1);}else{j1=x.selectNodes(t,"./d:Apply",k);if(j1.length>0){k1=x.nextNode(j1,0);l["Apply"]=n(t,k1);}}}}return l;};f=function(t,k,l){var p={},g1,h1,I,i1,j1,k1,l1,m1,n1={},L,N,W,o1,p1;if(k.hasChildNodes()){g1=x.selectNodes(t,"./d:Record | ./d:Collection/d:Record | ./d:Collection/d:If/d:Record",k);if(g1.length){h1=0;for(I=0;I<g1.length;I+=1){i1=x.nextNode(g1,I);j1=h(t,i1,l);if(i1.getAttribute("Type")){j1["RecordType"]=r(i1.getAttribute("Type"));}if(h1===0){if(i1.nextElementSibling||(i1.parentNode.nodeName==="Collection")||(i1.parentNode.nodeName==="If")){p=[];p.push(j1);}else{p=j1;}}else{p.push(j1);}h1+=1;}}else{k1=x.selectNodes(t,"./d:UrlRef",k);if(k1.length>0){for(I=0;I<k1.length;I+=1){l1=x.nextNode(k1,I);p["UrlRef"]=e(t,l1);}}else{k1=x.selectNodes(t,"./d:Url",k);if(k1.length>0){for(I=0;I<k1.length;I+=1){l1=x.nextNode(k1,I);p["Url"]=e(t,l1);}}else{p1=x.selectNodes(t,"./d:Collection/d:AnnotationPath | ./d:Collection/d:PropertyPath",k);if(p1.length>0){p=[];for(I=0;I<p1.length;I+=1){m1=x.nextNode(p1,I);n1={};n1[m1.nodeName]=x.getNodeText(m1);p.push(n1);}}else{p=d(k);L=x.selectNodes(t,"./d:Annotation",k);N={};for(W=0;W<L.length;W+=1){N=x.nextNode(L,W);if(N.hasChildNodes()===false){o1=r(N.getAttribute("Term"));p[o1]=d(N);}}}}}}}else{p=d(k);}return p;};h=function(t,k,l){var p={},N={},L,W,g1,h1,I,i1,j1,k1,l1,m1;L=x.selectNodes(t,"./d:Annotation",k);for(W=0;W<L.length;W+=1){N=x.nextNode(L,W);if(N.hasChildNodes()===false){g1=r(N.getAttribute("Term"));p[g1]=d(N);}}h1=x.selectNodes(t,"./d:PropertyValue",k);if(h1.length>0){for(I=0;I<h1.length;I+=1){i1=x.nextNode(h1,I);j1=i1.getAttribute("Property");p[j1]=f(t,i1,l);k1=x.selectNodes(t,"./d:Apply",i1);l1=null;for(m1=0;m1<k1.length;m1+=1){l1=x.nextNode(k1,m1);if(l1){p[j1]={};p[j1]['Apply']=n(t,l1);}}}}else{p=f(t,k,l);}return p;};n=function(t,k){var l={},p,g1=null,h1=[],i;p=x.selectNodes(t,"./d:*",k);for(i=0;i<p.length;i+=1){g1=x.nextNode(p,i);switch(g1.nodeName){case"Apply":h1.push({"Type":"Apply","Value":n(t,g1)});break;case"LabeledElement":h1.push({"Name":g1.getAttribute("Name"),"Value":e(t,g1)});break;default:h1.push({"Type":g1.nodeName,"Value":x.getNodeText(g1)});break;}}l['Name']=k.getAttribute('Function');l['Parameters']=h1;return l;};o=function(l,p,g1){var h1,i,i1,j1,j,k;for(i=m.dataServices.schema.length-1;i>=0;i-=1){h1=m.dataServices.schema[i];if(h1.entityType){i1=h1.namespace+".";j1=h1.entityType;for(k=j1.length-1;k>=0;k-=1){if(i1+j1[k].name===l&&j1[k].navigationProperty){for(j=0;j<j1[k].navigationProperty.length;j+=1){if(j1[k].navigationProperty[j].name===p){return true;}}}}}}return false;};r=function(k){for(A in w){if(w.hasOwnProperty(A)){if(k.indexOf(A+".")>=0){k=k.replace(A+".",w[A]+".");return k;}}}return k;};if(this.initialized[a]){return this.initialized[a];}t=g(a);t=x.setNameSpace(t);u=x.selectNodes(t,"//d:Schema",t);for(i=0;i<u.length;i+=1){v=x.nextNode(u,i);S.Alias=v.getAttribute("Alias");S.Namespace=v.getAttribute("Namespace");}B=x.selectNodes(t,"//edmx:Reference",t);for(i=0;i<B.length;i+=1){C=x.nextNode(B,i);D=x.selectNodes(t,"./edmx:Include",C);if(D&&D.length>0){E=x.nextNode(D,0);if(E.getAttribute("Alias")){w[E.getAttribute("Alias")]=E.getAttribute("Namespace");}else{w[E.getAttribute("Namespace")]=E.getAttribute("Namespace");}}F=x.selectNodes(t,"./edmx:IncludeAnnotations",C);if(F.length>0){for(j=0;j<F.length;j+=1){G=x.nextNode(F,j);if(G.getAttribute("TargetNamespace")){z=G.getAttribute("TargetNamespace");if(!y[z]){y[z]={};}y[z][G.getAttribute("TermNamespace")]=C.getAttribute("Uri");}else{y[G.getAttribute("TermNamespace")]=C.getAttribute("Uri");}}}}if(y){q.annotationReferences=y;}q.aliasDefinitions=w;H=x.selectNodes(t,"//d:Term",t);if(H.length>0){T={};for(I=0;I<H.length;I+=1){J=x.nextNode(H,I);K=r(J.getAttribute("Type"));T["@"+S.Alias+"."+J.getAttribute("Name")]=K;}q.termDefinitions=T;}M=b(m);if(M.extensions){q.propertyExtensions=M.extensions;}L=x.selectNodes(t,"//d:Annotations ",t);for(I=0;I<L.length;I+=1){N=x.nextNode(L,I);if(N.hasChildNodes()===false){continue;}O=N.getAttribute("Target");P=O.split(".")[0];if(P&&w[P]){O=O.replace(new RegExp(P,""),w[P]);}Q=O;R=null;if(O.indexOf("/")>0){Q=O.split("/")[0];R=O.replace(Q+"/","");}if(!q[Q]){q[Q]={};}if(R){if(!q.propertyAnnotations){q.propertyAnnotations={};}if(!q.propertyAnnotations[Q]){q.propertyAnnotations[Q]={};}q.propertyAnnotations[Q][R]={};U=x.selectNodes(t,"./d:Annotation",N);for(W=0;W<U.length;W+=1){V=x.nextNode(U,W);if(V.hasChildNodes()===false){X=r(V.getAttribute("Term"));q.propertyAnnotations[Q][R][X]=d(V);}}}else{Z=Q.replace(w[P],P);U=x.selectNodes(t,"./d:Annotation",N);for(Y=0;Y<U.length;Y+=1){V=x.nextNode(U,Y);$=V.getAttribute("Qualifier");_=r(V.getAttribute("Term"));if($){_+="#"+$;}a1=f(t,V,Z);a1=s(a1,M.types,Q,S);q[Q][_]=a1;}b1=x.selectNodes(t,"//d:Annotations[contains(@Target, '"+Z+"')]//d:PropertyValue[contains(@Path, '/')]//@Path",t);for(i=0;i<b1.length;i+=1){c1=x.nextNode(b1,i);d1=c1.value;if(q.propertyAnnotations){if(q.propertyAnnotations[Q]){if(q.propertyAnnotations[Q][d1]){continue;}}}e1=d1.split('/');if(o(Q,e1[0],m)){if(!q.expand){q.expand={};}if(!q.expand[Q]){q.expand[Q]={};}q.expand[Q][e1[0]]=e1[0];}}f1=x.selectNodes(t,"//d:Annotations[contains(@Target, '"+Z+"')]//d:Path[contains(., '/')]",t);for(i=0;i<f1.length;i+=1){c1=x.nextNode(f1,i);d1=x.getNodeText(c1);if(q.propertyAnnotations[Q]){if(q.propertyAnnotations[Q][d1]){continue;}}if(!q.expand){q.expand={};}if(!q.expand[Q]){q.expand[Q]={};}e1=d1.split('/');if(o(Q,e1[0],m)){if(!q.expand){q.expand={};}if(!q.expand[Q]){q.expand[Q]={};}q.expand[Q][e1[0]]=e1[0];}}}this.initialized[a]=q;}return q;};}());};if(!jQuery.sap.isDeclared('sap.ushell.components.factsheet.controls.PictureTileRenderer')){jQuery.sap.declare("sap.ushell.components.factsheet.controls.PictureTileRenderer");jQuery.sap.require('sap.m.CustomTileRenderer');sap.ushell.components.factsheet.controls.PictureTileRenderer=sap.ui.core.Renderer.extend(sap.m.CustomTileRenderer);sap.ushell.components.factsheet.controls.PictureTileRenderer.render=function(r,c){jQuery.sap.log.debug("PictureTileRenderer :: begin rendering");r.write("<div ");r.writeControlData(c);r.addClass("sapCaUiPictureTile");r.writeClasses();r.write(">");r.write("<div");r.addClass("sapCaUiPictureTileContent");r.writeClasses();r.write(">");r.write("<div id='"+c.getId()+"-wrapper'>");r.renderControl(c._oDeletePictureButton);this._renderContent(r,c);r.write("</div>");r.write("</div></div>");};sap.ushell.components.factsheet.controls.PictureTileRenderer._renderContent=function(r,t){r.renderControl(t.getContent());};};if(!jQuery.sap.isDeclared('sap.ushell.components.factsheet.controls.PictureViewerRenderer')){jQuery.sap.declare("sap.ushell.components.factsheet.controls.PictureViewerRenderer");jQuery.sap.require('sap.m.TileContainerRenderer');sap.ushell.components.factsheet.controls.PictureViewerRenderer={};sap.ushell.components.factsheet.controls.PictureViewerRenderer.render=function(r,c){jQuery.sap.log.debug("PictureViewerRenderer :: begin rendering");sap.m.TileContainerRenderer.render(r,c);jQuery.sap.log.debug("PictureViewerRenderer :: end rendering");};};if(!jQuery.sap.isDeclared('sap.ushell.components.factsheet.factory.ThingInspector')){(function(){"use strict";jQuery.sap.declare("sap.ushell.components.factsheet.factory.ThingInspector");sap.ushell.components.factsheet.factory=(function(){jQuery.sap.require('sap.suite.ui.commons.UnifiedThingInspector');jQuery.sap.require('sap.ui.vbm.library');var t,M={},A=[],L={},c,d,g,f,h,q,r,s,u,v,w,x,y={},z,B,C,D,E,F,G,H,I,J,K,N,O,P,Q,R,S,T,U,V,W,X,Y="displayFactSheet";jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.core.format.NumberFormat');Q=sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale();if(sap.ui.getCore().getConfiguration().getLanguage()==="ZH"){Q=new sap.ui.core.Locale("zh_CN");}function Z(a){return a<0?true:false;}function _(a){var b=Number(a).toFixed(0);if(Z(a)){b=Number(b)*-1;}return b;}function a1(a,b){var e,o,i,n;if(!a){return"";}o=new RegExp(sap.ui.core.format.NumberFormat.oDefaultFloatFormat.groupingSeparator,"g");if(b>=0){b=parseInt(b,10);n=sap.ui.core.format.NumberFormat.getFloatInstance({minFractionDigits:b,maxFractionDigits:b},Q);}else{n=sap.ui.core.format.NumberFormat.getFloatInstance({minFractionDigits:0,maxFractionDigits:99},Q);}e=n.format(a);i=e.replace(/[\D]/g,"");if(i&&i.length>6){a=a.replace(o,"");if(_(a)<1000){return sap.ui.core.format.NumberFormat.getIntegerInstance().format(a);}n=sap.ui.core.format.NumberFormat.getFloatInstance({minFractionDigits:1,maxFractionDigits:1,style:"short"},Q);return n.format(a);}else{return e;}}function b1(){var p,a,o="",b,m,e,k,i,j,n,l,c1;b=this.getElementBinding().sPath.split("/")[1];m=this.getModel();e=this.mBindingInfos.value.parameters;k=this.mBindingInfos.value.parts;for(i=0;i<e.length;i+=1){o=o+e[i].string;}for(j=0;j<k.length;j+=1){p=k[j].path;l="{"+p+"}";a=m.oData[b][p];o=o.replace(l,a);}n=z(o);if($.isNumeric(n)){c1=this.mBindingInfos.value.parts.filter(function(d1){return(d1.path===p);});n=a1(n,c1[0].type.oFormatOptions.maxFractionDigits);this.setDoubleFontSize(true);}this.setValue(n);this.getElementBinding().detachChange(b1);}V=function(){var a="";if(t.getName()&&t.getDescription()){a=t.getName()+", "+t.getDescription();}else if(t.getName()&&!t.getDescription()){a=t.getName();}else if(!t.getName()&&t.getDescription()){a=t.getDescription();}return a;};f=function(a){var b,e,i;b=a.slice(1).split("/");e="/";for(i=0;i<b.length;i+=1){if((b[i].indexOf("(")>0)&&(b[i].indexOf("sid(")<0)){break;}else{e+=b[i]+"/";}}return e;};h=function(a,m){var e,b,i,n;b=a.slice(m.sServiceUrl.length+1);if(b.indexOf("/")>=0){i=b.split("/");n=i[i.length];e=i[i.length-1];if(e.indexOf("(")>=0){e=e.slice(e.indexOf("("));}e=this.getNavEntitySet(e,n,m.getMetadata());}else{if(b.indexOf("(")>=0){e=b.slice(0,b.indexOf("("));}else{if(b.indexOf("?")>=0){e=b.slice(0,b.indexOf("?"));}else{e=b;}}}return e;};D=function(a,m){var e,k="",o,b;e=a.slice(m.sServiceUrl.length+1);if(e.indexOf("(")>=0){k=e.slice(e.indexOf("(")+1,e.indexOf(")"));if(k.indexOf("=")<=0){o=m.getServiceMetadata();b=r(h(a,m),o);k=E(b,o)+"="+k;}}return k;};E=function(e,m){var i,a,j;for(i=m.dataServices.schema.length-1;i>=0;i-=1){a=m.dataServices.schema[i];if(a.namespace===e.slice(0,e.lastIndexOf("."))){for(j=0;j<a.entityType.length;j+=1){if(a.entityType[j].name===e.slice(e.lastIndexOf(".")+1)){return a.entityType[j].key.propertyRef[0].name;}}}}};q=function(e,m){var i,a,b,j;for(i=m.dataServices.schema.length-1;i>=0;i-=1){a=m.dataServices.schema[i];if(a.entityContainer){b=a.entityContainer[0].entitySet;for(j=b.length-1;j>=0;j-=1){if(b[j].entityType===e){return b[j].name;}}}}};r=function(e,m,b){var i,a,k,j,l;for(i=m.dataServices.schema.length-1;i>=0;i-=1){a=m.dataServices.schema[i];if(a.entityContainer){k=a.entityContainer[0].entitySet;for(j=k.length-1;j>=0;j-=1){if(k[j].name===e){if(b){l=k[j].entityType.slice(a.namespace.length+1);}else{l=k[j].entityType;}return l;}}}}};s=function(e,n,m){var a,i,b,l,k,j,o;a=e.split(".");for(i=m.dataServices.schema.length-1;i>=0;i-=1){b=m.dataServices.schema[i];l=a[0];if(a.length>2){for(k=1;k<a.length-1;k+=1){l+="."+a[k];}}if(b.namespace===l){for(j=0;j<b.entityType.length;j+=1){if(b.entityType[j].name===a[a.length-1]){if(b.entityType[j].navigationProperty){for(k=0;k<b.entityType[j].navigationProperty.length;k+=1){if(b.entityType[j].navigationProperty[k].name===n){o=b.entityType[j].navigationProperty[k];return{name:o.relationship,toRole:o.toRole};}}}}}}}};u=function(e,n,m){var a,b,o,i,l,j,p,k;a=r(e,m);if(n.charAt(0)==="@"){if(M.termDefinitions&&M.termDefinitions[n]){b=M.termDefinitions[n];if(b.indexOf("Collection")>=0){b=b.slice(b.indexOf("(")+1,b.indexOf(")"));}return q(b,m);}}else{o=s(a,n,m);if(o){for(i=m.dataServices.schema.length-1;i>=0;i-=1){l=m.dataServices.schema[i];if(l.entityContainer&&l.entityContainer[0].associationSet){for(j=l.entityContainer[0].associationSet.length-1;j>=0;j-=1){p=l.entityContainer[0].associationSet[j];if(p.association===o.name){for(k=0;k<p.end.length;k+=1){if(p.end[k].role===o.toRole){return p.end[k].entitySet;}}}}}}}}};v=function(e,n,m){var a,o,i,b,j,l,k,p,c1;a=r(e,m);p=a.split(".")[a.split(".").length-1];o=s(a,n,m);if(o){for(i=m.dataServices.schema.length-1;i>=0;i-=1){b=m.dataServices.schema[i];for(j=0;j<b.entityType.length&&!c1;j+=1){if(b.entityType[j].name===p){for(k=0;k<b.entityType[j].navigationProperty.length;k+=1){if(b.entityType[j].navigationProperty[k].name===n){c1=b.entityType[j].navigationProperty[k].toRole;break;}}}}for(j=b.association.length-1;j>=0;j-=1){l=b.association[j];if(b.namespace+"."+l.name===o.name){for(k=0;k<l.end.length;k+=1){if(l.end[k].role===c1){return l.end[k].multiplicity;}}}}}}else{jQuery.sap.log.error("\""+n+"\" wasn't found in the metadata document. Check whether the corresponding search connector is active.");return 0;}};w=function(e,m){var o,a,b,i;o={};if(M.expand){if(M.expand[r(e,m)]){a=M.expand[r(e,m)];b=[];for(i in a){if(a.hasOwnProperty(i)){b.push(a[i]);}}o.expand=b.join(", ");}}return o;};X=function(a,e,o){var m,b,j,k,l,n;for(m=o.dataServices.schema.length-1;m>=0;m-=1){b=o.dataServices.schema[m];for(j=0;j<b.entityType.length;j+=1){if(b.entityType[j].name===e.split(".")[e.split(".").length-1]){for(k=0;k<b.entityType[j].navigationProperty.length;k+=1){if(b.entityType[j].navigationProperty[k].name===a){for(l=0;l<b.association.length;l+=1){for(n=b.association[l].end.length-1;n>=0;n-=1){if(b.association[l].end[n].role===b.entityType[j].navigationProperty[k].toRole){return(b.association[l].end[n].type);}}}}}}}}};x=function(p,o){var b={},j;b.parts=[];b.parameters=[];for(j=p.length-1;j>=0;j-=1){if(p[j].Type==="Path"){if(p[j].EdmType){switch(p[j].EdmType){case"Edm.DateTimeOffset":case"Edm.DateTime":b.parts.push({path:p[j].Value,type:new sap.ui.model.type.DateTime()});break;case"Edm.Time":b.parts.push({path:p[j].Value+"/ms",type:new sap.ui.model.type.Time({source:{pattern:"timestamp"}})});break;case"Edm.Date":b.parts.push({path:p[j].Value,type:new sap.ui.model.type.Date({"UTC":true})});break;case"Edm.Decimal":case"Edm.Double":case"Edm.Single":b.parts.push({path:p[j].Value,type:new sap.ui.model.type.Float()});break;case"Edm.Int16":case"Edm.Int32":case"Edm.Int64":b.parts.push({path:p[j].Value,type:new sap.ui.model.type.Integer()});break;default:b.parts.push({path:p[j].Value});break;}}else{b.parts.push({path:p[j].Value});}}else if(p[j].Type==="String"){b.parameters.unshift({string:p[j].Value});}}b.formatter=function(){var a="",e,k,l,i,m="",n=false,c1=0,d1=0;if(arguments&&arguments.length>=1){e=arguments.length-1;l="";i=0;if(p&&p[0]&&(p[0].Type==="String")&&(p[0].Value.substr(0,1)==="#")){n=true;}for(k=0;k<p.length;k+=1){if(p[k].Type==="Path"){l=arguments[e];if(!l||(l.length===0)){if(a.length>i){if(a.indexOf("(")>i){a=a.substr(0,i);}else{a=a.substr(0,i);l=a;}}}else{if(n){l=encodeURIComponent(l);}a+=l;c1+=1;}e-=1;i=a.length;}else{i=a.length;m=p[k].Value;if(m.indexOf("(")!==-1){d1+=1;}if((l&&l.length>0)||(m.indexOf("(")!==-1)||(m&&(m.substr(0,1)==="#"))){a+=p[k].Value;}else{m="";}}}if(o){a=o(a);}a=a.trim();if((c1===1)&&(d1>0)&&(a.substr(0,1)==="(")&&(a.substr(-1)===")")){a=a.substr(1,a.length-2);}return a.trim();}};return b;};J=function(o,p){var k;for(k in o){if(o.hasOwnProperty(k)){if(k==="__metadata"){continue;}else if(k===p){return o[k];}else if(typeof o[k]==="object"){return J(o[k],p);}}}};z=function(a){var l,n,b,e={},i;l=a.lastIndexOf("/");n=a.slice(0,l);b=a.slice(l+1);if(!y[a]){e=new sap.ui.model.json.JSONModel();e.loadData(n,null,false);y[a]=e.getData();}else{e=y[a];}if(y[a]&&y[a].d){if(!y[a].d[b]){i=J(y[a].d,b);}else{i=y[a].d[b];}}return i;};B=function(o,e,m,a){var b,i,n,j,k,l,p,c1;b=new sap.ui.core.Control();i=K(o.Value,o.EdmType,e);if(o.Value&&o.Value["com.sap.vocabularies.UI.v1.IsImageURL"]){b=new sap.m.Image({height:"50px"});if(i.BindingInfo){b.bindProperty("src",i.BindingInfo);}else{b.setProperty("src",i.String);}}else{if(o.UrlRef||o.Url||(o.Target&&o.Target.Path)){b=new sap.m.Link({wrapping:true});}else{b=new sap.m.Text();if(o.EdmType==="Edm.Decimal"||o.EdmType==="Edm.Double"||o.EdmType==="Edm.Single"||o.EdmType==="Edm.Int16"||o.EdmType==="Edm.Int32"||o.EdmType==="Edm.Int64"){b.setTextAlign(sap.ui.core.TextAlign.End);}}b.addStyleClass("sapFactsheetUtiDataField");if(i.BindingInfo){b.bindProperty("text",i.BindingInfo);}else{b.setProperty("text",i.String);}}if((o.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithNavigation")&&m){n=o.Target.Path;if(M[e][n.slice(1)]){if(n.charAt(0)==="@"){if(n.indexOf("/")<0){j=M[e][n.slice(1)].UrlRef;}else{j=M[e][n.slice(1,n.indexOf("/"))].UrlRef;}b.bindProperty("href",F(j));}}b.attachPress(function(d1){return false;});}if(o.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){if(o.Url.String){b.setHref(o.Url.String);}else{b.bindProperty("href",F(o.Url));k=new sap.m.Text({wrapping:true});if(i.BindingInfo){k.bindProperty("text",i.BindingInfo);}else{k.setProperty("text",i.String);}b.setVisible(false);l=new sap.ui.layout.VerticalLayout();l.addContent(b);l.addContent(k);if(!A[A.indexOf(a)].Links){A[A.indexOf(a)].Links=[];}if(o.Url.Apply){p=o.Url.Apply.Parameters[0].Value.slice(o.Url.Apply.Parameters[0].Value.indexOf("#")+1,o.Url.Apply.Parameters[0].Value.indexOf("-"));c1=o.Url.Apply.Parameters[0].Value.slice(o.Url.Apply.Parameters[0].Value.indexOf("#")+1,o.Url.Apply.Parameters[0].Value.indexOf("?"));}A[A.indexOf(a)].Links.push({sSemanticObject:p,sIntend:c1,oVL:l});}}if(l){return l;}else{return b;}};C=function(o,l,p,b){var a,e="",i="",m,j,k,n;a=new sap.m.Label(l);a.addStyleClass("sapFactsheetUtiLabel");if(b){e=":";}if(o.Label){if(o.Label.String){a.setText(o.Label.String.trim()+e);a.setTooltip(o.Label.String.trim());}else{if(o.Label.Path){a.bindProperty("text",o.Label.Path);a.bindProperty("tooltip",o.Label.Path);}}}else{if(o.Value){if(o.Value.Path&&p){m=p[o.Value.Path];for(j in m){if(m.hasOwnProperty(j)){if(j==="http://www.sap.com/Protocols/SAPData"){if(m[j].label){i=m[j].label;break;}}}}}else if(o.Value.Apply&&(o.Value.Apply.Name==="odata.concat")){for(k in o.Value.Apply.Parameters){if(o.Value.Apply.Parameters.hasOwnProperty(k)){n=o.Value.Apply.Parameters[k];if(n.Type==="Path"){m=p[n.Value];for(j in m){if(m.hasOwnProperty(j)){if(j==="http://www.sap.com/Protocols/SAPData"){if(m[j].label){i=m[j].label;break;}}}}break;}}}}a.setText(i+e);a.setTooltip(i);}}return a;};K=function(o,e,a){var b={},p,k,l=[],j,m,n,c1=[],d1,e1,i,f1,g1,h1,i1,j1=[],k1;k1=function(a,l1,m1){var p,n1={};p=M.propertyAnnotations[a];if(p&&p[l1]&&p[l1][m1]){if(p[l1][m1].Path){n1.Type="Path";n1.Value=p[l1][m1].Path;}else{n1.Type="String";n1.Value=p[l1][m1].String;}}return n1;};if(!o){return false;}if(o.Apply){if(o.Apply.Name==="odata.concat"){if(a&&M.propertyAnnotations&&M.propertyAnnotations[a]){k=o.Apply.Parameters;for(j=0;j<k.length;j+=1){l.push(k[j]);if(k[j].Type==="Path"){p=k1(a,k[j].Value,"Org.OData.Measures.V1.ISOCurrency");if(!$.isEmptyObject(p)){l.push({Type:"String",Value:" "});l.push({Type:p.Type,Value:p.Value});}p=k1(a,k[j].Value,"Org.OData.Measures.V1.Unit");if(!$.isEmptyObject(p)){l.push({Type:"String",Value:" "});l.push({Type:p.Type,Value:p.Value});}}}b.BindingInfo=x(l);}else{b.BindingInfo=x(o.Apply.Parameters);}}}else{if(o.Path){if(o.Path.charAt(0)==="@"){m=M[a][o.Path.slice(1,o.Path.indexOf("/"))].UrlRef;n=o.Path.slice(o.Path.indexOf("/")+1);if(m&&m.Apply){d1=m.Apply.Parameters;switch(m.Apply.Name){case"odata.concat":c1=d1;c1.push({Type:"String",Value:"/"+n});break;case"odata.fillUriTemplate":e1=d1[0].Value.split("{");for(i in e1){if(e1.hasOwnProperty(i)){if(e1[i].indexOf("}")<0){c1.push({Type:"String",Value:e1[i]});}else{f1=e1[i].split("}");for(j=1;j<d1.length;j+=1){if(d1[j].Name===f1[0]){g1=d1[j].Value;if(g1.Path){c1.push({Type:"Path",Value:g1.Path});}else{if(g1.Apply&&g1.Apply.Name&&(g1.Apply.Name.toLowerCase()==="odata.uriencode")){h1=g1.Apply.Parameters[0];c1.push({Type:h1.Type,Value:encodeURIComponent(h1.Value)});c1.push({Type:"String",Value:"{"+encodeURIComponent(h1.Value)+"}"});}}}}c1.push({Type:"String",Value:f1[1]});}}}c1.push({Type:"String",Value:"/"+n});b.fnChange=b1;break;default:break;}b.BindingInfo=x(c1,z);}else{if(m&&m.Path){c1.push({Type:"Path",Value:m.Path},{Type:"String",Value:"/"+n});b.BindingInfo=x(c1,z);}else{if(m&&m.String){b.String=z(m.String+"/"+n);}}}}else{b.BindingInfo={};switch(e){case"Edm.DateTimeOffset":case"Edm.DateTime":b.BindingInfo={path:o.Path,type:new sap.ui.model.type.DateTime()};break;case"Edm.Time":b.BindingInfo={path:o.Path+"/ms",type:new sap.ui.model.type.Time({source:{pattern:"timestamp"}})};break;case"Edm.Date":b.BindingInfo={path:o.Path,type:new sap.ui.model.type.Date({"UTC":true})};break;case"Edm.Decimal":case"Edm.Double":case"Edm.Single":case"Edm.Int16":case"Edm.Int32":case"Edm.Int64":if((e==="Edm.Decimal")||(e==="Edm.Double")||(e==="Edm.Single")){i1=new sap.ui.model.type.Float();}else if((e==="Edm.Int16")||(e==="Edm.Int32")||(e==="Edm.Int64")){i1=new sap.ui.model.type.Integer();}if(M.propertyAnnotations){j1.push({Type:"Path",Value:o.Path,EdmType:e},{Type:"String",Value:" "});p=k1(a,o.Path,"Org.OData.Measures.V1.ISOCurrency");if(!$.isEmptyObject(p)){j1.push({Type:p.Type,Value:p.Value});}p=k1(a,o.Path,"Org.OData.Measures.V1.Unit");if(!$.isEmptyObject(p)){j1.push({Type:p.Type,Value:p.Value});}b.BindingInfo=x(j1);}else{b.BindingInfo={path:o.Path,type:i1};}break;default:b.BindingInfo={path:o.Path};break;}}}else{if(o.String){b.String=o.String;}}}return b;};F=function(o){var a=[],p,b,j,e,i={},k,l,m;if(o&&o.Apply){p=o.Apply.Parameters;switch(o.Apply.Name){case"odata.fillUriTemplate":p[0].Value=p[0].Value.trim();b=p[0].Value.split("{");for(j=0;j<b.length;j+=1){if(b[j].indexOf("}")<0){a.push({"Value":b[j],"Type":"String"});}else{e=b[j].split("}");i={};i.Value=e[0];i.Type="Path";for(j=1;j<p.length;j+=1){if(p[j].Name===i.Value){k=p[j].Value;if(k.Path){i.Value=k.Path;}else{if(k.Apply&&k.Apply.Name&&k.Apply.Name.toLowerCase()==="odata.uriencode"){i.Value=k.Apply.Parameters[0].Value;}}break;}}a.push(i);a.push({"Value":e[1],"Type":"String"});}}l=sap.ushell.Container.getService("NavTargetResolution").getCurrentResolution();if(l&&l.url){m=jQuery.sap.getUriParameters(l.url).get("sap-system");if(m){a.push({Type:"String",Value:"&sap-system="+m});}}break;default:break;}}return x(a);};G=function(o){var a=sap.ui.core.TextAlign.Begin;if(o.EdmType==="Edm.Decimal"||o.EdmType==="Edm.Double"||o.EdmType==="Edm.Single"||o.EdmType==="Edm.Int16"||o.EdmType==="Edm.Int32"||o.EdmType==="Edm.Int64"){a=sap.ui.core.TextAlign.End;}return a;};N=function(m,e,a,o,b,k){var l,p,j=0,n=0,c1=0,d1=0,e1,i,f1,g1,h1;if(!b){b=m.getServiceMetadata();}if(!a){a=[];}l=r(e,b);h1=new sap.ui.layout.form.SimpleForm({labelMinWidth:150,maxContainerCols:2});p=(M.propertyExtensions)?M.propertyExtensions[l]:[];if(o&&o.High){n=o.High;}if(o&&o.Medium){c1=o.Medium;}if(o&&o.Low){d1=o.Low;}for(i=0;i<a.length;i+=1){e1=W(a[i]);if(o&&(e1==="High")){if(n){n-=1;}else{continue;}}else if(o&&(e1==="Medium")){if(c1){c1-=1;}else{continue;}}else if(o&&(e1==="Low")){if(d1){d1-=1;}else{continue;}}if(o&&o.Total&&(j>=o.Total)){break;}j+=1;f1=new sap.ui.core.Control().setModel(m);g1=C(a[i],{textAlign:sap.ui.core.TextAlign.End},p,false);g1.addStyleClass("sapFactsheetUtiFormPadding");f1=B(a[i],l,b,k);f1.addStyleClass("sapFactsheetUtiFormPadding");if(f1.setTextAlign){f1.setTextAlign(sap.ui.core.TextAlign.Begin);}h1.addContent(g1);h1.addContent(f1);}h1.addStyleClass("sapFactsheetUtiFormLayout");return h1;};O=function(m,e,o,b,a){var j,k="",l,n,p,c1,d1,e1,f1,g1,h1,i1,j1=[],i,k1,l1,m1;j=m.getServiceMetadata();switch(o.RecordType){case"com.sap.vocabularies.UI.v1.ReferenceFacet":l=new sap.suite.ui.commons.UnifiedThingGroup();if(o.Label&&o.Label.String){l.setTitle(o.Label.String);}n=o.Target.AnnotationPath;p=n.substring(n.lastIndexOf("@")+1);n=n.substring(0,n.lastIndexOf("@")-1);if(n){k=v(e,n,j);}c1=p.split("#");switch(c1[0]){case"com.sap.vocabularies.UI.v1.LineItem":case"com.sap.vocabularies.UI.v1.Chart":case"com.sap.vocabularies.UI.v1.Badge":case"com.sap.vocabularies.UI.v1.Identification":if(n){d1=u(e,n,j);k1=r(d1,j);}else{k1=r(e,j);}if(c1[0]==="com.sap.vocabularies.UI.v1.Chart"){p="com.sap.vocabularies.UI.v1.LineItem";}l1=M[k1][p];if(M.propertyExtensions){m1=M.propertyExtensions[k1];}if(k==="*"&&c1[0]!=="com.sap.vocabularies.UI.v1.Identification"){e1=P(m,l1,k1,j,b+"/"+n,o,m1,a);l.setContent(e1);}if(c1[0]==="com.sap.vocabularies.UI.v1.Identification"){f1=M[k1]["com.sap.vocabularies.UI.v1.Identification"];g1=new sap.ui.layout.VerticalLayout({width:"100%"}).setModel(m);if(n){g1.addContent(N(m,d1,f1,null,null,a)).addStyleClass("sapFactsheetUtiPanel");g1.bindElement(b+"/"+n);}else{g1.addContent(N(m,e,f1,null,null,a).addStyleClass("sapFactsheetUtiPanel"));}l.setContent(g1);}break;case"com.sap.vocabularies.UI.v1.StatusInfo":if(n){d1=u(e,n,j);h1=M[r(d1,j)]["com.sap.vocabularies.UI.v1.StatusInfo"];l.setContent(N(m,d1,h1,null,null,a).addStyleClass("sapFactsheetUtiPanel").bindElement(b+"/"+n));}else{h1=M[r(e,j)]["com.sap.vocabularies.UI.v1.StatusInfo"];l.setContent(N(m,e,h1,null,null,a).addStyleClass("sapFactsheetUtiPanel"));}break;case"com.sap.vocabularies.UI.v1.FieldGroup":i1=M[r(e,j)][p];if(i1){if(!l.getTitle()||(l.getTitle()==="")){if(i1.Label){if(i1.Label.String){l.setTitle(i1.Label.String);}else{if(i1.Label.Path){l.bindProperty("title",i1.Label.Path);}}}}if(n){d1=u(e,n,j);l.setContent(N(m,d1,i1.Data,null,null,a).addStyleClass("sapFactsheetUtiPanel").bindElement(b+"/"+n));}else{l.setContent(N(m,e,i1.Data,null,null,a).addStyleClass("sapFactsheetUtiPanel"));}}break;default:break;}return l;case"com.sap.vocabularies.UI.v1.ReferenceURLFacet":l=new sap.ui.ux3.ThingGroup({title:o.Label.String});l.setContent(H(o));return l;case"com.sap.vocabularies.UI.v1.CollectionFacet":for(i=0;i<o.Facets.length;i+=1){j1.push(O(m,e,o.Facets[i],b,a));}return j1;default:break;}};H=function(o){var i,a,b;switch(o.UrlContentType.String){case"image/png":case"image/jpeg":case"image/gif":i=new sap.m.Image({width:"100%"});if(o.Url.String){i.setSrc(o.Url.String);}return i;default:a=new sap.ui.core.HTML();if(o.Url.String){a.setContent("<iframe src = '"+o.Url.String+"' width='100%' height='250px' frameborder='0'></iframe>");}else{if(o.Url.Path){a.bindProperty("content",{path:o.Url.Path,formatter:function(e){b="<iframe src = '"+o.Url.Path+"' width='100%' height='250px' frameborder='0'></iframe>";return b;}});}}return a;}};P=function(m,a,e,o,b,l,n,c1){var d1,e1,f1,g1,h1,i,k,i1=[],j1=[],k1=[],l1=[],m1,n1,o1,p1,q1,r1,s1,t1=[],u1,v1,w1,x1=[],y1,z1,A1,B1,C1,D1,E1,F1,G1=false,H1,I1;F1=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");if(!o){o=m.getServiceMetadata();}d1=(M.propertyExtensions)?M.propertyExtensions[e]:[];e1=6;if(jQuery.device.is.tablet&&jQuery.device.is.landscape){e1=5;}else if(jQuery.device.is.tablet&&jQuery.device.is.portrait){e1=4;}else if(jQuery.device.is.phone&&jQuery.device.is.landscape){e1=3;}else if(jQuery.device.is.phone&&jQuery.device.is.portrait){e1=2;}f1=0;g1=0;for(i=0;i<a.length;i+=1){h1=W(a[i]);if(h1==="High"){f1+=1;}}if(e1>f1){g1=e1-f1;}else if(e1<f1){f1=e1;}j1.push(new sap.m.Column({visible:false}));i1.push(new sap.m.Text().bindText("__metadata/uri"));for(i=0;i<a.length;i+=1){I1="";o1=new sap.ui.core.Control();h1=W(a[i]);o1=B(a[i],e,o,c1);m1=C(a[i],null,d1);if(a[i].Value.Path){w1=a[i].Value.Path;if(n&&n[w1]&&n[w1]["http://www.sap.com/Protocols/SAPData"]&&n[w1]["http://www.sap.com/Protocols/SAPData"].sortable){m1.data("IsSortable",n[w1]["http://www.sap.com/Protocols/SAPData"].sortable);if(n[w1]["http://www.sap.com/Protocols/SAPData"].sortable==="true"){G1=true;}}else{m1.data("IsSortable","true");G1=true;}if(n&&n[w1]&&n[w1]["http://www.sap.com/Protocols/SAPData"]&&n[w1]["http://www.sap.com/Protocols/SAPData"].filterable){m1.data("IsFilterable",n[w1]["http://www.sap.com/Protocols/SAPData"].filterable);if(n[w1]["http://www.sap.com/Protocols/SAPData"].filterable==="true"){G1=true;}}else{m1.data("IsFilterable","true");G1=true;}}else{H1=true;for(k=0;k<a[i].Value.Apply.Parameters.length;k+=1){if(a[i].Value.Apply.Parameters[k].Type==="Path"){w1=a[i].Value.Apply.Parameters[k].Value;if(n[w1]&&n[w1]["http://www.sap.com/Protocols/SAPData"]&&n[w1]["http://www.sap.com/Protocols/SAPData"].sortable){if(n[w1]["http://www.sap.com/Protocols/SAPData"].sortable==="false"){H1=false;I1="";break;}}if(I1){I1+=";";}I1+=w1;}}w1=I1;if(H1===false){m1.data("IsSortable","false");}else{m1.data("IsSortable","true");G1=true;}m1.data("IsFilterable","false");}if(a[i].EdmType){m1.data("EdmType",a[i].EdmType);}m1.data("ColumnName",w1);k1.push(m1);l1.push(o1);if(h1==="High"){if(f1>0){n1=true;f1-=1;}else{n1=false;}}else if(h1==="Medium"){if(g1>0){n1=true;g1-=1;}else{n1=false;}}else{n1=false;}j1.push(new sap.m.Column({header:m1,hAlign:G(a[i]),visible:n1}));i1.push(o1);}p1=new sap.m.ColumnListItem({type:sap.m.ListType.Navigation,unread:false,cells:i1});if(l){q1=l.Label.String;}p1.attachPress({aColumns:a,aLabels:k1,aControls:l1,sTitle:q1},function(j,p){var J1,K1,m1,i,L1,M1,N1;J1=j.getSource().getCells()[0].getText().substr(j.getSource().getCells()[0].getText().lastIndexOf("/"));K1=new sap.m.Table({backgroundDesign:sap.m.BackgroundDesign.Transparent,showSeparators:sap.m.ListSeparators.None,columns:[new sap.m.Column({hAlign:sap.ui.core.TextAlign.End}),new sap.m.Column()]});K1.addStyleClass("sapFactsheetUtiPanel");K1.addStyleClass("sapFactsheetUtiTilePadding");K1.addStyleClass("sapFactsheetUtiTableNoTopBorder");K1.bindElement(J1);for(i=0;i<a.length;i+=1){m1=k1[i].clone();m1.setText(m1.getText()+":");N1=l1[i].clone();m1.setLabelFor(N1);K1.addItem(new sap.m.ColumnListItem({cells:[m1,N1]}));}L1=new sap.suite.ui.commons.UnifiedThingGroup({content:K1,title:q1,description:V()});M1=new sap.m.Page({title:t.getTitle(),showNavButton:true,content:[L1]});t.navigateToPage(M1,true);t.attachAfterNavigate(K1,function(j){if(j.getParameters().getParameters().toId.indexOf("__page")>=0){var O1;O1=K1.getItems();if(O1.length>0&&A.indexOf(c1)>=0){A[A.indexOf(c1)].bLoaded=true;A[A.indexOf(c1)].bProcessed=false;A[A.indexOf(c1)].bIsTable=true;A[A.indexOf(c1)].oTableItems=O1;c(A.indexOf(c1));}}});});r1=new sap.m.Table({growing:true,columns:j1});r1.setModel(m);r1.bindItems({path:b,template:p1});z1=new sap.m.VBox({items:[new sap.m.Input({placeholder:F1.getText("USHELL_FACTSHEET_ENTER_YOUR_FILTER"),change:function(j){var p,J1,K1,L1,i;p=j.getSource().getParent().getParent().getId();J1=sap.ui.getCore().byId(p.substr(0,p.indexOf("-")));K1=J1.getFilterItems();for(i=0;i<K1.length;i+=1){if(K1[i]instanceof sap.m.ViewSettingsCustomItem&&K1[i].getKey()===this.oParent.data("ColumnName")){L1=K1[i];break;}}if(L1){if((j.getParameter("newValue")===undefined)||(j.getParameter("newValue")==="")){L1.setSelected(false);L1.setFilterCount(0);}else{L1.setSelected(true);L1.setFilterCount(1);}}}}).addStyleClass("sapFactsheetUtiFilterInput")]});A1=new sap.m.VBox({items:[new sap.m.List({mode:sap.m.ListMode.SingleSelectLeft,includeItemInSelection:true,items:[new sap.m.StandardListItem({title:F1.getText("USHELL_FACTSHEET_GREATER_THEN")}).data("FilterOperator",sap.ui.model.FilterOperator.GT),new sap.m.StandardListItem({title:F1.getText("USHELL_FACTSHEET_EQUALS")}).data("FilterOperator",sap.ui.model.FilterOperator.EQ),new sap.m.StandardListItem({title:F1.getText("USHELL_FACTSHEET_LESS_THEN")}).data("FilterOperator",sap.ui.model.FilterOperator.LT)]}),new sap.m.Input({placeholder:F1.getText("USHELL_FACTSHEET_ENTER_YOUR_FILTER"),change:function(j){var p,J1,K1,L1,i;p=j.getSource().getParent().getParent().getId();J1=sap.ui.getCore().byId(p.substr(0,p.indexOf("-")));K1=J1.getFilterItems();for(i=0;i<K1.length;i+=1){if((K1[i]instanceof sap.m.ViewSettingsCustomItem)&&(K1[i].getKey()===this.oParent.data("ColumnName"))){L1=K1[i];break;}}if(L1){if((j.getParameter("newValue")===undefined)||(j.getParameter("newValue")==="")){L1.setSelected(false);L1.setFilterCount(0);}else{L1.setSelected(true);L1.setFilterCount(1);}}}}).addStyleClass("sapFactsheetUtiFilterInput")]});new sap.m.VBox({items:[new sap.m.List({mode:sap.m.ListMode.SingleSelectLeft,includeItemInSelection:true,items:[new sap.m.StandardListItem({title:F1.getText("USHELL_FACTSHEET_AFTER")}).data("FilterOperator",sap.ui.model.FilterOperator.GT),new sap.m.StandardListItem({title:F1.getText("USHELL_FACTSHEET_AT")}).data("FilterOperator",sap.ui.model.FilterOperator.EQ),new sap.m.StandardListItem({title:F1.getText("USHELL_FACTSHEET_BEFORE")}).data("FilterOperator",sap.ui.model.FilterOperator.LT)]}),new sap.m.DateTimeInput({type:sap.m.DateTimeInputType.Date,valueFormat:new sap.ui.model.type.DateTime({pattern:"yyyy/MM/dd HH:mm:ss UTC+00:00"}).getOutputPattern(),placeholder:F1.getText("USHELL_FACTSHEET_ENTER_YOUR_FILTER"),change:function(j){var p,J1,K1,L1,i;p=j.getSource().getParent().getParent().getId();J1=sap.ui.getCore().byId(p.substr(0,p.indexOf("-")));K1=J1.getFilterItems();for(i=0;i<K1.length;i+=1){if((K1[i]instanceof sap.m.ViewSettingsCustomItem)&&(K1[i].getKey()===this.oParent.data("ColumnName"))){L1=K1[i];break;}}if((j.getParameter("newValue")===undefined)||(j.getParameter("newValue")==="")){L1.setSelected(false);L1.setFilterCount(0);}else{L1.setSelected(true);L1.setFilterCount(1);}}}).addStyleClass("sapFactsheetUtiFilterInput")]});B1=function(o1){var j=[],i,p,J1=o1.getItems(),K1;if(J1[0].getParent().data("EdmType")==="Edm.String"&&J1[0].getValue()){j.push(new sap.ui.model.Filter(J1[0].getParent().data("ColumnName"),sap.ui.model.FilterOperator.Contains,J1[0].getValue()));}else if(J1[0].getParent().data("EdmType")==="Edm.Decimal"&&J1[1].getValue()){for(i=0;i<J1[0].getItems().length;i+=1){if(J1[0].getItems()[i].getSelected()===true){p=J1[0].getItems()[i].data("FilterOperator");break;}}K1=J1[1].getValue();for(i=K1.length-1;i>0;i-=1){if(K1[i]===","){K1=K1.replace(K1[i],".");break;}}j.push(new sap.ui.model.Filter(J1[1].getParent().data("ColumnName"),p,K1));}else if(J1[0].getParent().data("EdmType")==="Edm.Date"&&J1[1].getValue()){for(i=0;i<J1[0].getItems().length;i+=1){if(J1[0].getItems()[i].getSelected()===true){p=J1[0].getItems()[i].data("FilterOperator");break;}}j.push(new sap.ui.model.Filter(J1[1].getParent().data("ColumnName"),p,J1[1].getValue()));}else{j.push(new sap.ui.model.Filter(J1[0].getParent().data("ColumnName"),sap.ui.model.FilterOperator.EQ,J1[0].getValue()));}return j;};C1=function(p){var J1=p.getSource(),K1=J1.getFilterItems(),L1,i,j;for(i=0;i<K1.length;i+=1){if(K1[i]&&K1[i]instanceof sap.m.ViewSettingsCustomItem){K1[i].setSelected(false);K1[i].setFilterCount(0);L1=K1[i].getCustomControl().getItems();for(j=0;j<L1.length;j+=1){if((L1[j]instanceof sap.m.Input)||(L1[j]instanceof sap.m.DateTimeInput)){L1[j].setValue("");}if((L1[j]instanceof sap.m.List)&&(L1[j].getSelectedItem()!==null)){L1[j].removeSelections();}}}}};D1=C1;for(i=0;i<j1.length;i+=1){if(j1[i+1]){m1=k1[i].clone();if(m1.getText()&&(m1.data("IsSortable")==="true")&&j1[i+1].getVisible()){u1=new sap.m.ViewSettingsItem({text:m1.getText(),key:m1.data("ColumnName")});if(i===0){u1.setSelected(true);}u1.Sort=m1.Sort;t1.push(u1);}if(m1.getText()&&(m1.data("IsFilterable")==="true")){if(m1.data("EdmType")==="Edm.String"){E1=z1.clone().data("ColumnName",m1.data("ColumnName")).data("EdmType",m1.data("EdmType"));}else if(m1.data("EdmType")==="Edm.Decimal"){E1=A1.clone().data("ColumnName",m1.data("ColumnName")).data("EdmType",m1.data("EdmType"));}if((m1.data("EdmType")==="Edm.String")||(m1.data("EdmType")==="Edm.Decimal")){y1=new sap.m.ViewSettingsCustomItem({key:m1.data("ColumnName"),text:m1.getText(),customControl:E1,customData:new sap.ui.core.CustomData({key:"callback",value:B1})});x1.push(y1);}}}}v1=new sap.m.ViewSettingsDialog({sortItems:t1,filterItems:x1,cancel:D1,resetFilters:C1,confirm:function(j){var J1,K1,L1=[],M1,N1=[],O1,P1=[],Q1=[],p,i,R1;J1=j.getParameters();K1=r1.getBinding("items");if(J1.sortItem){M1=J1.sortItem.getKey();O1=J1.sortDescending;if(M1.indexOf(";")>0){N1=M1.split(";");for(i=0;i<N1.length;i+=1){L1.push(new sap.ui.model.Sorter(N1[i],O1));}}else if(M1){L1.push(new sap.ui.model.Sorter(M1,O1));}K1.sort(L1);}p=J1;for(i=0;i<p.filterItems.length;i+=1){if(p.filterItems[i]instanceof sap.m.ViewSettingsCustomItem){R1=p.filterItems[i].getCustomData()[0].getValue();P1=R1.apply(this,[p.filterItems[i].getCustomControl()]);if(P1){if(!Array.isArray(P1)){P1=[P1];}Q1=Q1.concat(P1);}}else if(p.filterItems[i]instanceof sap.m.ViewSettingsItem){P1=p.filterItems[i].getCustomData()[0].getValue();if(P1){if(!Array.isArray(P1)){P1=[P1];}Q1=Q1.concat(P1);}}}K1.filter(Q1);}});if(G1===true&&(t1.length>0||x1.length>0)){r1.setHeaderToolbar(new sap.m.Toolbar({content:[new sap.m.Label(),new sap.m.ToolbarSpacer(),new sap.m.Button({icon:"sap-icon://drop-down-list",press:function(j){v1.open();},tooltip:sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("P13NDIALOG_VIEW_SETTINGS")})]}));}r1.setNoDataText(sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("PULL2REFRESH_LOADING_LONG"));s1=(function(c1){return function(j){var p=this.getItems();if(p.length===0){this.setNoDataText(F1.getText("FACETOVERVIEW_NO_CONTENT_TEXT"));}else{this.setNoDataText(sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("PULL2REFRESH_LOADING_LONG"));}if(p.length>0&&A.indexOf(c1)>=0){A[A.indexOf(c1)].bLoaded=true;A[A.indexOf(c1)].bProcessed=false;A[A.indexOf(c1)].bIsTable=true;A[A.indexOf(c1)].oTableItems=p;}c(A.indexOf(c1));};}(c1));r1.attachUpdateFinished(s1);return r1;};R=function(a,o,b,e){var i;switch(a){case"com.sap.vocabularies.UI.v1.ChartType/Area":i=new sap.viz.ui5.Area({});break;case"com.sap.vocabularies.UI.v1.ChartType/Bar":i=new sap.viz.ui5.Bar({});break;case"com.sap.vocabularies.UI.v1.ChartType/Bubble":i=new sap.viz.ui5.Bubble({});break;case"com.sap.vocabularies.UI.v1.ChartType/Column":i=new sap.viz.ui5.Column({});break;case"com.sap.vocabularies.UI.v1.ChartType/ColumnStacked":i=new sap.viz.ui5.StackedColumn({});break;case"com.sap.vocabularies.UI.v1.ChartType/ColumnStacked100":i=new sap.viz.ui5.StackedColumn100({});break;case"com.sap.vocabularies.UI.v1.ChartType/Donut":i=new sap.viz.ui5.Donut({});break;case"com.sap.vocabularies.UI.v1.ChartType/HeatMap":i=new sap.viz.ui5.Heatmap({});break;case"com.sap.vocabularies.UI.v1.ChartType/HorizontalArea":i=new sap.viz.ui5.HorizontalArea({});break;case"com.sap.vocabularies.UI.v1.ChartType/Line":i=new sap.viz.ui5.Line({});break;case"com.sap.vocabularies.UI.v1.ChartType/Pie":i=new sap.viz.ui5.Pie({});break;case"com.sap.vocabularies.UI.v1.ChartType/Scatter":i=new sap.viz.ui5.Scatter({});break;case"com.sap.vocabularies.UI.v1.ChartType/TreeMap":i=new sap.viz.ui5.Treemap({});break;case"com.sap.vocabularies.UI.v1.ChartType/AreaStacked":case"com.sap.vocabularies.UI.v1.ChartType/AreaStacked100":case"com.sap.vocabularies.UI.v1.ChartType/BarStacked":case"com.sap.vocabularies.UI.v1.ChartType/BarStacked100":case"com.sap.vocabularies.UI.v1.ChartType/HorizontalAreaStacked":case"com.sap.vocabularies.UI.v1.ChartType/HorizontalAreaStacked100":case"com.sap.vocabularies.UI.v1.ChartType/Radar":case"com.sap.vocabularies.UI.v1.ChartType/Waterfall":break;}if(i){if(o&&o.String){i.setTitle(new sap.viz.ui5.types.Title({visible:true,text:o.String}));}if(b&&b.String){i.setTooltip(b.String);}i.setWidth("100%");i.setHeight("17rem");i.setDataset(e);}else{i=new sap.m.Text({});}return i;};S=function(i){var a;i=i||1;if(jQuery.device.is.phone){a=(7*i)+"rem";}else{a=(11*i-1)+"rem";}return a;};T=function(a){var i,b=0,e=0,j=0,o;for(i=0;i<a.length;i+=1){o=W(a[i]);if(o){switch(o){case"High":b+=1;break;case"Medium":e+=1;break;case"Low":j+=1;break;}}}return{High:b,Medium:e,Low:j};};W=function(o){var e="";if(o.Importance){e=o.Importance.EnumMember;}else if(o["com.sap.vocabularies.UI.v1.Importance"]){e=o["com.sap.vocabularies.UI.v1.Importance"].EnumMember;}return e.substr(e.indexOf("/")+1);};U=function(m,a,e,b){var i=false,o,j,k,l;o=new sap.suite.ui.commons.KpiTile({doubleFontSize:false});if(a.ValueFormat){j=a.ValueFormat.NumberOfFractionalDigits.Int;}if(a.Title&&a.Title.String){o.setDescription(a.Title.String);}else{if(a.Title&&a.Title.Path){o.bindProperty("description",{path:a.Title.Path});}}if(a.Value&&a.Value.String){o.setValue(a.Value.String);}else{if(a.Value&&a.Value.Path){k=K(a.Value,a.Value.EdmType,e);if(k.fnChange){o.setModel(m);o.bindElement(b);o.getElementBinding().attachChange(k.fnChange,o);}if(k.String){if($.isNumeric(k.String)){i=true;o.setValue(a1(k.String,j));}else{o.setValue(k.String);}}else if(k.BindingInfo){l=k.BindingInfo;if(l.parts&&l.parts.length===2){o.bindProperty("valueUnit",l.parts[0]);l.parts[1].type=undefined;l.parts[1].formatter=(function(){return function(n){return a1(n,j);};}(j));o.bindProperty("value",l.parts[1]);}else if(l.parts&&l.parts.length===1){l.parts[0].type=undefined;l.parts[0].formatter=(function(){return function(n){return a1(n,j);};}(j));o.bindProperty("value",l);}else{o.bindProperty("value",l);}}}}if(a.Value.EdmType==="Edm.Decimal"||a.Value.EdmType==="Edm.Double"||a.Value.EdmType==="Edm.Single"||a.Value.EdmType==="Edm.Int16"||a.Value.EdmType==="Edm.Int32"||a.Value.EdmType==="Edm.Int64"||i===true){o.setDoubleFontSize(true);}return o;};g=function(m){var a=[],b=[],e,j,k,i,l;j=function(o){if(k(o)===false){if(o.constructor===Array){for(i=0;i<o.length;i+=1){k(o[i]);}}if(o.constructor===Object){for(l in o){if(o.hasOwnProperty(l)){if(o[l].constructor!==String){j(o[l]);}}}}}};k=function(o){if(o.RecordType&&o.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){if(o.Url&&o.Url.Apply){e=o.Url.Apply.Parameters[0].Value.slice(o.Url.Apply.Parameters[0].Value.indexOf("#")+1,o.Url.Apply.Parameters[0].Value.indexOf("-"));if(a.indexOf(e)<0){a.push(e);}return true;}}else{return false;}};for(l in M){if(M.hasOwnProperty(l)){if(l.indexOf(m.dataServices.schema[0].namespace)>=0){j(M[l]);}}}for(i=0;i<a.length;i+=1){if(!L.hasOwnProperty(a[i])){b.push(a[i]);}}return b;};d=function(a){var i,o,l,b;if(a.length>0){o=new sap.ui.model.json.JSONModel();l="/sap/opu/odata/UI2/INTEROP/SemanticObjects?$expand=Links&$format=json";b="&$filter=id%20eq%20%27";for(i=0;i<a.length;i+=1){if(b.length>22){b+="%20or%20id%20eq%20%27"+a[i]+"%27";}else{b+=a[i]+"%27";}}l+=l+b;o.loadData(l);o.attachRequestCompleted(function(){var i,j,e,k=[];if(this.getData().d&&this.getData().d.results){e=this.getData().d.results;for(i=0;i<e.length;i+=1){L[e[i].id]="";k=e[i].Links.results;for(j=0;j<k.length;j+=1){L[k[j].id.slice(0,k[j].id.indexOf("~"))]="";}}}L.InteropCompleted=true;c();});}else{L.InteropCompleted=true;}};c=function(a){var i,j,k,n,b,e,l;if(L.InteropCompleted===true){for(i=0;i<A.length;i+=1){if(A[i].bLoaded&&!A[i].bProcessed&&A[i].Links){l=A[i].Links;for(j=0;j<l.length;j+=1){if(L.hasOwnProperty(l[j].sIntend)===true){if(A[i].bIsTable===true){if(A[i].oTableItems){b=A[i].oTableItems;for(k=0;k<b.length;k+=1){e=b[k].getCells();for(n=0;n<e.length;n+=1){if(e[n]instanceof sap.ui.layout.VerticalLayout&&e[n].getContent()[0].getBindingInfo("href").parts===l[j].oVL.getContent()[0].getBindingInfo("href").parts&&e[n].getContent()[1].getBindingInfo("text").parts===l[j].oVL.getContent()[1].getBindingInfo("text").parts){e[n].getContent()[0].setVisible(true);e[n].getContent()[1].setVisible(false);}}}}}else{l[j].oVL.getContent()[0].setVisible(true);l[j].oVL.getContent()[1].setVisible(false);}}else if(A[i].bIsTable===false){l[j].oVL.getContent()[1].setText(l[j].oVL.getContent()[0].getText());}A[i].bProcessed=true;}}}}if(a>=0){if(A[a].bLoaded&&!A[a].bProcessed&&A[a].Links){l=A[a].Links;for(j=0;j<l.length;j+=1){if(A[a].bIsTable===false){l[j].oVL.getContent()[1].setText(l[j].oVL.getContent()[0].getText());}}}}};I=function(e,l,t){var m,n,p,c1,d1,e1,f1,g1,i,h1={},i1,j1,k1,l1,j,m1,n1,o1,p1,q1,r1,s1,t1,u1,v1=0,w1=0,x1,y1,z1,A1,B1,C1,D1,E1=[],F1,G1,H1,I1,J1,K1,L1,M1,N1,O1,P1,Q1,R1,S1,T1,U1,V1,W1=0,X1,Y1,Z1,$1,_1,a2,b2,c2;m=f(e);r1=l.substring(0,l.substring(0,l.lastIndexOf("/")).lastIndexOf("/"));s1=l.substring(l.substring(0,l.lastIndexOf("/")).lastIndexOf("/"));if(window.location.search.indexOf("cbn_keep_anno_case%3Dtrue")===-1){s1=s1.toLowerCase();}n=new sap.ui.model.odata.ODataModel(m,{annotationURI:r1+s1,loadAnnotationsJoined:true,loadMetadataAsync:false,json:true});n.setCountSupported(false);t.setModel(n);p=h(e,n);c1="/"+e.slice(m.length);d1=n.getServiceMetadata();M=n.getServiceAnnotations();e1=r(p,d1);f1=M[e1]["com.sap.vocabularies.UI.v1.HeaderInfo"];g1=M[e1]["com.sap.vocabularies.UI.v1.Facets"];t.bindElement(c1,w(p,d1));t1=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");L.InteropCompleted=false;d(g(d1));t.addStyleClass("sapFactsheetUtiThingType"+p.replace(/\s/g,""));if(f1.TypeName.String){t.setTitle(f1.TypeName.String);}else{if(f1.TypeName.Path){t.bindProperty("title",{path:f1.TypeName.Path});}}if(f1.ImageUrl&&f1.ImageUrl.String){t.setIcon(f1.ImageUrl.String);}else if(f1.ImageUrl&&f1.ImageUrl.Path){t.bindProperty("icon",{path:f1.ImageUrl.Path});}else if(f1.TypeImageUrl&&f1.TypeImageUrl.String){t.setIcon(f1.TypeImageUrl.String);}else if(f1.TypeImageUrl&&f1.TypeImageUrl.Path){t.bindProperty("icon",{path:f1.TypeImageUrl.Path});}if(f1.Title.Value.String){t.setName(f1.Title.Value.String);}else{t.bindProperty("name",K(f1.Title.Value,f1.Title.EdmType,e1).BindingInfo);}if(f1.Description&&f1.Description.Value){if(f1.Description.Value.String){t.setDescription(f1.Description.Value.String);}else{t.bindProperty("description",K(f1.Description.Value,f1.Description.EdmType,e1).BindingInfo);}}for(X1 in M[e1]){if(M[e1].hasOwnProperty(X1)){if(X1.search("com.sap.vocabularies.UI.v1.DataPoint")!==-1){Y1=M[e1][X1];if(Y1){t.addKpi(U(n,Y1,e1,c1));W1+=1;}}if(W1>=3){break;}}}for(i=0;i<g1.length;i+=1){if(g1[i]["com.sap.vocabularies.UI.v1.IsSummary"]){n1=g1[i];break;}}if(n1){u1=15;for(j=0;j<n1.Facets.length;j+=1){x1=n1.Facets[j].Target.AnnotationPath.substring(n1.Facets[j].Target.AnnotationPath.lastIndexOf("@")+1);i1=n1.Facets[j].Target.AnnotationPath;i1=i1.substring(0,i1.lastIndexOf("@")-1);n1.Facets[j].NavPath=i1;y1=u(p,i1,d1);n1.Facets[j].NavEntitySet=y1;if(y1){z1=y1;}else{z1=p;}n1.Facets[j].EntitySet=z1;A1=r(y1,d1);if(A1){B1=A1;}else{B1=e1;}n1.Facets[j].EntityType=B1;C1=[];if(M[B1][x1].length){C1=M[B1][x1];}else if(M[B1][x1].Data.length){C1=M[B1][x1].Data;}n1.Facets[j].Content=C1;for(i=0;i<C1.length;i+=1){D1=W(C1[i]);if(D1==="High"){v1+=1;}else if(D1==="Medium"){w1+=1;}}}if(v1>=u1){v1=u1;w1=0;}else if((v1+w1)>u1){w1=u1-v1;if(w1<0){w1=0;}}if(jQuery.device.is.phone){w1=0;}H1=u1-v1-w1;P1=new sap.suite.ui.commons.FacetOverview({title:t1.getText("UNIFIEDTHINGINSPECTOR_GENERAL_INFORMATION_HEADER_TEXT")});A=[];A.push(P1);A[0].bLoaded=false;A[0].bProcessed=false;A[0].bIsTable=false;I1=[];K1=w1+v1;for(j=0;j<n1.Facets.length;j+=1){L1=N(n,n1.Facets[j].EntitySet,n1.Facets[j].Content,{High:v1,Medium:w1,Low:0},null,P1).addStyleClass("sapFactsheetUtiTilePadding");if(j>0){L1.addStyleClass("sapFactsheetUtiPaddingTop");}if(n1.Facets[j].NavPath){L1.bindElement(c1+"/"+n1.Facets[j].NavPath);}J1=T(n1.Facets[j].Content);v1-=J1.High;w1-=J1.Medium;if(((J1.High>0)&&((v1+J1.High)>0))||((J1.Medium>0)&&((w1+J1.Medium)>0))){I1.push(L1);if(j>0){if(H1>0){H1-=1;}else if(w1>0){w1-=1;}else if(v1>0){v1-=1;}}}if((v1<1)&&(w1<1)){break;}}if(v1<0){v1=0;}if(w1<0){w1=0;}h1=new sap.ui.layout.VerticalLayout({content:I1,width:"100%"});M1=S();O1=1;if((K1>3)&&(K1<=9)){M1=S(2);O1=2;}else if(K1>9){M1=S(3);O1=3;}P1.setContent(h1);P1.setRowSpan(O1);if(jQuery.device.is.phone){P1.setHeightType(sap.suite.ui.commons.FacetOverviewHeight.Auto);}else{P1.setHeight(M1);}P1.addStyleClass("sapFactsheetUtiGeneralInformationOverviewFacet");P1.attachPress({facets:n1},function(o,a){var b,k,d2,e2,h1;t.removeAllFacetContent();d2=new sap.suite.ui.commons.UnifiedThingGroup();d2.setDescription(V());d2.setTitle(t1.getText("UNIFIEDTHINGINSPECTOR_GENERAL_INFORMATION_HEADER_TEXT"));d2.addStyleClass("sapFactsheetUtiGeneralInformationUtg");if(a.facets.Facets.length>1){b="L6 M12 S12";}else{b="L12 M12 S12";}A[0].Links=[];e2=new sap.ui.layout.VerticalLayout({width:"100%"});for(i=0;i<a.facets.Facets.length;i+=1){if(i%2===0){k=new sap.ui.layout.Grid({hSpacing:1,vSpacing:1,defaultSpan:b});}h1=O(n,p,a.facets.Facets[i],c1,this);h1.addStyleClass("sapFactsheetUtiGeneralInformationUtgContent");if((i===0)&&(a.facets.Facets.length>1)&&(h1.getTitle().trim()==="")){h1.setTitle(t1.getText("UNIFIEDTHINGINSPECTOR_GENERAL_INFORMATION_HEADER_TEXT"));}k.addContent(h1);if(i%2!==0){e2.addContent(k);}}A[0].bLoaded=true;A[0].bProcessed=false;A[0].bIsTable=false;c(0);if(i%2!==0){e2.addContent(k);}d2.setContent(e2);t.addFacetContent(d2);t.navigateToDetail();});t.addFacet(P1);}k1=function(l1){return function(a){var o,b,k,d2,e2,f2,g2,h2,i2,j2,c1,k2,l2,m2,n2,o2,p2,q2,r2,i;if((l1.cardinality==="*"&&a.results&&a.results.length&&a.results.length!==0)||(l1.cardinality==="1"&&a)){j2=new sap.ui.model.json.JSONModel();if(l1.cardinality==="*"){if(a.results&&a.results.length){j2.setData(a);}}else{j2.setData({result:a});c1="/result";}o=new sap.ui.model.odata.ODataModel("/sap/opu/odata/sap/VBI_APPL_DEF_SRV",false);b=M[l1.navigationType]["com.sap.vocabularies.UI.v1.GeoLocation"];l2=M[l1.navigationType]["com.sap.vocabularies.UI.v1.HeaderInfo"];m2=M[l1.navigationType]["com.sap.vocabularies.UI.v1.Identification"];if(b.Longitude&&b.Latitude){d2={"Data":{"Set":{"N":[{"name":"Spots","E":[]}]}}};if(l1.cardinality==="1"){if(b.Longitude.Path&&b.Latitude.Path){k=a[b.Longitude.Path]+";"+a[b.Latitude.Path]+";0";}d2.Data.Set.N[0].E.push({"A":k,"I":"pin_blue.png"});}else{for(i=0;i<a.results.length;i+=1){if(b.Longitude.Path&&b.Latitude.Path){k=a.results[i][b.Longitude.Path]+";"+a.results[i][b.Latitude.Path]+";0";}d2.Data.Set.N[0].E.push({"A":k,"I":"pin_blue.png"});}if(a.results.length!==0){k=a.results[0][b.Longitude.Path]+";"+a.results[0][b.Latitude.Path]+";0";}}}r2=parseInt(a.__count,10);if(Number(r2)){l1.facet.setQuantity(r2);}g2=function(s2){var t2,u2,v2,w2,x2;t2=$.parseJSON(s2.getParameters().data);if(t2.Action.name==="DETAIL_REQUEST"&&t2.Action.instance){u2=t2.Action.instance;if(j2.oData.results){c1="/results/"+u2.split(".")[1];}q2=l2.TypeName.String.substring(0,17);w2=parseFloat(S(0.7))*16;x2=parseFloat(S(1.5))*16;v2={"SAPVB":{"version":"2.0","xmlns:VB":"VB","Windows":{"Remove":{"name":"Detail1"},"Set":{"name":"Detail1","Window":{"id":"Detail1","type":"callout","refParent":"Main","refScene":"","offsetX":"16","offsetY":"-27","modal":"false","width":x2,"height":w2,"caption":q2,"pos.bind":u2+".GeoPosition"}}},"Scenes":{"Set":{"name":"Details","Scene":{"id":"Details","navControlVisible":"false"}}}}};this.load(v2);}};h2=function(s2){var X1,t2,y1,u2;if(!n2){n2=B(l2.Title,l1.navigationType,d1,l1.facet);n2.setModel(j2);n2.bindElement(c1);o2=B(l2.Description,l1.navigationType,d1,l1.facet);o2.setModel(j2);o2.bindElement(c1);for(X1 in b.Address){if(X1==="label"){k2=B({Value:b.Address[X1]},l1.navigationType,d1,l1.facet);k2.setModel(j2);k2.bindElement(c1);break;}}u2=7;if(jQuery.device.is.tablet&&jQuery.device.is.landscape){u2=4;}else if(jQuery.device.is.tablet&&jQuery.device.is.portrait){u2=5;}else if(jQuery.device.is.phone&&jQuery.device.is.landscape){u2=2;}else if(jQuery.device.is.phone&&jQuery.device.is.portrait){u2=3;}p2=new sap.ui.layout.VerticalLayout({width:"100%"}).setModel(n);if(l1.navigationPath){y1=u(l1.entitySet,l1.navigationPath,d1);p2.addContent(N(n,y1,m2,{High:u2},null,l1.facet));p2.setModel(j2).bindElement(c1);}else{p2.addContent(N(n,l1.entitySet,m2,{High:u2},null,l1.facet)).setModel(j2).bindElement(c1);}}else{n2.bindElement(c1);if(o2){o2.bindElement(c1);}if(k2){k2.bindElement(c1);}if(p2){p2.bindElement(c1);}}t2=parseFloat(S(1.5))*16*0.95+"px";if(n2){n2.placeAt(s2.getParameter("contentarea").id);n2.addStyleClass("sapFactsheetUtiGeoPopupHead");if(jQuery.device.is.phone){n2.addStyleClass("sapFactsheetUtiGeoPopupHeadFontPhone");}n2.setWidth(t2);}if(o2){o2.placeAt(s2.getParameter("contentarea").id);o2.addStyleClass("sapFactsheetUtiGeoPopupDescr");if(jQuery.device.is.phone){o2.addStyleClass("sapFactsheetUtiGeoPopupDescrFontPhone");}o2.setWidth(t2);}if(k2){k2.placeAt(s2.getParameter("contentarea").id);k2.addStyleClass("sapFactsheetUtiGeoPopupText");k2.setWidth(t2);}if(p2&&p2.getContent()[0]&&p2.getContent()[0].getContent&&p2.getContent()[0].getContent().length>0){p2.placeAt(s2.getParameter("contentarea").id);p2.addStyleClass("sapFactsheetUtiGeoPopupText");p2.setWidth(t2);}if(A.indexOf(l1.facet)>=0){A[A.indexOf(l1.facet)].bLoaded=true;A[A.indexOf(l1.facet)].bProcessed=false;A[A.indexOf(l1.facet)].bIsTable=false;}c(A.indexOf(l1.facet));};i2=function(s2){if(n2){n2.destroy();n2=undefined;}if(o2){o2.destroy();o2=undefined;}if(k2){k2.destroy();k2=undefined;}if(p2){p2.destroy();p2=undefined;}$(s2.getParameter("contentarea").id).empty();};e2=function(l1){return function(a){var s2,t2,u2,v2,i;v2=a.ProjectJSON;v2=v2.indexOf("{")?v2.substr(v2.indexOf("{")):v2;s2=$.parseJSON(v2);s2.SAPVB.Scenes.Set.SceneGeo.initialStartPosition=k;s2.SAPVB.Scenes.Set.SceneGeo.initialZoom=12;s2.SAPVB.Actions.Set.Action.push({id:"200",name:"TAP_ON_MAP",refEvent:"Click",refScene:"MainScene",refVO:"Map"});if(d2){s2.SAPVB.Data=d2.Data;}for(i=0;i<s2.SAPVB.Scenes.Set.SceneGeo.VO.length;i+=1){if(s2.SAPVB.Scenes.Set.SceneGeo.VO[i].datasource==="Spots"){if(s2.SAPVB.Scenes.Set.SceneGeo.VO[i].scale&&s2.SAPVB.Scenes.Set.SceneGeo.VO[i].scale.split(";").length!==3){s2.SAPVB.Scenes.Set.SceneGeo.VO[i].scale="1.0;1.0;1.0";break;}}}l1.facet.getContent().attachSubmit(function(w2){if(jQuery.device.is.tablet||jQuery.device.is.phone){l1.facet.firePress();}});l1.facet.getContent().load(s2);l1.facet.attachPress("",function(w2,x2){var y2=[],z2=[],i,A2;if(!t2){t2=new sap.ui.vbm.VBI({width:"100%",height:"100%",plugin:false,config:null});t2.addStyleClass("sapFactsheetUtiGeoPopup");}s2.SAPVB.Scenes.Set.SceneGeo.NavigationDisablement.move="false";s2.SAPVB.Scenes.Set.SceneGeo.NavigationDisablement.zoom="false";s2.SAPVB.Scenes.Set.SceneGeo.NavigationDisablement.pitch="false";s2.SAPVB.Scenes.Set.SceneGeo.NavigationDisablement.yaw="false";s2.SAPVB.Scenes.Set.SceneGeo.SuppressedNavControlVisibility="false";t2.load(s2);if(l1.cardinality==="*"){for(i=0;i<j2.oData.results.length;i+=1){y2.push(j2.oData.results[i][b.Longitude.Path]);z2.push(j2.oData.results[i][b.Latitude.Path]);}}t2.attachSubmit(g2);t2.attachOpenWindow(h2);t2.attachCloseWindow(i2);u2=new sap.suite.ui.commons.UnifiedThingGroup({content:t2,title:l1.facetContent.Label.String,description:V()});t.removeAllFacetContent();t.addFacetContent(u2);t.navigateToDetail();t.attachAfterNavigate(y2,function(w2){if(w2.getParameters().getParameters().toId.indexOf("-detail-page")!==-1){if(jQuery.device.is.phone){A2="300px";}else{A2=Math.floor($("#"+w2.getParameters().getParameters().toId+"-cont").height()-128)+"px";}t2.setHeight(A2);if(y2.length>1){t2.zoomToGeoPosition(y2,z2);}}});});};};f2=function(s2){return function(t2){t.removeFacet(s2);};};o.read("VBIApplicationSet('ZFACTSHEETS')","","",false,e2(l1),f2(l1.facet));}else{l1.facet.setQuantity(undefined);l1.facet.addStyleClass("sapFactsheetUtiEmptyTile");l1.facet.setHeightType(jQuery.device.is.phone?sap.suite.ui.commons.FacetOverviewHeight.Auto:sap.suite.ui.commons.FacetOverviewHeight.S);l1.facet.setContent(undefined);l1.facet.setTitle(undefined);}};};b2=function(o){var a,b;a=o.srcControl.getParent().getParent().getDomRef().clientWidth;b=a;if(o.srcControl.getParent().getContent()[0]){b-=o.srcControl.getParent().getContent()[0].getDomRef().clientWidth;if(a<o.srcControl.getParent().getContent()[0].getDomRef().clientWidth){o.srcControl.getParent().getContent()[0].getDomRef().setAttribute("style","width:"+a+"px");return;}}if(o.srcControl.getParent().getContent()[1]){b-=o.srcControl.getParent().getContent()[1].getDomRef().clientWidth;}if(b<10){b=0;}if(o.srcControl.getParent().getContent()[2]){o.srcControl.getParent().getContent()[2].getDomRef().setAttribute("style","width:"+b+"px");}};j1=function(l1){return function(a){var o,b,k,d2,e2,f2,i,j,h1,g2,h2,i2,j2,k2,l2,m2,n2,o2,p2,q2,r2,s2,t2,u2,v2,w2="",x2,y2,z2,A2,B2,C2;o=new sap.ui.model.json.JSONModel();if(l1.facetContent.Target&&l1.facetContent.Target.AnnotationPath&&l1.facetContent.Target.AnnotationPath.split("#")[1]&&M[l1.navigationType]["com.sap.vocabularies.UI.v1.Badge#"+l1.facetContent.Target.AnnotationPath.split("#")[1]]){b=M[l1.navigationType]["com.sap.vocabularies.UI.v1.Badge#"+l1.facetContent.Target.AnnotationPath.split("#")[1]];}else{b=M[l1.navigationType]["com.sap.vocabularies.UI.v1.Badge"];}if(l1.cardinality==="*"){if(a.results&&a.results.length){x2=l1.facetContent.Target.AnnotationPath;Z1=x2.substring(x2.lastIndexOf("@")+1);if(Z1==="com.sap.vocabularies.UI.v1.Chart"){jQuery.sap.require("sap.viz.ui5.data.FlattenedDataset");y2=M[l1.navigationType]["com.sap.vocabularies.UI.v1.Chart"];z2=M.propertyExtensions[l1.navigationType];A2=[];for(i=0;i<y2.Dimensions.length;i+=1){A2.push({axis:1,name:z2[y2.Dimensions[i].PropertyPath]["http://www.sap.com/Protocols/SAPData"].label,value:"{"+y2.Dimensions[i].PropertyPath+"}"});}B2=[];for(i=0;i<y2.Measures.length;i+=1){B2.push({name:z2[y2.Measures[i].PropertyPath]["http://www.sap.com/Protocols/SAPData"].label,value:"{"+y2.Measures[i].PropertyPath+"}"});}C2=new sap.viz.ui5.data.FlattenedDataset({dimensions:A2,measures:B2,data:{path:"/results"}});h1=R(y2.ChartType.EnumMember,y2.Title,y2.Description,C2);h1.setModel(o);l1.facet.setHeightType(jQuery.device.is.phone?sap.suite.ui.commons.FacetOverviewHeight.Auto:sap.suite.ui.commons.FacetOverviewHeight.XL);}else{h1=new sap.ui.layout.VerticalLayout({width:"100%"}).addStyleClass("sapFactsheetUtiVLayoutPadding");for(i=0;i<a.results.length;i+=1){e2=new sap.ui.layout.HorizontalLayout().addStyleClass("sapFactsheetUtiHLayoutPadding");k=B(b.Title,l1.navigationType,d1,l1.facet);if(k.setWrapping){k.setWrapping(false);}k.addDelegate({onAfterRendering:b2});o=new sap.ui.model.json.JSONModel();o.setData({result:a.results[i]});k.setModel(o);k.bindElement("/result");f2=false;if(a.results[i][b.Title.Value.Path]){f2=true;}if(b.Title.Value.Apply){for(j=0;j<b.Title.Value.Apply.Parameters.length;j+=1){if(b.Title.Value.Apply.Parameters[j].Type==="Path"){if(a.results[i][b.Title.Value.Apply.Parameters[j].Value]){f2=true;break;}}}}w2="";if(f2){e2.addContent(k);if(b.MainInfo&&((b.MainInfo.EdmType&&b.MainInfo.EdmType==="Edm.Decimal")||(b.MainInfo.Value&&b.MainInfo.Value.Apply&&b.MainInfo.Value.Apply.Parameters[0]&&b.MainInfo.Value.Apply.Parameters[0].EdmType&&b.MainInfo.Value.Apply.Parameters[0].EdmType==="Edm.Decimal"))){w2="comma";}else if(b.MainInfo&&b.MainInfo.Value.Path&&a.results[i][b.MainInfo.Value.Path]){w2="dash";}else if(b.MainInfo&&b.MainInfo.Value.Apply){for(j=0;j<b.MainInfo.Value.Apply.Parameters.length;j+=1){if(b.MainInfo.Value.Apply.Parameters[j].Type==="Path"){if(a.results[i][b.MainInfo.Value.Apply.Parameters[j].Value]){w2="dash";break;}}}}if(w2==="dash"){e2.addContent(new sap.ui.core.HTML({content:"<span class=\"sapFactsheetUtiSeparatorPadding sapMText\"> &ndash; </span>"}));}if(w2==="comma"){e2.addContent(new sap.m.Text({text:", "}).addStyleClass("sapFactsheetUtiSeparatorPaddingForDecimal"));}}if(b.MainInfo){d2=B(b.MainInfo,l1.navigationType,d1,l1.facet);if(d2.setWrapping){d2.setWrapping(false);}d2.addDelegate({onAfterRendering:b2});d2.setModel(o);d2.bindElement("/result");e2.addContent(d2);}h1.addContent(e2);}}g2=parseInt(a.__count,10);if(Number(g2)){l1.facet.setQuantity(g2);}l1.facet.setContent(h1);l1.facet.attachPress({facet:l1.facetContent},function(D2,E2){var h1;t.removeAllFacetContent();A[A.indexOf(l1.facet)].Links=[];h1=O(n,l1.entitySet,E2.facet,l1.bindingPath,this);h1.setDescription(V());t.addFacetContent(h1);if(A.indexOf(l1.facet)>=0){A[A.indexOf(l1.facet)].bLoaded=false;A[A.indexOf(l1.facet)].bProcessed=false;A[A.indexOf(l1.facet)].bIsTable=true;}c(A.indexOf(l1.facet));t.navigateToDetail();});}else{l1.facet.setQuantity(0);l1.facet.addStyleClass("sapFactsheetUtiEmptyTile");l1.facet.setHeightType(jQuery.device.is.phone?sap.suite.ui.commons.FacetOverviewHeight.Auto:sap.suite.ui.commons.FacetOverviewHeight.S);}if(A.indexOf(l1.facet)>=0){A[A.indexOf(l1.facet)].bLoaded=true;A[A.indexOf(l1.facet)].bProcessed=false;A[A.indexOf(l1.facet)].bIsTable=false;}c(A.indexOf(l1.facet));}else{o.setData({result:a});for(u2 in a){if(a.hasOwnProperty(u2)){if(u2!=="__metadata"){if(typeof a[u2]==="string"&&a[u2]){if(parseInt(a[u2],10)!==0){v2=true;break;}}else if(typeof a[u2]==="number"&&parseInt(a[u2],10)!==0){v2=true;break;}}}}if(v2){h2=new sap.ui.layout.VerticalLayout();i2=(M.propertyExtensions)?M.propertyExtensions[l1.navigationType]:[];j2=new sap.ui.layout.HorizontalLayout().addStyleClass("sapFactsheetUtiHLayoutLabelValue");k2=C(b.Title,{},i2,true).addStyleClass("sapFactsheetUtiLabelMargin");k=B(b.Title,l1.navigationType,d1,l1.facet);k.setModel(o);k.bindElement("/result");j2.addContent(k2);j2.addContent(k);h2.addContent(j2);if(b.MainInfo){l2=new sap.ui.layout.HorizontalLayout().addStyleClass("sapFactsheetUtiHLayoutLabelValue");m2=C(b.MainInfo,{},i2,true).addStyleClass("sapFactsheetUtiLabelMargin");d2=B(b.MainInfo,l1.navigationType,d1,l1.facet);d2.setModel(o);d2.bindElement("/result");l2.addContent(m2);l2.addContent(d2);h2.addContent(l2);}if(b.SecondaryInfo){n2=new sap.ui.layout.HorizontalLayout().addStyleClass("sapFactsheetUtiHLayoutLabelValue");o2=C(b.SecondaryInfo,{},i2,true).addStyleClass("sapFactsheetUtiLabelMargin");p2=B(b.SecondaryInfo,l1.navigationType,d1,l1.facet);p2.setModel(o);p2.bindElement("/result");n2.addContent(o2);n2.addContent(p2);h2.addContent(n2);}if(b.TypeImageUrl||b.ImageUrl){if(b.ImageUrl){q2=b.ImageUrl;}else{q2=b.TypeImageUrl;}r2=new sap.ui.layout.HorizontalLayout();s2="64px";if(jQuery.device.is.phone){s2="48px";}if(q2.String&&(q2.String.substr(0,11)==="sap-icon://")){t2=new sap.ui.core.Icon({size:s2,width:s2});}else{t2=new sap.m.Image({width:s2});}t2.addStyleClass("sapFactsheetUtiRelIcon");if(q2&&q2.String){t2.setSrc(q2.String);}else{if(q2&&q2.Path){t2.bindProperty("src",q2.Path);}}r2.addContent(t2);r2.addContent(h2);l1.facet.setContent(r2);}else{l1.facet.setContent(h2);}l1.facet.attachPress({facet:l1.facetContent},function(D2,E2){var h1;t.removeAllFacetContent();A[A.indexOf(l1.facet)].Links=[];h1=O(n,l1.entitySet,E2.facet,l1.bindingPath,this);h1.setDescription(V());t.addFacetContent(h1);if(A.indexOf(l1.facet)>=0){A[A.indexOf(l1.facet)].bLoaded=true;A[A.indexOf(l1.facet)].bProcessed=false;A[A.indexOf(l1.facet)].bIsTable=false;}c(A.indexOf(l1.facet));t.navigateToDetail();});}else{l1.facet.addStyleClass("sapFactsheetUtiEmptyTile");l1.facet.setHeightType(jQuery.device.is.phone?sap.suite.ui.commons.FacetOverviewHeight.Auto:sap.suite.ui.commons.FacetOverviewHeight.S);}if(A.indexOf(l1.facet)>=0){A[A.indexOf(l1.facet)].bLoaded=true;A[A.indexOf(l1.facet)].bProcessed=false;A[A.indexOf(l1.facet)].bIsTable=false;}c(A.indexOf(l1.facet));}};};a2=function(l1){return function(a){t.removeFacet(l1.facet);};};$1=function(l1){return function(a){var o,b,i,k,d2;b=M[l1.navigationType]["com.sap.vocabularies.UI.v1.MediaResource"];if(l1.cardinality==="*"){if(a.results&&a.results.length){o=new sap.ui.layout.HorizontalLayout().addStyleClass("sapFactsheetUtiPictureViewerOverview");for(i=0;i<a.results.length;i+=1){o.addContent(new sap.m.Image({src:a.results[i][b.Thumbnail.Url.Path],height:"85px"}));if(i===3){break;}}k=parseInt(a.__count,10);if(Number(k)){l1.facet.setQuantity(k);}l1.facet.setContent(o);l1.facet.attachPress({facet:l1.facetContent,data:a},function(e2,f2){var g2,_1,h2;t.removeAllFacetContent();d2=new sap.suite.ui.commons.UnifiedThingGroup();if(f2.facet.Label&&f2.facet.Label.String){d2.setTitle(f2.facet.Label.String);}d2.setDescription(V());if(jQuery.device.is.phone){_1="350px";}else{_1="550px";}g2=new sap.m.Carousel({height:_1});for(i=0;i<f2.data.results.length;i+=1){h2=new sap.m.Image({src:f2.data.results[i][b.Url.Path]});if(jQuery.device.is.phone){h2.addStyleClass("sapFactsheetUtiCarouselMaxImageHeightPhone");}else{h2.addStyleClass("sapFactsheetUtiCarouselMaxImageHeight");}g2.addPage(h2);}d2.setContent(g2);t.addFacetContent(d2);t.navigateToDetail();});}else{l1.facet.setQuantity(0);l1.facet.addStyleClass("sapFactsheetUtiEmptyTile");l1.facet.setHeightType(jQuery.device.is.phone?sap.suite.ui.commons.FacetOverviewHeight.Auto:sap.suite.ui.commons.FacetOverviewHeight.S);}}};};c2=function(o,d2){var k,i,j,e2=[],f2={},g2,h2,i2,j2,k2,l2,m2,n2;h2=function(d1,a){var i,b="";if(d1){if(d1.Path){return a[d1.Path];}else if(d1.String){return d1.String;}else if(d1.Apply.Name==="odata.concat"){for(i=0;i<d1.Apply.Parameters.length;i+=1){if(d1.Apply.Parameters[i].Type==="Path"){b=b+a[d1.Apply.Parameters[i].Value];}else if(d1.Apply.Parameters[i].Type==="String"){b=b+d1.Apply.Parameters[i].Value;}}return b;}}};f2.iCount=0;f2.aContacts=[];for(i=0;i<o.__batchResponses.length;i+=1){if(!o.__batchResponses[i].data){continue;}e2=o.__batchResponses[i].data.results;if(!e2){e2=[];e2.push(o.__batchResponses[i].data);}if(e2.length>0){g2=M[e2[0].__metadata.type]["com.sap.vocabularies.Communication.v1.Contact"];if(g2){for(j=0;j<e2.length;j+=1){i2=j2=k2="";if(g2.tel){for(k=0;k<g2.tel.length;k+=1){if(g2.tel[k].type&&g2.tel[k].type.EnumMember){l2=h2(g2.tel[k].uri,e2[j]);switch(g2.tel[k].type.EnumMember){case"com.sap.vocabularies.Communication.v1.PhoneType/voice":i2=l2?l2.replace("tel:",""):"";i2=i2?i2.replace(";ext=",""):"";break;case"com.sap.vocabularies.Communication.v1.PhoneType/cell":j2=l2?l2.replace("tel:",""):"";j2=j2?j2.replace(";ext=",""):"";break;case"com.sap.vocabularies.Communication.v1.PhoneType/fax":k2=l2?l2.replace("tel:",""):"";k2=k2?k2.replace(";ext=",""):"";break;}}}}n2=g2.email&&g2.email.address?g2.email.address:"";m2=h2(g2.photo,e2[j]);f2.iCount+=1;f2.aContacts.push({fn:h2(g2.fn,e2[j]),title:h2(g2.title,e2[j]),org:h2(g2.org,e2[j]),phone:i2,mobile:j2,fax:k2,photo:m2,email:h2(n2,e2[j]),sEntity:e2[0].__metadata.type,bExistsPhoto:m2?true:false,bUseIcon:m2?false:true,sOrder:f2.iCount});}}}}if(d2){f2.aContacts.sort(function(a,b){return a[d2]>b[d2]?1:-1;});}return f2;};G1=function(l1){return function(o){var i,a,b,k,d2,e2,f2,g2;a=c2(o,"sOrder");b=new sap.ui.layout.Grid({defaultSpan:"L6 M6 S12",hSpacing:0,vSpacing:0}).addStyleClass("sapFactsheetUtiContactsGrid");for(i=0;i<a.aContacts.length&&i<4;i+=1){e2=new sap.ui.layout.VerticalLayout();if(a.aContacts[i].photo){f2=new sap.m.Image({height:"55px",src:a.aContacts[i].photo});}else{f2=new sap.ui.core.Icon({size:"50px",src:sap.ui.core.IconPool.getIconURI("person-placeholder")}).addStyleClass("sapFactsheetUtiRelIcon");}e2.addContent(f2);e2.addStyleClass("sapFactsheetUtiContactsImage");d2=new sap.ui.layout.VerticalLayout({content:[new sap.m.Text({text:a.aContacts[i].fn}).addStyleClass("sapFactsheetUtiTextName"),new sap.m.Text({text:a.aContacts[i].title}).addStyleClass("sapFactsheetUtiTextValue")]});k=new sap.ui.layout.HorizontalLayout({content:[e2,d2]}).addStyleClass("sapFactsheetUtiContactsBox");b.addContent(k);}P1=sap.ui.getCore().byId(t.data("contactFacetId"));P1.setQuantity(a.iCount);if(i>0){P1.setContent(b);if(i<=2){g2=sap.suite.ui.commons.FacetOverviewHeight.M;}else{g2=sap.suite.ui.commons.FacetOverviewHeight.L;}P1.attachPress(function(){var i,E1=[],F1;n.clearBatch();for(i=0;i<M[e1]["com.sap.vocabularies.UI.v1.Contacts"].length;i+=1){i1=M[e1]["com.sap.vocabularies.UI.v1.Contacts"][i].AnnotationPath;i1=i1.substring(0,i1.lastIndexOf("@")-1);if(i1!==""){F1=c1+"/"+i1;}else{F1=c1;}E1.push(n.createBatchOperation(F1,"GET"));}n.addBatchReadOperations(E1);n.submitBatch(function(o){var a,h2,i2,j2,k2,l2,m2;m2=jQuery.sap.resources({url:jQuery.sap.getModulePath("sap.ushell.components.container.")+"/resources/resources.properties",language:sap.ui.getCore().getConfiguration().getLanguage()});a=c2(o,"sEntity");h2=new sap.ui.model.json.JSONModel();h2.setData(a);i2=new sap.m.ColumnListItem({type:sap.m.Inactive,unread:false,cells:[new sap.ui.layout.VerticalLayout({content:[new sap.m.Image({src:"{photo}",width:"74px",visible:"{bExistsPhoto}"}),new sap.ui.core.Icon({size:"76px",src:sap.ui.core.IconPool.getIconURI("person-placeholder"),visible:"{bUseIcon}"}).addStyleClass("sapFactsheetUtiRelIcon")]}),new sap.ui.layout.VerticalLayout({content:[new sap.m.Text({text:"{fn}"}).addStyleClass("sapFactsheetUtiContactsName"),new sap.m.Label({text:"{title}"}),new sap.m.Label({text:"{org}"})]}),new sap.m.Link({text:"{phone}",href:"tel:{phone}"}),new sap.m.Link({text:"{mobile}",href:"tel:{mobile}"}),new sap.m.Link({text:"{fax}",href:"tel:{fax}"}),new sap.m.Link({text:"{email}",href:"mailto:{email}"})]});j2=new sap.m.Table({threshold:2,inset:false,showUnread:true,scrollToLoad:true,columns:[new sap.m.Column({hAlign:sap.ui.core.TextAlign.Center,width:"12%",header:new sap.m.Text({text:""})}),new sap.m.Column({hAlign:sap.ui.core.TextAlign.Begin,header:new sap.m.Text({text:m2.getText("USHELL_FACTSHEET_NAME")})}),new sap.m.Column({hAlign:sap.ui.core.TextAlign.Begin,width:"12%",header:new sap.m.Text({text:m2.getText("USHELL_FACTSHEET_PHONE")}),minScreenWidth:"Tablet",demandPopin:true}),new sap.m.Column({hAlign:sap.ui.core.TextAlign.Begin,width:"12%",header:new sap.m.Text({text:sap.ushell.resources.i18n.getText("mobile")}),minScreenWidth:"Tablet",demandPopin:true}),new sap.m.Column({hAlign:sap.ui.core.TextAlign.Begin,width:"12%",header:new sap.m.Text({text:sap.ushell.resources.i18n.getText("fax")}),minScreenWidth:"Tablet",demandPopin:true}),new sap.m.Column({hAlign:sap.ui.core.TextAlign.Begin,width:"26%",header:new sap.m.Text({text:m2.getText("USHELL_FACTSHEET_EMAIL")}),minScreenWidth:"Tablet",demandPopin:true})],items:{path:"/aContacts",template:i2}});k2=new sap.m.ViewSettingsDialog({sortItems:[new sap.m.ViewSettingsItem({key:"fn",text:m2.getText("USHELL_FACTSHEET_NAME")}),new sap.m.ViewSettingsItem({key:"phone",text:m2.getText("USHELL_FACTSHEET_PHONE")}),new sap.m.ViewSettingsItem({key:"mobile",text:sap.ushell.resources.i18n.getText("mobile")}),new sap.m.ViewSettingsItem({key:"fax",text:sap.ushell.resources.i18n.getText("fax")}),new sap.m.ViewSettingsItem({key:"email",text:m2.getText("USHELL_FACTSHEET_EMAIL")})],confirm:function(n2){var o2,p2,q2=[];o2=n2.getParameters();p2=j2.getBinding("items");if(o2.sortItem){q2.push(new sap.ui.model.Sorter(o2.sortItem.getKey(),o2.sortDescending));p2.sort(q2);}}});j2.setHeaderToolbar(new sap.m.Toolbar({content:[new sap.m.Label(),new sap.m.ToolbarSpacer(),new sap.m.Button({icon:"sap-icon://drop-down-list",press:function(n2){k2.open();}})]}));j2.setModel(h2);l2=new sap.suite.ui.commons.UnifiedThingGroup({title:P1.getTitle(),description:V(),content:j2});t.removeAllFacetContent();t.addFacetContent(l2);t.navigateToDetail();});});}else{g2=sap.suite.ui.commons.FacetOverviewHeight.S;P1.addStyleClass("sapFactsheetUtiEmptyTile");P1.setQuantity(0);}P1.setHeightType(jQuery.device.is.phone?sap.suite.ui.commons.FacetOverviewHeight.Auto:g2);};};for(i=0;i<g1.length;i+=1){if(g1[i]["com.sap.vocabularies.UI.v1.Map"]){i1=g1[i].Target.AnnotationPath;i1=i1.substring(0,i1.lastIndexOf("@")-1);S1="1";R1=e1;if(i1){R1=X(i1,e1,d1);S1=v(p,i1,d1);}_1="100%";if(jQuery.device.is.phone){_1="150px";}Q1=new sap.ui.vbm.VBI({width:"100%",height:_1,plugin:false,config:null});P1=new sap.suite.ui.commons.FacetOverview({title:g1[i].Label.String.trim(),heightType:jQuery.device.is.phone?sap.suite.ui.commons.FacetOverviewHeight.Auto:sap.suite.ui.commons.FacetOverviewHeight.L,content:Q1});A.push(P1);A[A.length-1].bLoaded=false;A[A.length-1].bProcessed=false;A[A.length-1].bIsTable=false;l1={cardinality:S1,navigationPath:i1,facet:P1,facetContent:g1[i],navigationType:R1,metadata:d1,bindingPath:c1,entitySet:p};if(S1==="*"){T1=["$inlinecount=allpages","$top=1000"];}else{T1=[];}n.read(c1+"/"+i1,"",T1,true,k1(l1));t.addFacet(P1);}else{if(g1[i].Target){i1=g1[i].Target.AnnotationPath;i1=i1.substring(0,i1.lastIndexOf("@")-1);Z1=g1[i].Target.AnnotationPath.substring(g1[i].Target.AnnotationPath.lastIndexOf("@")+1);if(i1){R1=X(i1,e1,d1);P1=new sap.suite.ui.commons.FacetOverview({title:g1[i].Label.String.trim(),heightType:jQuery.device.is.phone?sap.suite.ui.commons.FacetOverviewHeight.Auto:sap.suite.ui.commons.FacetOverviewHeight.M});S1=v(p,i1,d1);if(S1!==0){l1={cardinality:S1,navigationPath:i1,facet:P1,facetContent:g1[i],navigationType:R1,metadata:d1,bindingPath:c1,entitySet:p};if(g1[i]["com.sap.vocabularies.UI.v1.Gallery"]){if(S1==="*"){T1=["$inlinecount=allpages"];}else{T1=[];}n.read(c1+"/"+i1,"",T1,true,$1(l1));}else{A.push(P1);A[A.length-1].bLoaded=false;A[A.length-1].bProcessed=false;A[A.length-1].bIsTable=false;if(S1==="*"){T1=["$inlinecount=allpages","$top=3"];}else{T1=[];}n.read(c1+"/"+i1,"",T1,true,j1(l1),a2(l1));}t.addFacet(P1);}}else{if(Z1==="com.sap.vocabularies.UI.v1.Contacts"){P1=new sap.suite.ui.commons.FacetOverview({title:g1[i].Label.String.trim(),heightType:jQuery.device.is.phone?sap.suite.ui.commons.FacetOverviewHeight.Auto:sap.suite.ui.commons.FacetOverviewHeight.M});t.data("contactFacetId",P1.sId);l1={facet:P1};n.clearBatch();for(j=0;j<M[e1][Z1].length;j+=1){i1=M[e1][Z1][j].AnnotationPath;i1=i1.substring(0,i1.lastIndexOf("@")-1);if(i1!==""){S1=v(p,i1,d1);if(S1==="*"){F1=c1+"/"+i1+"?$top=4"+"&$inlinecount=allpages";}else{F1=c1+"/"+i1;}}else{F1=c1;}E1.push(n.createBatchOperation(F1,"GET"));}n.addBatchReadOperations(E1);n.submitBatch(G1(l1));t.addFacet(P1);}}}}}N1=new sap.ushell.ui.footerbar.AddBookmarkButton();V1=function(){var b,i,Z1,a,k,d2={},X1,e2,f2,g2,o,h2,i2,j2,k2;N1.setAppData({title:t.getTitle(),subtitle:t.getName()+" - "+t.getDescription()});N1.setEnabled(true);i2=sap.ushell.Container.getService("URLParsing");j2=i2.getShellHash(window.location.href);k2=i2.parseShellHash(j2);f2=k2.semanticObject;p1=new sap.suite.ui.commons.LinkActionSheet({showCancelButton:true,placement:sap.m.PlacementType.Top});m1=D(e,n);b=m1.split(",");for(i=0;i<b.length;i+=1){b[i]=b[i].replace("='","=","g");if(b[i].lastIndexOf("'")===b[i].length-1){b[i]=b[i].slice(0,-1);}}for(Z1 in M[e1]){if(M[e1].hasOwnProperty(Z1)){if(Z1.indexOf("com.sap.vocabularies.Common.v1.SecondaryKey")===0){a=M[e1][Z1];for(i=0;i<a.length;i+=1){k=this.getBoundContext().getProperty(a[i].PropertyPath);if(k){b.push(a[i].PropertyPath+"="+k);}}}}}for(i=0;i<b.length;i+=1){X1=b[i].substr(0,b[i].indexOf("="));e2=b[i].substr(b[i].indexOf("=")+1,b[i].length);d2[decodeURIComponent(X1)]=decodeURIComponent(e2);}o1=sap.ushell.Container.getService("CrossApplicationNavigation").getSemanticObjectLinks(f2,d2);o1.done(jQuery.proxy(function(l2){var i,m2,n2;for(i=0;i<l2.length;i+=1){n2=l2[i].intent;if(n2.indexOf(Y)<0&&n2.indexOf("-analyzeKPIDetails~")<0&&n2.indexOf("-analyzeSBKPIDetails~")<0&&n2.indexOf("-NavigateToMaintainCusProj~")<0&&n2.indexOf("CostCenter-manageCostCenter~")<0&&n2.indexOf("AccountingDocument-analyzeDocumentJournal~")<0&&n2.indexOf("AccountingDocument-analyzeGLLineItem~")<0&&n2.indexOf("ControllingDocument-analyzeCostCenters~")<0&&n2.indexOf("ControllingDocument-analyzeInternalOrders~")<0&&n2.indexOf("ControllingDocument-analyzeMarketSegment~")<0&&n2.indexOf("ControllingDocument-analyzeProfitCentersActuals~")<0&&n2.indexOf("ControllingDocument-analyzeProfitLoss~")<0&&n2.indexOf("ControllingDocument-analyzeProjectsActuals~")<0&&n2.indexOf("PurchaseOrder-create~")<0){m2=sap.ushell.Container.getService("CrossApplicationNavigation").hrefForExternal({target:{shellHash:n2}});p1.addItem(new sap.m.Link({text:l2[i].text,href:m2}));t.setTransactionsVisible(true);}}}));t.attachTransactionsButtonPress(function(l2){p1.openBy(l2.getParameter("caller"));});this.detachChange(V1);sap.ushell.services.AppConfiguration.setWindowTitle(t.getTitle().trim()+": "+t.getName().trim()+" ("+t.getDescription().trim()+")");t.setActionsVisible(true);U1=new sap.m.Button({text:t1.getText("UNIFIEDTHINGINSPECTOR_FOOTER_BUTTON_EMAIL_LINK"),icon:"sap-icon://email",press:function(oE){sap.m.URLHelper.triggerEmail("",t.getName(),window.location.href);}});q1=new sap.m.ActionSheet({placement:sap.m.PlacementType.Top});g2=e.substr(0,e.lastIndexOf("/")+1);for(o in n.oData){if(n.oData.hasOwnProperty(o)){g2=g2+o;h2=o.substring(o.indexOf("(")+1,o.indexOf(")"));break;}}q1.addButton(new sap.ushell.ui.footerbar.JamDiscussButton({jamData:{businessObject:{appContext:"CB",odataServicePath:e.substr(0,e.lastIndexOf("/")+1),collection:p,key:h2,name:t.getTitle(),ui_url:window.location.href}}}));q1.addButton(new sap.ushell.ui.footerbar.JamShareButton({jamData:{object:{id:window.location.href,display:new sap.m.Text({text:t.getTitle()}),share:""},externalObject:{appContext:"CB",odataServicePath:e.substr(0,e.lastIndexOf("/")+1),collection:p,key:h2,name:t.getTitle()}}}));q1.addButton(N1);q1.addButton(U1);t.attachActionsButtonPress(function(l2){q1.openBy(l2.getParameter("caller"));});A[0].bLoaded=true;A[0].bProcessed=false;c(0);};t.getElementBinding().attachChange(V1);t.attachBackAction(function(o){history.back();});t.addDelegate({onAfterRendering:function(){t._adjustFacetLayout();}});return t;};return{ThingInspector:function(a,b){try{t=I(a,b,new sap.suite.ui.commons.UnifiedThingInspector({configurationVisible:false}));}catch(e){throw e;}return t;}};}());}());};if(!jQuery.sap.isDeclared('sap.ushell.components.factsheet.tools.ODataUrlTemplating')){(function(){"use strict";function P(p,t,u){this.parameter=p;this.template=t;this.semiConvertedUrl=u;this.message=" is a missing key parameter for constructing the entity url";this.toString=function(){return this.parameter+this.message;};}jQuery.sap.declare("sap.ushell.components.factsheet.tools.ODataUrlTemplating");sap.ushell.components.factsheet.tools.ODataUrlTemplating={ParameterException:P,resolve:function(t,d){var e,v,p,i,b=t.match(/{\s*[\w\.]+\s*}/g);e=t;for(i=b.length-1;i>=0;i-=1){p=b[i];v=d[p.replace(/[{}]/g,"")];if(v!==undefined){if(typeof v!=="string"){v=v[0];}v=encodeURIComponent(decodeURIComponent(v));e=e.replace(p,v);}}p=e.match(/{\s*[\w\.]+\s*}/g);if(p){jQuery.sap.log.error(" "+e);throw new this.ParameterException(p,t,e);}return e;}};})();};if(!jQuery.sap.isDeclared('sap.ushell.components.factsheet.views.ThingViewer.view')){jQuery.sap.declare('sap.ushell.components.factsheet.views.ThingViewer.view');(function(){"use strict";sap.ui.jsview("sap.ushell.components.factsheet.views.ThingViewer",{getControllerName:function(){return"sap.ushell.components.factsheet.views.ThingViewer";},createContent:function(c){var e,a,E,t,v,s;v=this.getViewData();jQuery.sap.require("sap.ushell.components.factsheet.factory.ThingInspector");e=v.entity||v.service;if(!e){E=v.entityTemplateURI||v.template;if(E){if(typeof E!=="string"){E=E[0];}E=E.replace(/%25/g,"%");E=E.replace(/%28/g,"(");E=E.replace(/%29/g,")");E=E.replace(/%27/g,"'");E=E.replace(/%3D/g,"=");E=E.replace(/%7B/g,"{");E=E.replace(/%7D/g,"}");e=sap.ushell.components.factsheet.tools.ODataUrlTemplating.resolve(E,v);}}a=v.annotationURI||v.annotation;if(typeof e!=="string"){e=e[0];}if(typeof a!=="string"){a=a[0];}s=e.substr(0,e.lastIndexOf("/"));jQuery.sap.require("sap.ui.model.odata.ODataUtils");function b(C,s){var S;if(sap.ui.model.odata&&sap.ui.model.odata.ODataUtils&&typeof sap.ui.model.odata.ODataUtils.setOrigin==="function"){if(!(C&&C.getComponentData())){throw new Error("no component passed");}if(C&&C.getComponentData()&&C.getComponentData().startupParameters&&C.getComponentData().startupParameters["sap-system"]){S=C.getComponentData().startupParameters["sap-system"][0];s=sap.ui.model.odata.ODataUtils.setOrigin(s,{alias:S});}}return s;}s=b(sap.ui.core.Component.getOwnerComponentFor(this),s);s=s+e.substr(e.lastIndexOf("/"));t=sap.ushell.components.factsheet.factory.ThingInspector(s,a);t.addStyleClass("ThingInspector");return t;}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.flp.ActionMode')){(function(){"use strict";jQuery.sap.declare("sap.ushell.components.flp.ActionMode");var A=function(){this.oEventBus=sap.ui.getCore().getEventBus();this.oEventBus.subscribe('launchpad','actionModeInactive',this.scrollToViewPoint,this);this.oEventBus.subscribe('launchpad','actionModeActive',this.scrollToViewPoint,this);this.viewPoint=undefined;this.init=function(m){this.oModel=m;};};A.prototype.activate=function(){var t;jQuery.sap.require("sap.m.MessageToast");this.oModel.setProperty('/tileActionModeActive',true);this.aOrigHiddenGroupsIds=sap.ushell.utils.getCurrentHiddenGroupIds(this.oModel);t=sap.ui.getCore().byId("ActionModeBtn");if(t){t.setTooltip(sap.ushell.resources.i18n.getText("exitEditMode"));t.setText(sap.ushell.resources.i18n.getText("exitEditMode"));}this.oEventBus.publish('launchpad','actionModeActive');};A.prototype.scrollToViewPoint=function(){var d=this.viewPoint;d.restoreLastFocusedTile=true;if(!this.oModel.getProperty('/tileActionModeActive')){var j=jQuery(".sapUshellTileContainerHeader[tabindex=0]");if(j&&j.length>0){var a=j[0].closest('.sapUshellTileContainer');if(a){d.restoreLastFocusedTileContainerById=a.id;}}}d.iDuration=0;window.setTimeout(jQuery.proxy(this.oEventBus.publish,this.oEventBus,"launchpad","scrollToGroup",d),0);};A.prototype.deactivate=function(){var t=sap.ui.getCore().byId("TileActions"),T;this.oModel.setProperty('/tileActionModeActive',false);this.oEventBus.publish("launchpad",'actionModeInactive',this.aOrigHiddenGroupsIds);if(t!==undefined){t.destroy();}jQuery.sap.require("sap.m.MessageToast");sap.m.MessageToast.show(sap.ushell.resources.i18n.getText("savedChanges"),{duration:4000});T=sap.ui.getCore().byId("ActionModeBtn");if(T){T.setTooltip(sap.ushell.resources.i18n.getText("activateEditMode"));T.setText(sap.ushell.resources.i18n.getText("activateEditMode"));}};A.prototype.toggleActionMode=function(m,s,d){var t=m.getProperty('/tileActionModeActive');var c=m.getProperty('/topGroupInViewPortIndex');if(!d){d=[];}var v=d.filter(function(b){return b.getVisible();});var a=v[c];if(a){var e=t?-49:49;var g=document.getElementById("sapUshellDashboardPage-cont").scrollTop-a.getDomRef().offsetTop;this.viewPoint={group:v[c],fromTop:g+e};}else{this.viewPoint={fromTop:0};}if(t){this.deactivate();}else{this.activate();}};A.prototype.activateGroupEditMode=function(g){var j=jQuery(g.getDomRef()).find('.sapUshellTileContainerContent');j.addClass("sapUshellTileContainerEditMode");};A.prototype._openActionsMenu=function(e,t){var a=this,T=t||e.getSource(),l=sap.ushell.Container.getService("LaunchPage"),b=[],o=sap.ui.getCore().byId("TileActions"),i,n,B,c,d,h,f,g;if(T){d=T.getBindingContext().getObject().object;b=l.getTileActions(d);}a.oTileControl=T;jQuery(".sapUshellTileActionLayerDivSelected").removeClass("sapUshellTileActionLayerDivSelected");f=jQuery(e.getSource().getDomRef()).find(".sapUshellTileActionLayerDiv");f.addClass("sapUshellTileActionLayerDivSelected");if(o===undefined){o=new sap.m.ActionSheet("TileActions",{placement:sap.m.PlacementType.Auto,afterClose:function(){$(".sapUshellTileActionLayerDivSelected").removeClass("sapUshellTileActionLayerDivSelected");var E=sap.ui.getCore().getEventBus();E.publish("dashboard","actionSheetClose",a.oTileControl);}});}else{o.destroyButtons();}if(b.length===0||T.oParent.getProperty("isGroupLocked")){n=new sap.m.Button({text:sap.ushell.resources.i18n.getText("tileHasNoActions"),enabled:false});o.addButton(n);}else{for(i=0;i<b.length;i++){c=b[i];h=function(c){return function(){a._handleActionPress(c);};}(c);B=new sap.m.Button({text:c.text,icon:c.icon,press:h});o.addButton(B);}}g=e.getSource().getActionSheetIcon();if(g){o.openBy(g);}else{o.openBy(e.getSource());}};A.prototype._handleActionPress=function(a){if(a.press){a.press.call();}else if(a.targetURL){if(a.targetURL.indexOf("#")===0){hasher.setHash(a.targetURL);}else{window.open(a.targetURL,'_blank');}}else{sap.m.MessageToast.show("No Action");}};sap.ushell.components.flp.ActionMode=new A();}());};if(!jQuery.sap.isDeclared('sap.ushell.components.flp.CustomRouter')){(function(){"use strict";jQuery.sap.declare("sap.ushell.components.flp.CustomRouter");sap.ui.core.routing.Router.extend("sap.ushell.components.flp.CustomRouter",{constructor:function(){sap.ui.core.routing.Router.apply(this,arguments);this.attachRouteMatched(this._onHandleRouteMatched,this);},navTo:function(){if(!this._bIsInitialized){this.initialize();}sap.ui.core.routing.Router.prototype.navTo.apply(this,arguments);},destroy:function(){sap.ui.core.routing.Router.prototype.destroy.apply(this,arguments);},_onHandleRouteMatched:function(e){var p=e.getParameters(),t=sap.ui.getCore().byId(p.config.controlId);var r=this.getTarget(p.config.target).display();t.to(r.oTargetParent);setTimeout(function(){sap.ui.getCore().getEventBus().publish("launchpad","launchpadCustomRouterRouteMatched");},0);}});})();};if(!jQuery.sap.isDeclared('sap.ushell.components.flp.FLPAnalytics')){(function(){"use strict";jQuery.sap.declare("sap.ushell.components.flp.FLPAnalytics");var o=["appOpened","deleteTile","createGroup","actionModeActive","catalogTileClick","dashboardTileClick","dashboardTileLinkClick"],E=sap.ui.getCore().getEventBus(),t=this,l={};function s(c){var m=sap.ushell.services.AppConfiguration.getMetadata();l[c]={};l[c].startTime=new Date();l[c].title=m.title;}function a(c){var d=0;try{d=(new Date()-l[c].startTime)/1000;sap.ushell.Container.getService("UsageAnalytics").logCustomEvent("FLP: Time in Application (sec)",d,[l[c].title]);}catch(e){jQuery.sap.log.warning("Duration in application "+c+" could not be calculated",null,"sap.ushell.components.flp.FLPAnalytics");}}function h(c,d,D){var A=hasher.getHash(),f;window.swa.custom1={ref:A};switch(d){case'appOpened':s(A);sap.ushell.Container.getService("UsageAnalytics").logCustomEvent("FLP: Application Opened","Direct Launch",[l[A].title]);E.unsubscribe("launchpad","appOpened",h);break;case'bookmarkTileAdded':f=window.document.title;sap.ushell.Container.getService("UsageAnalytics").logCustomEvent("FLP: Personalization","Save as Tile",[f,D&&D.group&&D.group.title?D.group.title:"",D&&D.group&&D.group.id?D.group.id:"",D&&D.tile&&D.tile.title?D.tile.title:f]);break;case'actionModeActive':sap.ushell.Container.getService("UsageAnalytics").logCustomEvent("FLP: Personalization","Enter Action Mode",[D.source]);break;case'catalogTileClick':sap.ushell.Container.getService("UsageAnalytics").logCustomEvent("FLP: Application Launch point","Catalog",[]);break;case'dashboardTileClick':sap.ushell.Container.getService("UsageAnalytics").logCustomEvent("FLP: Application Launch point","Homepage",[]);break;case'dashboardTileLinkClick':window.swa.custom1={ref:D.targetHash.substr(1)};sap.ushell.Container.getService("UsageAnalytics").logCustomEvent("FLP: Application Launch point","Tile Group Link",[]);break;default:break;}}function b(c){var f,T,d;if(c.getParameter("from")&&c.getParameter("to")){f=c.getParameter("from").getId().replace("application-","").replace("applicationShellPage-","");window.swa.custom1={ref:f};a(f);d=c.getParameter("to");T=d.getId().replace("application-","").replace("applicationShellPage-","");s(T);window.swa.custom1={ref:T};sap.ushell.Container.getService("UsageAnalytics").logCustomEvent("FLP: Application Opened","Fiori Navigation",[l[T].title]);}}jQuery(window).unload(function(c){var d=window.location.hash.substr(1);a(d);});try{sap.ui.getCore().byId('viewPortContainer').attachAfterNavigate(b,t);}catch(e){jQuery.sap.log.warning("Failure when subscribing to viewPortContainer 'AfterNavigate' event",null,"sap.ushell.components.flp.FLPAnalytics");}E.subscribe("sap.ushell.services.Bookmark","bookmarkTileAdded",h,t);o.forEach(function(c,i,d){E.subscribe("launchpad",c,h,t);});})();};if(!jQuery.sap.isDeclared('sap.ushell.components.flp.launchpad.PagingManager')){(function(){"use strict";jQuery.sap.declare("sap.ushell.components.flp.launchpad.PagingManager");sap.ui.base.EventProvider.extend("sap.ushell.components.flp.launchpad.PagingManager",{metadata:{publicMethods:["setElementClass","setContainerSize","getNumberOfAllocatedElements","moveToNextPage","getTileHeight"]},constructor:function(i,s){sap.ushell.components.flp.launchpad.getPagingManager=jQuery.sap.getter(this.getInterface());this.currentPageIndex=0;this.containerHeight=s.containerHeight||0;this.containerWidth=s.containerWidth||0;this.supportedElements=s.supportedElements||"";this.tileHeight=0;},getTileHeight:function(){return this.tileHeight;},setElementClass:function(c){this.supportedElements=c;},setContainerSize:function(n,a){var t=this.getNumberOfAllocatedElements();this.containerHeight=n;this.containerWidth=a;this._changePageSize(t);},getNumberOfAllocatedElements:function(){return this._calcElementsPerPage()*this.currentPageIndex;},_changePageSize:function(t){this.currentPageIndex=Math.ceil(t/this._calcElementsPerPage());},moveToNextPage:function(){this.currentPageIndex++;},getSizeofSupportedElementInUnits:function(t){return this.supportedElements[t].sizeInBaseUnits;},_calcElementMatrix:function(c){var e=jQuery("<div>").addClass(c);jQuery('body').append(e);var a=e.height();var b=e.width();if(a<20||b<40){b=40;a=20;}e.remove();return{width:b,height:a};},_calcElementsPerPage:function(){var s,b,a,m,a,c,e,d;for(s in this.supportedElements){a=this.supportedElements[s];m=this._calcElementMatrix(a.className);a.matrix=m;if(b){b.width=b.width>m.width?m.width:b.width;b.height=b.height>m.height?m.height:b.height;}else{b={width:m.width,height:m.height};}}for(s in this.supportedElements){a=this.supportedElements[s];c=a.matrix;a.sizeInBaseUnits=Math.round(c.width/b.width*c.height/b.height);}e=Math.round(this.containerWidth/b.width);d=Math.round(this.containerHeight/b.height);if(!d||!e||e===Infinity||d===Infinity||e===0||d===0){return 10;}return d*e;}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.flp.launchpad.dashboard.DashboardGroupsBox')){(function(){"use strict";jQuery.sap.declare("sap.ushell.components.flp.launchpad.dashboard.DashboardGroupsBox");sap.ui.base.Object.extend("sap.ushell.components.flp.launchpad.dashboard.DashboardGroupsBox",{metadata:{publicMethods:["createGroupsBox"]},constructor:function(i,s){if(sap.ushell.components.flp.launchpad.dashboard.getDashboardGroupsBox&&sap.ushell.components.flp.launchpad.dashboard.getDashboardGroupsBox()){return sap.ushell.components.flp.launchpad.dashboard.getDashboardGroupsBox();}sap.ushell.components.flp.launchpad.dashboard.getDashboardGroupsBox=jQuery.sap.getter(this.getInterface());this.oController=undefined;this.oGroupsContainer=undefined;this.bTileContainersContentAdded=false;sap.ui.getCore().getEventBus().subscribe("launchpad","actionModeActive",this._addTileContainersContent,this);},destroy:function(){sap.ui.getCore().getEventBus().unsubscribe("launchpad","actionModeActive",this._addTileContainersContent,this);sap.ushell.components.flp.launchpad.dashboard.getDashboardGroupsBox=undefined;},createGroupsBox:function(c,m){this.oController=c;var t=this,a,g,T=this._getTileContainerTemplate(c,m),E=function(){return t.oModel.getProperty('/enableLockedGroupsCompactLayout')&&!t.oModel.getProperty('/tileActionModeActive');},b=function(G){var d,p;if(G&&(d=G.getDomRef())){p=d.querySelector('.sapUshellPlusTile');if(p){return p;}}return null;},r=function(l){var p=b(l.currentGroup),d=b(l.endGroup),i=(l.tiles[l.tiles.length-2]===l.item)||(l.endGroup.getTiles().length===0);if(i){t._hidePlusTile(d);}else{t._showPlusTile(d);}if(l.currentGroup!==l.endGroup){t._showPlusTile(p);}};a=function(){sap.ushell.Layout.getLayoutEngine().setExcludedControl(sap.ushell.ui.launchpad.PlusTile);sap.ushell.Layout.getLayoutEngine().setReorderTilesCallback.call(sap.ushell.Layout.layoutEngine,r);};g=function(){if(!sap.ushell.Layout.isInited){sap.ushell.Layout.init({getGroups:this.getGroups.bind(this),isLockedGroupsCompactLayoutEnabled:E,animationsEnabled:(t.oModel.getProperty('/animationMode')==='full')}).done(a);sap.ui.Device.media.attachHandler(function(){if(!this.bIsDestroyed){sap.ushell.Layout.reRenderGroupsLayout(null);}},this,sap.ui.Device.media.RANGESETS.SAP_STANDARD);var d=this.getDomRef();c.getView().sDashboardGroupsWrapperId=!jQuery.isEmptyObject(d)&&d.parentNode?d.parentNode.id:'';}sap.ushell.Layout.reRenderGroupsLayout(null);if(this.getGroups().length){if(c.bModelInitialized){c._initializeUIActions();}sap.ui.getCore().getEventBus().publish("launchpad","contentRendered");sap.ui.getCore().getEventBus().publish("launchpad","contentRefresh");c._addBottomSpace();if(this.getModel().getProperty("/tilesOpacity")){sap.ushell.utils.handleTilesOpacity(this.getModel());}}var f=new sap.ui.model.Filter("isGroupSelected",sap.ui.model.FilterOperator.EQ,true);var G=t.oModel.getProperty('/homePageGroupDisplay'),h=t.oModel.getProperty("/tileActionModeActive");if(G&&G==="tabs"&&!h){this.getBinding("groups").filter([f]);}else{this.getBinding("groups").filter([]);}try{sap.ushell.utils.handleTilesVisibility();}catch(e){}};jQuery.sap.require("sap.ushell.ui.launchpad.DashboardGroupsContainer");this.oGroupsContainer=new sap.ushell.ui.launchpad.DashboardGroupsContainer("dashboardGroups",{accessibilityLabel:sap.ushell.resources.i18n.getText("DashboardGroups_label"),groups:{path:"/groups",template:T},displayMode:"{/homePageGroupDisplay}",afterRendering:g});this.oGroupsContainer.addEventDelegate({onsapskipback:function(e){e.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);var j=jQuery(".sapUshellAnchorItem:visible:first");if(!j.length){sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(e);}else{sap.ushell.components.flp.ComponentKeysHandler.goToSelectedAnchorNavigationItem();}},onsapskipforward:function(e){e.preventDefault();var f=jQuery("#sapUshellDashboardFooterDoneBtn:visible");if(f.length){f.focus();}else{sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(e);}},onsaptabnext:function(e){if(t.oModel.getProperty("/tileActionModeActive")){var j=jQuery(document.activeElement).closest(".sapUshellTileContainerHeader");if(!j||j.length===0){e.preventDefault();var f=jQuery("#sapUshellDashboardFooterDoneBtn:visible");if(f.length){f.focus();}}else{var d=jQuery(document.activeElement).closest(".sapUshellTileContainer");var i=jQuery(document.activeElement).hasClass("sapUshellContainerTitle");var h=d.find('.sapUshellHeaderActionButton');var k=h&&h.length>0;var l=false;if(k){l=document.activeElement.id===h.last()[0].id;}if((i&&!k)||(l)){e.preventDefault();var H=d.find(".sapUshellTile:visible, sapUshellLink:visible").length>0;if(H){sap.ushell.components.flp.ComponentKeysHandler.goToLastVisitedTile(d,true);}else{var f=jQuery("#sapUshellDashboardFooterDoneBtn:visible");if(f.length){f.focus();}else{sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(e);}}}}}else{e.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(e);}},onsaptabprevious:function(e){sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);var j=jQuery(":focus");if(!t.oModel.getProperty("/tileActionModeActive")||j.hasClass("sapUshellTileContainerHeader")){e.preventDefault();var d=jQuery(".sapUshellAnchorItem:visible:first"),f=jQuery(".sapUshellAnchorItemOverFlow");if(!f&&!d.length){sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(e);}if(f.hasClass("sapUshellShellHidden")){sap.ushell.components.flp.ComponentKeysHandler.goToSelectedAnchorNavigationItem();}else{f.find("button").focus();}}else if(t.oModel.getProperty("/tileActionModeActive")){var h=jQuery(document.activeElement);if(h.hasClass('sapUshellTile')){e.preventDefault();var i=h.closest(".sapUshellTileContainer");var k=i.find('.sapUshellHeaderActionButton:visible').last();if(k.length>0){k.focus();}else{i.find('.sapUshellContainerTitle').focus();}}}}});this.oModel=m;return this.oGroupsContainer;},_getTileContainerTemplate:function(c,m){var t=this,T=new sap.ushell.ui.launchpad.TileContainer({headerText:"{title}",tooltip:"{title}",tileActionModeActive:'{/tileActionModeActive}',ieHtml5DnD:c.getView().ieHtml5DnD,enableHelp:'{/enableHelp}',groupId:"{groupId}",defaultGroup:"{isDefaultGroup}",isLastGroup:"{isLastGroup}",isGroupLocked:"{isGroupLocked}",isGroupSelected:"{isGroupSelected}",showHeader:true,editMode:"{editMode}",titleChange:function(e){sap.ui.getCore().getEventBus().publish("launchpad","changeGroupTitle",{groupId:e.getSource().getGroupId(),newTitle:e.getParameter("newTitle")});},showPlaceholder:{parts:["/tileActionModeActive","tiles/length"],formatter:function(a){return(a||!this.groupHasTiles())&&!this.getIsGroupLocked();}},visible:{parts:["/tileActionModeActive","isGroupVisible","visibilityModes"],formatter:function(a,i,v){if(!v[a?1:0]){return false;}return i||a;}},links:this._getLinkTemplate(),tiles:this._getTileTemplate(),add:function(e){t.oController.getView().parentComponent.getRouter().navTo('appFinder',{'menu':'catalog',filters:JSON.stringify({targetGroup:encodeURIComponent(e.getSource().getBindingContext().sPath)})});},afterRendering:jQuery.proxy(this._tileContainerAfterRenderingHandler,t)});return T;},_getLinkTemplate:function(){var f=new sap.ui.model.Filter("isTileIntentSupported",sap.ui.model.FilterOperator.EQ,true);if(window.location.search.indexOf("new_links_container=true")===-1){return{path:"links",templateShareable:true,template:new sap.ushell.ui.launchpad.LinkTileWrapper({uuid:"{uuid}",tileCatalogId:"{tileCatalogId}",target:"{target}",isLocked:"{isLocked}",tileActionModeActive:"{/tileActionModeActive}",animationRendered:false,debugInfo:"{debugInfo}",ieHtml5DnD:this.oController.getView().ieHtml5DnD,tileViews:{path:"content",factory:function(i,c){return c.getObject();}},afterRendering:function(e){var j=jQuery(this.getDomRef().getElementsByTagName("a"));j.attr("tabindex",-1);}}),filters:[f]};}else{return{path:"links",factory:function(i,c){return c.getObject().content[0];},filters:[f]};}},_getTileTemplate:function(){var f=new sap.ui.model.Filter("isTileIntentSupported",sap.ui.model.FilterOperator.EQ,true);var t=new sap.ushell.ui.launchpad.Tile({"long":"{long}",uuid:"{uuid}",tileCatalogId:"{tileCatalogId}",target:"{target}",isLocked:"{isLocked}",tileActionModeActive:"{/tileActionModeActive}",showActionsIcon:"{showActionsIcon}",rgba:"{rgba}",animationRendered:false,debugInfo:"{debugInfo}",ieHtml5DnD:this.oController.getView().ieHtml5DnD,afterRendering:function(e){var c=e.getSource().getBindingContext(),T;if(c){T=c.getObject();sap.ui.getCore().getEventBus().publish("launchpad","tileRendered",{tileId:T.originalTileId,tileDomElementId:e.getSource().getId()});}},tileViews:{path:"content",factory:function(i,c){return c.getObject();}},coverDivPress:function(e){if(!e.oSource.getBindingContext().getObject().tileIsBeingMoved){sap.ushell.components.flp.ActionMode._openActionsMenu(e);}},showActions:function(e){sap.ushell.components.flp.ActionMode._openActionsMenu(e);},deletePress:function(e){var T=e.getSource(),t=T.getBindingContext().getObject().object,d={originalTileId:sap.ushell.Container.getService("LaunchPage").getTileId(t)};sap.ui.getCore().getEventBus().publish("launchpad","deleteTile",d,this);},press:[this.oController.dashboardTilePress,this.oController]});var v=sap.ui.getCore().byId("viewPortContainer");t.addEventDelegate({onclick:function(e){jQuery.sap.measure.start("FLP:DashboardGroupsBox.onclick","Click on tile","FLP");function a(){jQuery.sap.measure.end("FLP:DashboardGroupsBox.onclick");v.detachAfterNavigate(a);}v.attachAfterNavigate(a);}});return{path:"tiles",templateShareable:true,template:t,filters:[f]};},_tileContainerAfterRenderingHandler:function(e){e.oSource.bindProperty("showBackground","/tileActionModeActive");e.oSource.bindProperty("showDragIndicator",{parts:['/tileActionModeActive','/enableDragIndicator'],formatter:function(I,d){return I&&d&&!this.getIsGroupLocked()&&!this.getDefaultGroup();}});e.oSource.bindProperty("showMobileActions",{parts:['/tileActionModeActive'],formatter:function(I){return I&&!this.getDefaultGroup();}});e.oSource.bindProperty("showIcon",{parts:['/isInDrag','/tileActionModeActive'],formatter:function(I,b){return(this.getIsGroupLocked()&&(I||b));}});e.oSource.bindProperty("deluminate",{parts:['/isInDrag'],formatter:function(I){return this.getIsGroupLocked()&&I;}});if(this.bTileContainersContentAdded&&!e.oSource.getBeforeContent().length){var g=e.oSource.getModel().getProperty("/groups"),i;for(i=0;i<g.length;i++){if(g[i].groupId===e.oSource.getGroupId()){break;}}this._addTileContainerContent(i);}sap.ushell.Layout.reRenderGroupsLayout(null);this._updateFirstGroupHeaderVisibility(e.oSource.getProperty('tileActionModeActive'),e.oSource.getModel().getProperty('/homePageGroupDisplay')!=="tabs");},_updateFirstGroupHeaderVisibility:function(I,e){var g=this.oGroupsContainer.getGroups(),f=undefined,v=0;for(var i=g.length-1;i>=0;--i){g[i].setShowGroupHeader(I||e);if(g[i].getProperty("visible")){v++;f=i;}}if(f!==undefined)g[f].setShowGroupHeader(I||(v==1&&e));},_addTileContainersContent:function(){if(!this.bTileContainersContentAdded){var g=this.oGroupsContainer.getGroups();g.forEach(function(a,b){this._addTileContainerContent(b);}.bind(this));this.bTileContainersContentAdded=true;}},_addTileContainerContent:function(g){var G=this.oGroupsContainer.getGroups()[g],b;if(G){b=G.getBindingContext().getPath()+'/';G.addBeforeContent(this._getBeforeContent(this.oController,b));G.addAfterContent(this._getAfterContent(this.oController,b));G.addHeaderAction(this._getHeaderAction(this.oController,b));}},_getBeforeContent:function(c){var a=new sap.m.Button({icon:"sap-icon://add",text:sap.ushell.resources.i18n.getText("add_group_at"),visible:{parts:["/tileActionModeActive"],formatter:function(t){return(!this.getParent().getIsGroupLocked()&&!this.getParent().getDefaultGroup()&&t);}},enabled:{parts:["/editTitle"],formatter:function(i){return!i;}},type:sap.m.ButtonType.Transparent,press:[this.oController._addGroupHandler]}).addStyleClass("sapUshellAddGroupButton");a.addDelegate({onAfterRendering:function(){jQuery(".sapUshellAddGroupButton").attr("tabindex",-1);}});return a;},_getAfterContent:function(c){var a=new sap.m.Button({icon:"sap-icon://add",text:sap.ushell.resources.i18n.getText("add_group_at"),visible:{parts:["isLastGroup","/tileActionModeActive","/isInDrag"],formatter:function(i,t,b){return(i&&t);}},enabled:{parts:["/editTitle"],formatter:function(i){return!i;}},type:sap.m.ButtonType.Transparent,press:[this.oController._addGroupHandler]}).addStyleClass("sapUshellAddGroupButton");a.addDelegate({onAfterRendering:function(){jQuery(".sapUshellAddGroupButton").attr("tabindex",-1);}});return a;},_getHeaderActions:function(){var s=new sap.m.Button({text:{path:'isGroupVisible',formatter:function(i){if(sap.ui.Device.system.phone){this.setIcon(i?"sap-icon://hide":"sap-icon://show");}return sap.ushell.resources.i18n.getText(i?'HideGroupBtn':'ShowGroupBtn');}},type:sap.m.ButtonType.Transparent,visible:{parts:['/tileActionModeActive','/enableHideGroups','isGroupLocked','isDefaultGroup'],formatter:function(i,I,b,a){return i&&I&&!b&&!a;}},press:function(e){var S=e.getSource(),g=S.getBindingContext();this.oController._changeGroupVisibility(g);}.bind(this)}).addStyleClass("sapUshellHeaderActionButton");var d=new sap.m.Button({text:{path:'removable',formatter:function(i){if(sap.ui.Device.system.phone){if(i){this.setIcon("sap-icon://delete");}else{this.setIcon("sap-icon://refresh");}}return sap.ushell.resources.i18n.getText(i?'DeleteGroupBtn':'ResetGroupBtn');}},type:sap.m.ButtonType.Transparent,visible:{parts:['/tileActionModeActive','isDefaultGroup'],formatter:function(i,I){return i&&!I;}},enabled:{parts:["/editTitle"],formatter:function(i){return!i;}},press:function(e){var S=e.getSource(),g=S.getBindingContext();this.oController._handleGroupDeletion(g);}.bind(this)}).addStyleClass("sapUshellHeaderActionButton");return[s,d];},_getHeaderAction:function(c,b){jQuery.sap.require("sap.ushell.ui.launchpad.GroupHeaderActions");return new sap.ushell.ui.launchpad.GroupHeaderActions({content:this._getHeaderActions(),tileActionModeActive:{parts:['/tileActionModeActive',b+'isDefaultGroup'],formatter:function(i,I){return i&&!I;}},isOverflow:'{/isPhoneWidth}'}).addStyleClass("sapUshellOverlayGroupActionPanel");},_hidePlusTile:function(p){if(p){p.className+=" sapUshellHidePlusTile";}},_showPlusTile:function(p){if(p){p.className=p.className.split(' '+'sapUshellHidePlusTile').join('');}}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.flp.launchpad.dashboard.DashboardUIActions')){(function(){"use strict";jQuery.sap.declare("sap.ushell.components.flp.launchpad.dashboard.DashboardUIActions");sap.ui.base.Object.extend("sap.ushell.components.flp.launchpad.dashboard.DashboardUIActions",{metadata:{publicMethods:["initializeUIActions"]},constructor:function(i,s){if(sap.ushell.components.flp.launchpad.dashboard.getDashboardUIActions&&sap.ushell.components.flp.launchpad.dashboard.getDashboardUIActions()){return sap.ushell.components.flp.launchpad.dashboard.getDashboardUIActions();}sap.ushell.components.flp.launchpad.dashboard.getDashboardUIActions=jQuery.sap.getter(this.getInterface());this.oTileUIActions=undefined;this.oGroupUIActions=undefined;this.oController=undefined;this.UIActionsInitialized=false;sap.ui.getCore().getEventBus().subscribe('launchpad','actionModeActive',this._enableGroupUIActions,this);sap.ui.getCore().getEventBus().subscribe('launchpad','actionModeInactive',this._disableGroupUIActions,this);},destroy:function(){sap.ui.getCore().getEventBus().unsubscribe('launchpad','actionModeActive',this._enableGroupUIActions,this);sap.ui.getCore().getEventBus().unsubscribe('launchpad','actionModeInactive',this._disableGroupUIActions,this);sap.ushell.components.flp.launchpad.dashboard.getDashboardUIActions=undefined;this.oGroupUIActions=null;this.oTileUIActions=null;},initializeUIActions:function(c){this.oController=c;var d=c.getView().sDashboardGroupsWrapperId,a,r=sap.ui.getCore().getConfiguration().getRTL(),C={containerSelector:'#dashboardGroups',wrapperSelector:d?"#"+d:undefined,rootSelector:"#dashboardGroups"},o=jQuery.extend(true,{},C,{switchModeDelay:1000,isTouch:c.getView().isTouch,isCombi:c.getView().isCombi,debug:false}),t={draggableSelector:".sapUshellTile",draggableSelectorExclude:".sapUshellPlusTile",placeHolderClass:"sapUshellTile-placeholder",cloneClass:"sapUshellTile-clone",deltaTop:-44,scrollContainerSelector:undefined,startCallback:this._handleTileUIStart.bind(this),endCallback:this._handleTileDrop.bind(this),dragCallback:this._handleStartDragTile.bind(this),dragAndScrollCallback:this._handleTileDragMove.bind(this),moveTolerance:c.getView().isTouch||c.getView().isCombi?10:3,isLayoutEngine:true,disabledDraggableSelector:'sapUshellLockedTile',onDragStartUIHandler:this._markDisableGroups.bind(this),onDragEndUIHandler:this._endUIHandler.bind(this),offsetLeft:r?jQuery(".sapUshellViewPortLeft").width():-jQuery(".sapUshellViewPortLeft").width()},g={draggableSelector:".sapUshellDashboardGroupsContainerItem:not(.sapUshellDisableDragAndDrop)",draggableSelectorBlocker:".sapUshellTilesContainer-sortable, .sapUshellTileContainerBeforeContent, .sapUshellTileContainerAfterContent",draggableSelectorExclude:".sapUshellHeaderActionButton",placeHolderClass:"sapUshellDashboardGroupsContainerItem-placeholder",cloneClass:"sapUshellDashboardGroupsContainerItem-clone",startCallback:this._handleGroupsUIStart.bind(this),endCallback:this._handleGroupDrop.bind(this),dragCallback:this._handleGroupStartDrag.bind(this),moveTolerance:c.getView().isTouch||c.getView().isCombi?10:0.1,isLayoutEngine:false,isVerticalDragOnly:true,draggableElement:".sapUshellTileContainerHeader"},w={draggableSelector:".sapUshellTile",placeHolderClass:"sapUshellTile-placeholder",startCallback:this._handleTileUIStart.bind(this),endCallback:this._handleTileDrop.bind(this),dragCallback:this._handleStartDragTile.bind(this),dragAndScrollCallback:this._handleTileDragMove.bind(this),onDragStartUIHandler:this._markDisableGroups.bind(this),onDragEndUIHandler:this._endUIHandler.bind(this),offsetLeft:r?jQuery(".sapUshellViewPortLeft").width():-jQuery(".sapUshellViewPortLeft").width()},W={forGroups:true,draggableSelector:".sapUshellTileContainerHeader",placeHolderClass:"sapUshellDashboardGroupsContainerItem-placeholder",_publishAsync:c._publishAsync};if(c.getView().oDashboardGroupsBox.getGroups().length){if(c.getView().getModel().getProperty("/personalization")){if(!c.getView().ieHtml5DnD){jQuery.sap.require('sap.ushell.UIActions');this._disableTileUIActions();this._disableGroupUIActions();this.oTileUIActions=new sap.ushell.UIActions(jQuery.extend(true,{},o,t)).enable();this.oGroupUIActions=new sap.ushell.UIActions(jQuery.extend(true,{},o,g));a=c.getView().getModel().getProperty("/tileActionModeActive");if(a){this.oGroupUIActions.enable();}}else{jQuery.sap.require('sap.ushell.UIActionsWin8');this._disableTileUIActions();this._disableGroupUIActions();this.oTileUIActions=sap.ushell.UIActionsWin8.getInstance(jQuery.extend(true,{},C,w)).enable();this.oGroupUIActions=sap.ushell.UIActionsWin8.getInstance(jQuery.extend(true,{},C,W)).enable();}}}},_enableGroupUIActions:function(){if(this.oGroupUIActions){this.oGroupUIActions.enable();}},_disableTileUIActions:function(){if(this.oTileUIActions){this.oTileUIActions.disable();}},_disableGroupUIActions:function(){if(this.oGroupUIActions){this.oGroupUIActions.disable();}},_handleTileDragMove:function(c){if(!c.isScrolling){sap.ushell.Layout.getLayoutEngine().moveDraggable(c.moveX,c.moveY);}},_handleTileUIStart:function(e,u){if((sap.ui.Device.browser.msie)&&((navigator.msMaxTouchPoints>0)||(navigator.maxTouchPoints>0))){this.titleElement=u.querySelector("[title]");if(this.titleElement){this.titleElement.setAttribute("data-title",this.titleElement.getAttribute("title"));this.titleElement.removeAttribute("title");}}},_changeTileDragAndDropAnimate:function(e,u){var d=this.dragNDropData.jqDashboard.scrollTop(),j,t,c,a,b,T,i,C;for(i=0;i<this.dragNDropData.jqDraggableElements.length;i++){j=this.dragNDropData.jqDraggableElements.eq(i);t=j[0];c=j.position();a=j.offset();if((a.left===t.offset.left)&&(a.top===t.offset.top)){continue;}t.position=c;t.offset=a;C=j.data("clone");if(!C){continue;}b=t.position.left+this.dragNDropData.containerLeftMargin;T=this._getTileTopOffset(j,t.position,d);C.stop(true,false).animate({left:b,top:T},{duration:250},{easing:"swing"});}},_handleStartDragTile:function(a,t){if(window.getSelection){var s=window.getSelection();try{s.removeAllRanges();}catch(e){}}sap.ushell.Layout.getLayoutEngine().layoutStartCallback(t);if(sap.ushell.Layout.isAnimationsEnabled()){sap.ushell.Layout.initDragMode();}jQuery(t).find("a").removeAttr('href');this.placeHolderElement=jQuery(".sapUshellTile-placeholder");sap.ui.getCore().getEventBus().publish("launchpad","sortableStart");},_handleTileDrop:function(e,t,a){var h=function(e,t){if(sap.ushell.Layout.isAnimationsEnabled()){sap.ushell.Layout.endDragMode();}jQuery('#dashboardGroups .sapUshellHidePlusTile').removeClass('sapUshellHidePlusTile');if((sap.ui.Device.browser.msie)&&((navigator.msMaxTouchPoints>0)||(navigator.maxTouchPoints>0))&&this.titleElement){this.titleElement.setAttribute("title",this.titleElement.getAttribute("data-title"));}this.oController._handleDrop.call(this.oController,e,t);if(sap.ui.Device.desktop){jQuery('body').removeClass("sapUshellDisableUserSelect");}};if(sap.ushell.Layout.isAnimationsEnabled()&&a&&a.clone){var d=jQuery.Deferred();var j=jQuery(a.clone);var c=a.clone.getBoundingClientRect();var p=t.getBoundingClientRect();var s=j.css("transform").split(",");var b=p.top-c.top;var f=p.left-c.left;var g=parseInt(s[4],10)+f;var i=parseInt(s[5],10)+b;j.css({"transform":"translate3d("+g+"px, "+i+"px, 0px)","transition":"transform 0.3s cubic-bezier(0.46, 0, 0.44, 1)"});setTimeout(function(){d.resolve();h.call(this,e,t);}.bind(this),300);return d.promise();}else{h.apply(this,arguments);}},_getTileTopOffset:function(t,p,d){var i=0,T=i+d;T+=t.closest(".sapUshellDashboardGroupsContainerItem").position().top;T+=p.top;return T;},_markDisableGroups:function(){if(this.oController.getView().getModel()){this.oController.getView().getModel().setProperty('/isInDrag',true);}},_endUIHandler:function(){if(sap.ushell.Layout.isAnimationsEnabled()){sap.ushell.Layout.endDragMode();}if(this.oController.getView().getModel()){this.oController.getView().getModel().setProperty('/isInDrag',false);}},_handleGroupStartDrag:function(e,u){this.oTileUIActions.disable();var g=jQuery(".sapUshellDashboardGroupsContainerItem-clone"),a=g.find(".sapUshellContainerTitle"),t=a.height(),b=a.width(),c,d,f,s,r=sap.ui.getCore().getConfiguration().getRTL();if(!sap.ui.Device.system.phone){g.find(".sapUshellTileContainerEditMode").offset({top:this.oGroupUIActions.getMove().y-t,left:r?jQuery(".sapUshellViewPortCenter").width()+this.oGroupUIActions.getMove().x+b:this.oGroupUIActions.getMove().x-(b/2)});jQuery(".sapUshellTileContainerBeforeContent").addClass("sapUshellTileContainerHidden");}else{jQuery(".sapUshellTilesContainer-sortable").addClass("sapUshellTileContainerRemoveContent");jQuery(".sapUshellLineModeContainer, .sapUshellLinksContainer").addClass("sapUshellTileContainerRemoveContent");jQuery(".sapUshellTileContainerBeforeContent").addClass("sapUshellTileContainerRemoveContent");jQuery(".sapUshellContainerHeaderActions").addClass("sapUshellTileContainerHidden");}jQuery(".sapUshellTileContainerAfterContent").addClass("sapUshellTileContainerRemoveContent");jQuery(u).find(".sapUshellContainerHeaderActions").addClass("sapUshellTileContainerHidden");this.oController.getView().getModel().setProperty('/isInDrag',true);jQuery(u).attr('startPos',jQuery(u).index());jQuery.sap.log.info('startPos - '+jQuery(u).index());setTimeout(function(){sap.ui.getCore().getEventBus().publish("launchpad","sortableStart");},0);c=jQuery("#dashboardGroups").offset().top;d=jQuery(".sapUshellDashboardGroupsContainerItem-placeholder").offset().top;f=jQuery(".sapUshellDashboardGroupsContainerItem-clone").offset().top;s=d-c-f;jQuery('.sapUshellDashboardView section').animate({scrollTop:s},0);},_handleGroupsUIStart:function(e,u){jQuery(u).find(".sapUshellTileContainerContent").css("outline-color","transparent");},_handleGroupDrop:function(e,u){var b=sap.ui.getCore().getEventBus(),q=jQuery(u),f=jQuery(q.children()[0]).attr("id"),g=sap.ui.getCore().byId(f),d=sap.ui.getCore().byId("dashboardGroups"),D={group:g,groupChanged:false,focus:false},n=q.index();q.startPos=window.parseInt(q.attr('startPos'),10);d.removeAggregation('groups',g,true);d.insertAggregation('groups',g,n,true);this._handleGroupMoved(e,{item:q});q.removeAttr('startPos');sap.ui.getCore().getEventBus().publish("launchpad","sortableStop");setTimeout(function(){jQuery(".sapUshellContainerHeaderActions").removeClass("sapUshellTileContainerHidden");jQuery(".sapUshellTileContainerBeforeContent").removeClass("sapUshellTileContainerHidden");jQuery(".sapUshellTileContainerBeforeContent").removeClass("sapUshellTileContainerRemoveContent");jQuery(".sapUshellTileContainerAfterContent").removeClass("sapUshellTileContainerRemoveContent");jQuery(".sapUshellTilesContainer-sortable").removeClass("sapUshellTileContainerRemoveContent");jQuery(".sapUshellLineModeContainer, .sapUshellLinksContainer").removeClass("sapUshellTileContainerRemoveContent");},0);window.setTimeout(jQuery.proxy(b.publish,b,"launchpad","scrollToGroup",D),1);this.oTileUIActions.enable();},_handleGroupMoved:function(e,u){var f=u.item.startPos,t=u.item.index(),m=this.oController.getView().getModel();if(t!==-1){this.oController._publishAsync("launchpad","moveGroup",{fromIndex:f,toIndex:t});setTimeout(function(){m.setProperty('/isInDrag',false);},100);}},_setController:function(c){this.oController=c;}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.flp.settings.FlpSettings.controller')){jQuery.sap.declare('sap.ushell.components.flp.settings.FlpSettings.controller');jQuery.sap.require('sap.ui.core.mvc.Controller');sap.ui.define("sap/ushell/components/flp/settings/FlpSettings.controller",["sap/ui/core/mvc/Controller"],function(C){"use strict";return C.extend("sap.ushell.components.flp.settings.FlpSettings",{DISPLAY_MODES:{'scroll':0,'tabs':1,getName:function(v){return Object.keys(this)[v];}},onInit:function(){this.oConfModel=new sap.ui.model.json.JSONModel({});this.oConfModel.setData({isRTL:sap.ui.getCore().getConfiguration().getRTL(),flexAlignItems:sap.ui.Device.system.phone?'Stretch':'Start',textAlign:sap.ui.Device.system.phone?'Begin':'End',textDirection:sap.ui.Device.system.phone?'Column':'Row',labelWidth:sap.ui.Device.system.phone?"auto":"12rem"});this.getView().setModel(this.oConfModel,"config");var r=new sap.ui.model.resource.ResourceModel({bundleUrl:jQuery.sap.getModulePath("sap.ushell.renderers.fiori2.resources.resources",".properties")});this.getView().setModel(r,"i18n");var i=this.getView().getViewData().initialDisplayMode;this.iCurrentMode=this.DISPLAY_MODES[i]||this.DISPLAY_MODES.scroll;},onBeforeRendering:function(){this.oConfModel.setProperty("/displayMode",this.iCurrentMode);},onSave:function(){this.iCurrentMode=this.oConfModel.getProperty("/displayMode");return this.DISPLAY_MODES.getName(this.iCurrentMode);}});});};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.cdm.applauncher.Component')){(function(){"use strict";jQuery.sap.declare("sap.ushell.components.tiles.cdm.applauncher.Component");jQuery.sap.declare('sap.ushell.components.tiles.cdm.applauncher.Component');jQuery.sap.require('sap.ui.core.UIComponent');sap.ui.define("sap/ushell/components/tiles/cdm/applauncher/Component",["sap/ui/core/UIComponent"],function(U){return U.extend("sap.ushell.components.tiles.cdm.applauncher.Component",{metadata:{"manifest":"json"},createContent:function(){var c=this.getComponentData();var m=this.getManifestEntry("/sap.ui5/config")||{};var p=c.properties.tilePersonalization||{};var M=jQuery.extend(m,p);var s=c.startupParameters;if(s&&s["sap-system"]){M["sap-system"]=s["sap-system"][0];}var t=sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.ushell.components.tiles.cdm.applauncher.StaticTile",viewData:{properties:c.properties,configuration:M}});this._oController=t.getController();return t;},tileSetVisualProperties:function(n){if(this._oController){this._oController.updatePropertiesHandler(n);}},tileRefresh:function(){},tileSetVisible:function(i){},exit:function(){this._oController=null;}});});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.cdm.applauncherdynamic.Component')){(function(){"use strict";jQuery.sap.declare("sap.ushell.components.tiles.cdm.applauncherdynamic.Component");jQuery.sap.declare('sap.ushell.components.tiles.cdm.applauncherdynamic.Component');jQuery.sap.require('sap.ui.core.UIComponent');sap.ui.define("sap/ushell/components/tiles/cdm/applauncherdynamic/Component",["sap/ui/core/UIComponent"],function(U){return U.extend("sap.ushell.components.tiles.cdm.applauncherdynamic.Component",{metadata:{"manifest":"json"},createContent:function(){var c=this.getComponentData();var m=this.getManifestEntry("/sap.ui5/config")||{};var p=c.properties||{};var P=p.tilePersonalization||{};var M=jQuery.extend(m,P);var i=p.indicatorDataSource;if(i&&i.path){M.serviceUrl=i.path;M.serviceRefreshInterval=i.refresh;}var s=c.startupParameters;if(s&&s["sap-system"]&&s["sap-system"][0]){M["sap-system"]=s["sap-system"][0];}if(M.serviceUrl&&M.serviceUrl.charAt(0)!=="/"&&p.dataSource&&p.dataSource.uri){var S=p.dataSource.uri;if(M["sap-system"]){if(S.charAt(S.length-1)==="/"){S=S.slice(0,S.length-1);}S+=";o="+M["sap-system"];}if(S.charAt(S.length-1)!=="/"){S+="/";}S+=M.serviceUrl;M.serviceUrl=S;}var t=sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.ushell.components.tiles.cdm.applauncherdynamic.DynamicTile",viewData:{properties:p,configuration:M}});this._oController=t.getController();return t;},tileSetVisualProperties:function(n){if(this._oController){this._oController.updateVisualPropertiesHandler(n);}},tileRefresh:function(){if(this._oController){this._oController.refreshHandler();}},tileSetVisible:function(i){if(this._oController){this._oController.visibleHandler(i);}},exit:function(){this._oController=null;}});});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper')){(function(){jQuery.sap.declare("sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper");sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper=function(t){this.tile=t;};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setErrorState=function(){this.getTile().setState(sap.suite.ui.commons.LoadState.Failed);};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setLoadingState=function(){this.getTile().setState(sap.suite.ui.commons.LoadState.Loading);};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setLoadedState=function(){this.getTile().setState(sap.suite.ui.commons.LoadState.Loaded);};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setTrendDown=function(){this.getTile().setIndicator(sap.suite.ui.commons.DeviationIndicator.Down);};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setTrendUp=function(){this.getTile().setIndicator(sap.suite.ui.commons.DeviationIndicator.Up);};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setTrendNeutral=function(){this.getTile().setIndicator(sap.suite.ui.commons.DeviationIndicator.None);};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setThresholdGood=function(){};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setThresholdBad=function(){};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setThresholdCritical=function(){};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setThresholdNeutral=function(){};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.calculateThreshold=function(a,v,i){};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setTile=function(t){this.tile=t;};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.getTile=function(){return this.tile;};}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.indicatorTileUtils.oData4Analytics')){jQuery.sap.declare("sap.ushell.components.tiles.indicatorTileUtils.oData4Analytics");jQuery.sap.require('sap.ui.core.Core');sap=sap||{};sap.ushell=sap.ushell||{};sap.ushell.components=sap.ushell.components||{};sap.ushell.components.tiles.indicatorTileUtils=sap.ushell.components.tiles.indicatorTileUtils||{};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics=sap.ushell.components.tiles.indicatorTileUtils.odata4analytics||{};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants={};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants["SAP_NAMESPACE"]="http://www.sap.com/Protocols/SAPData";sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants["VERSION"]="0.7";sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.helper={renderPropertyKeyValue:function(f,p){if(f.charAt(0)=="'"){throw"Illegal property value starting with a quote";}switch(p){case'Edm.String':return"'"+f+"'";case'Edm.DateTime':return"datetime'"+f+"'";case'Edm.Guid':return"guid'"+f+"'";case'Edm.Time':return"time'"+f+"'";case'Edm.DateTimeOffset':return"datetimeoffset'"+f+"'";default:return f;}},renderPropertyFilterValue:function(f,p){if(f.charAt(0)=="'"){throw"Illegal property value starting with a quote";}switch(p){case'Edm.String':return"'"+f+"'";case'Edm.DateTime':return"datetime'"+f+"'";case'Edm.Guid':return"guid'"+f+"'";case'Edm.Time':return"time'"+f+"'";case'Edm.DateTimeOffset':return"datetimeoffset'"+f+"'";default:return f;}},tokenizeNametoLabelText:function(n){var l="";l=n.replace(/([^A-Z0-9_]+)([A-Z0-9_])/g,"$1 $2");l=l.replace(/([A-Z0-9_]{2,})([A-Z0-9_])([^A-Z0-9_]+)/g,"$1 $2$3");l=l.replace(/(.*) _E$/,"$1");l=l.replace(/(.*) _(.*)/g,"$1 $2");return l;}};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Model=function(m,a){this._init(m,a);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Model.ReferenceByURI=function(u){return{sServiceURI:u};};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Model.ReferenceByModel=function(m){return{oModel:m};};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Model.ReferenceWithWorkaround=function(m,w){return{oModelReference:m,aWorkaroundID:w};};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Model.prototype={_init:function(m,a){this._oActivatedWorkarounds={};if(m&&m.aWorkaroundID){var w=m.aWorkaroundID;for(var i=0;i<w.length;i++){this._oActivatedWorkarounds[w[i]]=true;}m=m.oModelReference;}if(!m||(!m.sServiceURI&&!m.oModel)){throw"Usage with oModelReference being an instance of Model.ReferenceByURI or Model.ReferenceByModel";}if(m.oModel){this._oModel=m.oModel;}else{this._oModel=new sap.ui.model.odata.ODataModel(m.sServiceURI);}if(this._oModel.getServiceMetadata().dataServices==undefined){throw"Model could not be loaded";}this.mergeV2Annotations(a);this._oQueryResultSet={};this._oParameterizationSet={};this._oEntityTypeSet={};this._oEntitySetSet={};this._oEntityTypeNameToEntitySetMap={};var s=this._oModel.getServiceMetadata().dataServices.schema[0];for(var i=-1,c;c=s.entityContainer[++i];){if(c.isDefaultEntityContainer=="true"){this._oDefaultEntityContainer=c;break;}}var e=s.entityType;var q=[],p=[],u=[];for(var i=-1,t;t=e[++i];){var P=false;if(t.extensions!=undefined){for(var j=-1,E;E=t.extensions[++j];){if(E.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE&&E.name=="semantics"){P=true;switch(E.value){case"aggregate":q.push(t);break;case"parameters":p.push(t);break;default:u.push(t);}}if(P){continue;}}if(!P){u.push(t);}}else{u.push(t);}}for(var i=-1,t;t=u[++i];){var o=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntityType(this._oModel.getServiceMetadata(),s,t);this._oEntityTypeSet[o.getQName()]=o;var b=this._getEntitySetsOfType(s,o.getQName());if(b.length==0){throw"Invalid consumption model: No entity set for entity type annotated with parameters semantics";}if(b.length>1){throw"Unsupported consumption model: More than one entity set for entity type annotated with parameters semantics";}var d=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntitySet(this._oModel.getServiceMetadata(),s,b[0][0],b[0][1]);this._oEntitySetSet[d.getQName()]=d;this._oEntityTypeNameToEntitySetMap[o.getQName()]=d;}var f={};for(var i=-1,t;t=p[++i];){var o=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntityType(this._oModel.getServiceMetadata(),s,t);this._oEntityTypeSet[o.getQName()]=o;var b=this._getEntitySetsOfType(s,o.getQName());if(b.length==0){throw"Invalid consumption model: No entity set for entity type annotated with parameters semantics";}if(b.length>1){throw"Unsupported consumption model: More than one entity set for entity type annotated with parameters semantics";}var d=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntitySet(this._oModel.getServiceMetadata(),s,b[0][0],b[0][1]);this._oEntitySetSet[d.getQName()]=d;this._oEntityTypeNameToEntitySetMap[o.getQName()]=d;var g=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Parameterization(o,d);this._oParameterizationSet[g.getName()]=g;f[o.getQName()]=g;var h=o.getQName();if(s.association!=undefined){for(var j=-1,A;A=s.association[++j];){if(A.referentialConstraint==undefined){continue;}var k=null;if(A.end[0].type==h&&A.end[0].multiplicity=="*"&&A.end[1].multiplicity=="1"){k=A.end[1].type;}else if(A.end[1].type==h&&A.end[1].multiplicity=="*"&&A.end[0].multiplicity=="1"){k=A.end[0].type;}if(!k){continue;}if(A.referentialConstraint.dependent.propertyRef.length!=1){continue;}var l=g.findParameterByName(A.referentialConstraint.dependent.propertyRef[0].name);if(l==null){continue;}var v=this._oEntityTypeSet[k];var V=this._oEntityTypeNameToEntitySetMap[k];l.setValueSetEntity(v,V);}}}for(var i=-1,t;t=q[++i];){var o=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntityType(this._oModel.getServiceMetadata(),s,t);this._oEntityTypeSet[o.getQName()]=o;var Q=o.getQName();var g=null;var n=null;if(s.association!=undefined){for(var j=-1,A;A=s.association[++j];){var r=null;if(A.end[0].type==Q){r=A.end[1].type;}else if(A.end[1].type==Q){r=A.end[0].type;}else{continue;}var M=null;M=f[r];if(M!=null){if(g!=null){throw"LIMITATION: Unable to handle multiple parameter entity types of query entity "+o.name;}else{g=M;n=A;}}}}var b=this._getEntitySetsOfType(s,o.getQName());if(b.length!=1){throw"Invalid consumption model: There must be exactly one entity set for an entity type annotated with aggregating semantics";}var d=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntitySet(this._oModel.getServiceMetadata(),s,b[0][0],b[0][1]);this._oEntitySetSet[d.getQName()]=d;this._oEntityTypeNameToEntitySetMap[o.getQName()]=d;var x=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.QueryResult(this,o,d,g);this._oQueryResultSet[x.getName()]=x;if(g){g.setTargetQueryResult(x,n);}}},oUI5ODataModelAnnotatableObject:{objectName:"schema",keyPropName:"namespace",extensions:true,aSubObject:[{objectName:"entityType",keyPropName:"name",extensions:true,aSubObject:[{objectName:"property",keyPropName:"name",aSubObject:[],extensions:true}]},{objectName:"entityContainer",keyPropName:"name",extensions:false,aSubObject:[{objectName:"entitySet",keyPropName:"name",extensions:true,aSubObject:[]}]}]},mergeV2Annotations:function(a){try{var A=JSON.parse(a);}catch(e){return;}var m;try{m=this._oModel.getServiceMetadata().dataServices;}catch(e){return;}for(var p in A){if(!(this.oUI5ODataModelAnnotatableObject.objectName==p)){continue;}if(!(A[p]instanceof Array)){continue;}this.mergeV2AnnotationLevel(m[this.oUI5ODataModelAnnotatableObject.objectName],A[this.oUI5ODataModelAnnotatableObject.objectName],this.oUI5ODataModelAnnotatableObject);break;}return;},mergeV2AnnotationLevel:function(M,a,u){for(var i=-1,A;A=a[++i];){for(var j=-1,o;o=M[++j];){if(!(A[u.keyPropName]==o[u.keyPropName])){continue;}if(A["extensions"]!=undefined){if(o["extensions"]==undefined){o["extensions"]=[];}for(var l=-1,b;b=A["extensions"][++l];){var f=false;for(var m=-1,c;c=o["extensions"][++m];){if(b.name==c.name&&b.namespace==c.namespace){c.value=b.value;f=true;break;}}if(!f){o["extensions"].push(b);}}}for(var k=-1,U;U=u.aSubObject[++k];){for(var p in A){if(!(U.objectName==p)){continue;}if(!(A[U.objectName]instanceof Array)){continue;}if((o[U.objectName]==undefined)||(!(o[U.objectName]instanceof Array))){continue;}this.mergeV2AnnotationLevel(o[U.objectName],A[U.objectName],U);break;}}}}return;},findQueryResultByName:function(n){var q=this._oQueryResultSet[n];if(!q&&this._oDefaultEntityContainer){var Q=this._oDefaultEntityContainer.name+"."+n;q=this._oQueryResultSet[Q];}return q;},getAllQueryResultNames:function(){if(this._aQueryResultNames){return this._aQueryResultNames;}this._aQueryResultNames=new Array(0);for(var n in this._oQueryResultSet)this._aQueryResultNames.push(this._oQueryResultSet[n].getName());return this._aQueryResultNames;},getAllQueryResults:function(){return this._oQueryResultSet;},getODataModel:function(){return this._oModel;},_getEntitySetsOfType:function(s,q){var e=[];for(var i=-1,E;E=s.entityContainer[++i];){for(var j=-1,o;o=E.entitySet[++j];){if(o.entityType==q){e.push([E,o]);}}}return e;},_oModel:null,_oDefaultEntityContainer:null,_aQueryResultNames:null,_oQueryResultSet:null,_oParameterizationSet:null,_oEntityTypeSet:null,_oEntitySetSet:null,_oEntityTypeNameToEntitySetMap:null,_oActivatedWorkarounds:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.QueryResult=function(m,e,E,p){this._init(m,e,E,p);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.QueryResult.prototype={_init:function(m,e,E,p,a){this._oModel=m;this._oEntityType=e;this._oEntitySet=E;this._oParameterization=p;this._oDimensionSet={};this._oMeasureSet={};var P=e.getTypeDescription().property;var A={};for(var i=-1,o;o=P[++i];){if(o.extensions==undefined){continue;}for(var j=-1,b;b=o.extensions[++j];){if(!b.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE){continue;}switch(b.name){case"aggregation-role":switch(b.value){case"dimension":var d=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Dimension(this,o);this._oDimensionSet[d.getName()]=d;break;case"measure":var M=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Measure(this,o);this._oMeasureSet[M.getName()]=M;break;case"totaled-properties-list":this._oTotaledPropertyListProperty=o;break;}break;case"attribute-for":var D=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.DimensionAttribute(this,o);A[D.getKeyProperty()]=D;break;}}}for(var s in A){var D=A[s];D.getDimension().addAttribute(D);}if(m._oActivatedWorkarounds.IdentifyTextPropertiesByName){var c=[];for(var f in this._oDimensionSet){var d=this._oDimensionSet[f];if(!d.getTextProperty()){var t=null;t=e.findPropertyByName(f+"Name");if(!t){t=e.findPropertyByName(f+"Text");}if(!t){t=e.findPropertyByName(f+"Desc");}if(!t){t=e.findPropertyByName(f+"Description");}if(t){d.setTextProperty(t);c.push(t.name);}}}for(var i=-1,g;g=c[++i];){delete this._oDimensionSet[g];}}},getName:function(){return this.getEntitySet().getQName();},getParameterization:function(){return this._oParameterization;},getAllDimensionNames:function(){if(this._aDimensionNames){return this._aDimensionNames;}this._aDimensionNames=[];for(var n in this._oDimensionSet)this._aDimensionNames.push(this._oDimensionSet[n].getName());return this._aDimensionNames;},getAllDimensions:function(){return this._oDimensionSet;},getAllMeasureNames:function(){if(this._aMeasureNames){return this._aMeasureNames;}this._aMeasureNames=[];for(var n in this._oMeasureSet)this._aMeasureNames.push(this._oMeasureSet[n].getName());return this._aMeasureNames;},getAllMeasures:function(){return this._oMeasureSet;},findDimensionByName:function(n){return this._oDimensionSet[n];},getTotaledPropertiesListProperty:function(){return this._oTotaledPropertyListProperty;},findMeasureByName:function(n){return this._oMeasureSet[n];},getModel:function(){return this._oModel;},getEntityType:function(){return this._oEntityType;},getEntitySet:function(){return this._oEntitySet;},_oModel:null,_oEntityType:null,_oEntitySet:null,_oParameterization:null,_aDimensionNames:null,_oDimensionSet:null,_aMeasureNames:null,_oMeasureSet:null,_oTotaledPropertyListProperty:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Parameterization=function(e,E){this._init(e,E);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Parameterization.prototype={_init:function(e,E){this._oEntityType=e;this._oEntitySet=E;this._oParameterSet={};var p=e.getTypeDescription().property;for(var i=-1,P;P=p[++i];){if(P.extensions==undefined){continue;}for(var j=-1,o;o=P.extensions[++j];){if(!o.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE){continue;}switch(o.name){case"parameter":var a=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Parameter(this,P);this._oParameterSet[a.getName()]=a;break;}}}},setTargetQueryResult:function(q,a){this._oQueryResult=q;var Q=this._oEntityType.getSchema().namespace+"."+a.name;var n=this._oEntityType.getTypeDescription().navigationProperty;if(!n){throw"Invalid consumption model: Parameters entity type lacks navigation property for association to query result entity type";}for(var i=-1,N;N=n[++i];){if(N.relationship==Q){this._oNavPropToQueryResult=N.name;}}if(!this._oNavPropToQueryResult){throw"Invalid consumption model: Parameters entity type lacks navigation property for association to query result entity type";}},getName:function(){return this.getEntitySet().getQName();},getAllParameterNames:function(){if(this._aParameterNames){return this._aParameterNames;}this._aParameterNames=[];for(var n in this._oParameterSet)this._aParameterNames.push(this._oParameterSet[n].getName());return this._aParameterNames;},getAllParameters:function(){return this._oParameterSet;},findParameterByName:function(n){return this._oParameterSet[n];},getNavigationPropertyToQueryResult:function(){return this._oNavPropToQueryResult;},getEntityType:function(){return this._oEntityType;},getEntitySet:function(){return this._oEntitySet;},_oEntityType:null,_oEntitySet:null,_oQueryResult:null,_oNavPropToQueryResult:null,_aParameterNames:null,_oParameterSet:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Parameter=function(p,P){this._init(p,P);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Parameter.prototype={_init:function(p,P){this._oParameterization=p;this._oProperty=P;var e=p.getEntityType();if(P.extensions!=undefined){for(var i=-1,E;E=P.extensions[++i];){if(!E.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE){continue;}switch(E.name){case"parameter":switch(E.value){case"mandatory":this._bRequired=true;break;case"optional":this._bRequired=false;break;default:throw"Invalid annotation value for parameter property";}break;case"label":this._sLabelText=E.value;break;case"text":this._oTextProperty=e.findPropertyByName(E.value);break;case"upper-boundary":this._bIntervalBoundaryParameter=true;this._oUpperIntervalBoundaryParameterProperty=e.findPropertyByName(E.value);break;case"lower-boundary":this._bIntervalBoundaryParameter=true;this._oLowerIntervalBoundaryParameterProperty=e.findPropertyByName(E.value);break;}}}if(!this._sLabelText){this._sLabelText="";}},setValueSetEntity:function(e,E){this._oValueSetEntityType=e;this._oValueSetEntitySet=E;},getTextProperty:function(){return this._oTextProperty;},getLabelText:function(){if(!this._sLabelText&&this._oQueryResult._oModel._oActivatedWorkarounds.CreateLabelsFromTechnicalNames){this._sLabelText=sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.helper.tokenizeNametoLabelText(this.getName());}return this._sLabelText;},isOptional:function(){return(!this._bRequired);},isIntervalBoundary:function(){return this._bIntervalBoundaryParameter;},isLowerIntervalBoundary:function(){return(this._oUpperIntervalBoundaryParameterProperty?true:false);},getPeerIntervalBoundaryParameter:function(){var p=null;if(this._oLowerIntervalBoundaryParameterProperty){p=this._oLowerIntervalBoundaryParameterProperty.name;}else{p=this._oUpperIntervalBoundaryParameterProperty.name;}if(!p){throw"Parameter is not an interval boundary";}return this._oParameterization.findParameterByName(p);},isValueSetAvailable:function(){return(this._oValueSetEntityType?true:false);},getName:function(){return this._oProperty.name;},getProperty:function(){return this._oProperty;},getContainingParameterization:function(){return this._oParameterization;},getURIToValueEntitySet:function(s){var u=null;u=(s?s:"")+"/"+this._oValueSetEntitySet.getQName();return u;},_oParameterization:null,_oProperty:null,_sLabelText:null,_oTextProperty:null,_bRequired:false,_bIntervalBoundaryParameter:false,_oLowerIntervalBoundaryParameterProperty:null,_oUpperIntervalBoundaryParameterProperty:null,_oValueSetEntityType:null,_oValueSetEntitySet:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Dimension=function(q,p){this._init(q,p);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Dimension.prototype={_init:function(q,p){this._oQueryResult=q;this._oProperty=p;this._oAttributeSet={};if(p.extensions!=undefined){for(var i=-1,e;e=p.extensions[++i];){if(!e.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE){continue;}switch(e.name){case"label":this._sLabelText=e.value;break;case"text":this._oTextProperty=q.getEntityType().findPropertyByName(e.value);break;case"super-ordinate":this._sSuperOrdinatePropertyName=e.value;break;}}}if(!this._sLabelText){this._sLabelText="";}},getName:function(){return this._oProperty.name;},getKeyProperty:function(){return this._oProperty;},getTextProperty:function(){return this._oTextProperty;},setTextProperty:function(t){this._oTextProperty=t;},getLabelText:function(){if(!this._sLabelText&&this._oQueryResult._oModel._oActivatedWorkarounds.CreateLabelsFromTechnicalNames){this._sLabelText=sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.helper.tokenizeNametoLabelText(this.getName());}return this._sLabelText;},getSuperOrdinateDimension:function(){if(!this._sSuperOrdinatePropertyName){return null;}return this._oQueryResult.findDimensionByName(this._sSuperOrdinatePropertyName);},getHierarchy:function(){if(!this._oHierarchy){this._oHierarchy=this._oQueryResult.getEntityType().getHierarchy(this._oProperty.name);}return this._oHierarchy;},getAllAttributeNames:function(){if(this._aAttributeNames){return this._aAttributeNames;}this._aAttributeNames=[];for(var n in this._oAttributeSet)this._aAttributeNames.push(this._oAttributeSet[n].getName());return this._aAttributeNames;},getAllAttributes:function(){return this._oAttributeSet;},findAttributeByName:function(n){return this._oAttributeSet[n];},addAttribute:function(d){this._oAttributeSet[d.getName()]=d;},getContainingQueryResult:function(){return this._oQueryResult;},_oQueryResult:null,_oProperty:null,_oTextProperty:null,_sLabelText:null,_sSuperOrdinatePropertyName:null,_aAttributeNames:null,_oAttributeSet:null,_oHierarchy:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.DimensionAttribute=function(q,p){this._init(q,p);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.DimensionAttribute.prototype={_init:function(q,p){this._oQueryResult=q;this._oProperty=p;if(p.extensions!=undefined){for(var i=-1,e;e=p.extensions[++i];){if(!e.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE){continue;}switch(e.name){case"attribute-for":this._sDimensionName=e.value;break;case"label":this._sLabelText=e.value;break;case"text":this._oTextProperty=q.getEntityType().findPropertyByName(e.value);break;}}}},getName:function(){return this._oProperty.name;},getKeyProperty:function(){return this._oProperty;},getTextProperty:function(){return this._oTextProperty;},getLabelText:function(){return this._sLabelText;},getDimension:function(){return this._oQueryResult.findDimensionByName(this._sDimensionName);},_oQueryResult:null,_oProperty:null,_oTextProperty:null,_sLabelText:null,_sDimensionName:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Measure=function(q,p){this._init(q,p);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Measure.prototype={_init:function(q,p){this._oQueryResult=q;this._oProperty=p;if(p.extensions!=undefined){for(var i=-1,e;e=p.extensions[++i];){if(!e.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE){continue;}switch(e.name){case"label":this._sLabelText=e.value;break;case"text":this._oTextProperty=q.getEntityType().findPropertyByName(e.value);break;case"unit":this._oUnitProperty=q.getEntityType().findPropertyByName(e.value);break;}}}if(!this._sLabelText){this._sLabelText="";}},getName:function(){return this._oProperty.name;},getRawValueProperty:function(){return this._oProperty;},getFormattedValueProperty:function(){return this._oTextProperty;},getUnitProperty:function(){return this._oUnitProperty;},getLabelText:function(){return this._sLabelText;},_oQueryResult:null,_oProperty:null,_oTextProperty:null,_sLabelText:null,_oUnitProperty:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntitySet=function(m,s,c,e){this._init(m,s,c,e);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntitySet.prototype={_init:function(m,s,c,e){this._oEntitySet=e;this._oContainer=c;this._oSchema=s;this._oModel=m;if(s.entityContainer.length>1){this._sQName=c.name+"."+e.name;}else{this._sQName=e.name;}},getQName:function(){return this._sQName;},getSetDescription:function(){return this._oEntitySet;},getSchema:function(){return this._oSchema;},getModel:function(){return this._oModel;},_oEntitySet:null,_oContainer:null,_oSchema:null,_oModel:null,_sQName:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntityType=function(m,s,e){this._init(m,s,e);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntityType.prototype={_init:function(m,s,e){this._oEntityType=e;this._oSchema=s;this._oModel=m;this._oPropertySet={};this._aFilterablePropertyNames=[];this._aSortablePropertyNames=[];this._aRequiredFilterPropertyNames=[];this._sQName=s.namespace+"."+e.name;var r={};var R=null;for(var i=-1,p;p=e.property[++i];){this._aFilterablePropertyNames.push(p.name);this._aSortablePropertyNames.push(p.name);if(p.extensions==undefined){continue;}for(var j=-1,E;E=p.extensions[++j];){if(!E.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE){continue;}switch(E.name){case"filterable":if(E.value=="false"){this._aFilterablePropertyNames.pop(p.name);}break;case"sortable":if(E.value=="false"){this._aSortablePropertyNames.pop(p.name);}break;case"required-filter":if(E.value=="true"){this._aRequiredFilterPropertyNames.push(p.name);}break;case"hierarchy-node-for":if(!(R=r[p.name])){R=r[p.name]={};}R.dimensionName=E.value;break;case"hierarchy-parent-node-for":case"hierarchy-parent-nod":if(!(R=r[E.value])){R=r[E.value]={};}R.parentNodeIDProperty=p;break;case"hierarchy-level-for":if(!(R=r[E.value])){R=r[E.value]={};}R.levelProperty=p;break;case"hierarchy-drill-state-for":case"hierarchy-drill-stat":if(!(R=r[E.value])){R=r[E.value]={};}R.drillStateProperty=p;break;}}this._oPropertySet[p.name]=p;}this._oRecursiveHierarchySet={};for(var h in r){var H=r[h];var o=this._oPropertySet[h];var d=this._oPropertySet[H.dimensionName];if(d==null){d=o;}this._oRecursiveHierarchySet[d.name]=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.RecursiveHierarchy(e,o,H.parentNodeIDProperty,H.levelProperty,d);}},findPropertyByName:function(n){return this._oPropertySet[n];},getFilterablePropertyNames:function(){return this._aFilterablePropertyNames;},getSortablePropertyNames:function(){return this._aSortablePropertyNames;},getRequiredFilterPropertyNames:function(){return this._aRequiredFilterPropertyNames;},getAllHierarchyPropertyNames:function(){if(this._aHierarchyPropertyNames){return this._aHierarchyPropertyNames;}this._aHierarchyPropertyNames=[];for(var n in this._oRecursiveHierarchySet)this._aHierarchyPropertyNames.push(this._oRecursiveHierarchySet[n].getNodeValueProperty().name);return this._aHierarchyPropertyNames;},getHierarchy:function(n){if(this._oRecursiveHierarchySet[n]==undefined){return null;}return this._oRecursiveHierarchySet[n];},getQName:function(){return this._sQName;},getTypeDescription:function(){return this._oEntityType;},getSchema:function(){return this._oSchema;},getModel:function(){return this._oModel;},_oEntityType:null,_oSchema:null,_oModel:null,_sQName:null,_oPropertySet:null,_aFilterablePropertyNames:null,_aRequiredFilterPropertyNames:null,_aHierarchyPropertyNames:null,_oRecursiveHierarchySet:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.RecursiveHierarchy=function(e,n,p,N,o){this._init(e,n,p,N,o);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.RecursiveHierarchy.prototype={_init:function(e,n,p,N,o){this._oEntityType=e;this._oNodeIDProperty=n;this._oParentNodeIDProperty=p;this._oNodeLevelProperty=N;this._oNodeValueProperty=o;},isRecursiveHierarchy:function(){return true;},isLeveledHierarchy:function(){return false;},getNodeIDProperty:function(){return this._oNodeIDProperty;},getParentNodeIDProperty:function(){return this._oParentNodeIDProperty;},getNodeLevelProperty:function(){return this._oNodeLevelProperty;},getNodeValueProperty:function(){return this._oNodeValueProperty;},_oNodeIDProperty:null,_oParentNodeIDProperty:null,_oNodeLevelProperty:null,_oNodeValueProperty:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.FilterExpression=function(m,s,e){this._init(m,s,e);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.FilterExpression.prototype={_init:function(m,s,e){this._oEntityType=e;this._oSchema=s;this._oModel=m;this._aFilterCondition=[];},clear:function(){this._aFilterCondition=[];},addCondition:function(p,o,v,V){var P=this._oEntityType.findPropertyByName(p);if(P==null){throw"Cannot add filter condition for unknown property name "+p;}var f=this._oEntityType.getFilterablePropertyNames();if(f.indexOf(p)===-1){throw"Cannot add filter condition for not filterable property name "+p;}this._aFilterCondition.push({property:P,op:o,val1:v,val2:V});return this._aFilterablePropertyNames;},addSetCondition:function(p,v){var P=this._oEntityType.findPropertyByName(p);if(P==null){throw"Cannot add filter condition for unknown property name "+p;}var f=this._oEntityType.getFilterablePropertyNames();if(f.indexOf(p)===-1){throw"Cannot add filter condition for not filterable property name "+p;}for(var i=-1,V;V=v[++i];){this._aFilterCondition.push({property:P,op:sap.ui.model.FilterOperator.EQ,val1:V});}return this._aFilterablePropertyNames;},getExpressionAsUI5FilterArray:function(){var f=[];for(var i=-1,c;c=this._aFilterCondition[++i];){f.push(new sap.ui.model.Filter(c.property.name,c.op,c.val1,c.val2));}return f;},getURIFilterOptionValue:function(){if(this._aFilterCondition.length==0){return"";}this._aFilterCondition.sort(function(a,b){if(a.property.name==b.property.name){return 0;}if(a.property.name>b.property.name){return 1;}else{return-1;}});var p=this._aFilterCondition[0].property.name;var o="";var s="";for(var i=-1,c;c=this._aFilterCondition[++i];){if(p!=c.property.name){o+=(o==""?"":" and ")+"("+s+")";s="";p=c.property.name;}switch(c.op){case sap.ui.model.FilterOperator.BT:s+=(s==""?"":" or ")+"("+c.property.name+" "+sap.ui.model.FilterOperator.GE.toLowerCase()+" "+sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.helper.renderPropertyFilterValue(c.val1,c.property.type)+" and "+c.property.name+" "+sap.ui.model.FilterOperator.LE.toLowerCase()+" "+sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.helper.renderPropertyFilterValue(c.val2,c.property.type)+")";break;default:s+=(s==""?"":" or ")+"("+c.property.name+" "+c.op.toLowerCase()+" "+sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.helper.renderPropertyFilterValue(c.val1,c.property.type)+")";}}o+=(o==""?"":" and ")+"("+s+")";return o;},getEntityType:function(){return this._oEntityType;},getSchema:function(){return this._oSchema;},getModel:function(){return this._oModel;},_oEntityType:null,_oSchema:null,_oModel:null,_aFilterCondition:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.SortOrder={Ascending:"asc",Descending:"desc"};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.SortExpression=function(m,s,e){this._init(m,s,e);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.SortExpression.prototype={_init:function(m,s,e){this._oEntityType=e;this._oSchema=s;this._oModel=m;this._aSortCondition=[];},_containsSorter:function(p){var r=null;for(var i=-1,c;c=this._aSortCondition[++i];){if(c.property.name===p){r={sorter:c,index:i};break;}}return r;},_removeFromArray:function(a,f,t){var r=a.slice((t||f)+1||a.length);a.length=f<0?a.length+f:f;return a.push.apply(a,r);},clear:function(){this._aSortCondition=[];},addSorter:function(p,s){var P=this._oEntityType.findPropertyByName(p);if(P==null){throw"Cannot add sort condition for unknown property name "+p;}if(this._containsSorter(p)!=null){throw"Sort condition for this property name is already defined "+p;}var S=this._oEntityType.getSortablePropertyNames();if(S.indexOf(p)===-1){throw"Cannot add sort condition for not sortable property name "+p;}this._aSortCondition.push({property:P,order:s});return this;},removeSorter:function(p){if(!p){return;}var s=this._containsSorter(p);if(s){this._removeFromArray(this._aSortCondition,s.index);}},getExpressionsAsUI5SorterArray:function(){var s=[];for(var i=-1,c;c=this._aSortCondition[++i];){s.push(new sap.ui.model.Sorter(c.property.name,c.order==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.SortOrder.Descending));}return s;},getExpressionAsUI5Sorter:function(){var s=this.getExpressionsAsUI5SorterArray();if(s.length==0){return null;}else{return s[0];}},getURIOrderByOptionValue:function(){if(this._aSortCondition.length==0){return"";}var o="";for(var i=-1,c;c=this._aSortCondition[++i];){o+=c.property.name+" "+c.order;if(i<this._aSortCondition.length-1){o+=", ";}}return o;},getEntityType:function(){return this._oEntityType;},getSchema:function(){return this._oSchema;},getModel:function(){return this._oModel;},_oEntityType:null,_oSchema:null,_oModel:null,_aSortCondition:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.ParameterizationRequest=function(p){this._init(p);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.ParameterizationRequest.prototype={_init:function(p){if(!p){throw"No parameterization given";}this._oParameterization=p;this._oParameterValueAssignment=[];},getParameterization:function(){return this._oParameterization;},setParameterValue:function(p,v,t){var P=this._oParameterization.findParameterByName(p);if(!P){throw"Invalid parameter name "+p;}if(t!=null){if(!P.isIntervalBoundary()){throw"Range value cannot be applied to parameter "+p+" accepting only single values";}if(!P.isLowerIntervalBoundary()){throw"Range value given, but parameter "+p+" does not hold the lower boundary";}}if(!P.isIntervalBoundary()){if(v==null){delete this._oParameterValueAssignment[p];}else{this._oParameterValueAssignment[p]=v;}}else{if(v==null&&t!=null){throw"Parameter "+p+": An upper boundary cannot be given without the lower boundary";}if(v==null){delete this._oParameterValueAssignment[p];t=null;}else{this._oParameterValueAssignment[p]=v;}var u=P.getPeerIntervalBoundaryParameter();if(t==null){t=v;}if(v==null){delete this._oParameterValueAssignment[u.getName()];}else{this._oParameterValueAssignment[u.getName()]=t;}}return;},getURIToParameterizationEntitySet:function(s){return(s?s:"")+"/"+this._oParameterization.getEntitySet().getQName();},getURIToParameterizationEntry:function(s){var d=this._oParameterization.getAllParameters();for(var D in d){if(this._oParameterValueAssignment[D]==undefined){throw"Parameter "+D+" has no value assigned";}}var k="",f=true;for(var p in this._oParameterValueAssignment){k+=(f?"":",")+p+"="+sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.helper.renderPropertyKeyValue(this._oParameterValueAssignment[p],d[p].getProperty().type);f=false;}return(s?s:"")+"/"+this._oParameterization.getEntitySet().getQName()+"("+k+")";},_oParameterization:null,_oParameterValueAssignment:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.QueryResultRequest=function(q,p){this._init(q);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.QueryResultRequest.prototype={_init:function(q,p){this._oQueryResult=q;this._oParameterizationRequest=p;this._oAggregationLevel={};this._oMeasures={};this._bIncludeEntityKey=false;this._oFilterExpression=null;},setParameterizationRequest:function(p){this._oParameterizationRequest=p;},getQueryResult:function(){return this._oQueryResult;},setAggregationLevel:function(d){this._oAggregationLevel={};if(!d){d=this._oQueryResult.getAllDimensionNames();}this.addToAggregationLevel(d);},addToAggregationLevel:function(d){if(!d){return;}for(var i=-1,D;D=d[++i];){if(!this._oQueryResult.findDimensionByName(D)){throw D+" is not a valid dimension name";}this._oAggregationLevel[D]={key:true,text:false,attributes:null};}},removeFromAggregationLevel:function(d){if(!d){return;}for(var i=-1,D;D=d[++i];){if(!this._oQueryResult.findDimensionByName(D)){throw D+" is not a valid dimension name";}if(this._oAggregationLevel[D]!=undefined){delete this._oAggregationLevel[D];this.getSortExpression().removeSorter(D);}}},getAggregationLevel:function(){var d=[];for(var D in this._oAggregationLevel){d.push(D);}return d;},getAggregationLevelDetails:function(d){if(this._oAggregationLevel[d]==undefined){throw"Aggregation level does not include dimension "+d;}return this._oAggregationLevel[d];},setMeasures:function(m){if(!m){m=this._oQueryResult.getAllMeasureNames();}this._oMeasures={};for(var i=-1,M;M=m[++i];){if(!this._oQueryResult.findMeasureByName(M)){throw M+" is not a valid measure name";}this._oMeasures[M]={value:true,text:false,unit:false};}},getMeasureNames:function(){var m=[];for(var M in this._oMeasures){m.push(M);}return m;},includeDimensionKeyTextAttributes:function(d,I,b,a){var D=[];if(d){if(this._oAggregationLevel[d]==undefined){throw d+" is not included in the aggregation level";}D.push(d);}else{for(var n in this._oAggregationLevel){D.push(n);}a=null;}for(var i=-1,s;s=D[++i];){if(I!=null){this._oAggregationLevel[s].key=I;}if(b!=null){this._oAggregationLevel[s].text=b;}if(a!=null){this._oAggregationLevel[s].attributes=a;}}},includeMeasureRawFormattedValueUnit:function(m,I,b,a){var M=[];if(m){if(this._oMeasures[m]==undefined){throw m+" is not part of the query result";}M.push(m);}else{for(var n in this._oMeasures){M.push(n);}}for(var i=-1,s;s=M[++i];){if(I!=null){this._oMeasures[s].value=I;}if(b!=null){this._oMeasures[s].text=b;}if(a!=null){this._oMeasures[s].unit=a;}}},getFilterExpression:function(){if(this._oFilterExpression==null){var e=this._oQueryResult.getEntityType();this._oFilterExpression=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.FilterExpression(e.getModel(),e.getSchema(),e);}return this._oFilterExpression;},setFilterExpression:function(f){this._oFilterExpression=f;},getSortExpression:function(){if(this._oSortExpression==null){var e=this._oQueryResult.getEntityType();this._oSortExpression=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.SortExpression(e.getModel(),e.getSchema(),e);}return this._oSortExpression;},setSortExpression:function(s){this._oSortExpression=s;},setRequestOptions:function(i,I){if(i){this._bIncludeEntityKey=i;}if(I){this._bIncludeCount=I;}},setResultPageBoundaries:function(s,e){if(s!=null&&typeof s!=="number"){throw"Start value must be null or numeric";}if(e!==null&&typeof e!=="number"){throw"End value must be null or numeric";}if(s==null){s=1;}if(s<1||s>(e==null?s:e)){throw"Invalid values for requested page boundaries";}this._iSkipRequestOption=(s>1)?s:null;this._iTopRequestOption=(e!=null)?(e-s+1):null;},getResultPageBoundaries:function(){return{start:(this._iSkipRequestOption==null)?1:this._iSkipRequestOption,end:(this._iTopRequestOption!=null)?(this._iSkipRequestOption==null)?1:this._iSkipRequestOption+this._iTopRequestOption:null};},getURIToQueryResultEntitySet:function(s){var u=null;if(this._oQueryResult.getParameterization()){if(!this._oParameterizationRequest){throw"Missing parameterization request";}else{u=this._oParameterizationRequest.getURIToParameterizationEntry(s)+"/"+this._oQueryResult.getParameterization().getNavigationPropertyToQueryResult();}}else{u=(s?s:"")+"/"+this._oQueryResult.getEntitySet().getQName();}return u;},getURIQueryOptionValue:function(q){var Q=null;switch(q){case"$select":{var s="";for(var d in this._oAggregationLevel){var D=this._oQueryResult.findDimensionByName(d);var o=this._oAggregationLevel[d];if(o.key==true){s+=(s==""?"":",")+D.getKeyProperty().name;}if(o.text==true&&D.getTextProperty()){s+=(s==""?"":",")+D.getTextProperty().name;}if(o.attributes){for(var i=-1,a;a=o.attributes[++i];){s+=(s==""?"":",")+D.findAttributeByName(a).getName();}}}for(var m in this._oMeasures){var M=this._oQueryResult.findMeasureByName(m);var b=this._oMeasures[m];if(b.value==true){s+=(s==""?"":",")+M.getRawValueProperty().name;}if(b.text==true&&M.getFormattedValueProperty()){s+=(s==""?"":",")+M.getFormattedValueProperty().name;}if(b.unit==true&&M.getUnitProperty()){s+=(s==""?"":",")+M.getUnitProperty().name;}}if(this._bIncludeEntityKey){var k=this._oQueryResult.getEntityType().getTypeDescription().key.propertyRef;for(var i=-1,K;K=k[++i];){s+=(s==""?"":",")+K.name;}}Q=(s?s:null);break;}case"$filter":{var f=null;if(this._oFilterExpression){f=this._oFilterExpression.getURIFilterOptionValue();}Q=(f?f:null);break;}case"$orderby":{var S=null;if(this._oSortExpression){S=this._oSortExpression.getURIOrderByOptionValue();}Q=(S?S:null);break;}case"$top":{if(this._iTopRequestOption!==null){Q=this._iTopRequestOption;}break;}case"$skip":{Q=this._iSkipRequestOption;break;}default:break;}return Q;},getURIToQueryResultEntries:function(s){var r=this.getURIToQueryResultEntitySet(s);var S=this.getURIQueryOptionValue("$select");var f=this.getURIQueryOptionValue("$filter");var a=this.getURIQueryOptionValue("$orderby");var t=this.getURIQueryOptionValue("$top");var b=this.getURIQueryOptionValue("$skip");var u=r;var q=false;if(S){u+="?$select="+S;q=true;}if(this._oFilterExpression&&f){if(!q){u+="?";q=true;}else{u+="&";}u+="$filter="+f;}if(this._oSortExpression&&a){if(!q){u+="?";q=true;}else{u+="&";}u+="$orderby="+a;}if(this._iTopRequestOption&&t){if(!q){u+="?";q=true;}else{u+="&";}u+="$top="+t;}if(this._iSkipRequestOption&&b){if(!q){u+="?";q=true;}else{u+="&";}u+="$skip="+b;}if(this._bIncludeCount){if(!q){u+="?";q=true;}else{u+="&";}u+="$inlinecount=allpages";}return u;},_oQueryResult:null,_oParameterizationRequest:null,_oAggregationLevel:null,_oMeasures:null,_bIncludeEntityKey:null,_bIncludeCount:null,_oFilterExpression:null,_oSortExpression:null,_iSkipRequestOption:0,_iTopRequestOption:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.ParameterValueSetRequest=function(p){this._init(p);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.ParameterValueSetRequest.prototype={_init:function(p){this._oParameter=p;this._oValueSetResult={};this._oFilterExpression=null;this._oSortExpression=null;},includeParameterText:function(i){if(i!=null){this._oValueSetResult.text=i;}},getFilterExpression:function(){if(this._oFilterExpression==null){var e=this._oParameter.getContainingParameterization().getEntityType();this._oFilterExpression=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.FilterExpression(e.getModel(),e.getSchema(),e);}return this._oFilterExpression;},setFilterExpression:function(f){this._oFilterExpression=f;},getSortExpression:function(){if(this._oSortExpression==null){var e=this._oQueryResult.getEntityType();this._oSortExpression=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.SortExpression(e.getModel(),e.getSchema(),e);}return this._oSortExpression;},setSortExpression:function(s){this._oSortExpression=s;},getURIQueryOptionValue:function(q){var Q=null;switch(q){case"$select":{var s="";s+=(s==""?"":",")+this._oParameter.getProperty().name;if(this._oValueSetResult.text==true&&this._oParameter.getTextProperty()){s+=(s==""?"":",")+this._oParameter.getTextProperty().name;}Q=(s?s:null);break;}case"$filter":{var f=null;if(this._oFilterExpression){f=this._oFilterExpression.getURIFilterOptionValue();}Q=(f?f:null);break;}case"$orderby":{var S=null;if(this._oSortExpression){S=this._oSortExpression.getURIOrderByOptionValue();}Q=(S?S:null);break;}default:break;}return Q;},getURIToParameterValueSetEntries:function(s){var r=null;r=(s?s:"")+"/"+this._oParameter.getContainingParameterization().getEntitySet().getQName();var S=this.getURIQueryOptionValue("$select");var f=this.getURIQueryOptionValue("$filter");var a=this.getURIQueryOptionValue("$orderby");var u=r;var q=false;if(S){u+="?$select="+S;q=true;}if(this._oFilterExpression&&f){if(!q){u+="?";q=true;}else{u+="&";}u+="$filter="+f;}if(this._oSortExpression&&a){if(!q){u+="?";q=true;}else{u+="&";}u+="$orderby="+a;}return u;},_oParameter:null,_oFilterExpression:null,_oSortExpression:null,_oValueSetResult:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.DimensionMemberSetRequest=function(d,p){this._init(d,p);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.DimensionMemberSetRequest.prototype={_init:function(d,p){this._oDimension=d;this._oParameterizationRequest=p;this._oValueSetResult={};this._oFilterExpression=null;this._oSortExpression=null;},setParameterizationRequest:function(p){this._oParameterizationRequest=p;},includeDimensionTextAttributes:function(i,a){if(i!=null){this._oValueSetResult.text=i;}if(a!=null){this._oValueSetResult.attributes=a;}},getFilterExpression:function(){if(this._oFilterExpression==null){var e=this._oDimension.getContainingQueryResult().getEntityType();this._oFilterExpression=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.FilterExpression(e.getModel(),e.getSchema(),e);}return this._oFilterExpression;},setFilterExpression:function(f){this._oFilterExpression=f;},getSortExpression:function(){if(this._oSortExpression==null){var e=this._oQueryResult.getEntityType();this._oSortExpression=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.SortExpression(e.getModel(),e.getSchema(),e);}return this._oSortExpression;},setSortExpression:function(s){this._oSortExpression=s;},hasMasterDataAvailable:function(){return false;},getURIQueryOptionValue:function(q){var Q=null;switch(q){case"$select":{var s="";s+=(s==""?"":",")+this._oDimension.getKeyProperty().name;if(this._oValueSetResult.text==true&&this._oDimension.getTextProperty()){s+=(s==""?"":",")+this._oDimension.getTextProperty().name;}if(this._oValueSetResult.attributes){for(var i=-1,a;a=this._oValueSetResult.attributes[++i];){s+=(s==""?"":",")+this._oDimension.findAttributeByName(a).getName();}}Q=(s?s:null);break;}case"$filter":{var f=null;if(this._oFilterExpression){f=this._oFilterExpression.getURIFilterOptionValue();}Q=(f?f:null);break;}case"$orderby":{var S=null;if(this._oSortExpression){S=this._oSortExpression.getURIOrderByOptionValue();}Q=(S?S:null);break;}default:break;}return Q;},getURIToDimensionMemberEntries:function(s){var r=null;if(this._oDimension.getContainingQueryResult().getParameterization()){if(!this._oParameterizationRequest){throw"Missing parameterization request";}else{r=this._oParameterizationRequest.getURIToParameterizationEntry(s)+"/"+this._oDimension.getContainingQueryResult().getParameterization().getNavigationPropertyToQueryResult();}}else{r=(s?s:"")+"/"+this._oDimension.getContainingQueryResult().getEntitySet().getQName();}var S=this.getURIQueryOptionValue("$select");var f=this.getURIQueryOptionValue("$filter");var a=this.getURIQueryOptionValue("$orderby");var u=r;var q=false;if(S){u+="?$select="+S;q=true;}if(this._oFilterExpression&&f){if(!q){u+="?";q=true;}else{u+="&";}u+="$filter="+f;}if(this._oSortExpression&&a){if(!q){u+="?";q=true;}else{u+="&";}u+="$orderby="+a;}return u;},_oDimension:null,_oParameterizationRequest:null,_oFilterExpression:null,_oSortExpression:null,_oValueSetResult:null};};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.indicatorTileUtils.smartBusinessUtil')){jQuery.sap.declare("sap.ushell.components.tiles.indicatorTileUtils.smartBusinessUtil");sap=sap||{};sap.ushell=sap.ushell||{};sap.ushell.components=sap.ushell.components||{};sap.ushell.components.tiles.indicatorTileUtils=sap.ushell.components.tiles.indicatorTileUtils||{};sap.ushell.components.tiles.indicatorTileUtils.util=sap.ushell.components.tiles.indicatorTileUtils.util||{};sap.ushell.components.tiles.indicatorTileUtils.util=(function(g,$){"use strict";var f=function(){var o={};$.ajax({type:"GET",async:false,dataType:"json",url:"/sap/hba/apps/kpi/s/logic/__token.xsjs",headers:{"X-CSRF-Token":"Fetch"},success:function(d,s,x){o.userName=d.userName;o.token=x.getResponseHeader("X-CSRF-Token");},error:function(){$.sap.log.error("Error Fetching AUTH TOKEN");}});return o;};var a=function(s){var r=[];for(var i=0;i<s.length;i++){r.push(JSON.parse(s[i]));}return r;};var c={};var t={"ANN":"years","WEE":"weeks","DAY":"days","HUR":"hours","MIN":"minutes"};var b={};var h={};return{getScheduledJob:function(k){return b[k];},setScheduledJob:function(k,d){b[k]=d;},isCallInProgress:function(k){return h[k];},setUnsetCallInProgress:function(k,v){h[k]=v;},getTimeUnitMap:function(){return t;},getAuthToken:function(){return f().token;},getHanaUser:function(){return authObject.userName;},getEdmType:function(u,p){var d=null;if(u instanceof sap.ui.model.odata.ODataModel){d=u;}else{d=this.getODataModelByServiceUri(u);}if(d&&d.getServiceMetadata()){var s=d.getServiceMetadata();var e=s.dataServices.schema[0].entityType;if(e){for(var i=0;i<e.length;i++){var k=e[i];var l=k.property;for(var j=0;j<l.length;j++){var m=l[j];if(m.name==p){return m.type;}}}}}return null;},getODataModelByServiceUri:function(s){s=this.addSystemToServiceUrl(s);if(!c[s]){var m=new sap.ui.model.odata.ODataModel(s,{loadMetadataAsync:true,json:true});c[s]=m;}return c[s];},addSystemToServiceUrl:function(u,s){jQuery.sap.log.info("Hana Adapter --> Add System to Service Url");if(sap.ushell&&sap.ushell.Container){if(s){u=sap.ushell.Container.getService("URLParsing").addSystemToServiceUrl(u,s);}else{u=sap.ushell.Container.getService("URLParsing").addSystemToServiceUrl(u);}}return u;},isCacheValid:function(d,e,i,j,k){var l=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(d);if(!l){return false;}else if(!(i&&Number(i))){return true;}else{var m=this.getMillisecond(i,t[j]);if(jQuery.type(l.CachedTime)=="date"){var n=l.CachedTime&&l.CachedTime.getTime();}else{var n=l.CachedTime&&parseInt(l.CachedTime.substr(6),10);}var o=this.getUTCDate();return(n>=e&&m>=(o-n)&&!k);}},getUTCDate:function(){var n=new Date();var u=new Date(n.getTime()+n.getTimezoneOffset()*60000);return n;},getMantissaLength:function(n){var N=n.toString();var i=0;if(n<0){i=1;}return(N.indexOf('.')===-1)?(n<0?N.length-1:N.length):N.substring(i,N.indexOf('.')).length;},getLocaleFormattedValue:function(n,s,d,i,e){jQuery.sap.require("sap.ui.core.format.NumberFormat");i=i||false;e=e||null;if(i){return sap.ui.core.format.NumberFormat.getCurrencyInstance({style:"short",showMeasure:false}).format(n,e);}var D=2;var F={style:"short"};var N;if(!(d==-1||d==null)){F.shortDecimals=Number(d);F.minFractionDigits=Number(d);F.maxFractionDigits=Number(d);}var v=sap.ui.core.format.NumberFormat.getInstance(F);if(s==-2){if(n>9999){N="????";}else if(n<0.001){N="0";}else{if(n.toString().indexOf('.')!=-1){N=Number(n).toFixed(4-n.toString().indexOf('.'));}else{N=Number(n);}N=v.format(N);}}else if(d==-1||d==null){var m=this.getMantissaLength(n);if(!(m%3)){D=1;}if(m%3===1){D=3;}if(m%3===2){D=2;}if(Math.abs(n)%Math.pow(10,m-1)==0){D=0;}else if((Math.abs(n)%Math.pow(10,m-1))<6*Math.pow(10,m-4)){D=0;}v=sap.ui.core.format.NumberFormat.getInstance({style:"short",shortDecimals:D});N=v.format(n);}else{N=v.format(n);}return N;},getPlatform:function(p){return(jQuery.sap.getUriParameters().get("sb_metadata")||p||"HANA").toUpperCase();},getRunTimeUri:function(p){if(p.toUpperCase()=="HANA"){return"/sap/hba/r/sb/core/odata/runtime/SMART_BUSINESS.xsodata";}return"/sap/opu/odata/SSB/SMART_BUSINESS_RUNTIME_SRV";},getTileTitleSubtitle:function(C){var d={};if(C.bag&&C.bag.getBagIds()&&C.bag.getBagIds().length){d.title=C.bag.getBag("sb_tileProperties").getText("title")||C.bag.getBag("sb_tileProperties").getProperty("title")||C.preview.getTitle();d.subTitle=C.bag.getBag("sb_tileProperties").getText("description")||C.bag.getBag("sb_tileProperties").getProperty("description")||C.preview.getDescription();}else{d.title=C.preview.getTitle();d.subTitle=C.preview.getDescription();}return d;},scheduleFetchDataJob:function(i){var d;if(this.getView().getViewName().indexOf("DualTile")!==-1){d=this.oKpiTileView.oConfig;}else{d=this.oConfig;}var k=d.TILE_PROPERTIES.id+"data";var r=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(k);if(r){clearTimeout(r);r=undefined;}var t=sap.ushell.components.tiles.indicatorTileUtils.util.getTimeUnitMap();var e=sap.ushell.components.tiles.indicatorTileUtils.util.getCachingTime(d);var j=sap.ushell.components.tiles.indicatorTileUtils.util.getCachingTimeUnit(d);var l=sap.ushell.components.tiles.indicatorTileUtils.util.getMillisecond(e,t[j]);if(jQuery.type(this.cacheTime)=="date"){var m=this.cacheTime;}else{var m=new Date(parseInt(this.cacheTime.substr(6),10));}var n=l-(sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate()-m);if(n<=0){n=0;}else if(n>2147483646){n=2147483646;}if(!i){n=300000;}if(this.getView().getViewName().indexOf("DualTile")!==-1){r=setTimeout(this.refreshPress.bind(this),n);}else{r=setTimeout(this.refreshHandler.bind(this,false,true),n);sap.ushell.components.tiles.indicatorTileUtils.util.setScheduledJob(k,r);}this.updateDatajobScheduled=true;},scheduleTimeStampJob:function(i){var k=this.oConfig.TILE_PROPERTIES.id+"time";var r=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(k);if(r){clearTimeout(r);r=undefined;}if(jQuery.type(this.cacheTime)=="date"){var d=this.cacheTime;}else{var d=new Date(parseInt(this.cacheTime.substr(6),10),13);}var e=sap.ushell.components.tiles.indicatorTileUtils.util.getTimeDifference(sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate()-d);r=setTimeout(this.setTimeStamp.bind(this,this.cacheTime),e.timer);sap.ushell.components.tiles.indicatorTileUtils.util.setScheduledJob(k,r);this.updateTimeStampjobScheduled=true;},getBoolValue:function(v){var r=false;if(typeof v=="boolean"&&v){r=true;}return r;},getTimeDifference:function(d){var r={};if(d){var m=this.getMinutes(d);var e=this.getHours(d);var i=this.getDays(d);if(m<5){r.time=0;r.unit="minutes";r.timer=Math.round(this.getMillisecond(5-m,"minutes"));}else if(m>=5&&m<60){if(m<10){r.time=5;}else{r.time=(m-(m%10));}r.unit="minutes";r.timer=Math.round(this.getMillisecond(10-(m%10),"minutes"));}else if(e>=1&&e<24){r.unit="hours";r.time=(e-(e%1));r.timer=Math.round(this.getMillisecond(1-(e%1),"hours"));}else if(i>=1&&i<2){r.unit="days";r.time=(i-(i%1));r.timer=Math.round(this.getMillisecond(1-(i%1),"days"));}else{r.unit="days";r.time=(i-(i%1));r.timer=this.getMillisecond(2,"days");}}else{r.timer=6000;r.unit="days";r.timer=2000;}return r;},getMillisecond:function(d,u){var r;switch(u){case"seconds":r=d*1000;break;case"minutes":r=d*60*1000;break;case"hours":r=d*60*60*1000;break;case"days":r=d*24*60*60*1000;break;case"weeks":r=d*7*24*60*60*1000;break;case"months":r=d*4*7*24*60*60*1000;break;case"years":r=d*12*4*7*24*60*60*1000;break;}return r;},getSeconds:function(d){return(d/1000);},getMinutes:function(d){return(this.getSeconds(d)/60);},getHours:function(d){return(this.getMinutes(d)/60);},getDays:function(d){return(this.getHours(d)/24);},getWeeks:function(d){return(this.getDays(d)/7);},getMonths:function(d){return(this.getWeeks(d)/4);},getYears:function(d){return(this.getMonths(d)/12);},getCachingTime:function(C){return((C.CACHINGTIME&&Number(C.CACHINGTIME))||(C.TILE_PROPERTIES.cachingTime&&Number(C.TILE_PROPERTIES.cachingTime)));},getCachingTimeUnit:function(C){return(C.CACHINGUNIT||C.TILE_PROPERTIES.cachingTimeUnit);},getFrontendCacheQuery:function(d,u,p,T){var e;try{var i=T.url.addSystemToServiceUrl('/sap/opu/odata/SSB/SMART_BUSINESS_RUNTIME_SRV');e=this.getODataModelByServiceUri(i);var i="/CacheParameters(P_CacheType=1)/Results";return{oModel:e,uri:i};}catch(j){jQuery.sap.log.error("FrontEnd cache Metadata failed");return null;}},isDualTile:function(C){var d=C&&C.TILE_PROPERTIES&&C.TILE_PROPERTIES.tileType;if(d.indexOf("DT-")==-1){return false;}return true;},writeFrontendCacheByChipAndUserId:function(T,d,e,u,i){try{var j=T.url.addSystemToServiceUrl("/sap/opu/odata/SSB/SMART_BUSINESS_RUNTIME_SRV/");var k=this.getODataModelByServiceUri(j);var l="/CacheData";k.create(l,e,{async:true,success:function(e){jQuery.sap.log.info("cache write successFully");i(e);},error:function(){jQuery.sap.log.error("cache update failed");i(null);}});}catch(m){jQuery.sap.log.error(m);}},getFrontendCache:function(C,T){var d=this;var e=sap.ushell.components.tiles.indicatorTileUtils.util.FRONTEND_CACHE_DEFERRED||jQuery.Deferred();var i=C&&C.TILE_PROPERTIES&&C.TILE_PROPERTIES.id;var j=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(i);if(j){sap.ushell.components.tiles.indicatorTileUtils.util.FRONTEND_CACHE_DEFERRED.resolve(true);}else if(sap.ushell.components.tiles.indicatorTileUtils.util.FRONTEND_CACHE_DEFERRED){return sap.ushell.components.tiles.indicatorTileUtils.util.FRONTEND_CACHE_DEFERRED.promise();}else{sap.ushell.components.tiles.indicatorTileUtils.util.FRONTEND_CACHE_DEFERRED=e;this.getKpiChipsOnPage(i,function(i,p){if(p){var k=d.getFrontendCacheQuery(p,sap.ushell.Container.getUser().getId(),p,T);if(k){var l=k.oModel;var m=k.uri;var n=false;var o=l.read(m,null,null,true,function(q){if(q&&q.results&&q.results instanceof Array&&q.results.length){jQuery.each(q.results,function(r,s){sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(s.ChipId,s);});}if(sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(i)){n=true;}sap.ushell.components.tiles.indicatorTileUtils.util.FRONTEND_CACHE_DEFERRED.resolve(n);},function(q){if(q&&q.response){jQuery.sap.log.error(q.message+" : "+q.request.requestUri);}sap.ushell.components.tiles.indicatorTileUtils.util.FRONTEND_CACHE_DEFERRED.reject();});}else{sap.ushell.components.tiles.indicatorTileUtils.util.FRONTEND_CACHE_DEFERRED.reject();}}else{sap.ushell.components.tiles.indicatorTileUtils.util.FRONTEND_CACHE_DEFERRED.resolve(false);}});}return sap.ushell.components.tiles.indicatorTileUtils.util.FRONTEND_CACHE_DEFERRED.promise();},getModelerRuntimeServiceModel:function(){return this.getODataModelByServiceUri("/sap/hba/apps/kpi/s/odata/smart_business_runtime_services.xsodata");},getSapFontErrorCode:function(){return String.fromCharCode(0xe0b1);},getSapFontBusyCode:function(){return String.fromCharCode(0xe1f2);},prepareFilterStructure:function(d,e){var v=[];if(e){d=d.concat(e);}for(var i=0;i<d.length;i++){var p={};p.comparator=d[i].OPERATOR;p.filterPropertyName=d[i].NAME;if(d[i].ID){p.id=d[i].ID;}p.type=d[i].TYPE;p.value=d[i].VALUE_1;p.valueTo=d[i].VALUE_2;v.push(p);}return v;},getODataModelByServiceUriFromChipAPI:function(s,T){s=T.url.addSystemToServiceUrl(s);if(!c[s]){var m=new sap.ui.model.odata.ODataModel(s,true);c[s]=m;}return c[s];},getFilterFromRunTimeService:function(C,T,s,e){var p=C.TILE_PROPERTIES.sb_metadata;var K=this.getODataModelByServiceUriFromChipAPI(this.getRunTimeUri(p),T);var d="ID eq '#EVALUATIONID'".replace("#EVALUATIONID",C.EVALUATION.ID);var k=K.read("/EVALUATION_FILTERS",null,{"$filter":d},true,function(i){var j=[];if(i.results.length){j=i.results;}s.call(this,j);},e);return k;},findTextPropertyForDimension:function(u,d,i){try{var o=this._getOData4AnalyticsObject(u);var q=o.findQueryResultByName(d);var D=q.findDimensionByName(i);if(D.getTextProperty()){return D.getTextProperty().name;}else{return i;}}catch(e){$.sap.log.error("Error Fetching Text Property for "+i+" : "+e.toString());}},getEvalValueMeasureName:function(C,d,r){var e=C.EVALUATION_VALUES;for(var i=0;i<e.length;i++){if(e[i].TYPE==d){if(r==="FIXED"){return e[i].FIXED;}else{return e[i].COLUMN_NAME;}}}},getSemanticColorName:function(d){var s="";if(d=="Error"){s="sb.error";}if(d=="Neutral"){s="sb.neutral";}if(d=="Critical"){s="sb.critical";}if(d=="Good"){s="sb.good";}return s;},setTooltipInTile:function(C,d,v){var e="";var r=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();if(d=="NT"||d=="DT"){if(v.status){e+=r.getText("sb.status")+": "+r.getText(v.status)+"\n";}if(v.actual){e+=r.getText("sb.actual")+": "+v.actual+"\n";}if(v.target){e+=r.getText("sb.target")+": "+v.target+"\n";}if(v.cH){e+=r.getText("sb.ch")+": "+v.cH+"\n";}if(v.wH){e+=r.getText("sb.wh")+": "+v.wH+"\n";}if(v.wL){e+=r.getText("sb.wl")+": "+v.wL+"\n";}if(v.cL){e+=r.getText("sb.cl")+": "+v.cL+"\n";}}if(d=="CONT"||d=="COMP"){if(v.measure&&d=="CONT"){if(v&&v.contributionTile.contributionTile&&v.contributionTile.contributionTile[1]==="asc"){e+=r.getText("sb.bottomn")+": "+v.contributionTile[0]+"\n";}else if(v&&v.contributionTile.contributionTile&&v.contributionTile.contributionTile.length){e+=r.getText("sb.topn")+": "+v.contributionTile[0]+"\n";}}if(v.m1&&((v.v1==undefined||v.v1==null)?false:v.v1.toString())&&v.c1){e+=v.m1+": "+v.v1+" "+r.getText(v.c1)+"\n";}if(v.m2&&((v.v2==undefined||v.v2==null)?false:v.v2.toString())&&v.c2){e+=v.m2+": "+v.v2+" "+r.getText(v.c2)+"\n";}if(v.m3&&((v.v3==undefined||v.v3==null)?false:v.v3.toString())&&v.c3){e+=v.m3+": "+v.v3+" "+r.getText(v.c3)+"\n";}}C&&C.setTooltip&&C.setTooltip(e);},_getFormattedTileProperties:function(d){d=d||{};var p=["sb_metadata","sb_navigation","sb_catalog"];var e=false;for(var i=0;!e&&i<p.length;i++){e=e||jQuery.sap.getUriParameters().get(p[i])||d[p[i]];}d.sb_metadata=(jQuery.sap.getUriParameters().get("sb_metadata")||d.sb_metadata||"HANA").toLowerCase();d.sb_navigation=(jQuery.sap.getUriParameters().get("sb_navigation")||d.sb_navigation||"abap").toLowerCase();d.sb_catalog=(jQuery.sap.getUriParameters().get("sb_catalog")||d.sb_catalog||"HANA").toLowerCase();d.isPlatformInfoPresent=e;return d;},getParsedChip:function(C,i,d){try{var p={};var e=JSON.parse(C);var j=JSON.parse(e.TILE_PROPERTIES).evaluationId||"";if(e.TILE_PROPERTIES){var k=JSON.parse(e.TILE_PROPERTIES);if(k&&(k.instanceId||k.catalogId)){return false;}}var l=this;if(e.blankTile){p["BLANKTILE"]=e.blankTile;}if(e.cachingTime){p["CACHINGTIME"]=e.cachingTime;}if(e.cachingTimeUnit){p["CACHINGUNIT"]=e.cachingTimeUnit;}if(e.TAGS){p["TAGS"]=JSON.parse(e.TAGS);}if(e.ADDITIONAL_FILTERS){p["ADDITIONAL_FILTERS"]=JSON.parse(e.ADDITIONAL_FILTERS);}if(e.ADDITIONAL_APP_PARAMETERS){p["ADDITIONAL_APP_PARAMETERS"]=JSON.parse(e.ADDITIONAL_APP_PARAMETERS);}p.TILE_PROPERTIES=this._getFormattedTileProperties(JSON.parse(e.TILE_PROPERTIES));var P=p.TILE_PROPERTIES.sb_metadata;if(e.EVALUATION_FILTERS){p["EVALUATION_FILTERS"]=JSON.parse(e.EVALUATION_FILTERS);if(e.EVALUATION_VALUES){p["EVALUATION_VALUES"]=JSON.parse(e.EVALUATION_VALUES);if(e.EVALUATION){p.EVALUATION=JSON.parse(e.EVALUATION);if(d){d(p);}else{return p;}}else{if(!i){l.getEvaluationDetailsFromRunTimeService("/EVALUATIONS",P,j,function(n){p.EVALUATION=n;if(d){d(p);}else{return p;}});}else{if(d){d(p);}else{return p;}}}}else{if(!i){l.getEvaluationDetailsFromRunTimeService("/EVALUATION_VALUES",P,j,function(n){p["EVALUATION_VALUES"]=n;if(e.EVALUATION){p.EVALUATION=JSON.parse(e.EVALUATION);if(d){d(p);}else{return p;}}else{l.getEvaluationDetailsFromRunTimeService("/EVALUATIONS",P,j,function(n){p.EVALUATION=n;if(d){d(p);}else{return p;}});}});}else{if(d){d(p);}else{return p;}}}}else if(i){if(d){d(p);}else{return p;}}else{l.getEvaluationDetailsFromRunTimeService("/EVALUATION_FILTERS",P,j,function(n){p["EVALUATION_FILTERS"]=n;if(e.EVALUATION_VALUES){p["EVALUATION_VALUES"]=JSON.parse(e.EVALUATION_VALUES);if(e.EVALUATION){p.EVALUATION=JSON.parse(e.EVALUATION);if(d){d(p);}else{return p;}}else{l.getEvaluationDetailsFromRunTimeService("/EVALUATIONS",P,j,function(n){p.EVALUATION=n;if(d){d(p);}else{return p;}});}}else{l.getEvaluationDetailsFromRunTimeService("/EVALUATION_VALUES",P,j,function(n){p["EVALUATION_VALUES"]=n;if(e.EVALUATION){p.EVALUATION=JSON.parse(e.EVALUATION);if(d){d(p);}else{return p;}}else{l.getEvaluationDetailsFromRunTimeService("/EVALUATIONS",P,j,function(n){p.EVALUATION=n;if(d){d(p);}else{return p;}});}});}});}}catch(m){return false;}},getEvaluationDetailsFromRunTimeService:function(e,p,i,d){var K=this.getODataModelByServiceUri(this.getRunTimeUri(p));var j="ID eq '#EVALUATIONID'".replace("#EVALUATIONID",i);var k=K.read(e,null,{"$filter":j},true,function(l){var m=[];if(l.results.length){m=l.results;}d.call(this,m);});},getNavigationTarget:function(C,s){var d=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService;var o=d&&d("CrossApplicationNavigation");var e;var p={};p["evaluationId"]=C.EVALUATION.ID;p["chipId"]=C.TILE_PROPERTIES.id;if(s){p["sap-system"]=s;}p["tileType"]=C.TILE_PROPERTIES.tileType;if(C.TILE_PROPERTIES.dimension){p["dimension"]=C.TILE_PROPERTIES.dimension;}if(C.TILE_PROPERTIES.storyId){p["storyId"]=C.TILE_PROPERTIES.storyId;}if(C.TILE_PROPERTIES.apfConfId){p["sap-apf-configuration-id"]=C.TILE_PROPERTIES.apfConfId;}if(C.TILE_PROPERTIES.isPlatformInfoPresent){p["sb_metadata"]=C.TILE_PROPERTIES.sb_metadata;p["sb_navigation"]=C.TILE_PROPERTIES.sb_navigation;p["sb_catalog"]=C.TILE_PROPERTIES.sb_catalog;}if(C.ADDITIONAL_APP_PARAMETERS){for(e in C.ADDITIONAL_APP_PARAMETERS){if(C.ADDITIONAL_APP_PARAMETERS.hasOwnProperty(e)){if(C.ADDITIONAL_APP_PARAMETERS[e].constructor==Array){var k=C.ADDITIONAL_APP_PARAMETERS[e];for(var i=0;i<k.length;i++){p[e]=k[i];}}else{p[e]=C.ADDITIONAL_APP_PARAMETERS[e];}}}}var l=o&&o.hrefForExternal({target:{semanticObject:C.TILE_PROPERTIES.semanticObject,action:C.TILE_PROPERTIES.semanticAction},params:p})||"";if(C.ADDITIONAL_FILTERS){var m=C.ADDITIONAL_FILTERS;var n="&";for(var j=0;j<m.length;j++){if(m[j].OPERATOR==="EQ"){n=n+"/"+m[j].NAME+"="+m[j].VALUE_1;}}l+=n;}return l;},getChipTitle:function(C){var d="";if(C){var e=C.EVALUATION||{};d=e.INDICATOR_TITLE||"";}return d;},getstringifyTileConfig:function(C){var s={};s.EVALUATION=JSON.stringify(C.EVALUATION);s.EVALUATION_FILTERS=JSON.stringify(C.EVALUATION_FILTERS);s.EVALUATION_VALUES=JSON.stringify(C.EVALUATION_VALUES);s.TILE_PROPERTIES=JSON.stringify(C.TILE_PROPERTIES);return JSON.stringify(s);},getChipSubTitle:function(C){var T="";if(C){var d=C.EVALUATION||{};T=d.TITLE||"";}return T;},getFormattingMetadata:function(u,e,p){var d={};d._hasCurrency=false;d._hasSapText=false;var m=null;if(u instanceof sap.ui.model.odata.ODataModel){m=sap.ui.model.analytics.odata4analytics.Model.ReferenceByModel(u);}else{var j=this.getODataModelByServiceUri(u);m=sap.ui.model.analytics.odata4analytics.Model.ReferenceByModel(j);}var O=new sap.ui.model.analytics.odata4analytics.Model(m);var q=O.findQueryResultByName(e);var k=q.getAllMeasures();if(k[p]){var s=(k[p]._oTextProperty&&k[p]._oTextProperty.name)?k[p]._oTextProperty.name:"";if(s!=""){d._hasSapText=true;d._sapTextColumn=s;}else if(k[p].hasOwnProperty("_oUnitProperty")){var l=k[p]._oUnitProperty.extensions;for(var i=0;i<k[p]._oUnitProperty.extensions.length;i++){if(l[i].name==="semantics"&&l[i].value==="currency-code"){d._hasCurrency=true;d._currencyColumn=k[p]._oUnitProperty.name;}}}}return d;},prepareQueryServiceUri:function(u,d,m,n,v,o,p){function _(U){return U.replace(/'/g,"''");}var q=null;try{var r=null;if(u instanceof sap.ui.model.odata.ODataModel){r=sap.ui.model.analytics.odata4analytics.Model.ReferenceByModel(u);}else{var s=this.getODataModelByServiceUri(u);r=sap.ui.model.analytics.odata4analytics.Model.ReferenceByModel(s);}var O=new sap.ui.model.analytics.odata4analytics.Model(r);var Q=O.findQueryResultByName(d);var w=new sap.ui.model.analytics.odata4analytics.QueryResultRequest(Q);if(m){w.setMeasures(m.split(","));w.includeMeasureRawFormattedValueUnit(null,true,true,true);}if(n){if(typeof n=="string"){q=n;q=q.split(",");}for(var i=0;i<q.length;i++){w.addToAggregationLevel([q[i]]);var x=Q.getAllDimensions();if(x[q[i]].getTextProperty()!=null){w.includeDimensionKeyTextAttributes([q[i]],true,true,null);}}}if(v&&v.length){var A=[];var B=[];for(var i=0,l=v.length;i<l;i++){var C=v[i];if(C.type==="PA"){B.push(C);}else if(C.type==="FI"){A.push(C);}}function D(U){var V=U.toJSON();var W=V.charAt(V.length-1).toUpperCase();if(W.charCodeAt(0)>=65&&W.charCodeAt(0)<=90){V=V.slice(0,-1);}return V;};function E(U){if(U){try{if(U==+U){U=window.parseInt(U);}var V=new Date(U);var W=V.getTime();if(isNaN(W)){return U;}else{return D(V);}}catch(e){jQuery.sap.log.error(e);}}return U;};if(A.length){var F=w.getFilterExpression();for(var i=0,l=A.length;i<l;i++){var C=A[i];if(this.getEdmType(u,C.filterPropertyName)=="Edm.DateTime"){C.value=E(C.value);C.valueTo=E(C.valueTo);}if(C.comparator==sap.ui.model.FilterOperator.BT){F.addCondition(C.filterPropertyName,C.comparator,_(C.value),C.valueTo);}else{var G=C.value.split(",");for(var j=0,k=G.length;j<k;j++){F.addCondition(C.filterPropertyName,C.comparator,_(G[j].replace(/\^\|/g,",")),null);}}}}if(B.length){if(Q.getParameterization()){var P=new sap.ui.model.analytics.odata4analytics.ParameterizationRequest(Q.getParameterization());var H=Q.getParameterization();var I,J,K,L,M;for(var y=0,z=B.length;y<z;y++){I=B[y];J=H.findParameterByName(I.filterPropertyName);if(J.isIntervalBoundary()===true&&J.isLowerIntervalBoundary()===true){M=J.getPeerIntervalBoundaryParameter();for(var i=0,l=B.length;i<l;i++){if(B[i].filterPropertyName===M.getName()){L=_(B[i].value);break;}}K=_(I.value);if(L){P.setParameterValue(I.filterPropertyName,K,L);}}else if(J.isIntervalBoundary()===true&&J.isLowerIntervalBoundary()===false){jQuery.sap.log.info("Future development");}else{P.setParameterValue(I.filterPropertyName,_(I.value));}}w.setParameterizationRequest(P);}}}var N=w.getURIToQueryResultEntries();if(o&&o.length){N=N+"&$orderby=";for(var y=0,z=o.length;y<z;y++){var R=o[y].sortOrder||"asc";if(R){N+=o[y].element+" "+R+",";}}N=N.slice(0,N.length-1);}if(p){N=N+"&$top="+p;}var S=Q.getAllMeasures();var T=[];for(var i=0;i<m.split(",").length;i++){T.push(S[m.split(",")[i]].getUnitProperty());}return{uri:N,model:O.getODataModel(),unit:T};}catch(e){$.sap.log.error("Error Preparing Query Service Uri using OData4Analytics Library : "+e.toString());if(arguments.length){$.sap.log.error("Arguments Passed to this function");$.sap.log.error(arguments[0]+","+arguments[1]+","+arguments[2]+","+arguments[3]);}else{$.sap.log.error("NO Arguments passed to this function");}return null;}},_getOData4AnalyticsObject:function(u){var m=null;if(u instanceof sap.ui.model.odata.ODataModel){m=u;}else if(typeof u=="string"){m=this.getODataModelByServiceUri(u);}else{throw new Error("Invalid Input to Create ODataModel Object : "+u);}var O=new sap.ui.model.analytics.odata4analytics.Model(sap.ui.model.analytics.odata4analytics.Model.ReferenceByModel(m));return O;},getAllEntitySet:function(u){var d=[];try{var o=this._getOData4AnalyticsObject(u);d=o.getAllQueryResultNames();}catch(e){$.sap.log.error("Error fetching Enity Set : "+e.toString());}return d;},getAllMeasures:function(u,d){var m=[];try{var o=this._getOData4AnalyticsObject(u);var q=o.findQueryResultByName(d);m=q.getAllMeasureNames();}catch(e){$.sap.log.error("Error Fetching All Measures : "+e.toString());}return m;},getAllMeasuresWithLabelText:function(u,d){var m=[];try{var o=this._getOData4AnalyticsObject(u);var q=o.findQueryResultByName(d);var j=q.getAllMeasureNames();for(var i=0;i<j.length;i++){var k=j[i];g.oMeasure=q.findMeasureByName(k);m.push({key:k,value:oMeasure.getLabelText()});}}catch(e){$.sap.log.error("Error Fetching All Measures : "+e.toString());}return m;},getAllDimensions:function(u,d){function i(l,m){var n=0,p=0;var r=[];while(n<l.length&&p<m.length){if(l[n]<m[p]){n++;}else if(l[n]>m[p]){p++;}else{r.push(l[n]);n++;p++;}}return r;}var j=[];var F=[];try{var o=this._getOData4AnalyticsObject(u);var q=o.findQueryResultByName(d);var k=q.getEntityType();F=k.getFilterablePropertyNames();j=q.getAllDimensionNames();if(F&&F.length){j=i(F.sort(),j.sort());}}catch(e){$.sap.log.error("Error Fetching All Dimesions : "+e.toString());}return j;},getAllDimensionsWithLabelText:function(u,d){var j=[];try{var o=this._getOData4AnalyticsObject(u);var q=o.findQueryResultByName(d);var k=q.getAllDimensionNames();for(var i=0;i<k.length;i++){var l=k[i];var D=q.findDimensionByName(l);var m=null;if(D.getTextProperty()!=null){m=D.getTextProperty().name;}j.push({key:l,value:D.getLabelText(),textProperty:m});}}catch(e){$.sap.log.error("Error Fetching All Dimesions : "+e.toString());}return j;},getAllInputParams:function(u,d){var i=[];try{var o=this._getOData4AnalyticsObject(u);var q=o.findQueryResultByName(d);if(q.getParameterization()){var p=q.getParameterization();i=p.getAllParameterNames();}}catch(e){$.sap.log.error("Error Fetching Input Params : "+e.toString());}return i;},getAllInputParamsWithFlag:function(u,d){var j=[];try{var o=this._getOData4AnalyticsObject(u);var q=o.findQueryResultByName(d);if(q.getParameterization()){var p=q.getParameterization();var k=p.getAllParameterNames();for(var i=0;i<k.length;i++){var l=k[i];var m=p.findParameterByName(l);j.push({name:l,optional:m.isOptional()});}}}catch(e){$.sap.log.error("Error Fetching Input Params : "+e.toString());}return j;},formatOdataObjectToString:function(v){if(v&&v.constructor==Object){if(v.__edmType=="Edm.Time"){var m=v.ms;var s=Math.floor((m/1000)%60);var d=Math.floor((m/60000)%60);var e=Math.floor((m/3600000)%24);return e+"H"+d+"M"+s+"S";}}return v;},generateCombinations:function(d){function e(k,s){while(s.length<k){s='0'+s;}return s;}var m=Math.pow(2,d.length);var r=[];var j=0;while(m>1){var s=(m-1).toString(2);s=e(d.length,s);r[j]=[];for(var i=0;i<s.length;i++){if(Number(s[i])){r[j].push(d[i]);}}m--;j++;}return r;},logError:function(e,C){if(e=="no data"&&C){var r=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();C.setFailedText(r.getText("sb.noData"));}jQuery.sap.log.error(e.toString());},numberOfLeadingZeros:function(n){n=String(n);var d=0;var e=n.indexOf('.');if(e==-1){return 0;}if(Number(n.split('.')[0])!=0){return 0;}var i=e+1;while(n[i++]=='0'){++d;}return d;},formatValue:function(v,s,M){M=M||3;var u={3:"K",6:"M",9:"B",12:"T",0:""};u["-3"]="m";u["-6"]="u";u["-9"]="n";u["-12"]="t";u["-2"]="%";var d,p,e;d=Number(v).toPrecision(M);var z=this.numberOfLeadingZeros(d);if(z>0&&s<0){p=d*Math.pow(10,z+M);e=-(z+M);}else{p=Number(d.split("e")[0]);e=Number(d.split("e")[1])||0;}if(!v&&v!=0){return{value:"",unitPrefix:""};}if(s>=0){if(e%3!=0){if(e%3==2){if(e+1==s){e=e+1;p=p/10;}else{e=e-2;p=p*100;}}else{if(e+2==s){e=e+2;p=p/100;}else{e--;p=p*10;}}}else if(e==15){p=p*1000;e=12;}}else{if(s=="-2"){var x=this.formatValue((v*100),0);}else if(e>=0&&v<10&&s=="-3"){p=v*Math.pow(10,3);e=-3;}else if(e>=0){return this.formatValue(v,0);}else{e=Math.abs(e);s=Math.abs(s);if(s>e){p=p/(Math.pow(10,e%3));e=e-(e%3);}else{var i=e-s;p=p/(Math.pow(10,i));e=e-i;}e=0-e;}}p+="";if(s=="-2"){var j=(x.unitPrefix=="")?Number(x.value+"").toFixed(4-(x.value+"").indexOf('.')):Number(x.value+"").toFixed(3-(x.value+"").indexOf('.'));return{value:Number(j),unitPrefix:(x.unitPrefix)+u[-2]};}p=Number(p).toFixed(4-p.indexOf('.'));return{value:Number(p),unitPrefix:u[e]};},getKpiChipsOnPage:function(d,e){var i=[];var j=this;var l=sap.ushell.Container.getService("LaunchPage");l.getGroups().done(function(G){if(G&&G instanceof Array&&G.length){jQuery.sap.log.info("Group Chip fetch");}e(d,i);});},isSmartbusinessChipAndCachable:function(d){var C=this.getParsedChip(d&&d.getConfigurationParameter("tileConfiguration"));return(C&&C.TILE_PROPERTIES&&C.TILE_PROPERTIES.tileType&&this.getCachingTime(C));},getHanaClient:function(){var e;var i=sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED||jQuery.Deferred();var j=sap.ushell.components.tiles.indicatorTileUtils.cache.getCacheHanaClient();if(j!=undefined){e=j;sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED.resolve(e);}else if(sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED){return sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED.promise();}else{sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED=i;jQuery.ajax({type:"GET",async:false,dataType:"json",url:"/sap/hba/r/sb/core/logic/GetSessionClient.xsjs",success:function(d,s,x){e=d.sessionClient;sap.ushell.components.tiles.indicatorTileUtils.cache.setCacheHanaClient(e);sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED.resolve(e);},error:function(d,k,l){jQuery.sap.log.error(d.responseText);jQuery.sap.log.error("session client call failed");sap.ushell.components.tiles.indicatorTileUtils.cache.setCacheHanaClient(null);sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED.reject();}});}return sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED.promise();},abortPendingODataCalls:function(d){try{if(d){d.abort();}}catch(e){this.logError(e);}}};})(window,jQuery);sap.ushell.components.tiles.indicatorTileUtils.cache=(function(){"use strict";var B={};var K={};var s="HANA_CLIENT";return{getCacheHanaClient:function(){return B[s];},setCacheHanaClient:function(d){B[s]=d;},getEvaluationById:function(k){return this.getEvaluationByChipId(k);},getEvaluationByChipId:function(k){if(B[k]){return B[k];}return null;},setEvaluationById:function(k,d){B[k]=d;},getKpivalueById:function(k){if(K[k]){return K[k];}return null;},setKpivalueById:function(k,d){K[k]=d;}};})();};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.indicatorcomparison.ComparisonTile.view')){jQuery.sap.declare('sap.ushell.components.tiles.indicatorcomparison.ComparisonTile.view');(function(){"use strict";jQuery.sap.require('sap.ui.model.analytics.odata4analytics');sap.ui.getCore().loadLibrary("sap.suite.ui.commons");sap.ui.jsview("sap.ushell.components.tiles.indicatorcomparison.ComparisonTile",{getControllerName:function(){return"sap.ushell.components.tiles.indicatorcomparison.ComparisonTile";},createContent:function(c){this.setHeight('100%');this.setWidth('100%');var t=this;t.tileData;t.oGenericTileData={};t.oCmprsDataTmpl=new sap.suite.ui.commons.ComparisonData({title:"{title}",value:"{value}",color:"{color}",displayValue:"{displayValue}"});t.oCmprsChrtTmpl=new sap.suite.ui.commons.ComparisonChart({size:"{/size}",scale:"{/scale}",data:{template:t.oCmprsDataTmpl,path:"/data"}});t.oNVConfS=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerComp}",content:t.oCmprsChrtTmpl});t.oGenericTile=new sap.suite.ui.commons.GenericTile({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[t.oNVConfS]});t.oGenericTileModel=new sap.ui.model.json.JSONModel();t.oGenericTileModel.setData(t.oGenericTileData);t.oGenericTile.setModel(t.oGenericTileModel);return t.oGenericTile;}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.indicatorcontribution.ContributionTile.view')){jQuery.sap.declare('sap.ushell.components.tiles.indicatorcontribution.ContributionTile.view');(function(){"use strict";jQuery.sap.require('sap.ui.model.analytics.odata4analytics');sap.ui.getCore().loadLibrary("sap.suite.ui.commons");sap.ui.jsview("sap.ushell.components.tiles.indicatorcontribution.ContributionTile",{getControllerName:function(){return"sap.ushell.components.tiles.indicatorcontribution.ContributionTile";},createContent:function(c){this.setHeight('100%');this.setWidth('100%');var t=this;t.tileData;t.oGenericTileData={};t.oCmprsDataTmpl=new sap.suite.ui.commons.ComparisonData({title:"{title}",value:"{value}",color:"{color}",displayValue:"{displayValue}"});t.oCmprsChrtTmpl=new sap.suite.ui.commons.ComparisonChart({size:"{/size}",scale:"{/scale}",data:{template:t.oCmprsDataTmpl,path:"/data"}});t.oNVConfS=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerComp}",content:t.oCmprsChrtTmpl});t.oGenericTile=new sap.suite.ui.commons.GenericTile({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[t.oNVConfS]});t.oGenericTileModel=new sap.ui.model.json.JSONModel();t.oGenericTileModel.setData(t.oGenericTileData);t.oGenericTile.setModel(t.oGenericTileModel);return t.oGenericTile;}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.indicatordeviation.DeviationTile.view')){jQuery.sap.declare('sap.ushell.components.tiles.indicatordeviation.DeviationTile.view');(function(){"use strict";jQuery.sap.require('sap.ui.model.analytics.odata4analytics');sap.ui.getCore().loadLibrary("sap.suite.ui.commons");sap.ui.jsview("sap.ushell.components.tiles.indicatordeviation.DeviationTile",{getControllerName:function(){return"sap.ushell.components.tiles.indicatordeviation.DeviationTile";},createContent:function(c){this.setHeight('100%');this.setWidth('100%');var h="Lorem ipsum";var s="Lorem ipsum";var t=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.getViewData().chip);if(t.title&&t.subTitle){h=t.title;s=t.subTitle;}var d={subheader:s,header:h,footerNum:"",footerComp:"",frameType:"OneByOne",state:sap.suite.ui.commons.LoadState.Loading,scale:""};var b=new sap.suite.ui.commons.BulletChartData({value:"{value}",color:"{color}"});this.oBCTmpl=new sap.suite.ui.commons.BulletChart({size:sap.suite.ui.commons.InfoTileSize.Auto,scale:"{/scale}",actual:{value:"{/actual/value}",color:"{/actual/color}"},targetValue:"{/targetValue}",actualValueLabel:"{/actualValueLabel}",targetValueLabel:"{/targetValueLabel}",thresholds:{template:b,path:"/thresholds"},state:"{/state}",showActualValue:"{/showActualValue}",showTargetValue:"{/showTargetValue}"});this.oNVConfS=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:this.oBCTmpl});this.oGenericTile=new sap.suite.ui.commons.GenericTile({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[this.oNVConfS]});var g=new sap.ui.model.json.JSONModel();g.setData(d);this.oGenericTile.setModel(g);return this.oGenericTile;}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.indicatornumeric.NumericTile.view')){jQuery.sap.declare('sap.ushell.components.tiles.indicatornumeric.NumericTile.view');(function(){"use strict";jQuery.sap.require('sap.ui.model.analytics.odata4analytics');sap.ui.getCore().loadLibrary("sap.suite.ui.commons");sap.ui.jsview("sap.ushell.components.tiles.indicatornumeric.NumericTile",{getControllerName:function(){return"sap.ushell.components.tiles.indicatornumeric.NumericTile";},createContent:function(c){var h="Lorem ipsum";var s="Lorem ipsum";var t=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.getViewData().chip);if(t.title&&t.subTitle){h=t.title;s=t.subTitle;}var g={subheader:s,header:h,footerNum:"",footerComp:"",scale:"",unit:"",value:"",size:"Auto",frameType:"OneByOne",state:sap.suite.ui.commons.LoadState.Loading,valueColor:sap.suite.ui.commons.InfoTileValueColor.Neutral,indicator:sap.suite.ui.commons.DeviationIndicator.None,title:"",footer:"",description:""};this.oNVConfContS=new sap.suite.ui.commons.NumericContent({value:"{/value}",scale:"{/scale}",unit:"{/unit}",indicator:"{/indicator}",valueColor:"{/valueColor}",size:"{/size}",formatterValue:true,truncateValueTo:5,nullifyValue:false});this.oNVConfS=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:this.oNVConfContS});this.oGenericTile=new sap.suite.ui.commons.GenericTile({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[this.oNVConfS]});var G=new sap.ui.model.json.JSONModel();G.setData(g);this.oGenericTile.setModel(G);return this.oGenericTile;}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.sbtilecontent')){jQuery.sap.declare("sap.ushell.components.tiles.sbtilecontent");jQuery.sap.declare('sap.ushell.components.tiles.sbtilecontent');jQuery.sap.require('sap.suite.ui.commons.TileContent');jQuery.sap.require('sap.suite.ui.commons.TileContentRenderer');jQuery.sap.require('sap.ui.core.Control');sap.ui.define("sap/ushell/components/tiles/sbtilecontent",["sap/suite/ui/commons/TileContent","sap/suite/ui/commons/TileContentRenderer","sap/ui/core/Control"],function(T,R,C){"use strict";var t=C.extend("numeric.TileContent_Timestamp",{ontap:function(e){if(this.getParent().getRefreshOption()){e.preventDefault();e.cancelBubble=true;if(e.stopPropagation){e.stopPropagation();}this.getParent().fireRefresh();}},renderer:function(r,c){r.write("<div");r.writeElementData(c);r.addClass("sapSuiteTileCntFtrTxt");if(c.getParent().getRefreshOption()){r.addClass("sapMLnk");}r.writeClasses();r.addStyle("position","absolute");r.addStyle(r.getConfiguration().getRTL()?"left":"right","auto");r.writeStyles();r.write(">");var a=c.getParent().getTimestamp();if(a){if(!c.getParent().getRefreshOption()){r.writeEscaped(a);}else if(r.getConfiguration().getRTL()){r.writeEscaped(a+"\u2009");r.writeIcon("sap-icon://refresh","sapSuiteCmpTileUnitInner");}else{r.writeIcon("sap-icon://refresh","sapSuiteCmpTileUnitInner");r.writeEscaped("\u2009"+a);}}r.write("</div>");}});return T.extend("sap.ushell.components.tiles.sbtilecontent",{metadata:{properties:{timestamp:{type:"string"},refreshOption:{type:"boolean"}},events:{refresh:{}}},init:function(){this.addDependent(this._oTimestamp=new t());},getAltText:function(){var a=T.prototype.getAltText.apply(this,arguments);if(this.getTimestamp()){a+=(a===""?"":"\n")+this.getTimestamp();}return a;},renderer:{renderFooter:function(r,c){R.renderFooter.apply(this,arguments);r.renderControl(c._oTimestamp);}}});},true);};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.utils')){this.sap=this.sap||{};(function(){"use strict";jQuery.sap.declare("sap.ushell.components.tiles.utils");if(!sap.ushell.components.tiles.utilsRT){jQuery.sap.require("sap.ushell.components.tiles.utilsRT");}sap=sap||{};sap.ushell=sap.ushell||{};sap.ushell.components=sap.ushell.components||{};sap.ushell.components.tiles=sap.ushell.components.tiles||{};sap.ushell.components.tiles.utils=sap.ushell.components.tiles.utils||{};sap.ushell.components.tiles.utils.isInitial=function(T){return T==="App Launcher – Static"||T==="App Launcher – Dynamic"||T==="Target Mapping";};sap.ushell.components.tiles.utils.getResourceBundleModel=function(){jQuery.sap.require("sap.ushell.resources");return sap.ushell.resources.i18nModel;};sap.ushell.components.tiles.utils.getEmptyRowObj=function(e){return{name:"",mandatory:false,value:"",isRegularExpression:false,defaultValue:"",valEnabled:false||!e,defValEnabled:true,editable:e};};sap.ushell.components.tiles.utils.getEmptyTileActionsRowObj=function(e){var r=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();return{menu_title:"",target_type:r.getText("configuration.tile_actions.table.target_type.url"),navigation_target:"",action:"",icon:"",isTargetTypeIntent:false,editable:e};};sap.ushell.components.tiles.utils.getTileNavigationActionsRows=function(T,e){var a=[],b=[];b=this.getTileNavigationActions(T);if(b.length){for(var i=0;i<b.length;i++){a.push(t(b[i],e));}}else{a=[this.getEmptyTileActionsRowObj(e)];}return a;};sap.ushell.components.tiles.utils.getTileNavigationActions=function(T){var a=[],s='';var b=T.bag.getBag('tileNavigationActions');if(b.getPropertyNames().indexOf('tile_navigation_actions')>=0){a=JSON.parse(b.getProperty('tile_navigation_actions'));for(var i=0;i<a.length;i++){if(a[i].text){if(b.getTextNames().indexOf('action_tile_'+(i+1))>=0){s=b.getText('action_tile_'+(i+1));}a[i].text=s;}}}return a;};var t=function(T,e){var a={},r=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();a.menu_title=T.text;a.icon=T.icon;if((T.targetURL).charAt(0)==="#"){a.target_type=r.getText("configuration.tile_actions.table.target_type.intent");var n=T.targetURL.split("-");a.navigation_target=n[0].substring(1,n[0].length);a.action=n[1];a.isTargetTypeIntent=true;}else{a.target_type=r.getText("configuration.tile_actions.table.target_type.url");a.navigation_target=T.targetURL;a.action="";a.isTargetTypeIntent=false;}a.editable=e;return a;};sap.ushell.components.tiles.utils.tileActionsRows2TileActionsArray=function(T){var a=[];for(var i=0;i<T.length;i++){if(T[i].menu_title){a.push(c(T[i]));}}return a;};var c=function(T){var o={};o.text=T.menu_title;o.icon=T.icon;if(T.action){o.targetURL="#"+T.navigation_target+"-"+T.action;}else{o.targetURL=T.navigation_target;}return o;};sap.ushell.components.tiles.utils.populateTileNavigationActionsBag=function(a,n){a.setProperty('tile_navigation_actions',JSON.stringify(n));for(var i=0;i<n.length;i++){var A=n[i].text;a.setText('action_tile_'+(i+1),A);}};sap.ushell.components.tiles.utils.getDefaultFormFactors=function(){return{"appDefault":false,"manual":{"desktop":true,"tablet":true,"phone":true},"defaultParam":true};};sap.ushell.components.tiles.utils.buildFormFactorsObject=function(m){return{"appDefault":m.getProperty("/config/appFormFactor"),"manual":{"desktop":m.getProperty("/config/desktopChecked"),"tablet":m.getProperty("/config/tabletChecked"),"phone":m.getProperty("/config/phoneChecked")}};};sap.ushell.components.tiles.utils.tableHasDuplicateParameterNames=function(T){var p={};for(var i=0;i<T.length;i++){var a=T[i].name;if(a!==""){if(p[a]){return true;}else{p[a]=true;}}}return false;};sap.ushell.components.tiles.utils.getMappingSignatureString=function(a,b){var m="";for(var i=0;i<a.length;i++){if(a[i].name){m+=(g(a[i])+"&");}}return b?m+"*=*":m.substring(0,m.length-1);};var g=function(a){var p="";if(a.mandatory){if(a.isRegularExpression){p="{"+a.name+"="+encodeURIComponent(a.value)+"}";}else{p=a.name+"="+encodeURIComponent(a.value);}}else{p="["+a.name+"="+encodeURIComponent(a.defaultValue)+"]";}return p;};sap.ushell.components.tiles.utils.getMappingSignatureTableData=function(m,e){var p=[];var a=m.split("&");for(var i=0;i<a.length;i++){var b=a[i];if(b!=="*=*"){p.push(d(a[i],e));}}return p;};var d=function(p,e){var a={};if(p.charAt(0)==="["){a.mandatory=false;a.isRegularExpression=false;a.value="";p=p.substring(1,p.length-1);a.name=p.substring(0,p.indexOf("="));a.defaultValue=decodeURIComponent(p.substring(p.indexOf("=")+1));}else{a.mandatory=true;a.defaultValue="";if(p.charAt(0)==="{"){a.isRegularExpression=true;p=p.substring(1,p.length-1);}else{a.isRegularExpression=false;}a.name=p.substring(0,p.indexOf("="));a.value=decodeURIComponent(p.substring(p.indexOf("=")+1));}a.editable=e;if(e){a.valEnabled=a.mandatory;a.defValEnabled=!a.mandatory;}else{a.valEnabled=true;a.defValEnabled=true;}return a;};sap.ushell.components.tiles.utils.getAllowUnknownParametersValue=function(m){if(m&&(m.substring(m.length-3,m.length)==="*=*")){return true;}else{return false;}};sap.ushell.components.tiles.utils.getMappingSignature=function(r,a){var A=a?"allowed":"ignored";var u=new RegExp("%%UserDefault[.].+%%");var m=[];var M={"parameters":{},"additional_parameters":A};r.forEach(function(R){M.parameters[R.name]={"required":R.mandatory,"rename_to":R.rename_to};if(R.defaultValue){m=u.exec(R.defaultValue);if(m){R.defaultValue=m[0];}M.parameters[R.name].defaultValue={"value":R.defaultValue};}if(R.value){m=u.exec(R.value);if(m){R.value=m[0];}M.parameters[R.name].filter={"value":R.value};if(R.isRegularExpression){M.parameters[R.name].filter.format="regexp";}}});return M;};sap.ushell.components.tiles.utils.getSignatureTableData=function(s,e){var p=[];var r={};var P={};var o=s.parameters;for(var k in o){P=o[k];r={};r.editable=e;r.name=k;r.mandatory=P.required;P.rename_to?r.rename_to=P.rename_to:r.rename_to=P.renameTo;if(e){r.valEnabled=r.mandatory;r.defValEnabled=!r.mandatory;}else{r.valEnabled=true;r.defValEnabled=true;}if(P.filter){r.value=P.filter.value;if(P.filter.format&&P.filter.format==="regexp"){r.isRegularExpression=true;}}if(P.defaultValue){r.defaultValue=P.defaultValue.value;}p.push(r);}return p;};sap.ushell.components.tiles.utils.getTranslatedTitle=function(T){if(T.bag){var b=T.bag.getBag('tileProperties');if(b.getTextNames().indexOf("display_title_text")>=0){return b.getText('display_title_text');}}if(T.title){return T.title.getTitle();}if(T.preview){return T.preview.getTitle();}return"";};sap.ushell.components.tiles.utils.getTranslatedSubtitle=function(T,C){if(T.bag){var b=T.bag.getBag('tileProperties');if(b.getTextNames().indexOf("display_subtitle_text")>=0){return b.getText('display_subtitle_text');}}if(typeof C['display_subtitle_text']==="string"){return C['display_subtitle_text'];}if(T.preview&&T.preview.getDescription&&T.preview.getDescription()){return T.preview.getDescription();}return'';};sap.ushell.components.tiles.utils.getTranslatedProperty=function(T,o,p){if(T.bag){var b=T.bag.getBag('tileProperties');if(b.getTextNames().indexOf(p)>=0){return b.getText(p);}}return o[p];};sap.ushell.components.tiles.utils.getActionConfiguration=function(T,a){var C=T.configuration.getParameterValueAsString('tileConfiguration');var o=JSON.parse(C||"{}"),r;if(typeof a=="undefined"){a=T.configurationUi.isEnabled();}if(a){r=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();}o.semantic_object=o.semantic_object||(a?"["+r.getText("configuration.semantic_object")+"]":"");o.semantic_action=o.semantic_action||(a?"["+r.getText("configuration.semantic_action")+"]":"");o.navigation_provider=o.navigation_provider||"";o.navigation_provider_role=o.navigation_provider_role||"";o.navigation_provider_instance=o.navigation_provider_instance||"";o.target_application_id=o.target_application_id||"";o.target_application_alias=o.target_application_alias||"";o.display_info_text=o.display_info_text||"";o.editable=true;if(T.configurationUi&&T.configurationUi.isReadOnly){if(T.configurationUi.isReadOnly()){o.editable=false;}}return o;};sap.ushell.components.tiles.utils.getConfigurationUi=function(v,V){var o=v.getViewData();var T=o.chip;var C,s,r,i,a,A;var b=sap.ushell.components.tiles.utilsRT.getConfiguration(T,true,true);var e=new sap.ui.model.json.JSONModel({config:b,tileModel:v.getModel()});C=new sap.ui.view({type:sap.ui.core.mvc.ViewType.XML,viewData:o,viewName:V});C.setModel(e);s=C.byId("navigation_semantic_objectInput")||C.byId("semantic_objectInput");if(s){s.getModel().setProperty("/enabled",b.navigation_use_semantic_object);s.getModel().setProperty("/value",b.semantic_object||b.navigation_semantic_object);}r=C.byId("navigation_provider_roleInput");if(r){r.getModel().setProperty("/value",b.navigation_provider_role);}i=C.byId("navigation_provider_instanceInput");if(i){i.getModel().setProperty("/value",b.navigation_provider_instance);}a=C.byId("target_application_aliasInput");if(a){a.getModel().setProperty("/value",b.target_application_alias);}A=C.byId("targetTypeInput");if(A){if(!C.getModel().getProperty("/config/transaction")){C.getModel().setProperty("/config/transaction",{});}if(!C.getModel().getProperty("/config/web_dynpro")){C.getModel().setProperty("/config/web_dynpro",{});}if(v.getModel().getProperty('/config/navigation_provider')=="LPD"){sap.ushell.components.tiles.utils.displayLpdCustApplicationTypeFields(C);}else if(v.getModel().getProperty('/config/navigation_provider')=="SAPUI5"||v.getModel().getProperty('/config/navigation_provider')==''){A.setSelectedKey("SAPUI5");sap.ushell.components.tiles.utils.displaySapui5ApplicationTypeFields(C);}else if(v.getModel().getProperty('/config/navigation_provider')=="TR"){sap.ushell.components.tiles.utils.displayTransactionApplicationTypeFields(C);}else if(v.getModel().getProperty('/config/navigation_provider')=="WDA"){sap.ushell.components.tiles.utils.displayWebDynproApplicationTypeFields(C);}else if(v.getModel().getProperty('/config/navigation_provider')=="URL"){sap.ushell.components.tiles.utils.displayURLApplicationTypeFields(C);}}return C;};sap.ushell.components.tiles.utils._updateTilePropertiesTexts=function(v,T){var a=T.getTextNames(),m=v.getModel();a.forEach(function(p){m.setProperty('/data/'+p,T.getText(p));m.setProperty('/config/'+p,T.getText(p));});};sap.ushell.components.tiles.utils._updateTileConfiguration=function(v,T){var m=v.getModel();jQuery.each(JSON.parse(T),function(p,P){m.setProperty('/data/'+p,P);m.setProperty('/config/'+p,P);if(p==="navigation_target_url"){m.setProperty('/nav/'+p,P);}});};sap.ushell.components.tiles.utils.aData=[];sap.ushell.components.tiles.utils.aActionData=[];sap.ushell.components.tiles.utils.aRoleData=[];sap.ushell.components.tiles.utils.aAliasData=[];sap.ushell.components.tiles.utils.objectSelectDoSearch=function(e){var f=[],v=e.getParameter("value"),i,s,a;if(v!==undefined){i=e.getParameter("itemsBinding");s=new sap.ui.model.Filter("name",sap.ui.model.FilterOperator.Contains,v);a=new sap.ui.model.Filter("obj",sap.ui.model.FilterOperator.Contains,v);f.push(a);f.push(s);i.filter(new sap.ui.model.Filter(f,false));}};sap.ushell.components.tiles.utils.actionSelectDoSearch=function(e){var f=[],v=e.getParameter("value"),i,s;if(v!==undefined){i=e.getParameter("itemsBinding");s=new sap.ui.model.Filter("text",sap.ui.model.FilterOperator.Contains,v);f.push(s);i.filter(new sap.ui.model.Filter(f,false));}};sap.ushell.components.tiles.utils.roleSelectDoSearch=function(e){var f=[],v=e.getParameter("value"),i,s,a;if(v!==undefined){i=e.getParameter("itemsBinding");s=new sap.ui.model.Filter("role",sap.ui.model.FilterOperator.Contains,v);a=new sap.ui.model.Filter("instance",sap.ui.model.FilterOperator.Contains,v);f.push(s);f.push(a);i.filter(new sap.ui.model.Filter(f,false));}};sap.ushell.components.tiles.utils.instanceSelectDoSearch=function(e){var f=[],v=e.getParameter("value"),a,r,i,s,b;a=e.getSource().getCustomData();r=a[0].getValue();if(v!==undefined){i=e.getParameter("itemsBinding");if(v!=""){b=new sap.ui.model.Filter("instance",sap.ui.model.FilterOperator.Contains,v);f.push(b);}if(r!=""){s=new sap.ui.model.Filter("role",sap.ui.model.FilterOperator.EQ,r);f.push(s);}if(f.length>0){i.filter(new sap.ui.model.Filter(f,true));}}};sap.ushell.components.tiles.utils.instanceSuggest=function(C,e){var v=C.getView(),f=[],V=e.getParameter("value"),r,R,s,a,b;r=v.byId("navigation_provider_roleInput");R=r.getValue();V=e.getParameter("suggestValue");if(V!=""){b=new sap.ui.model.Filter("instance",sap.ui.model.FilterOperator.Contains,V);f.push(b);}if(R!=""){a=new sap.ui.model.Filter("role",sap.ui.model.FilterOperator.EQ,R);f.push(a);}if(f.length>0){s=e.oSource.getBinding("suggestionItems");s.filter(new sap.ui.model.Filter(f,true));}};sap.ushell.components.tiles.utils.aliasSuggest=function(C,e){var v=C.getView(),f=[],V=e.getParameter("value"),i,I,s,a,b;i=v.byId("navigation_provider_instanceInput");I=i.getValue();V=e.getParameter("suggestValue");if(V!=""){b=new sap.ui.model.Filter("alias",sap.ui.model.FilterOperator.Contains,V);f.push(b);}if(I!=""){a=new sap.ui.model.Filter("instance",sap.ui.model.FilterOperator.EQ,I);f.push(a);}if(f.length>0){s=e.oSource.getBinding("suggestionItems");s.filter(new sap.ui.model.Filter(f,true));}};sap.ushell.components.tiles.utils.aliasSelectDoSearch=function(e){var f=[],v=e.getParameter("value"),a,i,b,s,h;a=e.getSource().getCustomData();i=a[0].getValue();if(v!==undefined){b=e.getParameter("itemsBinding");s=new sap.ui.model.Filter("instance",sap.ui.model.FilterOperator.EQ,i);if(v!=""){h=new sap.ui.model.Filter("alias",sap.ui.model.FilterOperator.Contains,v);f.push(h);}f.push(s);b.filter(new sap.ui.model.Filter(f,true));}};sap.ushell.components.tiles.utils.objectSelectUpdateDialog=function(s,v){var f=[],i=s.getBinding("items"),a;if(v!==undefined){a=new sap.ui.model.Filter("name",sap.ui.model.FilterOperator.Contains,v);f.push(a);i.filter(f);}};sap.ushell.components.tiles.utils.actionSelectUpdateDialog=function(s,v){var f=[],i=s.getBinding("items"),a;if(v!==undefined){a=new sap.ui.model.Filter("text",sap.ui.model.FilterOperator.Contains,v);f.push(a);i.filter(f);}};sap.ushell.components.tiles.utils.roleSelectUpdateDialog=function(s,v){var f=[],i=s.getBinding("items"),a;if(v!==undefined){a=new sap.ui.model.Filter("role",sap.ui.model.FilterOperator.Contains,v);f.push(a);i.filter(f);}};sap.ushell.components.tiles.utils.instanceSelectUpdateDialog=function(s,v){var f=[],a,i=s.getBinding("items"),b,r,e;a=s.getCustomData();r=a[0].getValue();if(v!==undefined){b=new sap.ui.model.Filter("instance",sap.ui.model.FilterOperator.Contains,v);f.push(b);}if(r!==""){e=new sap.ui.model.Filter("role",sap.ui.model.FilterOperator.EQ,r);f.push(e);}if(f.length>0){i.filter(f,true);}};sap.ushell.components.tiles.utils.aliasSelectUpdateDialog=function(s,v){var f=[],a,i,b=s.getBinding("items"),e,h;a=s.getCustomData();i=a[0].getValue();if(v!==undefined){h=new sap.ui.model.Filter("alias",sap.ui.model.FilterOperator.Contains,v);f.push(h);}if(i!==""){e=new sap.ui.model.Filter("instance",sap.ui.model.FilterOperator.EQ,i);f.push(e);}if(f.length>0){b.filter(f,true);}};sap.ushell.components.tiles.utils.sSelectedColor=(jQuery(".sapMStdTileIconDiv").css('color')||"#007cc0").split(" ").join("");sap.ushell.components.tiles.utils.sDeselectedColor=(jQuery(".sapMLabel:not(.sapFioriDropZoneText )").css('color')||"#666666").split(" ").join("");sap.ushell.components.tiles.utils.iconSelect=function(i,s){i.setColor(s?sap.ushell.components.tiles.utils.sSelectedColor:sap.ushell.components.tiles.utils.sDeselectedColor);i.setActiveColor(s?sap.ushell.components.tiles.utils.sDeselectedColor:sap.ushell.components.tiles.utils.sSelectedColor);};sap.ushell.components.tiles.utils.onSelectIcon=function(C,i,T,o){var m=C.getView().getModel(),s;if(i){s=m.getProperty("/config/tile_actions_selected_icon");}else{s=m.getProperty("/config/selected_icon");}if(s){sap.ushell.components.tiles.utils.iconSelect(s,false);}s=o.getSource();sap.ushell.components.tiles.utils.iconSelect(s,true);m.setProperty("/config/ok.enabled",true);if(i){m.setProperty("/config/tile_actions_selected_icon",s);}else{m.setProperty("/config/selected_icon",s);}C.byId("selectIconDialog").setTitle(s.getSrc());};sap.ushell.components.tiles.utils.onSelectIconClose=function(v){v.byId("selectIconDialog").close();};sap.ushell.components.tiles.utils.onSelectIconOk=function(v,T){var s=v.getModel().getProperty("/config/selected_icon");if(!T){v.getModel().setProperty("/config/display_icon_url",s.getSrc());v.byId("iconInput").setValueState(sap.ui.core.ValueState.None);}else{s=v.getModel().getProperty("/config/tile_actions_selected_icon");if(s){T.setValue(s.getSrc());T.setValueState(sap.ui.core.ValueState.None);}}sap.ushell.components.tiles.utils.onSelectIconClose(v);};sap.ushell.components.tiles.utils.iconSelectOnValueHelpRequest=function(C,e,a){var m=C.getView().getModel();var r=C.getView().byId("icons");var b=sap.ui.core.IconPool.getIconCollectionNames();var D=C.getView().byId("selectIconDialog");var o=C.getView().byId("ok");var f,I,T,h,i,j,u,B=false;r.destroyContent();if(a){T=sap.ui.getCore().byId(e.getParameter('id'));I=T.getValue();}else{I=m.getProperty("/config/display_icon_url");}o.attachEventOnce("press",function(){sap.ushell.components.tiles.utils.onSelectIconOk(C.getView(),T);});b.sort();b=jQuery.grep(b,function(v){if(v==="BusinessSuiteInAppSymbols"){B=true;return false;}return true;});if(B){b.push("BusinessSuiteInAppSymbols");}for(i=0;i<b.length;i+=1){h=sap.ui.core.IconPool.getIconNames(b[i]);h.sort();for(j=0;j<h.length;j+=1){u=sap.ui.core.IconPool.getIconURI(h[j],b[i]);r.addContent(new sap.ui.core.Icon({height:"38px",press:sap.ushell.components.tiles.utils.onSelectIcon.bind(null,C,a,T),size:"2rem",src:u,tooltip:u,width:"38px"}));}}f=r.getContent();m.setProperty("/config/ok.enabled",false);D.bindProperty("title",{model:"i18n",path:"configuration.select_icon"});for(i=0;i<f.length;i+=1){if(f[i].getSrc()===I){if(a){m.setProperty("/config/tile_actions_selected_icon",f[i]);}else{m.setProperty("/config/selected_icon",f[i]);}sap.ushell.components.tiles.utils.iconSelect(f[i],true);m.setProperty("/config/ok.enabled",true);D.setTitle(I);}else{sap.ushell.components.tiles.utils.iconSelect(f[i],false);}}D.open();};sap.ushell.components.tiles.utils.objectSelectOnValueHelpRequest=function(C,e,i){var v=C.getView(),T=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle().getText("configuration.semantic_object"),s,V,S=new sap.ui.model.json.JSONModel(),o=new sap.m.SelectDialog("semantic_object_select_dialog",{title:T,search:sap.ushell.components.tiles.utils.objectSelectDoSearch,liveChange:sap.ushell.components.tiles.utils.objectSelectDoSearch}),a=new sap.m.StandardListItem({title:"{obj}"});if(i){s=sap.ui.getCore().byId(e.getParameter('id'));}else{s=v.byId("semantic_objectInput")||v.byId("navigation_semantic_objectInput");}V=s.getValue();o.open(V);S.setData(C.aDefaultObjects.concat(sap.ushell.components.tiles.utils.aData));o.bindAggregation("items","/",a);o.setModel(S);sap.ushell.components.tiles.utils.objectSelectUpdateDialog(o,V);o.attachCancel(function(b){s.setValue(V);if(!i){s.fireChange();}o.destroy();o=null;});o.attachConfirm(function(b){var f=b.getParameter("selectedItem");if(f){s.setValue(f.getTitle());if(!i){s.fireChange();}}o.destroy();o=null;});};sap.ushell.components.tiles.utils.actionSelectOnValueHelpRequest=function(C,e,i){var v=C.getView(),T=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle().getText("configuration.semantic_action"),a,V,s=new sap.ui.model.json.JSONModel(),S=new sap.m.SelectDialog("semantic_action_select_dialog",{title:T,search:sap.ushell.components.tiles.utils.actionSelectDoSearch,liveChange:sap.ushell.components.tiles.utils.actionSelectDoSearch}),b=new sap.m.StandardListItem({title:"{text}"});if(i){a=sap.ui.getCore().byId(e.getParameter('id'));}else{a=v.byId("semantic_actionInput")||v.byId("navigation_semantic_actionInput");}V=a.getValue();S.open(V);s.setData(sap.ushell.components.tiles.utils.aActionData);S.bindAggregation("items","/items",b);S.setModel(s);sap.ushell.components.tiles.utils.actionSelectUpdateDialog(S,V);S.attachCancel(function(f){a.setValue(V);if(!i){a.fireChange();}S.destroy();S=null;});S.attachConfirm(function(f){var h=f.getParameter("selectedItem");if(h){a.setValue(h.getTitle());if(!i){a.fireChange();a.fireLiveChange({"newValue":h.getTitle()});}}S.destroy();S=null;});};sap.ushell.components.tiles.utils.roleSelectOnValueHelpRequest=function(C,e){var v=C.getView(),T=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle().getText("configuration.navigation_provider_role"),r,i,V,s=new sap.ui.model.json.JSONModel(),S=new sap.m.TableSelectDialog("role_select_dialog",{title:T,search:sap.ushell.components.tiles.utils.roleSelectDoSearch,liveChange:sap.ushell.components.tiles.utils.roleSelectDoSearch,columns:[new sap.m.Column({header:[new sap.m.Text({text:sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle().getText("configuration.navigation_provider_role")})]}),new sap.m.Column({header:[new sap.m.Text({text:sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle().getText("configuration.navigation_provider_instance")})]})]}),a=new sap.m.ColumnListItem({cells:[new sap.m.Text({text:"{role}"}),new sap.m.Text({text:"{instance}"})]});r=v.byId("navigation_provider_roleInput");i=v.byId("navigation_provider_instanceInput");V=r.getValue();S.open(V);s.setData(C.aDefaultObjects.concat(sap.ushell.components.tiles.utils.aRoleData));S.bindAggregation("items","/",a);S.setModel(s);sap.ushell.components.tiles.utils.roleSelectUpdateDialog(S,V);S.attachCancel(function(b){r.setValue(V);r.fireChange();S.destroy();S=null;});S.attachConfirm(function(b){var f=b.getParameter("selectedItem");if(f){r.setValue(f.getCells()[0].getText());i.setValue(f.getCells()[1].getText());r.fireChange();i.fireChange();}S.destroy();S=null;});};sap.ushell.components.tiles.utils.instanceSelectOnValueHelpRequest=function(C,e){var v=C.getView(),r,T=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle().getText("configuration.navigation_provider_instance"),i,V,s=new sap.ui.model.json.JSONModel(),S=new sap.m.SelectDialog("instance_select_dialog",{title:T,search:sap.ushell.components.tiles.utils.instanceSelectDoSearch,liveChange:sap.ushell.components.tiles.utils.instanceSelectDoSearch}),a=new sap.m.StandardListItem({title:"{instance}"});i=v.byId("navigation_provider_instanceInput");V=i.getValue();r=v.byId("navigation_provider_roleInput").getValue();S.addCustomData(new sap.ui.core.CustomData({key:"role",value:r}));S.open(V);s.setData(C.aDefaultObjects.concat(sap.ushell.components.tiles.utils.aRoleData));S.bindAggregation("items","/",a);S.setModel(s);sap.ushell.components.tiles.utils.instanceSelectUpdateDialog(S,V);S.attachCancel(function(b){i.setValue(V);i.fireChange();S.destroy();S=null;});S.attachConfirm(function(b){var f=b.getParameter("selectedItem");if(f){i.setValue(f.getTitle());i.fireChange();}S.destroy();S=null;});};sap.ushell.components.tiles.utils.applicationAliasSelectOnValueHelpRequest=function(C,e){var v=C.getView(),T=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle().getText("configuration.target_application_alias"),a,V,i,s=new sap.ui.model.json.JSONModel(),S=new sap.m.SelectDialog("alias_select_dialog",{title:T,search:sap.ushell.components.tiles.utils.aliasSelectDoSearch,liveChange:sap.ushell.components.tiles.utils.aliasSelectDoSearch}),b=new sap.m.StandardListItem({title:"{alias}"});a=v.byId("target_application_aliasInput");V=a.getValue();i=v.byId("navigation_provider_instanceInput").getValue();S.addCustomData(new sap.ui.core.CustomData({key:"instance",value:i}));S.open(V);s.setData(C.aDefaultObjects.concat(sap.ushell.components.tiles.utils.aAliasData));S.bindAggregation("items","/",b);S.setModel(s);sap.ushell.components.tiles.utils.aliasSelectUpdateDialog(S,V);S.attachCancel(function(f){a.setValue(V);a.fireChange();S.destroy();S=null;});S.attachConfirm(function(f){var h=f.getParameter("selectedItem");if(h){a.setValue(h.getTitle());a.fireChange();}S.destroy();S=null;});};sap.ushell.components.tiles.utils.onTargetTypeChange=function(T){var i=T.getParameter('id');var p=sap.ui.getCore().byId(i).getParent().getCells();var s=T.getSource().getSelectedKey();if(s=="INT"){p[3].setEnabled(true);p[2].setShowValueHelp(true);p[2].setValue("");}else{p[2].setShowValueHelp(false);p[2].setValue("");p[3].setEnabled(false);p[3].setValue("");}};sap.ushell.components.tiles.utils.addTileActionsRow=function(C){var m=C.getModel();var r=m.getProperty('/config/tile_actions_rows');var n=this.getEmptyTileActionsRowObj();r.push(n);m.setProperty('/config/tile_actions_rows',r);};sap.ushell.components.tiles.utils.deleteTileActionsRow=function(C){var m=C.getModel();var r=m.getProperty('/config/tile_actions_rows');var e=C.byId("tileActions");var s=e.getSelectedIndices();var S=s.sort(function(a,b){return b-a;}).slice();for(var i=0;i<S.length;i++){e.removeSelectionInterval(S[i],S[i]);r.splice(S[i],1);}m.setProperty('/config/tile_actions_rows',r);};sap.ushell.components.tiles.utils.checkInput=function(C,o){var T=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle(),i=C.byId("iconInput"),u=C.byId("useLpdCheckbox"),s=C.byId("navigation_semantic_objectInput")||C.byId("semantic_objectInput"),S=C.byId("navigation_semantic_actionInput")||C.byId("semantic_actionInput"),n=jQuery.trim(o.getParameter("newValue")),v=sap.ui.core.ValueState.None,V=null;switch(o.getSource()){case i:if(n!=""&&n.substring(0,11)!=="sap-icon://"){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.display_icon_url.warning");}break;case u:if(!u.getSelected()){S.setValueState(sap.ui.core.ValueState.None);s.setValueState(sap.ui.core.ValueState.None);}break;case s:if(/[\-#&? ]/.test(n)){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.semantic_object.error_invalid_chars");}else if(n==""){v=sap.ui.core.ValueState.Error;}break;case S:if(/[\-#&? ]/.test(n)){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.semantic_action.error_invalid_chars");}else if(n==""){v=sap.ui.core.ValueState.Error;}break;default:break;}if(v){o.getSource().setValueState(v);if(V!==null){o.getSource().setValueStateText(V||"");}}};sap.ushell.components.tiles.utils.checkInputOnSaveConfig=function(C){var i=C.byId("iconInput");var s=C.byId("navigation_semantic_objectInput");var S=C.byId("navigation_semantic_actionInput");var u=C.byId("useLpdCheckbox");var T=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();var r=false;if(i.getValue()!=""&&!sap.ushell.components.tiles.utils.isIconURIValid(i.getValue())){i.setValueState(sap.ui.core.ValueState.Error);i.setValueStateText(T.getText("configuration.display_icon_url.warning"));r=true;}if(u.getSelected()&&/[\-#&? ]/.test(s.getValue())){s.setValueState(sap.ui.core.ValueState.Error);s.setValueStateText(T.getText("configuration.semantic_object.error_invalid_chars"));r=true;}else if(u.getSelected()&&s.getValue()==""){s.setValueState(sap.ui.core.ValueState.Error);r=true;}if(/[\-#&? ]/.test(S.getValue())){S.setValueState(sap.ui.core.ValueState.Error);S.setValueStateText(T.getText("configuration.semantic_action.error_invalid_chars"));r=true;}else if(u.getSelected()&&S.getValue()==""){S.setValueState(sap.ui.core.ValueState.Error);r=true;}return r;};sap.ushell.components.tiles.utils.checkTileActions=function(C){var T=C.getModel().getProperty("/config/tile_actions_rows");var o=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();var r=false;for(var i=0;i<T.length;i++){if(!T[i].menu_title&&(T[i].navigation_target||T.length>1)){T[i].valueState=sap.ui.core.ValueState.Error;r=true;}else{T[i].valueState=sap.ui.core.ValueState.None;}if(T[i].icon){if(!sap.ushell.components.tiles.utils.isIconURIValid(T[i].icon)){T[i].iconValueState=sap.ui.core.ValueState.Error;T[i].iconValueStateText=o.getText("configuration.display_icon_url.warning");r=true;}}}C.getModel().setProperty("/config/tile_actions_rows",T);return r;};sap.ushell.components.tiles.utils.isIconURIValid=function(i){var r=[];var C="";var I="";var v="";r=/sap-icon:\/\/(.+)\//.exec(i);if(r){C=r[1];r=/\/\/.+\/(.+)/.exec(i);r?I=r[1]:I="";v=sap.ui.core.IconPool.getIconURI(I,C);if(v!=i){return false;}}else{r=/sap-icon:\/\/(.+)/.exec(i);if(r){I=r[1];if(!sap.ui.core.IconPool.getIconInfo(I)){return false;}}else{return false;}}return true;};sap.ushell.components.tiles.utils.checkTMInput=function(C,o){var T=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle(),s=C.byId("semantic_objectInput"),S=C.byId("semantic_actionInput"),a=C.byId("target_application_descriptionInput"),b=C.byId("target_application_urlInput"),e=C.byId("target_application_componentInput"),n=C.byId("navigation_provider_roleInput"),N=C.byId("navigation_provider_instanceInput"),f=C.byId("target_application_aliasInput"),h=C.byId("target_application_idInput"),i=jQuery.trim(o.getParameter("newValue")),v=sap.ui.core.ValueState.None,V=null;switch(o.getSource()){case s:if(/[\-#&? ]/.test(i)){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.semantic_object.error_invalid_chars");}if(S.getValue()==""){S.setValueState(sap.ui.core.ValueState.Error);}break;case S:if(/[\-#&? ]/.test(i)){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.semantic_action.error_invalid_chars");}else if(i==""){v=sap.ui.core.ValueState.Error;}break;case a:if(i==""){v=sap.ui.core.ValueState.Error;}break;case b:if(i!=""&&!(/^[-~+,;:?%&#=/.\w]+$/.test(i))){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.url.error_invalid_chars");}break;case e:if(i==""){v=sap.ui.core.ValueState.Error;}else if(i.substring(0,17)=="SAPUI5.Component="){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.component.error_invalid_input");}break;case n:if(i==""){v=sap.ui.core.ValueState.Error;}else if(!(/^[\w/]+$/.test(i))){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.role.error_invalid_chars");}break;case N:if(i==""){v=sap.ui.core.ValueState.Error;}else if(!(/^[\w/]+$/.test(i))){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.instance.error_invalid_chars");}break;case f:if(i==""&&h.getValue()==""){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.alias_id.warning");}else if(i!=""&&h.getValue()!=""){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.alias_id.warning");h.setValueState(v);h.setValueStateText(V);}else{h.setValueState(sap.ui.core.ValueState.None);}break;case h:if(i==""&&f.getValue()==""){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.alias_id.warning");}else if(i!=""&&f.getValue()!=""){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.alias_id.warning");f.setValueState(v);f.setValueStateText(V);}else if(i!=""&&!(/^[A-Fa-f0-9]+$/.test(i))){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.alias_id.error_invalid_chars");}else{f.setValueState(sap.ui.core.ValueState.None);}break;default:break;}if(v){o.getSource().setValueState(v);if(V!==null){o.getSource().setValueStateText(V||"");}}};sap.ushell.components.tiles.utils.checkTMInputOnSaveConfig=function(C){var T=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();var s=C.byId("semantic_objectInput");var S=C.byId("semantic_actionInput");var o=C.byId("target_application_descriptionInput");var a=C.byId("target_application_urlInput");var b=C.byId("target_application_componentInput");var n=C.byId("navigation_provider_roleInput");var N=C.byId("navigation_provider_instanceInput");var e=C.byId("target_application_aliasInput");var f=C.byId("target_application_idInput");var h=C.byId("targetTypeInput");var i=C.byId("target_transactionInput");var w=C.byId("target_web_dynpro_applicationInput");var F=C.byId("desktopCB");var j=C.byId("tabletCB");var k=C.byId("phoneCB");var r=false;s.setValue(s.getValue().trim());if(/[\-#&? ]/.test(s.getValue())){s.setValueState(sap.ui.core.ValueState.Error);s.setValueStateText(T.getText("configuration.semantic_object.error_invalid_chars"));r=true;}S.setValue(S.getValue().trim());if(/[\-#&? ]/.test(S.getValue())){S.setValueState(sap.ui.core.ValueState.Error);S.setValueStateText(T.getText("configuration.semantic_action.error_invalid_chars"));r=true;}else if(S.getValue()==""){S.setValueState(sap.ui.core.ValueState.Error);r=true;}var l=C.getModel().getProperty("/config/navigation_provider");if(l==="SAPUI5"){if(o.getValue()==""){o.setValueState(sap.ui.core.ValueState.Error);r=true;}if(a.getValue()!=""&&!(/^[-~+,;:?%&#=/.\w]+$/.test(a.getValue()))){a.setValueState(sap.ui.core.ValueState.Error);a.setValueStateText(T.getText("configuration.target_application.url.error_invalid_chars"));r=true;}if(b.getValue()==""){b.setValueState(sap.ui.core.ValueState.Error);r=true;}else if(b.getValue().substring(0,17)=="SAPUI5.Component="){b.setValueState(sap.ui.core.ValueState.Error);b.setValueStateText(T.getText("configuration.target_application.component.error_invalid_input"));r=true;}}else if(l==="LPD"){if(n.getValue()==""){n.setValueState(sap.ui.core.ValueState.Error);r=true;}if(!(/^[\w]+$/.test(n.getValue()))){n.setValueState(sap.ui.core.ValueState.Error);var v=T.getText("configuration.target_application.role.error_invalid_chars");n.setValueStateText(v);r=true;}if(N.getValue()==""){N.setValueState(sap.ui.core.ValueState.Error);r=true;}if(!(/^[\w]+$/.test(N.getValue()))){N.setValueState(sap.ui.core.ValueState.Error);var v=T.getText("configuration.target_application.instance.error_invalid_chars");N.setValueStateText(v);r=true;}if(e.getValue()==""&&f.getValue()==""){var v=T.getText("configuration.target_application.alias_id.warning");e.setValueState(sap.ui.core.ValueState.Error);e.setValueStateText(v);f.setValueState(sap.ui.core.ValueState.Error);f.setValueStateText(v);r=true;}if(e.getValue()!=""&&f.getValue()!=""){var v=T.getText("configuration.target_application.alias_id.warning");e.setValueState(sap.ui.core.ValueState.Error);e.setValueStateText(v);f.setValueState(sap.ui.core.ValueState.Error);f.setValueStateText(v);r=true;}if(f.getValue()!=""&&!(/^[A-Fa-f0-9]+$/.test(f.getValue()))){f.setValueState(sap.ui.core.ValueState.Error);f.setValueStateText(T.getText("configuration.target_application.alias_id.error_invalid_chars"));r=true;}}else if(l==="TR"){if(i.getValue()==""){i.setValueState(sap.ui.core.ValueState.Error);r=true;}}else if(l==="WDA"){if(w.getValue()==""){w.setValueState(sap.ui.core.ValueState.Error);r=true;}}else if(l==="URL"){if(a.getValue()==""){a.setValueState(sap.ui.core.ValueState.Error);r=true;}else if(!(/^[-~+,;:?%&#=/.\w]+$/.test(a.getValue()))){a.setValueState(sap.ui.core.ValueState.Error);a.setValueStateText(T.getText("configuration.target_application.url.error_invalid_chars"));r=true;}}else{h.setValueState(sap.ui.core.ValueState.Error);h.setValueStateText(T.getText("configuration.navigation_provider.error_invalid_provider"));r=true;}if(!F.getSelected()&&!j.getSelected()&&!k.getSelected()){var v=T.getText("configuration.form_factor.warning");F.setValueState(sap.ui.core.ValueState.Error);F.setValueStateText(v);j.setValueState(sap.ui.core.ValueState.Error);j.setValueStateText(v);k.setValueState(sap.ui.core.ValueState.Error);k.setValueStateText(v);r=true;}return r;};sap.ushell.components.tiles.utils.updateTooltipForDisabledProperties=function(C){var m=C.getModel();var i=m.getProperty("/config/isLocaleSuitable");if(!i){var r=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();var a=r.getText("edit_configuration.original_locale_not_fit_tooltip",[m.getProperty("/config/userLocale"),m.getProperty("/config/orgLocale")]);C.byId("titleInput").setTooltip(a);C.byId("subtitleInput").setTooltip(a);C.byId("keywordsInput").setTooltip(a);C.byId("infoInput").setTooltip(a);}};sap.ushell.components.tiles.utils.updateMessageStripForOriginalLanguage=function(C){var m=C.getModel();if(m.getProperty("/config/isLocaleSuitable")===false){var M=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle().getText("edit_configuration.original_locale_not_fit_message",[m.getProperty("/config/orgLocale").toUpperCase(),m.getProperty("/config/userLocale").toUpperCase()]);var o=C.byId("messageStrip");o.setVisible(true);o.setText(M);o.setType(sap.ui.core.MessageType.Warning);}};sap.ushell.components.tiles.utils.createSemanticObjectModel=function(C,s,D){var v=C.getView(),u="/sap/opu/odata/UI2/INTEROP/SemanticObjects",a=[{obj:"",name:""},{obj:"*",name:"*"}],b=(D||a).slice(0),S=new sap.ui.model.json.JSONModel();S.setSizeLimit(999999);S.setProperty("/value","");S.setProperty("/enabled",true);s.bindAggregation("suggestionItems","suggest>/items",new sap.ui.core.Item({text:"{suggest>obj}"}));s.setModel(S,"suggest");if(sap.ushell.components.tiles.utils.aData.length>0){S.setData({items:b.concat(sap.ushell.components.tiles.utils.aData)},true);return;}OData.read({requestUri:u,headers:{"Accept":"application/json"}},function(o,r){var I,T,i;for(i=0;i<o.results.length;i=i+1){I=o.results[i].id;T=o.results[i].text;sap.ushell.components.tiles.utils.aData.push({obj:I,name:T||I});}S.setData({items:b.concat(sap.ushell.components.tiles.utils.aData)},true);},function(e){var m=e&&e.message?e.message:e;if(e.response){m+=" - "+e.response.statusCode+" "+e.response.statusText;}jQuery.sap.log.error("Could not fetch data: "+u+": "+m,null,(v.getViewName()||"sap.ushell.components.tiles.utils"));});};sap.ushell.components.tiles.utils.createRoleModel=function(C,r,I){var v=C.getView(),u="/sap/opu/odata/UI2/INTEROP/GetLPDInstances",s=new sap.ui.model.json.JSONModel(),o=new sap.ui.model.json.JSONModel();s.setSizeLimit(999999);o.setSizeLimit(999999);s.setProperty("/value","");s.setProperty("/enabled",true);o.setProperty("/value","");o.setProperty("/enabled",true);var a=new sap.m.ColumnListItem({cells:[new sap.m.Label({text:"{role}"}),new sap.m.Label({text:"{instance}"})]});r.bindAggregation("suggestionRows","/items",a);I.bindAggregation("suggestionItems","/items",new sap.ui.core.Item({text:"{instance}"}));I.setModel(o);r.setModel(s);r.attachSuggestionItemSelected(function(e){I.setValue(e.getParameter("selectedRow").getCells()[1].getText());I.fireChange();});if(sap.ushell.components.tiles.utils.aRoleData.length>0){s.setData({items:sap.ushell.components.tiles.utils.aRoleData},false);o.setData({items:sap.ushell.components.tiles.utils.aRoleData},false);return;}OData.read({requestUri:u,headers:{"Accept":"application/json"}},function(D,R){var b,e,i;for(i=0;i<D.results.length;i=i+1){b=D.results[i].lpdRole;e=D.results[i].instance;sap.ushell.components.tiles.utils.aRoleData.push({role:b,instance:e});}s.setData({items:sap.ushell.components.tiles.utils.aRoleData},true);o.setData({items:sap.ushell.components.tiles.utils.aRoleData},true);},function(e){var m=e&&e.message?e.message:e;if(e.response){m+=" - "+e.response.statusCode+" "+e.response.statusText;}jQuery.sap.log.error("Could not fetch data: "+u+": "+m,null,(v.getViewName()||"sap.ushell.components.tiles.utils"));});};sap.ushell.components.tiles.utils.createAliasModel=function(C,a){var v=C.getView(),o,u="/sap/opu/odata/UI2/INTEROP/GetLPDAppAlias",s=new sap.ui.model.json.JSONModel();s.setSizeLimit(999999);s.setProperty("/value","");s.setProperty("/enabled",true);a.bindAggregation("suggestionItems","/items",new sap.ui.core.Item({text:"{alias}"}));a.setModel(s);o=sap.ushell.components.tiles.utilsRT.getConfiguration(v.oViewData.chip,true,true);if(o&&o.navigation_provider_role&&o.navigation_provider_instance){if(o.navigation_provider_role!=""&&o.navigation_provider_instance!=""){u=u+"?role='"+o.navigation_provider_role+"'&instance='"+o.navigation_provider_instance+"'";}}OData.read({requestUri:u,headers:{"Accept":"application/json"}},function(D,r){var A,R,I,i,m;sap.ushell.components.tiles.utils.aAliasData=[];for(i=0;i<D.results.length;i=i+1){A=D.results[i].lpdApplicationAlias;R=D.results[i].lpdRole;I=D.results[i].lpdInstance;sap.ushell.components.tiles.utils.aAliasData.push({role:R,instance:I,alias:A});}m=s.getData();if(m){m.items=sap.ushell.components.tiles.utils.aAliasData;}else{m={items:sap.ushell.components.tiles.utils.aAliasData};}s.setData(m,false);},function(e){var m=e&&e.message?e.message:e;if(e.response){m+=" - "+e.response.statusCode+" "+e.response.statusText;}jQuery.sap.log.error("Could not fetch data: "+u+": "+m,null,(v.getViewName()||"sap.ushell.components.tiles.utils"));});};sap.ushell.components.tiles.utils.updateAliasModel=function(v,a){var u,I,r,s=a.getModel();I=v.byId("navigation_provider_instanceInput").getValue();r=v.byId("navigation_provider_roleInput").getValue();u="/sap/opu/odata/UI2/INTEROP/GetLPDAppAlias?role='"+r+"'&instance='"+I+"'";OData.read({requestUri:u,headers:{"Accept":"application/json"}},function(D,R){var A,r,I,i,m;sap.ushell.components.tiles.utils.aAliasData=[];for(i=0;i<D.results.length;i=i+1){A=D.results[i].lpdApplicationAlias;r=D.results[i].lpdRole;I=D.results[i].lpdInstance;sap.ushell.components.tiles.utils.aAliasData.push({role:r,instance:I,alias:A});}m=s.getData();if(m){m.items=sap.ushell.components.tiles.utils.aAliasData;}else{m={items:sap.ushell.components.tiles.utils.aAliasData};}s.setData(m,false);},function(e){var m=e&&e.message?e.message:e;if(e.response){m+=" - "+e.response.statusCode+" "+e.response.statusText;}jQuery.sap.log.error("Could not fetch data: "+u+": "+m,null,(v.getViewName()||"sap.ushell.components.tiles.utils"));});};sap.ushell.components.tiles.utils.createActionModel=function(C,a){var i=new sap.ui.model.json.JSONModel();var v=C.getView(),o,A;i.setData({"items":[{"text":"display"},{"text":"approve"},{"text":"displayFactSheet"},{"text":"manage"},{"text":"create"},{"text":"monitor"},{"text":"track"},{"text":"change"},{"text":"register"},{"text":"release"},{"text":"analyzeKPIDetails"},{"text":"lookup"},{"text":"manageLineItems"}]});sap.ushell.components.tiles.utils.aActionData=i.getData();o=sap.ushell.components.tiles.utilsRT.getConfiguration(v.oViewData.chip,true,true);A=o.navigation_semantic_action||o.semantic_action;if(A){if(!i.getData().items.some(function(I){return I.text===A;})){i.getData().items.push({"text":A});}}a.bindAggregation("suggestionItems","items>/items",new sap.ui.core.Item({text:"{items>text}"}));a.setModel(i,"items");a.getBinding("suggestionItems").sort(new sap.ui.model.Sorter("text",false));};sap.ushell.components.tiles.utils.createNavigationProviderModel=function(C,T){var i=new sap.ui.model.json.JSONModel();var r=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();i.setData({"items":[{"key":"SAPUI5","text":r.getText('configuration.target_application.sapui5')},{"key":"LPD","text":r.getText('configuration.target_application.lpd_cust')},{"key":"TR","text":r.getText('configuration.target_application.transaction')},{"key":"WDA","text":r.getText('configuration.target_application.web_dynpro')},{"key":"URL","text":r.getText('configuration.target_application.url')}]});T.bindItems("items>/items",new sap.ui.core.Item({key:"{items>key}",text:"{items>text}"}));T.setModel(i,"items");T.getBinding("items").sort(new sap.ui.model.Sorter("text",false));};sap.ushell.components.tiles.utils.displayApplicationTypeFields=function(a,C){switch(a){case'LPD':sap.ushell.components.tiles.utils.displayLpdCustApplicationTypeFields(C);break;case'SAPUI5':sap.ushell.components.tiles.utils.displaySapui5ApplicationTypeFields(C);break;case'TR':sap.ushell.components.tiles.utils.displayTransactionApplicationTypeFields(C);break;case'WDA':sap.ushell.components.tiles.utils.displayWebDynproApplicationTypeFields(C);break;case'URL':sap.ushell.components.tiles.utils.displayURLApplicationTypeFields(C);break;}};sap.ushell.components.tiles.utils.displaySapui5ApplicationTypeFields=function(C){C.byId('navigation_provider_role').setVisible(false);C.byId('navigation_provider_roleInput').setVisible(false);C.byId('navigation_provider_instance').setVisible(false);C.byId('navigation_provider_instanceInput').setVisible(false);C.byId('target_application_alias').setVisible(false);C.byId('target_application_aliasInput').setVisible(false);C.byId('target_application_id').setVisible(false);C.byId('target_application_idInput').setVisible(false);C.byId('application_description').setVisible(true);C.byId('target_application_descriptionInput').setVisible(true);C.byId('application_url').setVisible(true);C.byId('target_application_urlInput').setVisible(true);C.byId('application_component').setVisible(true);C.byId('target_application_componentInput').setVisible(true);C.byId('target_transaction').setVisible(false);C.byId('target_transactionInput').setVisible(false);C.byId('target_web_dynpro_application').setVisible(false);C.byId('target_web_dynpro_applicationInput').setVisible(false);C.byId('target_web_dynpro_configuration').setVisible(false);C.byId('target_web_dynpro_configurationInput').setVisible(false);C.byId('target_system_alias').setVisible(false);C.byId('target_system_aliasInput').setVisible(false);};sap.ushell.components.tiles.utils.displayLpdCustApplicationTypeFields=function(C){C.byId('application_description').setVisible(false);C.byId('target_application_descriptionInput').setVisible(false);C.byId('application_url').setVisible(false);C.byId('target_application_urlInput').setVisible(false);C.byId('application_component').setVisible(false);C.byId('target_application_componentInput').setVisible(false);C.byId('navigation_provider_role').setVisible(true);C.byId('navigation_provider_roleInput').setVisible(true);C.byId('navigation_provider_instance').setVisible(true);C.byId('navigation_provider_instanceInput').setVisible(true);C.byId('target_application_alias').setVisible(true);C.byId('target_application_aliasInput').setVisible(true);C.byId('target_application_id').setVisible(true);C.byId('target_application_idInput').setVisible(true);C.byId('target_transaction').setVisible(false);C.byId('target_transactionInput').setVisible(false);C.byId('target_web_dynpro_application').setVisible(false);C.byId('target_web_dynpro_applicationInput').setVisible(false);C.byId('target_web_dynpro_configuration').setVisible(false);C.byId('target_web_dynpro_configurationInput').setVisible(false);C.byId('target_system_alias').setVisible(false);C.byId('target_system_aliasInput').setVisible(false);};sap.ushell.components.tiles.utils.displayTransactionApplicationTypeFields=function(C){C.byId('application_description').setVisible(true);C.byId('target_application_descriptionInput').setVisible(true);C.byId('application_url').setVisible(false);C.byId('target_application_urlInput').setVisible(false);C.byId('application_component').setVisible(false);C.byId('target_application_componentInput').setVisible(false);C.byId('navigation_provider_role').setVisible(false);C.byId('navigation_provider_roleInput').setVisible(false);C.byId('navigation_provider_instance').setVisible(false);C.byId('navigation_provider_instanceInput').setVisible(false);C.byId('target_application_alias').setVisible(false);C.byId('target_application_aliasInput').setVisible(false);C.byId('target_application_id').setVisible(false);C.byId('target_application_idInput').setVisible(false);C.byId('target_transaction').setVisible(true);C.byId('target_transactionInput').setVisible(true);C.byId('target_web_dynpro_application').setVisible(false);C.byId('target_web_dynpro_applicationInput').setVisible(false);C.byId('target_web_dynpro_configuration').setVisible(false);C.byId('target_web_dynpro_configurationInput').setVisible(false);C.byId('target_system_alias').setVisible(true);C.byId('target_system_aliasInput').setVisible(true);};sap.ushell.components.tiles.utils.displayWebDynproApplicationTypeFields=function(C){C.byId('application_description').setVisible(true);C.byId('target_application_descriptionInput').setVisible(true);C.byId('application_url').setVisible(false);C.byId('target_application_urlInput').setVisible(false);C.byId('application_component').setVisible(false);C.byId('target_application_componentInput').setVisible(false);C.byId('navigation_provider_role').setVisible(false);C.byId('navigation_provider_roleInput').setVisible(false);C.byId('navigation_provider_instance').setVisible(false);C.byId('navigation_provider_instanceInput').setVisible(false);C.byId('target_application_alias').setVisible(false);C.byId('target_application_aliasInput').setVisible(false);C.byId('target_application_id').setVisible(false);C.byId('target_application_idInput').setVisible(false);C.byId('target_transaction').setVisible(false);C.byId('target_transactionInput').setVisible(false);C.byId('target_web_dynpro_application').setVisible(true);C.byId('target_web_dynpro_applicationInput').setVisible(true);C.byId('target_web_dynpro_configuration').setVisible(true);C.byId('target_web_dynpro_configurationInput').setVisible(true);C.byId('target_system_alias').setVisible(true);C.byId('target_system_aliasInput').setVisible(true);};sap.ushell.components.tiles.utils.displayURLApplicationTypeFields=function(C){C.byId('navigation_provider_role').setVisible(false);C.byId('navigation_provider_roleInput').setVisible(false);C.byId('navigation_provider_instance').setVisible(false);C.byId('navigation_provider_instanceInput').setVisible(false);C.byId('target_application_alias').setVisible(false);C.byId('target_application_aliasInput').setVisible(false);C.byId('target_application_id').setVisible(false);C.byId('target_application_idInput').setVisible(false);C.byId('application_description').setVisible(true);C.byId('target_application_descriptionInput').setVisible(true);C.byId('application_url').setVisible(true);C.byId('target_application_urlInput').setVisible(true);C.byId('application_component').setVisible(false);C.byId('target_application_componentInput').setVisible(false);C.byId('target_transaction').setVisible(false);C.byId('target_transactionInput').setVisible(false);C.byId('target_web_dynpro_application').setVisible(false);C.byId('target_web_dynpro_applicationInput').setVisible(false);C.byId('target_web_dynpro_configuration').setVisible(false);C.byId('target_web_dynpro_configurationInput').setVisible(false);C.byId('target_system_alias').setVisible(true);C.byId('target_system_aliasInput').setVisible(true);};}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.utilsRT')){this.sap=this.sap||{};(function(){"use strict";jQuery.sap.declare("sap.ushell.components.tiles.utilsRT");sap=sap||{};sap.ushell=sap.ushell||{};sap.ushell.components=sap.ushell.components||{};sap.ushell.components.tiles=sap.ushell.components.tiles||{};sap.ushell.components.tiles.utilsRT=sap.ushell.components.tiles.utilsRT||{};if(sap.ushell.components.tiles.utilsRT.getConfiguration){return;}sap.ushell.components.tiles.utilsRT.getConfiguration=function(t,a,e){var r;var c=t.configuration.getParameterValueAsString('tileConfiguration');var C=JSON.parse(c||"{}");var u=sap.ushell.components.tiles.utils;C.editable=true;if(t.configurationUi&&t.configurationUi.isReadOnly){if(t.configurationUi.isReadOnly()){C.editable=false;}}var T=u.getTranslatedTitle(t);var s=u.getTranslatedSubtitle(t,C);var i=u.getTranslatedProperty(t,C,'display_info_text');var k=u.getTranslatedProperty(t,C,'display_search_keywords');if(a){r=u.getResourceBundleModel().getResourceBundle();if(e&&t.bag){var o=t.bag.getOriginalLanguage();var l=sap.ui.getCore().getConfiguration().getLocale().getSAPLogonLanguage();var b=sap.ui.getCore().getConfiguration().getLanguage();C.isLocaleSuitable=o===""||o.toLowerCase()===l.toLowerCase()||o.toLowerCase()===b.toLowerCase();C.orgLocale=o;C.userLocale=l;}}C.display_icon_url=C.display_icon_url||"";if(i!==undefined){C.display_info_text=i;}else if(C.display_info_text===undefined){if(a&&!e){C.display_info_text="["+r.getText("configuration.display_info_text")+"]";}else{C.display_info_text="";}}C.navigation_semantic_object=C.navigation_semantic_object||"";C.navigation_semantic_action=C.navigation_semantic_action||"";C.navigation_semantic_parameters=C.navigation_semantic_parameters||"";C.display_number_unit=C.display_number_unit||"";C.display_number_factor=C.display_number_factor||"";C.service_refresh_interval=C.service_refresh_interval?parseInt(C.service_refresh_interval,10):0;C.service_url=C.service_url||"";C.navigation_target_url=C.navigation_target_url||"";if(a&&u.isInitial(T)){C.display_title_text=e?"":"["+r.getText("configuration.display_title_text")+"]";C.display_subtitle_text=e?"":"["+r.getText("configuration.display_subtitle_text")+"]";}else{C.display_title_text=T||C.display_title_text||"";if(s!==undefined){C.display_subtitle_text=s;}else if(C.display_subtitle_text===undefined){C.display_subtitle_text="";}}C.navigation_use_semantic_object=(C.navigation_use_semantic_object===false?false:true);C.display_search_keywords=k||C.display_search_keywords||"";if(a){C.display_number_value=C.display_number_value||1234;}C.form_factors=C.form_factors?C.form_factors:u.getDefaultFormFactors();C.desktopChecked=C.form_factors.manual.desktop;C.tabletChecked=C.form_factors.manual.tablet;C.phoneChecked=C.form_factors.manual.phone;C.manualFormFactor=!(C.form_factors.appDefault)&&C.editable;C.appFormFactor=C.form_factors.appDefault;C.formFactorConfigDefault=C.form_factors.defaultParam?true:false;if(C.signature){C.rows=u.getSignatureTableData(C.signature,e&&C.editable);}else{C.rows=(C.mapping_signature&&C.mapping_signature!=="*=*")?u.getMappingSignatureTableData(C.mapping_signature,e&&C.editable):[u.getEmptyRowObj(C.editable)];}if(C.signature){C.isUnknownAllowed=(C.signature.additional_parameters==="allowed"||C.signature.additionalParameters==="allowed");}else{C.isUnknownAllowed=(C.mapping_signature!==undefined)?u.getAllowUnknownParametersValue(C.mapping_signature):true;}if(a){C.tile_actions_rows=u.getTileNavigationActionsRows(t,C.editable);}else{if(!C.actions){C.actions=u.getTileNavigationActions(t);}}return C;};sap.ushell.components.tiles.utilsRT.getDataToDisplay=function(c,d){var a=0,i,n,C,s,D={display_icon_url:d.icon||c.display_icon_url||"",display_title_text:d.title||c.display_title_text||"",display_number_value:!isNaN(d.number)?d.number:"...",display_number_unit:d.numberUnit||c.display_number_unit||"",display_info_text:d.info||c.display_info_text||"",display_info_state:d.infoState||"Neutral",display_subtitle_text:d.subtitle||c.display_subtitle_text||"",display_state_arrow:d.stateArrow||"None",display_number_state:d.numberState||"Neutral",display_number_digits:d.numberDigits>=0?d.numberDigits:4,display_number_factor:d.numberFactor||"",display_search_keyword:d.keywords||c.display_search_keyword||"",targetParams:[]};if(d.infoStatus){D.display_info_state=d.infoStatus;}if(d.targetParams){D.targetParams.push(d.targetParams);}if(d.results){for(i=0,n=d.results.length;i<n;i=i+1){C=d.results[i].number||0;if(typeof C==="string"){C=parseFloat(C,10);}a=a+C;s=d.results[i].targetParams;if(s){D.targetParams.push(s);}}D.display_number_value=a;}if(!isNaN(d.number)){if(typeof d.number==="string"){d.number=d.number.trim();}jQuery.sap.require("sap.ui.core.format.NumberFormat");var S=this._shouldProcessDigits(d.number,d.numberDigits),m=D.display_icon_url?4:5;if(d.number&&d.number.length>=m||S){var N=this._normalizeNumber(d.number,m,d.numberFactor,d.numberDigits);D.display_number_factor=N.numberFactor;D.display_number_value=N.displayNumber;}else{var o=sap.ui.core.format.NumberFormat.getFloatInstance({maxFractionDigits:m});D.display_number_value=o.format(d.number);}}if(D&&D.display_number_state){switch(D.display_number_state){case"Positive":D.display_number_state="Good";break;case"Negative":D.display_number_state="Error";break;}}return D;};sap.ushell.components.tiles.utilsRT.getTileSettingsAction=function(m,s){var r=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();return{text:r.getText('tileSettingsButtonTitle'),press:function(){var a=sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.ushell.ui.footerbar.SaveAsTile",viewData:{appData:{showGroupSelection:false,title:m.getProperty('/config/display_title_text'),subtitle:m.getProperty('/config/display_subtitle_text'),info:m.getProperty('/config/display_info_text'),icon:m.getProperty('/config/display_icon_url'),keywords:m.getProperty('/config/display_search_keywords')}}});var S=new sap.ui.layout.form.SimpleForm({id:'tileSettings',layout:sap.ui.layout.form.SimpleFormLayout.GridLayout,content:[a]}).addStyleClass("sapUshellAddBookmarkForm");var o=new sap.m.Button('bookmarkOkBtn',{text:r.getText('okBtn'),press:function(){s(a);d.close();},enabled:true}),c=new sap.m.Button('bookmarkCancelBtn',{text:r.getText('cancelBtn'),press:function(){d.close();}});var e=function(t){o.setEnabled(t.trim()?true:false);};a.getTitleInput().attachLiveChange(function(){e(this.getValue());});var d=new sap.m.Dialog({id:'settingsDialog',title:r.getText('tileSettingsButtonTitle'),contentWidth:'400px',content:S,beginButton:o,endButton:c,horizontalScrolling:false,afterClose:function(){d.destroy();}});d.open();}};};sap.ushell.components.tiles.utilsRT.getSemanticNavigationUrl=function(c){var u="#"+jQuery.trim(c.navigation_semantic_object);u+="-"+jQuery.trim(c.navigation_semantic_action);if(c.navigation_semantic_parameters&&jQuery.trim(c.navigation_semantic_parameters).length>0){u+="?"+jQuery.trim(c.navigation_semantic_parameters);}return u;};sap.ushell.components.tiles.utilsRT.addParamsToUrl=function(u,d){var p="",U=u.indexOf("?")!==-1,t=d.targetParams,i;if(t&&t.length>0){for(i=0;i<t.length;i=i+1){p+=t[i];if(i<t.length-1){p+="&";}}}if(p.length>0){if(!U){u+="?";}else{u+="&";}u+=p;}return u;};sap.ushell.components.tiles.utilsRT._normalizeNumber=function(n,m,a,N){jQuery.sap.require("sap.ui.core.format.NumberFormat");var b;if(isNaN(n)){b=n;}else{var o=sap.ui.core.format.NumberFormat.getFloatInstance({maxFractionDigits:N});if(!a){if(n>=1000000000){a='B';n/=1000000000;}else if(n>=1000000){a='M';n/=1000000;}else if(n>=1000){a='K';n/=1000;}}b=o.format(n);}var d=b;var c=d[m-1];m-=(c==='.'||c===',')?1:0;d=d.substring(0,m);return{displayNumber:d,numberFactor:a};};sap.ushell.components.tiles.utilsRT._shouldProcessDigits=function(d,D){var n;d=typeof(d)!=='string'?d.toString():d;if(d.indexOf('.')!==-1){n=d.split(".")[1].length;if(n>D){return true;}}return false;};}());};if(!jQuery.sap.isDeclared('sap.ushell.functionBindPrototype')){(function(){"use strict";jQuery.sap.declare("sap.ushell.functionBindPrototype");if(!Function.prototype.bind){Function.prototype.bind=function(t){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");}var a=Array.prototype.slice.call(arguments,1),b=this,n=function(){},B=function(){return b.apply(this instanceof n&&t?this:t,a.concat(Array.prototype.slice.call(arguments)));};n.prototype=this.prototype;B.prototype=new n();return B;};}}());};if(!jQuery.sap.isDeclared('sap.ushell.iconfonts')){(function(){"use strict";jQuery.sap.require('sap.ui.core.IconPool');jQuery.sap.declare("sap.ushell.iconfonts");sap.ushell.iconfonts={};sap.ushell.iconfonts.registerFiori2IconFont=function(){var l={fontFamily:"BusinessSuiteInAppSymbols",collectionName:"BusinessSuiteInAppSymbols",icons:[["icon-heart","E000"],["icon-quarter","E001"],["icon-year","E002"],["icon-equalizer","E003"],["icon-component","E004"],["icon-component-private","E005"],["icon-raw-material","E006"],["icon-sms","E007"],["icon-add-note","E008"],["icon-change-time-horizon","E009"],["icon-table-chart-customization","E00a"],["icon-delegated-important-task","E00b"],["icon-forklift","E00c"],["icon-coins","E00d"],["icon-filter-menu","E00e"],["icon-target-to-date","E00f"],["icon-program","E010"],["icon-phase","E011"],["icon-checklist","E012"],["icon-mirrored-task","E013"],["icon-sub-project","E014"],["icon-checklist-item","E015"],["icon-adhoc-analysis","E016"],["icon-change-analysis","E017"],["icon-review-demands","E018"],["icon-project-definition","E019"],["icon-data-access","E01a"],["icon-define-shortage","E01b"],["icon-review-supplies","E01c"],["icon-change-log","E01d"],["icon-priority-1","E01e"],["icon-priority-2","E01f"],["icon-jam","E020"],["icon-milestone","E021"],["icon-bulleting-with-numbers","E022"],["icon-decrease-indent","E023"],["icon-increase-indent","E024"],["icon-bold","E025"],["icon-italic","E026"],["icon-strike-through","E027"],["icon-underline","E028"],["icon-save-as","E029"],["icon-segmentation","E02A"],["icon-context-menu","E02B"],["icon-snapshot","E02C"],["icon-substraction-b-a","E02D"],["icon-substraction-a-b","E02E"],["icon-intersection","E02F"],["icon-union","E030"],["icon-top","E031"],["icon-bottom","E032"],["icon-page-up","E033"],["icon-page-down","E034"],["icon-create-dashboard","E035"],["icon-excelsius-file","E036"],["icon-open-folder","E037"],["icon-neutral","E038"],["icon-split-segmentation","E039"],["icon-manage-budget","E03A"],["icon-blocked","E03B"],["icon-pipette","E03C"],["icon-top-recipe","E03D"],["icon-recipe","E03E"],["icon-ingredients","E03F"],["icon-multiple-charts","E040"],["icon-descending-bars","E041"],["icon-descending-stacked-bars","E042"],["icon-scatter-plot","E043"],["icon-spill","E044"],["icon-fire","E045"],["icon-stratification","E046"],["icon-relationship","E047"],["icon-margin-decomposition","E048"],["icon-control-group","E049"],["icon-bullet-chart","E04A"],["icon-responsible-area","E04B"],["icon-increase","E04C"],["icon-decrease","E04D"],["icon-current-stock","E04E"],["icon-expedite","E04F"],["icon-postpone","E050"],["icon-approved","E051"],["icon-partially-delivered","E052"],["icon-line-bar-chart","E053"],["icon-expand-all","E054"],["icon-submission","E055"],["icon-change-request","E056"],["icon-column-unselected","E057"],["icon-column-selected","E058"],["icon-row-unselected","E059"],["icon-row-selected","E05A"],["icon-stock-requirements","E05B"],["icon-gender-male-and-female","E05C"],["icon-icon-marital-status","E05D"],["icon-birthday","E05E"],["icon-classification","E05F"],["icon-marked-for-deletion","E060"],["icon-bullet-chart","E061"],["icon-remove-filter","E062"],["icon-bank-account","E063"],["icon-savings-account","E064"],["icon-debit-card","E065"],["icon-vip-customer","E066"],["icon-undesirable-customer","E067"],["icon-answered-change-request","E068"],["icon-collected-change-request","E069"],["icon-draw-freehand","E06A"],["icon-draw-circle","E06B"],["icon-completed","E06C"],["icon-answered","E06D"],["icon-traffic-cone","E06E"],["icon-traffic-lights","E06F"],["icon-container","E070"],["icon-container-loading","E071"],["icon-traffic-jam","E072"],["icon-products","E073"],["icon-sidepanel","E074"],["icon-split-screen","E075"],["icon-truck-driver","E076"],["icon-keep-segment","E077"],["icon-exclude-segment","E078"],["icon-separate-segments","E079"],["icon-distribute-segments","E07A"],["icon-next-open-item","E07B"],["icon-where-used","E07C"],["icon-outbound-delivery","E07D"],["icon-outbound-delivery-inactive","E07E"],["icon-outbound-delivery-active","E07F"],["icon-target","E080"],["icon-source","E081"],["icon-material","E082"],["icon-due-date","E083"],["icon-overdue","E084"],["icon-set-as-default","E085"],["icon-face-very-bad","E086"],["icon-face-bad","E087"],["icon-face-skeptical","E088"],["icon-face-neutral","E089"],["icon-face-astonished","E08A"],["icon-face-happy","E08B"],["icon-face-very-happy","E08C"],["icon-face-awful","E08D"],["icon-face-devastated","E08E"],["icon-face-okey-dokey","E08F"],["icon-alarm","E090"],["icon-activate","E091"],["icon-segment-preview-reference-objects","E092"],["icon-radius","E093"],["icon-polygon-black","E094"],["icon-polygon-white","E095"],["icon-polygon","E096"],["icon-no-filter","E097"],["icon-grip","E098"],["icon-water","E09A"],["icon-liquid","E09C"],["icon-gas","E09B"],["icon-gas-2","e09d"],["icon-water-2","e09e"],["icon-operator","e09f"],["icon-target-filter","e0a0"],["icon-equipment","E0A1"],["icon-gis-layer","E0A2"],["icon-section","E0A3"],["icon-kohorte","E0A4"],["icon-female","E0A5"],["icon-male","E0A6"],["icon-model","E0A7"],["icon-hourglass","E0A8"],["icon-plain-grid-layout","E0A9"],["icon-top-panel-layout","E0AA"],["icon-2x1-grid-layout","E0AB"],["icon-1x2-grid-layout","E0AC"],["icon-side-panel-left-layout","E0AD"],["icon-2x2-grid-layout","E0AE"],["icon-inverse-t-layout","E0AF"],["icon-t-layout","E0B0"],["icon-top-side-panel-layout","E0B1"],["icon-side-top-panel-layout","E0B2"],["icon-4x4-grid-layout","E0B3"],["icon-add-point","E0B4"],["icon-add-polyline","E0B5"],["icon-add-polygone","E0B6"],["icon-email-send-delayed","E0B7"],["icon-email-not-opened","E0B8"],["icon-link-not-clicked","E0B9"],["icon-sms-send-delayed","E0BA"],["icon-ab-testing","E0BB"],["icon-tv","E0BC"],["icon-radio","E0BD"],["icon-outdoor","E0BE"],["icon-event","E0BF"],["icon-paid-search","E0C0"],["icon-display-ads","E0C1"],["icon-call-center","E0C2"],["icon-social","E0C3"],["icon-event2","E0C4"],["icon-official-service-group","E0C5"],["icon-time-deposit","E0C6"],["icon-early-widthdrawal-for-time-deposits","E0C7"],["icon-aggregated-view","E0C8"],["icon-detailed-view","E0C9"],["icon-rescheduling","E0CA"],["icon-resequencing","E0CB"],["icon-movement-warning","E0CC"],["icon-multiple-warnings","E0CD"],["icon-box-truck","E0CE"],["icon-box-truck-empty","E0CF"],["icon-tractor","E0C0"],["icon-driver","E0D1"],["icon-driver-warning","E0D2"],["icon-overlap","E0D3"],["icon-expand-overlap","E0D4"],["icon-collapse-overlap","E0D5"],["icon-utilization","E0D6"],["icon-expand-utilization","E0D7"],["icon-collapse-utilization","E0D8"],["icon-trailer","E0D7"],["icon-container-closed","E0DA"],["icon-railcar","E0DB"],["icon-warehouse","E0DC"],["icon-goods","E0DD"],["icon-ship","E0DE"],["icon-truck-driver","E0DF"],["icon-return-delivery","E0E0"],["icon-return-order","E0E1"],["icon-contract","E0E2"],["icon-business-partner","E0E3"],["icon-business-partner-verified","E0E4"],["icon-business-partner-anonymous","E0E5"],["icon-business-partner-self-identified","E0E6"],["icon-money-withdrawal","E0E7"]]},f={fontFamily:"SAP-Icons",collectionName:"Fiori2",icons:[["F0017","e05e"],["F0018","e0c3"],["F0019","e0c3"],["F0020","e0c3"],["F0021","e10d"],["F0366","e129"],["F0392","e04f"],["F0394","e044"],["F0395","e132"],["F0396","e064"],["F0397","e0a4"],["F0398","e0a4"],["F0399","e044"],["F0401","e08d"],["F0402","e13e"],["F0403","e13e"],["F0404","e033"],["F0405","e0b3"],["F0406","e043"],["F0407","e043"],["F0408","e043"],["F0409","e075"],["F0410","e007"],["F0411","e075"]]},F={fontFamily:"Fiori2",collectionName:"Fiori3",icons:[["F0246","E218"],["F0247","E219"],["F0250","E21C"],["F0251","E21D"],["F0263","E2A8"],["F0508","E2A9"],["F0509","E2AA"],["F0510","E2AB"],["F0533","E2AC"],["F0534","E2AD"],["F0535","E2AE"],["F0536","E2AF"],["F0537","E2B0"],["F0538","E2B1"],["Lumira001","E2B2"]]},a={fontFamily:"Fiori2",collectionName:"Fiori2",icons:[["F0002","E236"],["F0003","E202"],["F0004","E203"],["F0005","E204"],["F0006","E205"],["F0009","E206"],["F0010","E207"],["F0012","E208"],["F0014","E209"],["F0018","E200"],["F0019","E201"],["F0023","E20A"],["F0024","E20B"],["F0025","E20C"],["F0026","E20D"],["F0072","E23A"],["F0100","E23B"],["F0101","E23C"],["F0102","E23D"],["F0106","E20F"],["F0144","E210"],["F0190","E23E"],["F0194","E23F"],["F0210","E242"],["F0211","E243"],["F0212","E244"],["F0217","E211"],["F0220","E213"],["F0243","E215"],["F0244","E216"],["F0245","E217"],["F0246","E218"],["F0247","E219"],["F0250","E21C"],["F0251","E21D"],["F0248","E21A"],["F0249","E21B"],["F0252","E21E"],["F0257","E21F"],["F0281","E220"],["F0282","E221"],["F0283","E222"],["F0284","E223"],["F0292","E224"],["F0295","E225"],["F0296","E226"],["F0316","E227"],["F0317","E228"],["F0321","E229"],["F0339","E22A"],["F0340","E22B"],["F0341","E22C"],["F0342","E22D"],["F0365","E212"],["F0366","E22F"],["F0367","E230"],["F0368","E231"],["F0369","E235"],["F0370","E22E"],["F0372","E232"],["F0380","E233"],["F0381","E234"],["F0382","E246"],["F0390","E20E"],["F0412","E213"],["F0429","E2A6"],["F0xx1","E240"],["F0xx2","E241"],["F0013","E237"],["F0016","E238"],["F0028","E239"],["F0029","E283"],["F0030","E284"],["F0031","E285"],["F0032","E286"],["F0033","E287"],["F0034","E288"],["F0036","E289"],["F0038","E28A"],["F0039","E28B"],["F0041","E28C"],["F0044","E28D"],["F0293","E28E"],["F0294","E28F"],["F0297","E290"],["F0298","E291"],["F0299","E292"],["F0300","E293"],["F0301","E294"],["F0302","E295"],["F0303","E296"],["F0304","E297"],["F0305","E298"],["F0306","E299"],["F0323","E29A"],["F0324","E29B"],["F0326","E29C"],["F0327","E29D"],["F0328","E29E"],["F0329","E29F"],["F0331","E2A1"],["F0332","E2A2"],["F0343","E2A3"],["F0344","E2A4"],["F0345","E2A5"],["F0388","E2A7"],["F0391","E2A0"],["F0260","E2B4"],["FD10N","E2B5"],["FK10N","E2B6"],["FS10N","E2B7"],["FBL5N","E2B8"],["FBL1N","E2B9"],["FFS01","E2BA"],["FBL3N","E2BB"],["FCOA1","E2BC"]]},o={fontFamily:"Fiori2",collectionName:"Fiori4",icons:[["F0194","E2BD"],["F0260","E2B4"],["F0433","E21C"],["F0251","E2BE"],["F0499","E2BF"],["F0500","E2C0"],["F0501","E2C1"],["F0502","E2C2"],["F0503","E2C3"],["F0504","E2C4"],["F0507","E2C5"],["F0530","E2C6"],["F0531","E2C7"],["F0539","E2C8"],["F0544","E2C9"],["F0545","E2CA"],["F0547","E2CB"],["F0576","E2CC"],["F0578","E2CD"],["F0579","E2CE"],["F0580","E2CF"],["F0581","E2D0"],["F0582","E2D1"],["F0583","E2D2"],["F0584","E2D3"],["F0586","E2D4"],["F0587","E2D5"],["F0588","E2D6"],["F0589","E2D7"],["F0590","E2D8"],["F0591","E2D9"],["F0593","E2DA"],["F0594","E2DB"],["F0597","E2DC"],["F0603","E2DD"],["F0604","E2DE"],["F0605","E2DF"],["F0606","E2E0"],["F0607","E2E1"],["F0608","E2E2"],["F0609","E2E3"],["F0615","E2E4"],["F0616","E2E5"],["F0618","E2E6"],["F0617","E2E7"],["F0622","E2E8"],["F0623","E2E9"],["F0624","E2BC"],["F0625","E2EB"],["F0626","E2EC"],["F0627","E2ED"],["F0629","E2EE"],["F0630","E2EF"],["F0632","E2F0"],["F0633","E2F1"],["F0634","E2F2"],["F0635","E2F3"],["F0636","E2F4"],["F0638","E2F5"],["F0639","E2F6"],["F0643","E2F7"],["F0644","E2F8"],["F0645","E2F9"],["F0646","E2FA"],["F0648","E2FB"],["F0649","E2FC"],["F0650","E2FD"],["F0654","E2FE"],["F0655","E2FF"],["F0659","E300"],["F0660","E301"],["F0661","E302"],["F0665","E303"],["F0666","E304"],["F0667","E305"],["F0671","E306"],["F0672","E307"],["F0673","E308"],["F0675","E309"],["F0676","E30A"],["F0677","E30B"],["F0678","E30C"],["F0679","E30D"],["F0680","E30E"],["F0682","E30F"],["F0683","E310"],["F0684","E240"],["F0685","E312"],["F0686","E313"],["F0687","E314"],["F0690","E315"],["F0691","E316"],["F0692","E317"],["F0693","E318"],["F0694","E319"],["F0695","E31A"],["F0700","E31B"],["F0598","E31C"],["F0600","E38A"]]},b={fontFamily:"Fiori2",collectionName:"Fiori5",icons:[["F0263","E321"],["F0266","E322"],["F0834","E31D"],["F2001","E31E"],["F0839","E320"],["F0270","E323"],["F0273","E324"],["F0439","E325"],["F0443","E326"],["F0549","E327"],["F0550","E328"],["F0551","E329"],["F0577","E32A"],["F0585","E32B"],["F0637","E32C"],["F0668","E32D"],["F0669","E32E"],["F0670","E330"],["F0688","E331"],["F0689","E332"],["F0701","E333"],["F0702","E334"],["F0703","E335"],["F0706","E336"],["F0707","E337"],["F0708","E338"],["F0711","E339"],["F0712","E33A"],["F0731","E33B"],["F0732","E33C"],["F0733","E33D"],["F0735","E33E"],["F0736","E340"],["F0737","E341"],["F0742","E342"],["F0743","E343"],["F0744","E344"],["F0745","E345"],["F0746","E346"],["F0747","E347"],["F0748","E348"],["F0749","E349"],["F0750","E34A"],["F0751","E34B"],["F0755","E34C"],["F0756","E34D"],["F0757","E34E"],["F0758","E350"],["F0759","E351"],["F0760","E352"],["F0761","E353"],["F0763","E354"],["F0764","E355"],["F0765","E356"],["F0768","E357"],["F0770","E358"],["F0771","E359"],["F0772","E35A"],["F0774","E35B"],["F0776","E35C"],["F0777","E35D"],["F0778","E35E"],["F0788","E360"],["F0789","E361"],["F0790","E362"],["F0791","E363"],["F0792","E364"],["F0793","E365"],["F0794","E366"],["F0806","E367"],["F0807","E368"],["F0808","E369"],["F0809","E36A"],["F0810","E36B"],["F0811","E36C"],["F0812","E36D"],["F0813","E36E"],["F0814","E370"],["F0815","E371"],["F0816","E372"],["F0817","E373"],["F0818","E374"],["F0819","E375"],["F0820","E376"],["F0821","E377"],["F0822","E378"],["F0823","E379"],["F0824","E37A"],["F0825","E37B"],["F0826","E37C"],["F0827","E37D"],["F0828","E37E"],["F0829","E380"],["F0830","E381"],["F0831","E382"],["F0717","E383"],["F0718","E384"],["F0241","E385"],["F0246","E386"],["F0250","E387"],["F0248","E388"],["F0252","E389"],["F0600","E38A"],["F0674","E38B"],["F0247","E38E"],["F0251","E390"]]},c={fontFamily:"Fiori2",collectionName:"Fiori6",icons:[["F0795","E397"],["F0866","E3A0"],["F0865","E3A1"],["F0867","E3A2"],["F0868","E3A3"],["F0869","E3A4"],["F0870","E3A5"],["F0138","E3A6"],["F0752","E3A7"],["F0753","E3A8"],["F0773","E3A9"],["F0891","E3AA"],["F0892","E3AB"],["F1023","E3AC"],["F0767","E3AD"],["F0849","E3AE"],["F0670-1","E393"],["F0670-2","E394"],["F0670-3","E395"],["F0670-4","E396"]]},d={fontFamily:"Fiori2",collectionName:"Fiori7",icons:[["F1079","E3B0"],["F0738","E3B1"],["F1301","E3B2"],["F1302","E3B3"],["F1303","E3B4"],["F1338","E3B5"],["F1263","E3B6"],["F1373","E3B7"],["F0863","E3B8"],["F1068","E3BA"],["F0955","E3B9"],["F1242","E3BB"],["F1405","E3BC"],["F1406","E3BD"],["F1407","E3BE"],["F1408","E3BF"],["F1409","E3C0"],["F1410","E3C1"],["F1411","E3C2"],["F1412","E3C3"],["F1413","E3C4"],["F1414","E3C5"],["F1415","E3C6"],["F0797","E3C8"],["F0798","E3C9"],["F0800","E3CA"],["F0801","E3CB"],["F0804","E3CC"],["F0850","E3CD"],["F0890","E3CE"],["F1075","E3CF"],["F1394","E3D0"],["F1061","E3D1"],["F1062","E3D2"],["F1255","E3D3"],["F1077","E3D4"],["F0843","E3D5"],["F1076","E3D6"],["F0859","E3D7"],["F1060","E3D8"],["F1053","E3D9"],["F0900","E3DA"],["F0840","E3DB"],["F0842-1","E3A6"],["F0842-2","E22C"],["F1476","E3C7"]]},e={fontFamily:"Fiori2",collectionName:"Fiori8",icons:[["F1317","E3DC"],["F1318","E3DD"],["F1319","E3DE"],["F1369","E3DF"],["F1475","E3E0"],["F1345","E3E1"],["F1248","E3E2"],["F1067","E3E3"],["F1332","E3E4"],["F1333","E3E5"],["F1334","E3E6"],["F1335","E3E7"],["F1030","E3E8"],["F1457","E3E9"],["F1504","E3EA"],["F1505","E3EB"]]},g={fontFamily:"Fiori2",collectionName:"Fiori9",icons:[["F1094","E3EC"],["F1096","E3ED"],["F1353","E3EE"],["F1354","E3EF"],["F1428","E3F0"],["F1492","E3F1"],["F1515","E3F2"],["F1516","E3F3"],["F0997","E400"],["F1512","E401"],["F1563","E402"],["F1564","E403"],["F1599","E404"],["F1596","E405"],["F1254","E406"],["F1618","E407"],["F1561","E408"]]},s={fontFamily:"Fiori2",collectionName:"S4Hana",icons:[["S0001","E3F4"],["S0002","E3F5"],["S0003","E3F6"],["S0004","E3F7"],["S0005","E3F8"],["S0006","E3F9"],["S0007","E3FA"],["S0008","E3FB"],["S0009","E3FC"],["S0010","E3FD"],["S0011","E3FE"],["S0012","E3FF"]]},t={fontFamily:"SAPIconsTNT",collectionName:"TNTIcons",icons:[["Technical System","e000"],["Java System","e001"],["ABAP System","e002"],["System","e004"],["System TREX","e005"],["System Tracks","e006"],["System Recommendation","e003"],["System HANA","e00e"],["Technical Scenario","e007"],["Technical Instance","e008"],["Throughput Backlog","e009"],["Batch Processing","e00a"],["Database Consistency","e00b"],["Intermediate Message","e00c"],["Exceptions","e00d"],["Python","e00f"],["Raise fault","e010"],["Code1","e011"],["Code2","e012"],["Spike arrest","e013"],["Verify API","e014"],["User","e015"],["Note","e016"],["Throwing message","e017"],["Catching message","e018"],["Start event","e019"],["End event","e01a"],["Gateway","e01b"],["Sub process marker","e01c"],["Ad hoc marker","e01d"],["Manual task","e01e"],["Send task","e01f"],["Receive task","e020"],["Script task","e021"],["Marquee","e022"],["Data input arrow","e023"],["Data output arrow","e024"],["More","e025"],["Pattern","e026"],["Task","e027"],["Arrow","e028"],["Data","e029"],["Data store","e02a"],["Pool","e02b"],["Swimlane","e02c"],["Select","e02d"],["Cursor","e02e"],["API","e02f"],["O Data","e030"],["Javascript","e031"],["Value mapping","e032"],["Terminate end event","e033"],["Parallel gateway","e034"],["Exclusive gateway","e035"],["Service task","e036"],["Workflow editor","e037"]]},h={fontFamily:"FioriInAppIcons",collectionName:"FioriInAppIcons",icons:[["Hierarchal Tree","E700"],["Open","E701"],["Blocked","E702"],["Partially Blocked","E703"],["Open1","E704"],["Partially Adopted","E705"],["Due","E706"],["Overdue","E707"],["Sort","E708"],["Missing Parts","E709"],["Fire","E70A"],["Dangerous Chemicals","E70B"],["Share","E70C"],["Entertainment","E70D"],["Gift","E70E"],["QR Code","E70F"],["Wifi-Online","E710"],["Wifi-Offline","E711"],["Sunrise","E712"],["Sunset","E713"],["Afternoon","E714"],["Night","E715"],["Loading Date","E715"],["Cloudy","e717"],["Rain","e718"],["Storm","e719"],["Partly Sunny","e71A"],["Heavy Rain","e71B"],["Foggy","e71C"],["Snow","e71D"],["Risk Assessment","e71E"],["Database","e71f"]]},i={fontFamily:"Fiori2",collectionName:"FioriNonNative",icons:[["FN0001","E392"],["FN0002","E398"],["FN0003","E399"],["FN0004","E39A"],["FN0005","E39B"],["FN0006","E39C"],["FN0007","E39D"],["FN0008","E39E"],["FN0009","E39F"]]};this.registerFonts(f,F,a,l,h,o,b,i,c,d,e,g,s,t);};sap.ushell.iconfonts.registerFonts=function(){var I,i,j;for(i=0;i<arguments.length;i=i+1){I=arguments[i];for(j=0;j<I.icons.length;j=j+1){sap.ui.core.IconPool.addIcon(I.icons[j][0],I.collectionName,I.fontFamily,I.icons[j][1],false,true);}}};}());};if(!jQuery.sap.isDeclared('sap.ushell.library')){jQuery.sap.declare("sap.ushell.library");jQuery.sap.require('sap.ui.core.Core');jQuery.sap.require('sap.ui.core.library');jQuery.sap.require('sap.ui.layout.library');jQuery.sap.require('sap.m.library');sap.ui.getCore().initLibrary({name:"sap.ushell",dependencies:["sap.ui.core","sap.ui.layout","sap.m"],types:["sap.ushell.ui.launchpad.ViewPortState","sap.ushell.ui.tile.State","sap.ushell.ui.tile.StateArrow"],interfaces:[],controls:["sap.ushell.components.factsheet.controls.PictureTile","sap.ushell.components.factsheet.controls.PictureViewer","sap.ushell.components.factsheet.controls.PictureViewerItem","sap.ushell.ui.appfinder.AppBox","sap.ushell.ui.footerbar.AboutButton","sap.ushell.ui.footerbar.AddBookmarkButton","sap.ushell.ui.footerbar.ContactSupportButton","sap.ushell.ui.footerbar.EndUserFeedback","sap.ushell.ui.footerbar.HideGroupsButton","sap.ushell.ui.footerbar.JamDiscussButton","sap.ushell.ui.footerbar.JamShareButton","sap.ushell.ui.footerbar.LogoutButton","sap.ushell.ui.footerbar.SettingsButton","sap.ushell.ui.footerbar.UserPreferencesButton","sap.ushell.ui.launchpad.ActionItem","sap.ushell.ui.launchpad.AnchorItem","sap.ushell.ui.launchpad.AnchorNavigationBar","sap.ushell.ui.launchpad.DashboardGroupsContainer","sap.ushell.ui.launchpad.EmbeddedSupportErrorMessage","sap.ushell.ui.launchpad.Fiori2LoadingDialog","sap.ushell.ui.launchpad.GroupHeaderActions","sap.ushell.ui.launchpad.GroupListItem","sap.ushell.ui.launchpad.HeaderTile","sap.ushell.ui.launchpad.LinkTileWrapper","sap.ushell.ui.launchpad.LoadingDialog","sap.ushell.ui.launchpad.Panel","sap.ushell.ui.launchpad.PlusTile","sap.ushell.ui.launchpad.Tile","sap.ushell.ui.launchpad.TileContainer","sap.ushell.ui.launchpad.TileState","sap.ushell.ui.launchpad.ViewPortContainer","sap.ushell.ui.tile.DynamicTile","sap.ushell.ui.tile.ImageTile","sap.ushell.ui.tile.StaticTile","sap.ushell.ui.tile.TileBase"],elements:[],version:"1.44.6"});jQuery.sap.declare("sap.ushell.ui.launchpad.ViewPortState");sap.ushell.ui.launchpad.ViewPortState={Left:"Left",Center:"Center",Right:"Right",LeftCenter:"LeftCenter",CenterLeft:"CenterLeft",RightCenter:"RightCenter",CenterRight:"CenterRight"};jQuery.sap.declare("sap.ushell.ui.tile.State");sap.ushell.ui.tile.State={Neutral:"Neutral",None:"None",Negative:"Negative",Error:"Error",Positive:"Positive",Success:"Success",Critical:"Critical",Warning:"Warning"};jQuery.sap.declare("sap.ushell.ui.tile.StateArrow");sap.ushell.ui.tile.StateArrow={None:"None",Up:"Up",Down:"Down"};};if(!jQuery.sap.isDeclared('sap.ushell.override')){(function(){"use strict";jQuery.sap.declare("sap.ushell.override");sap.ushell.override={};sap.ushell.override.updateAggregation=function(n){if(this.isTreeBinding(n)){sap.ui.base.ManagedObject.prototype.updateAggregation.apply(this,arguments);}else{var b=this.mBindingInfos[n],B=b.binding,a=B.getContexts(),f=b.factory,A=this.getMetadata().getJSONKeys()[n],g=A._sMutator+"Group",G=B.isGrouped()&&this[g],i=0,I=[],c=jQuery.proxy(function(C){var s=this.getId()+"-"+jQuery.sap.uid(),o=f(s,C);o.setBindingContext(C,b.model);this[A._sMutator](o);},this);if(G){sap.ui.base.ManagedObject.prototype.updateAggregation.apply(this,arguments);}else{I=this[A._sGetter]();for(i=0;i<a.length;++i){if(i<I.length){I[i].setBindingContext(a[i],b.model);}else{c(a[i]);}}for(;i<I.length;++i){I[i].destroy();}I.length=a.length;}}};sap.ushell.override.updateAggregationGrouped=function(n){var b=this.mBindingInfos[n],B=b.binding,f=b.factory,c,N=null,g=null,G=null,t=this,I=t.getItems(),l=0,L=0,i,s,T=[];g=B.isGrouped()&&this.addItemGroup;jQuery.each(B.getContexts(),function(a,C){if(g&&B.aSorters.length>0){N=B.aSorters[0].fnGroup(C);if(typeof N==="string"){N={key:N};}if(N.key!==G){var o,h;if(b.groupHeaderFactory){o=b.groupHeaderFactory(N);}h=o||new sap.m.GroupHeaderListItem({title:N.text||N.key}).addStyleClass("sapMListHdr");t.insertAggregation("items",h,L,true);L=L+1;G=N.key;}}I=t.getItems();for(i=L;i<I.length;i=i+1){if(I[i].constructor===sap.m.GroupHeaderListItem){T.push(t.removeItem(I[i]));I=t.getItems();}}if(L<I.length){I[L].setBindingContext(C,b.model);if(I[L].aDelegates){jQuery.each(I[L].aDelegates,function(i,v){v.vThis=C;});}}else{s=t.getId()+"-"+L;c=f(s,C);c.setBindingContext(C,b.model);t.addItem(c);}L=L+1;l=L;});for(i=I.length-1;i>=l;i=i-1){T.push(t.removeItem(I[i]));}setTimeout(function(){jQuery.each(T,function(i,v){v.destroy();});},1);};sap.ushell.override.updateAggregatesFactory=function(n){return function(){jQuery.proxy(sap.ushell.override.updateAggregation,this,n)();};};}());};if(!jQuery.sap.isDeclared('sap.ushell.plugins.rta.Component')){jQuery.sap.declare('sap.ushell.plugins.rta.Component');jQuery.sap.require('sap.ui.core.Component');jQuery.sap.require('sap.ui.model.resource.ResourceModel');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.ui.core.BusyIndicator');sap.ui.define("sap/ushell/plugins/rta/Component",["sap/ui/core/Component","sap/ui/model/resource/ResourceModel","sap/m/MessageBox","sap/ui/core/BusyIndicator"],function(C,R,M,B){"use strict";var c="sap.ushell.plugins.rta";var a=sap.ui.core.Component.extend("sap.ushell.plugins.rta.Component",{metadata:{manifest:"json"},_getRenderer:function(){var t=this,d=new jQuery.Deferred(),r;t._oShellContainer=jQuery.sap.getObject("sap.ushell.Container");if(!t._oShellContainer){d.reject("Illegal state: shell container not available; this component must be executed in a unified shell runtime context.");}else{r=t._oShellContainer.getRenderer();if(r){d.resolve(r);}else{t._onRendererCreated=function(e){r=e.getParameter("renderer");if(r){d.resolve(r);}else{d.reject("Illegal state: shell renderer not available after recieving 'rendererCreated' event.");}};t._oShellContainer.attachRendererCreatedEvent(t._onRendererCreated);}}return d.promise();},init:function(){var t=this;this.i18n=this.getModel("i18n").getResourceBundle();this._getRenderer().fail(function(e){jQuery.sap.log.error(e,undefined,c);}).done(function(r){var A=sap.ushell.Container.getService("AppLifeCycle");A.attachAppLoaded(function(e){var u=t._checkUI5App();if(u&&!e.mParameters.homePage){t._checkRestartRTA();}});var _=function(e){var s=((sap.ui.Device.browser.msie&&sap.ui.Device.browser.version>10)||sap.ui.Device.browser.webkit||sap.ui.Device.browser.firefox);if(!s){M.error(t.i18n.getText("MSG_UNSUPPORTED_BROWSER"),{title:t.i18n.getText("ERROR_TITLE"),onClose:null});}else{window.setTimeout(function(){t._switchToAdaptionMode();},0);}};r.addActionButton("sap.ushell.ui.launchpad.ActionItem",{id:"RTA_Plugin_ActionButton",text:t.i18n.getText("RTA_BUTTON_TEXT"),icon:"sap-icon://wrench",press:_},true,false,[r.LaunchpadState.App]);});},exit:function(){if(this._oShellContainer&&this._onRendererCreated){this._oShellContainer.detachRendererCreatedEvent(this._onRendererCreated);}},_checkUI5App:function(){var o=this._getCurrentRunningApplication();var u=o&&o.applicationType==="UI5";return u;},_checkRestartRTA:function(){var r=!!window.localStorage.getItem("sap.ui.rta.restart");if(r){window.localStorage.removeItem("sap.ui.rta.restart");this._switchToAdaptionMode();}},_getCurrentRunningApplication:function(){var A=sap.ushell.Container.getService("AppLifeCycle");var o=A.getCurrentApplication();return o;},_switchToDefaultMode:function(){if(this._oRTA){this._oRTA.destroy();this._oRTA=null;}},_switchToAdaptionMode:function(){var t=this;var u=this._checkUI5App();if(!u){M.error(this.i18n.getText("MSG_UNSUPPORTED_APP"),{title:this.i18n.getText("ERROR_TITLE"),onClose:null});return;}var o=this._getCurrentRunningApplication();var r=o.componentInstance.getAggregation("rootControl");if(!this._oRTA){B.show(0);sap.ui.getCore().loadLibraries(["sap.ui.dt","sap.ui.rta"],{async:true}).then(function(){sap.ui.require(["sap/ui/rta/RuntimeAuthoring"],function(b){try{t._oRTA=new b({rootControl:r});t._oRTA.attachEvent('start',function(){B.hide();},t);t._oRTA.attachEvent('failed',function(){B.hide();t._switchToDefaultMode();M.error(this.i18n.getText("MSG_ADAPTUI_FAILED"),{title:this.i18n.getText("ERROR_TITLE"),onClose:null});},t);t._oRTA.start();t._oRTA.attachEvent('stop',t._switchToDefaultMode,t);}catch(e){B.hide();jQuery.sap.log.error("exception occured while starting sap.ui.rta",e);t._switchToDefaultMode();M.error(t.i18n.getText("MSG_ADAPTUI_FAILED"),{title:t.i18n.getText("ERROR_TITLE"),onClose:null});}});});}}});return a;},true);};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.AccessKeysHandler')){(function(){"use strict";jQuery.sap.declare("sap.ushell.renderers.fiori2.AccessKeysHandler");var a=function(){};a.prototype={keyCodes:jQuery.sap.KeyCodes,bFocusOnShell:true,bFocusPassedToExternalHandlerFirstTime:true,isFocusHandledByAnotherHandler:false,fnExternalKeysHandler:null,sLastExternalKeysHandlerUrl:null,fnExternalShortcuts:null,isleftAltPressed:false,bForwardNavigation:true,appOpenedHandler:function(){var c=hasher.getHash();if(c!==this.sLastExternalKeysHandlerUrl){this.fnExternalKeysHandler=null;}this.sLastExternalKeysHandlerUrl=c;},handleSearchKey:function(){var s=sap.ui.getCore().byId('sf');if(s&&$('#sf:visible').length===0){return;}jQuery(s).click();},setFocusOnSearchButton:function(e){e.preventDefault();var s=sap.ui.getCore().byId('sf');if(s){jQuery(s).focus();}},handleSearchAppFinderKey:function(e){var b=sap.ui.getCore().byId('appFinderSearch');if(!b||jQuery('#appFinderSearch:visible').length===0){return;}else if(jQuery('.sapUshellViewPortCenter').hasClass('centerClass')){jQuery(b).focus();e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();}},handleNavToMeArea:function(){var m=sap.ui.getCore().byId("meAreaHeaderButton"),M=sap.ui.getCore().byId("mainShell"),A;if(M){A=M.getController().getModelConfiguration().appState;}if(m&&!m.getSelected()&&A!="headerless"){var s=sap.ui.getCore().byId("mainShell").oController;s.loadMeAreaView();m.firePress();}setTimeout(function(){jQuery(".sapUshellActionItem:first").focus();},300);},handleSettingsButton:function(){var m=sap.ui.getCore().byId("meAreaHeaderButton");if(m&&!m.getSelected()){var s=sap.ui.getCore().byId("mainShell").oController;s.loadMeAreaView();m.firePress();}setTimeout(function(){jQuery("#userSettingsBtn").focus();},300);},handleNavToNotifications:function(){var n=sap.ui.getCore().byId("NotificationsCountButton"),m=sap.ui.getCore().byId("mainShell"),A;if(m){A=m.getController().getModelConfiguration().appState;}if(n&&A!="headerless"){n.firePress();setTimeout(function(){jQuery("#notificationsView .sapUshellNotificationsListItem:visible:first").focus();},2000);}},handleSettings:function(){var s,u=sap.ui.getCore().byId('userSettingsBtn');if(!u){s=sap.ui.getCore().byId("mainShell").oController;s.loadMeAreaView();u=sap.ui.getCore().byId('userSettingsBtn');}u.firePress();},handleAccessOverviewKey:function(){var t=sap.ushell.resources.i18n,i=this.oModel.getProperty("/searchAvailable"),m=sap.ui.getCore().byId("mainShell"),c=[],s,d,A,o;if(m){A=m.getController().getModelConfiguration().appState;}this.aShortcutsDescriptions.forEach(function(v){c.push(new sap.m.Label({text:v.text}));c.push(new sap.m.Text({text:v.description}));});if(i){c.push(new sap.m.Label({text:"Alt+F"}));c.push(new sap.m.Text({text:t.getText("hotkeyFocusOnSearchButton")}));}if(A!="headerless"){c.push(new sap.m.Label({text:"Alt+M"}));c.push(new sap.m.Text({text:t.getText("hotkeyFocusOnMeArea")}));c.push(new sap.m.Label({text:"Alt+N"}));c.push(new sap.m.Text({text:t.getText("hotkeyFocusOnNotifications")}));}c.push(new sap.m.Label({text:"Alt+S"}));c.push(new sap.m.Text({text:t.getText("hotkeyFocusOnSettingsButton")}));c.push(new sap.m.Label({text:"Ctrl+Comma"}));c.push(new sap.m.Text({text:t.getText("hotkeyOpenSettings")}));if(i){c.push(new sap.m.Label({text:"Ctrl+Shift+F"}));c.push(new sap.m.Text({text:t.getText("hotkeyFocusOnSearchField")}));}s=new sap.ui.layout.form.SimpleForm({editable:false,content:c});o=new sap.m.Button({text:t.getText("okBtn"),press:function(){d.close();}});d=new sap.m.Dialog({id:"hotKeysGlossary",title:t.getText("hotKeysGlossary"),contentWidth:"29.6rem",leftButton:o,afterClose:function(){d.destroy();}});d.addContent(s);d.open();},handleShortcuts:function(e){if(e.altKey){switch(String.fromCharCode(e.keyCode)){case'M':this.handleNavToMeArea();break;case'N':this.handleNavToNotifications();break;case'S':this.handleSettingsButton();break;case'F':this.setFocusOnSearchButton(e);break;}}if(e.ctrlKey){if(e.shiftKey){if(e.keyCode===70){this.handleSearchKey();}}else{if(e.keyCode===188){this.handleSettings();}else if(e.keyCode===112){this.handleAccessOverviewKey();}else if(e.keyCode===83){this.handleSearchAppFinderKey(e);}}}},registerAppKeysHandler:function(h){this.fnExternalKeysHandler=h;this.sLastExternalKeysHandlerUrl=hasher.getHash();},resetAppKeysHandler:function(){this.fnExternalKeysHandler=null;},getAppKeysHandler:function(){return this.fnExternalKeysHandler;},registerAppShortcuts:function(h,s){this.fnExternalShortcuts=h;this.aShortcutsDescriptions=s;},_handleFocusBackToMe:function(e,i){this.bFocusOnShell=true;if(i){jQuery("#"+i).focus();}else if(!e){jQuery("#meAreaHeaderButton").focus();}else if(e.shiftKey){this.bForwardNavigation=false;if(e.keyCode===jQuery.sap.KeyCodes.TAB){jQuery("#sapUshellHeaderAccessibilityHelper").focus();}else if(e.keyCode===jQuery.sap.KeyCodes.F6){e.preventDefault();jQuery("#meAreaHeaderButton").focus();}}else{this.bForwardNavigation=true;e.preventDefault();if(!jQuery("#meAreaHeaderButton").length){jQuery("#sapUshellHeaderAccessibilityHelper").focus();}else{jQuery("#meAreaHeaderButton").focus();}}this.bFocusPassedToExternalHandlerFirstTime=true;},setIsFocusHandledByAnotherHandler:function(h){this.isFocusHandledByAnotherHandler=h;},sendFocusBackToShell:function(p){var e=undefined,i=undefined;var P=typeof p;if(P==="string"){i=p;}else if(P==="object"){e=p;}this._handleFocusBackToMe(e,i);},init:function(m){this.oModel=m;document.addEventListener("keydown",function(e){if(e.keyCode==jQuery.sap.KeyCodes.ARROW_UP||e.keyCode==jQuery.sap.KeyCodes.ARROW_DOWN){if(!e.ctrlKey||e.doNotInterrupt){return true;}try{var n=new Event(e.type);}catch(b){var n=document.createEvent("Event");n.initEvent("keydown",true,true);}jQuery.extend(n,e);e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();n.doNotInterrupt=true;document.dispatchEvent(n);}return true;},true);jQuery(document).on('keydown',function(e){if(e.keyCode===16){return;}if(e.shiftKey){this.bForwardNavigation=false;}else{this.bForwardNavigation=true;}if(!this.bFocusOnShell&&!this.isFocusHandledByAnotherHandler){if(this.fnExternalKeysHandler&&jQuery.isFunction(this.fnExternalKeysHandler)){this.fnExternalKeysHandler(e,this.bFocusPassedToExternalHandlerFirstTime);this.bFocusPassedToExternalHandlerFirstTime=false;}}if(e.keyCode===18){if(e.originalEvent.location===window.KeyboardEvent.DOM_KEY_LOCATION_LEFT){this.isleftAltPressed=true;}else{this.isleftAltPressed=false;}}if(this.isleftAltPressed||!e.altKey){this.handleShortcuts(e);if(this.fnExternalShortcuts){this.fnExternalShortcuts(e);}}this.setIsFocusHandledByAnotherHandler(false);}.bind(this));}};sap.ushell.renderers.fiori2.AccessKeysHandler=new a();sap.ui.getCore().getEventBus().subscribe("sap.ushell.renderers.fiori2.Renderer","appOpened",a.prototype.appOpenedHandler.bind(sap.ushell.renderers.fiori2.AccessKeysHandler));}());};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.History')){(function(){"use strict";jQuery.sap.declare("sap.ushell.renderers.fiori2.History");sap.ushell.renderers.fiori2.History=function(){this._history=[];this.backwards=false;this._historyPosition=-1;this._virtual={};};sap.ushell.renderers.fiori2.History.prototype.hashChange=function(n,o){var h=this._history.indexOf(n);if(h===-1){if(this._historyPosition+1<this._history.length){this._history=this._history.slice(0,this._historyPosition+1);}this._history.push(n);this._historyPosition+=1;this.backwards=false;this.forwards=false;}else{this.backwards=this._historyPosition>h;this.forwards=this._historyPosition<h;this._historyPosition=h;}};sap.ushell.renderers.fiori2.History.prototype.pop=function(){var l;if(this._history.length>0){l=this._history.pop();this._historyPosition--;}return l;};sap.ushell.renderers.fiori2.History.prototype.isVirtualHashchange=function(n,o){return this._virtual.hasOwnProperty(o)&&this.getCurrentHash()===n&&this._history.length-1>this._historyPosition&&this._history[this._historyPosition+1]===o;};sap.ushell.renderers.fiori2.History.prototype.setVirtualNavigation=function(h){this._virtual[h]=true;};sap.ushell.renderers.fiori2.History.prototype.getCurrentHash=function(){return this._history[this._historyPosition]||null;};sap.ushell.renderers.fiori2.History.prototype.getHashIndex=function(h){return this._history.indexOf(h);};sap.ushell.renderers.fiori2.History.prototype.getHistoryLength=function(){return this._history.length;};}());};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.Lifecycle')){(function(){"use strict";jQuery.sap.declare("sap.ushell.renderers.fiori2.Lifecycle");var l="sap.ushell",e,E={rendererLoaded:{oldNamespace:"sap.ushell.renderers.fiori2.Renderer",newEventName:"rendererLoaded"},componentCreated:{oldNamespace:"sap.ushell.components.container.ApplicationContainer",newEventName:"appComponentLoaded"},appOpened:{oldNamespace:"launchpad",newEventName:"appOpened"},appClosed:{oldNamespace:"launchpad",newEventName:"appClosed"},coreExtLoaded:{oldNamespace:"launchpad",newEventName:"coreResourcesFullyLoaded"}};function _(n,e,d){setTimeout(function(){sap.ui.getCore().getEventBus().publish(l,e,d);},0);}function a(n,s,d){var m=E[s];if(m!==undefined){_(l,m.newEventName,d);}}for(e in E){sap.ui.getCore().getEventBus().subscribe(E[e].oldNamespace,e,a);}}());};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.Navigation')){(function(){"use strict";jQuery.sap.declare("sap.ushell.renderers.fiori2.Navigation");sap.ushell.renderers.fiori2.Navigation=function(){this.SEARCH={ID:"ShellSearch",SEMANTICOBJECT:"shell",ACTION:"search"};sap.ushell.Container.getService("NavTargetResolution").registerCustomResolver({name:"Search App Container",isApplicable:function(h){return h==="#Action-search";},resolveHashFragment:function(h){var d=new jQuery.Deferred(),r={};if(h==="#Action-search"){r={"additionalInformation":"SAPUI5.Component=sap.ushell.renderers.fiori2.search.container","applicationType":"URL","url":jQuery.sap.getResourcePath("sap/ushell/renderers/fiori2/search/container"),"loadCoreExt":false,"loadDefaultDependencies":false};}d.resolve(r);return d.promise();}});};sap.ushell.Container.getService("NavTargetResolution").registerCustomResolver({name:"FLP Resolver",isApplicable:function(h){h=(typeof h==="string")?h:"";h=h.split("?")[0];return h==="#Shell-home"||h==="#shell-catalog";},resolveHashFragment:function(h){var d=new jQuery.Deferred(),r={};h=(typeof h==="string")?h:"";h=h.split("?")[0];if(h==="#Shell-home"||h==="#shell-catalog"){r={"additionalInformation":"SAPUI5.Component=sap.ushell.components.flp","applicationType":"URL","url":jQuery.sap.getResourcePath("sap/ushell/components/flp"),"loadCoreExt":false,"loadDefaultDependencies":false};}d.resolve(r);return d.promise();}});sap.ushell.renderers.fiori2.Navigation=new sap.ushell.renderers.fiori2.Navigation();}());};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.RendererExtensions')){(function(){"use strict";jQuery.sap.declare("sap.ushell.renderers.fiori2.RendererExtensions");function _(C){a("rendererLoaded",{rendererName:"fiori2"});}function a(E,D){setTimeout(function(){sap.ui.getCore().getEventBus().publish("sap.ushell.renderers.fiori2.Renderer",E,D);},0);}sap.ushell.renderers.fiori2.utils={};sap.ushell.renderers.fiori2.utils.publishExternalEvent=a;sap.ushell.renderers.fiori2.utils.init=_;function b(I,L,w){sap.ushell.Container.getRenderer("fiori2").showSubHeader(I.getId(),false,[L,w]);}function c(I,L,w){sap.ushell.Container.getRenderer("fiori2").hideSubHeader(I.getId(),false,[L,w]);}function d(I,L,w){sap.ushell.Container.getRenderer("fiori2").showHeaderItem(I.getId(),false,[L,w]);}function e(I,L,w){sap.ushell.Container.getRenderer("fiori2").hideHeaderItem(I.getId(),false,[L,w]);}function f(B,L,w){sap.ushell.Container.getRenderer("fiori2").showActionButton(B.getId(),false,[L,w]);}function g(B,L,w){sap.ushell.Container.getRenderer("fiori2").hideActionButton(B.getId(),false,[L,w]);}function h(C,L,w){sap.ushell.Container.getRenderer("fiori2").showLeftPaneContent(C.getId(),false,[L,w]);}function i(L,w){sap.ushell.Container.getRenderer("fiori2").hideLeftPaneContent(false,[L,w]);}function j(I,L,w){sap.ushell.Container.getRenderer("fiori2").showFloatingActionButton(I.getId(),false,[L,w]);}function k(I,L,w){sap.ushell.Container.getRenderer("fiori2").hideFloatingActionButton(I.getId(),false,[L,w]);}function l(I,L,w){sap.ushell.Container.getRenderer("fiori2").showHeaderEndItem(I.getId(),false,[L,w]);}function m(I,L,w){sap.ushell.Container.getRenderer("fiori2").hideHeaderEndItem(I.getId(),false,[L,w]);}function n(){return sap.ushell.Container.getRenderer("fiori2").getModelConfiguration();}function o(I,L,T,w){var x=sap.ui.getCore().byId(I);if(w){sap.ushell.Container.getRenderer("fiori2").showHeaderItem(x.getId(),T,[L]);}}function p(C,S){sap.ushell.Container.getRenderer("fiori2").addEndUserFeedbackCustomUI(C,S);}function q(w){sap.ushell.Container.getRenderer("fiori2").addUserPreferencesEntry(w);}function r(T){sap.ushell.Container.getRenderer("fiori2").setHeaderTitle(T);}function s(L,V){sap.ushell.Container.getRenderer("fiori2").setLeftPaneVisibility(L,V);}function t(H){sap.ushell.Container.getRenderer("fiori2").setHeaderHiding(H);}function u(F){sap.ushell.Container.getRenderer("fiori2").setFooter(F);}function v(){sap.ushell.Container.getRenderer("fiori2").removeFooter();}function R(){this.addHeaderItem=d;this.setHeaderItemVisibility=o;this.addSubHeader=b;this.removeSubHeader=c;this.addHeaderEndItem=l;this.removeHeaderItem=e;this.removeHeaderEndItem=m;this.addEndUserFeedbackCustomUI=p;this.addOptionsActionSheetButton=f;this.removeOptionsActionSheetButton=g;this.setFooter=u;this.removeFooter=v;this.addUserPreferencesEntry=q;this.setHeaderTitle=r;this.setHeaderHiding=t;this.LaunchpadState={App:"app",Home:"home"};this.addFloatingActionButton=j;this.removeFloatingActionButton=k;this.setLeftPaneContent=h;this.removeLeftPaneContent=i;this.setLeftPaneVisibility=s;this.getConfiguration=n;}sap.ushell.renderers.fiori2.RendererExtensions=new R();}());};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.ShellModel')){(function(){"use strict";jQuery.sap.declare("sap.ushell.renderers.fiori2.ShellModel");var a=sap.ui.Device.system.phone;var m={animationMode:"full",searchAvailable:false,title:"",searchFiltering:true,showEndUserFeedback:false,searchTerm:"",isPhoneWidth:false,enableNotifications:false,enableNotificationsUI:false,notificationsCount:0,currentViewPortState:"Center",userStatus:undefined,customStatesDelta:{"home":{"actions":["ContactSupportBtn","EndUserFeedbackBtn"]},"app":{"actions":["ContactSupportBtn","EndUserFeedbackBtn","aboutBtn"]},"minimal":{"actions":["ContactSupportBtn","EndUserFeedbackBtn","aboutBtn"]},"standalone":{"actions":["ContactSupportBtn","EndUserFeedbackBtn","aboutBtn"]},"embedded":{"actions":["ContactSupportBtn","EndUserFeedbackBtn","aboutBtn"]},"embedded-home":{"actions":["ContactSupportBtn","EndUserFeedbackBtn","aboutBtn"]}},states:{"blank":{"stateName":"blank","showCurtain":false,"headerHiding":a,"headerVisible":true,"headEndItems":[],"showCatalog":false,"showPane":false,"showRightFloatingContainer":true,"paneContent":[],"headItems":[],"actions":[],"floatingActions":[],"subHeader":[],"toolAreaItems":[],"RightFloatingContainerItems":[],"toolAreaVisible":false,"floatingContainerContent":[],"application":{}},"blank-home":{"stateName":"blank-home","showCurtain":false,"headerHiding":a,"headerVisible":true,"headEndItems":[],"showCatalog":false,"showPane":false,"showRightFloatingContainer":true,"paneContent":[],"headItems":[],"actions":[],"floatingActions":[],"subHeader":[],"toolAreaItems":[],"RightFloatingContainerItems":[],"toolAreaVisible":false,"floatingContainerContent":[],"application":{}},"home":{"stateName":"home","showCurtain":false,"headerHiding":false,"headerVisible":true,"showCatalog":false,"showPane":false,"showRightFloatingContainer":true,"headItems":['meAreaHeaderButton'],"headEndItems":["sf"],"search":"","paneContent":[],"actions":["openCatalogBtn","userSettingsBtn"],"floatingActions":[],"subHeader":[],"toolAreaItems":[],"RightFloatingContainerItems":[],"toolAreaVisible":false,"floatingContainerContent":[],"application":{}},"app":{"stateName":"app","showCurtain":false,"headerHiding":a,"headerVisible":true,"headEndItems":["sf"],"showCatalog":false,"showPane":false,"showRightFloatingContainer":true,"paneContent":[],"search":"","headItems":['meAreaHeaderButton','backBtn','homeBtn'],"actions":["openCatalogBtn","userSettingsBtn"],"floatingActions":[],"subHeader":[],"toolAreaItems":[],"RightFloatingContainerItems":[],"toolAreaVisible":false,"floatingContainerContent":[],"application":{}},"minimal":{"stateName":"minimal","showCurtain":false,"headerHiding":false,"headerVisible":true,"headEndItems":[],"showCatalog":false,"showPane":false,"showRightFloatingContainer":true,"paneContent":[],"headItems":['meAreaHeaderButton','homeBtn'],"actions":["openCatalogBtn","userSettingsBtn"],"floatingActions":[],"subHeader":[],"toolAreaItems":[],"RightFloatingContainerItems":[],"toolAreaVisible":false,"floatingContainerContent":[],"application":{}},"standalone":{"stateName":"standalone","showCurtain":false,"headerHiding":a,"headerVisible":true,"headEndItems":[],"showCatalog":false,"showPane":false,"showRightFloatingContainer":true,"paneContent":[],"headItems":['meAreaHeaderButton','backBtn'],"actions":[],"floatingActions":[],"subHeader":[],"toolAreaItems":[],"RightFloatingContainerItems":[],"toolAreaVisible":false,"floatingContainerContent":[],"application":{}},"embedded":{"stateName":"embedded","showCurtain":false,"headerHiding":a,"headerVisible":true,"headEndItems":[],"showCatalog":false,"showPane":false,"showRightFloatingContainer":true,"paneContent":[],"headItems":['meAreaHeaderButton','backBtn','homeBtn'],"actions":[],"floatingActions":[],"subHeader":[],"toolAreaItems":[],"RightFloatingContainerItems":[],"toolAreaVisible":false,"floatingContainerContent":[],"application":{}},"embedded-home":{"stateName":"embedded-home","showCurtain":false,"headerHiding":a,"headerVisible":true,"headEndItems":[],"showCatalog":false,"showPane":false,"showRightFloatingContainer":true,"paneContent":[],"headItems":['meAreaHeaderButton'],"actions":[],"floatingActions":[],"subHeader":[],"toolAreaItems":[],"RightFloatingContainerItems":[],"toolAreaVisible":false,"floatingContainerContent":[],"application":{}},"headerless":{"stateName":"headerless","showCurtain":false,"headerHiding":a,"headerVisible":false,"headEndItems":[],"showCatalog":false,"showPane":false,"showLogo":false,"showRightFloatingContainer":true,"paneContent":[],"headItems":['backBtn','homeBtn'],"actions":[],"floatingActions":[],"subHeader":[],"toolAreaItems":[],"RightFloatingContainerItems":[],"toolAreaVisible":false,"floatingContainerContent":[],"application":{}},"merged":{"stateName":"merged","showCurtain":false,"headerHiding":a,"headerVisible":true,"headEndItems":[],"showCatalog":false,"showPane":false,"showLogo":false,"showRightFloatingContainer":true,"paneContent":[],"headItems":['backBtn','homeBtn'],"actions":[],"floatingActions":[],"subHeader":[],"toolAreaItems":[],"RightFloatingContainerItems":[],"toolAreaVisible":false,"floatingContainerContent":[],"application":{}},"headerless-home":{"stateName":"headerless-home","showCurtain":false,"headerHiding":a,"headerVisible":false,"headEndItems":[],"showCatalog":false,"showPane":false,"showLogo":false,"showRightFloatingContainer":true,"paneContent":[],"headItems":[],"actions":[],"floatingActions":[],"subHeader":[],"toolAreaItems":[],"RightFloatingContainerItems":[],"toolAreaVisible":false,"floatingContainerContent":[],"application":{}},"merged-home":{"stateName":"merged-home","showCurtain":false,"headerHiding":a,"headerVisible":true,"headEndItems":[],"showCatalog":false,"showPane":false,"showLogo":false,"showRightFloatingContainer":true,"paneContent":[],"headItems":[],"actions":[],"floatingActions":[],"subHeader":[],"toolAreaItems":[],"RightFloatingContainerItems":[],"toolAreaVisible":false,"floatingContainerContent":[],"application":{}}},userPreferences:{entries:[]}};function v(i,b,s){return b!=undefined;}function n(i,b,s){return true;}function u(b,V,c){c.setProperty(b,V);}function S(){var M;var c;var s;var C;var e;var o;var I;var b;var E;var d;var t;var f;this.createDefault=function(){var r=function(g,h,D){if(D.sProperty=="actions"){var A=D.oModel.getProperty(D.path);if(A&&A.length===0&&D.aIds&&D.aIds.length>0){this._renderShellState();}}}.bind(this);this.createTriggers([{sName:'onAddFirstAction',fnRegister:function(){sap.ui.getCore().getEventBus().subscribe("launchpad","updateShell",r,this);},fnUnRegister:function(){sap.ui.getCore().getEventBus().unsubscribe("launchpad","updateShell",r,this);}}],false,["blank","blank-home"]);this.createInspection("actions",[{fnCondition:function(i,g,T){return(i&&i.length>0)||(g&&g.length>0);},fnAction:function(i,g,T){if(g.indexOf("meAreaHeaderButton")===-1){T.addHeaderItem(["meAreaHeaderButton"],true);}}}],false,["blank-home","blank"]);};this.init=function(g){M=new sap.ui.model.json.JSONModel(m);s=M;c={};e={};o={};I=false;b=false;d=false;t=[];f=true;E=undefined;this.createDefault();var i=g&&g.appState?g.appState:"home";this.switchState(i);};this.destroy=function(){M=undefined;s=undefined;c=undefined;e=undefined;o=undefined;I=undefined;b=undefined;f=undefined;d=undefined;E=undefined;};this.getModel=function(){return M;};this.switchState=function(g,h){var p=g[0]==="/"?g:"/states/"+g,i=M.getProperty(p),j=M.getProperty("/currentState")||{},k=["home","embedded-home","headerless-home","merged-home","blank-home"];if(!!h){M.setProperty("/lastState",j);}this._destroyManageQueue(k);M.setProperty("/currentState",jQuery.extend(true,{},{},i));if(!e[g]){e[g]={extendedShellStates:{},oCheckPoints:{},aTriggers:[],customShellState:this._createCustomShellState(g)};}C=e[g].customShellState;E=undefined;this._renderShellState();return i;};this.setHeaderHiding=function(h){this.updateStateProperty("headerHiding",h,true);};this.setHeaderVisibility=function(V,g,h){this.updateStateProperty("headerVisible",V,g,h);};this.showLogo=function(g,h){this.updateStateProperty("showLogo",true,g,h,false);};this.addHeaderItem=function(i,g,h){this._addHeaderItemInCorrectOrder("headItems",i,g,h);};this._removeReservedItemId=function(r,g,i){var A=false,R=i.indexOf(r);if(R>-1){i.splice(R,1);A=true;}R=g.indexOf(r);if(R>-1){g.splice(R,1);A=true;}return A;};this._addHeaderItemInCorrectOrder=function(p,i,g,h){var j=this;function V(k,l,q){var A=3-k.length;l.forEach(function(r,w){var x=(r==='meAreaHeaderButton'||r==='backBtn'||r==='homeBtn');if(k[r]===-1&&!x){A--;}});if(A<0){jQuery.sap.log.warning("Maximum of three items has been reached, cannot add more items.");return false;}return true;}function U(k,l,q){var r=q.getProperty(k),w=[],x=l.slice(0);if(j._removeReservedItemId("meAreaHeaderButton",r,x)===true){w.push("meAreaHeaderButton");}if(j._removeReservedItemId("backBtn",r,x)===true){w.push("backBtn");}if(j._removeReservedItemId("homeBtn",r,x)===true){w.push("homeBtn");}r.some(function(y){if(w.length<3){w.push(y);}else{return true;}});x.some(function(y){if(w.length<3){w.push(y);}else{return true;}});q.setProperty(k,w);}this._setShellItem(p,i,g,h,V,U);};this.removeHeaderItem=function(i,g,h){this._removeShellItem("headItems",i,g,h);};this.addHeaderEndItem=function(i,g,h,D){if(i.length){this._addUpToThreeItem("headEndItems",i,g,h,D);}};this.removeHeaderEndItem=function(i,g,h){this._removeShellItem("headEndItems",i,g,h);};this.addSubHeader=function(i,g,h){if(i.length){this._addShellItem("subHeader",i,g,h);}};this.removeSubHeader=function(i,g,h){this._removeShellItem("subHeader",i,g,h);};this.addActionButton=function(i,g,h,j){if(j){this._addActionButtonAtStart("actions",i,g,h);}else{this._addActionButton("actions",i,g,h);}};this.removeActionButton=function(i,g,h){this._removeShellItem("actions",i,g,h);};this.addToolAreaItem=function(i,g,h){if(i.length){this._addToolAreaItem("toolAreaItems",i,g,h);}};this.removeToolAreaItem=function(i,g,h){this._removeShellItem("toolAreaItems",i,g,h);};this.addLeftPaneContent=function(i,g,h){if(i.length){this._addShellItem("paneContent",i,g,h);}};this.removeLeftPaneContent=function(i,g,h){this._removeShellItem("paneContent",i,g,h);};this.addRightFloatingContainerItem=function(i,g,h){if(i.length){this._addRightFloatingContainerItem("RightFloatingContainerItems",i,g,h);}};this.removeRightFloatingContainerItem=function(i,g,h){this._removeShellItem("RightFloatingContainerItems",i,g,h);};this.showSettingsButton=function(g,h){this.addActionButton(["userSettingsBtn"],g,h,false);};this.showSignOutButton=function(g,h){this.addActionButton(["logoutBtn"],g,h,false);};this.showRightFloatingContainer=function(g){this._showRightFloatingContainer(g);};this.addFloatingActionButton=function(i,g,h){if(i.length){this._addShellItem("floatingActions",i,g,h);}};this.removeFloatingActionButton=function(i,g,h){this._removeShellItem("floatingActions",i,g,h);};this.updateStateProperty=function(p,V,g,h,D){this._setShellItem(p,V,g,h,v,u,D);};this._handleTriggers=function(N){var T,g,h=[],A={};f=false;while(t.length>0){T=t.pop();if(N[T.sName]){h.push(T);A[T.sName]=T;}else{T.fnUnRegister(this);}}for(var i in N){if(N.hasOwnProperty(i)){if(!A[i]){g=N[i];g.fnRegister(this);h.push(g);}}}t=h;f=true;};this._registerTriggers=function(T){var i;f=false;for(i=0;i<T.length;i++){T[i].fnRegister(this);t.push(T[i]);}f=true;};this.createTriggers=function(T,g,h){var N=[];var U=function(T,r){var w;if(!r.aTriggers){r.aTriggers=[];}for(w=0;w<T.length;w++){var x={sName:T[w].sName,fnRegister:T[w].fnRegister,fnUnRegister:T[w].fnUnRegister};N.push(x);r.aTriggers.push(x);}};if(g===true){var j=s.getProperty("/currentState/");U(T,j);if(!I){this._registerTriggers(N);}}else{var i,k=s.getProperty('/currentState/stateName');for(i=0;i<h.length;i++){var l=h[i],p="/states/"+l,q=M.getProperty(p);N=[];U(T,q);if(k===l){if(!I){this._registerTriggers(N);}}}}};this.createInspection=function(A,g,h,j){var k=function(M,A,g){var x,y;if(!M.oCheckPoints){M.oCheckPoints=[];}if(!M.oCheckPoints[A]){M.oCheckPoints[A]=[];}x=M.oCheckPoints[A];for(y=0;y<g.length;y++){l=g[y];x.push({fnCondition:l.fnCondition,fnCheckPoint:l.fnAction});}};if(h===true){var l,p=s.getProperty("/currentState");k(p,A,g);if(!d&&!I){k(C.getProperty("/currentState"),A,g);}this._renderShellState();}else{var i,q=s.getProperty('/currentState/stateName');for(i=0;i<j.length;i++){var r=j[i],P="/states/"+r,w=M.getProperty(P);k(w,A,g);if(q===r){if(!I){this._renderShellState();}}}}};this.showShellItem=function(p,g,V){var h,j,k=this._getModelStates(g),l=this.getModel().getData().states,q="/currentState"+p;for(var i=0;i<k.length;i++){j=l[k[i]];h="/states/"+j.stateName+p;s.setProperty(h,V);}if(s.getProperty("/currentState/stateName")===g){s.setProperty(q,V);}};this.addCustomItems=function(g,i,h,j){if(this._isValidStateEntry(g)){this._isValidStateEntry(g).fnAdd(i,h,j);}else{throw new Error("Invalid state entry:"+g);}};this.removeCustomItems=function(g,i,h,j){if(this._isValidStateEntry(g)){this._isValidStateEntry(g).fnRemove(i,h,j);}else{throw new Error("Invalid state entry:"+g);}};this.createExtendedShellState=function(g,h){var B=M.getProperty("/currentState/stateName"),i,j=this._createCustomShellState(g);if(!e[B]){e[B]={extendedShellStates:{},oCheckPoints:{},aTriggers:[],customShellState:this._createCustomShellState("custom")};}i=e[B].extendedShellStates;if(i[g]){return false;}s=j;d=true;h();if(i[g]){i[g].customState=j;}else{i[g]={managedObjects:[],customState:j};}s=M;d=false;return true;};this.applyExtendedShellState=function(g){E=g;this._renderShellState();};this.addEntryInShellStates=function(g,h,A,r,i){var j,k;if(!c[g]){c[g]={fnAdd:A,fnHide:r};var l=this._getStatesList();for(j=0;j<l.length;j++){k=l[j];M.setProperty("/states/"+k+"/"+g,i[k]);}this["remove"+h]=r;this["add"+h]=A;}else{throw new Error("State entry already exsists:"+g);}};this.addElementToManagedQueue=function(i){var g=s.getProperty("/currentState/stateName"),B=M.getProperty("/currentState/stateName"),h,j=i.getId();if(!e[B]){e[B]={extendedShellStates:{},oCheckPoints:{},aTriggers:[],customShellState:this._createCustomShellState("custom")};}h=e[B].extendedShellStates;if(!h[g]){h[g]={managedObjects:[],customState:undefined};}h[g].managedObjects.push(j);var k=o[j];if(k){k.nRefCount++;}else{k={oItem:i,nRefCount:1};o[j]=k;}};this.updateNeededTriggersMap=function(g,T){var i;if(!T){return;}for(i=0;i<T.length;i++){g[T[i].sName]=T[i];}};this._renderShellState=function(){var B=M.getProperty("/currentState/stateName"),p=B[0]==="/"?B:"/states/"+B,g,h,i=jQuery.extend(true,{},{},M.getProperty(p)),j=e[B],k,N={};if(j){k=j.customShellState.getProperty("/currentState");}var l=new sap.ui.model.json.JSONModel({"currentState":jQuery.extend(true,{},{},i)});s=l;I=true;if(E){if(j.extendedShellStates[E]){g=j.extendedShellStates[E].customState;h=g.getProperty("/currentState");this._addCustomShellStates(h);}}if(k){this._addCustomShellStates(k);}s=M;if(i&&i.aTriggers){this.updateNeededTriggersMap(N,i.aTriggers);}if(h&&h.aTriggers){this.updateNeededTriggersMap(N,h.aTriggers);}if(k&&k.aTriggers){this.updateNeededTriggersMap(N,k.aTriggers);}if(f){this._handleTriggers(N);}M.setProperty("/currentState",l.getProperty("/currentState"));I=false;l.destroy();};this._addCustomShellStates=function(T){this.addHeaderItem(T.headItems,true);this.addToolAreaItem(T.toolAreaItems,true);this.addHeaderEndItem(T.headEndItems,true);this.addSubHeader(T.subHeader,true);this.addRightFloatingContainerItem(T.RightFloatingContainerItems,true);this.addActionButton(T.actions,true,undefined,false);this.addLeftPaneContent(T.paneContent,true);this.addFloatingActionButton(T.floatingActions,true);this._setCurrentApplicationInformation(T.application);this.showRightFloatingContainer(T.showRightFloatingContainer);this.setHeaderHiding(T.headerHiding);this.setHeaderVisibility(T.headerVisible,true);if(T.showLogo){this.showLogo(true);}};this._createCustomShellState=function(g){var h={"currentState":{"stateName":g,"headEndItems":[],"paneContent":[],"headItems":[],"actions":[],"floatingActions":[],"subHeader":[],"toolAreaItems":[],"RightFloatingContainerItems":[],"application":{},"showRightFloatingContainer":true,"headerHeading":undefined}};var i=M.getProperty("/customStatesDelta"),j=i[g];if(j){jQuery.extend(h.currentState,j);}return new sap.ui.model.json.JSONModel(h);};this._setCurrentApplicationInformation=function(A){if(!A){A={};}this.updateStateProperty("application",A,true);};this._showRightFloatingContainer=function(g){this._setShellItem("showRightFloatingContainer",g,true,[],n,u);};this._addActionButtonAtStart=function(p,i,g,h){function U(j,k,l){var A=l.getProperty(j),q=[],O=k.indexOf("openCatalogBtn");if(O>-1){k.splice(O,1);q.push("openCatalogBtn");}else{if(A[0]==="openCatalogBtn"){A.splice(0,1);q.push("openCatalogBtn");q=q.concat(A);}}q=q.concat(k).concat(A);l.setProperty(j,q);}this._setShellItem(p,i,g,h,n,U);};this._addActionButton=function(p,i,g,h){function U(j,k,l){var A=l.getProperty(j);var L=A.indexOf("logoutBtn");if(L>-1){A.splice.apply(A,[L,0].concat(k));}else{A=A.concat(k);}var O=A.indexOf("openCatalogBtn"),q=[];if(O>-1){A.splice(O,1);q.push("openCatalogBtn");q=q.concat(A);}else{q=A;}l.setProperty(j,q);}this._setShellItem(p,i,g,h,n,U);};this.setFloatingContainerContent=function(p,i,g,h){function V(j,i,k){return i.length===1;}function U(j,i,k){k.setProperty(j,i);}this._setShellItem(p,i,g,h,V,U);};this._addUpToThreeItem=function(p,i,g,h,D){function V(j,k,l){var q=0,r,w;if(k.length===1&&k[0]==="endItemsOverflowBtn"){return true;}for(r=0;r<j.length;r++){w=j[r];if(w!=="endItemsOverflowBtn"){q++;}if(q+k.length>3){jQuery.sap.log.warning("maximum of three items has reached, cannot add more items.");return false;}if(k.indexOf(w)>-1){return false;}}return true;}function U(j,k,l){var q=l.getProperty(j),r=q.slice(0);if(r[r.length-1]==="NotificationsCountButton"){r.splice.apply(r,[r.length-1,0].concat(k));}else{r=r.concat(k);}l.setProperty(j,r);}this._setShellItem(p,i,g,h,V,U,D);};this._addShellItem=function(p,i,g,h){function V(j,i,k){if(j.length>0){jQuery.sap.log.warning("You can only add one item. Replacing existing item: "+j[0]+" in state: "+k+", with the new item: "+i[0]+".");}return true;}function U(j,k,l){l.setProperty(j,i.slice(0));}this._setShellItem(p,i,g,h,V,U);};this._addRightFloatingContainerItem=function(p,i,g,h){function U(j,k,l){var q=l.getProperty(j);q=q.concat(k);l.setProperty(j,q);}this._setShellItem(p,i,g,h,n,U);};this._addToolAreaItem=function(p,i,g,h){function U(k,i,l){var q=l.getProperty(k);q.push(i);l.setProperty(k,q);}var j,P=this._getPassStates(h);for(j=0;j<P.length;j++){this.showShellItem("/toolAreaVisible",P[j],true);}this._setShellItem(p,i,g,h,n,U);};this._removeShellItem=function(p,i,g,h){function V(j,k){var l,i,q;for(q=0;q<k.length;q++){i=k[q];l=j.indexOf(i);if(l<0){jQuery.sap.log.warning("You cannot remove Item: "+i+", the headItem does not exists.");return false;}}return true;}function U(j,k,l){var q=l.getProperty(j),r,i,w;for(w=0;w<k.length;w++){i=k[w];r=q.indexOf(i);if(r>-1){q.splice(r,1);}}l.setProperty(j,q);}this._setShellItem(p,i,g,h,V,U);};this._commitCheckPoints=function(g,i,h){var j;for(j=0;j<g.length;j++){if(g[j].fnCondition(i,h,this)){g[j].fnCheckPoint(i,h,this);}}};this._setShellItem=function(p,O,g,h,V,U,D){var k,l;var q=Array.isArray(O)?O.slice(0):O;if(g===true){k="/currentState/"+p;l=s.getProperty(k);if(V(l,q,"currentState")===false){return;}if(I&&!b){var B=M.getProperty("/currentState/stateName"),P="/states/"+B,r=M.getProperty(P),w=e[B];b=true;if(r.oCheckPoints){var x=r.oCheckPoints[p];if(x&&x.length){this._commitCheckPoints(x,l,q);}}if(E){if(w.extendedShellStates[E]){var y=w.extendedShellStates[E].customState,z=y.getProperty("/currentState");if(z&&z.oCheckPoints&&z.oCheckPoints[p]){this._commitCheckPoints(z.oCheckPoints[p],l,q);}}}var A=w.customShellState.getProperty("/currentState");if(A&&A.oCheckPoints&&A.oCheckPoints[p]){x=A.oCheckPoints[p];if(x&&x.length){this._commitCheckPoints(x,l,q);}}b=false;}if(!d&&!I){U(k,q,C);sap.ui.getCore().getEventBus().publish('launchpad','updateShell',{oModel:s,path:k,aIds:q,sProperty:p});this._renderShellState();}else{U(k,q,s);}}else{var F=D?h:this._getPassStates(h),i,G=s.getProperty('/currentState/stateName');for(i=0;i<F.length;i++){var H=F[i],j;k="/states/"+H+"/"+p;l=s.getProperty(k);if(V(l,q,H)===false){continue;}var J=this._getModelStates(H,D);for(j=0;j<J.length;j++){k="/states/"+J[j]+"/"+p;U(k,q,s);if(G===J[j]){if(!I){this._renderShellState();}}}}}};this._getPassStates=function(g){var p=[],i;g=g||[];for(i=0;i<g.length;i++){if(g[i]!==undefined){if(g[i]!=="home"&&g[i]!=="app"){throw new Error("sLaunchpadState value is invalid");}p.push(g[i]);}}if(!p.length){p=["app","home"];}return p;};this._getModelStates=function(g,D){var h=[];if(g==="app"&&!D){var i=["app","minimal","standalone","embedded","headerless","merged","blank"];h=h.concat(i);}else if(g==="home"&&!D){var i=["home","embedded-home","headerless-home","merged-home","blank-home"];h=h.concat(i);}else{h.push(g);}return h;};this._getStatesList=function(){var g=M.getProperty("/states");return Object.keys(g);};this._destroyManageQueue=function(g){var h,i,j,k,B,l,p;for(h in e){if(e.hasOwnProperty(h)){if(!g||g.indexOf(h)===-1){B=e[h].extendedShellStates;for(l in B){if(B.hasOwnProperty(l)){p=B[l].managedObjects;for(i=0;i<p.length;i++){j=p[i];k=o[j];k.nRefCount--;if(k.nRefCount===0){k.oItem.destroy();}}delete B[l];}}delete e[h];}}}};this._isValidStateEntry=function(N){return!!c[N];};}sap.ushell.renderers.fiori2.ShellModel=new S();}());};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.notifications.Notifications.view')){jQuery.sap.declare('sap.ushell.renderers.fiori2.notifications.Notifications.view');(function(){"use strict";jQuery.sap.require('sap.m.NotificationListItem');sap.ui.jsview("sap.ushell.renderers.fiori2.notifications.Notifications",{createContent:function(c){var t=this;this.oBusyIndicator=new sap.m.BusyIndicator('notificationsByTypeBusyIndicator',{size:"1rem"});this.oPreviousTabKey="sapUshellNotificationIconTabByDate";this.oPreviousByDateSorting=undefined;this.oActionListItemTemplate=new sap.m.Button({text:"{ActionText}",type:{parts:["Nature"],formatter:function(n){switch(n){case"POSITIVE":return"Accept";case"NEGATIVE":return"Reject";default:return"Default";}}},press:function(e){var n=this.getBindingContext().getPath(),N=this.getModel().getProperty(n),p=n.split("/"),T=t.oIconTabBar.getSelectedKey(),P=T==='sapUshellNotificationIconTabByType'?"/"+p[1]+"/"+p[2]+"/"+p[3]+"/"+p[4]:"/"+p[1]+"/"+p[2]+"/"+p[3],b=this.getModel().getProperty(P),s=b.Id;this.getModel().setProperty(P+"/Busy",true);c.executeAction(s,N.ActionId).done(function(r){if(r&&r.isSucessfull){if(r.message&&r.message.length){sap.m.MessageToast.show(r.message,{duration:4000});}c.removeNotificationFromModel(s);c.cleanModel();}else{sap.ushell.Container.getService('Message').error(r.message);}this.getModel().setProperty(P+"/Busy",false);}.bind(this)).fail(function(){this.getModel().setProperty(P+"/Busy",false);sap.ushell.Container.getService('Message').error(sap.ushell.resources.i18n.getText('notificationsFailedExecuteAction'));}.bind(this));}});this.oActionGroupItemTemplate=new sap.m.Button({text:"{GroupActionText}",type:{parts:["Nature"],formatter:function(n){switch(n){case"POSITIVE":return"Accept";case"NEGATIVE":return"Reject";default:return"Default";}}},press:function(e){var n=this.getBindingContext().getPath(),N=this.getModel().getProperty(n),p=n.split("/"),P="/"+p[1]+"/"+p[2],b=this.getModel().getProperty(P),d=[];b.notifications.forEach(function(f,g){d.push(f.Id);this.getModel().setProperty(P+"/Busy",true);}.bind(this));this.getModel().setProperty(n+"/Busy",true);c.executeBulkAction(d,N.ActionId,this.getProperty("text"),b,n,P);}});this.addStyleClass('sapUshellNotificationsView');this.oNotificationListItemTemplate=new sap.m.NotificationListItem({press:function(e){var b=this.getBindingContext(),m=b.sPath,M=this.getModel().getProperty(m),s=M.NavigationTargetObject,A=M.NavigationTargetAction,p=M.NavigationTargetParams,n=M.Id;c.onListItemPress(n,s,A,p).bind(c);},datetime:{path:"CreatedAt",formatter:sap.ushell.utils.formatDate.bind(c)},title:{parts:["SensitiveText","Text"],formatter:function(s,b){return s?s:b;}},buttons:{path:"Actions",templateShareable:true,sorter:new sap.ui.model.Sorter('Nature',true),template:this.oActionListItemTemplate},unread:{parts:["IsRead"],formatter:function(b){return!b;}},close:function(e){var n=this.getBindingContext().getPath(),N=this.getModel().getProperty(n),s=N.Id;c.dismissNotification(s);},busy:{parts:["Busy"],formatter:function(b){if(b){return b;}return false;}},priority:{parts:["Priority"],formatter:function(p){if(p){p=p.charAt(0)+p.substr(1).toLowerCase();return sap.ui.core.Priority[p];}}}}).addStyleClass("sapUshellNotificationsListItem").addStyleClass('sapContrastPlus').addStyleClass('sapContrast');this.oNotificationGroupTemplate=new sap.m.NotificationListGroup({title:"{GroupHeaderText}",description:"{GroupHeaderText}",collapsed:true,showEmptyGroup:true,datetime:{path:"CreatedAt",formatter:sap.ushell.utils.formatDate.bind(c)},buttons:{path:"Actions",templateShareable:true,sorter:new sap.ui.model.Sorter('Nature',true),template:this.oActionGroupItemTemplate},items:{path:"notifications",template:this.oNotificationListItemTemplate},onCollapse:function(e){var g=e.getSource(),b=g.getId();if(!g.getCollapsed()){c.collapseOtherGroups(b);}},close:function(e){var n=this.getBindingContext().getPath(),p=n.split("/"),P="/"+p[1]+"/"+p[2],N=this.getModel().getProperty(P),b=[];N.notifications.forEach(function(d,f){b.push(d.Id);});c.dismissBulkNotifications(b,N);},priority:{parts:["Priority"],formatter:function(p){if(p){p=p.charAt(0)+p.substr(1).toLowerCase();return sap.ui.core.Priority[p];}}},busy:{parts:["Busy"],formatter:function(b){if(b){return b;}return false;}}});this.oNotificationsListDate=new sap.m.List({id:"sapUshellNotificationsListDate",mode:sap.m.ListMode.None,noDataText:sap.ushell.resources.i18n.getText('noNotificationsMsg'),items:{path:"/notificationsByDateDescending/aNotifications",template:this.oNotificationListItemTemplate,templateShareable:true},growing:true,growingThreshold:400,growingScrollToLoad:true}).addStyleClass("sapUshellNotificationsList");this.oNotificationsListDate.onAfterRendering=function(){c.handleEmptyList();this.oNotificationsListDate.$().parent().parent().scroll(this._triggerRetrieveMoreData.bind(t));if(c._oTopNotificationData){c.scrollToItem(c._oTopNotificationData);}}.bind(this);this.oNotificationsListPriority=new sap.m.List({id:"sapUshellNotificationsListPriority",mode:sap.m.ListMode.None,noDataText:sap.ushell.resources.i18n.getText('noNotificationsMsg'),items:{path:"/notificationsByPriorityDescending/aNotifications",template:this.oNotificationListItemTemplate,templateShareable:true},growing:true,growingThreshold:400,growingScrollToLoad:true}).addStyleClass("sapUshellNotificationsList");this.oNotificationsListPriority.onAfterRendering=function(){c.handleEmptyList();this.oNotificationsListPriority.$().parent().parent().scroll(this._triggerRetrieveMoreData.bind(t));if(c._oTopNotificationData){c.scrollToItem(c._oTopNotificationData);}}.bind(this);this.triggerRetrieveMoreData=function(p){if(!this.getModel().getProperty("/"+p+"/inUpdate")){var n=this.getController().getItemsFromModel(p),b=n?n.length:0,d=b?this.getController().getBasicBufferSize():0,e=d*2/3,f=Math.floor(b-e),l=p==="notificationsByPriorityDescending"?this.oNotificationsListPriority.getItems()[f]:this.oNotificationsListDate.getItems()[f],g=this.getController().getTopOffSet();if(l.getDomRef()&&jQuery(l.getDomRef()).offset().top<=g){this.getController().getNextBuffer(p);}}};this._triggerRetrieveMoreData=function(){this.triggerRetrieveMoreData(c.sCurrentSorting);};this.oNotificationsListType=new sap.m.List({id:"sapUshellNotificationsListType",mode:sap.m.ListMode.SingleSelect,noDataText:sap.ushell.resources.i18n.getText('noNotificationsMsg'),items:{path:"/aNotificationsByType",template:t.oNotificationGroupTemplate,templateShareable:true,growing:true,growingThreshold:400,growingScrollToLoad:true}}).addStyleClass("sapUshellNotificationsList").addStyleClass('sapContrastPlus').addStyleClass('sapContrast');var i=new sap.m.IconTabFilter({id:"sapUshellNotificationIconTabByDate",key:"sapUshellNotificationIconTabByDate",text:sap.ushell.resources.i18n.getText('notificationsSortByDate'),tooltip:sap.ushell.resources.i18n.getText('notificationsSortByDateDescendingTooltip')});var I=new sap.m.IconTabFilter({id:"sapUshellNotificationIconTabByType",key:"sapUshellNotificationIconTabByType",text:sap.ushell.resources.i18n.getText('notificationsSortByType'),tooltip:sap.ushell.resources.i18n.getText('notificationsSortByTypeTooltip'),content:this.oNotificationsListType});var o=new sap.m.IconTabFilter({id:"sapUshellNotificationIconTabByPrio",key:"sapUshellNotificationIconTabByPrio",text:sap.ushell.resources.i18n.getText('notificationsSortByPriority'),tooltip:sap.ushell.resources.i18n.getText('notificationsSortByPriorityTooltip')});this.oIconTabBar=new sap.m.IconTabBar('notificationIconTabBar',{backgroundDesign:sap.m.BackgroundDesign.Transparent,expandable:false,selectedKey:"sapUshellNotificationIconTabByDate",items:[i,I,o],select:function(e){var k=e.getParameter("key"),b=e.getParameter("item");if(k==="sapUshellNotificationIconTabByDate"){if(((t.oPreviousTabKey==="sapUshellNotificationIconTabByDate")&&((t.oPreviousByDateSorting===t.oController.oSortingType.NOTIFICATIONS_BY_DATE_DESCENDING)||t.oPreviousByDateSorting===undefined))||((t.oPreviousTabKey!=="sapUshellNotificationIconTabByDate")&&(t.oPreviousByDateSorting===t.oController.oSortingType.NOTIFICATIONS_BY_DATE_ASCENDING))){t.oController.sCurrentSorting=t.oController.oSortingType.NOTIFICATIONS_BY_DATE_ASCENDING;b.setTooltip(sap.ushell.resources.i18n.getText('notificationsSortByDateAscendingTooltip'));t.oNotificationsListDate.bindItems("/notificationsByDateAscending/aNotifications",t.oNotificationListItemTemplate);if(c.getItemsFromModel(c.oSortingType.NOTIFICATIONS_BY_DATE_ASCENDING).length===0){c.getNextBuffer(c.oSortingType.NOTIFICATIONS_BY_DATE_ASCENDING);}t.oPreviousByDateSorting=t.oController.oSortingType.NOTIFICATIONS_BY_DATE_ASCENDING;}else{t.oController.sCurrentSorting=t.oController.oSortingType.NOTIFICATIONS_BY_DATE_DESCENDING;b.setTooltip(sap.ushell.resources.i18n.getText('notificationsSortByDateDescendingTooltip'));t.oNotificationsListDate.bindItems("/notificationsByDateDescending/aNotifications",t.oNotificationListItemTemplate);if(c.getItemsFromModel(c.oSortingType.NOTIFICATIONS_BY_DATE_DESCENDING).length===0){c.getNextBuffer(c.oSortingType.NOTIFICATIONS_BY_DATE_DESCENDING);}t.oPreviousByDateSorting=t.oController.oSortingType.NOTIFICATIONS_BY_DATE_DESCENDING;}t.oPreviousTabKey="sapUshellNotificationIconTabByDate";}else if(k==="sapUshellNotificationIconTabByType"){if(t.oPreviousTabKey!=="sapUshellNotificationIconTabByType"){t.oController.sCurrentSorting=t.oController.oSortingType.NOTIFICATIONS_BY_TYPE_DESCENDING;t.getController().getNotificationsByTypeWithGroupHeaders();b.removeAllContent();b.addContent(t.oBusyIndicator);t.oIconTabBar.addStyleClass('sapUshellNotificationIconTabByTypeWithBusyIndicator');t.oPreviousTabKey="sapUshellNotificationIconTabByType";}}else{t.oController.sCurrentSorting=t.oController.oSortingType.NOTIFICATIONS_BY_PRIORITY_DESCENDING;if(c.getItemsFromModel(c.oSortingType.NOTIFICATIONS_BY_PRIORITY_DESCENDING).length===0){c.getNextBuffer(c.oSortingType.NOTIFICATIONS_BY_PRIORITY_DESCENDING);}t.oPreviousTabKey="sapUshellNotificationIconTabByPrio";}t.oPreviousTabKey=k;}}).addStyleClass('sapUshellNotificationTabBar');this.oIconTabBar.addEventDelegate({onsaptabprevious:function(e){var O=e.originalEvent,s=O.srcElement,C=s.classList,b;b=jQuery.inArray('sapMITBFilter',C)>-1;if(b===true){e.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(e);}}});var a=this.oIconTabBar.onAfterRendering;this.oIconTabBar.onAfterRendering=function(){if(a){a.apply(this,arguments);}var T=sap.ui.getCore().byId('notificationIconTabBar--header');if(T){T.addStyleClass('sapContrastPlus');T.addStyleClass('sapUshellTabBarHeader');}};return[this.oIconTabBar];},getMoreCircle:function(t){var m=new sap.m.Text({text:sap.ushell.resources.i18n.getText('moreNotifications')}),n=new sap.m.Text({text:""}).addStyleClass("sapUshellNotificationsMoreCircleCount"),M=new sap.m.VBox({items:[n,m],alignItems:sap.m.FlexAlignItems.Center}).addStyleClass("sapUshellNotificationsMoreCircle"),b=new sap.m.Text({text:sap.ushell.resources.i18n.getText('moreNotificationsAvailable_message'),textAlign:"Center"}).addStyleClass("sapUshellNotificationsMoreHelpingText"),B=new sap.m.Text({text:sap.ushell.resources.i18n.getText('processNotifications_message'),textAlign:"Center"}).addStyleClass("sapUshellNotificationsMoreHelpingText"),v=new sap.m.VBox({items:[M,b,B]}).addStyleClass("sapUshellNotificationsMoreVBox"),l=new sap.m.CustomListItem({type:sap.m.ListType.Inactive,content:v}).addStyleClass("sapUshellNotificationsMoreListItem").addStyleClass('sapContrastPlus');n.setModel(this.getModel());n.bindText("/"+t+"/moreNotificationCount");this.oMoreListItem=l;return l;},getControllerName:function(){return"sap.ushell.renderers.fiori2.notifications.Notifications";}});}());};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.SearchConfiguration')){(function(){"use strict";jQuery.sap.declare('sap.ushell.renderers.fiori2.search.SearchConfiguration');var D='sap.ushell.renderers.fiori2.search.controls.SearchResultListSelectionHandler';var a=jQuery.sap.getObject(D);var u={multiSelect:{type:'bool'},odataProvider:{type:'bool'},searchBusinessObjects:{type:'bool'},charts:{type:'bool'},maps:{type:'bool'},newpie:{type:'bool'},personalizationStorage:{type:'string'}};var S=sap.ushell.renderers.fiori2.search.SearchConfiguration=function(){this.init.apply(this,arguments);};S.prototype={init:function(p){try{var c=window['sap-ushell-config'].renderers.fiori2.componentData.config.esearch;jQuery.extend(true,this,c);}catch(e){}this.handleOutdatedConfigurationParameters();this.setDefaults();this.readUrlParameters();this.setModulePaths();},setModulePaths:function(){if(!this.modulePaths){return;}for(var i=0;i<this.modulePaths.length;++i){var m=this.modulePaths[i];jQuery.sap.registerModulePath(m.moduleName,m.urlPrefix);}},handleOutdatedConfigurationParameters:function(){try{var c=window['sap-ushell-config'].renderers.fiori2.componentData.config;if(c.searchBusinessObjects!==undefined&&this.searchBusinessObjects===undefined){if(c.searchBusinessObjects==='hidden'||c.searchBusinessObjects===false){this.searchBusinessObjects=false;}else{this.searchBusinessObjects=true;}}if(c.enableSearch!==undefined&&this.enableSearch===undefined){this.enableSearch=c.enableSearch;}}catch(e){}},setDefaults:function(){if(this.searchBusinessObjects===undefined){this.searchBusinessObjects=true;}if(this.odataProvider===undefined){this.odataProvider=false;}if(this.multiSelect===undefined){this.multiSelect=true;}if(this.charts===undefined){this.charts=true;}if(this.maps===undefined){this.maps=false;}if(this.newpie===undefined){this.newpie=false;}if(this.dataSources===undefined){this.dataSources={};}if(this.enableSearch===undefined){this.enableSearch=true;}if(this.personalizationStorage===undefined){this.personalizationStorage='auto';}},readUrlParameters:function(){var p=this.parseUrlParameters();for(var b in p){if(b==='demoMode'){this.searchBusinessObjects=true;this.enableSearch=true;continue;}var c=u[b];if(!c){continue;}var v=p[b];switch(c.type){case'bool':v=(v==='true'||v==='');break;default:}this[b]=v;}},parseUrlParameters:function(){var U=sap.ushell.Container.getService("URLParsing");var p=U.parseParameters(window.location.search);var n={};for(var k in p){var v=p[k];if(v.length!==1){continue;}v=v[0];if(typeof v!=='string'){continue;}n[k]=v;}return n;},getDataSourceConfig:function(d){var c;var b=d.semanticObjectType;if(!b&&d.semanticObjectTypes&&d.semanticObjectTypes.length==1){b=d.semanticObjectTypes[0];}if(this.semanticObjects&&b){c=this.semanticObjects[b];}if(!c){if(!this._defaultConfig){this._defaultConfig={searchResultListItemContent:undefined,searchResultListItemContentControl:undefined,searchResultListSelectionHandler:D,searchResultListSelectionHandlerControl:a};}c=this._defaultConfig;if(b){this.semanticObjects=this.semanticObjects||[];this.semanticObjects[b]=c;}}if(c.searchResultListItemContent&&!c.searchResultListItemContentControl){try{jQuery.sap.require(c.searchResultListItemContent);c.searchResultListItemContentControl=jQuery.sap.getObject(c.searchResultListItemContent);}catch(e){}}c.searchResultListSelectionHandler=c.searchResultListSelectionHandler||D;try{if(!c.searchResultListSelectionHandlerControl){jQuery.sap.require(c.searchResultListSelectionHandler);c.searchResultListSelectionHandlerControl=jQuery.sap.getObject(c.searchResultListSelectionHandler);}}catch(e){}return c;},isLaunchpad:function(){try{return sap.ushell.Container.getService("Search").isSearchAvailable?true:false;}catch(e){return false;}},getSina:function(){jQuery.sap.require("sap.ushell.renderers.fiori2.search.esh.api.release.sina");if(!this.isSinaRegistered){if(!this.odataProvider&&this.isLaunchpad()){sap.ushell.Container.addRemoteSystem(new sap.ushell.System({alias:"ENTERPRISE_SEARCH",platform:"abap",baseUrl:"/ENTERPRISE_SEARCH"}));this.sina=window.sina.getSina();}else{this.sina=window.sina.getSina({'impl_type':"odata2"});}}this.isSinaRegistered=true;return this.sina;}};var s;S.getInstance=function(){if(s){return s}s=new S();return s;}})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.SearchFacetDialogHelper')){(function(){"use strict";jQuery.sap.declare('sap.ushell.renderers.fiori2.search.SearchFacetDialogHelper');var m=sap.ushell.renderers.fiori2.search.SearchFacetDialogHelper={};jQuery.extend(m,{init:function(d){var t=this;t.POS_FACET_LIST=0;t.POS_TOOLBAR_SEARCHFIELD=0;t.POS_TOOLBAR_TOGGLEBUTTON=1;t.POS_SETTING_CONTAINER=0;t.POS_ATTRIBUTE_LIST_CONTAINER=1;t.POS_ICONTABBAR=0;t.POS_TABBAR_LIST=0;t.POS_TABBAR_CONDITION=1;t.POS_SORTING_SELECT=0;t.POS_SHOWONTOP_CHECKBOX=1;t.POS_ADVANCED_CHECKBOX=0;t.POS_ADVANCED_INPUT_LAYOUT=1;t.POS_ADVANCED_BUTTON=2;var n={"decimals":2};t.oNumberFormat=sap.ui.core.format.NumberFormat.getFloatInstance(n);var D={"pattern":"yyyy-MM-dd HH:mm:ss.SSSSSSS","UTC":true};t.oDateFormat=sap.ui.core.format.DateFormat.getDateTimeInstance(D);t.dialog=d;},getFacetList:function(){var t=this;return t.dialog.oSplitContainer.getMasterPages()[0].getContent()[t.POS_FACET_LIST];},updateDetailPage:function(l,f){var t=this;var M=t.dialog.getModel();var s=t.dialog.getModel('searchModel');var b=l.getBindingContext().sPath;var S=M.getProperty(b);var d=M.getAttributeDataType(S.dataType);var i=this.getFacetList().indexOfAggregation("items",l);var D=t.dialog.oSplitContainer.getDetailPages()[i];var o,a,c;if(d==="string"||d==="text"){o=D.getContent()[t.POS_ICONTABBAR].getItems()[t.POS_TABBAR_LIST].getContent()[0].getContent()[t.POS_ATTRIBUTE_LIST_CONTAINER].getContent()[0];a=D.getContent()[t.POS_ICONTABBAR].getItems()[t.POS_TABBAR_CONDITION].getContent()[0];c=D.getContent()[t.POS_ICONTABBAR].getItems()[t.POS_TABBAR_LIST].getContent()[0].getContent()[t.POS_SETTING_CONTAINER];}else{o=D.getContent()[t.POS_ATTRIBUTE_LIST_CONTAINER].getContent()[0];a=D.getContent()[t.POS_ATTRIBUTE_LIST_CONTAINER];c=D.getContent()[t.POS_SETTING_CONTAINER];}var n=D.getId();t.dialog.oSplitContainer.toDetail(n,"show");t.dialog.resetIcons(M,b,t.dialog);o.setBusy(true);var p={sAttribute:S.dimension,sBindingPath:b,sAttributeLimit:1000};if(d==="number"){p.sAttributeLimit=5;}t.applyChartQueryFilter(i);if(f){var e=M.sina.createFilterCondition({attribute:S.dimension,operator:"=",value:f+"*"});M.chartQuery.addFilterCondition(e);}else if(f===undefined&&(d==="string"||d==="text")){D.getContent()[t.POS_ICONTABBAR].getItems()[t.POS_TABBAR_LIST].getContent()[0].getSubHeader().getContent()[t.POS_TOOLBAR_SEARCHFIELD].setValue('');}M.chartQuery.setSearchTerms(s.getSearchBoxTerm());M.facetDialogSingleCall(p).done(function(){var I=M.getProperty(D.getBindingContext().sPath).items;if(a.data('initial')){t.initiateAdvancedConditions(a,I,a.data('dataType'));}var C=c.getContent()[t.POS_SHOWONTOP_CHECKBOX];if(o.getSelectedContexts().length>0){C.setEnabled(true);}t.updateDetailPageListItemsSelected(o,a);t.dialog.updateDetailPageCharts(I,M);});},applyChartQueryFilter:function(e){var t=this;t.dialog.getModel().resetChartQueryFilterConditions();var d=t.dialog.oSplitContainer.getDetailPages();for(var i=0;i<d.length;i++){if(i===e||d[i].getContent().length===0){continue;}var l;if(!d[i].getContent()[t.POS_ATTRIBUTE_LIST_CONTAINER]){l=d[i].getContent()[t.POS_ICONTABBAR].getItems()[t.POS_TABBAR_LIST].getContent()[0].getContent()[t.POS_ATTRIBUTE_LIST_CONTAINER].getContent()[0];}else{l=d[i].getContent()[t.POS_ATTRIBUTE_LIST_CONTAINER].getContent()[0];}for(var j=0;j<l.getItems().length;j++){var L=l.getItems()[j];var o=L.getBindingContext().getObject();var f=o.filterCondition;if(f.attribute||f.conditions){if(L.getSelected()){if(!t.dialog.getModel().chartQuery.getFilter().hasFilterCondition(f)){t.dialog.getModel().chartQuery.addFilterCondition(f);}}}}t.applyAdvancedCondition(d[i],t.getFacetList().getItems()[i].getBindingContext().getObject(),t.dialog.getModel().chartQuery);}},applyAdvancedCondition:function(d,f,a){var t=this;var b=t.dialog.getModel();var D,A,k,o,c,e,g,C;if(d.getContent()[t.POS_ATTRIBUTE_LIST_CONTAINER]){var l=d.getContent()[t.POS_ATTRIBUTE_LIST_CONTAINER];D=l.data('dataType');A=l.getContent();switch(D){case'date':for(k=1;k<A.length;k++){o=A[k];c=o.getContent()[t.POS_ADVANCED_CHECKBOX];var h=o.getContent()[t.POS_ADVANCED_INPUT_LAYOUT];if(c.getSelected()&&h.getDateValue()&&h.getSecondDateValue()){var i=t.oDateFormat.format(h.getDateValue());var s=t.oDateFormat.format(new Date(h.getSecondDateValue().getTime()+86400000-1));e=b.sina.createFilterCondition({attribute:f.dimension,attributeLabel:f.title,operator:">=",value:i,label:i});g=b.sina.createFilterCondition({attribute:f.dimension,attributeLabel:f.title,operator:"<=",value:s,label:s});C=b.sina.createFilterConditionGroup();C.label=h.getValue();C.conditions[0]=e;C.conditions[1]=g;a.addFilterCondition(C,false);}}break;case'number':for(k=1;k<A.length;k++){o=A[k];c=o.getContent()[t.POS_ADVANCED_CHECKBOX];var j=o.getContent()[t.POS_ADVANCED_INPUT_LAYOUT].getContent()[0];var n=o.getContent()[t.POS_ADVANCED_INPUT_LAYOUT].getContent()[2];var p=o.getContent()[t.POS_ADVANCED_INPUT_LAYOUT].getContent()[1];var q=t.oNumberFormat.parse(j.getValue());var r=t.oNumberFormat.parse(n.getValue());if(c.getSelected()&&q&&r){e=b.sina.createFilterCondition({attribute:f.dimension,attributeLabel:f.title,operator:">=",value:q,label:t.oNumberFormat.format(q)});g=b.sina.createFilterCondition({attribute:f.dimension,attributeLabel:f.title,operator:"<=",value:r,label:t.oNumberFormat.format(r)});C=b.sina.createFilterConditionGroup();C.label=t.oNumberFormat.format(q)+p.getText()+t.oNumberFormat.format(r);C.conditions[0]=e;C.conditions[1]=g;a.addFilterCondition(C,false);}}break;default:break;}}else{var u=d.getContent()[t.POS_ICONTABBAR].getItems()[t.POS_TABBAR_CONDITION].getContent()[0];D=u.data('dataType');A=u.getContent();var v,w,x,F;switch(D){case'string':for(k=0;k<A.length-1;k++){o=A[k];v=o.getContent()[t.POS_ADVANCED_INPUT_LAYOUT].getContent()[0];w=o.getContent()[t.POS_ADVANCED_INPUT_LAYOUT].getContent()[1];switch(v.getSelectedKey()){case'eq':x=w.getValue();break;case'ew':x="*"+w.getValue();break;case'bw':x=w.getValue()+"*";break;case'co':x="*"+w.getValue()+"*";break;default:x=w.getValue();break;}if(w.getValue()){F=b.sina.createFilterCondition({attribute:f.dimension,attributeLabel:f.title,operator:"=",value:x,label:x});a.addFilterCondition(F,false);}}break;case'text':for(k=0;k<A.length-1;k++){o=A[k];v=o.getContent()[t.POS_ADVANCED_INPUT_LAYOUT].getContent()[0];w=o.getContent()[t.POS_ADVANCED_INPUT_LAYOUT].getContent()[1];x=w.getValue();var O;switch(v.getSelectedKey()){case'co':O="=";break;default:O="=";break;}if(w.getValue()){F=b.sina.createFilterCondition({attribute:f.dimension,attributeLabel:f.title,operator:O,value:x,label:x});a.addFilterCondition(F,false);}}break;default:break;}}},initiateAdvancedConditions:function(a,I,t){var b=this;var c,C,o,d;for(var i=I.length;i>0;i--){var e=I[i-1];if(e.advanced){c=a.getContent();if(t==="string"||t==="text"){C=c[c.length-2];}else{C=c[c.length-1];}o=C.getContent()[b.POS_ADVANCED_CHECKBOX];o.setSelected(true);d=C.getContent()[b.POS_ADVANCED_INPUT_LAYOUT];switch(t){case'number':var f=d.getContent()[0];var g=d.getContent()[2];if(e.filterCondition.conditions){for(var j=0;j<e.filterCondition.conditions.length;j++){var h=e.filterCondition.conditions[j];if(h.operator===">="){f.setValue(h.label);}if(h.operator==="<="){g.setValue(h.label);}}}break;case'string':var s=e.label;if((s.charAt(0)==="*")&&(s.charAt(s.length-1)==="*")){d.getContent()[0].setSelectedKey('co');s=s.substring(1,s.length-1);}else if((s.charAt(0)==="*")){d.getContent()[0].setSelectedKey('ew');s=s.substring(1);}else if((s.charAt(s.length-1)==="*")){d.getContent()[0].setSelectedKey('bw');s=s.substring(0,s.length-1);}d.getContent()[1].setValue(s);break;case'text':var k=e.label;if((k.charAt(0)==="*")&&(k.charAt(k.length-1)==="*")){d.getContent()[0].setSelectedKey('co');k=k.substring(1,k.length-1);}d.getContent()[1].setValue(k);break;default:d.setValue(e.label);break;}b.insertNewAdvancedCondition(C,t);b.dialog.getModel().changeFilterAdvaced(e,true);}}a.data('initial',false);},updateDetailPageListItemsSelected:function(d,a){var t=this;var D=a.data('dataType');for(var j=0;j<d.getItems().length;j++){var l=d.getItems()[j];var L=l.getBindingContext().getObject();if(d.getModel().hasFilter(L)){l.setSelected(true);d.getModel().changeFilterAdvaced(L,false);t.removeAdvancedCondition(a,l,D);}else{l.setSelected(false);}var s=l.getBindingContext().sPath+"/selected";l.getBindingContext().oModel.setProperty(s,l.getSelected());}t.sortingAttributeList(d.getParent().getParent());d.setBusy(false);if(D==="date"||D==="number"){d.focus();}},removeAdvancedCondition:function(a,l,t){var b=this;var c=a.getContent();var C,I,d;if(t==="string"||t==="text"){for(var i=0;i<c.length-1;i++){C=c[i];I=C.getContent()[b.POS_ADVANCED_INPUT_LAYOUT].getContent()[1];if(I.getProperty('value')){var v=I.getValue();var L=l.getBindingContext().getObject();if(v===L.filterCondition.value){d=i;break;}}}}a.removeContent(d);},sortingAttributeList:function(d){var t=this;var s=d.getContent()[t.POS_SETTING_CONTAINER];var S=s.getContent()[t.POS_SORTING_SELECT];var c=s.getContent()[t.POS_SHOWONTOP_CHECKBOX];var l=d.getContent()[t.POS_ATTRIBUTE_LIST_CONTAINER].getContent()[0];var D=l.data('dataType');var b=l.getBinding("items");var a=[];if(c.getSelected()){a.push(new sap.ui.model.Sorter("selected",true,false));}switch(S.getSelectedKey()){case"sortName":a.push(new sap.ui.model.Sorter("label",false,false));break;case"sortCount":a.push(new sap.ui.model.Sorter("value",true,false));if(D==="string"||D==="text"){a.push(new sap.ui.model.Sorter("label",false,false));}break;default:break;}b.sort(a);},insertNewAdvancedCondition:function(a,t){var A=a.getParent();var n=new sap.ushell.renderers.fiori2.search.controls.SearchAdvancedCondition({type:t});if(t==="string"||t==="text"){var i=A.getAggregation("content").length-1;A.insertAggregation("content",n,i);}else{var b=A.indexOfAggregation("content",a);if(b===(A.getAggregation("content").length-1)){A.addContent(n);}}},deleteAdvancedCondition:function(a){var t=this;var A=a.getParent();var d=a.getParent().getParent().getParent().getParent().getParent();A.removeAggregation("content",a);t.updateCountInfo(d);},updateCountInfo:function(d){var t=this;var M=t.getFacetList();var o=M.getSelectedItem();if(!o){o=M.getItems()[0];}var a=o.getBindingContext().oModel;var s=o.getBindingContext().sPath;var D=a.getProperty(s).dimension;var f=t.dialog.getModel().aFilters;var c=0;for(var j=0;j<f.length;j++){if(!f[j].advanced&&f[j].facetAttribute===D){c++;}}var b=a.getAttributeDataType(a.getProperty(s).dataType);var A,e,i,C,g;var h=0;if(b==="string"||b==="text"){A=d.getContent()[t.POS_ICONTABBAR].getItems()[t.POS_TABBAR_CONDITION].getContent()[0];e=A.getContent().length-1;for(i=0;i<e;i++){C=A.getContent()[i];g=C.getContent()[0];if(g.getSelected()){h++;}}}else{A=d.getContent()[t.POS_ATTRIBUTE_LIST_CONTAINER];e=A.getContent().length;for(i=1;i<e;i++){C=A.getContent()[i];g=C.getContent()[0];if(g.getSelected()){h++;}}}var F=a.getProperty(s).facetType;if(F==="attribute"){var k=c+h;a.setProperty(s+"/count",k);t.dialog.resetEnabledForFilterResetButton();}}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.SearchFacetDialogHelperCharts')){(function(){"use strict";jQuery.sap.declare('sap.ushell.renderers.fiori2.search.SearchFacetDialogHelperCharts');var m=sap.ushell.renderers.fiori2.search.SearchFacetDialogHelperCharts={};jQuery.extend(m,{init:function(d){this.dialog=d;},getBarChartPlaceholder:function(){var t=this;var c;c=new sap.suite.ui.microchart.ComparisonMicroChart({height:"90%",width:"100%",colorPalette:"",tooltip:""});c.addStyleClass('largeChart1barchart');var b=new sap.ui.model.Filter("value",sap.ui.model.FilterOperator.GT,0);var B={path:"items",factory:function(i,C){var o=new sap.suite.ui.microchart.ComparisonMicroChartData({title:'{label}',value:'{value}',color:{path:'selected',formatter:function(v){var r=sap.m.ValueColor.Good;if(!v){r=sap.m.ValueColor.Neutral;}return r;}},displayValue:'{valueLabel}',press:function(e){t.dialog.onDetailPageSelectionChangeCharts(e);}});return o;},filters:[b]};c.bindAggregation("data",B);c.setBusyIndicatorDelay(0);return c;},testWhetherPieWedgeOrLabelIsDummy:function(E){var r=false;var l="";var p=0,a=0;try{l=JSON.stringify(E.getParameters().data[0].data).split("\"")[3];p=l.match(/\d+/g)[0];a=l.match(/\d+/g)[1];if(l===sap.ushell.resources.i18n.getText("facetPieChartOverflowText2",[p,a])){r=true;}else if(l===sap.ushell.resources.i18n.getText("facetPieChartOverflowText2",[a,p])){r=true;}}catch(e){}return r;},getPieChartPlaceholder2:function(){jQuery.sap.require('sap.viz.ui5.controls.VizFrame');var t=this;var c;c=new sap.viz.ui5.controls.VizFrame({width:"100%",vizType:"info/pie",selectData:function(e){if(!t.testWhetherPieWedgeOrLabelIsDummy(e)){t.dialog.onDetailPageSelectionChangeCharts(e);}},deselectData:function(e){if(!t.testWhetherPieWedgeOrLabelIsDummy(e)){t.dialog.onDetailPageSelectionChangeCharts(e);}}});c.addEventDelegate({onAfterRendering:function(e){}});c.attachRenderComplete(function(e){var b=[];var I;var s=this.getBindingContext().getObject().items4pie;if(!s){return c;}for(var i=0;i<s.length;i++){I=s[i];if(I.selected===true){b.push({data:{Label:(I.label)}});}}var g={clearSelection:true};c.vizSelection(b,g);var h,k,l;var n,o,q,r;h=e.getSource().sId;n=$("#"+h+" .v-legend-marker").last();o=$("#"+h+" .v-legend-item").last();if(this.getBindingContext().getObject().items4pie[0].percentageMissingInBigPie>0){q=$("#"+h+" .v-legend-item").length-1;r=$("#"+h+" .v-datapoint-group").children();for(var j=0;j<r.length;j++){l=r[j];k=l.getAttribute("data-id");k=parseInt(k,10);if(k===q){l.remove();break;}}n.attr("fill-opacity","0");n.attr("stroke-opacity","1");n.attr("stroke","black");n.attr("stroke-width","0.5");o.unbind();o.off();}var u=$("#"+h+" .v-background-body");u.unbind();u.off();});c.setVizProperties({plotArea:{},legend:{},legendGroup:{linesOfWrap:0,layout:{maxWidth:0.5}},title:{visible:false},interaction:{selectability:{mode:"multiple"}}});c.addStyleClass('largeChart2piechart');var p=new sap.ui.model.Filter("pieReady",sap.ui.model.FilterOperator.EQ,true);var d=new sap.viz.ui5.data.FlattenedDataset({dimensions:[{name:'Label',value:"{label}"}],measures:[{name:'Value',value:'{valueLabel}'}],data:{path:"items4pie",filters:[p]}});var f=new sap.viz.ui5.controls.common.feeds.FeedItem({uid:"size",type:"Measure",values:["Value"]});var a=new sap.viz.ui5.controls.common.feeds.FeedItem({uid:"color",type:"Dimension",values:["Label"]});c.setDataset(d);c.addFeed(f);c.addFeed(a);return c;},getPieChartPlaceholder:function(){var t=this;var c;var p={};p.oSearchFacetDialog=t.dialog;c=new sap.ushell.renderers.fiori2.search.controls.SearchFacetPieChart(p);c.addStyleClass('largeChart2piechart');sap.ui.core.ResizeHandler.register(c,function(e){var s=0;var a=0;if(e.target.firstChild){s=parseInt(window.getComputedStyle(e.target.firstChild,null).getPropertyValue("transform-origin").split(" ")[0],10);a=(e.size.width/2)-s;e.target.firstChild.style.marginLeft=a+"px";}});return c;},getHeaderWithDropDown:function(t){var a=this;var c=a.getDropDownButton();var l=new sap.m.Label({text:t});var h=new sap.m.Bar({translucent:true,design:sap.m.BarDesign.Header,contentMiddle:[l,c]});h.addStyleClass("sapUshellSearchFacetDialogTabBarHeader");return h;},setDummyTabBarItems:function(c){c.tabBarItems=[new sap.m.IconTabFilter({text:sap.ushell.resources.i18n.getText("facetList"),icon:"sap-icon://list",key:'list'+arguments[0]}),new sap.m.IconTabFilter({text:sap.ushell.resources.i18n.getText("facetBarChart"),icon:"sap-icon://horizontal-bar-chart",key:'barChart'+arguments[0]}),new sap.m.IconTabFilter({text:sap.ushell.resources.i18n.getText("facetPieChart"),icon:"sap-icon://pie-chart",key:'pieChart'+arguments[0]})];c.chartOnDisplayIndex=0;},getDropDownButton:function(c){var b=[];var B;var d=new sap.m.Button({icon:c.tabBarItems[c.chartOnDisplayIndex].getIcon()});for(var i=0;i<c.tabBarItems.length;i++){B=new sap.m.Button({text:c.tabBarItems[i].getText(),icon:c.tabBarItems[i].getIcon(),press:function(E){var g,h;h=E.getSource().sId;g=document.getElementById(h).dataset.facetViewIndex;g=parseInt(g,10);c.chartOnDisplayIndex=g;if(c.chartOnDisplayIndex===0){$(".sapUshellSearchFacetDialogSettingsContainer").css('display','block');}else{$(".sapUshellSearchFacetDialogSettingsContainer").css('display','none');}c.chartOnDisplayIndexByFilterArray[c.facetOnDisplayIndex]=g;var j=c.tabBarItems[c.chartOnDisplayIndex].getIcon();d.setIcon(j);var e=c.tabBarItems[c.chartOnDisplayIndex].getText();var f=sap.ushell.resources.i18n.getText('displayAs',[e]);d.setTooltip(f);var k=$(".sapUshellSearchFacetDialogFacetList")[0];if(k){var F=sap.ui.getCore().byId(k.id);if(!F.getSelectedItem()){F.setSelectedItem(F.getItems()[0]);}F.fireSelectionChange({listItem:F.getSelectedItem()});}c.controlChartVisibility(c,g);}});B.data("facet-view-index",""+i,true);b.push(B);}var a=new sap.m.ActionSheet({showCancelButton:true,buttons:b,placement:sap.m.PlacementType.Bottom,cancelButtonPress:function(){jQuery.sap.log.info("sap.m.ActionSheet: cancelButton is pressed");}});d.addStyleClass("sapUshellSearchFacetDialogTabBarButton");var e=c.tabBarItems[c.chartOnDisplayIndex].getText();var f=sap.ushell.resources.i18n.getText('displayAs',[e]);d.setTooltip(f);d.attachPress(function(E){a.openBy(this);});return d;},getListContainersForDetailPage:function(){var t,b,p;var r=[];var a=0;var c=440;var s=$(".searchFacetLargeChartContainer");for(var i=0;i<s.length;i++){if(s[i].clientHeight>0){c=s[i].offsetParent.offsetParent.offsetParent.clientHeight;a=i;break;}}var d=$(".searchFacetLargeChartContainer")[a];if(d){var l=sap.ui.getCore().byId(d.id);var S,I;I=$('.sapUshellSearchFacetDialogSubheaderToolbar .sapMSF');S=$('.sapUshellSearchFacetDialogSortButton');t=d.firstChild.children[0];b=d.firstChild.children[1];p=d.firstChild.children[2];r.push(d);r.push(l);r.push(c);r.push(t);r.push(b);r.push(p);r.push(S);r.push(I);}return r;}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.SearchHelper')){(function(){"use strict";jQuery.sap.declare('sap.ushell.renderers.fiori2.search.SearchHelper');var m=sap.ushell.renderers.fiori2.search.SearchHelper={};jQuery.sap.require('jquery.sap.storage');jQuery.sap.require('sap.ui.core.format.NumberFormat');m.Tester=function(){this.init.apply(this,arguments);};m.Tester.prototype={init:function(s,h){s=s||"*";s=s.replace(/([.+?^=!:${}()|\[\]\/\\])/g,"\\$1");this.aSearchTerms=this.tokenizeSearchTerms(s);for(var j=0;j<this.aSearchTerms.length;++j){this.aSearchTerms[j]=this.aSearchTerms[j].replace(/\*/g,"[^\\s]*");var i=this.aSearchTerms[j].match(/[\u3400-\u9faf]/)!==null?true:false;if(i){this.aSearchTerms[j]=new RegExp(this.aSearchTerms[j],'gi');}else{this.aSearchTerms[j]=new RegExp('(?:^|\\s)'+this.aSearchTerms[j],'gi');}}this.highlightStyle=h;},test:function(t){var r={bMatch:false,sHighlightedText:''};if(!t){return r;}this.initializeBoldArray(t);this.globalBold=false;var R;var M=false;var a;for(var j=0;j<this.aSearchTerms.length;++j){R=this.aSearchTerms[j];if(R.toString()==='/(?:^|\\s)[^\\s]*/gi'||R.toString()==='/[^\\s]*/gi'){continue;}M=false;var l=-1;while((a=R.exec(t))!==null){M=true;if(R.lastIndex===l){break;}l=R.lastIndex;var s=this.indexOfFirstNoneWhiteSpaceChar(t,a.index);if(s<0){continue;}this.markBoldArray(s,R.lastIndex);}if(M===false){return r;}}r.bMatch=true;r.sHighlightedText=this.render(t);return r;},indexOfFirstNoneWhiteSpaceChar:function(t,s){t=t.substring(s);var a=/[^\s]/.exec(t);if(!a){return-1;}return a.index+s;},tokenizeSearchTerms:function(t){var a=t.split(" ");var n=[];$.each(a,function(i,b){b=$.trim(b);if(b.length>0&&b!=='.*'){n.push(b);}});return n;},initializeBoldArray:function(t){this.bold=new Array(t.length);for(var i=0;i<this.bold.length;++i){this.bold[i]=false;}},markBoldArray:function(n,a){for(var i=n;i<a;i++){this.bold[i]=true;this.globalBold=true;}},render:function(o){if(!this.globalBold){return o;}var b=false;var r=[];var s=0;var i;for(i=0;i<o.length;++i){if((!b&&this.bold[i])||(b&&!this.bold[i])){r.push(o.substring(s,i));if(b){r.push("</b>");}else{if(this.highlightStyle){r.push('<b class="'+this.highlightStyle+'">');}else{r.push("<b>");}}b=!b;s=i;}}r.push(o.substring(s,i));if(b){r.push("</b>");}return r.join("");}};m.delayedExecution=function(o,d){var t=null;var a=function(){var b=arguments;var c=this;if(t){window.clearTimeout(t);}t=window.setTimeout(function(){t=null;o.apply(c,b);},d);};a.abort=function(){if(t){window.clearTimeout(t);}};return a;};m.refuseOutdatedRequests=function(o,r){var l=0;var d=function(){var a=arguments;var t=this;var b=++l;var c=new jQuery.Deferred();o.apply(t,a).done(function(){if(b!==l){return;}c.resolve.apply(c,arguments);}).fail(function(){if(b!==l){return;}c.reject.apply(c,arguments);});return c;};d.abort=function(){++l;};if(r){m.outdatedRequestAdministration.registerDecorator(r,d);}return d;};m.abortRequests=function(r){var d=m.outdatedRequestAdministration.getDecorators(r);for(var i=0;i<d.length;++i){var a=d[i];a.abort();}};m.outdatedRequestAdministration={decoratorMap:{},registerDecorator:function(r,d){var a=this.decoratorMap[r];if(!a){a=[];this.decoratorMap[r]=a;}a.push(d);},getDecorators:function(r){var d=this.decoratorMap[r];if(!d){d=[];}return d;}};m.boldTagUnescaper=function(d,h){var i=d.innerHTML;var b='';var a='';if(h){b='&lt;b class="'+h+'"&gt;';a='<b class="'+h+'">';}else{b='&lt;b&gt;';a='<b>';}var c='&lt;/b&gt;';var e='</b>';while(i.indexOf(b)+i.indexOf(c)>=-1){i=i.replace(b,a);i=i.replace(c,e);}while(i.indexOf('&lt;i&gt;')+i.indexOf('&lt;/i&gt;')>=-1){i=i.replace('&lt;i&gt;','<i>');i=i.replace('&lt;/i&gt;','</i>');}while(i.indexOf('&lt;span&gt;')+i.indexOf('&lt;/span&gt;')>=-1){i=i.replace('&lt;span&gt;','<span>');i=i.replace('&lt;/span&gt;','</span>');}d.innerHTML=i;};m.boldTagUnescaperByText=function(d){var a=$(d);var s=a.text().replace(/<b>/gi,'').replace(/<\/b>/gi,'');if(s.indexOf('<')===-1){a.html(a.text());}};m.forwardEllipsis4Whyfound=function(d){var a=$(d);var p=a.html().indexOf("<b>");if(p>2&&d.offsetWidth+3<d.scrollWidth){var e="..."+a.html().substring(p);a.html(e);}};m.getHashFromUrl=function(){return'#'+(window.location.href.split("#")[1]||"");};m.getUrlParameters=function(){var u;if(sap&&sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("URLParsing")){var U=sap.ushell.Container.getService("URLParsing");var a=U.splitHash(m.getHashFromUrl()).appSpecificRoute;u=a.substring(2);}else{u=m.getHashFromUrl();}var b=m.parseUrlParameters(u);return b;};m.parseUrlParameters=function(u){var p={};var k=[{"name":"filter","pos":-1,"value":""},{"name":"top","pos":-1,"value":""},{"name":"datasource","pos":-1,"value":""},{"name":"searchterm","pos":-1,"value":""}];for(var i=0;i<k.length;i++){k[i].pos=u.toLowerCase().indexOf(k[i].name+"=");}k.sort(function(a,b){return a.pos-b.pos;});for(var j=0;j<k.length;j++){if(k[j].pos!==-1){if(k[j+1]&&k[j+1].pos!==-1){k[j].value=u.substring(k[j].pos,k[j+1].pos);}else{k[j].value=u.substring(k[j].pos);}k[j].value=k[j].value.substring(k[j].name.length+1);if(k[j].value.charAt(k[j].value.length-1)==="&"){k[j].value=k[j].value.substring(0,k[j].value.length-1);}k[j].value=decodeURIComponent(k[j].value);p[k[j].name]=k[j].value;}}return p;};m.isSearchAppActive=function(){if(m.getHashFromUrl().substr(1,13)==='Action-search'){return true;}else{return false;}};m.hasher={hash:null,setHash:function(h){if(decodeURIComponent(m.getHashFromUrl())!==decodeURIComponent(h)){try{window.location.hash=h;}catch(e){this.showUrlUpdateError(e);}}this.hash=h;},reset:function(){this.hash=null;},hasChanged:function(){if(decodeURIComponent(this.hash)!==decodeURIComponent(m.getHashFromUrl())){return true;}return false;},showUrlUpdateError:function(e){if(this.urlError){return;}this.urlError=true;jQuery.sap.require("sap.m.MessageBox");var a=sap.ushell.resources.i18n.getText('searchUrlErrorMessage',e.toString());sap.m.MessageBox.alert(a,{title:sap.ushell.resources.i18n.getText('searchUrlErrorTitle'),icon:sap.m.MessageBox.Icon.ERROR});}};m.loadResultViewType=function(){if(jQuery.sap.storage&&jQuery.sap.storage.isSupported()){var r=jQuery.sap.storage.get("resultViewType");if(!r||r!=="searchResultTable"){return"searchResultList";}else{return"searchResultTable";}}else{return"searchResultList";}};m.saveResultViewType=function(r){if(jQuery.sap.storage.isSupported()){jQuery.sap.storage.put("resultViewType",r);}};m.idMap={};m.subscribeOnlyOnce=function(i,e,c,s){if(m.idMap[i]){m.idMap[i].unsubscribe();}var w=function(){c.apply(s);sap.ui.getCore().getEventBus().unsubscribe(e,w,s);};sap.ui.getCore().getEventBus().subscribe(e,w,s);m.idMap[i]={unsubscribe:function(){sap.ui.getCore().getEventBus().unsubscribe(e,w,s);}};};m._isDisplayed=function(c){if(c&&c.getDomRef&&c.getDomRef()){return true;}return false;};m.SearchFocusHandler=function(){this.init.apply(this,arguments);};m.SearchFocusHandler.prototype={init:function(s){this.oSearchView=s;},get2BeFocusedControlDomRef:function(){if(!this.oModel){this.oModel=this.oSearchView.getModel();}var i=0;var c=null;var a=null;var b=false;if(!this.oModel.getDataSource().equals(this.oModel.appDataSource)){if(this.oModel.getProperty('/boCount')>0&&this.oModel.getProperty('/appCount')>0){i=this.oModel.getProperty('/focusIndex');i=(i>0)?i+1:i;c=this.oSearchView.resultList.getItems()[i];if(c&&c.getDomRef){a=c.getDomRef();}}else if(this.oModel.getProperty('/boCount')>0&&this.oModel.getProperty('/appCount')===0){i=this.oModel.getProperty('/focusIndex');b=this.oModel.getResultToDisplay()==="searchResultTable";if(!b){c=this.oSearchView.resultList.getItems()[i];}else{c=this.oSearchView.searchResultTable.getItems()[i];}if(c&&c.getDomRef){a=c.getDomRef();}}else if(this.oModel.getProperty('/boCount')===0&&this.oModel.getProperty('/appCount')>0){var f=this.oSearchView.resultList.getItems()[0];if(!m._isDisplayed(f)){return null;}var t=f.getContent()[0];if(!m._isDisplayed(t)){return null;}c=t.getTiles()[0];if(!m._isDisplayed(c)){return null;}a=m.getFocusableTileDomRef(c.getDomRef());}}else{var T=this.oSearchView.appSearchResult;if(T.getDomRef()===null){return null;}i=this.oModel.getProperty('/focusIndex');c=T.getTiles()[i];if(m._isDisplayed(c)){a=m.getFocusableTileDomRef(c.getDomRef());}}return a;},setFocus:function(){var t=this;var r=10;var d=function(){t.focusSetter=null;var c=t.get2BeFocusedControlDomRef();if(!c||sap.ui.getCore().getUIDirty()||sap.ui.getCore().byId('Fiori2LoadingDialog').isOpen()||jQuery('.sapUshellSearchTileContainerDirty').length>0||jQuery('.sapMBusyDialog').length>0){if(--r){t.focusSetter=setTimeout(d,100);}return;}c.focus();if(t.oModel.getProperty('/focusIndex')===0){var a=sap.ui.getCore().byId(c.getAttribute('id'));if(a&&a.getContent&&a.getContent()[0]){var b=a.getContent()[0];if(b.showDetails){b.showDetails();}}}t.oSearchView.resultList.collectListItemsForNavigation();};if(this.focusSetter){clearTimeout(this.focusSetter);this.focusSetter=null;}d();}};m.getFocusableTileDomRef=function(t){return jQuery(t).find('[tabindex], button')[0];};m.formatInteger=function(v){if(!m._integerShortFormatter){m._integerShortFormatter=sap.ui.core.format.NumberFormat.getIntegerInstance({style:'short',precision:3,groupingEnabled:true});}if(!m._integerStandardFormatter){m._integerStandardFormatter=sap.ui.core.format.NumberFormat.getIntegerInstance({style:'standard',precision:3,groupingEnabled:true});}if(Math.abs(v)>=99950){return m._integerShortFormatter.format(v);}else{return m._integerStandardFormatter.format(v);}};})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.SearchLogger')){(function(g){"use strict";jQuery.sap.declare('sap.ushell.renderers.fiori2.search.SearchLogger');var m=sap.ushell.renderers.fiori2.search.SearchLogger={};var S=sap.ushell.renderers.fiori2.search.SearchConfiguration;m.NavigationEvent=function(){this.init.apply(this,arguments);};m.NavigationEvent.prototype={init:function(p){var c=S.getInstance();this.sina=c.getSina();},_createUserHistoryEntry:function(t){function a(p){var n=p;for(var i=0,q=n.length;i<q;i++){var r=n[i];if(r.indexOf("sap-system")!==-1){var v=r.split("=");return{"System":v[1].slice(4,7),"Client":v[1].slice(8,-1)};}}}function b(H){return H.split("-")[0];}function c(H){return H.split("-")[1].split("&")[0];}function d(p){var n=p;var q=[];for(var i=0,r=n.length;i<r;i++){var v=n[i];if(v.indexOf("sap-system")!==-1){continue;}var w=v.split("=")[0];var x=v.split("=")[1];q.push({"Name":w,Value:x});}return q;}var u={"NavigationEventList":[{"SourceApplication":{"SemanticObjectType":"","Intent":"","ParameterList":[]}},{"TargetApplication":{"SemanticObjectType":"","Intent":"","ParameterList":[]}}]};var h=window.hasher.getHashAsArray();var s=b(h[0]);u.NavigationEventList[0].SourceApplication.SemanticObjectType=s;var e=c(h[0]);u.NavigationEventList[0].SourceApplication.Intent=e;var f=d(h[1].split("&"));u.NavigationEventList[0].SourceApplication.ParameterList=f;h=t.split("?");var j=b(h[0]).split("#")[1];u.NavigationEventList[1].TargetApplication.SemanticObjectType=j;var k=c(h[0]);u.NavigationEventList[1].TargetApplication.Intent=k;var l=d(h[1].split("&"));u.NavigationEventList[1].TargetApplication.ParameterList=l;var o=a(h[1].split("&"));u.NavigationEventList[1].TargetApplication=jQuery.extend(u.NavigationEventList[1].TargetApplication,o);return u;},addUserHistoryEntry:function(t){if(!t){return;}if(t.indexOf("#")===-1){return;}var s=this.sina.getSystem().getServices();if(s.PersonalizedSearch&&s.PersonalizedSearch.capabilities&&s.PersonalizedSearch.capabilities.SetUserStatus){var u=this._createUserHistoryEntry(t);this.sina.addUserHistoryEntry(u).done(function(d){}).fail(function(e){});}}};}(window));};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.SearchResultListFormatter')){(function(){"use strict";jQuery.sap.declare('sap.ushell.renderers.fiori2.search.SearchResultListFormatter');var m=sap.ushell.renderers.fiori2.search.SearchResultListFormatter=function(){this.init.apply(this,arguments);};m.prototype={init:function(){},format:function(s,t){return this._doFormat(s.getElements(),t);},_getImageUrl:function(r){var i={imageUrl:'',name:''};for(var p in r){var a=r[p];var b=false;try{if(a.value&&(a.$$MetaData$$.presentationUsage.indexOf('Image')>=0||a.$$MetaData$$.presentationUsage.indexOf('Thumbnail')>=0)){b=true;}}catch(e){}if(!b){continue;}i.imageUrl=a.value;i.name=p;return i;}return i;},_moveWhyFound2ResponseAttr:function(w,p){var l=w.length;while(l--){if(w[l].labelRaw===p.labelRaw&&p!==undefined){p.value=w[l].value;p.whyfound=true;w.splice(l,1);}}},_appendRemainingWhyfounds2FormattedResultItem:function(w,i){var l=w.length;while(l--){if(w[l].labelRaw!==undefined){var I={};I.name=w[l].label;I.value=w[l].value;I.whyfound=true;i.push(I);w.splice(l,1);}}},_doFormat:function(r,t){var s=function(a,b){return a.displayOrder-b.displayOrder;};var c,d,e,f,g;var h=[];for(var i=0;i<r.length;i++){var j=r[i];if(j.$$DataSourceMetaData$$.semanticObjectType==='fileprocessorurl'){c=j.$$DataSourceMetaData$$.client;d='UIA000~EPM_FILE_PROC_U_DEMO~';if(j.$$DataSourceMetaData$$.objectName&&j.$$DataSourceMetaData$$.objectName.value){d=j.$$DataSourceMetaData$$.objectName.value;}e='/sap/es/fl_get_files?sap-client='+c+'&connector='+d+'&filetype=ThumbNail&PHIO_ID='+j.PHIO_ID.valueRaw;j.thumbnail={$$MetaData$$:{accessUsage:[],correspondingSearchAttributeName:"thumbnail",dataType:"String",description:"Thumbnail",displayOrder:0,isKey:false,isSortable:false,isTitle:false,presentationUsage:["Thumbnail"]},label:"Thumbnail",labelRaw:"Thumbnail",value:e,valueRaw:e};f='/sap/es/fl_get_files?sap-client='+c+'&connector='+d+'&filetype=BinaryContent&PHIO_ID='+j.PHIO_ID.valueRaw;j.titlelink={$$MetaData$$:{accessUsage:[],correspondingSearchAttributeName:"titlelink",dataType:"String",description:"Display original document",displayOrder:0,isKey:false,isSortable:false,isTitle:false,presentationUsage:["Titlelink"]},label:"Display original document",labelRaw:"Display original document",value:f,valueRaw:f};g='/sap/es/fl_get_files?sap-client='+c+'&connector='+d+'&filetype=SUVFile&PHIO_ID='+j.PHIO_ID.valueRaw;g='/ui/processSteps/Pdf2Text/pdfjs/web/viewer.html?file='+encodeURIComponent(g);j.suvlink={$$MetaData$$:{accessUsage:[],correspondingSearchAttributeName:"suvlink",dataType:"String",description:"Display suv file",displayOrder:0,isKey:false,isSortable:false,isTitle:false,presentationUsage:["Link"]},label:"Display suv file",labelRaw:"suvlink",value:g,valueRaw:g};}var u='';var k=j.$$RelatedActions$$;for(var l in k){if(k[l].type==="Navigation"||k[l].type==="Link"){u=encodeURI(k[l].uri);}}var w=j.$$WhyFound$$||[];var n=[];var o=[];var p=[];var q='';var v={};for(var x in j){if(!j[x].label||!j[x].$$MetaData$$){continue;}var A=j[x].$$MetaData$$.presentationUsage||[];if(A&&A.length>0){if(A.indexOf("Title")>-1&&j[x].value){this._moveWhyFound2ResponseAttr(w,j[x]);q=q+" "+j[x].value;}if(A.indexOf("Summary")>-1){n.push({property:x,displayOrder:j[x].$$MetaData$$.displayOrder});}else if(A.indexOf("Detail")>-1){o.push({property:x,displayOrder:j[x].$$MetaData$$.displayOrder});}else if(A.indexOf("Title")>-1){p.push({property:x,displayOrder:j[x].$$MetaData$$.displayOrder});}}var B=j[x].$$MetaData$$.semanticObjectType;if(B&&B.length>0){v[B]=j[x].valueRaw;}}n.sort(s);o.sort(s);p.sort(s);var C=n.concat(o);var D={};D.key=j.key;D.keystatus=j.keystatus;D.semanticObjectTypeAttrs=v;var E=this._getImageUrl(j);D.imageUrl=E.imageUrl;D.dataSourceName=j.$$DataSourceMetaData$$.label;D.dataSource=j.$$DataSourceMetaData$$;D.uri=u;D.semanticObjectType=j.$$DataSourceMetaData$$.semanticObjectType||"";D.$$Name$$='';D.systemId=j.$$DataSourceMetaData$$.systemId||"";D.client=j.$$DataSourceMetaData$$.client||"";D.suvlink=j.suvlink;var F;var I={};var G=[];for(var z=0;z<C.length;z++){F=C[z].property;I={};if(F!==E.name){this._moveWhyFound2ResponseAttr(w,j[F]);I.name=j[F].label;I.value=j[F].value;I.key=F;I.isTitle=false;I.isSortable=j[F].$$MetaData$$.isSortable;I.attributeIndex=z;if(j[F].whyfound){I.whyfound=j[F].whyfound;}G.push(I);}}var T=[];for(var y=0;y<p.length;y++){F=p[y].property;I={};if(F!==E.name){I.name=j[F].label;I.value=j[F].value;I.key=F;I.isTitle=false;I.isSortable=j[F].$$MetaData$$.isSortable;T.push(I);}}D.$$Name$$=q.trim();D.numberofattributes=C.length;D.title=j.title;D.itemattributes=G;D.titleattributes=T;D.selected=D.selected||false;D.expanded=D.expanded||false;this._appendRemainingWhyfounds2FormattedResultItem(w,D.itemattributes);h.push(D);}return h;}};})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.SearchTabStripsFormatter')){(function(){"use strict";jQuery.sap.declare('sap.ushell.renderers.fiori2.search.SearchTabStripsFormatter');var m=sap.ushell.renderers.fiori2.search.SearchTabStripsFormatter={};m.Node=function(){this.init.apply(this,arguments);};m.Node.prototype={init:function(d,c){this.dataSource=d;this.children=[];this.parent=null;this.count=c;},equals:function(o){return this===o;},setCount:function(c){this.count=c;},getAncestors:function(){var a=[],c=this;while(c.parent){a.push(c.parent);c=c.parent;}return a;},getChildren:function(){var c=[];for(var i=0;i<this.children.length;++i){var a=this.children[i];if(a.unsureWhetherNodeisBelowRoot){continue;}c.push(a);}return c;},getChildrenSortedByCount:function(){var c=this.getChildren();c.sort(function(a,b){return b.count-a.count;});return c;},clearChildren:function(){for(var i=0;i<this.children.length;++i){var c=this.children[i];c.parent=null;}this.children=[];},appendNode:function(n){n.parent=this;this.children.push(n);},appendNodeAtIndex:function(n,i){n.parent=this;this.children.splice(i,0,n);},removeChildNode:function(n){var i=this.children.indexOf(n);if(i<0){return;}this.children.splice(i,1);n.parent=null;},hasChild:function(n){return this.children.indexOf(n)>-1;},hasSibling:function(n){if(this.equals(n)){return false;}var p=this.parent;if(!p){return false;}if(p.hasChild(n)){return true;}return false;},_findNode:function(d,r){if(this.dataSource.equals(d)){r.push(this);return;}for(var i=0;i<this.children.length;++i){var c=this.children[i];c._findNode(d,r);if(r.length>0){return;}}}};m.Tree=function(){this.init.apply(this,arguments);};m.Tree.prototype={init:function(r){this.rootNode=new m.Node(r,null);},reset:function(){this.rootNode=null;},invalidate:function(d){var n=this.findNode(d);if(!n){this.rootNode.children=[];this.rootNode.count=0;return;}var c=null;while(n){n.children=c?[c]:[];n.count=null;if(c){c.count=null;}c=n;n=n.parent;}},findNode:function(d){if(!this.rootNode){return null;}var r=[];this.rootNode._findNode(d,r);return r.length>0?r[0]:null;},hasChild:function(d,a){if(a.equals(this.rootNode.dataSource)){return false;}var n=this.findNode(d);if(!n){return false;}var b=this.findNode(a);if(!b){return false;}return n.hasChild(b);},hasSibling:function(d,a){if(a.equals(this.rootNode.dataSource)){return false;}var n=this.findNode(d);if(!n){return false;}var b=this.findNode(a);if(!b){return false;}return n.hasSibling(b);},updateFromPerspective:function(d,p,a){var c=null;try{c=p.getSearchFacet().getQuery().getResultSetSync().totalcount;}catch(e){}var b=this.findNode(d);if(!b){b=new m.Node(d,c);b.unsureWhetherNodeisBelowRoot=true;this.rootNode.appendNode(b);}b.setCount(c);if(d.equals(a.allDataSource)){b.setCount(b.count+a.getProperty('/appCount'));}this.updateFromPerspectiveChildDataSources(b,p,a);this.updateAppTreeNode(d,a);},updateAppTreeNode:function(d,a){if(!d.equals(a.allDataSource)&&!d.equals(a.appDataSource)){return;}var b=this.findNode(a.appDataSource);if(b){this.rootNode.removeChildNode(b);}var c=a.getProperty('/appCount');if(c===0&&!d.equals(a.appDataSource)){return;}b=new m.Node(a.appDataSource,c);this.rootNode.appendNodeAtIndex(b,0);},updateFromPerspectiveChildDataSources:function(c,p,a){if(!p||c.dataSource.equals(a.appDataSource)){return;}var f=p.getChartFacets();if(f.length===0){return;}var d=f[0];if(d.facetType!=='datasource'){return;}var b=d.getQuery().getResultSetSync().getElements();c.clearChildren();for(var i=0;i<b.length;++i){var e=b[i];var g=e.dataSource;var h=this.findNode(g);if(!h){h=new m.Node(g,e.valueRaw);}if(h.unsureWhetherNodeisBelowRoot){h.unsureWhetherNodeisBelowRoot=false;this.rootNode.removeChildNode(h);}if(h.parent){h.parent.removeChildNode(h);}h.setCount(e.valueRaw);c.appendNode(h);}}};m.Formatter=function(){this.init.apply(this,arguments);};m.Formatter.prototype={init:function(r){this.tree=new m.Tree(r);},format:function(d,p,a){this.tree.updateFromPerspective(d,p,a);var t=this.generateTabStrips(d,a);return t;},invalidate:function(d){if(this.tree){this.tree.invalidate(d);}},generateTabStrips:function(d,a){var t=9999;var i,c,b;var e={strips:[],selected:null};var n=this.tree.findNode(d);if(!n){if(!d.equals(a.allDataSource)){e.strips.push(a.allDataSource);}e.strips.push(d);e.selected=d;return e;}if(n.dataSource.equals(a.allDataSource)){e.strips.push(a.allDataSource);b=n.getChildrenSortedByCount();for(i=0;i<b.length&&e.strips.length<t;++i){c=b[i];e.strips.push(c.dataSource);}e.selected=a.allDataSource;return e;}if(n.parent===this.tree.rootNode&&!n.unsureWhetherNodeisBelowRoot){e.strips.push(a.allDataSource);var f=false;b=this.tree.rootNode.getChildrenSortedByCount();for(i=0;i<b.length;++i){c=b[i];if(f){if(e.strips.length>=t){break;}e.strips.push(c.dataSource);}else{if(e.strips.length<t-1||n===c){e.strips.push(c.dataSource);if(n===c){f=true;}}}}if(b.length===0){e.strips.push(n.dataSource);}e.selected=n.dataSource;return e;}e.strips.push(a.allDataSource);e.strips.push(n.dataSource);e.selected=n.dataSource;return e;}};})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.UXLog')){(function(){"use strict";var S=sap.ushell.renderers.fiori2.search.SearchHelper;jQuery.sap.declare('sap.ushell.renderers.fiori2.search.UXLog');var m=sap.ushell.renderers.fiori2.search.UXLog={};jQuery.extend(m,{logLines:[],log:function(){this._log.apply(this,arguments);},_log:function(t){this.logLines.push(t);this._save();},_save:function(){jQuery.ajax({type:'PUT',url:'/uxlog.txt',data:this.logLines.join('\n')+'\n',contentType:'text/plain'});this.logLines=[];}});m._save=S.delayedExecution(m._save,2000);})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.container.Component')){jQuery.sap.declare("sap.ushell.renderers.fiori2.search.container.Component");jQuery.sap.require('sap.ui.core.UIComponent');sap.ui.core.UIComponent.extend("sap.ushell.renderers.fiori2.search.container.Component",{metadata:{version:"1.44.6",library:"sap.ushell.renderers.fiori2.search.container",includes:[],dependencies:{libs:["sap.m"],components:[]},config:{title:sap.ushell.resources.i18n.getText("searchAppTitle"),compactContentDensity:true,cozyContentDensity:true}},createContent:function(){"use strict";return sap.ui.view({id:"searchContainerApp",viewName:"sap.ushell.renderers.fiori2.search.container.App",type:sap.ui.core.mvc.ViewType.JS});}});};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.container.ComponentService')){(function(){"use strict";jQuery.sap.declare('sap.ushell.renderers.fiori2.search.container.ComponentService');var m=sap.ushell.renderers.fiori2.search.container.ComponentService={};jQuery.sap.require('sap.ushell.renderers.fiori2.search.esh.api.release.sina');jQuery.sap.require('jquery.sap.storage');jQuery.extend(m,{init:function(){sap.ushell.Container={getService:function(n){if(n==="Search"){return{queryApplications:function(p){return jQuery.when().then(function(){return{totalResults:0,searchTerm:p.searchTerm,getElements:function(){return[];}};});}};}else if(n==="URLParsing"){return{parseParameters:function(s){s=s.substr(1);var r={};var p=s.split("&");for(var i=0;i<p.length;i++){var a=p[i].split("=");if(!a[1]){a[1]="";}r[a[0]]=[a[1]];}return r;},splitHash:function(h){var r={};r.appSpecificRoute=h.substr(14);return r;}};}}};sap.ushell.resources={};sap.ushell.resources.i18nModel=new sap.ui.model.resource.ResourceModel({bundleUrl:"/sap/bc/resources/sap/ushell/renderers/fiori2/resources/resources.properties",bundleLocale:"en"});sap.ushell.resources.i18n=sap.ushell.resources.i18nModel.getResourceBundle();}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchAdvancedCondition')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchAdvancedCondition');(function(){"use strict";jQuery.sap.require('sap.ui.layout.HorizontalLayout');var s=sap.ushell.renderers.fiori2.search.SearchFacetDialogHelper;sap.ui.layout.HorizontalLayout.extend('sap.ushell.renderers.fiori2.search.controls.SearchAdvancedCondition',{metadata:{properties:{"type":""}},constructor:function(o){var t=this;o=jQuery.extend({},{allowWrapping:true,content:t.contentFactory(o.type)},o);sap.ui.layout.HorizontalLayout.prototype.constructor.apply(this,[o]);t.addStyleClass('sapUshellSearchFacetDialogDetailPageCondition');},renderer:'sap.ui.layout.HorizontalLayoutRenderer',contentFactory:function(t){var a=this;var A=new sap.m.CheckBox({select:function(e){if(t==="string"||t==="text"){s.updateCountInfo(e.getSource().getParent().getParent().getParent().getParent().getParent().getParent());}else{s.updateCountInfo(e.getSource().getParent().getParent().getParent());}}}).addStyleClass('sapUshellSearchFacetDialogDetailPageConditionCheckBox');var o=sap.ui.getCore().byId("operatorLabel");if(!o){o=new sap.ui.core.InvisibleText("operatorLabel",{text:sap.ushell.resources.i18n.getText("operator")});}var i,b,I,S;switch(t){case'date':i=new sap.m.DateRangeSelection({width:'86%',change:function(e){a.onDateRangeSelectionChange(e);}}).addStyleClass('sapUshellSearchFacetDialogDetailPageConditionInput');break;case'string':A.setVisible(false);I=new sap.m.Input({width:'57%',placeholder:sap.ushell.resources.i18n.getText("filterCondition"),liveChange:function(e){a.onAdvancedInputChange(e);}}).addStyleClass('sapUshellSearchFacetDialogDetailPageConditionInput');S=new sap.m.Select({width:'40%',tooltip:sap.ushell.resources.i18n.getText("operator"),items:[new sap.ui.core.Item({text:sap.ushell.resources.i18n.getText("equals"),key:'eq'}),new sap.ui.core.Item({text:sap.ushell.resources.i18n.getText("beginsWith"),key:'bw'}),new sap.ui.core.Item({text:sap.ushell.resources.i18n.getText("endsWith"),key:'ew'}),new sap.ui.core.Item({text:sap.ushell.resources.i18n.getText("contains"),key:'co'})]}).addStyleClass('sapUshellSearchFacetDialogDetailPageConditionSelect');S.addAriaLabelledBy("operatorLabel");i=new sap.ui.layout.HorizontalLayout({allowWrapping:true,content:[S,I]});b=new sap.m.Button({icon:"sap-icon://sys-cancel",type:sap.m.ButtonType.Transparent,tooltip:sap.ushell.resources.i18n.getText("removeButton"),press:function(e){a.onDeleteButtonPress(e);}});break;case'text':A.setVisible(false);I=new sap.m.Input({width:'57%',placeholder:sap.ushell.resources.i18n.getText("filterCondition"),liveChange:function(e){a.onAdvancedInputChange(e);}}).addStyleClass('sapUshellSearchFacetDialogDetailPageConditionInput');S=new sap.m.Select({width:'40%',tooltip:sap.ushell.resources.i18n.getText("operator"),items:[new sap.ui.core.Item({text:sap.ushell.resources.i18n.getText("containsWords"),key:'co'})]}).addStyleClass('sapUshellSearchFacetDialogDetailPageConditionSelect');S.addAriaLabelledBy("operatorLabel");i=new sap.ui.layout.HorizontalLayout({allowWrapping:true,content:[S,I]});b=new sap.m.Button({icon:"sap-icon://sys-cancel",type:sap.m.ButtonType.Transparent,tooltip:sap.ushell.resources.i18n.getText("removeButton"),press:function(e){a.onDeleteButtonPress(e);}});break;case'number':var c=new sap.m.Input({width:'46.5%',placeholder:sap.ushell.resources.i18n.getText("fromPlaceholder"),liveChange:function(e){a.onAdvancedNumberInputChange(e);}}).addStyleClass('sapUshellSearchFacetDialogDetailPageConditionInput');var d=new sap.m.Input({width:'46.5%',placeholder:sap.ushell.resources.i18n.getText("toPlaceholder"),liveChange:function(e){a.onAdvancedNumberInputChange(e);}}).addStyleClass('sapUshellSearchFacetDialogDetailPageConditionInput');var l=new sap.m.Label({text:'...'}).addStyleClass('sapUshellSearchFacetDialogDetailPageConditionLabel');i=new sap.ui.layout.HorizontalLayout({allowWrapping:true,content:[c,l,d]});i.addEventDelegate({onAfterRendering:function(e){var f=e.srcControl.getParent().getParent().getContent().length;var g=e.srcControl.getParent().getParent().indexOfAggregation("content",e.srcControl.getParent());if(g===f-2){var v=e.srcControl.getContent()[2].getValue();e.srcControl.getContent()[2].setValue();e.srcControl.getContent()[2].setValue(v);}}});break;default:break;}return[A,i,b];},onDateRangeSelectionChange:function(e){var d=e.getSource();var a=d.getParent();var A=a.getContent()[0];if(d.getDateValue()&&d.getSecondDateValue()){A.setSelected(true);s.insertNewAdvancedCondition(a,"date");s.updateCountInfo(a.getParent().getParent());}else{A.setSelected(false);}},onAdvancedInputChange:function(e){var i=e.getSource();var a=i.getParent().getParent();var A=a.getContent()[0];if(i.getValue()){A.setSelected(true);s.updateCountInfo(a.getParent().getParent().getParent().getParent().getParent());}else{A.setSelected(false);}},onDeleteButtonPress:function(e){var a=e.getSource().getParent();s.deleteAdvancedCondition(a);},onAdvancedNumberInputChange:function(e){var i=e.getSource();var a=i.getParent().getParent();var A=a.getContent()[0];if(i.getParent().getContent()[0].getValue()&&i.getParent().getContent()[2].getValue()){A.setSelected(true);s.insertNewAdvancedCondition(a,"number");s.updateCountInfo(a.getParent().getParent());}else{A.setSelected(false);}}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchButton')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchButton');(function(){"use strict";jQuery.sap.require('sap.m.Button');sap.m.Button.extend('sap.ushell.renderers.fiori2.search.controls.SearchButton',{constructor:function(i,o){o=jQuery.extend({},{icon:sap.ui.core.IconPool.getIconURI("search"),tooltip:sap.ushell.resources.i18n.getText("search")},o);sap.m.Button.prototype.constructor.apply(this,[i,o]);this.addStyleClass('searchBtn');},renderer:'sap.m.ButtonRenderer'});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchFacetBarChart')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchFacetBarChart');(function(){"use strict";jQuery.sap.require('sap.suite.ui.microchart.ComparisonMicroChart');sap.ui.core.Control.extend('sap.ushell.renderers.fiori2.search.controls.SearchFacetBarChart',{metadata:{properties:{lastUpdated:{type:"string"},aItems:{type:"object"}},aggregations:{'items':{type:'sap.suite.ui.microchart.ComparisonMicroChartData',multiple:true}}},constructor:function(o){var t=this;t.options=o;sap.ui.core.Control.prototype.constructor.apply(this);this.bindAggregation('items','items',function(){var c=new sap.suite.ui.microchart.ComparisonMicroChartData({title:'{label}',value:'{value}',color:{path:'selected',formatter:function(v){var r=sap.m.ValueColor.Good;if(!v){r=sap.m.ValueColor.Neutral;}return r;}},displayValue:'{valueLabel}',press:function(e){var a=e.getSource().getBindingContext();var m=a.getModel();var d=a.getObject();var i=d.selected;var f=d.filterCondition;if(i){if(t.options.oSearchFacetDialog){t.options.oSearchFacetDialog.onDetailPageSelectionChangeCharts(e);}else{m.removeFilterCondition(f,true);}}else if(t.options.oSearchFacetDialog){t.options.oSearchFacetDialog.onDetailPageSelectionChangeCharts(e);}else{m.addFilterCondition(f,true);}}});return c;});},renderer:function(r,c){r.write('<div');r.writeControlData(c);r.writeClasses();r.write('>');var C=new sap.suite.ui.microchart.ComparisonMicroChart({width:"90%",colorPalette:"",press:function(e){},tooltip:""});if(c.options.oSearchFacetDialog){C.setWidth("95%");C.addStyleClass("sapUshellSearchFacetBarChartLarge");}else{C.addStyleClass("sapUshellSearchFacetBarChart");}C.addEventDelegate({onAfterRendering:function(e){$('#'+this.sId).has('.Good').addClass("sapUshellSearchFacetBarChartSelected");}});var a=c.getItems();var b=c.getAItems();if(a.length===0&&b){a=b;}var m=0;for(var i=0;i<a.length;++i){var d=a[i];if(!c.options.oSearchFacetDialog){if(d.mProperties&&d.mProperties.value){C.addData(d);}else if(d.mProperties&&!d.mProperties.value){m++;}}else{C.addData(d);}}c.iMissingCnt=m;r.renderControl(C);r.write('</div>');},onAfterRendering:function(){var t=this;if(t.iMissingCnt>0){var a=$(this.getDomRef()).closest(".sapUshellSearchFacetIconTabBar").find(".sapUshellSearchFacetInfoZeile")[0];var I=sap.ui.getCore().byId(a.id);var m=sap.ushell.resources.i18n.getText("infoZeileNumberMoreSelected",[t.iMissingCnt]);I.setText(m);}var A=$(".sapSuiteUiMicroChartPointer");for(var i=0;i<A.length;i++){var b=A[i];var s=b.title;if(s&&s.indexOf(":")===-1){b.title=s.replace(/( \d+) *$/,':$1');}}},setEshRole:function(){}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchFacetDialog')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchFacetDialog');(function(){"use strict";jQuery.sap.require('sap.m.Dialog');var s=sap.ushell.renderers.fiori2.search.SearchFacetDialogHelper;var a=sap.ushell.renderers.fiori2.search.SearchFacetDialogHelperCharts;sap.m.Dialog.extend('sap.ushell.renderers.fiori2.search.controls.SearchFacetDialog',{constructor:function(o){var t=this;t.bShowCharts=true;t.bOldPieChart=true;if(jQuery.sap.getUriParameters().mParams.newpie&&jQuery.sap.getUriParameters().get("newpie")!=="false"){t.bOldPieChart=false;}t.chartOnDisplayIndex=o.selectedTabBarIndex;t.facetOnDisplayIndex=0;t.chartOnDisplayIndexByFilterArray=[];t.aItemsForBarChart=[];t.tabBarItems=o.tabBarItems;t.searchFacetDialogHelperCharts=a;if(!t.tabBarItems){a.setDummyTabBarItems(t);}o=jQuery.extend({},{showHeader:false,horizontalScrolling:false,verticalScrolling:false,contentHeight:'35rem',beginButton:new sap.m.Button({text:sap.ushell.resources.i18n.getText("okDialogBtn"),press:function(e){t.onOkClick(e);t.close();t.destroy();}}),endButton:new sap.m.Button({text:sap.ushell.resources.i18n.getText("cancelDialogBtn"),press:function(e){t.close();t.destroy();}}),content:[t.createContainer()]},o);t.selectedAttribute=o.selectedAttribute?o.selectedAttribute:"";delete o.selectedAttribute;delete o.selectedTabBarIndex;delete o.tabBarItems;sap.m.Dialog.prototype.constructor.apply(this,[o]);s.init(t);a.init(t);t.addStyleClass('sapUshellSearchFacetDialog');},renderer:'sap.m.DialogRenderer',createContainer:function(){var t=this;t.oSplitContainer=new sap.m.SplitContainer({masterPages:t.createMasterPages()});t.oSplitContainer.bindAggregation("detailPages","/facetDialog",function(i,c){return t.createDetailPages(i,c);});t.oSplitContainer.addStyleClass('sapUshellSearchFacetDialogContainer');return t.oSplitContainer;},createMasterPages:function(){var t=this;var f=new sap.m.List({mode:sap.m.ListMode.SingleSelectMaster,selectionChange:function(e){t.onMasterPageSelectionChange(e);}});f.addStyleClass('sapUshellSearchFacetDialogFacetList');f.bindAggregation("items","/facetDialog",function(i,c){var l=new sap.m.StandardListItem({title:"{title}",counter:"{count}"});return l;});var r=new sap.m.Button({icon:"sap-icon://clear-filter",tooltip:sap.ushell.resources.i18n.getText("resetFilterButton_tooltip"),type:'Transparent',enabled:false,press:function(e){t.resetAllFilters(e);}});r.addStyleClass("sapUshellSearchFacetDialogFilterResetButton");var m=new sap.m.Page({title:sap.ushell.resources.i18n.getText("filters"),headerContent:r,content:[f]}).addStyleClass('sapUshellSearchFacetDialogMasterContainer');m.addEventDelegate({onAfterRendering:function(e){if(t.selectedAttribute){for(var i=0;i<f.getItems().length;i++){var l=f.getItems()[i];var b=l.getBindingContext().getObject();if(t.selectedAttribute===b.dimension){f.setSelectedItem(l);t.facetOnDisplayIndex=i;t.chartOnDisplayIndexByFilterArray.push(t.chartOnDisplayIndex);}else{var n=0;var c=l.getBindingContext().getModel().oData.facets;for(var j=0;j<c.length;j++){if(c[j].chartIndex&&c[j].dimension===b.dimension&&!isNaN(c[j].chartIndex)){n=c[j].chartIndex;}}t.chartOnDisplayIndexByFilterArray.push(n);}}}if(!f.getSelectedItem()){f.setSelectedItem(f.getItems()[0]);}var S=f.getSelectedItem();s.updateDetailPage(S);t.resetEnabledForFilterResetButton();}});var M=[m];return M;},resetAllFilters:function(e){var m=this.getModel();m.resetFilterConditions(false);m.aFilters=[];var M=s.getFacetList();var f=M.getItems();for(var i=0;i<f.length;i++){f[i].setCounter(0);}this.resetAdvancedConditionFilters();s.updateDetailPage(M.getSelectedItem());this.resetEnabledForFilterResetButton();},resetAdvancedConditionFilters:function(){var t=this;var A,c,n,b,p,C,j;var d=t.oSplitContainer.getDetailPages();for(var i=0;i<d.length;i++){var D=d[i];n=s.POS_ATTRIBUTE_LIST_CONTAINER;A=D.getContent()[n];if(A){for(j=A.getContent().length-2;j>0;j--){c=A.getContent()[j];p=c.getParent();C=c;p.removeContent(C);}}else{n=s.POS_ICONTABBAR;b=s.POS_TABBAR_CONDITION;A=D.getContent()[n].getItems()[b].getContent()[0];if(A){for(j=A.getContent().length-1;j>-1;j--){c=A.getContent()[j];if(c.getContent&&c.getContent()[1]){var e=c.getContent()[1].getContent()[1];var f=e.getValue();if(f&&(""+f).length>0){p=c.getParent();C=c;p.removeContent(C);}}}}}}},resetEnabledForFilterResetButton:function(f){var F=false;var o=0;var m=s.getFacetList();var b=m.getItems();for(var i=0;i<b.length;i++){o+=b[i].getCounter();}var M=this.getModel();if(M.aFilters&&M.aFilters.length>0||f||o>0){F=true;}var c=$('.sapUshellSearchFacetDialogFilterResetButton')[0].id;var r=sap.ui.getCore().byId(c);r.setEnabled(F);},onMasterPageSelectionChange:function(e){var t=this;var l=e.mParameters.listItem;t.facetOnDisplayIndex=l.getParent().indexOfItem(l.getParent().getSelectedItem());t.setChartOnDisplayIndexForFacetListItem(t.facetOnDisplayIndex);var m=l.getParent().getModel();var b=l.getBindingContext().sPath;t.resetIcons(m,b,t);s.updateDetailPage(l);if(t.oSplitContainer.getMode()==="ShowHideMode"){t.oSplitContainer.hideMaster();}t.controlChartVisibility(t,t.chartOnDisplayIndex);},createDetailPages:function(i,c){var t=this;var f=c.oModel.getProperty(c.sPath).facetType;var d=c.oModel.getAttributeDataType(c.oModel.getProperty(c.sPath).dataType);var S=new sap.m.Select({items:[new sap.ui.core.Item({text:sap.ushell.resources.i18n.getText("notSorted"),key:"notSorted"}),new sap.ui.core.Item({text:sap.ushell.resources.i18n.getText("sortByCount"),key:"sortCount"}),new sap.ui.core.Item({text:sap.ushell.resources.i18n.getText("sortByName"),key:"sortName"})],selectedKey:(d==="string"||d==="text")?"sortCount":"notSorted",change:function(E){t.onSelectChange(E);}}).addStyleClass('sapUshellSearchFacetDialogSettingsSelect');var C=new sap.m.CheckBox({text:"Show Selected on Top",enabled:false,select:function(E){t.onCheckBoxSelect(E);}});var o=new sap.ui.layout.VerticalLayout({content:[S,C]}).addStyleClass('sapUshellSearchFacetDialogSettingsContainer');o.setVisible(false);var l=new sap.m.List({includeItemInSelection:true,showNoData:false,showSeparators:sap.m.ListSeparators.None,selectionChange:function(E){t.onDetailPageSelectionChange(E);}});l.addStyleClass('sapUshellSearchFacetDialogDetailPageList');l.addStyleClass('largeChart0');if(f==="attribute"){l.setMode(sap.m.ListMode.MultiSelect);}var b={path:"items",factory:function(i,c){var B=c.oModel.getProperty(c.sPath);var n=new sap.m.StandardListItem({title:"{label}",tooltip:sap.ushell.resources.i18n.getText("facetListTooltip",["{label}","{value}"]),info:"{valueLabel}",selected:"{selected}"});if(B.selected){c.oModel.addFilter(B);}return n;}};if(d==="number"){S.removeItem(2);}b.filters=new sap.ui.model.Filter("advanced",sap.ui.model.FilterOperator.NE,true);l.bindAggregation("items",b);l.setBusyIndicatorDelay(0);l.data('dataType',d);if(t.bShowCharts){l.addEventDelegate({onAfterRendering:function(E){t.hideSelectively(E,t,0);}});}var L,e,g;e=a.getBarChartPlaceholder();e.addEventDelegate({onAfterRendering:function(E){t.hideSelectively(E,t,1);}});e.data('dataType',d);if(t.bOldPieChart){g=a.getPieChartPlaceholder();}else{g=a.getPieChartPlaceholder2();}g.addEventDelegate({onAfterRendering:function(E){t.hideSelectively(E,t,2);}});if(t.bShowCharts&&(d==="string"||d==="text")){L=new sap.m.ScrollContainer({height:'67.2%',horizontal:false,vertical:true,content:[l,e,g]});}else{L=new sap.m.ScrollContainer({height:'calc(100% - 0.25rem)',horizontal:false,vertical:true,content:[l]});}L.addStyleClass('sapUshellSearchFacetDialogDetailPageListContainer');L.addStyleClass('searchFacetLargeChartContainer');var A=new sap.ushell.renderers.fiori2.search.controls.SearchAdvancedCondition({type:d});var p;if(d==="string"||d==="text"){var h=new sap.m.ScrollContainer({horizontal:false,vertical:true,content:[A]});h.addStyleClass('sapUshellSearchFacetDialogDetailPageAdvancedContainer');var P=new sap.m.Button({icon:"sap-icon://add",type:sap.m.ButtonType.Transparent,press:function(E){t.onPlusButtonPress(E,d);}});h.addContent(P);h.data('dataType',d);h.data('initial',true);L.setHeight('calc(100% - 0.25rem)');h.setHeight('100%');var j=a.getDropDownButton(t);var k=new sap.m.Toolbar({content:[new sap.m.SearchField({placeholder:sap.ushell.resources.i18n.getText("filterPlaceholder"),liveChange:function(E){t.onSearchFieldLiveChange(E);}}),new sap.m.ToggleButton({icon:"sap-icon://sort",press:function(E){t.onSettingButtonPress(E);}}).addStyleClass('sapUshellSearchFacetDialogSortButton')]}).addStyleClass('sapUshellSearchFacetDialogSubheaderToolbar');k.addEventDelegate({onAfterRendering:function(E){$('.sapUshellSearchFacetDialogSubheaderToolbar').removeClass("sapContrastPlus");}});if(t.bShowCharts){k.addContent(j);}var T=new sap.m.Page({showHeader:false,subHeader:k,content:[o,L]}).addStyleClass('sapUshellSearchFacetDialogDetailPage');var I=new sap.m.IconTabBar({upperCase:true,expandable:false,stretchContentHeight:true,backgroundDesign:sap.m.BackgroundDesign.Transparent,applyContentPadding:false,select:function(E){t.controlChartVisibility(t,t.chartOnDisplayIndex);},items:[new sap.m.IconTabFilter({text:sap.ushell.resources.i18n.getText("selectFromList"),content:[T]}),new sap.m.IconTabFilter({text:sap.ushell.resources.i18n.getText("defineCondition"),content:[h]})]});I.addStyleClass('sapUshellSearchFacetDialogIconTabBar');p=new sap.m.Page({showHeader:true,title:c.oModel.getProperty(c.sPath).title,content:[I]});p.addStyleClass('sapUshellSearchFacetDialogDetailPageString');}else{L.addContent(A);L.data('dataType',d);L.data('initial',true);if(t.bShowCharts){var m=c.oModel.getProperty(c.sPath).title;p=new sap.m.Page({title:m,showHeader:true,content:[o,L]});}else{p=new sap.m.Page({showHeader:true,title:c.oModel.getProperty(c.sPath).title,content:[o,L]});}p.addStyleClass('sapUshellSearchFacetDialogDetailPage');}return p;},onDetailPageSelectionChange:function(e){var t=this;var S=e.mParameters.listItem;var b=S.getBindingContext().getObject();if(S.getSelected()){t.getModel().addFilter(b);}else{t.getModel().removeFilter(b);}var l=e.oSource;var d;if(l.data('dataType')==="string"||l.data('dataType')==="text"){d=l.getParent().getParent().getParent().getParent().getParent().getParent();}else{d=l.getParent().getParent();}s.updateCountInfo(d);var o=l.getParent().getParent().getContent()[s.POS_SETTING_CONTAINER];var c=o.getContent()[s.POS_SHOWONTOP_CHECKBOX];var f=o.getContent()[s.POS_SORTING_SELECT];if(c.getSelected()){c.setSelected(false);f.setSelectedKey("notSorted");}if(l.getSelectedContexts().length>0){c.setEnabled(true);}else{c.setEnabled(false);}},onSearchFieldLiveChange:function(e){var f=e.getSource().getValue();var S=s.getFacetList().getSelectedItem();s.updateDetailPage(S,f);},onSettingButtonPress:function(e){var p=e.oSource.getPressed();var S=e.oSource.getParent().getParent().getContent()[s.POS_SETTING_CONTAINER];var l=e.oSource.getParent().getParent().getContent()[s.POS_ATTRIBUTE_LIST_CONTAINER];if(p){S.setVisible(true);l.setHeight('calc(100% - 4.25rem)');}else{S.setVisible(false);l.setHeight('calc(100% - 0.25rem)');}},onSelectChange:function(e){s.sortingAttributeList(e.oSource.getParent().getParent());},onCheckBoxSelect:function(e){s.sortingAttributeList(e.oSource.getParent().getParent());},onPlusButtonPress:function(e,t){var A=e.getSource().getParent();var n=new sap.ushell.renderers.fiori2.search.controls.SearchAdvancedCondition({type:t});var i=A.getAggregation("content").length-1;A.insertAggregation("content",n,i);},onOkClick:function(e){var t=this;var M=t.getModel();var S=t.getModel('searchModel');S.resetFilterConditions(false);var d=t.oSplitContainer.getDetailPages();for(var m=0;m<M.aFilters.length;m++){var b=M.aFilters[m];if(!b.advanced){S.addFilterCondition(b.filterCondition,false);}}for(var i=0;i<d.length;i++){if(s.getFacetList().getItems()[i]){s.applyAdvancedCondition(d[i],s.getFacetList().getItems()[i].getBindingContext().getObject(),S);}}S.filterChanged=true;S._firePerspectiveQuery();},setChartOnDisplayIndexForFacetListItem:function(f){var t=this;var r=0;try{r=t.chartOnDisplayIndexByFilterArray[f];}catch(e){r=0;}if(r===undefined){r=0;}t.chartOnDisplayIndex=r;},resetIcons:function(m,p,c){var t=this;var b=false;var d=m.getAttributeDataType(m.getProperty(p).dataType);if(t.bShowCharts&&(d==="string"||d==="text")){b=true;}var e=$('.sapUshellSearchFacetDialogTabBarButton');if(b){e.css("display","block");for(var i=0;i<e.length;i++){var f=e[i].id;var D=sap.ui.getCore().byId(f);var g=c.tabBarItems[c.chartOnDisplayIndex].getIcon();D.setIcon(g);var h=c.tabBarItems[c.chartOnDisplayIndex].getText();var j=sap.ushell.resources.i18n.getText('displayAs',[h]);D.setTooltip(j);}}else{e.css("display","none");}},onDetailPageSelectionChangeCharts:function(e){var c=0;var b,m,d,f,g,S,h,B,p,M;var k,n,i,o;if(e.getSource&&e.sId==="press"){b=e.getSource().getBindingContext();m=b.getModel();d=b.getObject();f=d.selected;g=f?false:true;S=e.getSource();h=S.getBindingContext().sPath+"/selected";m.setProperty(h,g);B=S.getBindingContext().getObject();if(g){m.addFilter(B);}else{m.removeFilter(B);}p=h.replace(/\/items.+/,'');p+="/items";k=m.getProperty(p);c=0;for(i=0;i<k.length;i++){n=k[i];if(n.selected===true){c++;}}}else if(e.getSource&&(e.sId==="selectData"||e.sId==="deselectData")){b=e.getSource().getBindingContext();m=b.getModel();d=b.getObject();g=(e.sId==="selectData")?true:false;S=e.getSource();h=S.getBindingContext().sPath+"/items/";var l;for(var j=0;j<e.getParameters().data.length;j++){l=e.getParameters().data[j].data._context_row_number;h+=l+"/selected";m.setProperty(h,g);B=S.getBindingContext().getObject().items[l];if(g){m.addFilter(B);}else{m.removeFilter(B);}}p=h.replace(/\/items.+/,'');p+="/items";k=m.getProperty(p);c=0;for(i=0;i<k.length;i++){if(k[i].selected===true){c++;}}var q=e.mParameters.data.length;if(!g&&q>1){c=0;for(i=0;i<k.length;i++){k[i].selected=false;}}}else{d=e.dataObject;f=d.selected;g=f?false:true;c=e.cnt;m=e.model;var r=new sap.ushell.renderers.fiori2.search.FacetItem();r.facetAttribute=d.dimension;r.filterCondition=d.filterCondition;r.label=d.label;r.selected=d.selected;r.value=d.value;r.valueLabel=d.valueLabel;if(f){m.addFilter(r);}else{m.removeFilter(r);}}M=s.getFacetList();o=M.getSelectedItem();if(!o){o=M.getItems()[0];}o.setCounter(c);this.resetEnabledForFilterResetButton();},updateDetailPageCharts:function(i,m){var t=this;if(t.bShowCharts===false){return;}t.aItemsForBarChart=i;var l=a.getListContainersForDetailPage();var L=l[1];var c=L.getContent();if(c&&t.chartOnDisplayIndex===2){var p=c[2];var e=l[5];var r=l[2];r=0.9*r;if(p.directUpdate){var b={};b.relevantContainerHeight=r;b.oSearchFacetDialog=t;var M=new sap.ui.model.json.JSONModel();M.setData(i);$("#"+e.id).empty();p.directUpdate(i,e,M,b);}}var d,f;if(c&&t.chartOnDisplayIndex===1){d=l[0].firstChild.children[2];if(d){f=$("#"+d.id);f.css("display","none");}}if(c&&t.chartOnDisplayIndex===2){d=l[0].firstChild.children[1];if(d){f=$("#"+d.id);f.css("display","none");}}},controlChartVisibility:function(c,b,f){var t=this;var e,d,g,h;if(t.bShowCharts===false){return;}var l=c.searchFacetDialogHelperCharts.getListContainersForDetailPage();var L=l[1];if(!L||!L.getContent){return;}var j=L.getContent();for(var i=0;i<j.length;i++){e=l[0].firstChild.children[i];if(!e){return;}g=e.className;h=false;if(g.indexOf("largeChart")>-1){h=true;}d=$("#"+e.id);if(h&&i!==b){d.css("display","none");}else{d.css("display","block");}}if(c.bOldPieChart){if(h&&b===2&&f){var I=t.aItemsForBarChart;var m=t.getModel();t.updateDetailPageCharts(I,m);}if(h&&b===2){L.setVertical(false);}else{L.setVertical(true);}}var S=l[6];var o=l[7];if(S){if(b===0){S.css("display","block");o.css('visibility','visible');}else{S.css("display","none");o.css('visibility','hidden');}}},hideSelectively:function(e,c,b){var d=$("#"+e.srcControl.sId);var f=c.chartOnDisplayIndex;var l=c.searchFacetDialogHelperCharts.getListContainersForDetailPage();var L=l[1];if(l[0].firstChild.children.length!=3){return;}if(f!==undefined){if(c.chartOnDisplayIndex!==b){d.css("display","none");}else{d.css("display","block");}}else{d.css("display","block");}if(f===2){if(!l[0].firstChild.children[2]||!l[0].firstChild.children[2].firstChild){c.controlChartVisibility(c,c.chartOnDisplayIndex,true);}if(c.bOldPieChart){L.setVertical(false);}}else{L.setVertical(true);}var S=l[6];if(S){var g=$("#"+S.sId);if(f===0){g.css("display","block");}else{g.css("display","none");}}}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchFacetItem')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchFacetItem');(function(){"use strict";jQuery.sap.require('sap.ui.core.format.NumberFormat');jQuery.sap.require('sap.m.StandardListItem');var S=sap.ushell.renderers.fiori2.search.SearchHelper;sap.m.StandardListItem.extend('sap.ushell.renderers.fiori2.search.controls.SearchFacetItem',{constructor:function(i,o){var t=this;t.options=jQuery.extend({},{type:sap.m.ListType.Active,title:"{label}",tooltip:"{label}"+": "+"{valueLabel}",info:{parts:[{path:'value'}],formatter:function(v){return typeof v==="number"?S.formatInteger(v):"";}},selected:"{selected}"},o);sap.m.StandardListItem.prototype.constructor.apply(this,[i,t.options]);this.addStyleClass('sapUshellSearchFacetItem');this.addEventDelegate({onAfterRendering:function(){if(t.getBindingContext()&&t.getBindingContext().getObject()){var l=t.getBindingContext().getObject().level;if(jQuery("html").attr("dir")==='rtl'){jQuery(t.getDomRef()).children(".sapMLIBContent").css("padding-right",l+"rem");}else{jQuery(t.getDomRef()).children(".sapMLIBContent").css("padding-left",l+"rem");}}}});},renderer:'sap.m.StandardListItemRenderer'});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchFacetPieChart')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchFacetPieChart');(function(){"use strict";jQuery.sap.require('sap.ui.thirdparty.d3');sap.ui.core.Control.extend('sap.ushell.renderers.fiori2.search.controls.SearchFacetPieChart',{setEshRole:function(r){},metadata:{properties:{oSearchFacetDialog:{}},aggregations:{items:{type:"sap.ushell.renderers.fiori2.search.FacetItem",multiple:true}}},renderer:function(R,C){R.write("<div");R.writeControlData(C);R.writeClasses();R.write('>');function e(){if(navigator.appName==='Microsoft Internet Explorer'){return true;}return false;}var P=function(){this.init.apply(this,arguments);};P.Labelposition=(function(){var a=function(){this.init.apply(this,arguments);};a.prototype={init:function(b,c,s,d,r,f,g,h,t,i){this.backgroundWidth=b;this.backgroundHeight=c;this.startAngle=s;this.endAngle=d;this.r=r;this.labelPaddingX=3;this.labelPaddingY=3;this.radiusPadding=4.24;this.labelWidth=f+2*this.labelPaddingX;this.labelHeight=g;this.outsetMin=0.3;this.outsetMax=1.2;this.outsetStep=0.025;this.apexAngle=d-s;this.startLabelWidth=this.labelWidth;this.d3centroid=h;this.text=t;this.svgBackground=i;this.debug=false;this.labelHeight=this.labelHeight+2*this.labelPaddingY;var x=Math.round(this.backgroundWidth/2);var y=Math.round(this.backgroundHeight/2);this.translateStr="translate("+x+","+y+")";},update:function(){var o=Math.max(this.outsetMin,Math.sin(this.apexAngle/2)/(this.apexAngle/2)*2/3);var p=true;var i=Math.max(100,this.labelWidth*2,1/this.outsetStep);var b=0;var c;do{p=true;c=this.calc(o,this.labelWidth,this.labelHeight);if(o>this.outsetMax||o<this.outsetMin){break;}if(this.labelWidth<0){break;}var d,f,g,h;if(b===0){d=this.calc(o+this.outsetStep,this.labelWidth,this.labelHeight);f=this.calc(o-this.outsetStep,this.labelWidth,this.labelHeight);g=this.value(d,c);h=this.value(f,c);if(g<h&&h>0.5){b=-1;o+=this.outsetStep*b;p=false;}else if(g>0.5||c.labelWidth<=0){b=1;o+=this.outsetStep*b;p=false;}}else{d=this.calc(o+this.outsetStep*b,this.labelWidth,this.labelHeight);g=this.value(d,c);if(g>0.5||c.labelWidth<=0){o+=this.outsetStep*b;p=false;}}i--;}while(!p&&i>0&&!isNaN(o));c=this.calc(o,this.labelWidth,this.labelHeight);this.labelWidth=c.labelWidth;var x=c.x;var y=c.y;this.svgBackground.select("circle.centroid").remove();if(this.debug){this.svgBackground.append("svg:circle").attr("class","centroid").attr("cx",c.centroidX).attr("cy",c.centroidY).attr("r",2).style("fill","blue");}this.svgBackground.selectAll("line.helper").remove();if(this.debug){this.svgBackground.append("svg:line").attr("class","helper helper2").attr("x1",-this.backgroundWidth/2).attr("x2",this.backgroundWidth/2).attr("y1",y-this.labelHeight/2).attr("y2",y-this.labelHeight/2);this.svgBackground.append("svg:line").attr("class","helper helper2").attr("x1",-this.backgroundWidth/2).attr("x2",this.backgroundWidth/2).attr("y1",y+this.labelHeight/2).attr("y2",y+this.labelHeight/2);this.svgBackground.append("svg:line").attr("class","helper").attr("x1",0).attr("y1",0).attr("x2",Math.sin(this.startAngle)*(this.r+this.radiusPadding)).attr("y2",-Math.cos(this.startAngle)*(this.r+this.radiusPadding));this.svgBackground.append("svg:line").attr("class","helper").attr("x1",0).attr("y1",0).attr("x2",Math.sin(this.endAngle)*(this.r+this.radiusPadding)).attr("y2",-Math.cos(this.endAngle)*(this.r+this.radiusPadding));this.svgBackground.append("svg:line").attr("class","helper").attr("x1",Math.sin(this.startAngle)*(this.r+this.radiusPadding)).attr("y1",-Math.cos(this.startAngle)*(this.r+this.radiusPadding)).attr("x2",this.isStartAngleOnRight()?this.backgroundWidth/2:-this.backgroundWidth/2).attr("y2",-Math.cos(this.startAngle)*(this.r+this.radiusPadding));this.svgBackground.append("svg:line").attr("class","helper").attr("x1",Math.sin(this.endAngle)*(this.r+this.radiusPadding)).attr("y1",-Math.cos(this.endAngle)*(this.r+this.radiusPadding)).attr("x2",this.isEndAngleOnRight()?this.backgroundWidth/2:-this.backgroundWidth/2).attr("y2",-Math.cos(this.endAngle)*(this.r+this.radiusPadding));}if(this.labelWidth<2*this.labelPaddingX){this.labelWidth=0;}else if(this.labelWidth<this.startLabelWidth){this.labelWidth=this.labelWidth-2*this.labelPaddingX;}this.x=(isNaN(x))?0:(x);this.y=(isNaN(x))?0:(y);},calc:function(o,b,c){var d,f,g,r,p,h;if(this.startAngle-this.endAngle+2*Math.PI<1e-9){d=0;f=0;r=this.backgroundWidth/2;g=-this.backgroundWidth/2;h=-this.r;p=this.r;}else{d=Math.sin(this.apexAngle/2)*this.r*o;f=Math.cos(this.apexAngle/2)*-this.r*o;var t=d*Math.cos(this.startAngle)-f*Math.sin(this.startAngle);f=d*Math.sin(this.startAngle)+f*Math.cos(this.startAngle);d=t;var u=f-this.labelHeight/2;var i=f+this.labelHeight/2;g=Math.max(this.calcLeftBorder(d,u),this.calcLeftBorder(d,i),-this.backgroundWidth/2);if(Math.abs(this.startAngle-this.endAngle%(2*Math.PI))>1e-9&&d>0&&u<=0&&i>=0){g=Math.max(g,0);}if(!this.doesFitHeight(g,u,i,(d<0),true)){g=this.backgroundWidth/2;}r=Math.min(this.calcRightBorder(d,u),this.calcRightBorder(d,i),this.backgroundWidth/2);if(Math.abs(this.startAngle-this.endAngle%(2*Math.PI))>1e-9&&d<0&&u<=0&&i>=0){r=Math.min(r,0);}if(!this.doesFitHeight(r,u,i,(d<0),false)){r=-this.backgroundWidth/2;}var j=this.calcPerimeterBorder(1,f-this.labelHeight/2);if(j<d){j=this.backgroundWidth/2;}var k=this.calcPerimeterBorder(1,f+this.labelHeight/2);if(k<d){k=this.backgroundWidth/2;}p=Math.min(j,k,r);var m=this.calcPerimeterBorder(-1,f-this.labelHeight/2);if(m>d){m=-this.backgroundWidth/2;}var n=this.calcPerimeterBorder(-1,f+this.labelHeight/2);if(n>d){n=-this.backgroundWidth/2;}h=Math.max(m,n,g);if(isNaN(p)){p=r;}if(isNaN(h)){h=g;}}this.svgBackground.select("line.left").remove();this.svgBackground.select("line.right").remove();this.svgBackground.select("line.perimeterLeft").remove();this.svgBackground.select("line.perimeterRight").remove();if(this.debug){this.svgBackground.append("svg:line").attr("class","left").attr("y1",-this.backgroundHeight/2).attr("y2",this.backgroundHeight/2).attr("x1",g).attr("x2",g);this.svgBackground.append("svg:line").attr("class","right").attr("y1",-this.backgroundHeight/2).attr("y2",this.backgroundHeight/2).attr("x1",r).attr("x2",r);this.svgBackground.append("svg:line").attr("class","perimeterLeft").attr("y1",-this.backgroundHeight/2).attr("y2",this.backgroundHeight/2).attr("x1",h).attr("x2",h);this.svgBackground.append("svg:line").attr("class","perimeterRight").attr("y1",-this.backgroundHeight/2).attr("y2",this.backgroundHeight/2).attr("x1",p).attr("x2",p);}var q=b;b=Math.min(b,Math.floor(r-g));var x=d;x=Math.max(x,h+b/2);x=Math.min(x,p-b/2);if(x-b/2<h-1e-9||x+b/2>p+1e-9){x=(h+p)/2;}if(d>=0){x=Math.max(x,g+b/2);x=Math.min(x,r-b/2);}else{x=Math.min(x,r-b/2);x=Math.max(x,g-b/2);}var y=f;return{x:x,y:y,labelWidth:b,labelShortened:(b!==q),xSpace:r-g,centroidX:d,centroidY:f,asymmetry:Math.abs(x-d)};},value:function(c,b){if(c.labelWidth<0){return-10000;}if(c.labelWidth<b.labelWidth){return-100;}if(c.labelWidth>b.labelWidth){return(c.labelWidth-b.labelWidth)*1000;}if(b.labelShortened&&c.labelWidth===b.labelWidth){return(c.xSpace-b.xSpace)*100;}return 0;},doesFitHeight:function(b,u,c,i,d){var y=-Math.cos(this.startAngle)*(this.r+this.radiusPadding);var f=-Math.cos(this.endAngle)*(this.r+this.radiusPadding);if(Math.abs(this.startAngle-this.endAngle%(2*Math.PI))<1e-9){y=-this.backgroundHeight/2;f=this.backgroundHeight/2;}else if(b===0){y=-this.backgroundHeight/2;f=this.backgroundHeight/2;}else if(b>0){if(!this.isStartAngleOnRight()){y=-this.backgroundHeight/2;}else if(b<=Math.sin(this.startAngle)*(this.r+this.radiusPadding)){y=b/-Math.tan(this.startAngle);}if(!this.isEndAngleOnRight()){f=this.backgroundHeight/2;}else if(b<=Math.sin(this.endAngle)*(this.r+this.radiusPadding)){f=b/-Math.tan(this.endAngle);}if(i&&!d&&y>=c){y=-this.backgroundHeight/2;}if(i&&!d&&f<=u){f=this.backgroundHeight/2;}}else{if(this.isStartAngleOnRight()){y=this.backgroundHeight/2;}else if(b>Math.sin(this.startAngle)*(this.r+this.radiusPadding)){y=b/-Math.tan(this.startAngle);}if(this.isEndAngleOnRight()){f=-this.backgroundHeight/2;}else if(b>Math.sin(this.endAngle)*(this.r+this.radiusPadding)){f=b/-Math.tan(this.endAngle);}if(!i&&d&&f>=c){f=-this.backgroundHeight/2;}if(!i&&d&&y<=u){y=this.backgroundHeight/2;}}if(!d){this.svgBackground.selectAll(".rightBorder").remove();if(this.debug){this.svgBackground.append("svg:rect").attr("class","rightBorder").attr("x",b-3).attr("y",y-3).attr("width",6).attr("height",6).style("fill","green");this.svgBackground.append("svg:circle").attr("class","rightBorder").attr("cx",b).attr("cy",f).attr("this.r",3).style("fill","green");}}else{this.svgBackground.selectAll(".leftBorder").remove();if(this.debug){this.svgBackground.append("svg:rect").attr("class","leftBorder").attr("x",b-3).attr("y",y-3).attr("width",6).attr("height",6).style("fill","red");this.svgBackground.append("svg:circle").attr("class","leftBorder").attr("cx",b).attr("cy",f).attr("this.r",3).style("fill","red");}}return(u>=Math.min(y,f)-1e-9&&c<=Math.max(y,f)+1e-9);},calcLeftBorder:function(x,y){var b=-this.backgroundWidth/2;if(Math.abs(this.startAngle-this.endAngle%(2*Math.PI))<1e-9){return b;}if(y<=0){if(y>-Math.cos(this.startAngle)*(this.r+this.radiusPadding)){b=Math.tan(this.startAngle)*-y;}}else if(y<-Math.cos(this.endAngle)*(this.r+this.radiusPadding)){b=Math.tan(this.endAngle)*-y;}return b;},calcRightBorder:function(x,y){var b=this.backgroundWidth/2;if(Math.abs(this.startAngle-this.endAngle%(2*Math.PI))<1e-9){return b;}if(y>=0){if(-y>Math.cos(this.startAngle)*(this.r+this.radiusPadding)){b=Math.tan(this.startAngle)*-y;}}else if(-y<Math.cos(this.endAngle)*(this.r+this.radiusPadding)){b=Math.tan(this.endAngle)*-y;}return b;},calcPerimeterBorder:function(x,y){var b=(x>0)?this.backgroundWidth/2:-this.backgroundWidth/2;b=Math.sqrt(this.r*this.r-y*y);if(x<0){b*=-1;}return b;},isStartAngleOnRight:function(){return this.startAngle>0&&this.startAngle<=2*Math.PI/360*180;},isEndAngleOnRight:function(){return this.endAngle%(2*Math.PI)<2*Math.PI/360*180;}};return a;})();P.Tweens=(function(){var T={};T.tweenGenSimple=function(d,i,a,b,o,s){var c={startAngle:d.oldArc.startAngle,endAngle:d.oldArc.endAngle,innerRadius:b,outerRadius:o};var f={startAngle:d.startAngle,endAngle:d.endAngle,innerRadius:b,outerRadius:o};var j=d3.interpolate(c,f);return function(t){return s(j(t));};};T.tweenGenSimpleText=function(d,i,a,b,o,c,f){var g=" ";if((d.labelElement.childNodes[1])&&(d.labelElement.childNodes[1].childNodes[0])&&(d.labelElement.childNodes[1].childNodes[0].data)){g=d.labelElement.childNodes[1].childNodes[0].data;}var h=new P.Labelposition(c.options.width,c.options.height,d.oldArc.startAngle,d.oldArc.endAngle,c.options.outerRadius,d.labelElement.childNodes[1].getBBox().width,d.labelElement.childNodes[1].getBBox().height,c.svgArcGen(d).centroid(d),g,c.svg);h.update();var k=[h.x,h.y];var m=new P.Labelposition(c.options.width,c.options.height,d.startAngle,d.endAngle,c.options.outerRadius,d.labelElement.childNodes[1].getBBox().width,d.labelElement.childNodes[1].getBBox().height,c.svgArcGen(d).centroid(d),g,c.svg);m.update();if(m.labelWidth<d.labelElement.childNodes[1].getBBox().width){c.adjustLabelWidth(d.labelElement,m.labelWidth);}var n=[m.x,m.y];var j=d3.interpolateArray(k,n);var p=function(q){var t;if(f){t=T.translateStr4Padding(d.startAngle,d.endAngle,c.options.padding4click,q[0],q[1]);}else{t="translate("+q+")";}return t;};return function(t){return p(j(t));};};T.translateStr4Padding=function(s,a,p,x,y){var b=a-s;var c=p*Math.sin(b/2);var d=-(p*Math.cos(b/2));var t=c*Math.cos(s)-d*Math.sin(s);d=c*Math.sin(s)+d*Math.cos(s);c=t;var f="translate("+(x+c)+", "+(y+d)+")";return f;};T.tweenGenEcstasy=function(d,i,a,b,o,s){var c=Math.round((b+o)/2);var f;var g;if(i%2){f=o;g=c;}else{f=c;g=b;}var h={startAngle:d.oldArc.startAngle,endAngle:d.oldArc.endAngle,innerRadius:b,outerRadius:o};var j={startAngle:d.oldArc.startAngle,endAngle:d.oldArc.endAngle,innerRadius:g,outerRadius:f};var k=d3.interpolate(h,j);h={startAngle:d.oldArc.startAngle,endAngle:d.oldArc.endAngle,innerRadius:g,outerRadius:f};j={startAngle:d.startAngle,endAngle:d.endAngle,innerRadius:g,outerRadius:f};var r=d3.interpolate(h,j);h={startAngle:d.startAngle,endAngle:d.endAngle,innerRadius:g,outerRadius:f};j={startAngle:d.startAngle,endAngle:d.endAngle,innerRadius:b,outerRadius:o};var u=d3.interpolate(h,j);return function(t){if(t<=0.25){return s(k(t*4));}if(t<=0.75){return s(r((t-0.25)*2));}return s(u((t-0.75)*4));};};T.tweenGenLSD=function(d,i,a,b,o,s){var c=Math.round((b+o)/2);var f;var g;if(i%2){f=o;g=c;}else{f=c;g=b;}var h={startAngle:d.oldArc.startAngle,endAngle:d.oldArc.endAngle,innerRadius:b,outerRadius:o};var j={startAngle:d.oldArc.startAngle,endAngle:d.oldArc.endAngle,innerRadius:g,outerRadius:f};var k=d3.interpolate(h,j);h={startAngle:d.oldArc.startAngle,endAngle:d.oldArc.endAngle,innerRadius:g,outerRadius:f};j={startAngle:d.startAngle,endAngle:d.startAngle+(d.oldArc.endAngle-d.oldArc.startAngle),innerRadius:g,outerRadius:f};var m=d3.interpolate(h,j);h={startAngle:d.startAngle,endAngle:d.startAngle+(d.oldArc.endAngle-d.oldArc.startAngle),innerRadius:g,outerRadius:f};j={startAngle:d.startAngle,endAngle:d.endAngle,innerRadius:g,outerRadius:f};var r=d3.interpolate(h,j);h={startAngle:d.startAngle,endAngle:d.endAngle,innerRadius:g,outerRadius:f};j={startAngle:d.startAngle,endAngle:d.endAngle,innerRadius:b,outerRadius:o};var u=d3.interpolate(h,j);return function(t){if(t<=0.25){return s(k(t*4));}if(t<=0.5){return s(m((t-0.25)*4));}if(t<=0.75){return s(r((t-0.5)*4));}return s(u((t-0.75)*4));};};return T;})();var l={};l.debug=function(t){};P.prototype={init:function(p,o,a,m){this.application=a;this.parent=p;this.model=m;this.chartElements=[];var b=d3.select(p);var s=$(p).innerHeight();var c=$(p).innerWidth();if(o.height>s){s=o.height;}var r=(Math.min(c,s)/2);this.options={"dimension-pie":"YEAR",backgroundWidth:c,backgroundHeight:s,width:c,height:s,innerRadius:0,outerRadius:r*0.8,tweenGen:P.Tweens.tweenGenSimple,tweenGenText:P.Tweens.tweenGenSimpleText,arcCalculator:P.generateHistoricalArcCalculator(),animationduration:1500,labelHideThreshold:0.05,easing:"linear",pieChartClass:"sap-piechart",pieChartParentClass:"sapUshellSearchFacetPieChart",color:"blue",strokewidth:1,strokewidthHover:3,padding4click:7,multipleselectable:true,oSearchFacetDialog:null};if(o){for(var f in o){this.options[f]=o[f];}}this.createAttributeService(P,"innerRadius",function(){this.init();});this.createAttributeService(P,"outerRadius",function(){this.init();});this.createAttributeService(P,"tweenGen",function(){this.init();});this.createAttributeService(P,"tweenGenText",function(){this.init();});this.createAttributeService(P,"width",function(){this.init();});this.createAttributeService(P,"height",function(){this.init();});this.createAttributeService(P,"animationduration");this.createAttributeService(P,"labelHideThreshold");this.createAttributeService(P,"arcCalculator");var x=Math.round(this.options.width/2);var y=Math.round(this.options.height/2);this.svg=b.append("svg:svg").attr("width",c).attr("height",s).attr("id",p.id+"_svg").append("svg:g").attr("transform","translate("+x+","+y+")");this.svgArcs=this.svg.append("svg:g");this.svgLabels=this.svg.append("svg:g");this.svg.attr("class",this.options.pieChartClass);this.inittween();this.oldArcs=[];this.clickedSegment={};this.firstUpdate=true;},getParent:function(){return this.parent;},createAttributeService:function(c,a,i){c.prototype[a]=function(v){if(v===null){return this.options[a];}else{this.options[a]=v;if(i){i.call(this);}return this;}};},inittween:function(){var t=this;t.xOrigin=Math.round(t.options.width/2);t.yOrigin=Math.round(t.options.height/2);t.svg.attr("width",this.options.width).attr("height",this.options.height);this.tweenGenArc=function(d,i,a){return t.options.tweenGen(d,i,a,t.options.innerRadius,t.options.outerRadius,t.svgArcGen(d));};this.tweenGenText=function(d,i,a,f){return t.options.tweenGenText(d,i,a,t.options.innerRadius,t.options.outerRadius,t,f);};},update:function(d){this.notAnimatedUpdate(d);},notAnimatedUpdate:function(a){var t=this;var b=[];if(!a){return;}this.chartElements=a;t.svgArcs.selectAll("path").remove();t.svgLabels.selectAll("g").remove();var c=0;for(var i=0;i<a.length;++i){c+=a[i].value;}for(var j=0;j<a.length;++j){a[j].percentage=a[j].value/c;}b=this.options.arcCalculator.calculateNewArcsOnly(a);var s=this.svgArcs.selectAll("path").data(b,P.getIdOfArc);if(!s.exit().empty()){s.exit().remove();}if(!s.empty()){s.attr("d",function(d){var p=t.svgArcGen(d);return p(d);}).attr("transform",function(d){var g;if(d.data.selected){g=P.translateStr4Padding(d.startAngle,d.endAngle,t.options.padding4click,0,0);}else{g="translate(0,0)";}return g;}).style("stroke",function(d){var g;if(d.data.stroke==="none"){g=d.data.stroke;}else if(d.data.selected||d.data.hovered){g="#dadada";}else{g="white";}return g;}).style("stroke-width",function(d){var g;if(d.data.selected||d.data.hovered){g=t.options.strokewidthHover;}else{g=t.options.strokewidth;}return g;}).style("opacity",function(d){var o;if(d.data.selected||d.data.hovered){o="1";}else if(d.data.initial){o="0.75";}else{o="0.5";}return o;}).each(function(d,i){while(this.hasChildNodes()){this.removeChild(this.lastChild);}d3.select(this).append("svg:title").text(""+d.data.tooltip);});}s.enter().append("svg:path").attr("transform",function(d){var g;if(d.data.selected){t.clickedSegment[d.data.id]=this;g=P.translateStr4Padding(d.startAngle,d.endAngle,t.options.padding4click,0,0);}return g;}).attr("shape-rendering","geometricPrecision").style("stroke",function(d){var g;if(d.data.stroke==="none"){g=d.data.stroke;}else if(d.data.selected||d.data.hovered){g="#dadada";}else{g="white";}return g;}).style("stroke-width",function(d){var g;if(d.data.selected||d.data.hovered){g=t.options.strokewidthHover;}else{g=t.options.strokewidth;}return g;}).style("opacity",function(d){var o;if(d.data.selected||d.data.hovered){o="1";}else if(d.data.initial){o="0.75";}else{o="0.5";}return o;}).attr("fill",function(d,i){return d.data.fill;}).on("click",function(d,i){var E;var g=d.data.selected;if((d.data.click)&&(d.data.pieupdateuionly===false)){var r=d.data.click(d,i);if((!t.options.multipleselectable)&&(!r)){return;}}var h,k;var m;var n=t.getLabelElementtbyLabel(d.data.label);if(n){var o=" ";if((n.childNodes[1])&&(n.childNodes[1].childNodes[0])&&(n.childNodes[1].childNodes[0].data)){o=n.childNodes[1].childNodes[0].data;}m=new P.Labelposition(t.options.width,t.options.height,d.startAngle,d.endAngle,t.options.outerRadius,n.childNodes[1].getBoundingClientRect().width,n.childNodes[1].getBoundingClientRect().height,t.svgArcGen(d).centroid(d),o,t.svg);m.update();if(m.labelWidth<n.childNodes[1].getBoundingClientRect().width){t.adjustLabelWidth(n,m.labelWidth);}}if(g){if((!t.options.multipleselectable)&&(Object.keys(t.clickedSegment).length>0)){delete t.clickedSegment[d.data.id];}d.data.selected=false;h="translate(0,0)";if(n){k="translate("+m.x+","+m.y+")";}if(t.options.oSearchFacetDialog){E={};E.cnt=t.getNumberOfClickedSegments();E.dataObject=d.data;E.model=t.model;t.options.oSearchFacetDialog.onDetailPageSelectionChangeCharts(E);}else{t.model.removeFilterCondition(d.data.filterCondition,true);}}else{if(!t.options.multipleselectable){if(Object.keys(t.clickedSegment).length>0){for(var p in t.clickedSegment){var q=t.clickedSegment[p];if(typeof q.__onclick==="function"){q.__data__.data.pieupdateuionly=true;q.__onclick.apply(q);}delete t.clickedSegment[p];}}if(Object.keys(t.clickedSegment).length<1){t.clickedSegment[d.data.id]=(this);}}d.data.selected=true;h=P.translateStr4Padding(d.startAngle,d.endAngle,t.options.padding4click,0,0);if(n){k=P.translateStr4Padding(d.startAngle,d.endAngle,t.options.padding4click,m.x,m.y);}if(d.data.filterCondition){if(t.options.oSearchFacetDialog){E={};E.cnt=t.getNumberOfClickedSegments();E.dataObject=d.data;E.model=t.model;t.options.oSearchFacetDialog.onDetailPageSelectionChangeCharts(E);}else{t.model.addFilterCondition(d.data.filterCondition,true);}}}d3.select(this).transition().duration(1000).ease(d3.ease("elastic")).attr("transform",h).style("stroke",function(d){var v;if(d.data.stroke==="none"){v=d.data.stroke;}else if(d.data.selected){v="#dadada";}else{v="white";}return v;}).style("stroke-width",function(d){var v;if(d.data.selected){v=t.options.strokewidthHover;}else{v=t.options.strokewidth;}return v;}).style("opacity",function(d){var v;if(d.data.selected||d.data.hovered){v="1";}else if(d.data.initial){v="0.75";}else{v="0.5";}return v;});var u=t.getLabelElementtbyLabel(d.data.label);if(u){d3.select(u).transition().duration(1000).ease(d3.ease("elastic")).attr("transform",k);}}).on("mouseover",function(d,i){if((!t.options.multipleselectable)&&(Object.keys(t.clickedSegment).length>0)){return;}if(d.data.selected||d.data.hovered){return;}if(d.data.mouseover){var r=d.data.mouseover(d,i);if((!t.options.multipleselectable)&&(!r)){return;}}}).on("mouseout",function(d,i){if((!t.options.multipleselectable)&&(Object.keys(t.clickedSegment).length>0)){return;}if(d.data.selected){return;}if(d.data.mouseout){var r=d.data.mouseout(d,i);if((!t.options.multipleselectable)&&(!r)){return;}}}).attr("d",function(d){var p=t.svgArcGen(d);return p(d);}).append("svg:title").text(function(d){return""+d.data.tooltip;});s=t.svgLabels.selectAll("g").data(b,P.getIdOfArc);if(!s.exit().empty()){s.exit().remove();}if(!s.empty()){s.style("opacity",function(d){if(d.removed||d.data.percentage<t.options.labelHideThreshold){return 0;}else{return 1;}}).attr("transform",function(d){var g;var h;if((this.childNodes[1])&&(this.childNodes[1].childNodes[0])){h=new P.Labelposition(t.options.width,t.options.height,d.startAngle,d.endAngle,t.options.outerRadius,this.getBoundingClientRect().width,this.getBoundingClientRect().height,t.svgArcGen(d).centroid(d),d.data.label,t.svg);}else{h=new P.Labelposition(t.options.width,t.options.height,d.startAngle,d.endAngle,t.options.outerRadius,this.getBoundingClientRect().width,this.getBoundingClientRect().height,t.svgArcGen(d).centroid(d)," ",t.svg);}h.update();if(h.labelWidth<this.childNodes[1].getBoundingClientRect().width){t.adjustLabelWidth(this,h.labelWidth);}if(d.data.selected){g=P.translateStr4Padding(d.startAngle,d.endAngle,t.options.padding4click,h.x,h.y);}else{g="translate("+h.x+","+h.y+")";}return g;});}if(!s.enter().empty()){var f=s.enter().append("svg:g").style("opacity",0);f.append("svg:text").attr("class","labelshadow").attr("text-anchor","middle").text(function(d){return""+d.data.label;}).style("pointer-events","none");f.append("svg:text").attr("class","label").attr("text-anchor","middle").text(function(d){return""+d.data.label;}).style("pointer-events","none");f.style("opacity",function(d){if(d.removed||d.data.percentage<t.options.labelHideThreshold){return 0;}else{return 1;}}).attr("transform",function(d){var g;var h=new P.Labelposition(t.options.width,t.options.height,d.startAngle,d.endAngle,t.options.outerRadius,this.getBoundingClientRect().width,this.getBoundingClientRect().height,t.svgArcGen(d).centroid(d),d.data.label,t.svg);h.update();if(h.labelWidth<this.childNodes[1].getBoundingClientRect().width){t.adjustLabelWidth(this,h.labelWidth);}if(d.data.selected){g=P.translateStr4Padding(d.startAngle,d.endAngle,t.options.padding4click,h.x,h.y);}else{g="translate("+h.x+","+h.y+")";}return g;});}t.oldArcs=P.removeDeletedArcs(b);},getNumberOfClickedSegments:function(){var c=0;var a=this.chartElements;for(var i=0;i<a.length;i++){if(a[i].selected===true){c++;}}return c;},adjustLabelWidth:function(a,t){var s=a.childNodes[0];var b=a.childNodes[1];if(t<=0){s.childNodes[0].data='';b.childNodes[0].data='';return;}var c=s.childNodes[0].data.length;s.childNodes[0].data+="...";var d="";while(s.getBBox().width>t){d=s.childNodes[0].data;d=d.substr(0,c-1)+d.substr(c,3);s.childNodes[0].data=d;c--;if(c<=0){s.childNodes[0].data='';break;}}b.childNodes[0].data=s.childNodes[0].data;},getArcsWithLabel:function(a){var t=this;var b=[];for(var i=0;i<a.length;++i){var c=a[i];if(c.data.percentage>t.options.labelHideThreshold){b.push(c);}}return b;},svgArcGen:function(d){var t=this;var a=d3.svg.arc().innerRadius(function(d){return t.options.innerRadius;}).outerRadius(function(d){return t.options.outerRadius;}).startAngle(function(d){return d.startAngle;}).endAngle(function(d){return d.endAngle;});return a;},getArcElementtbyLabel:function(a){var t=this;t.svgArcs.selectAll("g").each(function(d,i){if(d.data.label===a){t=this;}return;});return t;},getLabelElementtbyLabel:function(a){var t=this;t.svgLabels.selectAll("g").each(function(d,i){if(d.data.label===a){t=this;}});return t;}};P.removeDeletedArcs=function(a){var t=[];for(var i=0;i<a.length;++i){var b=a[i];if(!b.removed){t.push(b);}}return t;};P.createZeroArc=function(a,b){return{startAngle:a,endAngle:a,data:b,removed:true};};P.insertAfter=function(a,i,b){var n;if(i>=0){var c=a[i];n=P.createZeroArc(c.endAngle,b.data);}else{n=P.createZeroArc(0,b.data);}n.oldArc=b;a.splice(i+1,0,n);};P.getIdOfArc=function(a){return a.data.id;};P.arcsGen=d3.layout.pie().value(function(d){return d.value;}).sort(null);P.getIndexById=function(a,b){for(var i=0;i<a.length;++i){var c=a[i];if(P.getIdOfArc(c)===b){return i;}}return null;};P.add2arcSequence=function(d,a){if(e()){var b=function(x){a.getIndex(x.id);};d.forEach(b);}return d;};P.translateStr4Padding=function(s,a,p,x,y){var b=a-s;var c=p*Math.sin(b/2);var d=-(p*Math.cos(b/2));var t=c*Math.cos(s)-d*Math.sin(s);d=c*Math.sin(s)+d*Math.cos(s);c=t;var f="translate("+(x+c)+", "+(y+d)+")";return f;};P.Sequence=function(){this.init.apply(this,arguments);};P.Sequence.prototype={init:function(){this.maxIndex=0;this.objectMap={};},getIndex:function(o){var i=this.objectMap[o];if(typeof i!=='undefined'){return i;}i=this.maxIndex;this.maxIndex++;this.objectMap[o]=i;return i;}};P.generateDefaultArcCalculator=function(){return new P.DefaultArcCalculator();};P.DefaultArcCalculator=function(){this.init.apply(this,arguments);};P.DefaultArcCalculator.prototype={init:function(){this.arcSequence=new P.Sequence();},calculateNewArcsOnly:function(d){var t=this;d=d.slice();P.add2arcSequence(d,t.arcSequence);d.sort(function(a,b){return t.arcSequence.getIndex(a.id)-t.arcSequence.getIndex(b.id);});var n=P.arcsGen(d);return n;},calculateArcs:function(o,d){var n=P.arcsGen(d);this.insertMissingArcs(o,n,true);this.insertMissingArcs(n,o,false);return n;},insertMissingArcs:function(a,b,i){var c=-1;for(var d=0;d<b.length;++d){var f=b[d];var g=P.getIndexById(a,f.data.id);var h;if(g!==null){h=a[g];h.oldArc=f;c=g;continue;}else{if(i){c=this.determineInsertIndex(a,c,b,d);}var n;if(c>=0){var j=a[c];n=P.createZeroArc(j.endAngle,f.data);}else{n=P.createZeroArc(0,f.data);}n.oldArc=f;a.splice(c+1,0,n);c++;}}},determineInsertIndex:function(a,b,c,d){var f=c[d];var s=this.arcSequence.getIndex(f.data.id);var i;for(i=b+1;i<a.length;++i){var g=this.arcSequence.getIndex(a[i].data.id);if(g>s){break;}if(P.getIndexById(c,a[i].data.id)!==null){break;}}return i-1;}};P.generateHistoricalArcCalculator=function(){return new this.HistoricalArcCalculator();};P.HistoricalArcCalculator=function(){this.init.apply(this,arguments);};P.HistoricalArcCalculator.prototype={init:function(){this.arcSequence=new P.Sequence();},calculateNewArcsOnly:function(d){var t=this;d=d.slice();P.add2arcSequence(d,t.arcSequence);d.sort(function(a,b){return t.arcSequence.getIndex(a.id)-t.arcSequence.getIndex(b.id);});var n=P.arcsGen(d);return n;},calculateArcs:function(o,d){var t=this;d=d.slice();P.add2arcSequence(d,t.arcSequence);d.sort(function(a,b){return t.arcSequence.getIndex(a.id)-t.arcSequence.getIndex(b.id);});var n=P.arcsGen(d);this.insertMissingArcs(o,n);this.insertMissingArcs(n,o);return n;},insertMissingArcs:function(a,b){var t=this;var c=0;for(var d=0;d<b.length;++d){var f=b[d];var g=t.arcSequence.getIndex(f.data.id);var h;var i=false;for(;c<a.length;++c){h=a[c];var j=t.arcSequence.getIndex(h.data.id);if(j===g){i=true;break;}if(j>g){break;}}if(i){h.oldArc=f;}else{var n;if(c-1>=0&&c-1<a.length){var k=a[c-1];n=P.createZeroArc(k.endAngle,f.data);}else{n=P.createZeroArc(0,f.data);}a.splice(c,0,n);n.oldArc=f;}c++;}}};R.write("</div>");C.PieChart=P;},getFacetIndexById:function(c){var a=-1;var t=$("#"+c).parent().parent().parent().parent().parent()[0];var b=t.id;var d=$(".sapUshellSearchFacetIconTabBar");for(var i=0;i<d.length;i++){var e=d[i].id;if(e===b){a=i;break;}}return a;},getFacetIndexByIdForLargePieChart:function(c){var a=-1;var t=$("#"+c).parent().parent()[0];var b=t.id;var d=$(".searchFacetLargeChartContainer");for(var i=0;i<d.length;i++){var e=d[i].id;if(e===b){a=i;break;}}return a;},getPieChartIndexByFacetIndex:function(f){var s;var a=-1;var p=0;for(var i=0;i<f;i++){s=$($(".sapUshellSearchFacetIconTabBar")[i]).find(".sapMLIBContent")[1].firstChild.id;if(s.match(/pieChart/)!==null){p++;}}a=p;return a;},getSumSelected:function(d){var a;var b=0;if(d){for(var i=0;i<d.length;i++){if(d[i].facetType==="attribute"){for(var j=0;j<d[i].items.length;j++){a=d[i].items[j].value;if(a&&d[i].items[j].selected){b+=a;}}}}}return b;},getDataForPieChart:function(d,m){var r=[];var g=[];var a={};var b=0;var c="";var s=m.oData.count;var o=s;var p=0;this.iMissingCnt=0;for(var i=0;i<d.length;i++){if(d[i].facetType==="attribute"){if(d[i].totalCount){o=d[i].totalCount;}g=[];p=0;for(var j=0;j<d[i].items.length;j++){a={};b=d[i].items[j].value;if(b){c=""+b;p+=b;a.filterCondition=d[i].items[j].filterCondition;a.dimension=d[i].items[j].facetTitle;a.label=d[i].items[j].label;a.selected=d[i].items[j].selected;a.filterLabel=d[i].items[j].label;a.id=d[i].items[j].label;a.value=b;a.valueLabel=d[i].items[j].valueLabel;if(c){a.tooltip=d[i].items[j].label+": "+b;}else{a.tooltip=d[i].items[j].label;}a.filtered=false;a.removed=false;a.fill="#007CAA";a.maxLabelLength=30;g.push(a);}else{this.iMissingCnt++;}}var e=Math.round((p/o)*100);var f=(100-e);if(f>0){if(f===100){f=99;}var h=(18*p)/350;var l=""+f;a={};a.filterCondition=null;a.dimension="";a.label=l;a.id="perc_missing";a.value=h;a.valueLabel=l;a.tooltip=sap.ushell.resources.i18n.getText("facetPieChartOverflowText",[l]);a.filtered=false;a.removed=false;a.fill="transparent";a.stroke="none";a.maxLabelLength=30;g.push(a);}r.push(g);}}return r;},getDataForPieChartLarge:function(d,m){var g=[];var i={};var a=0;var p=0;g=[];p=0;for(var j=0;j<d.length;j++){a=d[j].value;if(a){i={};p+=a;i.filterCondition=d[j].filterCondition;i.dimension=d[j].facetAttribute;i.label=d[j].label;i.selected=d[j].selected;i.filterLabel=d[j].label;i.id=d[j].label;i.value=a;i.valueLabel=d[j].valueLabel;i.tooltip=d[j].label+"\t: "+a;i.filtered=false;i.removed=false;i.fill="#007CAA";i.maxLabelLength=30;g.push(i);}}return g;},directUpdate:function(d,p,m,o){var c,a,b;var f=[];var e=20;a=null;b=this.getModel();if(!b){b=this.oParent.getModel();}o.pieChartParentClass="sapUshellSearchFacetPieChartLarge";o.height=o.relevantContainerHeight;o.labelHideThreshold=0.000001;$(p).parent().parent().height(o.height);o.width=$(p).parent().parent().width();this.chartElements=this.getDataForPieChartLarge(d,m);c=new this.PieChart(p,o,a,b);for(var i=0;i<e;i++){if(this.chartElements[i]){f.push(this.chartElements[i]);}}c.update(f);},onAfterRendering:function(){var t=this;var d,c,a,m,b,p,f;var o={};b=null;m=this.getModel();if(!m){m=this.oParent.oModels.facets;}if(m){p=$("#"+this.sId)[0];if($(p).parent()[0].className==="sapMLIBContent"){o.pieChartParentClass="sapUshellSearchFacetPieChart";f=this.getFacetIndexById(this.sId);p.className=o.pieChartParentClass;d=this.getDataForPieChart(m.oData.facets,m);c=d[f];a=new this.PieChart(p,o,b,m);a.update(c);if(t.iMissingCnt>0){var i=$(this.getDomRef()).closest(".sapUshellSearchFacetIconTabBar").find(".sapUshellSearchFacetInfoZeile")[0];var I=sap.ui.getCore().byId(i.id);var e=sap.ushell.resources.i18n.getText("infoZeileNumberMoreSelected",[t.iMissingCnt]);I.setText(e);}}}}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchFacetTabBar')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchFacetTabBar');(function(){"use strict";jQuery.sap.require('sap.m.GroupHeaderListItemRenderer');jQuery.sap.require('sap.m.ButtonRenderer');sap.m.Button.extend('sap.ushell.renderers.fiori2.search.controls.SearchFacetDisplayModeDropDown',{renderer:'sap.ushell.renderers.fiori2.search.controls.SearchFacetDisplayModeDropDownRenderer'});sap.ushell.renderers.fiori2.search.controls.SearchFacetDisplayModeDropDownRenderer=jQuery.extend(true,{},sap.m.ButtonRenderer);sap.m.GroupHeaderListItemRenderer.extend('sap.ushell.renderers.fiori2.search.controls.SearchGroupHeaderListItemRenderer');sap.m.GroupHeaderListItem.extend('sap.ushell.renderers.fiori2.search.controls.SearchGroupHeaderListItem',{renderer:'sap.ushell.renderers.fiori2.search.controls.SearchGroupHeaderListItemRenderer',metadata:{properties:{button:{type:"control",defaultValue:null},upperCase:{type:"boolean",group:"Appearance",defaultValue:false}}}});sap.ushell.renderers.fiori2.search.controls.SearchGroupHeaderListItemRenderer.renderCounter=function(r,l){var b=l.getButton();if(b){this.renderCounterContent(r,l,b);}};sap.ushell.renderers.fiori2.search.controls.SearchGroupHeaderListItemRenderer.renderCounterContent=function(r,l,b){r.write('<div>');r.renderControl(b);r.write('</div>');};sap.m.SegmentedButtonItem.extend('my.SegmentedButtonItem',{aggregations:{"content1":{type:"sap.ui.core.Control",multiple:false}}});sap.ui.core.Control.extend('sap.ushell.renderers.fiori2.search.controls.SearchFacetTabBar',{metadata:{properties:{"eshRole":"string","headerText":"string","selectedButtonParameters":{type:"object",defaultValue:null}},aggregations:{items:{type:"sap.m.IconTabFilter",multiple:true}}},getSearchFacetTabBarAndDimensionById:function(b){var r={};r.index=0;var a=document.getElementById(b);var v=a.dataset.facetView;var c=a.dataset.facetViewIndex;var d=$("#"+b).parent()[0];var e=d.dataset.facetDimension;var f=$(".sapUshellSearchFacetTabBar");for(var i=0;i<f.length;i++){var g=$(".sapUshellSearchFacetTabBar .sapUshellSearchFacetTabBarHeader")[i];var h=g.dataset.facetDimension;if(h===e){r.index=i;r.control=sap.ui.getCore().byId(f[i].id);r.view=v;r.buttonIndex=c;r.dimension=e;break;}}return r;},storeClickedTabInformation:function(e){var s,a,b,d,c;var t=e.getSource().sId;var f=this.getSearchFacetTabBarAndDimensionById(t);var p=f.control.getModel().getPersonalizationStorageInstance().getItem("search-facet-panel-chart-state");s=f.dimension;a=f.control;b=f.view;c=f.buttonIndex;d=a.getBindingContext().getObject().dimension;var g=e.getParameters().id;var h=[];var o={};o.tabId=t;o.searchFacetTabBarIndex=f.searchFacetTabBarIndex;o.buttonId=g;o.buttonIndex=c;o.dimension=d;o.view=b;h.push(o);if(p&&Object.prototype.toString.call(p)==='[object Array]'){for(var i=0;i<p.length;i++){var j=p[i];if(j.dimension!==s){h.push(j);}}}f.control.getModel().getPersonalizationStorageInstance().setItem("search-facet-panel-chart-state",h);a.getBindingContext().getObject().chartIndex=c;},renderer:function(r,c){function a(x,T){return function(y){var d;var z=$(this.getDomRef()).closest(".sapUshellSearchFacetTabBar")[0];var E=sap.ui.getCore().byId($(z).attr("id"));var J=new sap.ushell.renderers.fiori2.search.SearchFacetDialogModel();J.setData(c.getModel().getData());J.prepareFacetList();if(E&&E.getBindingContext()&&E.getBindingContext().getObject()&&E.getBindingContext().getObject().dimension){d=E.getBindingContext().getObject().dimension;}var K=new sap.ushell.renderers.fiori2.search.controls.SearchFacetDialog({selectedAttribute:d,selectedTabBarIndex:x,tabBarItems:T});K.setModel(J);K.setModel(c.getModel(),'searchModel');K.open();var P=c.getParent().getParent().getParent().getParent();P.oFacetDialog=K;};}r.write("<div ");r.writeControlData(c);r.addClass("sapUshellSearchFacetTabBar");r.writeClasses();r.write('>');var d=c.getBindingContext().getObject().dimension;var b=c.getBindingContext().getObject().dataType;var t=c.getBindingContext().getObject().title;var e;var s;e=c.getModel().getPersonalizationStorageInstance().getItem("search-facet-panel-chart-state");if(e&&Object.prototype.toString.call(e)==='[object Array]'){for(var k=0;k<e.length;k++){if(e[k].dimension===d){s=e[k];break;}}}var f=[];var g=[];var C=null;var B=null;var h=0;if(s&&s.buttonIndex){h=s.buttonIndex;h=parseInt(h,10);}if(b!="text"){h=0;}c.getBindingContext().getObject().chartIndex=h;var j=c.getItems();var D=new sap.ushell.renderers.fiori2.search.controls.SearchFacetDisplayModeDropDown({icon:j[h].getIcon(),type:'Transparent'});for(var i=0;i<j.length;i++){C=j[i].getContent()[0];B=new sap.m.Button({text:j[i].getText(),icon:j[i].getIcon(),press:function(E){c.storeClickedTabInformation(E);c.setSelectedButtonParameters(E.getParameters());}});B.data("facet-view",j[i].getText(),true);B.data("facet-view-index",""+i,true);B.data("dimension",d,true);f.push(B);g.push(C);}var A=new sap.m.ActionSheet({showCancelButton:true,buttons:f,placement:sap.m.PlacementType.Bottom,cancelButtonPress:function(){jQuery.sap.log.info("sap.m.ActionSheet: cancelButton is pressed");}});A.data("facet-dimension",d,true);D.addStyleClass("sapUshellSearchFacetTabBarButton");var l=j[h].getText();var m=sap.ushell.resources.i18n.getText('displayAs',[l]);D.setTooltip(m);D.attachPress(function(E){A.openBy(this);});if(c.getHeaderText()){var H=new sap.m.List({});H.setShowNoData(false);H.setShowSeparators(sap.m.ListSeparators.None);var F=false;var n=c.getModel().getProperty("/uiFilter/defaultConditionGroup");if(n&&n.conditions&&n.conditions.length>0){F=true;}else{F=false;}var R=new sap.m.Button({icon:"sap-icon://clear-filter",tooltip:sap.ushell.resources.i18n.getText("resetFilterButton_tooltip"),type:'Transparent',enabled:F,press:function(E){c.getModel().resetFilterConditions(true);}});R.addStyleClass("sapUshellSearchFilterByResetButton");var L=new sap.m.Title({text:c.getHeaderText()});L.addStyleClass("sapUshellSearchFilterByResetButtonLabel");var S=new sap.m.ToolbarSpacer();var o=new sap.m.Toolbar({content:[L,S,R]});H.setHeaderToolbar(o);r.renderControl(H);}var p=new sap.m.CustomListItem({content:g[h]});p.setModel(c.getModel(),'facets');var G;if(b==="text"){G=new sap.ushell.renderers.fiori2.search.controls.SearchGroupHeaderListItem({title:t,button:D});}else{G=new sap.ushell.renderers.fiori2.search.controls.SearchGroupHeaderListItem({title:t});}G.data("facet-dimension",d,true);G.addStyleClass("sapUshellSearchFacetTabBarHeader");var q=new sap.m.Link({text:sap.ushell.resources.i18n.getText("showMore"),press:a(h,j)});q.setModel(c.getModel("i18n"));q.addStyleClass('sapUshellSearchFacetShowMoreLink');var I=new sap.m.Label({text:""});I.addStyleClass('sapUshellSearchFacetInfoZeile');var u=new sap.m.VBox({items:[I,q]});var v=new sap.m.CustomListItem({content:u,visible:{parts:[{path:'/uiFilter/dataSource'}],formatter:function(x){return x.getType().toLowerCase()!=="category";}}});v.addStyleClass('sapUshellSearchFacetShowMoreItem');var w=new sap.m.List({showSeparators:sap.m.ListSeparators.None,items:[G,p,v]});w.data("sap-ui-fastnavgroup","false",true);w.setModel(c.getModel());r.renderControl(w);c.getItems()[h].addContent(g[h]);r.write("</div>");},onAfterRendering:function(){}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchFilterBar')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchFilterBar');(function(){"use strict";jQuery.sap.require('sap.m.Toolbar');sap.m.Toolbar.extend("sap.ushell.renderers.fiori2.search.controls.SearchFilterBar",{constructor:function(o){var t=this;o=jQuery.extend({},{design:sap.m.ToolbarDesign.Info},o);sap.m.Toolbar.prototype.constructor.apply(t,[o]);t.addStyleClass('sapUshellSearchFilterContextualBar');t.filterFormatter=t.filterFormatter.bind(t);t.filterText=new sap.m.Text({text:{parts:[{path:"/uiFilter/defaultConditionGroup/conditions"},{path:"/facets"}],formatter:t.filterFormatter},tooltip:{parts:[{path:"/uiFilter/defaultConditionGroup/conditions"},{path:"/facets"}],formatter:t.filterFormatter}}).addStyleClass("sapUshellSearchFilterText");t.filterText.setMaxLines(1);t.filterText.clampText();t.addContent(t.filterText);t.addContent(new sap.m.ToolbarSpacer());t.resetButton=new sap.ui.core.Icon({src:"sap-icon://clear-filter",tooltip:sap.ushell.resources.i18n.getText("resetFilterButton_tooltip")}).addStyleClass("sapUshellSearchFilterResetButton");t.addContent(t.resetButton);},filterFormatter:function(c,f){var g=function(a){return a.label;};if(c.length===0){return"";}c=this.sortConditions(c,f);var l=[];for(var i=0;i<c.length;i++){var s=jQuery.map(c[i].conditions,g);l=l.concat(s);}return sap.ushell.resources.i18n.getText("filtered_by",l.join(', '));},sortConditions:function(c,f){var i;var g=function(e,v,l){for(var i=0;i<l.length;++i){if(l[i][e]===v){return i;}}return-1;};var a=function(t,f){for(var i=0;i<f.length;++i){if(f[i].title===t){return f[i];}}return null;};var n=[];for(i=0;i<c.length;++i){n.push(c[i].clone());}c=n;c.sort(function(e,h){return g('title',e.label,f)-g('title',h.label,f);});for(i=0;i<c.length;++i){var b=c[i];var d=a(b.label,f);if(!d){continue;}b.conditions.sort(function(e,h){return g('label',e.label,d.items)-g('label',h.label,d.items);});}return c;},renderer:'sap.m.ToolbarRenderer',onAfterRendering:function(){var t=this;t.resetButton.attachPress(function(){t.getModel().resetFilterConditions(true);});var $=jQuery('.sapUshellSearchFilterText');$.attr('aria-label',sap.ushell.resources.i18n.getText("filtered_by_aria_label"));}});}());};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchInput')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchInput');(function(){"use strict";jQuery.sap.require('sap.m.Input');var s=sap.ushell.renderers.fiori2.search.SearchHelper;var c=sap.ushell.renderers.fiori2.search.SearchConfiguration.getInstance();c.getSina();var a=window.sinabase;sap.m.Input.extend('sap.ushell.renderers.fiori2.search.controls.SearchInput',{constructor:function(i,o){var t=this;o=jQuery.extend({},{width:'100%',showValueStateMessage:false,showTableSuggestionValueHelp:false,showSuggestion:true,filterSuggests:false,suggestionColumns:[new sap.m.Column({})],placeholder:{path:'/searchTermPlaceholder',mode:sap.ui.model.BindingMode.OneWay},liveChange:this.handleLiveChange.bind(this),suggestionItemSelected:this.handleSuggestionItemSelected.bind(this)},o);var p=sap.ui.Device.system.phone;sap.ui.Device.system.phone=false;sap.m.Input.prototype.constructor.apply(this,[i,o]);sap.ui.Device.system.phone=p;this.bindAggregation("suggestionRows","/suggestions",function(i,C){return t.suggestionItemFactory(i,C);});this.addStyleClass('searchInput');this._bUseDialog=false;this._bFullScreen=false;this._ariaDescriptionIdNoResults=i+"-No-Results-Description";},renderer:'sap.m.InputRenderer',onsapenter:function(e){if(!(this._oSuggestionPopup&&this._oSuggestionPopup.isOpen()&&this._iPopupListSelectedIndex>=0)){this.getModel().invalidateQuery();this.triggerSearch(e);}sap.m.Input.prototype.onsapenter.apply(this,arguments);},triggerSearch:function(e){var t=this;s.subscribeOnlyOnce('triggerSearch','allSearchFinished',function(){t.getModel().autoStartApp();},t);var b=t.getValue();if(b.trim()===''){b='*';}t.getModel().setSearchBoxTerm(b,false);t.navigateToSearchApp();t.destroySuggestionRows();t.getModel().abortSuggestions();},handleLiveChange:function(e){var b=this.getValue();var m=this.getModel();m.setSearchBoxTerm(b,false);if(m.getSearchBoxTerm().length>0){m.doSuggestion();}else{this.destroySuggestionRows();m.abortSuggestions();}},handleSuggestionItemSelected:function(e){var m=this.getModel();var b=m.getSearchBoxTerm();var d=e.getParameter('selectedRow').getBindingContext().getObject();var f=d.labelRaw;var g=d.dataSource;var t=d.url;var h=d.type;switch(h){case a.SuggestionType.APPS:m.analytics.logCustomEvent('FLP: Search','Suggestion Select App',[d.title,t,b]);m.analytics.logCustomEvent('FLP: Application Launch point','Search Suggestions',[d.title,t,b]);if(t[0]==='#'){if(window.hasher){window.hasher.setHash(t);}else{window.location.href=t;}}else{window.open(t,'_blank');m.setSearchBoxTerm('',false);this.setValue('');this.focus();}break;case a.SuggestionType.DATASOURCE:m.analytics.logCustomEvent('FLP: Search','Suggestion Select Datasource',[g.key,b]);m.setDataSource(g,false);m.setSearchBoxTerm('',false);this.setValue('');this.focus();break;case a.SuggestionType.OBJECTDATA:m.analytics.logCustomEvent('FLP: Search','Suggestion Select Object Data',[f,g.key,b]);m.setDataSource(g,false);m.setSearchBoxTerm(f,false);this.navigateToSearchApp();this.setValue(f);break;case a.SuggestionType.HISTORY:m.analytics.logCustomEvent('FLP: Search','Suggestion Select History',[f,g.key,b]);m.setDataSource(g,false);m.setSearchBoxTerm(f,false);this.navigateToSearchApp();this.setValue(f);break;default:break;}},suggestionItemFactory:function(i,C){var t=this;var b=new sap.m.Label({text:{path:"icon",formatter:function(v){if(v){return"<i>"+sap.ushell.resources.i18n.getText("label_app")+"</i>";}return"";}}}).addStyleClass('suggestText').addStyleClass('suggestNavItem').addStyleClass('suggestListItemCell');b.addEventDelegate({onAfterRendering:function(){s.boldTagUnescaper(this.getDomRef());}},b);var d=new sap.ui.core.Icon({src:"{icon}"}).addStyleClass('suggestIcon').addStyleClass('sapUshellSearchSuggestAppIcon').addStyleClass('suggestListItemCell');var l=new sap.m.Label({text:"{label}"}).addStyleClass('suggestText').addStyleClass('suggestNavItem').addStyleClass('suggestListItemCell');l.addEventDelegate({onAfterRendering:function(){s.boldTagUnescaper(this.getDomRef());}},l);var f=new sap.m.CustomListItem({type:sap.m.ListType.Active,content:[b,d,l]});var g=C.oModel.getProperty(C.sPath);f.getText=function(){return(typeof g.labelRaw)==='string'?g.labelRaw:t.getValue();};var h=new sap.m.ColumnListItem({cells:[f],type:"Active"});if(g.title&&g.title.indexOf("combinedAppSuggestion")!==-1){h.addStyleClass('searchBOSuggestion');}else if(g.type===a.SuggestionType.APPS){h.addStyleClass('searchAppSuggestion');}if(g.type===a.SuggestionType.DATASOURCE){h.addStyleClass('searchDataSourceSuggestion');}if(g.type===a.SuggestionType.OBJECTDATA){h.addStyleClass('searchBOSuggestion');}if(g.type===a.SuggestionType.HISTORY){h.addStyleClass('searchHistorySuggestion');}h.addStyleClass('searchSuggestion');h.addEventDelegate({onAfterRendering:function(e){var j=h.$().find('.suggestListItemCell');var k=0;j.each(function(m){k+=$(this).outerWidth(true);});if(k>h.$().find('li').get(0).scrollWidth){h.setTooltip($(j[0]).text()+" "+$(j[2]).text());}}});return h;},navigateToSearchApp:function(){if(s.isSearchAppActive()){this.getModel()._firePerspectiveQuery();}else{var h=this.getModel().createSearchURL();window.location.hash=h;}},getAriaDescriptionIdForNoResults:function(){return this._ariaDescriptionIdNoResults;},onAfterRendering:function(e){var b=$(this.getDomRef()).find("#searchFieldInShell-input-inner");$(this.getDomRef()).find('input').attr('autocomplete','off');$(this.getDomRef()).find('input').attr('autocorrect','off');$(this.getDomRef()).find('input').attr('type','search');$(this.getDomRef()).find('input').attr('name','search');var d=jQuery('<form action="" onsubmit="return false;"></form>');$(this.getDomRef()).children('input').parent().append(d);$(this.getDomRef()).children('input').detach().appendTo(d);b.attr("aria-describedby",b.attr("aria-describedby")+" "+this._ariaDescriptionIdNoResults);},onValueRevertedByEscape:function(v){if(s.isSearchAppActive()){return;}this.setValue(" ");}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchLabel')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchLabel');(function(){"use strict";var s=sap.ushell.renderers.fiori2.search.SearchHelper;sap.m.Label.extend('sap.ushell.renderers.fiori2.search.controls.SearchLabel',{renderer:'sap.m.LabelRenderer',onAfterRendering:function(){var d=this.getDomRef();s.boldTagUnescaperByText(d);s.forwardEllipsis4Whyfound(d);}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchLink')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchLink');(function(){"use strict";var s=sap.ushell.renderers.fiori2.search.SearchHelper;sap.m.Link.extend('sap.ushell.renderers.fiori2.search.controls.SearchLink',{renderer:'sap.m.LinkRenderer',onAfterRendering:function(){var d=this.getDomRef();s.boldTagUnescaperByText(d);}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchResultList')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchResultList');(function(){"use strict";var s=sap.ushell.renderers.fiori2.search.SearchHelper;sap.m.List.extend('sap.ushell.renderers.fiori2.search.controls.SearchResultList',{init:function(){this.addStyleClass("searchResultList");},renderer:'sap.m.ListRenderer',onAfterRendering:function(){var t=this;sap.m.List.prototype.onAfterRendering.apply(t,arguments);var m=sap.ushell.renderers.fiori2.search.getModelSingleton();var a=m.getProperty("/multiSelectionEnabled");if(a){t.enableSelectionMode(false);}t._prepareResizeHandler();t.collectListItemsForNavigation();},collectListItemsForNavigation:function(){var t=this;var m=t.getItems();if(m.length===0){return;}var d=function(){t._doCollectListItemsForNavigation();};for(var i=0;i<m.length;i++){var M=m[i];if(M.hasStyleClass("sapUshellSearchResultListItemApps")){var c=M.getContent();if(c.length>0){c[0].addEventDelegate({onAfterRendering:d});}}}t._doCollectListItemsForNavigation();},_doCollectListItemsForNavigation:function(){var t=this;var i,j;var f=t.getDomRef();if(!f){return;}var I=t.getItemNavigation();if(!I){t._startItemNavigation();I=t.getItemNavigation();}if(!I){return;}t._bItemNavigationInvalidated=false;var r=f.getElementsByTagName("li");var d=[];var T=[];for(i=0;i<r.length;i++){var R=r[i];if($(R).hasClass("sapUshellSearchResultListItemApps")){var a=R.getElementsByClassName("sapUshellSearchTileWrapper");for(j=0;j<a.length;j++){var b=s.getFocusableTileDomRef(a[j]);if(!b||$(b).is(":hidden")){continue;}d.push(b);T.push(b);}$(R).removeAttr("tabindex");$(R).removeAttr("role");$(R).attr("aria-hidden","true");}else if($(R).hasClass("sapUshellSearchResultListFooter")){var S=R.getElementsByClassName("sapUshellResultListMoreFooter");for(i=0;i<S.length;i++){d.push(S[i]);T.push(S[i]);}}else if($(R).hasClass("sapUshellSearchResultListItem")){d.push(R);T.push(R);}}if(d.length>0){var c=$(d[0]).closest("ul");var e=c.length>0?c[0]:d[0].parentElement;I.setRootDomRef(e);}I.setItemDomRefs(d);I.setCycling(false);I.setPageSize(10);if(T.length>0){var g=$(T[0]).attr("id");for(i=1;i<T.length;i++){g+=" "+$(T[i]).attr("id");}$(t.getDomRef()).children("[role='listbox']").attr("aria-owns",g);}},_prepareResizeHandler:function(){var t=this;var r=[768,1151];var w=function(){var b=window.innerWidth;if(b<r[0]){return 0;}for(var i=0;i<r.length-1;i++){if(b>=r[i]&&b<r[i+1]){return i+1;}}return r.length;};var l=w();var a=function(e){var c=w();if(c!=l){l=c;var m=t.getItems();for(var i=0;i<m.length;i++){var M=m[i];if(M.getContent()&&M.getContent().length>0&&M.getContent()[0].showOrHideExpandButton){M.getContent()[0].showOrHideExpandButton();}}}};$(window).on("resize",a);},enableSelectionMode:function(a){var t=this;var d=jQuery.Deferred();a=a===undefined?true:a;var b=$(t.getDomRef());if(!a){b.addClass("sapUshellSearchResultList-ShowMultiSelection");d.resolve();return d.promise();}var c=200;var e=b.find(".sapUshellSearchResultListItem-CheckboxExpandContainer");var f=b.find(".sapUshellSearchResultListItem-Attributes");var g=parseFloat(f.css("padding-left"));var h=e.find(".sapUshellSearchResultListItem-CheckboxContainer");var i=h.width();if(!b.hasClass("sapUshellSearchResultList-ShowMultiSelection")){e.css("width","0");e.css("opacity","0");f.css("padding-left",g);b.addClass("sapUshellSearchResultList-ShowMultiSelection");var n=g+i;var j=e.animate({"width":i,"opacity":1},c,function(){$(this).css("width","");$(this).css("opacity","");});var k=f.animate({"padding-left":n},c,function(){$(this).css("padding-left","");});jQuery.when(j,k).done(function(){d.resolve();});}else{d.resolve();}return d.promise();},disableSelectionMode:function(a){var t=this;var d=jQuery.Deferred();a=a===undefined?true:a;var b=$(t.getDomRef());if(!a){b.removeClass("sapUshellSearchResultList-ShowMultiSelection");d.resolve();return d.promise();}var c=200;var e=b.find(".sapUshellSearchResultListItem-CheckboxExpandContainer");var f=b.find(".sapUshellSearchResultListItem-Attributes");var g=parseFloat(f.css("padding-left"));var h=e.find(".sapUshellSearchResultListItem-CheckboxContainer");var i=h.width();if(b.hasClass("sapUshellSearchResultList-ShowMultiSelection")){var n=g-i;var j=e.animate({"width":0,"opacity":0},c).promise();var k=f.animate({"padding-left":n},c).promise();jQuery.when(j,k).done(function(){b.removeClass("sapUshellSearchResultList-ShowMultiSelection");e.css("width","");e.css("opacity","");f.css("padding-left","");d.resolve();});}else{d.resolve();}return d.promise();}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchResultListSelectionHandler')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchResultListSelectionHandler');(function(){"use strict";jQuery.sap.require('sap.ui.base.Object');sap.ui.base.Object.extend("sap.ushell.renderers.fiori2.search.controls.SearchResultListSelectionHandler",{isMultiSelectionAvailable:function(d){return false;},actionsForDataSource:function(d){return[];}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchSelect')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchSelect');(function(){"use strict";jQuery.sap.require('sap.m.Select');sap.m.Select.extend('sap.ushell.renderers.fiori2.search.controls.SearchSelect',{constructor:function(i,o){o=jQuery.extend({},{visible:"{/businessObjSearchEnabled}",autoAdjustWidth:true,items:{path:"/dataSources",template:new sap.ui.core.Item({key:"{key}",text:"{labelPlural}"})},selectedKey:{path:'/uiFilter/dataSource/key',mode:sap.ui.model.BindingMode.OneWay},change:function(e){var a=this.getSelectedItem();var c=a.getBindingContext();var d=c.getObject();this.getModel().setDataSource(d,false);this.getModel().abortSuggestions();}},o);sap.m.Select.prototype.constructor.apply(this,[i,o]);this.addStyleClass('searchSelect');},renderer:'sap.m.SelectRenderer',setDisplayMode:function(m){switch(m){case'icon':this.setType(sap.m.SelectType.IconOnly);this.setIcon('sap-icon://slim-arrow-down');break;case'default':this.setType(sap.m.SelectType.Default);break;default:break;}}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchText')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchText');(function(){"use strict";var s=sap.ushell.renderers.fiori2.search.SearchHelper;sap.m.Text.extend('sap.ushell.renderers.fiori2.search.controls.SearchText',{renderer:'sap.m.TextRenderer',onAfterRendering:function(){var d=this.getDomRef();s.boldTagUnescaperByText(d);}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchTileHighlighter')){(function(){"use strict";jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchTileHighlighter');var T=sap.ushell.renderers.fiori2.search.SearchHelper.Tester;var H=sap.ushell.renderers.fiori2.search.SearchHelper;var a=sap.ushell.renderers.fiori2.search.controls.SearchTileHighlighter=function(){this.init.apply(this,arguments);};a.prototype={init:function(){},setHighlightTerms:function(h){this.tester=new T(h,'sapUshellSearchHighlight');},highlight:function(t){var n=t.getDomRef();if(!n){return;}this.doHighlight(n);},doHighlight:function(n){if(n.nodeType===window.Node.TEXT_NODE){this.highlightTextNode(n);return;}for(var i=0;i<n.childNodes.length;++i){var c=n.childNodes[i];this.doHighlight(c);}},highlightTextNode:function(n){var t=this.tester.test(n.textContent);if(!t.bMatch){return;}var s=document.createElement('span');s.innerHTML=jQuery.sap.encodeHTML(t.sHighlightedText);H.boldTagUnescaper(s,'sapUshellSearchHighlight');n.parentNode.insertBefore(s,n);n.parentNode.removeChild(n);}};})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchTilesContainerKeyHandler')){(function(){"use strict";jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchTilesContainerKeyHandler');var s=sap.ushell.renderers.fiori2.search.SearchHelper;var d={getAncestorByClass:function(e,c){while(e){if(e.classList.contains(c)){return e;}e=e.parentElement;}return false;}};var T=function(){this.init.apply(this,arguments);};T.prototype={init:function(t,e){this.tilesContainer=t;this.tilesContainerElement=t.getDomRef();this.element=e;},getIndexInTilesContainer:function(){return Array.prototype.indexOf.call(this.tilesContainerElement.children,this.element);},next:function(){if((this.getIndexInTilesContainer()+1)%this.tilesContainer.getTilesPerRow()===0){return null;}if(this.element.nextElementSibling){return new T(this.tilesContainer,this.element.nextElementSibling);}return null;},previous:function(){if((this.getIndexInTilesContainer())%this.tilesContainer.getTilesPerRow()===0){return null;}if(this.element.previousElementSibling){return new T(this.tilesContainer,this.element.previousElementSibling);}return null;},upper:function(){var i=this.getIndexInTilesContainer()-this.tilesContainer.getTilesPerRow();if(i<0){return null;}return new T(this.tilesContainer,this.tilesContainerElement.children.item(i));},lower:function(){var i=this.getIndexInTilesContainer()+this.tilesContainer.getTilesPerRow();if(i>=this.tilesContainerElement.children.length){return null;}return new T(this.tilesContainer,this.tilesContainerElement.children.item(i));},focus:function(){var e=s.getFocusableTileDomRef(this.element);if(e){e.focus();}}};var K=sap.ushell.renderers.fiori2.search.controls.SearchTilesContainerKeyHandler=function(){this.init.apply(this,arguments);};K.prototype={init:function(t){this.tilesContainer=t;},getFocusedObject:function(e){var t=d.getAncestorByClass(e,'sapUshellSearchTileWrapper');if(!t){return null;}return new T(this.tilesContainer,t);},onsapdown:function(e){this.navigate('lower',e);},onsapup:function(e){this.navigate('upper',e);},onsapleft:function(e){this.navigate('previous',e);},onsapright:function(e){this.navigate('next',e);},navigate:function(m,e){e.stopPropagation();e.preventDefault();var o=this.getFocusedObject(e.target);if(!o){return;}var n=o[m].apply(o,[]);if(!n){return;}n.focus();}};})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.personalization.Personalizer')){(function(){"use strict";jQuery.sap.declare('sap.ushell.renderers.fiori2.search.personalization.Personalizer');var P=sap.ushell.renderers.fiori2.search.personalization.Personalizer=function(){this.init.apply(this,arguments);};P.prototype={init:function(k,p){this.key=k;this.personalizationStorageInstance=p;},getKey:function(){return this.key;},setPersData:function(d){return(new jQuery.Deferred()).resolve(this.personalizationStorageInstance.setItem(this.key,d));},getPersData:function(){return(new jQuery.Deferred()).resolve(this.personalizationStorageInstance.getItem(this.key));}};})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.suggestions.SuggestionProvider')){(function(){"use strict";jQuery.sap.declare('sap.ushell.renderers.fiori2.search.suggestions.SuggestionProvider');var m=sap.ushell.renderers.fiori2.search.suggestions.SuggestionProvider=function(){this.init.apply(this,arguments);};m.prototype={init:function(p){jQuery.extend(this,p);},abortSuggestions:function(){},getSuggestions:function(){}};})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.suggestions.SuggestionTypeProps')){(function(){"use strict";var S=sap.ushell.renderers.fiori2.search.SearchConfiguration;var c=S.getInstance();c.getSina();jQuery.sap.declare('sap.ushell.renderers.fiori2.search.suggestions.SuggestionTypeProps');var s=window.sinabase;s.SuggestionType.APPS='apps';var m=sap.ushell.renderers.fiori2.search.suggestions.SuggestionTypeProps={};m[s.SuggestionType.DATASOURCE]={position:10,limit:2};m[s.SuggestionType.APPS]={position:20,limitDsAll:3,limitDsApps:jQuery.device.is.phone?7:7};m[s.SuggestionType.HISTORY]={position:30,limit:3};m[s.SuggestionType.OBJECTDATA]={position:40,limit:jQuery.device.is.phone?7:7,limitDataSource:2};})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.suggestions.TimeMerger')){(function(){"use strict";jQuery.sap.declare('sap.ushell.renderers.fiori2.search.suggestions.TimeMerger');var T=sap.ushell.renderers.fiori2.search.suggestions.TimeMerger=function(){this.init.apply(this,arguments);};var c=0;T.prototype={init:function(p,t){this.promiseList=p||[];this.timeDelay=t||1000;this.pending=this.promiseList.length;this.returned=[];this.aborted=false;this.counter=++c;},abort:function(){this.aborted=true;},process:function(p){this.processorCallback=p;this.start();return this;},start:function(){for(var i=0;i<this.promiseList.length;++i){var p=this.promiseList[i];p.done(this.assembleDoneCallback(i));}this.scheduleProcessorNotification();},scheduleProcessorNotification:function(){var t=this;if(t.processorNotificationSchedule){window.clearTimeout(t.processorNotificationSchedule);t.processorNotificationSchedule=null;}t.processorNotificationSchedule=window.setTimeout(function(){t.notifyProcessor();},this.timeDelay);},notifyProcessor:function(){if(this.aborted){return;}if(this.returned.length>0){this.processorCallback(this.returned);this.returned=[];}if(this.pending>0){this.scheduleProcessorNotification();}},assembleDoneCallback:function(i){var t=this;return function(r){t.pending--;t.returned.push(r);if(t.pending===0){if(t.processorNotificationSchedule){window.clearTimeout(t.processorNotificationSchedule);t.processorNotificationSchedule=null;}t.notifyProcessor();}};}};})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.userpref.SearchPrefsDialog.view')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.userpref.SearchPrefsDialog.view');(function(){"use strict";jQuery.sap.require('sap.m.MessageBox');sap.ui.jsview("sap.ushell.renderers.fiori2.search.userpref.SearchPrefsDialog",{createContent:function(c){var t=this;var u=new sap.m.Label({text:sap.ushell.resources.i18n.getText("sp.userProfilingField")+':'});var s=new sap.m.Switch({state:{path:"/sessionUserActive",mode:sap.ui.model.BindingMode.TwoWay},enabled:{parts:[{path:'/searchPrefsActive'},{path:'/personalizationPolicy'}],formatter:function(b,p){var m=t.getModel();if(b&&p!==m.personalizationPolicyEnforced&&p!==m.personalizationPolicyDisabled){return true;}else{return false;}},mode:sap.ui.model.BindingMode.OneWay},ariaLabelledBy:u});this.resetButton=new sap.m.Button({text:sap.ushell.resources.i18n.getText("sp.clearCollectedData"),press:this.resetHistory.bind(this),visible:{parts:[{path:'/searchPrefsActive'},{path:'/personalizationPolicy'}],formatter:function(b,p){var m=t.getModel();if(!b){return false;}if(p===m.personalizationPolicyOptIn||p===m.personalizationPolicyOptOut){return true;}return false;},mode:sap.ui.model.BindingMode.OneWay}});var l=new sap.ui.layout.VerticalLayout({content:[new sap.m.Text({text:'{/explanationText}',visible:{parts:[{path:'/searchPrefsActive'},{path:'/personalizationPolicy'}],formatter:function(b,p){var m=t.getModel();if(!b){return false;}if(p===m.personalizationPolicyEnforced||p===m.personalizationPolicyDisabled){return true;}return false;}}}),new sap.m.Text({text:sap.ushell.resources.i18n.getText('sp.disclaimer')})]});var a=[u,s,l,this.resetButton];return a;},resetHistory:function(){var t=this;this.getModel().resetProfile().then(function(){t.resetButton.setEnabled(false);},function(r){var e=sap.ushell.resources.i18n.getText('sp.resetFailed');if(r.statusText&&r.statusText.length>0&&r.statusText!=='OK'){e+='\n'+r.statusText+'\n'+t.formatErrorResponse(r.responseText);}sap.m.MessageBox.show(e,{title:sap.ushell.resources.i18n.getText("sp.resetFailedTitle"),icon:sap.m.MessageBox.Icon.ERROR,actions:[sap.m.MessageBox.Action.OK]});});},formatErrorResponse:function(r){var p;try{p=JSON.parse(r);}catch(e){return r;}if(!p.ErrorDetails){return r;}var a=[];for(var i=0;i<p.ErrorDetails.length;++i){var b=p.ErrorDetails[i];a.push(b.Message+' ('+b.Code+')');}return a.join('\n');},switchChangeHandler:function(e){var s=e.getSource();if(s.getState()){return;}var i=sap.ushell.resources.i18n;var d=i.getText("sp.disable");sap.m.MessageBox.confirm(i.getText('sp.disablingUserProfilingMsg'),{title:sap.ushell.resources.i18n.getText("sp.disableUserProfiling"),icon:sap.m.MessageBox.Icon.QUESTION,actions:[d,sap.m.MessageBox.Action.CANCEL],onClose:function(a){if(a==sap.m.MessageBox.Action.CANCEL){s.setState(true);}}});},openMessageBox:function(){var t=this;var i=sap.ushell.resources.i18n;var c=i.getText("sp.clear");sap.m.MessageBox.confirm(i.getText('sp.profileWillBeReset'),{title:sap.ushell.resources.i18n.getText("sp.clearCollectedData"),icon:sap.m.MessageBox.Icon.QUESTION,actions:[c,sap.m.MessageBox.Action.CANCEL],onClose:function(a){if(a==c){t.getModel().resetProfile();}}});}});}());};if(!jQuery.sap.isDeclared('sap.ushell.resources')){(function(){"use strict";jQuery.sap.declare("sap.ushell.resources");jQuery.sap.require('sap.ui.model.resource.ResourceModel');sap.ushell.resources={};sap.ushell.resources.getTranslationModel=function(l){var t=new sap.ui.model.resource.ResourceModel({bundleUrl:jQuery.sap.getModulePath("sap.ushell.renderers.fiori2.resources.resources",".properties"),bundleLocale:l});return t;};sap.ushell.resources.i18nModel=sap.ushell.resources.getTranslationModel(sap.ui.getCore().getConfiguration().getLanguage());sap.ushell.resources.i18n=sap.ushell.resources.i18nModel.getResourceBundle();}());};if(!jQuery.sap.isDeclared('sap.ushell.services.AppLifeCycle')){(function(){"use strict";var S="appLoaded";jQuery.sap.declare("sap.ushell.services.AppLifeCycle");jQuery.sap.require('sap.ui.base.EventProvider');sap.ushell.services.AppLifeCycle=function(a,c,p,C){var o,e,v;this.getCurrentApplication=function(){return o;};this.attachAppLoaded=function(d,f,l){e.attachEvent(S,d,f,l);};this.detachAppLoaded=function(f,l){e.detachEvent(S,f,l);};e=new sap.ui.base.EventProvider();v=sap.ui.getCore().byId("viewPortContainer");if(!v||typeof v.attachAfterNavigate!=="function"){jQuery.sap.log.error("Error during instantiation of AppLifeCycle service","Could not attach to afterNavigate event","sap.ushell.services.AppLifeCycle");return;}v.attachAfterNavigate(function(E){var A,s,b,h=false;if(E.mParameters.toId.indexOf("applicationShellPage")===0){A=E.mParameters.to.getApp();}else if(E.mParameters.toId.indexOf("application")===0){A=E.mParameters.to;}if(A&&typeof A.getComponentHandle==="function"&&A.getComponentHandle()){b=A.getComponentHandle().getInstance();}if(b&&b.getId()==="application-Shell-home-component"){h=true;}s=A&&typeof A.getApplicationType==="function"&&A.getApplicationType();if((!s||s==="URL")&&b){s="UI5";}o={applicationType:s,componentInstance:b,homePage:h};setTimeout(function(){e.fireEvent(S,o);},0);});};sap.ushell.services.AppLifeCycle.hasNoAdapter=true;}());};if(!jQuery.sap.isDeclared('sap.ushell.services.Bookmark')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.Bookmark");sap.ushell.services.Bookmark=function(){var l=sap.ushell.Container.getService("LaunchPage");this._isMatchingRemoteCatalog=function(c,r){var C=l.getCatalogData(c);return C.remoteId===r.remoteId&&C.baseUrl.replace(/\/$/,"")===r.baseUrl.replace(/\/$/,"");};this.addBookmark=function(p,g){var P=l.addBookmark(p,g);P.done(function(t){var d={tile:t,group:g};sap.ui.getCore().getEventBus().publish("sap.ushell.services.Bookmark","bookmarkTileAdded",d);});return P;};this._doAddCatalogTileToGroup=function(d,c,C,g){var e,f=d.reject.bind(d);function a(G){l.getCatalogTiles(C).fail(f).done(function(b){var g=l.getGroupId(G),t=b.some(function(o){if(l.getCatalogTileId(o)===c){l.addTile(o,G).fail(f).done(function(){d.resolve();sap.ui.getCore().getEventBus().publish("sap.ushell.services.Bookmark","catalogTileAdded",g);});return true;}});if(!t){e="No tile '"+c+"' in catalog '"+l.getCatalogId(C)+"'";jQuery.sap.log.error(e,null,"sap.ushell.services.Bookmark");f(e);}});}if(g){l.getGroups().fail(f).done(function(G){var b=G.some(function(o){if(l.getGroupId(o)===g){a(o);return true;}});if(!b){e="Group '"+g+"' is unknown";jQuery.sap.log.error(e,null,"sap.ushell.services.Bookmark");f(e);}});}else{l.getDefaultGroup().fail(f).done(a);}return d.promise();};this.addCatalogTileToGroup=function(c,g,C){var d=new jQuery.Deferred(),e,f=d.reject.bind(d),m,L="X-SAP-UI2-HANA:hana?remoteId=HANA_CATALOG",t=this;function i(o){return l.getCatalogId(o)===L;}m=C?this._isMatchingRemoteCatalog:i;C=C||{id:L};l.onCatalogTileAdded(c);l.getCatalogs().fail(f).done(function(a){var s;a.forEach(function(o){if(m(o,C)){if(!s){s=o;}else{jQuery.sap.log.warning("More than one matching catalog: "+JSON.stringify(C),null,"sap.ushell.services.Bookmark");}}});if(s){t._doAddCatalogTileToGroup(d,c,s,g);}else{e="No matching catalog found: "+JSON.stringify(C);jQuery.sap.log.error(e,null,"sap.ushell.services.Bookmark");d.reject(e);}});return d.promise();};this.countBookmarks=function(u){return l.countBookmarks(u);};this.deleteBookmarks=function(u){var p=l.deleteBookmarks(u);p.done(function(){sap.ui.getCore().getEventBus().publish("sap.ushell.services.Bookmark","bookmarkTileDeleted",u);});return p;};this.updateBookmarks=function(u,p){return l.updateBookmarks(u,p);};};sap.ushell.services.Bookmark.hasNoAdapter=true;}());};if(!jQuery.sap.isDeclared('sap.ushell.services.ClientSideTargetResolution')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.ClientSideTargetResolution");jQuery.sap.require('sap.ui.generic.app.navigation.service.SelectionVariant');sap.ushell.services.ClientSideTargetResolution=function(A,c,p,S){var h,H,u;var t=[undefined,"GUI","WDA","UI5"];this._ensureInbounds=function(s){var G=A.getInbounds;if(s){var d=new jQuery.Deferred();A.getInbounds(s).done(function(I){d.resolve(I);}).fail(d.reject.bind(d));return d.promise();}if(!h){if(typeof G!=="function"){jQuery.sap.log.error("Cannot get Inbounds","ClientSideTargetResolutionAdapter should implement getInbounds method","sap.ushell.services.ClientSideTargetResolution");return new jQuery.Deferred().reject().promise();}h=new jQuery.Deferred();G.call(A).done(function(I){h.resolve(I);}).fail(h.reject.bind(h));}return h.promise();};this._getURLParsing=function(){if(!u){u=sap.ushell.Container.getService("URLParsing");}return u;};this._addDefaultParameterValues=function(I,s,k,m,d){var o={},D={};Object.keys(I).forEach(function(P){if(P!=="sap-ushell-defaultedParameterNames"){o[P]=I[P];}});if(!s){return o;}Object.keys(s).forEach(function(P){var T=s[P],a,v=false;if(!o[P]&&T.hasOwnProperty("defaultValue")){if(T.defaultValue.format&&T.defaultValue.format==="reference"){a=T.defaultValue.value;if(k.hasOwnProperty(a)){if(typeof k[a]==="string"){o[P]=[k[a]];v=true;}else if(typeof k[a]==="object"){o[P]=k[a];v=true;}}else{o[P]=[T.defaultValue];m.push(T.defaultValue.value);}}else{o[P]=[T.defaultValue.value];v=true;}if(v){D[P]=true;}}});Object.keys(D).sort().forEach(function(P){d.push(P);});return o;};this._matchesFilter=function(v,f,k,m){var F;if(!f){return true;}if(!v&&v!==""){return false;}F=f.value;if(f.format==="reference"){if(/UserDefault\.extended\./.test(F)){jQuery.sap.log.error("Illegal inbound: extended user default '"+F+"' used as filter");return false;}if(k.hasOwnProperty(F)){return v===k[F];}m[F]=true;return true;}if(f.format==="value"||f.format==="plain"||f.format===undefined){return v===f.value;}else if(f.format==="regexp"){return!!v.match("^"+f.value+"$");}else{jQuery.sap.log.error("Illegal oFilter format");return false;}};function g(m){return m.inbound&&m.inbound.resolutionResult&&m.inbound.resolutionResult["sap.ui"]&&m.inbound.resolutionResult["sap.ui"].technology;}this._calculateTechnologyMatch=function(m){var T=m.intentParamsPlusAllDefaults["sap-ui-tech-hint"]&&m.intentParamsPlusAllDefaults["sap-ui-tech-hint"][0];var I=m.defaultedParamNames&&(m.defaultedParamNames.indexOf("sap-ui-tech-hint")>=0);if(T&&g(m)===T){return I?1:2;}return 0;};this._getTechnologyPriority=function(m){var T=g(m);var P=t.indexOf(T);return Math.max(0,P);};this._addSortString=function(m){function a(n){var s="000"+n;return s.substr(s.length-3);}m.priorityString=[m.genericSO?"g":"x","TECM="+this._calculateTechnologyMatch(m),"MTCH="+a(m.countMatchingParams),"MREQ="+a(m.countMatchingRequiredParams),"NFIL="+a(m.countMatchingFilterParams),"NDEF="+a(m.countDefaultedParams),"POT="+a(m.countPotentiallyMatchingParams),"RFRE="+a(999-m.countFreeInboundParams),"TECP="+this._getTechnologyPriority(m)].join(" ");};this._checkAdditionalParameters=function(I,o){var a=false;if(I.signature.additionalParameters==="allowed"||I.signature.additionalParameters==="ignored"){return true;}if(I.signature.additionalParameters==="notallowed"||I.signature.additionalParameters===undefined){a=Object.keys(o).every(function(P){return(!I.signature.parameters[P]&&P.indexOf("sap-")!==0)?false:true;});}else{jQuery.sap.log.error("Unexpected value of inbound for signature.additionalParameters");}return a;};this._addFoundParametersToRefs=function(r,m){r.forEach(function(R){m[R]=true;});};this._extractSapPriority=function(I,m){var s;if(I&&I["sap-priority"]&&I["sap-priority"][0]){s=parseInt(I["sap-priority"][0],10);if(!isNaN(s)){m["sap-priority"]=s;}}return;};this._constructParameterDominatorMap=function(P){var d={},r={};Object.keys(P).forEach(function(k){var R=P[k].renameTo||k;r[R]=r[R]||{"renameTo":R,"dominatedBy":[]};r[R].dominatedBy.push(k);r[R].dominatedBy=r[R].dominatedBy.sort();d[k]=r[R];});return d;};this._removeSpuriousDefaultedValues=function(I,d,P){var o=d.slice(0);o.forEach(function(s,a){var b;var n=P[s].dominatedBy.some(function(k){if(I[k]&&(k!==s)&&d.indexOf(k)===-1){b=k;return true;}return false;});if(n&&(b!==s)){d.splice(a,1);delete I[s];}});return{intentParamsPlusAllDefaults:I,defaultedParamNames:d};};this._matchToInbound=function(I,o,k,m){function n(R,x,D){R.matches=false;R.noMatchReason=x;R.noMatchDebug=D;return R;}function M(R){R.matches=true;return R;}var a=this,b={inbound:o};b.genericSO=(o.semanticObject==="*");if(!(I.semanticObject===undefined||I.semanticObject===o.semanticObject||o.semanticObject==='*')){return n(b,"Semantic object \""+I.semanticObject+"\" did not match");}if(!(I.action===undefined||I.action===o.action)){return n(b,"Action \""+I.action+"\" did not match");}if(o.deviceTypes&&!(I.formFactor===undefined||o.deviceTypes[I.formFactor])){return n(b,"Form factor \""+I.formFactor+"\" did not match","Inbound: ["+Object.keys(o.deviceTypes).filter(function(K){return!!o.deviceTypes[K];}).join(", ")+"]");}var T=I.params&&I.params["sap-ui-tech-hint"]&&I.params["sap-ui-tech-hint"][0];if(I.treatTechHintAsFilter&&T){var s=g({inbound:o});if(s!==T){return n(b,"Tech Hint as filter \""+T+"\" did not match","Inbound: ["+s+"]");}}var r=[],d=[],e=I.params;var f=this._addDefaultParameterValues(e,o.signature&&o.signature.parameters,k,r,d);b.intentParamsPlusAllDefaults=f;b.defaultedParamNames=d;this._extractSapPriority(f,b);var j=0,l=0,q=0,v=0;var w=Object.keys(o.signature.parameters).every(function(P){var V=f[P],x=V&&V[0],y=o.signature.parameters[P],z=e.hasOwnProperty(P);if(y.required&&(x===null||x===undefined)){return false;}if(y.filter){if(!a._matchesFilter(x,y.filter,k,m)){return false;}if(z){++q;}}if(z&&y.required){++l;}if(z){++j;}if(!z&&(x===null||x===undefined)){++v;}var B=a._constructParameterDominatorMap(o.signature.parameters);var R=a._removeSpuriousDefaultedValues(b.intentParamsPlusAllDefaults,b.defaultedParamNames,B);b.intentParmsPlusAllDefaults=R.intentParmsPlusAllDefaults;b.defaultedParamNames=R.defaultedParamNames;return true;});b.countMatchingParams=j;b.countMatchingRequiredParams=l;b.countMatchingFilterParams=q;b.countDefaultedParams=d.length;b.countPotentiallyMatchingParams=Object.keys(I.params).length;b.countFreeInboundParams=v;if(!w){return n(b,"Inbound parameter signature did not match",this._compactSignatureNotation(o.signature));}if(!this._checkAdditionalParameters(o,f)){return n(b,"Additional parameters not allowed",this._compactSignatureNotation(o.signature));}if(o.signature.additionalParameters==="ignored"){this._filterObjectKeys(f,function(K){if(K.indexOf("sap-")===0){return true;}if(o.signature.parameters.hasOwnProperty(K)){return true;}return false;},true);b.countPotentiallyMatchingParams=Object.keys(I.params).filter(function(x){return o.signature.parameters.hasOwnProperty(x);}).length;}this._constructEarlyResolutionResult(b,o);this._addSortString(b);this._addFoundParametersToRefs(r,m);return M(b);};this._filterObjectKeys=function(o,f,I){var O=I?o:jQuery.extend(true,{},o);Object.keys(O).forEach(function(k){if(f(k)===false){delete O[k];}});return O;};this._isFullLocalWDAResolution=function(m){var I=m.inbound,r=I&&I.resolutionResult;if(S&&S.config&&S.config["enableWdaLocalResolution"]===false){return false;}return!(!I||!r||!(r["sap.wda"])||!(r.applicationType==="WDA"));};this._isLocalWDAResolution=function(m){var I=m.inbound,r=I&&I.resolutionResult;if(S&&S.config&&S.config["enableWdaLocalResolution"]===false){return false;}return!(!I||!r||!(r.applicationType==="WDA"));};this._isFullLocalWebguiResolution=function(m){var I=m.inbound,r=I&&I.resolutionResult;if(S&&S.config&&S.config["enableWebguiLocalResolution"]===false){return false;}return!(!I||!r||!(r["sap.gui"])||!(r.applicationType==="TR"));};this._isLocalWebguiNowrapResolution=function(m){var I=m.inbound,r=I&&I.resolutionResult;if(S&&S.config&&S.config["enableWebguiLocalResolution"]===false){return false;}return!(!I||!r||!(r.applicationType==="TR")||!(r.url.indexOf("/~canvas;")>=0)||!(r.url.indexOf("app/transaction/APB_LPD_CALL_")===-1));};this._isLocalWebguiWrapResolution=function(m){var I=m.inbound,r=I&&I.resolutionResult;if(S&&S.config&&S.config["enableWebguiLocalResolution"]===false){return false;}return!(!I||!r||!(r.applicationType==="TR")||!(r.url.indexOf("/~canvas;")>=0)||!(r.url.indexOf("app/transaction/APB_LPD_CALL_")>=0));};this._isLocalNativeWebguiWrapResolution=function(m){var I=m.inbound,r=I&&I.resolutionResult;if(S&&S.config&&S.config["enableNativeWebguiLocalResolution"]===false){return false;}return!(!I||!r||!(r.applicationType==="TR")||!(r.url.indexOf("/its/webgui")>=0)||!(r.url.indexOf("APB_LPD_CALL_")!==-1));};this._isLocalNativeWebguiNowrapResolution=function(m){var I=m.inbound,r=I&&I.resolutionResult;if(S&&S.config&&S.config["enableNativeWebguiLocalResolution"]===false){return false;}return!(!I||!r||!(r.applicationType==="TR")||!(r.url.indexOf("/its/webgui")>=0)||!(r.url.indexOf("APB_LPD_CALL_")===-1));};this._constructEarlyResolutionResult=function(m,I){m.resolutionResult={};if(I&&I.resolutionResult&&I.resolutionResult.hasOwnProperty("sap.platform.runtime")){m.resolutionResult["sap.platform.runtime"]=I.resolutionResult["sap.platform.runtime"];}Object.keys(m.intentParamsPlusAllDefaults).slice(0).forEach(function(n){if(!jQuery.isArray(m.intentParamsPlusAllDefaults[n])){if(!m.resolutionResult.oNewAppStateMembers){m.resolutionResult.oNewAppStateMembers={};}m.resolutionResult.oNewAppStateMembers[n]=m.intentParamsPlusAllDefaults[n];}});};this._hasRenameTo=function(m){return m.inbound&&m.inbound.signature&&m.inbound.signature.parameters&&Object.keys(m.inbound.signature.parameters).some(function(k){return!!(m.inbound.signature.parameters[k].renameTo);});};this._removeUnusedComplexParameterValuesFromDefaultList=function(m){m.defaultedParamNames=m.defaultedParamNames.filter(function(n){if(m.intentParamsPlusAllDefaults[n]&&!jQuery.isArray(m.intentParamsPlusAllDefaults[n])){if(!(m.resolutionResult.oNewAppStateMembers&&m.resolutionResult.oNewAppStateMembers[n])){return false;}}return true;});};this._computeNavigationMode=function(m){var a=["newWindow","embedded","replace"];if(m.intentParamsPlusAllDefaults["sap-ushell-next-navmode"]&&a.indexOf(m.intentParamsPlusAllDefaults["sap-ushell-next-navmode"][0])>=0){m.resolutionResult["sap-ushell-next-navmode"]=m.intentParamsPlusAllDefaults["sap-ushell-next-navmode"][0];}if(m.intentParamsPlusAllDefaults["sap-ushell-navmode"]&&a.indexOf(m.intentParamsPlusAllDefaults["sap-ushell-navmode"][0])>=0){m.resolutionResult.navigationMode=m.intentParamsPlusAllDefaults["sap-ushell-navmode"][0];m.resolutionResult.explicitNavMode=true;}};this._mapDefaultParameterNames=function(m){var P=jQuery.sap.getObject("inbound.signature.parameters",undefined,m)||{},M={};m.defaultedParamNames.forEach(function(n){var N=(P[n]&&P[n].renameTo)||n;if(M[N]){jQuery.sap.log.error("renaming of defaultedParamNames creates duplicates"+n+"->"+N);}else{M[N]=true;}});m.mappedDefaultedParamNames=Object.keys(M).sort();};this._mixAppStateIntoResolutionResultAndRename=function(m,a){var d=new jQuery.Deferred(),b=this,n,s,o;function e(T){b._removeUnusedComplexParameterValuesFromDefaultList(T);b._mapDefaultParameterNames(T);b._computeNavigationMode(T);delete T.resolutionResult.oNewAppStateMembers;d.resolve(T);}function f(m){return(m.resolutionResult.oNewAppStateMembers&&!jQuery.isEmptyObject(m.resolutionResult.oNewAppStateMembers));}function j(L,P){return jQuery.isArray(L)&&L.some(function(q){return(P.indexOf(q)!==-1);});}function k(q,P){var v,w,x;if(q&&q.selectionVariant){v=new sap.ui.generic.app.navigation.service.SelectionVariant(JSON.stringify(q.selectionVariant));x=v.getSelectOptionsPropertyNames()||[];w=v.getParameterNames()||[];if(j(x,P)||j(w,P)){return true;}}return false;}function r(q,v,P){var w=new sap.ui.generic.app.navigation.service.SelectionVariant(),x=q.getParameterNames()||[],y=q.getSelectOptionsPropertyNames()||[],z,B;x.forEach(function(C){z=q.getParameter(C);if(P[C]&&P[C].renameTo){if((w.getParameter(P[C].renameTo)===undefined)&&(w.getSelectOption(P[C].renameTo)===undefined)){w.addParameter(P[C].renameTo,z);v.changed=true;}else{jQuery.sap.log.error("renaming of appstate creates duplicates "+C+"->"+P[C].renameTo);}}else{if((w.getParameter(C)===undefined)&&(w.getSelectOption(C)===undefined)){w.addParameter(C,z);}}});y.forEach(function(C){B=q.getSelectOption(C);if(P[C]&&P[C].renameTo){if((w.getSelectOption(P[C].renameTo)===undefined)&&(w.getParameter(P[C].renameTo)===undefined)){w.massAddSelectOption(P[C].renameTo,B);v.changed=true;}else{jQuery.sap.log.error("renaming of appstate creates duplicates "+C+"->"+P[C].renameTo);}}else{if((w.getSelectOption(C)===undefined)&&(w.getParameter(C)===undefined)){w.massAddSelectOption(C,B);}}});x.forEach(function(C){q.removeParameter(C);});y.forEach(function(C){q.removeSelectOption(C);});w.getParameterNames().forEach(function(C){q.addParameter(C,w.getParameter(C));});w.getSelectOptionsPropertyNames().forEach(function(C){q.massAddSelectOption(C,w.getSelectOption(C));});return q;}function R(q,v,P){return r(q,v,P);}function l(D){if(D===undefined||jQuery.isPlainObject(D)){return false;}return true;}function M(N){var q=N.getData()||{},v,C={};if(q.selectionVariant){v=new sap.ui.generic.app.navigation.service.SelectionVariant(JSON.stringify(q.selectionVariant));}else{v=new sap.ui.generic.app.navigation.service.SelectionVariant();}if(f(m)){Object.keys(m.resolutionResult.oNewAppStateMembers).forEach(function(w){v.massAddSelectOption(w,m.resolutionResult.oNewAppStateMembers[w].Ranges);});}v=R(v,C,m.inbound.signature.parameters);if(v.getParameterNames().length!==0||v.getSelectOptionsPropertyNames().length!==0){q.selectionVariant=v.toJSONObject();}if(!C.changed&&!f(m)){e(m);return;}N.setData(q);N.save().done(function(){m.intentParamsPlusAllDefaults["sap-xapp-state"]=[N.getKey()];m.mappedIntentParamsPlusSimpleDefaults["sap-xapp-state"]=[N.getKey()];e(m);});}if(!f(m)&&!b._hasRenameTo(m)){e(m);}else{s=m.intentParamsPlusAllDefaults["sap-xapp-state"]&&m.intentParamsPlusAllDefaults["sap-xapp-state"][0];if(s){a.getAppState(s).done(function(q){var P=b._constructParameterDominatorMap(m.inbound.signature.parameters);o=q.getData();if(l(o)){delete m.resolutionResult.oNewAppStateMembers;e(m);}if(m.resolutionResult.oNewAppStateMembers){Object.keys(m.resolutionResult.oNewAppStateMembers).forEach(function(v){var D=P[v].dominatedBy;if(k(o,D)){delete m.resolutionResult.oNewAppStateMembers[v];}});}if(!f(m)&&!b._hasRenameTo(m)){e(m);}else{n=a.createEmptyAppState(undefined,true);if(n){n.setData(q.getData());M(n);}}});}else if(f(m)){M(a.createEmptyAppState(undefined,true));}else{e(m);}}return d.promise();};this._extractInboundFilter=function(o){if(!A.hasSegmentedAccess){return undefined;}if(typeof o!=="string"){return undefined;}var f=o.indexOf("#")===0?o:"#"+o;var s=this._getURLParsing().parseShellHash(f);if(!s||!s.semanticObject||!s.action){return undefined;}return[{semanticObject:s.semanticObject,action:s.action}];};this.resolveHashFragment=function(s){var a=this,d=new jQuery.Deferred(),b=A.resolveHashFragmentFallback&&A.resolveHashFragmentFallback.bind(A),e=this._extractInboundFilter(s);this._ensureInbounds(e).done(function(I){a._resolveHashFragment(s,b,I).done(d.resolve.bind(d)).fail(d.reject.bind(d));}).fail(d.reject.bind(d));return d.promise();};this.resolveTileIntent=function(s){var a=this,d=new jQuery.Deferred(),b=this._extractInboundFilter(s);this._ensureInbounds(b).done(function(I){a._resolveTileIntent(s,undefined,I).done(d.resolve.bind(d)).fail(d.reject.bind(d));}).fail(d.reject.bind(d));return d.promise();};this._resolveHashFragment=function(s,b,I){var U=this._getURLParsing(),a=this,d=new jQuery.Deferred(),f=s.indexOf("#")===0?s:"#"+s,o=U.parseShellHash(f);if(o===undefined){jQuery.sap.log.error("Could not parse shell hash '"+s+"'","please specify a valid shell hash","sap.ushell.services.ClientSideTargetResolution");return d.reject().promise();}o.formFactor=sap.ushell.utils.getFormFactor();this._getMatchingInbounds(o,I,true).fail(function(e){jQuery.sap.log.error("Could not resolve "+s,"_getMatchingInbounds promise rejected with: "+e,"sap.ushell.services.ClientSideTargetResolution");d.reject(e);}).done(function(m){var M;if(m.length===0){jQuery.sap.log.warning("Could not resolve "+s,"rejecting promise","sap.ushell.services.ClientSideTargetResolution");d.reject("Could not resolve navigation target");return;}M=m[0];a._resolveSingleMatchingTarget(M,b,f).done(d.resolve.bind(d)).fail(d.reject.bind(d));});return d.promise();};this._resolveEasyAccessMenuIntent=function(I,m){var e="Intent must be either #Shell-startGUI or #Shell-startWDA";if(I.action==="startGUI"){return this._resolveEasyAccessMenuIntentWebgui(I,m);}if(I.action==="startWDA"){return this._resolveEasyAccessMenuIntentWDA(I,m);}return new jQuery.Deferred().reject("The easy access menu intent "+I.semanticObject+"-"+I.action+" could not be resolved: "+e).promise();};this._resolveEasyAccessMenuIntentWDA=function(I,m){var d=new jQuery.Deferred(),U,o,a=this,b={};U="/ui2/nwbc/~canvas;window=app/wda/"+I.params["sap-ui2-wd-app-id"][0]+"/";jQuery.each(I.params,function(e,v){if(e==="sap-ui2-wd-app-id"||e==="sap-system"){return;}if(e==="sap-ui2-wd-conf-id"){b["sap-wd-configId"]=v;return;}b[e]=v;});if(b){U=U+"?"+a._getURLParsing().paramsToString(b);}o=new URI(U);this._spliceSapSystemIntoURI(o,"",I.params["sap-system"][0],"WDA").done(function(o){var r={url:o.toString(),applicationType:"NWBC",text:I.params["sap-ui2-wd-app-id"][0],additionalInformation:"","sap-system":I.params["sap-system"][0]};if(m&&m.inbound&&m.inbound.resolutionResult&&m.inbound.resolutionResult["sap.platform.runtime"]){r["sap.platform.runtime"]=m.inbound.resolutionResult["sap.platform.runtime"];}d.resolve(r);}).fail(d.reject.bind(d));return d.promise();};this._resolveEasyAccessMenuIntentWebgui=function(I,m){var d=new jQuery.Deferred(),U,o;U="/sap/bc/gui/sap/its/webgui?%7etransaction="+I.params["sap-ui2-tcode"][0]+"&%7enosplash=1";o=new URI(U);this._spliceSapSystemIntoURI(o,"",I.params["sap-system"][0],"NATIVEWEBGUI").done(function(o){var r={url:o.toString(),applicationType:"TR",text:I.params["sap-ui2-tcode"][0],additionalInformation:"","sap-system":I.params["sap-system"][0]};if(m&&m.inbound&&m.inbound.resolutionResult&&m.inbound.resolutionResult["sap.platform.runtime"]){r["sap.platform.runtime"]=m.inbound.resolutionResult["sap.platform.runtime"];}d.resolve(r);}).fail(d.reject.bind(d));return d.promise();};this._resolveSingleMatchingTarget=function(m,b,f){var a=this,d=new jQuery.Deferred(),U=this._getURLParsing(),I=U.parseShellHash(f);if(I.semanticObject==="Shell"&&(I.action==="startWDA"||I.action==="startGUI")){return this._resolveEasyAccessMenuIntent(I,m);}this._mapParameterNamesAndRemoveObjects(m);this._mixAppStateIntoResolutionResultAndRename(m,sap.ushell.Container.getService("AppState")).done(function(m){var B=a._determineResultProcessor(m);B(m,b,f).done(function(m){d.resolve(m.resolutionResult);}).fail(function(M){if(M.indexOf("fallback:")>=0){a._constructFallbackResolutionResult.call(this,m,b,f).fail(d.reject.bind(d)).done(function(m){d.resolve(m.resolutionResult);});}else{d.reject(M);}});});return d.promise();};this._resolveTileIntent=function(s,b,I){var U=this._getURLParsing(),a=this,d=new jQuery.Deferred(),f=s.indexOf("#")===0?s:"#"+s,o=U.parseShellHash(f);if(o===undefined){jQuery.sap.log.error("Could not parse shell hash '"+s+"'","please specify a valid shell hash","sap.ushell.services.ClientSideTargetResolution");return d.reject("Cannot parse shell hash").promise();}o.formFactor=sap.ushell.utils.getFormFactor();this._getMatchingInbounds(o,I,false).fail(function(e){jQuery.sap.log.error("Could not resolve "+s,"_getMatchingInbounds promise rejected with: "+e,"sap.ushell.services.ClientSideTargetResolution");d.reject(e);}).done(function(m){var M;if(m.length===0){jQuery.sap.log.warning("Could not resolve "+s,"no matching targets were found","sap.ushell.services.ClientSideTargetResolution");d.reject("No matching targets found");return;}M=m[0];a._resolveSingleMatchingTileIntent(M,b,f).done(d.resolve.bind(d)).fail(d.reject.bind(d));});return d.promise();};this._resolveSingleMatchingTileIntent=function(m,b,f){var d=new jQuery.Deferred();d.resolve(m.inbound.tileResolutionResult);return d.promise();};this._determineResultProcessor=function(m){var I=m.inbound,r=I&&I.resolutionResult;function l(P,R){jQuery.sap.log.debug("Resolution result will be constructed via "+P+" processor",R,"sap.ushell.services.ClientSideTargetResolution");}if(!I||!r){l("FALLBACK","the inbound or the inbound resolutionResult member was not available");return this._constructFallbackResolutionResult.bind(this);}if(r.applicationType==="SAPUI5"){l("SAPUI5","inbound resolutionResult had SAPUI5 applicationType");return this._constructSAPUI5ResolutionResult.bind(this);}var a=this._isFullLocalWDAResolution(m);if(a){l("WDA full url construction");return this._constructFullWDAResolutionResult.bind(this);}var b=this._isLocalWDAResolution(m);if(b){l("WDA");return this._constructWDAResolutionResult.bind(this);}var d=this._isFullLocalWebguiResolution(m);if(d){l("NON-WRAPPED WEBGUI full url construction");return this._constructFullWebguiResolutionResult.bind(this);}var e=this._isLocalWebguiNowrapResolution(m);if(e){l("NON-WRAPPED WEBGUI");return this._constructWebguiNowrapResult.bind(this);}var f=this._isLocalWebguiWrapResolution(m);if(f){l("WRAPPED WEBGUI");return this._constructWebguiWrapResult.bind(this);}var j=this._isLocalNativeWebguiNowrapResolution(m);if(j){l("NATIVE NON-WRAPPED WEBGUI");return this._constructNativeWebguiNowrapResult.bind(this);}var k=this._isLocalNativeWebguiWrapResolution(m);if(k){l("NATIVE WRAPPED WEBGUI");return this._constructNativeWebguiWrapResult.bind(this);}if(r.applicationType==="URL"){l("URL","inbound resolutionResult had URL applicationType");return this._constructURLResolutionResult.bind(this);}l("FALLBACK","could not apply any result processor to inbound resolutionResult: "+JSON.stringify(r,null,"   "));return this._constructFallbackResolutionResult.bind(this);};this._stripURI=function(U,s,a){var d=new jQuery.Deferred(),b=this;if(typeof s==="undefined"){this._stripURIWithSystemAlias(U,s,a,undefined).fail(function(e){d.reject(e);}).done(function(n){d.resolve(n);});return d.promise();}A.resolveSystemAlias(s).fail(function(e){d.reject(e);}).done(function(r){b._stripURIWithSystemAlias(U,s,a,r).fail(function(e){d.reject(e);}).done(function(n){d.resolve(n);});});return d.promise();};this._stripURIWithSystemAlias=function(U,s,a,r){var b=this,o,d,T,e,D=new jQuery.Deferred(),P=new jQuery.Deferred();U.protocol("");U.hostname("");U.port("");b._removeParametersFromURI(U,["sap-client","sap-language"]);if(!jQuery.isPlainObject(r)||typeof s!=="string"){return D.resolve(U).promise();}d=b._selectSystemAliasDataName(r,new URI(window.location.toString()).protocol());o=r[d];e=(typeof o.pathPrefix==="string")&&o.pathPrefix;if(e!==""){P.resolve(e);}else{A.resolveSystemAlias("").fail(function(E){D.reject(E);}).done(function(R){var f=R[d];P.resolve(f.pathPrefix);});}P.fail(function(E){D.reject(E);}).done(function(e){if(e&&e.length>0){T=U.path();T=T.replace(e,"");if(T.indexOf("/")!==0){T="/"+T;}U.path(T);}if(a==="NATIVEWEBGUI"&&r.hasOwnProperty("rfc")){T=U.path();T=T.split(";").filter(function(f){return f.indexOf("~sysid=")!==0&&f.indexOf("~service=")!==0&&f.indexOf("~loginGroup=")!==0&&f.indexOf("~messageServer=")!==0&&f.indexOf("~sncNameR3=")!==0&&f.indexOf("~sncQoPR3=")!==0;}).join(";");U.path(T);}D.resolve(U);});return D.promise();};this._removeParametersFromURI=function(U,P){var b={},T;P.forEach(function(s){b[s]=true;});T=U.query();T=T.split("&").filter(function(s){var a=(s.split("=")[0]||"").toLowerCase();return!b.hasOwnProperty(a);}).join("&");U.query(T);};this._spliceSapSystemIntoUrlURI=function(U,s,a){var b=this,d=new jQuery.Deferred();if(typeof a==="undefined"||s===a){return d.resolve(U).promise();}if(s===""||typeof s==="undefined"){if(this._isAbsoluteURI(U)){return d.resolve(U);}b._applyAliasToURI(a,U,"URL").fail(function(e){d.reject(e);}).done(function(o){d.resolve(o);});return d.promise();}if(typeof A.resolveSystemAlias!=="function"){return d.reject("fallback: the adapter does not implement resolveSystemAlias").promise();}A.resolveSystemAlias(s).fail(function(e){d.reject(e);}).done(function(r){var e=b._selectSystemAliasDataName(r,new URI(window.location.toString()).protocol()),o=r[e],D;if((U.protocol()||"").toLowerCase()===e&&(U.hostname()||"")===o.host&&(U.path().indexOf(o.pathPrefix)===0)){U.protocol("");U.hostname("");D=U.path().replace(o.pathPrefix,"");U.path(D);b._removeParametersFromURI(U,["sap-language","sap-client"]);b._applyAliasToURI(a,U,"URL").fail(function(E){d.reject(E);}).done(function(f){d.resolve(f);});}else{d.resolve(U);}});return d.promise();};this._spliceSapSystemIntoURI=function(U,s,a,b){var d=new jQuery.Deferred(),e=this;if(b==="URL"){return this._spliceSapSystemIntoUrlURI(U,s,a);}if(typeof a==="undefined"||s===a){return d.resolve(U).promise();}if(typeof A.resolveSystemAlias!=="function"){return d.reject("fallback: the adapter does not implement resolveSystemAlias").promise();}this._stripURI(U,s,b).fail(function(E){d.reject(E);}).done(function(o){e._applyAliasToURI(a,o,b).fail(function(E){d.reject(E);}).done(function(I){d.resolve(I);});});return d.promise();};this._applyAliasToURI=function(s,U,a){var b=this,n=U,d=new jQuery.Deferred();A.resolveSystemAlias(s).fail(function(e){d.reject(e);}).done(function(r){var e=b._selectSystemAliasDataName(r,new URI(window.location.toString()).protocol()),o=r[e],q,l,f;n.protocol(e);n.hostname(o.host);n.port(o.port);b._interpolatePathPrefixIntoURI(n,a,o.pathPrefix).fail(function(E){d.reject(E);}).done(function(n){q=n.query();if(typeof r.client==="string"&&r.client!==""){q=q+(q.length>0?"&":"")+"sap-client="+r.client;}if(typeof r.language==="string"&&r.language!==""){l=r.language;}else{f=sap.ushell.Container.getUser();if(!f){jQuery.sap.log.error("Cannot retieve the User object via sap.ushell.Container while determining sap-language","will default to 'en' language","sap.ushell.services.ClientSideTargetResolution");l="en";}else{l=f.getLanguage();}}q=q+(q.length>0?"&":"")+"sap-language="+l;n.query(q);n=b._interpolateNativeWebguiDataIntoURI(r,n,a);d.resolve(n);});});return d.promise();};this._interpolateNativeWebguiDataIntoURI=function(s,U,a){var I,T,b,P;if(s.hasOwnProperty("rfc")&&a==="NATIVEWEBGUI"){b=s.rfc;I=!!b.systemId;if(I){T=[b.systemId&&("~sysid="+b.systemId),b.loginGroup&&("~loginGroup="+b.loginGroup),b.sncNameR3&&("~messageServer="+encodeURIComponent(b.sncNameR3)),b.sncNameR3&&("~sncNameR3="+encodeURIComponent(b.sncNameR3)),b.sncQoPR3&&("~sncQoPR3="+b.sncQoPR3)].filter(function(o){return(typeof o==="string")&&(o!=="");});}else{T=[b.service&&("~service="+b.service),b.sncNameR3&&("~sncNameR3="+encodeURIComponent(b.sncNameR3)),b.sncQoPR3&&("~sncQoPR3="+b.sncQoPR3)].filter(function(o){return(typeof o==="string")&&(o!=="");});}P=U.path()+";"+T.join(";").replace(/(%[A-F0-9]{2})/g,function(e){return e.toLowerCase();});U.path(P);U._parts.path=P;}return U;};this._interpolatePathPrefixIntoURI=function(U,s,P){var a=this,d=new jQuery.Deferred(),T;if(s==="URL"&&P.length===0){return d.resolve(U).promise();}function b(e){var r=e+U.path();U.path(r.replace(/\/+/g,"/"));d.resolve(U);}if(P.length>0){if((s==="WDA"||s==="WEBGUI")&&U.path().indexOf("~canvas")>=0){T=U.path();T="/~canvas"+T.split("~canvas")[1];U.path(T);}b(P);}else{A.resolveSystemAlias("").fail(function(e){d.reject(e);}).done(function(r){var e=a._selectSystemAliasDataName(r,new URI(window.location.toString()).protocol()),f=r[e].pathPrefix;b(f);});}return d.promise();};this._selectSystemAliasDataName=function(s,b){if(s.hasOwnProperty("https")){return"https";}if(s.hasOwnProperty("http")){return"http";}jQuery.sap.log.error("Cannot select which system alias to pick between http/https","make sure they are provided in the given system alias collection","sap.ushell.services.ClientSideTargetResolution");return undefined;};this._getRenameParameterName=function(P,s,a){if(!a||!jQuery.isArray(a)){return P;}if(s&&s.parameters&&s.parameters[P]&&s.parameters[P].renameTo){return s.parameters[P].renameTo;}return P;};this._mapParameterNamesAndRemoveObjects=function(m){var a=this,n={},o=m.intentParamsPlusAllDefaults;Object.keys(o).sort().forEach(function(P){var r=a._getRenameParameterName(P,m.inbound.signature,o[P]);if(jQuery.isArray(m.intentParamsPlusAllDefaults[P])){if(n[r]){jQuery.sap.log.error("collision of values during parameter mapping : \""+P+"\" -> \""+r+"\"");}else{n[r]=m.intentParamsPlusAllDefaults[P];}}});m.mappedIntentParamsPlusSimpleDefaults=n;};this._constructFullWDAResolutionResult=function(m,b,f){var d=this,I=m.inbound,r=I&&I.resolutionResult,D=new jQuery.Deferred();var o={target:{"semanticObject":"Shell","action":"startWDA"},"params":{"sap-ui2-wd-app-id":[I.resolutionResult["sap.wda"].applicationId],"sap-system":[r.systemAlias]}};if(I.resolutionResult["sap.wda"].configId){o.params["sap-ui2-wd-conf-id"]=[I.resolutionResult["sap.wda"].configId];}this._resolveEasyAccessMenuIntentWDA(o,m).done(function(C){r.url=C.url;return d._constructWDAResolutionResult(m,b,f).done(function(a){D.resolve(a);}).fail(function(M){D.reject(M);});});return D.promise();};this._constructFullWebguiResolutionResult=function(m,b,f){var d=this,I=m.inbound,r=I&&I.resolutionResult,D=new jQuery.Deferred();var o={target:{"semanticObject":"Shell","action":"startGUI"},"params":{"sap-ui2-tcode":[I.resolutionResult["sap.gui"].transaction],"sap-system":[r.systemAlias]}};this._resolveEasyAccessMenuIntentWebgui(o,m).done(function(C){r.url=C.url;return d._constructWebguiNowrapResult(m,b,f).done(function(a){D.resolve(a);}).fail(function(M){D.reject(M);});});return D.promise();};this._constructWDAResolutionResult=function(m,b,f){var a=this,I=m.inbound,r=I&&I.resolutionResult,d=new jQuery.Deferred();var w=new URI(r.url);var e=jQuery.extend(true,{},m.mappedIntentParamsPlusSimpleDefaults);if(m.mappedDefaultedParamNames.length>0){e["sap-ushell-defaultedParameterNames"]=[JSON.stringify(m.mappedDefaultedParamNames)];}var s=e["sap-system"]&&e["sap-system"][0];m.resolutionResult["sap-system"]=s;delete e["sap-system"];a._spliceSapSystemIntoURI(w,r.systemAlias,s,"WDA").fail(d.reject.bind(d)).done(function(w){sap.ushell.Container.getService("ShellNavigation").compactParams(e,["sap-xapp-state","sap-ushell-defaultedParameterNames","sap-intent-params"],undefined,true).fail(d.reject.bind(d)).done(function(E){var j=a._getURLParsing().paramsToString(E);var P=w.search();if(j){P=P+((P.indexOf("?")<0)?"?":"&")+j;}w.search(P);["additionalInformation","applicationDependencies"].forEach(function(k){if(I.resolutionResult.hasOwnProperty(k)){m.resolutionResult[k]=I.resolutionResult[k];}});m.resolutionResult.url=w.toString();m.resolutionResult.text=I.title;m.resolutionResult.applicationType="NWBC";d.resolve(m);});});return d.promise();};this._constructWebguiNowrapResult=function(m,b,f){var a=this,I=m.inbound,r=I&&I.resolutionResult,d=new jQuery.Deferred();var w=new URI(r.url);var e=jQuery.extend(true,{},m.mappedIntentParamsPlusSimpleDefaults);var s=e["sap-system"]&&e["sap-system"][0];m.resolutionResult["sap-system"]=s;delete e["sap-system"];a._adjustDYNP_OKCODE(e,m);a._spliceSapSystemIntoURI(w,r.systemAlias,s,"WEBGUI").fail(d.reject.bind(d)).done(function(w){var E=a._getURLParsing().paramsToString(e);var P=w.search();if(E){P=P+((P.indexOf("?")<0)?"?":"&")+E;}w.search(P);["additionalInformation","applicationDependencies"].forEach(function(j){if(I.resolutionResult.hasOwnProperty(j)){m.resolutionResult[j]=I.resolutionResult[j];}});m.resolutionResult.url=w.toString();m.resolutionResult.text=I.title;m.resolutionResult.applicationType="NWBC";d.resolve(m);});return d.promise();};this._constructWebguiWrapResult=function(m,b,f){var a=this,I=m.inbound,r=I&&I.resolutionResult,d=new jQuery.Deferred();var w=new URI(r.url);var e=jQuery.extend(true,{},m.mappedIntentParamsPlusSimpleDefaults);var s=e["sap-system"]&&e["sap-system"][0];m.resolutionResult["sap-system"]=s;delete e["sap-system"];a._spliceSapSystemIntoURI(w,r.systemAlias,s,"WEBGUI").fail(d.reject.bind(d)).done(function(w){var P=w.search();P=a._injectEffectiveParametersIntoWebguiPobjectParam(P,e,"&","=");w.search(P);["additionalInformation","applicationDependencies"].forEach(function(j){if(I.resolutionResult.hasOwnProperty(j)){m.resolutionResult[j]=I.resolutionResult[j];}});m.resolutionResult.url=w.toString();m.resolutionResult.text=I.title;m.resolutionResult.applicationType="NWBC";d.resolve(m);});return d.promise();};this._injectEffectiveParametersIntoWebguiPobjectParam=function(q,P,Q,s){var I,a="P_OBJECT"+s,m=132;var b=this._getURLParsing().privparamsToString(P,"%25","%21");if(!b){return q;}var d="";this._amendGuiParam("P_OBJECT",q,Q,s,function(f){var j=f.replace(a,"");d=decodeURIComponent(j);if(d.length>0){d=d+"%25";}return a;});b=d+b;var o={pObjX:"",pObject:""};b.match(new RegExp(".{1,"+m+"}","g")).map(function(f){return encodeURIComponent(f);}).forEach(function(f,G){var j="P_OBJECT";var k="pObject";if(G>0){j="P_OBJ"+G;k="pObjX";}var l=o[k].length===0?"":Q;o[k]=o[k]+l+j+s+f;});I=[o.pObjX,o.pObject].filter(function(f){return f.length>0;}).join(Q);var e=this._amendGuiParam("P_OBJECT",q,Q,s,function(f){return I;});if(e.found){return e.query;}return q+(q.length===0?"":Q)+I;};this._amendGuiParam=function(T,q,Q,s,a){var f=false,P=T+s;var b=q.split(Q).map(function(d){if(d.indexOf(P)!==0){return d;}f=true;return a(d);}).filter(function(d){return typeof d!=="undefined";}).join(Q);return{found:f,query:b};};this._parseWebguiTransactionQueryParam=function(T){var s="^(.+?)(%20|(%20)(.+))?$",r=new RegExp(s,"i"),a,P={hasParameters:null,transactionParamName:"",transactionCode:"",parameters:[]};var b=T.split("=");if(b.length>2){return{"error":"Found more than one assignment ('=') in the transaction query parameter","details":"Only one '=' sign is expected in "+T};}if(b.length<2||typeof b[1]==="undefined"||b[1].length===0){return{"error":"The transaction query parameter must specify at least the transaction name","details":"Got "+T+" instead."};}P.transactionParamName=b[0];a=b[1];var m=a.match(r);if(!m){return{"error":"Cannot parse ~transaction query parameter value.","details":a+" should match /"+s+"/"};}P.transactionCode=m[1];if(m[2]&&m[2]!=="%20"){var d=m[4]||"";d.split("%3b").forEach(function(n){var N=n.split("%3d"),e=N[0];if(e&&typeof e==="string"&&e.length>0){P.parameters.push({name:e,value:N[1]});}});}P.hasParameters=false;if(P.parameters.length>0){P.hasParameters=true;P.transactionCode=P.transactionCode.replace(/^[*]/,"");}return P;};this._injectEffectiveParametersIntoWebguiQueryParam=function(T,P){var o=this._parseWebguiTransactionQueryParam(T);if(o.error){jQuery.sap.log.error(o.error,o.details,"sap.ushell.services.ClientSideTargetResolution");return T;}var a=o.parameters.map(function(e){return e.name.toUpperCase()+"%3d"+e.value;});var b={};Object.keys(P).forEach(function(k){b[k.toUpperCase()]=P[k];});var s=this._getURLParsing().privparamsToString(b,"%3b","%3d");if(s){a.push(s);}var d=a.length>0;return o.transactionParamName+"="+(d?"*":"")+o.transactionCode+(d?"%20":"")+a.join("%3b");};this._constructNativeWebguiWrapResult=function(m,b,f){var a=this,I=m.inbound,r=I&&I.resolutionResult,d=new jQuery.Deferred();var w=new URI(r.url);var e=jQuery.extend(true,{},m.mappedIntentParamsPlusSimpleDefaults);var s=e["sap-system"]&&e["sap-system"][0];m.resolutionResult["sap-system"]=s;delete e["sap-system"];a._spliceSapSystemIntoURI(w,r.systemAlias,s,"NATIVEWEBGUI").fail(d.reject.bind(d)).done(function(w){var P=w.search();var j=P.split("&").map(function(q){var k;if(q.indexOf("?%7etransaction")===0||q.indexOf("%7etransaction")===0){k=a._injectEffectiveParametersIntoWebguiPobjectParam(q,e,"%3b","%3d");return k;}return q;}).join("&");w.search(j);["additionalInformation","applicationDependencies"].forEach(function(k){if(I.resolutionResult.hasOwnProperty(k)){m.resolutionResult[k]=I.resolutionResult[k];}});m.resolutionResult.url=w.toString();m.resolutionResult.text=I.title;m.resolutionResult.applicationType="TR";d.resolve(m);});return d.promise();};this._isWebguiBusinessParameter=function(n,v){var N;if(arguments.length===1){N=n.split(/[=](.+)?/);if(N.length>1){return this._isWebguiBusinessParameter.apply(this,N);}}return!(n.indexOf("sap-")===0||n.charAt(0)==="~");};this._extractWebguiNonBusinessParameters=function(P){var a=this,n={};Object.keys(P).forEach(function(s){var b=P[s];if(!a._isWebguiBusinessParameter(s,b)){n[s]=b;delete P[s];}});return n;};function i(I){return I&&I.signature&&I.signature&&I.signature.parameters&&I.signature.parameters.DYNP_OKCODE&&I.signature.parameters.DYNP_OKCODE.required===true;}this._adjustDYNP_OKCODE=function(e,m){var a=this;var I=i(m&&m.inbound);if(I){return e;}var n=Object.keys(e).reduce(function(P,s){if(!a._isWebguiBusinessParameter(s)){return P;}if(s.toUpperCase()==="DYNP_OKCODE"){return P;}return P+1;},0);if(n===0){Object.keys(e).forEach(function(P){if(P.toUpperCase()==="DYNP_OKCODE"){delete e[P];}});}return e;};this._constructNativeWebguiNowrapResult=function(m,b,f){var a=this,I=m.inbound,r=I&&I.resolutionResult,d=new jQuery.Deferred(),F={"sap-wd-run-sc":true,"sap-wd-auto-detect":true,"sap-ep-version":true,"sap-system":true};var w=new URI(r.url);var e=jQuery.extend(true,{},m.mappedIntentParamsPlusSimpleDefaults);var s=e["sap-system"]&&e["sap-system"][0];m.resolutionResult["sap-system"]=s;Object.keys(e).forEach(function(P){if(F[P.toLowerCase()]){delete e[P];}});a._adjustDYNP_OKCODE(e,m);var E=this._extractWebguiNonBusinessParameters(e);a._spliceSapSystemIntoURI(w,r.systemAlias,s,"NATIVEWEBGUI").fail(d.reject.bind(d)).done(function(w){var P=w.search();var j=P.split("&").map(function(q){var n;if(!a._isWebguiBusinessParameter(q)){if(q.indexOf("=")>=0){n=q.split("=");if(!E.hasOwnProperty(n[0])){E[n[0]]=n[1];}}else{jQuery.sap.log.error("Found no '=' separator of Webgui non-business parameter. Parameter will be skipped.","'"+q+"'","sap.ushell.services.ClientSideTargetResolution");}return undefined;}var l;if(q.indexOf("?%7etransaction")===0||q.indexOf("%7etransaction")===0){l=a._injectEffectiveParametersIntoWebguiQueryParam(q,e,"%3b","%3d");return l;}return q;}).filter(function(l){return typeof l!=="undefined";}).join("&");var k=a._getURLParsing().paramsToString(E);j=[j,k.replace("~","%7e")].join("&");w.search(j);["additionalInformation","applicationDependencies","sap.platform.runtime"].forEach(function(l){if(I.resolutionResult.hasOwnProperty(l)){m.resolutionResult[l]=I.resolutionResult[l];}});m.resolutionResult.url=w.toString();m.resolutionResult.text=I.title;m.resolutionResult.applicationType="TR";d.resolve(m);});return d.promise();};this._constructSAPUI5ResolutionResult=function(m,b,f){var I=m.inbound,d=new jQuery.Deferred(),U,s,e;["applicationType","additionalInformation","url","applicationDependencies"].forEach(function(P){if(I.resolutionResult.hasOwnProperty(P)){m.resolutionResult[P]=I.resolutionResult[P];}});e=jQuery.extend(true,{},m.mappedIntentParamsPlusSimpleDefaults);if(m.mappedDefaultedParamNames.length>0){e["sap-ushell-defaultedParameterNames"]=[JSON.stringify(m.mappedDefaultedParamNames)];}s=e["sap-system"]&&e["sap-system"][0];m.resolutionResult["sap-system"]=s;U=this._getURLParsing().paramsToString(e);if(U){m.resolutionResult.url=I.resolutionResult.url+((I.resolutionResult.url.indexOf("?")<0)?"?":"&")+U;}if(typeof I.resolutionResult.ui5ComponentName!=="undefined"){m.resolutionResult.ui5ComponentName=I.resolutionResult.ui5ComponentName;}m.resolutionResult.text=I.title;d.resolve(m);return d.promise();};this._isAbsoluteURI=function(U){return(U.protocol()||"").length>0;};this._constructURLResolutionResult=function(m,b,f){var a=this,I=m.inbound,r=I&&I.resolutionResult,d=new jQuery.Deferred();var U=new URI(r.url);var e=jQuery.extend(true,{},m.mappedIntentParamsPlusSimpleDefaults);if(m.inbound&&m.inbound.action==="launchURL"&&m.inbound.semanticObject==="Shell"){delete e["sap-external-url"];}var s=e["sap-system"]&&e["sap-system"][0];m.resolutionResult["sap-system"]=s;delete e["sap-system"];a._spliceSapSystemIntoURI(U,r.systemAlias,s,"URL").fail(d.reject.bind(d)).done(function(o){var j=o.toString(),k,F,l;l=a._getURLParsing().paramsToString(e);if(l){if(o.fragment()){F="#"+o.fragment();k=j.replace(/#.*/,"");}else{k=j;F="";}j=k+((j.indexOf("?")<0)?"?":"&")+l+F;}["additionalInformation","applicationDependencies"].forEach(function(P){if(I.resolutionResult.hasOwnProperty(P)){m.resolutionResult[P]=I.resolutionResult[P];}});m.resolutionResult.url=j;m.resolutionResult.text=I.title;m.resolutionResult.applicationType="URL";d.resolve(m);});return d.promise();};this._constructFallbackResolutionResult=function(m,b,f){var d=new jQuery.Deferred(),e={},D;Object.keys(m.intentParamsPlusAllDefaults).forEach(function(P){if(jQuery.isArray(m.intentParamsPlusAllDefaults[P])){e[P]=m.intentParamsPlusAllDefaults[P];}});D=m.mappedDefaultedParamNames||m.defaultedParamNames;if(D.length>0){e["sap-ushell-defaultedParameterNames"]=[JSON.stringify(D)];}if(typeof b!=="function"){jQuery.sap.log.error("Cannot resolve hash fragment",f+" has matched an inbound that cannot be resolved client side"+" and no resolveHashFragmentFallback method was implemented in ClientSideTargetResolutionAdapter","sap.ushell.services.ClientSideTargetResolution");d.reject("Cannot resolve hash fragment: no fallback provided.");return d.promise();}jQuery.sap.log.warning("Cannot resolve hash fragment client side",f+" has matched an inbound that cannot be resolved client side. Using fallback logic","sap.ushell.services.ClientSideTargetResolution");b(f,jQuery.extend(true,{},m.inbound),e).done(function(r){["applicationType","additionalInformation","url","applicationDependencies","text"].forEach(function(P){if(r.hasOwnProperty(P)){m.resolutionResult[P]=r[P];}});d.resolve(m);}).fail(d.reject.bind(d));return d.promise();};this.getDistinctSemanticObjects=function(){var d=new jQuery.Deferred();this._ensureInbounds().done(function(I){var s={};I.forEach(function(o){if(typeof o.semanticObject==="string"&&o.semanticObject!=="*"&&o.semanticObject.length>0){s[o.semanticObject]=true;}});d.resolve(Object.keys(s).sort());}).fail(function(e){d.reject(e);});return d.promise();};this.getLinks=function(a){var b=this,s,P,I,d=new jQuery.Deferred(),C;if(arguments.length===1&&jQuery.isPlainObject(arguments[0])){var a=arguments[0];C=jQuery.extend(true,{},a);["action","semanticObject"].forEach(function(e){if(a.hasOwnProperty(e)){C[e]=a[e];}});if(C.appStateKey){C.params=C.params||{};C.params["sap-xapp-state"]=[C.appStateKey];delete C.appStateKey;}}else if(arguments.length<=3){jQuery.sap.log.warning("Passing positional arguments to getLinks is deprecated","Please use nominal arguments instead","sap.ushell.services.ClientSideTargetResolution");s=arguments[0];P=arguments[1];I=arguments[2];C={semanticObject:s,params:P,ignoreFormFactor:I};}else{return d.reject("invalid arguments for getLinks").promise();}this._ensureInbounds().done(function(e){b._getLinks(C,e).done(d.resolve.bind(d)).fail(d.reject.bind(d));}).fail(d.reject.bind(d));return d.promise();};this._validateGetSemanticObjectLinksArgs=function(a){var s=a.semanticObject,b=a.action,I=!a.hasOwnProperty("action");if(typeof s!=="undefined"||I){if(typeof s!=="string"){jQuery.sap.log.error("invalid input for _getLinks","the semantic object must be a string, got "+Object.prototype.toString.call(s)+" instead","sap.ushell.services.ClientSideTargetResolution");return"invalid semantic object";}if(I&&s.match(/^\s+$/)){jQuery.sap.log.error("invalid input for _getLinks","the semantic object must be a non-empty string, got '"+s+"' instead","sap.ushell.services.ClientSideTargetResolution");return"invalid semantic object";}if(!I&&s.length===0){jQuery.sap.log.error("invalid input for _getLinks","the semantic object must not be an empty string, got '"+s+"' instead","sap.ushell.services.ClientSideTargetResolution");return"invalid semantic object";}}if(typeof b!=="undefined"){if(typeof b!=="string"){jQuery.sap.log.error("invalid input for _getLinks","the action must be a string, got "+Object.prototype.toString.call(b)+" instead","sap.ushell.services.ClientSideTargetResolution");return"invalid action";}if(b.length===0){jQuery.sap.log.error("invalid input for _getLinks","the action must not be an empty string, got '"+b+"' instead","sap.ushell.services.ClientSideTargetResolution");return"invalid action";}}return undefined;};this._getLinks=function(a,I){var s=a.semanticObject,b=a.action,P=a.params,w=!!a.withAtLeastOneUsedParam,T=!!a.treatTechHintAsFilter,d=a.ignoreFormFactor,e=a.sortResultOnTexts?"text":"intent";var E=this._validateGetSemanticObjectLinksArgs(a);if(E){return new jQuery.Deferred().reject(E).promise();}if(s==="*"){return new jQuery.Deferred().resolve([]).promise();}function C(U,P){var B=U.paramsToString(P);return B?"?"+B:"";}var f=this,U=this._getURLParsing(),D=new jQuery.Deferred(),F=sap.ushell.utils.getFormFactor(),o=U.parseParameters(C(U,P)),j={semanticObject:(s===""?undefined:s),action:b,formFactor:(d?undefined:F),params:o};if(T){j.treatTechHintAsFilter=true;}this._getMatchingInbounds(j,I,true).done(function(m){var k={},r=m.map(function(M){var l=s||M.inbound.semanticObject,n="#"+l+"-"+M.inbound.action,N;if(l==="*"){return undefined;}if(M.inbound.action==="*"){return undefined;}if(M.inbound&&M.inbound.hasOwnProperty("hideIntentLink")&&M.inbound.hideIntentLink===true){return undefined;}if(!k.hasOwnProperty(n)){k[n]=1;if(M.inbound.signature.additionalParameters==="ignored"){N=f._filterObjectKeys(o,function(v){return(v.indexOf("sap-")===0)||M.inbound.signature.parameters.hasOwnProperty(v);},false);}else{N=o;}if(w){var q=Object.keys(N).some(function(v){return v.indexOf("sap-")!==0;});if(!q){return undefined;}}return{"intent":n+C(U,N),"text":M.inbound.title};}else{k[n]++;}return undefined;}).filter(function(l){return typeof l==="object";}).sort(function(G,l){return G[e]<l[e]?-1:1;});if(r.length===0){jQuery.sap.log.debug("_getLinks returned no results");}else if(jQuery.sap.log.getLevel()>=jQuery.sap.log.Level.DEBUG){if(jQuery.sap.log.getLevel()>=jQuery.sap.log.Level.TRACE){var R=[];r.forEach(function(l){var n=l.intent.split("?")[0],L="- "+n+" ("+k[n]+") "+"text: "+l.text+" "+"intent: "+l.intent;R.push(L);});jQuery.sap.log.debug("_getLinks filtered to the following unique intents:",R.join("\n"),"sap.ushell.services.ClientSideTargetResolution");}else{jQuery.sap.log.debug("_getLinks filtered to unique intents.","Reporting histogram: "+Object.keys(k).join(", "),"sap.ushell.services.ClientSideTargetResolution");}}D.resolve(r);}).fail(D.reject.bind(D));return D.promise();};this._serializeMatchingResult=function(m,I){var r=m.inbound.resolutionResult;return["applicationType","ui5ComponentName","url","additionalInformation","text"].map(function(k){if(I){return r.hasOwnProperty(k)?k+":"+r[k]:"";}return r.hasOwnProperty(k)?r[k]:"";}).join("");};this._getMatchingInbounds=function(s,I,e){var a=this,d=new jQuery.Deferred(),r=new jQuery.Deferred(),R=new jQuery.Deferred();function w(b){var C=jQuery.sap.log.getLevel();if(C>=jQuery.sap.log.Level.DEBUG){var j=C>=jQuery.sap.log.Level.TRACE;b(j);}}function U(k,v){return this[k]===undefined?"<undefined>":v;}var f=function(){var m=[],M={},P=[],b=[],n={};w(function(){jQuery.sap.log.debug("Intent to navigate to is: \"#"+((s||{}).semanticObject||"")+"-"+((s||{}).action||"")+"\" with parameters"+"\n"+JSON.stringify(s.params,U,"   "),null,"sap.ushell.services.ClientSideTargetResolution");});b=I;if(e){b=I.filter(function(o){return!o.tileResolutionResult||!o.tileResolutionResult.isCustomTile;});}b.forEach(function(o){var j=a._matchToInbound(s,o,{},M);if(j.matches){m.push(j);P.push(o);}else{w(function(){if(!n[j.noMatchReason]){n[j.noMatchReason]=[];}n[j.noMatchReason].push("#"+(j.inbound||{}).semanticObject+"-"+(j.inbound||{}).action+(j.noMatchDebug?"|"+j.noMatchDebug:""));});}});w(function(j){if(j){Object.keys(n).forEach(function(k){jQuery.sap.log.debug(k+": "+n[k].join("; "),null,"sap.ushell.services.ClientSideTargetResolution");});}});if(jQuery.isEmptyObject(M)){r.resolve(m);}else{w(function(j){jQuery.sap.log.debug(j?"A rematch is required because the following user defaults need to be determined:"+"\n"+Object.keys(M).join("\n"):"A rematch is required because one or more user defaults need to be determined.",null,"sap.ushell.services.ClientSideTargetResolution");});sap.ushell.Container.getService("ReferenceResolver").resolveReferences(Object.keys(M)).done(function(o){R.resolve(o,P);}).fail(function(E){jQuery.sap.log.error("Failed to resolve all references",E,"sap.ushell.services.ClientSideTargetResolution");r.resolve([]);});}};if(sap.ushell.utils.getParameterValueBoolean("sap-ushell-cstr-timeout")){setTimeout(f,0);}else{f();}R.done(function(k,P){w(function(j){jQuery.sap.log.debug(j?"Rematching with the following resolved user defaults:"+JSON.stringify(k,U,"   "):"Rematching with resolved user defaults.",null,"sap.ushell.services.ClientSideTargetResolution");});var b=[],m={};P.forEach(function(o){var M=a._matchToInbound(s,o,k,m);if(M.matches){b.push(M);}});if(jQuery.isEmptyObject(m)){r.resolve(b);}else{jQuery.sap.log.error("Still obtained unknown references during rematch",JSON.stringify(m,U,"   "),"sap.ushell.services.ClientSideTargetResolution");d.reject("Rematching returned unknown references!");}});r.done(function(P){a._sortMatchingResultsDeterministic(P);w(function(b){if(P.length===0){w(function(){jQuery.sap.log.debug("The intent did not match any inbounds",null,"sap.ushell.services.ClientSideTargetResolution");});return;}var T=0,j=function(m,v){return(m==="_original")?undefined:U.call(this,m,v);},k=P.map(function(m){var C="";T++;if(b){C=" "+(m["sap-priority"]||"")+" Priority: "+(m["sap-priority"]?"sap-priority : "+m["sap-priority"]:"")+m.priorityString+" Signature: "+a._compactSignatureNotation((m.inbound||{}).signature)+" Deterministic blob: "+a._serializeMatchingResult(m,true);}return T+". #"+(m.inbound||{}).semanticObject+"-"+(m.inbound||{}).action+C;}).join("\n"),l=b?JSON.stringify(P[0],U,"   "):JSON.stringify(P[0].resolutionResult||P[0],j,"   ");jQuery.sap.log.debug("Intent has matched the following inbounds (in priority): \n"+k,"\nTop matched inbound resolves to:"+l,"sap.ushell.services.ClientSideTargetResolution");});d.resolve(P);});return d.promise();};this._sortMatchingResultsDeterministic=function(m){var a=this;m.sort(function(M,o){if((M["sap-priority"]||0)-(o["sap-priority"]||0)!==0){return-((M["sap-priority"]||0)-(o["sap-priority"]||0));}if(M.priorityString<o.priorityString){return 1;}if(M.priorityString>o.priorityString){return-1;}return(a._serializeMatchingResult(M)<a._serializeMatchingResult(o))?1:-1;});};this._isIntentSupportedOne=function(I,a){var d=new jQuery.Deferred(),s=this._getURLParsing().parseShellHash(I);if(I==="#"){d.resolve(true);return d.promise();}if(s===undefined){jQuery.sap.log.error("Could not parse shell hash '"+I+"'","please specify a valid shell hash","sap.ushell.services.ClientSideTargetResolution");return d.reject().promise();}s.formFactor=sap.ushell.utils.getFormFactor();this._getMatchingInbounds(s,a,true).done(function(T){d.resolve(T.length>0);}).fail(function(){d.reject();});return d.promise();};this.isIntentSupported=function(I){var a=this,d=new jQuery.Deferred();this._ensureInbounds().done(function(b){a._isIntentSupported(I,b).done(d.resolve.bind(d)).fail(d.reject.bind(d));}).fail(d.reject.bind(d));return d.promise();};this._isIntentSupported=function(I,a){var b=this,d=new jQuery.Deferred(),s={};d.resolve();function e(f,j){s[f]={supported:j};}I.forEach(function(f){var n=b._isIntentSupportedOne(f,a);n.fail(function(E){e(f,false);});n.done(function(R){e(f,R);});d=jQuery.when(d,n);});var r=new jQuery.Deferred();d.done(function(){r.resolve(s);}).fail(function(){r.reject.bind(d);});return r.promise();};this.getUserDefaultParameterNames=function(){var a=this,d=new jQuery.Deferred();this._ensureInbounds().done(function(I){var r;try{r=a._getUserDefaultParameterNames(I);d.resolve(r);}catch(e){d.reject("Cannot get user default parameters from inbounds: "+e);}}).fail(d.reject.bind(d));return d.promise();};this._getUserDefaultParameterNames=function(I){var r={simple:{},extended:{}};I.forEach(function(T){var s=T.signature&&T.signature.parameters||[];Object.keys(s).forEach(function(P){var o=s[P],R,e,a,b;if(o){if(o.filter&&o.filter.format==="reference"){a=o.filter.value;}else if(o.defaultValue&&o.defaultValue.format==="reference"){a=o.defaultValue.value;}if(typeof a==="string"){b=sap.ushell.Container.getService("ReferenceResolver");R=b.extractUserDefaultReferenceName(a);if(typeof R==="string"){r.simple[R]={};}e=b.extractExtendedUserDefaultReferenceName(a);if(typeof e==="string"){r.extended[e]={};}}}});});return r;};this._compactSignatureNotation=function(s){var f=s||{};var P=f.parameters||{},T={optional:"[FORMAT]",required:"FORMAT"},F={regexp:"/VALUE/",reference:"@VALUE",value:"VALUE",plain:"VALUE",_unknown:"?VALUE"},a={allowed:"<+>",notallowed:"<->",ignored:"<o>",_unknown:"<?>"};if(jQuery.isEmptyObject(P)){return"<no params>"+(a[f.additionalParameters||"_unknown"]);}var r=[];Object.keys(P).forEach(function(b){var o=P[b],d=o.required?"required":"optional",e=o.filter&&o.filter.value,j=o.defaultValue&&o.defaultValue.value,k=(o.filter&&o.filter.format)||"plain",l=(o.defaultValue&&o.defaultValue.format)||"plain";var v=[],m=F[k]||F._unknown,n=F[l]||F._unknown;if(e){v.push(T["required"].replace("FORMAT",m.replace("VALUE",e)));}if(j){v.push(T["optional"].replace("FORMAT",n.replace("VALUE",j)));}r.push(T[d].replace("FORMAT",b+":"+v.join("")));});return r.join(";")+(a[f.additionalParameters||"_unknown"]);};this.getEasyAccessSystems=function(){var e={},d;d=sap.ushell.utils.getFormFactor();if(!H){H=new jQuery.Deferred();this._ensureInbounds().done(function(I){I.forEach(function(o){var s;if(o&&o.semanticObject&&o.semanticObject==="Shell"&&o.action&&(o.action==="startGUI"||o.action==="startWDA")&&o.deviceTypes&&d!==undefined&&o.deviceTypes[d]){if(jQuery.isPlainObject(o.signature.parameters["sap-system"])&&o.signature.parameters["sap-system"].hasOwnProperty("filter")){s=jQuery.sap.getObject("signature.parameters.sap-system.filter.value",undefined,o);}if(typeof s==="string"){if(!e[s]){e[s]={text:o.title,appType:{}};}else if(o.action==="startGUI"){e[s].text=o.title;}if(o.action==="startGUI"){e[s].appType.TR=true;}else if(o.action==="startWDA"){e[s].appType.WDA=true;}}}});H.resolve(e);}).fail(H.reject.bind(H));}return H.promise();};};sap.ushell.services.ClientSideTargetResolution.hasNoAdapter=false;}());};if(!jQuery.sap.isDeclared('sap.ushell.services.CommonDataModel')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.CommonDataModel");sap.ushell.services.CommonDataModel=function(a,c,p,s){jQuery.sap.require("sap.ushell.services.CommonDataModel.PersonalizationProcessor");jQuery.sap.require("sap.ushell.services.ClientSideTargetResolution");var t=this,S=new jQuery.Deferred();function f(m){S.reject(m);}this._oAdapter=a;this._oPersonalizationProcessor=new sap.ushell.services.CommonDataModel.PersonalizationProcessor();this._oSitePromise=S.promise();a.getSite().done(function(o){t._oOriginalSite=jQuery.extend(true,{},o);a.getPersonalization().done(function(P){t._oPersonalizationProcessor.mixinPersonalization(o,P).done(function(b){t._oPersonalizedSite=b;S.resolve(t._oPersonalizedSite);}).fail(f);}).fail(f);}).fail(f);};sap.ushell.services.CommonDataModel.prototype.getHomepageGroups=function(){var d=new jQuery.Deferred();this._oSitePromise.then(function(s){var g=(s&&s.site&&s.site.payload&&s.site.payload.groupsOrder)?s.site.payload.groupsOrder:[];d.resolve(g);});return d.promise();};sap.ushell.services.CommonDataModel.prototype.getGroups=function(){var d=new jQuery.Deferred();this._oSitePromise.then(function(s){var g=[];Object.keys(s.groups).forEach(function(k){g.push(s.groups[k]);});d.resolve(g);});return d.promise();};sap.ushell.services.CommonDataModel.prototype.getGroup=function(i){var d=new jQuery.Deferred();this._oSitePromise.then(function(s){var g=s.groups[i];if(g){d.resolve(g);}else{d.reject("Group "+i+" not found");}});return d.promise();};sap.ushell.services.CommonDataModel.prototype.getSite=function(){return this._oSitePromise;};sap.ushell.services.CommonDataModel.prototype.getGroupFromOriginalSite=function(g){var d=new jQuery.Deferred();if(typeof g==="string"&&this._oOriginalSite&&this._oOriginalSite.groups&&this._oOriginalSite.groups[g]){d.resolve(jQuery.extend(true,{},this._oOriginalSite.groups[g]));}else{d.reject("Group does not exist in original site.");}return d.promise();};sap.ushell.services.CommonDataModel.prototype.save=function(){var d=new jQuery.Deferred(),t=this;this._oPersonalizationProcessor.extractPersonalization(this._oPersonalizedSite,this._oOriginalSite).done(function(e){if(e){t._oAdapter._storePersonalizationData(e).done(function(){d.resolve();}).fail(function(m){d.reject(m);});}else{d.resolve();}});return d.promise();};sap.ushell.services.CommonDataModel.prototype.hasNoAdapter=false;}());};if(!jQuery.sap.isDeclared('sap.ushell.services.CommonDataModel.PersonalizationProcessor')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.CommonDataModel.PersonalizationProcessor");sap.ushell.services.CommonDataModel.PersonalizationProcessor=function(){};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._getItemIndex=function(i,I){var r;for(r=0;r<i.length;r++){if(i[r].id===I){break;}}r=(r>=i.length)?-1:r;return r;};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._applyRenameGroup=function(g,n,o){var G,b=false;if(!n){return false;}if(g&&o&&o.groups&&o.groups[g]){G=o.groups[g];if(G.identification&&G.identification.title){o.groups[g].identification.title=n;b=true;}}return b;};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._applyGroupVisibility=function(g,G,o){var b=false;if(G===undefined){return false;}if(g&&o&&o.groups&&o.groups[g]){o.groups[g].identification.isVisible=G;b=true;}return b;};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype.mixinPersonalization=function(o,p){var d=new jQuery.Deferred(),t=this;if(!p||jQuery.isEmptyObject(p)){return d.resolve(o).promise();}if(p.groups){Object.keys(p.groups).forEach(function(g){var G=p.groups[g];if(o.groups[g]){if(G.identification){if(G.identification.title){t._applyRenameGroup(g,G.identification.title,o);}if(G.identification.hasOwnProperty("isVisible")&&G.identification.isVisible===false){t._applyGroupVisibility(g,false,o);}}}});}this._applyAddGroups(o,p);if(p.removedGroups&&jQuery.isArray(p.removedGroups)){p.removedGroups.forEach(function(g){t._applyRemoveGroup(o,g);});}this._applyMoveGroup(o,p);this._applyItemChanges(o,p);this._applyTileSettings(o,p);return d.resolve(o).promise();};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._applyAddGroups=function(o,p){var n=[];o.site=o.site||{};o.site.payload=o.site.payload||{};o.site.payload.groupsOrder=o.site.payload.groupsOrder||[];o.groups=o.groups||{};if(jQuery.isArray(p.groupOrder)){o.site.payload.groupsOrder.forEach(function(g){if(p.groupOrder.indexOf(g)===-1){if((p.removedGroups&&p.removedGroups.indexOf(g)===-1)||!p.removedGroups){n.push(g);}}});}if(jQuery.isArray(p.groupOrder)&&p.addedGroups&&Object.keys(p.addedGroups).length>0){Object.keys(p.addedGroups).forEach(function(g){o.groups[g]=p.addedGroups[g];o.groups[g].payload.isPreset=false;});o.site.payload.groupsOrder=p.groupOrder;}n.forEach(function(N){o.site.payload.groupsOrder.push(N);});};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._checkRenameGroup=function(g,p,o,P){if(g&&p&&o){if(o[g]){if(p[g].identification.title!==o[g].identification.title){P=P||{};P.groups=P.groups||{};P.groups[g]=P.groups[g]||{};P.groups[g].identification=P.groups[g].identification||{};P.groups[g].identification.title=p[g].identification.title;}}}return P;};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._checkTileSettings=function(p,P){if(!p.modifiedTiles){return;}P.modifiedTiles=p.modifiedTiles;};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._applyTileSettings=function(s,p){var g,m;if(!p.modifiedTiles){return;}g=Object.keys(s.groups).map(function(k){return this[k];},s.groups);m=Object.keys(p.modifiedTiles).map(function(k){return this[k];},p.modifiedTiles);g.some(function(G){G.payload.tiles.some(function(t){var P;m.some(function(u,i){if(u.id===t.id){if(u.title!==undefined){t.title=u.title;}if(u.subTitle!==undefined){t.subTitle=u.subTitle;}P=i;return true;}return false;});if(P!==undefined){m.splice(P,1);}return m.length===0;});return m.length===0;});s.modifiedTiles=p.modifiedTiles;};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._checkGroupVisibility=function(g,p,o,P){if(g&&p&&o){if(o[g]){if(p[g].identification.isVisible!==o[g].identification.isVisible&&typeof p[g].identification.isVisible==="boolean"){P=P||{};P.groups=P.groups||{};P.groups[g]=P.groups[g]||{};P.groups[g].identification=P.groups[g].identification||{};P.groups[g].identification.isVisible=p[g].identification.isVisible;}}}return P;};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._addGroupToPersonalizationDelta=function(p,P,g){var s=false,G,n;if(p&&p.site&&p.site.payload&&p.site.payload.groupsOrder&&p.groups&&g&&p.groups[g]&&P){G=p.site.payload.groupsOrder;n=p.groups[g];P.addedGroups=P.addedGroups||{};P.addedGroups[g]={};P.addedGroups[g].identification=jQuery.extend({},n.identification);P.addedGroups[g].payload=jQuery.extend({},n.payload);P.addedGroups[g].payload.tiles=[];P.groupOrder=G;s=true;}return s;};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype.extractPersonalization=function(p,o){var d=new jQuery.Deferred(),P,a={},O,e,t=this;if(p&&p.groups&&o&&o.groups){P=p.groups;O=o.groups;e=this._getExtractHelperObject(o,p,a);Object.keys(O).forEach(function(g){t._checkRemoveGroup(p,a,g);t._extractFromOriginalSiteOneGroup(o,e,g,"tiles");});Object.keys(P).forEach(function(g){if(O[g]){t._checkRenameGroup(g,P,O,a);t._checkGroupVisibility(g,P,O,a);}else{t._addGroupToPersonalizationDelta(p,a,g);}t._extractFromPersonalizedSiteOneGroup(p,e,g,"tiles");});this._checkMoveGroup(p,o,a);this._checkTileSettings(p,a);this._cleanupRemovedGroups(o,a);if(e.oPersonalizationDelta.movedTiles&&jQuery.isEmptyObject(e.oPersonalizationDelta.movedTiles)){delete(e.oPersonalizationDelta.movedTiles);}}return d.resolve(a).promise();};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._checkRemoveGroup=function(p,P,o){var s=false;if(p&&p.groups&&P&&o){if(!p.groups[o]){P.removedGroups=P.removedGroups||[];P.groupOrder=P.groupOrder||[];if(P.removedGroups.indexOf(o)===-1){P.removedGroups.push(o);}if(p.site&&p.site.payload&&p.site.payload.groupsOrder&&jQuery.isArray(p.site.payload.groupsOrder)){P.groupOrder=p.site.payload.groupsOrder.slice(0);}}s=true;}return s;};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._applyRemoveGroup=function(o,g){var O,G,i;if(o&&o.groups&&o.site&&o.site.payload&&o.site.payload.groupsOrder&&g){O=o.groups;G=o.site.payload.groupsOrder;i=G.indexOf(g);if(!(i===-1)){G.splice(i,1);delete(O[g]);return true;}}return false;};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._checkMoveGroup=function(p,o,P){var a,O,b=false,s=false;if(p.site&&p.site.payload&&jQuery.isArray(p.site.payload.groupsOrder)&&o.site&&o.site.payload&&jQuery.isArray(o.site.payload.groupsOrder)){a=p.site.payload.groupsOrder;O=o.site.payload.groupsOrder;if(a.length===O.length){b=(function(){var S=false,i;for(i=0;i<O.length;i++){if(O[i]!==a[i]){S=true;break;}}return S;})();if(b){P.groupOrder=a;s=true;}}}return s;};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._applyMoveGroup=function(o,p){var s=false;if(jQuery.isArray(p.groupOrder)){o.site=o.site||{};o.site.payload=o.site.payload||{};if(!jQuery.isArray(o.site.payload.groupsOrder)){o.site.payload.groupsOrder=[];}if(o.site.payload.groupsOrder.length===p.groupOrder.length){o.site.payload.groupsOrder=p.groupOrder;s=true;}}return s;};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._getHashedItemsFromSite=function(s){var r=null;if(s&&s.groups){if(Object.keys(s.groups).length>0){r={};Object.keys(s.groups).forEach(function(g){var G=s.groups[g],a;r[g]={};if(G.payload&&jQuery.isArray(G.payload.tiles)){a=G.payload.tiles;a.forEach(function(i,I){var b;if(i.id){b=i.id;r[g][b]={};r[g][b].iIndex=I;r[g][b].oItem=i;}});}});}}return r;};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._getExtractHelperObject=function(o,p,P){var r=null;r={};r.oHashedItemsOriginal=this._getHashedItemsFromSite(o);r.oHashedItemsPersonalized=this._getHashedItemsFromSite(p);r.oPersonalizationDelta=P;return r;};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._extractFromOriginalSiteOneGroup=function(o,e,g,i){var s=false,O,m,M;i=i?i:"tiles";M=function(a,f){m[a]=m[a]?m[a]:{};m[a].fromGroup=f;m[a].toGroup=null;};if(e&&e.oHashedItemsPersonalized&&e.oPersonalizationDelta&&o&&o.groups&&o.groups[g]&&o.groups[g].payload&&jQuery.isArray(o.groups[g].payload[i])){O=o.groups[g].payload[i];e.oPersonalizationDelta.movedTiles=e.oPersonalizationDelta.movedTiles?e.oPersonalizationDelta.movedTiles:{};m=e.oPersonalizationDelta.movedTiles;if(e.oHashedItemsPersonalized[g]){O.forEach(function(I){if(!e.oHashedItemsPersonalized[g][I.id]){M(I.id,g);}});s=true;}else{O.forEach(function(I){M(I.id,g);});s=true;}}return s;};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._handleItemChangeExtract=function(e,g,i){return false;};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._extractFromPersonalizedSiteOneGroup=function(p,e,g,i){var s=false,m,t,T=false,P,a=this;i=i?i:"tiles";if((i!=="tiles")&&(i!=="links")){return s;}if(e&&e.oHashedItemsOriginal&&e.oPersonalizationDelta&&p&&p.groups&&p.groups[g]&&p.groups[g].payload&&jQuery.isArray(p.groups[g].payload[i])){P=p.groups[g].payload[i];e.oPersonalizationDelta.movedTiles=e.oPersonalizationDelta.movedTiles?e.oPersonalizationDelta.movedTiles:{};m=e.oPersonalizationDelta.movedTiles;t=[];P.forEach(function(I,b){t.push(I.id);if(e.oHashedItemsOriginal[g]&&e.oHashedItemsOriginal[g][I.id]){if(m[I.id]){delete(m[I.id]);}if(e.oHashedItemsOriginal[g][I.id].iIndex!==b){T=true;}a._handleItemChangeExtract(e,g,i);}else{T=true;if(m[I.id]){if(m[I.id].fromGroup&&(m[I.id].fromGroup!==g)){if(!m[I.id].toGroup){m[I.id].toGroup=g;a._handleItemChangeExtract(e,g,i);}}}else{m[I.id]={};m[I.id].fromGroup=null;m[I.id].toGroup=g;m[I.id].item=I;}}});if(T){e.oPersonalizationDelta.groups=e.oPersonalizationDelta.groups||{};e.oPersonalizationDelta.groups[g]=e.oPersonalizationDelta.groups[g]||{};e.oPersonalizationDelta.groups[g].payload=e.oPersonalizationDelta.groups[g].payload||{};e.oPersonalizationDelta.groups[g].payload.tileOrder=t;}s=true;}return s;};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._cleanupRemovedGroups=function(o,p){var t,m;if(p.removedGroups&&p&&jQuery.isArray(p.removedGroups)&&(p.removedGroups.length>0)){p.removedGroups.forEach(function(g){if(o&&o.groups&&o.groups[g]&&o.groups[g].payload&&jQuery.isArray(o.groups[g].payload.tiles)){t=o.groups[g].payload.tiles;t.forEach(function(T){if(p.movedTiles){m=p.movedTiles[T.id];if(m&&m.fromGroup&&(m.fromGroup===g)&&!m.toGroup){delete(p.movedTiles[T.id]);}}});}});}};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._setItemOrderOnSiteCollection=function(o,i){var s=true,S=o.length,a,b={},I,c,C,f;if(!jQuery.isArray(o)||!jQuery.isArray(o)||(o.length!==i.length)){return false;}a=o.splice(0,o.length);for(I=0;I<i.length;I++){C=i[I];c=a.shift();if(c&&C===c.id){o.push(c);}else if(b[C]){o.push(b[C]);delete(b[C]);if(c){b[c.id]=c;}}else if(c){b[c.id]=c;f=false;while(a.length>0){c=a.shift();if(C===c.id){o.push(c);f=true;break;}else{b[c.id]=c;}}if(!f){s=false;}}}if(o.length!==S){s=false;}return s;};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._setItemOrderOnSiteGroupForItemType=function(o,d,i){var s=true,t,I;if((i==="tiles")||(i==="links")){I=(i==="tiles")?"tileOrder":"linkOrder";}else{return false;}if(d.payload&&jQuery.isArray(d.payload[I])&&(d.payload[I].length>0)){if(o.payload&&jQuery.isArray(o.payload[i])&&(o.payload[i].length>0)){t=this._setItemOrderOnSiteCollection(o.payload[i],d.payload[I]);if(!t){s=false;}}else{s=false;}}return s;};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._setItemOrderOnSite=function(o,p){var s=true,t,a=this;if(o.groups&&p.groups){Object.keys(p.groups).forEach(function(g){if(p.groups[g]&&o.groups[g]){t=a._setItemOrderOnSiteGroupForItemType(o.groups[g],p.groups[g],"tiles");if(!t){s=false;}t=a._setItemOrderOnSiteGroupForItemType(o.groups[g],p.groups[g],"links");if(!t){s=false;}}});}return s;};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._applyMoveItemsWithoutOrder=function(o,p,i){var s=true,t,T,I="tileOrder",d,a,b,O=[],c=this;function f(C,g){var s=true;if(o.groups[g]&&o.groups[g].payload&&p.groups&&p.groups[g]&&p.groups[g].payload&&jQuery.isArray(p.groups[g].payload[I])&&(p.groups[g].payload[I].length>0)){if(!jQuery.isArray(o.groups[g].payload[i])){o.groups[g].payload[i]=[];}o.groups[g].payload[i].push(C);}else{s=false;}return s;}if((i==="tiles")||(i==="links")){T=(i==="tiles")?"movedTiles":"movedLinks";I=(i==="tiles")?"tileOrder":"linkOrder";}else{return false;}if(!o||!o.groups||!o.site||!o.site.payload||!jQuery.isArray(o.site.payload.groupsOrder)||!p){return false;}if(p[T]){Object.keys(p[T]).forEach(function(e){d=p[T][e];if(d.fromGroup){if(d.toGroup){if(d.fromGroup!==d.toGroup){if(o.groups[d.fromGroup]&&o.groups[d.fromGroup].payload&&jQuery.isArray(o.groups[d.fromGroup].payload[i])){O=o.groups[d.fromGroup].payload[i];a=c._getItemIndex(O,e);if(a>=0){b=O.splice(a,1);t=f(b[0],d.toGroup);if(!t){s=false;}}else{s=false;}}else{s=false;}}else{s=false;}}else{if(o.groups[d.fromGroup]&&o.groups[d.fromGroup].payload&&jQuery.isArray(o.groups[d.fromGroup].payload[i])){O=o.groups[d.fromGroup].payload[i];a=c._getItemIndex(O,e);if(a>=0){O.splice(a,1);}else{s=false;}}else{s=false;}}}else if(d.toGroup){if(d.item&&!jQuery.isEmptyObject(d.item)){t=f(d.item,d.toGroup);if(!t){s=false;}}else{s=false;}}else{s=false;}});}return s;};sap.ushell.services.CommonDataModel.PersonalizationProcessor.prototype._applyItemChanges=function(o,p){var s=true,S;S=this._applyMoveItemsWithoutOrder(o,p,"tiles");if(!S){s=false;}S=this._applyMoveItemsWithoutOrder(o,p,"links");if(!S){s=false;}if(p.groups){S=this._setItemOrderOnSite(o,p);if(!S){s=false;}}return s;};}());};if(!jQuery.sap.isDeclared('sap.ushell.services.Container')){jQuery.sap.declare('sap.ushell.services.Container');(function(){"use strict";var S="sap.ushell.services.Container",b="sap.ushell.Container.dirtyState.",c,p,f;jQuery.sap.declare(S);if(!jQuery.sap.isDeclared('sap.ushell.utils')){(function(){"use strict";jQuery.sap.declare("sap.ushell.utils");sap.ushell.utils={};sap.ushell.utils.isArray=function(o){return Object.prototype.toString.apply(o)==='[object Array]';};sap.ushell.utils.getMember=function(o,a){var P=a.split("."),n=o;if(!o){return undefined;}P.forEach(function(s){if(typeof n!=="object"){return undefined;}n=n[s.replace(/[|]/g,".")];});return n;};sap.ushell.utils.addTime=function(i,I,e){if(!window["sap-ushell-startTime"]){window["sap-ushell-startTime"]=Date.now();}var s=window["sap-ushell-startTime"];e=e||Date.now();if(e<s){e=s+1;}jQuery.sap.measure.add("sap.ushell.fromStart."+i,I,s,e,e-s,e-s);};sap.ushell.utils.Error=function(m,s){this.name="sap.ushell.utils.Error";this.message=m;jQuery.sap.log.error(m,null,s);};sap.ushell.utils.Error.prototype=new Error();sap.ushell.utils.localStorageSetItem=function(k,v,l){var E;try{localStorage.setItem(k,v);if(l){E=document.createEvent("StorageEvent");E.initStorageEvent("storage",false,false,k,"",v,"",localStorage);dispatchEvent(E);}}catch(e){jQuery.sap.log.warning("Error calling localStorage.setItem(): "+e,null,"sap.ushell.utils");}};sap.ushell.utils.getLocalStorage=function(){return window.localStorage;};sap.ushell.utils.generateUniqueId=function(t){var u,e,i;if(jQuery.isArray(t)){e=t;i=function(G){return e.indexOf(G)===-1;};}else{i=t;}do{u=jQuery.sap.uid();}while(!i(u));return u;};sap.ushell.utils.reload=function(){location.reload();};sap.ushell.utils.calculateOrigin=function(D){var u;if(D.origin){return D.origin;}if(D.protocol&&D.hostname){return D.protocol+"//"+D.hostname+(D.port?':'+D.port:'');}if(D.href){u=new URI(D.href);return u.protocol()+"://"+u.hostname()+(u.port()?':'+u.port():'');}};sap.ushell.utils.getPrivateEpcm=function(){if(window.external&&window.external&&typeof window.external.getPrivateEpcm!=="undefined"){return window.external.getPrivateEpcm();}return undefined;};sap.ushell.utils.hasNativeNavigationCapability=function(){return sap.ushell.utils.isFeatureBitEnabled(1);};sap.ushell.utils.hasNativeLogoutCapability=function(){return sap.ushell.utils.isFeatureBitEnabled(2);};sap.ushell.utils.isFeatureBitEnabled=function(F){var s="0",P;P=sap.ushell.utils.getPrivateEpcm();if(P){try{s=P.getNwbcFeatureBits();jQuery.sap.log.debug("Detected epcm getNwbcFeatureBits returned feature bits: "+s);}catch(e){jQuery.sap.log.error("failed to get feature bit vector via call getNwbcFeatureBits on private epcm object",e.stack,"sap.ushell.utils");}}return(parseInt(s,16)&F)>0;};sap.ushell.utils.isApplicationTypeNWBCRelated=function(a){return a==="NWBC"||a==="TR";};sap.ushell.utils.appendUserIdToUrl=function(P,u){var U=sap.ushell.Container.getService("UserInfo").getUser().getId(),s=u.indexOf("?")>=0?"&":"?";return u+s+P+"="+U;};sap.ushell.utils.isNativeWebGuiNavigation=function(R){if(this.hasNativeNavigationCapability()&&R&&R.applicationType==="TR"){return true;}return false;};sap.ushell.utils.Map=function(){this.entries={};};sap.ushell.utils.Map.prototype.put=function(k,v){var o=this.get(k);this.entries[k]=v;return o;};sap.ushell.utils.Map.prototype.containsKey=function(k){if(typeof k!=="string"){throw new sap.ushell.utils.Error("Not a string key: "+k,"sap.ushell.utils.Map");}return Object.prototype.hasOwnProperty.call(this.entries,k);};sap.ushell.utils.Map.prototype.get=function(k){if(this.containsKey(k)){return this.entries[k];}};sap.ushell.utils.Map.prototype.keys=function(){return Object.keys(this.entries);};sap.ushell.utils.Map.prototype.remove=function(k){delete this.entries[k];};sap.ushell.utils.Map.prototype.toString=function(){var R=['sap.ushell.utils.Map('];R.push(JSON.stringify(this.entries));R.push(')');return R.join('');};sap.ushell.utils.getParameterValueBoolean=function(P,s){var a=jQuery.sap.getUriParameters(s).mParams&&jQuery.sap.getUriParameters(s).mParams[P],t=["true","x"],F=["false",""],v;if(!a||a.length===0){return undefined;}v=a[0].toLowerCase();if(t.indexOf(v)>=0){return true;}if(F.indexOf(v)>=0){return false;}return undefined;};sap.ushell.utils.call=function(s,F,a){var m;if(a){setTimeout(function(){sap.ushell.utils.call(s,F,false);},0);return;}try{s();}catch(e){m=e.message||e.toString();jQuery.sap.log.error("Call to success handler failed: "+m,e.stack,"sap.ushell.utils");if(F){F(m);}}};sap.ushell.utils.handleTilesVisibility=function(){var s=new Date(),t=sap.ushell.utils.getVisibleTiles(),a,l;if(t&&t.length){l=sap.ushell.Container.getService("LaunchPage");t.forEach(function(T){var e=sap.ushell.utils.getTileObject(T);if(e!==null){l.setTileVisible(e,T.isDisplayedInViewPort);}});jQuery.sap.log.debug("Visible Tiles: "+t.filter(function(T){return T.isDisplayedInViewPort;}).length);jQuery.sap.log.debug("NonVisible Tiles: "+t.filter(function(T){return!T.isDisplayedInViewPort;}).length);}a=new Date()-s;jQuery.sap.log.debug("Start time is: "+s+" and duration is: "+a);};sap.ushell.utils.refreshTiles=function(){var t=sap.ushell.utils.getVisibleTiles(),l;if(t&&t.length){l=sap.ushell.Container.getService("LaunchPage");t.forEach(function(T){var a=sap.ushell.utils.getTileObject(T);if(a!==null){l.refreshTile(a);}});}};sap.ushell.utils.setTilesNoVisibility=function(){var t=sap.ushell.utils.getVisibleTiles(),l;if((typeof t!=="undefined")&&t.length>0){l=sap.ushell.Container.getService("LaunchPage");t.forEach(function(T){l.setTileVisible(sap.ushell.utils.getTileObject(T),false);});jQuery.sap.log.debug("Visible Tiles: "+t.filter(function(T){return T.isDisplayedInViewPort;}).length);jQuery.sap.log.debug("NonVisible Tiles: "+t.filter(function(T){return!T.isDisplayedInViewPort;}).length);}};sap.ushell.utils.getBasicHash=function(a){if(!sap.ushell.utils.validHash(a)){jQuery.sap.log.debug("Utils ; getBasicHash ; Got invalid hash");return false;}var u=sap.ushell.Container.getService("URLParsing"),s=u.parseShellHash(a);return s?s.semanticObject+"-"+s.action:a;};sap.ushell.utils.validHash=function(a){return(a&&a.constructor===String&&jQuery.trim(a)!=="");};sap.ushell.utils.handleTilesOpacity=function(m){jQuery.sap.require("sap.ui.core.theming.Parameters");var t,a,e,s=sap.ui.core.theming.Parameters.get("sapUshellTileBackgroundColor"),i=this.hexToRgb(s),k,l,R,n,o,q,u,v,w,x,y,U=sap.ushell.Container.getService("UserRecents");if(i){R="rgba("+i.r+","+i.g+","+i.b+",{0})";e=U.getAppsUsage();e.done(function(z){t=z.usageMap;k=jQuery('.sapUshellTile').not('.sapUshellTileFooter');var A=m.getProperty("/groups");m.setProperty('/animationRendered',true);for(y=0;y<k.length;y++){n=jQuery(k[y]);o=this.getBasicHash(n.find('.sapUshellTileBase').attr('data-targeturl'));if(o){l=this.convertToRealOpacity(t[o],z.maxUsage);q=R.replace("{0}",l);a=sap.ui.getCore().byId(n.attr('id'));u=a.getBindingContext();v=u.sPath.split('/');w=v[2];x=v[4];A[w].tiles[x].rgba=q;}}m.setProperty("/groups",A);}.bind(this));}};sap.ushell.utils.convertToRealOpacity=function(a,m){var o=[1,0.95,0.9,0.85,0.8],O=Math.floor(m/o.length),i;if(!a){return o[0];}if(!m){return o[o.length-1];}i=Math.floor((m-a)/O);return i<o.length?o[i]:o[o.length-1];};sap.ushell.utils.getCurrentHiddenGroupIds=function(m){var l=sap.ushell.Container.getService("LaunchPage"),G=m.getProperty('/groups'),H=[],s,a,e;for(a in G){e=G[a].isGroupVisible;if(G[a].object){s=l.getGroupId(G[a].object);}if(!e&&s!==undefined){H.push(s);}}return H;};sap.ushell.utils.hexToRgb=function(a){var i=!a||a[0]!='#'||(a.length!=4&&a.length!=7),e;a=!i&&a.length===4?'#'+a[1]+a[1]+a[2]+a[2]+a[3]+a[3]:a;e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null;};sap.ushell.utils.getFormFactor=function(){var s=sap.ui.Device.system;if(s.desktop){return s.SYSTEMTYPE.DESKTOP;}if(s.tablet){return s.SYSTEMTYPE.TABLET;}if(s.phone){return s.SYSTEMTYPE.PHONE;}};sap.ushell.utils.getVisibleTiles=function(){var n=document.body.clientHeight,o=sap.ui.getCore().byId("dashboardGroups"),N=sap.ui.getCore().byId("viewPortContainer"),a,t,e,i,T,k,l,m,q,s=jQuery('#shell-hdr').height(),u=[],G,I,v;if(o&&o.getGroups()&&N){G=jQuery(o.getDomRef());I=G?G.is(":visible"):false;v=o.getGroups();for(a=0;a<v.length;a=a+1){e=v[a];i=e.getTiles();if(i){for(t=0;t<i.length;t=t+1){T=i[t];if(!I||window.document.hidden){T.isDisplayedInViewPort=false;u.push(T);}else{k=jQuery(T.getDomRef());l=k.offset();if(l){m=k.offset().top;q=m+k.height();T.isDisplayedInViewPort=e.getVisible()&&(q>s)&&(m<n);u.push(T);}}}}}}return u;};sap.ushell.utils.getTileObject=function(u){var a=u.getBindingContext();return a.getObject()?a.getObject().object:null;};sap.ushell.utils.addBottomSpace=function(){var a=jQuery('#dashboardGroups').find('.sapUshellTileContainer:visible');var l=a.last(),e=jQuery(".sapUshellShellHead > div").height(),i=l.parent().height(),k=parseInt(l.find(".sapUshellContainerTitle").css("margin-top"),10),m=parseInt(jQuery('.sapUshellDashboardGroupsContainer').css("padding-bottom"),10),n;if(a.length===1){n=0;}else{n=jQuery(window).height()-e-i-k-m;n=(n<0)?0:n;}jQuery('.sapUshellDashboardGroupsContainer').css("margin-bottom",n+"px");};sap.ushell.utils.calcVisibilityModes=function(G,a){var i=true,I=true,e=sap.ushell.utils.groupHasVisibleTiles(G.tiles,G.links);if(!e&&(!a||(G.isGroupLocked)||(G.isDefaultGroup))){i=false;}if(!e&&(!a)){I=false;}return[i,I];};sap.ushell.utils.groupHasVisibleTiles=function(a,e){var v=false,t,i,k=!a?[]:a,l=!e?[]:e;k=k.concat(l);if(k.length===0){return false;}for(t=0;t<k.length;t=t+1){i=k[t];if(i.isTileIntentSupported){v=true;break;}}return v;};sap.ushell.utils.invokeUnfoldingArrayArguments=function(F,A){var e,D,P,R,t;if(!jQuery.isArray(A[0])){return F.apply(this,A);}e=A[0];if(e.length===0){return new jQuery.Deferred().resolve([]).promise();}D=new jQuery.Deferred();P=[];R=[];t=new jQuery.Deferred().resolve();e.forEach(function(n,i){if(!jQuery.isArray(n)){jQuery.sap.log.error("Expected Array as nTh Argument of multivalue invokation: first Argument must be array of array of arguments: single valued f(p1,p2), f(p1_2,p2_2), f(p1_3,p2_3) : multivalued : f([[p1,p2],[p1_2,p2_2],[p1_3,p2_3]]");throw new Error("Expected Array as nTh Argument of multivalue invokation: first Argument must be array of array of arguments: single valued f(p1,p2), f(p1_2,p2_2), f(p1_3,p2_3) : multivalued : f([[p1,p2],[p1_2,p2_2],[p1_3,p2_3]]");}var k=F.apply(this,n),l=new jQuery.Deferred();k.done(function(){var a=Array.prototype.slice.call(arguments);R[i]=a;l.resolve();}).fail(l.reject.bind(l));P.push(l.promise());t=jQuery.when(t,l);});jQuery.when.apply(jQuery,P).done(function(){D.resolve(R);}).fail(function(){D.reject("failure");});return D.promise();};sap.ushell.utils.isClientSideNavTargetResolutionEnabled=function(){var D=true,l;if(jQuery.sap.storage===undefined){l=window.localStorage.getItem("targetresolution-client");l=(l===false||l==="false"||l==="")?false:true;}else{l=jQuery.sap.storage(jQuery.sap.getObject("jQuery.sap.storage.Type.local"),"targetresolution").get("client");}if(l===""||l===false||sap.ushell.utils.getParameterValueBoolean("sap-ushell-nav-cs")===false){return false;}return D;};sap.ushell.utils._getCurrentDate=function(){return new Date();};sap.ushell.utils._convertToUTC=function(a){var u=Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds());return u;};sap.ushell.utils.formatDate=function(s){var i,n,t,D,H,m;i=sap.ushell.utils._convertToUTC(new Date(s));n=sap.ushell.utils._convertToUTC(sap.ushell.utils._getCurrentDate());t=n-i;D=parseInt(t/(1000*60*60*24),10);if(D>0){if(D===1){return sap.ushell.resources.i18n.getText("time_day",D);}return sap.ushell.resources.i18n.getText("time_days",D);}H=parseInt(t/(1000*60*60),10);if(H>0){if(H===1){return sap.ushell.resources.i18n.getText("time_hour",H);}return sap.ushell.resources.i18n.getText("time_hours",H);}m=parseInt(t/(1000*60),10);if(m>0){if(m===1){return sap.ushell.resources.i18n.getText("time_minute",m);}return sap.ushell.resources.i18n.getText("time_minutes",m);}return sap.ushell.resources.i18n.getText("just_now");};sap.ushell.utils.toExternalWithParameters=function(s,a,P){var o=sap.ushell.Container.getService("CrossApplicationNavigation"),t={},e={},i,T,k;t.target={semanticObject:s,action:a};if(P&&P.length>0){e={};for(i=0;i<P.length;i++){T=P[i].Key;k=P[i].Value;e[T]=k;}t.params=e;}o.toExternal(t);};sap.ushell.utils.moveElementInsideOfAnArray=function(a,n,e){var E,i;if(!a||n<0||e<0||typeof n!=="number"||typeof e!=="number"||n>a.length||e>a.length){return undefined;}else if(n===e){return a;}E=a[n];if(n<e){for(i=n;i<e;i++){a[i]=a[i+1];}}else if(n>e){for(i=n;i>e;i--){a[i]=a[i-1];}}a[e]=E;return a;};}());};function d(){close();}function r(){document.location="about:blank";}function g(P){if(p&&p[P]){return p[P];}return"sap.ushell.adapters."+P;}function h(s){return(c.services&&c.services[s])||{};}function j(n,s,P){var a=h(n).adapter||{},A=a.module||g(s.getPlatform())+"."+n+"Adapter";jQuery.sap.require(A);return new(jQuery.sap.getObject(A))(s,P,{config:a.config||{}});}function C(a){var E=new sap.ui.base.EventProvider(),k=false,R=[],o={},s="sap.ushell.Container."+a.getSystem().getPlatform()+".remoteSystem.",m={},G,l,L=sap.ushell.utils.getLocalStorage(),n=new sap.ushell.utils.Map(),q="sap.ushell.Container."+a.getSystem().getPlatform()+".sessionTermination",t=this;this.cancelLogon=function(){if(this.oFrameLogonManager){this.oFrameLogonManager.cancelXHRLogon();}};this.createRenderer=function(e){var i,w,x,y,z;e=e||c.defaultRenderer;if(!e){throw new Error("Missing renderer name");}z=(c.renderers&&c.renderers[e])||{};w=z.module||(e.indexOf(".")<0?"sap.ushell.renderers."+e+".Renderer":e);jQuery.sap.require(w);if(z.componentData&&z.componentData.config){i={config:z.componentData.config};}x=new(jQuery.sap.getObject(w))({componentData:i});if(x instanceof sap.ui.core.UIComponent){y=new sap.ui.core.ComponentContainer({component:x,height:"100%",width:"100%"});}else{y=x;}if(!(y instanceof sap.ui.core.Control)){throw new Error("Unsupported renderer type for name "+e);}o[e]=y;E.fireEvent("rendererCreated",{renderer:x});return y;};this.getRenderer=function(e){var i,w;e=e||c.defaultRenderer;if(e){i=o[e];}else{w=Object.keys(o);if(w.length===1){i=o[w[0]];}else{jQuery.sap.log.warning("getRenderer() - cannot determine renderer, because no default renderer is configured and multiple instances exist.",undefined,S);}}if(i instanceof sap.ui.core.ComponentContainer){return i.getComponentInstance();}return i;};this.DirtyState={CLEAN:"CLEAN",DIRTY:"DIRTY",MAYBE_DIRTY:"MAYBE_DIRTY",PENDING:"PENDING",INITIAL:"INITIAL"};this.getGlobalDirty=function(){var i,D=new jQuery.Deferred(),U=jQuery.sap.uid(),w,P=0,x=this.DirtyState.CLEAN;function y(){if(P===0||x===t.DirtyState.DIRTY){D.resolve(x);jQuery.sap.log.debug("getGlobalDirty() Resolving: "+x,null,"sap.ushell.Container");}}function z(A){if(A.key.indexOf(b)===0&&A.newValue!==t.DirtyState.INITIAL&&A.newValue!==t.DirtyState.PENDING){jQuery.sap.log.debug("getGlobalDirty() Receiving event key: "+A.key+" value: "+A.newValue,null,"sap.ushell.Container");if(A.newValue===t.DirtyState.DIRTY||A.newValue===t.DirtyState.MAYBE_DIRTY){x=A.newValue;}P-=1;y();}}try{L.setItem(U,"CHECK");L.removeItem(U);}catch(e){jQuery.sap.log.warning("Error calling localStorage.setItem(): "+e,null,"sap.ushell.Container");return D.resolve(this.DirtyState.MAYBE_DIRTY).promise();}if(G){throw new Error("getGlobalDirty already called!");}G=D;window.addEventListener('storage',z);D.always(function(){window.removeEventListener('storage',z);G=undefined;});for(i=L.length-1;i>=0;i-=1){w=L.key(i);if(w.indexOf(b)===0){if(L.getItem(w)==='PENDING'){L.removeItem(w);jQuery.sap.log.debug("getGlobalDirty() Cleanup of unresolved 'PENDINGS':"+w,null,"sap.ushell.Container");}else{P+=1;sap.ushell.utils.localStorageSetItem(w,this.DirtyState.PENDING,true);jQuery.sap.log.debug("getGlobalDirty() Requesting status for: "+w,null,"sap.ushell.Container");}}}y();setTimeout(function(){if(D.state()!=="resolved"){D.resolve('MAYBE_DIRTY');jQuery.sap.log.debug("getGlobalDirty() Timeout reached, - resolved 'MAYBE_DIRTY'",null,"sap.ushell.Container");}},P*2000);return D.promise();};this.getLogonSystem=function(){return a.getSystem();};this.getUser=function(){return a.getUser();};this.getDirtyFlag=function(){for(var i=0;i<R.length;i++){k=k||R[i].call();}return k;};this.setDirtyFlag=function(i){k=i;};this.registerDirtyStateProvider=function(D){if(typeof D!=="function"){throw new Error("fnDirty must be a function");}R.push(D);};this.getService=function(e,P){var i={},M,K,w,x,y,z,A;function B(D){var F=new jQuery.Deferred();if(!D){throw new Error("Missing system");}F.resolve(j(e,D,P));sap.ushell.Container.addRemoteSystem(D);return F.promise();}if(!e){throw new Error("Missing service name");}if(e.indexOf(".")>=0){throw new Error("Unsupported service name");}z=h(e);M=z.module||"sap.ushell.services."+e;K=M+"/"+(P||"");A={config:z.config||{}};if(!n.containsKey(K)){jQuery.sap.require(M);w=jQuery.sap.getObject(M);if(w.hasNoAdapter===true){x=new w(i,P,A);}else{y=j(e,a.getSystem(),P);i.createAdapter=B;x=new w(y,i,P,A);}n.put(K,x);return x;}return n.get(K);};function u(){var w,x,i,K;for(i=L.length-1;i>=0;i-=1){K=L.key(i);if(K.indexOf(s)===0){try{w=K.substring(s.length);x=JSON.parse(L.getItem(K));m[w]=new sap.ushell.System(x);}catch(e){L.removeItem(K);}}}return m;}function v(){function e(i,w,F){jQuery.sap.log.warning(i,null,"sap.ushell.Container");if(F){setTimeout(F.bind(null,i),5000);}return{abort:function(){return;}};}OData.read=function(i,w,F){return e("OData.read('"+(i&&i.Uri?i.requestUri:i)+"') disabled during logout processing",w,F);};OData.request=function(i,w,F){return e("OData.request('"+(i?i.requestUri:"")+"') disabled during logout processing",w,F);};}this.addRemoteSystem=function(e){var A=e.getAlias(),O=m[A];if(O){if(O.toString()===e.toString()){return;}jQuery.sap.log.warning("Replacing "+O+" by "+e,null,"sap.ushell.Container");}else{jQuery.sap.log.debug("Added "+e,null,"sap.ushell.Container");}m[A]=e;sap.ushell.utils.localStorageSetItem(s+A,e);};this.addRemoteSystemForServiceUrl=function(e){var M,i={baseUrl:";o="};if(!e||e.charAt(0)!=='/'||e.indexOf('//')===0){return;}M=/^[^?]*;o=([^\/;?]*)/.exec(e);if(M&&M.length>=2){i.alias=M[1];}e=e.replace(/;[^\/?]*/g,"");if(/^\/sap\/(bi|hana|hba)\//.test(e)){i.platform="hana";i.alias=i.alias||"hana";}else if(/^\/sap\/opu\//.test(e)){i.platform="abap";}if(i.alias&&i.platform){this.addRemoteSystem(new sap.ushell.System(i));}};this.attachLogoutEvent=function(F){E.attachEvent("Logout",F);};this.detachLogoutEvent=function(F){E.detachEvent("Logout",F);};this.attachRendererCreatedEvent=function(F){E.attachEvent("rendererCreated",F);};this.detachRendererCreatedEvent=function(F){E.detachEvent("rendererCreated",F);};this.logout=function(){var D=new jQuery.Deferred();function i(){a.logout(true).always(function(){L.removeItem(q);D.resolve();});}function w(){if(E.fireEvent("Logout",true)){i();}else{setTimeout(i,1000);}}function x(){var m,y=[];if(l){window.removeEventListener('storage',l);}sap.ushell.utils.localStorageSetItem(q,"pending");t._suppressOData();m=t._getRemoteSystems();Object.keys(m).forEach(function(A){try{y.push(j("Container",m[A]).logout(false));}catch(e){jQuery.sap.log.warning("Could not create adapter for "+A,e.toString(),"sap.ushell.Container");}L.removeItem(s+A);});jQuery.when.apply(jQuery,y).done(w);}if(typeof a.addFurtherRemoteSystems==='function'){a.addFurtherRemoteSystems().always(x);}else{x();}return D.promise();};this.setLogonFrameProvider=function(e){if(this.oFrameLogonManager){this.oFrameLogonManager.setLogonFrameProvider(e);}};this._closeWindow=d;this._redirectWindow=r;this._getRemoteSystems=u;this._suppressOData=v;sap.ui.getCore().getEventBus().subscribe("sap.ushell.Container","addRemoteSystemForServiceUrl",function(e,i,D){t.addRemoteSystemForServiceUrl(D);});if(typeof a.logoutRedirect==='function'){l=function(e){function i(){t._closeWindow();t._redirectWindow();}if(sap.ushell.Container!==t){return;}if(e.key.indexOf(s)===0&&e.newValue&&e.newValue!==L.getItem(e.key)){sap.ushell.utils.localStorageSetItem(e.key,e.newValue);}if(e.key===q){if(e.newValue==="pending"){t._suppressOData();if(E.fireEvent("Logout",true)){i();}else{setTimeout(i,1000);}}}};window.addEventListener('storage',l);}}sap.ushell.bootstrap=function(P,a){var A,e;if(sap.ushell.Container!==undefined){e=new Error("Unified shell container is already initialized - cannot initialize twice.\nStacktrace of first initialization:"+f);jQuery.sap.log.error(e,e.stack,S);throw e;}sap.ushell.Container=null;f=(new Error()).stack;c=jQuery.extend({},true,window["sap-ushell-config"]||{});p=a;if(typeof window["sap.ushell.bootstrap.callback"]==="function"){setTimeout(window["sap.ushell.bootstrap.callback"]);}if(c.modulePaths){Object.keys(c.modulePaths).forEach(function(m){jQuery.sap.registerModulePath(m,c.modulePaths[m]);});}A=j("Container",new sap.ushell.System({alias:"",platform:c.platform||P}));return A.load().done(function(){sap.ushell.Container=new C(A);sap.ushell.Container.getService("PluginManager").registerPlugins(c.bootstrapPlugins);});};}());};if(!jQuery.sap.isDeclared('sap.ushell.services.EndUserFeedback')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.EndUserFeedback");function g(p,o){return jQuery.sap.getObject(p,undefined,o)||"";}sap.ushell.services.EndUserFeedback=function(a,c,p,s){var S=(s&&s.config)||{};this.sendFeedback=function(e){var u,n,A,b,E,f,U,d,h;u=g("clientContext.navigationData.applicationInformation.url",e);n=g("clientContext.navigationData.navigationHash",e);A=g("clientContext.navigationData.applicationInformation.additionalInformation",e);b=g("clientContext.navigationData.applicationInformation.applicationType",e);f=g("clientContext.navigationData.formFactor",e);U=g("clientContext.userDetails.userId",e);d=g("clientContext.userDetails.eMail",e);h=e.feedbackText||"";E={feedbackText:h.slice(0,2000),ratings:e.ratings||{},additionalInformation:A,applicationType:b,url:u?this.getPathOfURL(u):"",navigationIntent:n.replace(/\?.*$/,''),formFactor:f,isAnonymous:e.isAnonymous||false,userId:e.isAnonymous?"":U,eMail:e.isAnonymous?"":d};return a.sendFeedback(E);};this.getLegalText=function(){return a.getLegalText();};this.isEnabled=function(){var d=new jQuery.Deferred();if(S.enabled===false){setTimeout(function(){d.reject();},0);return d.promise();}a.isEnabled().done(function(l){d.resolve();}).fail(function(e){d.reject();});return d.promise();};this.getPathOfURL=function(u){var U=new URI(u);return U.pathname();};};}());};if(!jQuery.sap.isDeclared('sap.ushell.services.LaunchPage')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.LaunchPage");sap.ushell.services.LaunchPage=function(a,c){var t=this,T=[];this.getGroups=function(){var p=a.getGroups();p.fail(function(){jQuery.sap.log.error("getGroups failed");});return p;};this.getDefaultGroup=function(){var p=a.getDefaultGroup();p.fail(function(){jQuery.sap.log.error("getDefaultGroup failed");});return p;};this.getGroupTitle=function(g){return a.getGroupTitle(g);};this.getGroupId=function(g){return a.getGroupId(g);};this.getGroupTiles=function(g){return a.getGroupTiles(g);};this.getLinkTiles=function(g){return a.getLinkTiles(g);};this.addGroupAt=function(s,i){var p,b=i;if(a.addGroupAt){p=a.addGroupAt(s,i);p.fail(function(){jQuery.sap.log.error("addGroup "+s+" failed");});}else{var d=new jQuery.Deferred();p=a.addGroup(s);p.done(function(n,g){var m=this.moveGroup(n,b),e=n;m.done(function(){d.resolve(e);});m.fail(function(){d.reject();});}.bind(this));p.fail(function(){jQuery.sap.log.error("addGroup "+s+" failed");d.reject();});return d.promise();}return p;};this.addGroup=function(s){var p=a.addGroup(s);p.fail(function(){jQuery.sap.log.error("addGroup "+s+" failed");});return p;};this.removeGroup=function(g,i){var p=a.removeGroup(g,i);p.fail(function(){jQuery.sap.log.error("Fail to removeGroup "+t.getGroupTitle(g));});return p;};this.resetGroup=function(g,i){var p=a.resetGroup(g,i);p.fail(function(){jQuery.sap.log.error("Fail to resetGroup "+t.getGroupTitle(g));});return p;};this.isGroupRemovable=function(g){return a.isGroupRemovable(g);};this.isGroupLocked=function(g){if(typeof a.isGroupLocked==="function"){return a.isGroupLocked(g);}return false;};this.moveGroup=function(g,n){var p=a.moveGroup(g,n);p.fail(function(){jQuery.sap.log.error("Fail to moveGroup "+t.getGroupTitle(g));});return p;};this.setGroupTitle=function(g,s){var p=a.setGroupTitle(g,s);p.fail(function(){jQuery.sap.log.error("Fail to set Group title: "+t.getGroupTitle(g));});return p;};this.hideGroups=function(h){var d=jQuery.Deferred();if(typeof a.hideGroups!=="function"){d.reject('hideGroups() is not implemented in the Adapter.');}else{a.hideGroups(h).done(function(){d.resolve();}).fail(function(m){jQuery.sap.log.error("Fail to store groups visibility."+m);d.reject();});}return d.promise();};this.isGroupVisible=function(g){if(typeof a.isGroupVisible==="function"){return a.isGroupVisible(g);}return true;};this.addTile=function(C,g){var p=a.addTile(C,g);p.fail(function(){jQuery.sap.log.error("Fail to add Tile: "+t.getCatalogTileId(C));});return p;};this.removeTile=function(g,o,i){var p=a.removeTile(g,o,i);p.fail(function(){jQuery.sap.log.error("Fail to remove Tile: "+t.getTileId(o));});return p;};this.moveTile=function(o,s,i,S,b){var p=a.moveTile(o,s,i,S,b);p.fail(function(){jQuery.sap.log.error("Fail to move Tile: "+t.getTileId(o));});return p;};this.getTileId=function(o){return a.getTileId(o);};this.getTileTitle=function(o){return a.getTileTitle(o);};this.getTileType=function(o){if(a.getTileType){return a.getTileType(o);}return'tile';};this.getTileView=function(o){var d=a.getTileView(o);if(!jQuery.isFunction(d.promise)){d=jQuery.Deferred().resolve(d).promise();}return d;};this.getAppBoxPressHandler=function(o){if(a.getAppBoxPressHandler){return a.getAppBoxPressHandler(o);}return undefined;};this.getTileSize=function(o){return a.getTileSize(o);};this.getTileTarget=function(o){return a.getTileTarget(o);};this.getTileDebugInfo=function(o){if(typeof a.getTileDebugInfo==="function"){return a.getTileDebugInfo(o);}return undefined;};this.isTileIntentSupported=function(o){if(typeof a.isTileIntentSupported==="function"){return a.isTileIntentSupported(o);}return true;};this.refreshTile=function(o){a.refreshTile(o);};this.setTileVisible=function(o,n){return a.setTileVisible(o,n);};this.registerTileActionsProvider=function(p){if(typeof p!=='function'){throw new Error("Tile actions Provider is not a function");}T.push(p);};this.getTileActions=function(o){var b=[];var A;if(typeof a.getTileActions==='function'){A=a.getTileActions(o);if(A&&A.length&&A.length>0){b.push.apply(b,A);}}for(var i=0;i<T.length;i++){A=T[i](o);if(A&&A.length&&A.length>0){b.push.apply(b,A);}}return b;};this.getCatalogs=function(){return a.getCatalogs();};this.isCatalogsValid=function(){return a.isCatalogsValid();};this.getCatalogData=function(C){if(typeof a.getCatalogData!=="function"){jQuery.sap.log.warning("getCatalogData not implemented in adapter",null,"sap.ushell.services.LaunchPage");return{id:this.getCatalogId(C)};}return a.getCatalogData(C);};this.getCatalogError=function(C){return a.getCatalogError(C);};this.getCatalogId=function(C){return a.getCatalogId(C);};this.getCatalogTitle=function(C){return a.getCatalogTitle(C);};this.getCatalogTiles=function(C){var p=a.getCatalogTiles(C);p.fail(function(){jQuery.sap.log.error("Fail to get Tiles of Catalog: "+t.getCatalogTitle(C));});return p;};this.getCatalogTileId=function(o){return a.getCatalogTileId(o);};this.getCatalogTileTitle=function(C){return a.getCatalogTileTitle(C);};this.getCatalogTileSize=function(C){return a.getCatalogTileSize(C);};this.getCatalogTileView=function(C){return a.getCatalogTileView(C);};this.getCatalogTileTargetURL=function(C){return a.getCatalogTileTargetURL(C);};this.getCatalogTileTags=function(C){if(typeof a.getCatalogTileTags==="function"){return a.getCatalogTileTags(C);}return[];};this.getCatalogTileKeywords=function(C){return a.getCatalogTileKeywords(C);};this.getCatalogTilePreviewTitle=function(C){return a.getCatalogTilePreviewTitle(C);};this.getCatalogTilePreviewSubtitle=function(C){if(a.getCatalogTilePreviewSubtitle){return a.getCatalogTilePreviewSubtitle(C);}};this.getCatalogTilePreviewIcon=function(C){return a.getCatalogTilePreviewIcon(C);};this.addBookmark=function(p,g){var P,d,m;if(!p.title){jQuery.sap.log.error("Add Bookmark - Missing title");throw new Error("Title missing in bookmark configuration");}if(!p.url){jQuery.sap.log.error("Add Bookmark - Missing URL");throw new Error("URL missing in bookmark configuration");}if(g&&this.isGroupLocked(g)){d=new jQuery.Deferred();P=d.promise();m='Tile cannot be added, target group ('+this.getGroupTitle(g)+')is locked!';d.reject(m);jQuery.sap.log.error(m);}else{P=a.addBookmark(p,g);P.fail(function(){jQuery.sap.log.error("Fail to add bookmark for URL: "+p.url+" and Title: "+p.title);});}return P;};this.countBookmarks=function(u){if(!u||typeof u!=="string"){jQuery.sap.log.error("Fail to count bookmarks. No valid URL");throw new Error("Missing URL");}var p=a.countBookmarks(u);p.fail(function(){jQuery.sap.log.error("Fail to count bookmarks");});return p;};this.deleteBookmarks=function(u){if(!u||typeof u!=="string"){throw new Error("Missing URL");}var p=a.deleteBookmarks(u);p.fail(function(){jQuery.sap.log.error("Fail to delete bookmark for: "+u);});return p;};this.updateBookmarks=function(u,p){if(!u||typeof u!=="string"){jQuery.sap.log.error("Fail to update bookmark. No valid URL");throw new Error("Missing URL");}if(!p||typeof p!=="object"){jQuery.sap.log.error("Fail to update bookmark. No valid parameters, URL is: "+u);throw new Error("Missing parameters");}var P=a.updateBookmarks(u,p);P.fail(function(){jQuery.sap.log.error("Fail to update bookmark for: "+u);});return P;};this.onCatalogTileAdded=function(s){return a.onCatalogTileAdded(s);};};}());};if(!jQuery.sap.isDeclared('sap.ushell.services.Message')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.Message");sap.ushell.services.Message=function(){var s=null;this.init=function(S){s=S;return this;};this.show=function(t,m,p){if(!m){jQuery.sap.log.error("Message must not be empty.");}else{if(s){s(t,m,p||{});}else{jQuery.sap.log.error("MessageService not initialized. [Message: '"+m+"']");}}};this.info=function(m,d){this.show(sap.ushell.services.Message.Type.INFO,m,{duration:d||3000});};this.error=function(m,t){m=(t!==undefined)?t+" , "+m:m;jQuery.sap.log.error(m);this.show(sap.ushell.services.Message.Type.ERROR,m,{title:t});};this.confirm=function(m,c,t,a){this.show(sap.ushell.services.Message.Type.CONFIRM,m,{title:t,callback:c,actions:a});};};sap.ushell.services.Message.hasNoAdapter=true;sap.ushell.services.Message.Type={INFO:0,ERROR:1,CONFIRM:2};}());};if(!jQuery.sap.isDeclared('sap.ushell.services.Notifications')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.Notifications");jQuery.sap.require('sap.ui.thirdparty.datajs');sap.ushell.services.Notifications=function(c,p,s){var m=new sap.ui.model.json.JSONModel(),t=new Date(),S=s&&s.config,r={getNotifications:{},getNotificationsByType:{},getNotificationsInGroup:{},getBadgeNumber:{},resetBadgeNumber:{},getNotificationTypesSettings:{},getNotificationsGroupHeaders:{},getMobileSupportSettings:{},getNotificationCount:{}},w,W=S.webSocketUrl||"/sap/bc/apc/iwngw/notification_push_apc",P=S.pollingIntervalInSeconds||60,u=[],U=[],a=[],i=false,C=[],I=false,o=false,E=true,h,d,b=5000,f=6000,g=false,O={NOTIFICATIONS:0,NOTIFICATIONS_BY_TYPE:1,GET_BADGE_NUMBER:2,RESET_BADGE_NUMBER:3,GET_SETTINGS:4,GET_MOBILE_SUPPORT_SETTINGS:5,NOTIFICATIONS_GROUP_HEADERS:6,NOTIFICATIONS_IN_GROUP:7,GET_NOTIFICATIONS_COUNT:8,NOTIFICATIONS_BY_DATE_DESCENDING:"notificationsByDateDescending",NOTIFICATIONS_BY_DATE_ASCENDING:"notificationsByDateAscending",NOTIFICATIONS_BY_PRIORITY_DESCENDING:"notificationsByPriorityDescending",NOTIFICATIONS_BY_TYPE_DESCENDING:"notificationsByTypeDescending"},M={PACKAGED_APP:0,FIORI_CLIENT:1,WEB_SOCKET:2,POLLING:3},j,F=false,k,l=true,n=false,H=true,q=false,v=new jQuery.Deferred(),N=new jQuery.Deferred(),z,A=v.promise(),B=false,D=300,G={},J=10,K=false;this.isEnabled=function(){if(!S.enabled||!S.serviceUrl){E=false;if(S.enabled&&!S.serviceUrl){jQuery.sap.log.warning("No serviceUrl was found in the service configuration");}}else{E=true;}return E;};this.init=function(){if((!I)&&(this.isEnabled())){if(B===true){this._createDummyItems();}this.lastNotificationDate=new Date();l=S.enableNotificationsPreview;this._setWorkingMode();I=true;this.bUpdateDependencyInitiatorExists=false;this._userSettingInitialization();}};this.getUnseenNotificationsCount=function(){var e=jQuery.Deferred();e.resolve(m.getProperty("/UnseenCount"));return e.promise();};this.getNotificationsCount=function(){return m.getProperty("/NotificationsCount")?m.getProperty("/NotificationsCount"):"0";};this.getNotificationsByTypeWithGroupHeaders=function(){var e,R,x=new jQuery.Deferred(),y=this._getRequestURI(O.NOTIFICATIONS_BY_TYPE);R={requestUri:y};if(!this._getHeaderXcsrfToken()){e={};e["X-CSRF-Token"]="fetch";R.headers=e;}OData.request(R,function(L){x.resolve(L);},function(L){if(L.response&&L.response.statusCode===200&&L.response.body){x.resolve(L.response.body);}else{x.reject();jQuery.sap.log.error("Notification service - oData executeAction failed: ",L,"sap.ushell.services.Notifications");}});return x.promise();};this.getNotificationsGroupHeaders=function(){var e,R,x=new jQuery.Deferred(),y=this._getRequestURI(O.NOTIFICATIONS_GROUP_HEADERS);R={requestUri:y};if(!this._getHeaderXcsrfToken()){e={};e["X-CSRF-Token"]="fetch";R.headers=e;}OData.request(R,function(L){x.resolve(L);},function(L){if(L.response&&L.response.statusCode===200&&L.response.body){x.resolve(L.response.body);}else{x.reject();jQuery.sap.log.error("Notification service - oData executeAction failed: ",L,"sap.ushell.services.Notifications");}});return x.promise();};this.getNotificationsBufferInGroup=function(e,x,T){var y=this,L,R,Q=new jQuery.Deferred(),V={group:e,skip:x,top:T},X,Y,Z=this._getRequestURI(O.NOTIFICATIONS_IN_GROUP,V);if(B===true){X=G[O.NOTIFICATIONS_IN_GROUP].slice(x,x+T);Y=JSON.stringify({"@odata.context":"$metadata#Notifications","value":X});setTimeout(function(){Q.resolve(Y);},1000);}else{R={requestUri:Z};if(!this._getHeaderXcsrfToken()){L={};L["X-CSRF-Token"]="fetch";R.headers=L;}OData.request(R,function($){y._updateCSRF($.response);Q.resolve($.value);},function($){if($.response&&$.response.statusCode===200&&$.response.body){y._updateCSRF($.response);Q.resolve(JSON.parse($.response.body).value);}else{Q.reject();jQuery.sap.log.error("Notification service - oData executeAction failed: ",$,"sap.ushell.services.Notifications");}});}return Q.promise();};this.getNotificationsBufferBySortingType=function(e,x,T){var y=this,L,R,Q=new jQuery.Deferred(),V={skip:x,top:T},X,Y,Z=this._getRequestURI(e,V);if(B===true){X=G[e].slice(x,x+T);Y=JSON.stringify({"@odata.context":"$metadata#Notifications","value":X});setTimeout(function(){Q.resolve(Y);},1000);}else{R={requestUri:Z};if(!this._getHeaderXcsrfToken()){L={};L["X-CSRF-Token"]="fetch";R.headers=L;}OData.request(R,function($){y._updateCSRF($.response);Q.resolve($.value);},function($){if($.response&&$.response.statusCode===200&&$.response.body){y._updateCSRF($.response);Q.resolve(JSON.parse($.response.body).value);}else{Q.reject();jQuery.sap.log.error("Notification service - oData executeAction failed: ",$,"sap.ushell.services.Notifications");}});}return Q.promise();};this.getNotifications=function(){var R,e=jQuery.Deferred();if((j===M.FIORI_CLIENT)||(j===M.PACKAGED_APP)){R=this._readNotificationsData(false);R.done(function(){e.resolve(m.getProperty("/Notifications"));}).fail(function(x){e.reject();});}else{e.resolve(m.getProperty("/Notifications"));}return e.promise();};this.executeBulkAction=function(e,x){var y=new jQuery.Deferred(),L=[],Q=[],R={succededNotifications:L,failedNotifications:Q},T=[],V=this;e.forEach(function(X,Y){var Z=new jQuery.Deferred();T.push(Z.promise());V.executeAction(X,x).done(function(){L.push(X);Z.resolve();}).fail(function(){Q.push(X);Z.resolve();});});jQuery.when.apply(jQuery,T).always(function(){if(Q.length){y.reject(R);}else{y.resolve(R);}});return y.promise();};this.dismissBulkNotifications=function(e){var x=new jQuery.Deferred(),y=[],L=[],R={succededNotifications:y,failedNotifications:L},Q=[],T=this;e.forEach(function(V,X){var Y=new jQuery.Deferred();Q.push(Y.promise());T.dismissNotification(V).done(function(){y.push(V);Y.resolve();}).fail(function(){L.push(V);Y.resolve();});});jQuery.when.apply(jQuery,Q).always(function(){if(L.length){x.reject(R);}else{x.resolve(R);}});return x.promise();};this.executeAction=function(e,x){var y=S.serviceUrl+"/ExecuteAction",R={NotificationId:e,ActionId:x},L={requestUri:y,method:"POST",data:R,headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json","DataServiceVersion":d,"X-CSRF-Token":h}},Q=jQuery.Deferred();OData.request(L,function(T){var V,X={isSucessfull:true,message:""};if(T&&T.response&&T.response.statusCode===200&&T.response.body){V=JSON.parse(T.response.body);X.isSucessfull=V.Success;X.message=V.MessageText;}Q.resolve(X);},function(T){var V,X={isSucessfull:false,message:""};if(T.response&&T.response.statusCode===200&&T.response.body){V=JSON.parse(T.response.body);X.isSucessfull=V.Success;X.message=V.MessageText;Q.resolve(X);}else{Q.reject();jQuery.sap.log.error("Notification service - oData executeAction failed: ",T,"sap.ushell.services.Notifications");}});return Q.promise();};this.markRead=function(e){var x=S.serviceUrl+"/MarkRead",R={NotificationId:e},y={requestUri:x,method:"POST",data:R,headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json","DataServiceVersion":d,"X-CSRF-Token":h}},L=jQuery.Deferred();OData.request(y,function(Q){L.resolve();},function(Q){L.reject();jQuery.sap.log.error("Notification service - oData markRead failed: ",Q,"sap.ushell.services.Notifications");});return L.promise();};this.dismissNotification=function(e){var x=S.serviceUrl+"/Dismiss",R={NotificationId:e},y={requestUri:x,method:"POST",data:R,headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json","DataServiceVersion":d,"X-CSRF-Token":h}},L=jQuery.Deferred();OData.request(y,function(Q){L.resolve();},function(Q){L.reject();jQuery.sap.log.error("Notification service - oData dismiss notification failed: ",Q,"sap.ushell.services.Notifications");});return L.promise();};this.registerNotificationsUpdateCallback=function(e){u.push(e);};this.registerDependencyNotificationsUpdateCallback=function(e,x){if(x===false){this.bUpdateDependencyInitiatorExists=true;}U.push({callback:e,dependent:x});};this.registerNotificationCountUpdateCallback=function(e){a.push(e);};this.notificationsSeen=function(){this._setNotificationsAsSeen();};this.isFirstDataLoaded=function(){return F;};this.readSettings=function(){var e;e=this._readSettingsFromServer();return e;};this.saveSettingsEntry=function(e){var x;x=this._writeSettingsEntryToServer(e);return x;};this.getUserSettingsFlags=function(){var e=new jQuery.Deferred();if(q===true){e.resolve({previewNotificationEnabled:n,highPriorityBannerEnabled:H});}else{A.done(function(){e.resolve({previewNotificationEnabled:n,highPriorityBannerEnabled:H});});}return e.promise();};this.setUserSettingsFlags=function(e){n=e.previewNotificationEnabled;H=e.highPriorityBannerEnabled;this._writeUserSettingsFlagsToPersonalization(e);};this._getNotificationSettingsMobileSupport=function(){return z;};this.getPreviewNotificationEnabledConfig=function(){return l;};this.destroy=function(){o=true;if((j===M.WEB_SOCKET)&&w){w.close();}};this._readUnseenNotificationsCount=function(e){var x=this,y=new jQuery.Deferred(),L=this._getRequestURI(O.GET_BADGE_NUMBER),R={requestUri:L};OData.read(R,function(Q,T){m.setProperty("/UnseenCount",T.data.GetBadgeNumber.Number);x._setNativeIconBadge(T.data.GetBadgeNumber.Number);y.resolve(T.data.GetBadgeNumber.Number);},function(Q){if(Q.response&&Q.response.statusCode===200&&Q.response.body){var T=JSON.parse(Q.response.body);m.setProperty("/UnseenCount",T.value);x._setNativeIconBadge(T.value);y.resolve(T.value);}else{jQuery.sap.log.error("Notification service - oData read unseen notifications count failed: ",Q.message,"sap.ushell.services.Notifications");y.reject();}});return y.promise();};this.readNotificationsCount=function(){var e=new jQuery.Deferred(),x=this._getRequestURI(O.GET_NOTIFICATIONS_COUNT),R={requestUri:x};OData.read(R,function(y,L){e.resolve(L.data);},function(y){if(y.response&&y.response.statusCode===200&&y.response.body){var L=JSON.parse(y.response.body);e.resolve(L.value);}else{jQuery.sap.log.error("Notification service - oData read notifications count failed: ",y.message,"sap.ushell.services.Notifications");e.reject();}});return e.promise();};this._getNotificationSettingsAvalability=function(){return N.promise();};this._setNotificationsAsSeen=function(){var R=this._getRequestURI(O.RESET_BADGE_NUMBER),e={requestUri:R,method:"POST",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json","DataServiceVersion":d,"X-CSRF-Token":h}};if(this._isFioriClientMode()===true||this._isPackagedMode()===true){this._setNativeIconBadge(0);}OData.request(e,function(x,y){},function(x){jQuery.sap.log.error("Notification service - oData reset badge number failed: ",x,"sap.ushell.services.Notifications");});};this._readNotificationsData=function(e){var x=this,R,y,L,Q=new jQuery.Deferred(),T=[];R=this._readUnseenNotificationsCount(e);T.push(R);L=this.readNotificationsCount();L.done(function(V){m.setProperty("/NotificationsCount",V);});y=this.getNotificationsBufferBySortingType(O.NOTIFICATIONS_BY_DATE_DESCENDING,0,J);T.push(y);jQuery.when.apply(jQuery,T).then(function(V){T[0].done(function(X){if(e===true){x._updateNotificationsCountConsumers();}});T[1].done(function(X){m.setProperty("/Notifications",X);x._notificationAlert(X);if(e===true){x._updateNotificationsConsumers();x._updateDependentNotificationsConsumers();}Q.resolve();});});return Q.promise();};this._getHeaderXcsrfToken=function(){return h;};this._getDataServiceVersion=function(){return d;};this._getRequestURI=function(R,e){var x,y=encodeURI(this._getConsumedIntents(R));switch(R){case O.NOTIFICATIONS:if(r.getNotifications.basic===undefined){r.getNotifications.basic=S.serviceUrl+"/Notifications?$expand=Actions,NavigationTargetParams&$filter=IsGroupHeader%20eq%20false";}if(this._isIntentBasedConsumption()){if(r.getNotifications.byIntents===undefined){r.getNotifications.byIntents=r.getNotifications.basic.concat("&intents%20eq%20"+y);}return r.getNotifications.byIntents;}return r.getNotifications.basic;case O.NOTIFICATIONS_BY_TYPE:if(r.getNotificationsByType.basic===undefined){r.getNotificationsByType.basic=S.serviceUrl+"/Notifications?$expand=Actions,NavigationTargetParams";}if(this._isIntentBasedConsumption()){if(r.getNotificationsByType.byIntents===undefined){r.getNotificationsByType.byIntents=r.getNotificationsByType.basic.concat("&$filter=intents%20eq%20"+y);}return r.getNotificationsByType.byIntents;}return r.getNotificationsByType.basic;case O.NOTIFICATIONS_GROUP_HEADERS:if(r.getNotificationsGroupHeaders.basic===undefined){r.getNotificationsGroupHeaders.basic=S.serviceUrl+"/Notifications?$expand=Actions,NavigationTargetParams&$filter=IsGroupHeader%20eq%20true";}if(this._isIntentBasedConsumption()){if(r.getNotificationsGroupHeaders.byIntents===undefined){r.getNotificationsGroupHeaders.byIntents=r.getNotificationsGroupHeaders.basic.concat("&intents%20eq%20"+y);}return r.getNotificationsGroupHeaders.byIntents;}return r.getNotificationsGroupHeaders.basic;case O.NOTIFICATIONS_IN_GROUP:if(r.getNotificationsInGroup.basic===undefined){r.getNotificationsInGroup.basic=S.serviceUrl+"/Notifications?$expand=Actions,NavigationTargetParams&$orderby=CreatedAt%20desc&$filter=IsGroupHeader%20eq%20false&ParentId%20eq%20"+e.group+"$skip="+e.skip+"&$top="+e.top;}if(this._isIntentBasedConsumption()){if(r.getNotificationsInGroup.byIntents===undefined){r.getNotificationsInGroup.byIntents=r.getNotificationsInGroup.basic.concat("&intents%20eq%20"+y);}return r.getNotificationsInGroup.byIntents;}return r.getNotificationsInGroup.basic;case O.GET_BADGE_NUMBER:if(r.getBadgeNumber.basic===undefined){r.getBadgeNumber.basic=S.serviceUrl+"/GetBadgeNumber()";}if(this._isIntentBasedConsumption()){if(r.getBadgeNumber.byIntents===undefined){r.getBadgeNumber.byIntents=S.serviceUrl+"/GetBadgeCountByIntent("+y+")";}return r.getBadgeNumber.byIntents;}return r.getBadgeNumber.basic;case O.GET_NOTIFICATIONS_COUNT:if(r.getNotificationCount.basic===undefined){r.getNotificationCount.basic=S.serviceUrl+"/Notifications/$count";}return r.getNotificationCount.basic;case O.RESET_BADGE_NUMBER:if(r.resetBadgeNumber.basic===undefined){r.resetBadgeNumber.basic=S.serviceUrl+"/ResetBadgeNumber";}return r.resetBadgeNumber.basic;case O.GET_SETTINGS:if(r.getNotificationTypesSettings.basic===undefined){r.getNotificationTypesSettings.basic=S.serviceUrl+"/NotificationTypePersonalizationSet";}return r.getNotificationTypesSettings.basic;case O.GET_MOBILE_SUPPORT_SETTINGS:if(r.getMobileSupportSettings.basic===undefined){r.getMobileSupportSettings.basic=S.serviceUrl+"/Channels(ChannelId='SAP_SMP')";}return r.getMobileSupportSettings.basic;case O.NOTIFICATIONS_BY_DATE_DESCENDING:x=S.serviceUrl+"/Notifications?$expand=Actions,NavigationTargetParams&$orderby=CreatedAt%20desc&$filter=IsGroupHeader%20eq%20false&$skip="+e.skip+"&$top="+e.top;if(this._isIntentBasedConsumption()===true){x=x.concat("&intents%20eq%20"+y);}break;case O.NOTIFICATIONS_BY_DATE_ASCENDING:x=S.serviceUrl+"/Notifications?$expand=Actions,NavigationTargetParams&$orderby=CreatedAt%20asc&$filter=IsGroupHeader%20eq%20false&$skip="+e.skip+"&$top="+e.top;if(this._isIntentBasedConsumption()===true){x=x.concat("&intents%20eq%20"+y);}break;case O.NOTIFICATIONS_BY_PRIORITY_DESCENDING:x=S.serviceUrl+"/Notifications?$expand=Actions,NavigationTargetParams&$orderby=Priority%20desc&$filter=IsGroupHeader%20eq%20false&$skip="+e.skip+"&$top="+e.top;if(this._isIntentBasedConsumption()===true){x=x.concat("&intents%20eq%20"+y);}break;default:x="";}return x;};this._readSettingsFromServer_noConnection=function(){var e=jQuery.Deferred(),x=[{NotificationTypeId:"type1",NotificationTypeDesc:"aaaaabbbbb-cccccddddd",PriorityDefault:"40-HIGH",DoNotDeliver:false,DoNotDeliverMob:true},{NotificationTypeId:"type2",NotificationTypeDesc:"cccccdddddccc-aaaaabbbbb",PriorityDefault:"10-LOW",DoNotDeliver:true,DoNotDeliverMob:true}];e.resolve(JSON.stringify({"@odata.context":"$metadata#NotificationTypePersonalizationSet","value":x}));return e.promise();};this._readSettingsFromServer_noData=function(){var e=jQuery.Deferred();e.resolve(JSON.stringify({"@odata.context":"$metadata#NotificationTypePersonalizationSet","value":{}}));return e.promise();};this._readSettingsFromServer=function(){var R=this._getRequestURI(O.GET_SETTINGS),e={requestUri:R},x=jQuery.Deferred();OData.request(e,function(y){x.resolve(y.results);},function(y){if(y.response&&y.response.statusCode===200&&y.response.body){x.resolve(y.response.body);}else{x.reject();jQuery.sap.log.error("Notification service - oData get settings failed: ",y,"sap.ushell.services.Notifications");}});return x.promise();};this._readMobileSettingsFromServer=function(){var R=this._getRequestURI(O.GET_MOBILE_SUPPORT_SETTINGS),e={requestUri:R},x=jQuery.Deferred();OData.request(e,function(y){x.resolve(y.results);},function(y){if(y.response&&y.response.statusCode===200&&y.response.body){x.resolve(y.response.body);}else{x.reject();jQuery.sap.log.error("Notification service - oData get settings failed: ",y,"sap.ushell.services.Notifications");}});return x.promise();};this._writeSettingsEntryToServer=function(e){var x,y=this._getRequestURI(O.GET_SETTINGS)+"(NotificationTypeId="+e.NotificationTypeId+")",R={requestUri:y,method:"PUT",data:{"@odata.context":"$metadata#NotificationTypePersonalizationSet/$entity","NotificationTypeId":e.NotificationTypeId,"NotificationTypeDesc":e.NotificationTypeDesc,"PriorityDefault":e.PriorityDefault,"DoNotDeliver":e.DoNotDeliver,"DoNotDeliverMob":e.DoNotDeliverMob},headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json","DataServiceVersion":d,"X-CSRF-Token":h}};x=jQuery.Deferred();OData.request(R,function(L){x.resolve(L);},function(L){if(L.response&&L.response.statusCode===200&&L.response.body){x.resolve(L.response.body);}else{x.reject();jQuery.sap.log.error("Notification service - oData set settings entry failed: ",L,"sap.ushell.services.Notifications");}});return x.promise();};this._updateNotificationsConsumers=function(){u.forEach(function(e){e();});};this._updateDependentNotificationsConsumers=function(){var e=this,x=new jQuery.Deferred();U.forEach(function(y){if(e.bUpdateDependencyInitiatorExists===false){y.callback();}else{y.dependent===true?y.callback(x.promise()):y.callback(x);}});};this._updateNotificationsCountConsumers=function(){a.forEach(function(e){e();});};this._updateAllConsumers=function(){this._updateNotificationsConsumers();this._updateNotificationsCountConsumers();this._updateDependentNotificationsConsumers();};this._getModel=function(){return m;};this._getMode=function(){return j;};this._setWorkingMode=function(){var e;if(S.intentBasedConsumption===true){C=this._getIntentsFromConfiguration(S.consumedIntents);if(C.length>0){i=true;}}if(this._isPackagedMode()){j=M.PACKAGED_APP;e=this._getIntentsFromConfiguration(window.fiori_client_appConfig.applications);if(e.length>0){C=e;}if(C.length>0){i=true;}this._registerForPush();this._readNotificationsData(true);this._setNativeIconBadgeWithDelay();return;}this._performFirstRead();};this._performFirstRead=function(){var e=this,x,R=this._readNotificationsData(true);R.done(function(){x=e._getFioriClientRemainingDelay();if(x<=0){e._fioriClientStep();}else{setTimeout(function(){e._fioriClientStep();},x);}F=true;}).fail(function(y){jQuery.sap.log.error("Notifications oData read failed. Error: "+y);return;});};this._fioriClientStep=function(){var e=this,x;if(this._isFioriClientMode()){j=M.FIORI_CLIENT;this._addPushNotificationHandler();x=this.getUnseenNotificationsCount();x.done(function(y){e._setNativeIconBadge(y,function(){});}).fail(function(){});}else{this._webSocketStep();}};this._webSocketStep=function(){j=M.WEB_SOCKET;this._establishWebSocketConnection();};this._webSocketRecoveryStep=function(){if(g===false){g=true;setTimeout(function(){this._webSocketStep();}.bind(this),b);}else{this._activatePollingAfterInterval();}};this._activatePollingAfterInterval=function(){var e=this;setTimeout(function(){e._activatePolling();},P*1000);};this._activatePolling=function(){var e=this;j=M.POLLING;this._readNotificationsData(true);this.timer=setTimeout(e._activatePolling.bind(e,P,false),(P*1000));};this._formatAsDate=function(e){return new Date(e);};this._notificationAlert=function(e){if(H===false){return;}var x,y=[],L=0;for(x in e){if(this.lastNotificationDate&&this._formatAsDate(e[x].CreatedAt)>this.lastNotificationDate){if(e[x].Priority==="HIGH"){y.push(e[x]);}}if(L<this._formatAsDate(e[x].CreatedAt)){L=this._formatAsDate(e[x].CreatedAt);}}if(this.lastNotificationDate&&y&&y.length>0){sap.ui.getCore().getEventBus().publish("sap.ushell.services.Notifications","onNewNotifications",y);}this.lastNotificationDate=L;};this._getFioriClientRemainingDelay=function(){return f-(new Date()-t);};this._establishWebSocketConnection=function(){var x=this,y;jQuery.sap.require("sap.ui.core.ws.SapPcpWebSocket");try{w=new sap.ui.core.ws.SapPcpWebSocket(W,[sap.ui.core.ws.SapPcpWebSocket.SUPPORTED_PROTOCOLS.v10]);w.attachMessage(this,function(L,Q){y=L.getParameter("pcpFields");if((y)&&(y.Command)&&(y.Command==="Notification")){x._readNotificationsData(true);}});w.attachClose(this,function(L,Q){jQuery.sap.log.error("Notifications UShell service WebSocket: attachClose called with code: "+L.mParameters.code+" and reason: "+L.mParameters.reason);if(!o){x._webSocketRecoveryStep();}});w.attachError(this,function(L,Q){jQuery.sap.log.error("Notifications UShell service WebSocket: attachError called!");});}catch(e){jQuery.sap.log.error("Exception occurred while creating new sap.ui.core.ws.SapPcpWebSocket. Message: "+e.message);}};this._isFioriClientMode=function(){return!(sap.FioriClient===undefined);};this._isPackagedMode=function(){return(window.fiori_client_appConfig&&window.fiori_client_appConfig.prepackaged===true);};this._setNativeIconBadge=function(e){if((sap.Push!==undefined)&&(sap.Push.setBadgeNumber!==undefined)){sap.Push.setBadgeNumber(e,function(){});}};this._setNativeIconBadgeWithDelay=function(){var e=this,x;setTimeout(function(){x=e.getUnseenNotificationsCount();x.done(function(y){e._setNativeIconBadge(y);}).fail(function(){});},4000);};this._getIntentsFromConfiguration=function(e){var T=[],x,y;if(e&&e.length>0){for(y=0;y<e.length;y++){x=e[y].intent;T.push(x);}}return T;};this._handlePushedNotification=function(e){var x,y,L,Q,R=[],V;if(e!==undefined){if((e.additionalData===undefined)||(e.additionalData.foreground===true)){this._readNotificationsData(true);}else{x=e.NotificationId;y=e.NavigationTargetObject;L=e.NavigationTargetAction;Q=e.NavigationTargetParam;if(Q){if(typeof Q==='string'||Q instanceof String){R[0]=Q;}else if(Array.isArray(Q)===true){R=Q;}}if((typeof hasher!=="undefined")&&(hasher.getHash()===y+"-"+L)){V=sap.ui.getCore().byId('viewPortContainer');if(V){V.switchState("Center");}}sap.ushell.utils.toExternalWithParameters(y,L,R);this.markRead(x);this._readNotificationsData(true);}}};this._registerForPush=function(){sap.Push.initPush(this._handlePushedNotification.bind(this));};this._addPushNotificationHandler=function(){document.addEventListener("deviceready",this._registerForPush.bind(this),false);};this._isIntentBasedConsumption=function(){return i;};this._getConsumedIntents=function(R){var e="",x;if(!this._isIntentBasedConsumption()){return e;}if(C.length>0){if(R!==O.GET_BADGE_NUMBER){e="&";}for(x=0;x<C.length;x++){if(R===O.GET_BADGE_NUMBER){if(x===0){e=C[x];}else{e=e+","+C[x];}}else{e=e+"NavigationIntent%20eq%20%27"+C[x]+"%27";}}}return e;};this._notificationsAscendingSortBy=function(e,L){e.sort(function(x,y){var Q=x[L],R=y[L];if(Q===R){Q=x.id;R=y.id;}return R>Q?-1:1;});return e;};this._notificationsDescendingSortBy=function(e,L){e.sort(function(x,y){var Q=x[L],R=y[L];if(Q===R){Q=x.id;R=y.id;return Q>R?-1:1;}if(L==="Priority"){if(Q==="HIGH"){return-1;}if(R==="HIGH"){return 1;}if(Q==="MEDIUM"){return-1;}return 1;}return Q>R?-1:1;});return e;};this.getOperationEnum=function(){return O;};this._readUserSettingsFlagsFromPersonalization=function(){var e=this,x,y;try{y=this._getUserSettingsPersonalizer().getPersData();}catch(L){jQuery.sap.log.error("Personalization service does not work:");jQuery.sap.log.error(L.name+": "+L.message);x=new jQuery.Deferred();x.reject(L);y=x.promise();}y.done(function(Q){if(Q===undefined){e._writeUserSettingsFlagsToPersonalization({previewNotificationEnabled:n,highPriorityBannerEnabled:H});}else{n=Q.previewNotificationEnabled;H=Q.highPriorityBannerEnabled;}q=true;v.resolve();});y.fail(function(){jQuery.sap.log.error("Reading User Settings flags from Personalization service failed");});};this._writeUserSettingsFlagsToPersonalization=function(e){var x,y;try{y=this._getUserSettingsPersonalizer().setPersData(e);}catch(L){jQuery.sap.log.error("Personalization service does not work:");jQuery.sap.log.error(L.name+": "+L.message);x=new jQuery.Deferred();x.reject(L);y=x.promise();}return y;};this._getUserSettingsPersonalizer=function(){if(k===undefined){k=this._createUserSettingsPersonalizer();}return k;};this._createUserSettingsPersonalizer=function(){var e=sap.ushell.Container.getService("Personalization"),x,y={keyCategory:e.constants.keyCategory.FIXED_KEY,writeFrequency:e.constants.writeFrequency.LOW,clientStorageAllowed:true},L={container:"sap.ushell.services.Notifications",item:"userSettingsData"},Q=e.getPersonalizer(L,y,x);return Q;};this._updateCSRF=function(R){if((K===true)||(R.headers===undefined)){return;}if(!this._getHeaderXcsrfToken()){h=R.headers["x-csrf-token"]||R.headers["X-CSRF-Token"];}if(!this._getDataServiceVersion()){d=R.headers.DataServiceVersion||R.headers["odata-version"];}K=true;};this._userSettingInitialization=function(){var e,x,y={settingsAvailable:false,mobileAvailable:false},L;this._readUserSettingsFlagsFromPersonalization();e=this._readSettingsFromServer();x=this._readMobileSettingsFromServer();L=[e,x];e.done(function(){y.settingsAvailable=true;});x.done(function(R){z=R?JSON.parse(R).IsActive:false;y.mobileAvailable=z;});x.fail(function(){n=true;});jQuery.when.apply(jQuery,L).then(function(Q){N.resolve(y);});};this._createDummyItems=function(e){var x,y,L,Q,R=[],T=[],V=[],X;G[O.NOTIFICATIONS_BY_DATE_DESCENDING]=[];G[O.NOTIFICATIONS_BY_DATE_ASCENDING]=[];G[O.NOTIFICATIONS_BY_PRIORITY_DESCENDING]=[];for(x=0;x<D;x++){y={"Id":x,"OriginId":"G1Y_800","IsActionable":true,"IsRead":false,"IsGroupable":true,"IsGroupHeader":false,"NavigationTargetAction":"toappstatesample","NavigationTargetObject":"Action","NotificationTypeId":"00505692-5975-1EE5-A991-2706A9CB0001","ParentId":"00000000-0000-0000-0000-000000000000","Priority":"HIGH","Text":"A purchase order requires your approval","SensitiveText":"Purchase order #"+x,"GroupHeaderText":"","NotificationCount":0,"Actor":{"Id":"BAR-LEV","DisplayText":"BAR-LEV","ImageSource":"https://scn.sap.com/people/guest/avatar/BAR-LEV.png"},"NavigationTargetParams":[{"NotificationId":"00505692-5975-1ED5-ACF1-77645AE4AF3A","Key":"PurchaseOrderId","Value":"236400"},{"NotificationId":"00505692-5975-1ED5-ACF1-77645AE4AF3A","Key":"PurchaseOrderVendor","Value":"PARTNER_137"}],"Actions":[{"ActionId":"00505692-5975-1EE5-A991-2706A9CC0000","ActionText":"Accept","GroupActionText":"Accept All","Nature":"POSITIVE"},{"ActionId":"00505692-5975-1EE5-A991-2706A9CC0001","ActionText":"Reject","GroupActionText":"Reject All","Nature":"NEGATIVE"}]};L=new Date();y.CreatedAt=new Date(L.getTime()-x*15000);Q=parseInt(Math.random()*3,10);if(Q===0){y.Priority="LOW";V.push(y);}else if(Q===1){y.Priority="MEDIUM";T.push(y);}else{y.Priority="HIGH";R.push(y);}G[O.NOTIFICATIONS_BY_DATE_DESCENDING][x]=y;X=D-1-x;G[O.NOTIFICATIONS_BY_DATE_ASCENDING][X]=y;}G[O.NOTIFICATIONS_BY_PRIORITY_DESCENDING]=G[O.NOTIFICATIONS_BY_PRIORITY_DESCENDING].concat(R).concat(T).concat(V);};};sap.ushell.services.Notifications.hasNoAdapter=true;}());};if(!jQuery.sap.isDeclared('sap.ushell.services.PageBuilding')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.PageBuilding");jQuery.sap.require('sap.ui2.srvc.factory');jQuery.sap.require('sap.ui2.srvc.page');sap.ushell.services.PageBuilding=function(a,c){this.getFactory=function(){return a.getFactory();};this.getPage=function(p){return a.getFactory().createPage(p);};this.getPageSet=function(i){var d=new jQuery.Deferred();a.getFactory().createPageSet(i,d.resolve.bind(d),d.reject.bind(d));return d.promise();};};}());};if(!jQuery.sap.isDeclared('sap.ushell.services.PluginManager')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.PluginManager");var S="sap.ushell.services.PluginManager",a="sap-ushell-plugin-type",b="RendererExtensions",s=[b,"UserDefaults"];sap.ushell.services.PluginManager=function(){var t=this;this._oPluginCollection={};this._oCategoryLoadingProgress={};this._mInitializedComponentPromise={};s.forEach(function(p){t._oPluginCollection[p]={};t._oCategoryLoadingProgress[p]=new jQuery.Deferred();});this._handlePluginCreation=function(c,p,P){var t=this,o=(t._oPluginCollection[c])[p];try{if(o.hasOwnProperty("component")){if(t._mInitializedComponentPromise.hasOwnProperty(o.component)){t._mInitializedComponentPromise[o.component].then(function(){t._instantiateComponent(o,P);},function(){t._instantiateComponent(o,P);});}else{t._mInitializedComponentPromise[o.component]=t._instantiateComponent(o,P);}}else{jQuery.sap.log.error("Invalid plugin configuration. The plugin "+p+" must contain a <component> key",S);}}catch(e){jQuery.sap.log.error("Error while loading bootstrap plugin: "+o.component||"",S);if(P){P.reject(e);}}};this._instantiateComponent=function(p,P){var c=jQuery.extend(true,{},p),A={ui5ComponentName:c.component,url:c.url};c.name=c.component;delete c.component;A.applicationDependencies=c;if(c.config){A.applicationConfiguration=c.config;delete c.config;}A.loadDefaultDependencies=false;return sap.ushell.Container.getService("Ui5ComponentLoader").createComponent(A).done(function(l){if(P){P.resolve();}}).fail(function(e){e=e||"";jQuery.sap.log.error("Cannot create UI5 plugin component: (componentId/appdescrId :"+A.ui5ComponentName+")\n"+e+" properties "+JSON.stringify(A)+"\n This indicates a plugin misconfiguration, see e.g. Note 2316443.",e.stack,S);if(P){P.reject(e);}});};this.getSupportedPluginCategories=function(){return jQuery.extend(true,[],s);};this.getRegisteredPlugins=function(){return jQuery.extend(true,{},this._oPluginCollection);};this.registerPlugins=function(p){var t=this,c,P;if(!p){return;}sap.ushell.utils.addTime("PluginManager.registerPlugins");Object.keys(p).sort().forEach(function(d){c=p[d]||{};P=c.config||{};if(c&&c.hasOwnProperty("module")){jQuery.sap.log.error("Plugin "+d+" cannot get registered, because the module mechanism for plugins is not valid anymore. Plugins need to be defined as SAPUI5 components.",S);jQuery.sap.require(c.module);return;}if(P&&P.hasOwnProperty(a)){if(jQuery.inArray(P[a],s)!==-1){(t._oPluginCollection[P[a]])[d]=jQuery.extend(true,{},p[d]);}else{jQuery.sap.log.warning("Plugin "+d+" will not be inserted into the plugin collection of the PluginManager, because of unsupported category "+P[a],S);}}else{(t._oPluginCollection[b])[d]=jQuery.extend(true,{},p[d]);}});};this.getPluginLoadingPromise=function(p){if(this._oCategoryLoadingProgress.hasOwnProperty(p)){return this._oCategoryLoadingProgress[p].promise();}};this.loadPlugins=function(p){var t=this,P,o;sap.ushell.utils.addTime("PluginManager.startLoadPlugins["+p+"]");if(jQuery.inArray(p,s)!==-1){if(t._oCategoryLoadingProgress[p].pluginLoadingTriggered!==undefined){return t._oCategoryLoadingProgress[p].promise();}else{t._oCategoryLoadingProgress[p].pluginLoadingTriggered=true;}if(Object.keys(t._oPluginCollection[p]).length>0){P=[];Object.keys(t._oPluginCollection[p]).forEach(function(c){o=new jQuery.Deferred();P.push(o.promise());t._handlePluginCreation(p,c,o);});jQuery.when.apply(undefined,P).done(function(){sap.ushell.utils.addTime("PluginManager.endLoadPlugins["+p+"]");t._oCategoryLoadingProgress[p].resolve();}).fail(t._oCategoryLoadingProgress[p].reject.bind());}else{t._oCategoryLoadingProgress[p].resolve();}}else{jQuery.sap.log.error("Plugins with category "+p+" cannot be loaded by the PluginManager",S);t._oCategoryLoadingProgress[p].reject("Plugins with category "+p+" cannot be loaded by the PluginManager");}return t._oCategoryLoadingProgress[p].promise();};};sap.ushell.services.PluginManager.hasNoAdapter=true;}());};if(!jQuery.sap.isDeclared('sap.ushell.services.Search')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.Search");var s=sap.ushell.renderers.fiori2.search.SearchHelper;sap.ushell.services.Search=function(a,c){this.init.apply(this,arguments);};sap.ushell.services.Search.prototype={init:function(a,c,p,S){this.oAdapter=a;this.oContainerInterface=c;this.oLpdService=sap.ushell.Container.getService("LaunchPage");this.optimizedAppSearch=false;if(S&&S.config&&S.config.optimizedAppSearch!==undefined){this.optimizedAppSearch=S.config.optimizedAppSearch;}},isSearchAvailable:function(){return this.oAdapter.isSearchAvailable();},getSina:function(){return this.oAdapter.getSina();},isValid:function(t){if(this.oLpdService.isTileIntentSupported){return this.oLpdService.isTileIntentSupported(t);}else{return true;}},_getCatalogTiles:function(){var t=this;if(t.allTilesDeferred){return t.allTilesDeferred;}var c=[];t.allTilesDeferred=t.oLpdService.getCatalogs().then(function(d){var D=[];var o=t._getPersonalizedGroupTiles(new jQuery.Deferred());D.push(o);for(var i=0;i<d.length;i++){D.push(t.oLpdService.getCatalogTiles(d[i]));}return jQuery.when.apply(jQuery,D).then(function(){var T=arguments;for(var i=0;i<T.length;i++){var f=T[i];for(var j=0;j<f.length;j++){try{var g,h,k,l,m,S,I;g=f[j];if(!t.optimizedAppSearch){h=t.oLpdService.getCatalogTileView(g);}k=t.oLpdService.getCatalogTileKeywords(g);l=t.oLpdService.getCatalogTileTargetURL(g);m=t.oLpdService.getCatalogTilePreviewTitle(g)||t.oLpdService.getCatalogTileTitle(g);S=t.oLpdService.getCatalogTileSize(g);I=t.oLpdService.getCatalogTilePreviewIcon(g)||"sap-icon://business-objects-experience";if(t.isValid(g)){c.push({tile:g,keywords:k,url:l,title:m||'',icon:I,size:S});}if(!t.optimizedAppSearch){h.destroy();}if(g.getContract){var p=g.getContract("preview");if(p){p.setEnabled(false);}}}catch(e){jQuery.sap.log.error(e);}}}c=t._removeDuplicateTiles(c);c.sort(function(a,b){if(a.title.toUpperCase()<b.title.toUpperCase()){return-1;}if(a.title.toUpperCase()>b.title.toUpperCase()){return 1;}return 0;});return c;});});return t.allTilesDeferred;},_getPersonalizedGroupTiles:function(d){var t=this;t.oLpdService.getGroups().then(function(g){var D=[];var G;for(var j=0;j<g.length;j++){G=t.oLpdService.getGroupTiles(g[j])||[];D=D.concat(G);}d.resolve(D);});return d.promise();},_removeDuplicateTiles:function(t){var I={},k,u=[];for(var i=0;i<t.length;++i){var T=t[i];if(!T.url){continue;}var f=new RegExp('DisplayFactSheet','i');if(f.test(T.url)){continue;}k=T.title+T.url+T.icon;if(I[k]===undefined){I[k]=T;u.push(T);}}return u;},_searchTiles:function(p){var S=p.searchTerm;var c=p.aCatalogTiles;var t=p.top||10;var i=p.skip||0;var m=0;var b=p.searchInKeywords||false;var f=[],T;var a=function(T,h){m+=1;if(m<=i){return;}if(m>(i+t)){return;}var r=jQuery.extend({},T);r.tooltip=r.title;if(h.length>0){r.label=h;}else{r.label=T.title;}f.push(r);};var d=S.replace(/\*/g,'');var o=new s.Tester(d);var e;for(var j=0;j<c.length;j++){T=c[j];e=o.test(T.title);if(e.bMatch===true){a(T,e.sHighlightedText);continue;}if(b&&T.keywords&&Array.isArray(T.keywords)){e=o.test(T.keywords.join(' '));if(e.bMatch===true){a(T,"");}}}return{totalResults:m,searchTerm:S,getElements:function(){return f;}};},queryApplications:function(p){var t=this;return this._getCatalogTiles().then(function(c){p.aCatalogTiles=c;return t._searchTiles(p);});},queryApplicationsByTarget:function(S,r){this._getCatalogTiles().done(function(c){var R=[];for(var j=0,l=S&&S.length||0;j<l;j++){var o=S[j],u=sap.ushell.Container.getService("URLParsing");for(var i=0;i<c.length;i++){var t=u.parseShellHash(c[i].url);if(t&&(t.semanticObject===o.semanticObject)&&(t.action===o.action)){R.push(c[i]);break;}}}r(R);});}};}());};if(!jQuery.sap.isDeclared('sap.ushell.services.ShellNavigation')){(function(){"use strict";jQuery.sap.require('sap.ui.thirdparty.signals');jQuery.sap.require('sap.ui.thirdparty.hasher');jQuery.sap.require('sap.ui.core.routing.HashChanger');jQuery.sap.declare("sap.ushell.services.ShellNavigation");function c(){var h=window.history.length;var m={onHashChanged:function(){if(window.history.length!==h){m.onHashChanged=function(){};m.isInitialNavigation=function(){return false;};}},isInitialNavigation:function(){return true;}};return m;}sap.ui.core.routing.HashChanger.extend("sap.ushell.services.ShellNavigationHashChanger",{constructor:function(C){var u;this.oServiceConfig=C;if(jQuery.sap.getUriParameters().get("sap-ushell-reload")){if(jQuery.sap.getUriParameters().get("sap-ushell-reload")==="X"||jQuery.sap.getUriParameters().get("sap-ushell-reload")==="true"){u=true;}else{u=false;}}if(u!==undefined){if(typeof this.oServiceConfig!=="object"){this.oServiceConfig={};}this.oServiceConfig.reload=u;}sap.ui.core.routing.HashChanger.apply(this);this._initializedByShellNav=false;this.oURLShortening=sap.ushell.Container.getService("URLShortening");this.privfnShellCallback=null;this.privappHashPrefix="&/";this.privhashPrefix="#";this.aNavigationFilters=[];this.NavigationFilterStatus={Continue:"Continue",Custom:"Custom",Abandon:"Abandon"};this.privgetCurrentShellHash=function(){var r=this.privsplitHash(hasher.getHash());return{hash:"#"+((r&&r.shellPart)?r.shellPart:"")};};this.privconstructHash=function(A){var o=this.privgetCurrentShellHash();o.hash=o.hash+A;return o;};this.privconstructShellHash=function(s){return sap.ushell.Container.getService("URLParsing").constructShellHash(s);};this.privsplitHash=function(h){var s,o,A;if(h===undefined||h===null||h===""){return{shellPart:null,appSpecificRoute:null,intent:null,params:null};}s=sap.ushell.Container.getService("URLParsing").parseShellHash(h);if(s===undefined||s===null){return null;}o=(s.params&&!jQuery.isEmptyObject(s.params))?s.params:null;A=s.appSpecificRoute;s.appSpecificRoute=undefined;return{shellPart:this.privstripLeadingHash(this.privconstructShellHash(s))||null,appSpecificRoute:A||null,intent:(s.semanticObject&&s.action&&(s.semanticObject+"-"+s.action+(s.contextRaw||"")))||null,params:o};};this.privsetHash=function(f,A,w){hasher.prependHash="";f=this.privstripLeadingHash(f);A=A||"";if(w===undefined){w=true;}if(w){this.fireEvent("hashSet",{sHash:A});hasher.setHash(f);}else{this.fireEvent("hashReplaced",{sHash:A});hasher.replaceHash(f);}};this.privstripLeadingHash=function(h){if(h[0]==='#'){return h.substring(1);}return h;};this.registerNavigationFilter=function(f){if(typeof f!=="function"){throw new Error("fnFilter must be a function");}this.aNavigationFilters.push(f);};function b(o,t){this.oAppState=undefined;this.oPromise=(new jQuery.Deferred()).resolve();this.getNextKey=function(){this.oAppState=sap.ushell.Container.getService("AppState").createEmptyAppState(o,t);return this.oAppState.getKey();};this.store=function(v){var n;this.oAppState.setData(v);n=this.oAppState.save();this.oPromise=jQuery.when(this.oPromise,n);};this.getPromise=function(){return this.oPromise;};}this.compactParams=function(p,r,o,t){var U=sap.ushell.Container.getService("URLParsing"),s,d,R,P,D=new jQuery.Deferred(),h=U.constructShellHash({"target":{"semanticObject":"SO","action":"action"},"params":p},s);if(p===undefined||Object.keys(p).length===0){return D.resolve(p).promise();}s=new b(o,t);R=this.oURLShortening.compactHash(h,r,s);d=U.parseParameters(R.hash.match(/\?.*/)[0]);P=s.getPromise();P.done(function(){D.resolve(d);}).fail(function(m){D.reject(m);});return D;};this.hrefForExternal=function(A,v,o,d){var r=this.hrefForExternalNoEnc(A,v,o,d);function e(R,v){if(v===true){R.hash=encodeURI(R.hash);}else{R=encodeURI(R);}return R;}if(!d){return e(r,v);}var D=new jQuery.Deferred();r.done(function(R){D.resolve(e(R,v));}).fail(D.reject.bind(D));return D;};this.hrefForExternalNoEnc=function(A,v,o,d){var t,p,D,s=new b(o),r;t=this.privhrefForExternalNoEnc(A,s);if(v===true){r={hash:t.hash,params:t.params,skippedParams:t.skippedParams};}else{r=t.hash;}if(!d){return r;}p=s.getPromise();D=new jQuery.Deferred();p.done(function(){D.resolve(r);}).fail(function(m){D.reject(m);});return D;};this.privhrefForExternalNoEnc=function(A,s){var r;if(A===undefined){return this.privgetCurrentShellHash();}if(A&&A.target&&(typeof A.target.semanticObject==="string"||typeof A.target.shellHash==="string")){r="#"+this.privconstructShellHash(A);return this.oURLShortening.compactHash(r,undefined,s);}return this.privgetCurrentShellHash();};this.privgetAppHash=function(A){var s,o;if(A&&A.target&&(typeof A.target.shellHash==="string")){o=sap.ushell.Container.getService("URLParsing").parseShellHash(A.target.shellHash);s=o&&o.appSpecificRoute;s=s&&s.substring(2);}return s;};this.hrefForAppSpecificHash=function(A){return encodeURI(this.privconstructHash(this.privappHashPrefix+A).hash);};this.toExternal=function(A,o,w){var h,s=new b(o),d;h=this.privhrefForExternalNoEnc(A,s).hash;d=this.privgetAppHash(A);this.privsetHash(h,d,w);};this.toAppHash=function(A,w){var h=this.privconstructHash(this.privappHashPrefix+A).hash;this.privsetHash(h,A,w);};}});sap.ushell.services.ShellNavigationHashChanger.prototype.initShellNavigation=function(s){this._oInitialNavigationManager=c();if(this._initializedByShellNav){jQuery.sap.log.info("initShellNavigation already called on this ShellNavigationHashChanger instance.");return false;}this.privfnShellCallback=s;hasher.changed.add(this.treatHashChanged,this);if(!hasher.isActive()){hasher.initialized.addOnce(this.treatHashChanged,this);hasher.init();}else{this.treatHashChanged(hasher.getHash());}this._initializedByShellNav=true;return true;};sap.ushell.services.ShellNavigationHashChanger.prototype.init=function(){if(this._initialized){jQuery.sap.log.info("init already called on this ShellNavigationHashChanger instance.");return false;}var n=this.privsplitHash(hasher.getHash()),A=n&&(n.appSpecificRoute||"  ").substring(2);this.fireEvent("hashChanged",{newHash:A});this._initialized=true;return true;};sap.ushell.services.ShellNavigationHashChanger.prototype.treatHashChanged=function(n,o){if(this.inAbandonFlow){return;}this._oInitialNavigationManager.onHashChanged();var A,O,N,b,s,d,f,g,E,i,F;n=this.oURLShortening.expandHash(n);o=this.oURLShortening.expandHash(o);N=this.privsplitHash(n);b=this.privsplitHash(o);if(!N){E=new Error("Illegal new hash - cannot be parsed: '"+n+"'");this.fireEvent("shellHashChanged",{newShellHash:n,newAppSpecificRoute:null,oldShellHash:(b?b.shellPart:o),error:E});this.privfnShellCallback(n,null,(b?b.shellPart:o),(b?b.appSpecificRoute:null),E);return;}else{s=N.intent;}if(!b){b={shellPart:o,appSpecificRoute:null};}else{d=b.intent;}for(i=0;i<this.aNavigationFilters.length;i=i+1){try{F=this.aNavigationFilters[i].call(undefined,n,o);if(F===this.NavigationFilterStatus.Custom){return;}if(F===this.NavigationFilterStatus.Abandon){this.inAbandonFlow=true;hasher.replaceHash(o);this.inAbandonFlow=false;return;}}catch(e){jQuery.sap.log.error("Error while calling Navigation filter! ignoring filter...",e.message,"sap.ushell.services.ShellNavigation");}}if(s===d&&(o!==undefined)){if(!this._parametersChanged(N.params,b.params)){A=(N.appSpecificRoute||"  ").substring(2);O=(b.appSpecificRoute||"  ").substring(2);jQuery.sap.log.info("Inner App Hash changed from '"+O+"' to '"+A+"'",null,"sap.ushell.services.ShellNavigation");this.fireEvent("hashChanged",{newHash:A,oldHash:O});return;}if(this.hasListeners("shellHashParameterChanged")){f=sap.ushell.Container.getService("URLParsing").paramsToString(N.params);g=sap.ushell.Container.getService("URLParsing").paramsToString(b.params);jQuery.sap.log.info("Shell hash parameters changed from '"+g+"' to '"+f+"'",null,"sap.ushell.services.ShellNavigation");this.fireEvent("shellHashParameterChanged",{oNewParameters:N.params,oOldParameters:b.params});return;}}function r(h){window.location.hash='#'+encodeURI(h);window.location.reload();}if(o!==undefined){if(this.oServiceConfig&&this.oServiceConfig.reload){r(n);}}jQuery.sap.log.info("Outer shell hash changed from '"+o+"' to '"+n+"'",null,"sap.ushell.services.ShellNavigation");this.fireEvent("shellHashChanged",{newShellHash:N.shellPart,newAppSpecificRoute:N.appSpecificRoute,oldShellHash:b.shellPart,oldAppSpecificRoute:b.appSpecificRoute});this.privfnShellCallback(N.shellPart,N.appSpecificRoute,b.shellPart,b.appSpecificRoute);};function a(){jQuery.sap.require('sap.m.MessageBox');sap.m.MessageBox.show("Due to a configuration change on the server,\nclient and server are out of sync.\n We strongly recommend to reload the page soon.\nReload page now?",{icon:sap.m.MessageBox.Icon.ERROR,title:"Client out of sync with server.",actions:[sap.m.MessageBox.Action.YES,sap.m.MessageBox.Action.NO],onClose:function(A){if(A===sap.m.MessageBox.Action.YES){window.setTimeout(function(){window.location.reload();},0);}}});}sap.ushell.services.ShellNavigationHashChanger.prototype.isInitialNavigation=function(){return this._oInitialNavigationManager&&this._oInitialNavigationManager.isInitialNavigation();};sap.ushell.services.ShellNavigationHashChanger.prototype._parametersChanged=function(n,o){return!jQuery.sap.equal(n,o);};sap.ushell.services.ShellNavigationHashChanger.prototype.setHash=function(h){this.toAppHash(h,true);};sap.ushell.services.ShellNavigationHashChanger.prototype.replaceHash=function(h){this.toAppHash(h,false);};sap.ushell.services.ShellNavigationHashChanger.prototype.getHash=function(){return this.getAppHash();};sap.ushell.services.ShellNavigationHashChanger.prototype.getAppHash=function(){var n=this.privsplitHash(hasher.getHash()),A=n&&(n.appSpecificRoute||"  ").substring(2);return A;};sap.ushell.services.ShellNavigationHashChanger.prototype.destroy=function(){hasher.changed.remove(this.treatHashChanged,this);sap.ui.core.routing.HashChanger.prototype.destroy.apply(this,arguments);};function S(C,p,s){var o=s&&s.config;this.hashChanger=new sap.ushell.services.ShellNavigationHashChanger(o);this.isInitialNavigation=function(){return this.hashChanger.isInitialNavigation();};this.hrefForExternal=function(A,v,b,d){return this.hashChanger.hrefForExternal(A,v,b,d);};this.hrefForAppSpecificHash=function(A){return this.hashChanger.hrefForAppSpecificHash(A);};this.compactParams=function(P,r,b,t){return this.hashChanger.compactParams(P,r,b,t);};this.toExternal=function(A,b,w){this.hashChanger.toExternal(A,b,w);};this.toAppHash=function(A,w){this.hashChanger.toAppHash(A,w);};this.init=function(f){hasher.prependHash="";sap.ui.core.routing.HashChanger.replaceHashChanger(this.hashChanger);var b=sap.ui.getCore().getEventBus();b.subscribe("sap.ui.core.UnrecoverableClientStateCorruption","RequestReload",a);this.hashChanger.initShellNavigation(f);return this;};this.NavigationFilterStatus=this.hashChanger.NavigationFilterStatus;this.registerNavigationFilter=function(f){this.hashChanger.registerNavigationFilter(f);};}sap.ushell.services.ShellNavigation=S;sap.ushell.services.ShellNavigation.hasNoAdapter=true;}());};if(!jQuery.sap.isDeclared('sap.ushell.services.SupportTicket')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.SupportTicket");sap.ushell.services.SupportTicket=function(a,c,p,s){var S=(s&&s.config)||{};this.createTicket=function(o){return a.createTicket(o);};this.isEnabled=function(){return S.enabled===true;};};}());};if(!jQuery.sap.isDeclared('sap.ushell.services.URLParsing')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.URLParsing");sap.ushell.services.URLParsing=function(){var r=/^(([A-Za-z0-9_\/]+)-([A-Za-z0-9_\/\-]+)(~([A-Z0-9a-z=+\/]+))?)?([?]([^&]|(&[^\/]))*&?)?$/;this.getShellHash=function(s){var a=/[^#]*#(([^&]|&[^\/])*)(&\/.*)?/,m=a.exec(s);if(m){return m[1];}return undefined;};this.getHash=function(u){var a=/#(.*)/,m=a.exec(u);if(m){return m[1];}return undefined;};this.isIntentUrl=function(u){var a=/^#/,t,l,T,L,h,p;if(typeof u!=="string"){return false;}if(!a.test(u)){t=(new URI(u)).normalize();T=t.protocol()+"://"+t.host()+t.pathname();l=(new URI(window.location.href)).normalize();L=l.protocol()+"://"+l.host()+l.pathname();if(T!==L){return false;}}h=this.getHash(u);if(!h){return false;}p=this.parseShellHash(h);if(p&&p.semanticObject&&p.action){return true;}return false;};this.parseParameters=function(p){if(!p){return{};}return jQuery.sap.getUriParameters(p).mParams||{};};this.paramsToString=function(p){return this.privparamsToString(p,"&","=");};this.privparamsToString=function(p,d,A){var f,a,k,i,l,s="";f="";a=null;l=[];for(a in p){if(p.hasOwnProperty(a)){l.push(a);}}l.sort();for(k=0;k<l.length;k=k+1){a=l[k];if(jQuery.isArray(p[a])){for(i=0;i<p[a].length;i=i+1){s+=f+encodeURIComponent(a)+A+encodeURIComponent(p[a][i]);f=d;}}else{s+=f+encodeURIComponent(a)+A+encodeURIComponent(p[a]);f=d;}}return s;};this.parseShellHash=function(h){var a=r,s,S,A,c,p,m,d;if(!h){return undefined;}s=this.splitHash(h);m=a.exec(s.shellPart);if(m){S=m[2];A=m[3];c=m[5];p=m[6];d=this.parseParameters(p);return{semanticObject:S,action:A,contextRaw:c,params:d,appSpecificRoute:s.appSpecificRoute};}if(s.appSpecificRoute){return{semanticObject:undefined,action:undefined,contextRaw:undefined,params:{},appSpecificRoute:s.appSpecificRoute};}return undefined;};this.privstripLeadingHash=function(h){if(h[0]==='#'){return h.substring(1);}return h;};this.splitHash=function(h){var a=/^(?:#|)([\S\s]*?)(&\/[\S\s]*)?$/,m,s,A;if(h===undefined||h===null||h===""){return{};}m=a.exec(h);s=m[1];if(s!==""&&!r.test(s)){return{};}A=m[2];if(s||A){return{shellPart:s,appSpecificRoute:A};}return{};};function b(u,a){if(a){return u+a;}return u;}this.constructShellHash=function(s){var c,p,d,i=null,k,l=[],f="?",a=null;if(!s){return"";}if(!s.target){s.target={};s.target.semanticObject=s.semanticObject;s.target.action=s.action;s.target.contextRaw=s.contextRaw;}if(s.target.shellHash||s.target.shellHash===""){d=this.privstripLeadingHash(s.target.shellHash);return b(d,s.appSpecificRoute);}if(s.target.semanticObject&&s.target.action){c=s.target.semanticObject+"-"+s.target.action.replace(/[?].*/,"");}else{return b("",s.appSpecificRoute);}if(s.target.contextRaw){c+="~"+s.target.contextRaw;}f="?";a=null;l=[];for(a in s.params){if(s.params.hasOwnProperty(a)){l.push(a);}}p=(s.params&&JSON.parse(JSON.stringify(s.params)))||{};if(s.appStateKey){l.push("sap-xapp-state");p["sap-xapp-state"]=s.appStateKey;}l.sort();for(k=0;k<l.length;k=k+1){a=l[k];if(jQuery.isArray(p[a])){if(p[a].length>1){jQuery.sap.log.error("Array startup parameters violate the designed intent of the Unified Shell Intent, use only single-valued parameters!");}for(i=0;i<p[a].length;i=i+1){c+=f+encodeURIComponent(a)+"="+encodeURIComponent(p[a][i]);f="&";}}else{c+=f+encodeURIComponent(a)+"="+encodeURIComponent(p[a]);f="&";}}return b(c,s.appSpecificRoute);};this.addSystemToServiceUrl=function(s,c){var R,C,S=c;if(!s||s.indexOf('/')!==0||s.indexOf('//')===0){throw new sap.ushell.utils.Error("Invalid URL: "+s,"sap.ushell.services.URLParsing");}if(c instanceof sap.ui.core.Component){C=(typeof c.getComponentData==="function")&&c.getComponentData();S=C&&C.startupParameters&&C.startupParameters["sap-system"]&&C.startupParameters["sap-system"][0];}R=sap.ushell.Container.getService("NavTargetResolution").getCurrentResolution();if(!S&&!c&&R&&R.url){S=jQuery.sap.getUriParameters(R.url).get("sap-system");}if(/^[^?]*(;mo([\/;?]|$))/.test(s)){s=s;}else if(/^[^?]*(;o=([\/;?]|$))/.test(s)){s=s.replace(/;o=([\/;?]|$)/,(S?";o="+S:"")+"$1");}else if(!/^[^?]*;o=/.test(s)&&S){s=s.replace(/(\/[^?]*?)(\/$|$|(\/?\?.*))/,"$1;o="+S+"$2");}sap.ushell.Container.addRemoteSystemForServiceUrl(s);return s;};};sap.ushell.services.URLParsing.hasNoAdapter=true;}());};if(!jQuery.sap.isDeclared('sap.ushell.services.URLShortening')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.URLShortening");jQuery.sap.require('jquery.sap.storage');sap.ushell.services.URLShortening=function(){var t=this;this.ABBREV_PARAM_NAME="sap-intent-param";this.URL_LENGTH_LIMIT=1023;this.URL_PARAMS_LENGTH_LIMIT=512;this._replaceSapXAppStateRawWithKeyIfRequired=function(v,s){var V,k;if(typeof v!=="string"||/^[A-Z0-9]{40}$/.test(v)){return v;}try{V=JSON.parse(v);}catch(e){jQuery.sap.log.error("This cannot happen: sap-xapp-state parameter value is neither key nor JSON parseable");return v;}k=s&&s.getNextKey();this._storeValue(k,V,s);return k;};this.compactHash=function(u,r,s){var S,k,R,p,U,a,b=[this.ABBREV_PARAM_NAME,"sap-system","sap-xapp-state"];if(r){r.forEach(function(A){b.push(A);});}U=sap.ushell.Container.getService("URLParsing");S=U.parseShellHash(u);if(!S){jQuery.sap.log.error("the URL is not compliant and may break in a future version "+u);}p='';if(u.charAt(0)==='#'){p='#';}var v=S&&S.params&&S.params["sap-xapp-state"]&&S.params["sap-xapp-state"][0];if(v){S.params["sap-xapp-state"]=[this._replaceSapXAppStateRawWithKeyIfRequired(v,s)];u=p+U.constructShellHash({target:{semanticObject:S.semanticObject,action:S.action,contextRaw:S.contextRaw},params:S.params,appSpecificRoute:S.appSpecificRoute});}if(typeof u!=="string"||u.length<t.URL_LENGTH_LIMIT){return{hash:u};}if(S&&((S.params&&S.params[t.ABBREV_PARAM_NAME]))){return{hash:u};}k=s&&s.getNextKey();R=this._splitParameters(S.params,b,k);if(!R.key){return{hash:u};}a=U.paramsToString(R.tailParams);this._storeValue(R.key,a,s);return{hash:p+U.constructShellHash({target:{semanticObject:S.semanticObject,action:S.action,contextRaw:S.contextRaw},params:R.headParams,appSpecificRoute:S.appSpecificRoute}),params:R.headParams,skippedParams:R.tailParams};};this.checkHashLength=function(u){var s,r,p,U;if(typeof u!=="string"||u.length<t.URL_LENGTH_LIMIT){return{hash:u};}U=sap.ushell.Container.getService("URLParsing");s=U.parseShellHash(u);p='';if(u.charAt(0)==='#'){p='#';}r=this._splitParameters(s.params,[],"DummyKey");if(r.key){jQuery.sap.log.error("Application startup parameter length exceeds "+t.URL_PARAMS_LENGTH_LIMIT+" characters, truncation occured!");delete r.headParams[this.ABBREV_PARAM_NAME];return{hash:p+U.constructShellHash({target:{semanticObject:s.semanticObject,action:s.action,contextRaw:s.contextRaw},params:r.headParams,appSpecificRoute:s.appSpecificRoute}),params:r.headParams,skippedParams:r.tailParams};}jQuery.sap.log.error("URL exceeds dangerous limits, arbitrary shortening or worse may occur!");return{hash:u};};this._findIndex=function(a,T){var r=a.indexOf(T);if(r>=0){return r;}r=-1;a.every(function(A,i){if(A.length>0&&A[A.length-1]==="*"&&A.substring(0,A.length-1)===T.substring(0,A.length-1)){r=i;return false;}return true;});return r;};this._cmpByList=function(a,A,b){var i,c;a=a||[];if(A===b){return 0;}i=this._findIndex(a,A);c=this._findIndex(a,b);if(i>=0&&c>=0){if((i-c)!==0){return i-c;}if(A<b){return-1;}if(A>b){return+1;}return 0;}if(i>=0){return-1;}if(c>=0){return+1;}if(A<b){return-1;}return+1;};this._sortByPriority=function(l,r){return l.sort(this._cmpByList.bind(this,r));};this._splitParameters=function(p,r,K){var a,i,k,h={},b={},c=false,o,d,e=0,f,l=[];if(!K||typeof K!=="string"){throw new Error("sap.ushell.services.URLShortening._splitParameters: key must be supplied!");}for(a in p){if(Object.prototype.hasOwnProperty.call(p,a)){l.push(a);}}l.sort();l=this._sortByPriority(l,r);for(k=0;k<l.length;k=k+1){a=l[k];o=p[a];if(o.length>1){jQuery.sap.log.error("Array startup parameters violate the designed intent of the Unified Shell Intent, use only single-valued parameters!");}for(i=0;i<o.length;i=i+1){d=p[a][i];f=a.length+d.length;if(f+e>this.URL_PARAMS_LENGTH_LIMIT){if(b[a]){b[a].push(d);}else{b[a]=[d];}c=true;}else if(h[a]){h[a].push(d);}else{h[a]=[d];}e=e+f+1;}}if(c){h[this.ABBREV_PARAM_NAME]=[K];}return{key:K,tailParams:b,headParams:h};};this.expandHash=function(u){var r=function(k){return t._retrieveValue(k);};return this.expandParamGivenRetrievalFunction(u,this.ABBREV_PARAM_NAME,r);};this.expandParamGivenRetrievalFunction=function(u,p,r){var s,v,k,a,b;if(typeof u!=="string"){return u;}s=sap.ushell.Container.getService("URLParsing").parseShellHash(u);k=s&&s.params&&s.params[p]&&s.params[p][0];if(!k){return u;}a='';if(u.charAt(0)==='#'){a='#';}v=r(k);if(!v){return u;}b=this._blendParameters(s.params,p,v);return a+sap.ushell.Container.getService("URLParsing").constructShellHash({target:{semanticObject:s.semanticObject,action:s.action,contextRaw:s.contextRaw},params:b,appSpecificRoute:s.appSpecificRoute});};this._retrieveValue=function(k){return undefined;};this._storeValue=function(k,v,s){if(s&&typeof s.store==="function"){s.store(v);}};this._blendParameters=function(p,P,v){var n=sap.ushell.Container.getService("URLParsing").parseParameters("?"+v),a;delete p[P];for(a in n){if(Object.prototype.hasOwnProperty.call(n,a)){if(p[a]){p[a]=p[a].concat(n[a]);}else{p[a]=n[a];}}}return p;};};sap.ushell.services.URLShortening.hasNoAdapter=true;}());};if(!jQuery.sap.isDeclared('sap.ushell.services.Ui5ComponentLoader')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.Ui5ComponentLoader");var U=function(c){this._oComponent=c;};U.onBeforeApplicationInstanceCreated=function(){jQuery.sap.require("sap.ushell.Fiori20AdapterTest");};U.prototype.getInstance=function(){return this._oComponent;};U.prototype.getMetadata=function(){return this._oComponent.getMetadata();};sap.ushell.services.Ui5ComponentLoader=function(c,p,C){this._oConfig=(C&&C.config)||{};function g(u){var P=jQuery.sap.getUriParameters(u).mParams,x=P["sap-xapp-state"],r;delete P["sap-xapp-state"];r={startupParameters:P};if(x){r["sap-xapp-state"]=x;}return r;}this.createComponent=function(a,P,w){var d=new jQuery.Deferred(),s=window["sap-ui-debug"]===true?"sap/fiori/core-ext-light-dbg.js":"sap/fiori/core-ext-light.js",b=a&&a.url,o,l=true,e=jQuery.sap.isDeclared('sap.fiori.core',true)||jQuery.sap.isDeclared('sap.fiori.core-ext-light',true),L=true,A=a&&a.applicationDependencies||{},i,u,f,h=(this._oConfig&&this._oConfig.hasOwnProperty("amendedLoading"))?this._oConfig.amendedLoading:true,j=false;if(jQuery.isArray(A.messages)){A.messages.forEach(function(m){var S=String.prototype.toLowerCase.call(m.severity||"");S=["trace","debug","info","warning","error","fatal"].indexOf(S)!==-1?S:"error";jQuery.sap.log[S](m.text,m.details,A.name);});}if(a&&a.ui5ComponentName){o=jQuery.extend(true,{},a.applicationDependencies);f=jQuery.extend(true,{startupParameters:{}},a.componentData);if(b){i=b.indexOf("?");if(i>=0){u=g(b);f.startupParameters=u.startupParameters;if(u["sap-xapp-state"]){f["sap-xapp-state"]=u["sap-xapp-state"];}b=b.slice(0,i);}}if(a.applicationConfiguration){f.config=jQuery.extend(true,{},a.applicationConfiguration);}o.componentData=f;if(a.hasOwnProperty("loadDefaultDependencies")){L=a.loadDefaultDependencies;delete a.loadDefaultDependencies;}if(this._oConfig&&this._oConfig.hasOwnProperty("loadDefaultDependencies")){L=L&&this._oConfig.loadDefaultDependencies;}L=L&&h;if(!o.asyncHints){o.asyncHints=L?{"libs":["sap.ca.scfld.md","sap.ca.ui","sap.me","sap.ui.unified"]}:{};}if(a.hasOwnProperty("loadCoreExt")){l=a.loadCoreExt;delete a.loadCoreExt;}if(l&&h&&!e){o.asyncHints.preloadBundles=o.asyncHints.preloadBundles||[];o.asyncHints.preloadBundles.push(s);}j=l&&(l||e||(h===false));if(w){o.asyncHints.waitFor=w;}if(!o.name){o.name=a.ui5ComponentName;}if(b){o.url=b;}o.async=true;if(P){o.id="application-"+P.semanticObject+"-"+P.action+"-component";U.onBeforeApplicationInstanceCreated(o);}sap.ui.component(o).then(function(k){a.componentHandle=new U(k);if(j){a.coreResourcesFullyLoaded=true;}d.resolve(a);},function(E){var m="Failed to load UI5 component with properties '"+JSON.stringify(o)+"'.",D;if(typeof E==="object"&&E.stack){D=E.stack;}else{D=E;}jQuery.sap.log.error(m,D,"sap.ushell.services.Ui5ComponentLoader");d.reject(E);});}else{d.resolve(a);}return d.promise();};};sap.ushell.services.Ui5ComponentLoader.hasNoAdapter=true;})();};if(!jQuery.sap.isDeclared('sap.ushell.services.UsageAnalytics')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.UsageAnalytics");sap.ushell.services.UsageAnalytics=function(c,p,S){var o=(S&&S.config)||{},D=[],a=false,i=false,l,I;window.oCustomProperties={};this.setLegalText=function(t){l=t;if(I){this.init(I.usageAnalyticsTitle,I.iAgree,I.iDisagree,I.remindMeLater);}};this.getLegalText=function(){return l;};this.setTrackUsageAnalytics=function(s){var d=jQuery.Deferred();var u;var b=s;var f=sap.ushell.Container.getUser().getTrackUsageAnalytics();try{var g=sap.ushell.Container.getService("UserInfo");if(f!==b){sap.ushell.Container.getUser().setTrackUsageAnalytics(b);u=g.updateUserPreferences(sap.ushell.Container.getUser());u.done(function(){sap.ushell.Container.getUser().resetChangedProperties();if(!i&&b){this.start();}else if(i&&b===false){window.swa.disable();}else if(i&&b){window.swa.enable();}d.resolve();}.bind(this));u.fail(function(E){sap.ushell.Container.getUser().setTrackUsageAnalytics(f);sap.ushell.Container.getUser().resetChangedProperties();jQuery.sap.log.error(E);d.reject(E);});}else{d.resolve();}}catch(e){jQuery.sap.log.error("Getting UserInfo service failed.");d.reject("Getting UserInfo service failed.");}return d.promise();};this.showLegalPopup=function(){setTimeout(function(){jQuery.sap.require('sap.m.MessageBox');var b=new sap.ui.layout.VerticalLayout('usageAnalyticsPopUpLayout',{content:[new sap.m.Text({text:l})]});var d=new sap.m.Dialog('agreementMessageBox',{title:I.usageAnalyticsTitle,type:'Message',stretch:sap.ui.Device.system.phone,buttons:[new sap.m.Button('remindMeLaterButton',{text:I.remindMeLater,press:function(){d.close();}}),new sap.m.Button('iAgreeButton',{text:I.iAgree,type:'Accept',press:function(){sap.ushell.Container.getService("UsageAnalytics").setTrackUsageAnalytics(true);d.close();}}),new sap.m.Button('iDisagreeButton',{text:I.iDisagree,press:function(){sap.ushell.Container.getService("UsageAnalytics").setTrackUsageAnalytics(false);d.close();}})],afterClose:function(){d.destroy();}}).addStyleClass('sapUshellUsageAnalyticsPopUp');d.addContent(b);d.open();},100);};this.systemEnabled=function(){if(!o.enabled||!o.pubToken||(this.isSetUsageAnalyticsPermitted()&&!l)){if(!o.pubToken){jQuery.sap.log.warning("No valid pubToken was found in the service configuration");}if(!l){jQuery.sap.log.warning("No Legal text message found.");}return false;}else{return true;}};this.userEnabled=function(){var u=sap.ushell.Container.getUser();if(!this.systemEnabled()){return false;}return u.getTrackUsageAnalytics();};this.start=function(){sap.ui.getCore().getEventBus().publish("sap.ushell.services.UsageAnalytics","usageAnalyticsStarted");this._initUsageAnalyticsLogging();i=true;window.swa.custom2={ref:sap.ui.getCore().getConfiguration().getLanguage()};};this.init=function(u,s,b,r){I={usageAnalyticsTitle:u,iAgree:s,iDisagree:b,remindMeLater:r};if(this.systemEnabled()&&!i){if(!this.isSetUsageAnalyticsPermitted()){this.start();}else if(l){if(this.userEnabled()===true){this.start();}else if(this.userEnabled()===null||this.userEnabled()===undefined){this.showLegalPopup();}}}};this.setCustomAttributes=function(C){var b,P="attribute",s,d="custom",e,f,F="customFunction";if(!this.userEnabled()&&this.isSetUsageAnalyticsPermitted()){return;}for(b=1;b<6;b++){e=d.concat(b+4);if(window.swa[e]!==undefined){continue;}s=P+b;if(C[s]===undefined){continue;}if(jQuery.isFunction(C[s])){f=F+b;window[f]=C[s];window.swa[e]={ref:f};}else{window.swa[e]={ref:C[s]};}}};this.logCustomEvent=function(e,b,A){if(!this.userEnabled()&&this.isSetUsageAnalyticsPermitted()){return;}if(!this._isAnalyticsScriptLoaded()){this._addDelayedEvent(e,b,A);return;}if(A){A.unshift(b);A.unshift(e);window.swa.trackCustomEvent.apply(window.swa.trackCustomEvent,A);}else{window.swa.trackCustomEvent(e,b);}};window._trackingScriptsLoaded=function(){var b,t;a=true;for(b=0;b<D.length;b++){t=D[b];this.logCustomEvent(t.eventType,t.customEventValue,t.aAdditionalValues);}D=null;};this._initUsageAnalyticsLogging=function(){if(window.swa===undefined){window.swa={};}window.swa.pubToken=o.pubToken;window.swa.baseUrl=o.baseUrl;window.swa.bannerEnabled=false;window.swa.loggingEnabled=true;window.swa.visitorCookieTimeout=63113852;window.swa.dntLevel=1;window.swa.trackerReadyCallback=window._trackingScriptsLoaded.bind(this);window.swa.clicksEnabled=(o.logClickEvents===false?false:true);window.swa.pageLoadEnabled=(o.logPageLoadEvents===false?false:true);this._handlingTrackingScripts();};this._handlingTrackingScripts=function(){var d=document,g=d.createElement('script'),s=d.getElementsByTagName('script')[0];g.onerror=function(){jQuery.sap.log.warning("SWA scripts not loaded!");};g.type='text/javascript';g.defer=true;g.async=true;g.src=window.swa.baseUrl+'js/privacy.js';s.parentNode.insertBefore(g,s);};this._isAnalyticsScriptLoaded=function(){return a;};this.isSetUsageAnalyticsPermitted=function(){if(o.setUsageAnalyticsPermitted===undefined){return true;}return o.setUsageAnalyticsPermitted;};this._addDelayedEvent=function(e,b,A){var d={eventType:e,customEventValue:b,aAdditionalValues:A};D.push(d);};};sap.ushell.services.UsageAnalytics.hasNoAdapter=true;}());};if(!jQuery.sap.isDeclared('sap.ushell.services.UserDefaultParameterPersistence')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.UserDefaultParameterPersistence");var v=["value","extendedValue","noEdit","alwaysAskPlugin","_shellData","pluginData"];sap.ushell.services.UserDefaultParameterPersistence=function(a,c,p,C){this._oAdapter=a;this._oData={};};sap.ushell.services.UserDefaultParameterPersistence.prototype._cleanseValue=function(V){var r=jQuery.extend(true,{},V),a;for(a in r){if(r.hasOwnProperty(a)){if(v.indexOf(a)<0){delete r[a];}}}return r;};sap.ushell.services.UserDefaultParameterPersistence.prototype._testValue=function(V){return true;};sap.ushell.services.UserDefaultParameterPersistence.prototype.loadParameterValue=function(p){var d=new jQuery.Deferred(),t=this;if(this._oData[p]){d.resolve(this._oData[p]);}else{this._oAdapter.loadParameterValue(p).done(function(V){var c=t._cleanseValue(V);if(t._testValue(c)){d.resolve(c);}else{jQuery.sap.log.error("flawed value returned from persistence");d.reject("flawed value returned from persistence");}}).fail(d.reject.bind(this));}return d.promise();};sap.ushell.services.UserDefaultParameterPersistence.prototype.saveParameterValue=function(p,V){var d,c;if(!V){return this.deleteParameter(p);}c=this._cleanseValue(V);d=new jQuery.Deferred();if(!this._testValue(c)||(V&&V.noStore===true)){return d.resolve().promise();}this._oData[p]=c;return this._oAdapter.saveParameterValue(p,c);};sap.ushell.services.UserDefaultParameterPersistence.prototype.deleteParameter=function(p){delete this._oData[p];return this._oAdapter.deleteParameter(p);};sap.ushell.services.UserDefaultParameterPersistence.prototype.getStoredParameterNames=function(){var d=new jQuery.Deferred();this._oAdapter.getStoredParameterNames().done(function(r){r.sort();d.resolve(r);}).fail(d.reject.bind(d));return d.promise();};}());};if(!jQuery.sap.isDeclared('sap.ushell.services.UserDefaultParameters')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.UserDefaultParameters");var e="valueStored";var r=["value","noEdit","noStore","extendedValue","alwaysAskPlugin"];sap.ushell.services.UserDefaultParameters=function(a,c,p,C){this._aPlugins=[];this._oUserDefaultParametersNames=undefined;var t=this,s=new sap.ui.base.EventProvider();function g(P){var v=(typeof P.getComponentData==="function"&&P.getComponentData()&&P.getComponentData().config&&P.getComponentData().config["sap-priority"])||0;if(typeof v!=="number"||isNaN(v)){return 0;}return v;}this._insertPluginOrdered=function(P,o){var f=g(o),i,h;for(i=0;(i<P.length)&&o;++i){h=g(P[i]);if(o&&(f>h)){P.splice(i,0,o);o=undefined;}}if(o){P.push(o);}return P;};this.registerPlugin=function(P){this._aPlugins=this._insertPluginOrdered(this._aPlugins,P);};function b(i,P,f,v,D){if(i>=P.length){D.resolve(v);return;}if(typeof P[i].getUserDefault!=="function"){b(i+1,P,f,v,D);return;}P[i].getUserDefault(f,v).done(function(n){if(n){b(i+1,P,f,n,D);}else{b(i+1,P,f,v,D);}}).fail(function(){jQuery.sap.log.error("invocation of getUserDefault(\""+f+"\") for plugin "+t._getComponentNameOfPlugin(P[i])+" rejected.",null,"sap.ushell.services.UserDefaultParameters");b(i+1,P,f,v,D);});return;}function d(o){return jQuery.extend(true,{},o);}this._getStoreDate=function(){return new Date().toString();};this._storeValue=function(P,v,f){var h=new jQuery.Deferred();var D=new jQuery.Deferred();if(f&&v.extendedValue){sap.ushell.Container.getService("ClientSideTargetResolution").getUserDefaultParameterNames(true).done(function(o){var E=t._extractKeyArrays(o);var i=E.extended;D.resolve(i.indexOf(P)<0);}).fail(function(){D.resolve(false);});}else{D.resolve(false);}D.done(function(R){if(R){v.extendedValue=undefined;}if(f&&t._isInitial(v)){v=undefined;}else{v._shellData=jQuery.extend(true,{storeDate:t._getStoreDate()},v._shellData);}sap.ushell.Container.getService("UserDefaultParameterPersistence").saveParameterValue(P,v).always(function(){var S={parameterName:P,parameterValue:d(v)};s.fireEvent(e,S);h.resolve(P);});});return h.promise();};this._getCurrentValue=function(P){var D=new jQuery.Deferred();sap.ushell.Container.getService("UserDefaultParameterPersistence").loadParameterValue(P).done(function(v){D.resolve(v);}).fail(function(){D.resolve({value:undefined});});return D.promise();};this._isNeverSetValue=function(v){return!v||(!v._shellData&&!v.value&&!v.extendedValue);};this._isInitial=function(v){return!(v&&(v.value||v.extendedValue));};this._isStoreDistinct=function(v,V){return!r.every(function(m){return(v[m]===V[m]||jQuery.sap.equal(v[m],V[m]));});};this._getUserDefaultParameterNames=function(){if(!this._oUserDefaultParametersNames){this._oUserDefaultParametersNames=new jQuery.Deferred();sap.ushell.Container.getService("ClientSideTargetResolution").getUserDefaultParameterNames(true).done(function(P){var E=t._extractKeyArrays(P);var f=E.extended;var A=E.allParameters;var m=t._arrayToObject(A);if(m.length===0){t._oUserDefaultParametersNames.resolve({});}else{t._oUserDefaultParametersNames.resolve({aAllParameterNames:A,aExtendedParameterNames:f,oMetadataObject:m});}});}return this._oUserDefaultParametersNames.promise();};this._isRelevantParameter=function(P){var D=new jQuery.Deferred();this._getUserDefaultParameterNames().done(function(R){if(R.aAllParameterNames&&R.aAllParameterNames.indexOf(P)!==-1){D.resolve();}else{D.reject();}});return D.promise();};this.hasRelevantMaintainableParameters=function(){var t=this,R=new jQuery.Deferred(),h=false,G=[];t._getUserDefaultParameterNames().done(function(P){if(!jQuery.isEmptyObject(P)&&P.aAllParameterNames){P.aAllParameterNames.forEach(function(f){var o=t.getValue(f);G.push(o);o.done(function(v){if(v&&!v.hasOwnProperty("noEdit")){h=true;return;}});});jQuery.when.apply(undefined,G).done(function(){R.resolve(h);}).fail(function(){R.resolve();});}else{R.resolve();}});return R.promise();};this.getValue=function(P){var t=this,D=new jQuery.Deferred(),o=new jQuery.Deferred();this._isRelevantParameter(P).fail(function(){D.resolve({});}).done(function(){t._getCurrentValue(P).done(function(v){var O;if(!v){v={};}O=d(v);if((v._shellData||!t._isInitial(v))&&!v.noStore&&!v.alwaysAskPlugin){o.resolve(v);}else{sap.ushell.Container.getService("PluginManager").loadPlugins("UserDefaults").done(function(){b(0,t._aPlugins,P,v,o);}).fail(function(){jQuery.sap.log.error("Cannot get value for "+P+". One or more plugins could not be loaded.");o.reject("Initialization of plugins failed");});}o.done(function(n){if(t._isNeverSetValue(O)||t._isStoreDistinct(O,n)){t._storeValue(P,n);}D.resolve(n);}).fail(D.reject.bind(D));});});return D.promise();};this._addParameterValuesToParameters=function(P,f){var D=new jQuery.Deferred();var h=[];var t=this;f.forEach(function(i){var n=t.getValue(i);h.push(n);n.done(function(v){P[i].valueObject=v;});});jQuery.when.apply(jQuery,h).done(D.resolve.bind(D,P)).fail(D.reject.bind(D,P));return D.promise();};this._arrayToObject=function(P){var R={};P.forEach(function(f){R[f]={};});return R;};this._getComponentNameOfPlugin=function(P){if(typeof P!=="object"||typeof P.getMetadata!=="function"||!P.getMetadata()||typeof P.getMetadata().getComponentName!=="function"){return"'name of plugin could not be determined'";}return P.getMetadata().getComponentName()||"";};this._getEditorDataAndValue=function(D,A,E,m){var t=this;var P=[];var R=[];t._aPlugins.forEach(function(o,i){if(typeof o.getEditorMetadata==="function"){var n=new jQuery.Deferred();P.push(n);try{var f=P.length-1;o.getEditorMetadata(m).done(function(j){R[f]=j;}).always(function(){n.resolve();}).fail(function(){jQuery.sap.log.error("EditorMetadata for plugin "+t._getComponentNameOfPlugin(o)+"cannot be invoked.",null,"sap.ushell.services.UserDefaultParameters");n.resolve();});}catch(h){jQuery.sap.log.error("Error invoking getEditorMetaData on plugin: "+h+h.stack,null,"sap.ushell.services.UserDefaultParameters");n.resolve();}}});jQuery.when.apply(jQuery,P).done(function(){var f=[];var o=R.reverse().reduce(function(h,n){A.forEach(function(i){if(n[i]&&n[i].editorMetadata){h[i].editorMetadata=n[i].editorMetadata;}});return h;},m);A.forEach(function(h){if(!(o[h]&&o[h].editorMetadata)){f.push(h);}});t._addParameterValuesToParameters(o,A).done(function(h){var i=jQuery.extend(true,{},h),k;E.forEach(function(j){if(i[j]){i[j].editorMetadata=i[j].editorMetadata||{};i[j].editorMetadata.extendedUsage=true;}});k=Object.keys(i).splice(0);k.forEach(function(j){var l;if(i[j].valueObject&&i[j].valueObject.noEdit===true){delete i[j];l=f.indexOf(j);if(l>=0){f.splice(l,1);}}});if(f.length>0){jQuery.sap.log.error("The following parameter names have no editor metadata and thus likely no configured plugin:\n\""+f.join("\",\n\"")+"\".");}D.resolve(i);}).fail(D.reject.bind(D));});};this.editorGetParameters=function(){var D=new jQuery.Deferred();var t=this;this._getUserDefaultParameterNames().done(function(P){if(P.oMetadataObject.length===0){D.resolve({});}else{sap.ushell.Container.getService("PluginManager").loadPlugins("UserDefaults").done(function(){t._getEditorDataAndValue(D,P.aAllParameterNames,P.aExtendedParameterNames,P.oMetadataObject);}).fail(function(){jQuery.sap.log.error("One or more plugins could not be loaded");D.reject("Initialization of plugins failed");});}});return D.promise();};this._extractKeyArrays=function(P){var R={extended:[],simple:[],allParameters:[]};R.simple=(P&&P.simple&&Object.keys(P.simple).sort())||[];R.extended=(P&&P.extended&&Object.keys(P.extended).sort())||[];R.allParameters=R.simple.concat(R.extended.filter(function(S){return R.simple.indexOf(S)<0;})).sort();return R;};this.editorSetValue=function(P,v){return this._storeValue(P,v,true);};this.attachValueStored=function(f){s.attachEvent(e,f);};this.detachValueStored=function(f){s.detachEvent(e,f);};};sap.ushell.services.UserDefaultParameters.hasNoAdapter=true;}());};if(!jQuery.sap.isDeclared('sap.ushell.services.UserInfo')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.UserInfo");sap.ushell.services.UserInfo=function(a,c){this.getId=function(){return sap.ushell.Container.getUser().getId();};this.getUser=function(){return sap.ushell.Container.getUser();};this.getThemeList=function(){if(this.getUser().isSetThemePermitted()===false){jQuery.sap.log.error("getThemeList failed");throw true;}var p=a.getThemeList();p.fail(function(){jQuery.sap.log.error("getThemeList failed");});return p;};this.updateUserPreferences=function(){var p=a.updateUserPreferences(sap.ushell.Container.getUser());p.fail(function(){jQuery.sap.log.error("updateAttributes: ");});return p;};};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.appfinder.AppBox')){jQuery.sap.declare("sap.ushell.ui.appfinder.AppBox");jQuery.sap.require('sap.ui.core.Control');sap.ui.core.Control.extend("sap.ushell.ui.appfinder.AppBox",{metadata:{library:"sap.ushell",properties:{"title":{type:"string",group:"Misc",defaultValue:null},"subtitle":{type:"string",group:"Misc",defaultValue:null},"icon":{type:"string",group:"Misc",defaultValue:null},"url":{type:"string",group:"Misc",defaultValue:null}},aggregations:{"pinButton":{type:"sap.m.Button",multiple:false}},events:{"press":{},"afterRendering":{}}}});sap.ushell.ui.appfinder.AppBox.M_EVENTS={'press':'press','afterRendering':'afterRendering'};(function(){"use strict";sap.ushell.ui.appfinder.AppBox.prototype.init=function(){};sap.ushell.ui.appfinder.AppBox.prototype.onAfterRendering=function(){this._adjustHeaderElementsHeight();this.fireAfterRendering();};sap.ushell.ui.appfinder.AppBox.prototype.setTitle=function(t){this.setProperty("title",t,true);};sap.ushell.ui.appfinder.AppBox.prototype.setUrl=function(i){this.setProperty("url",i,true);};sap.ushell.ui.appfinder.AppBox.prototype.onclick=function(e){this.firePress(e);};sap.ushell.ui.appfinder.AppBox.prototype.onsapspace=function(e){e.preventDefault();this.firePress(e);};sap.ushell.ui.appfinder.AppBox.prototype._adjustHeaderElementsHeight=function(){var j=this.$().find(".sapUshellAppBoxTitle");var t=this._getNumberOfLines(j);var a=this.$().find(".sapUshellAppBoxSubtitle");if(t===2){j.addClass('sapUshellAppBoxHeaderElementTwoLines');a.addClass('sapUshellAppBoxHeaderElementOneLine');}else{j.addClass('sapUshellAppBoxHeaderElementOneLine');a.addClass('sapUshellAppBoxHeaderElementTwoLines');}};sap.ushell.ui.appfinder.AppBox.prototype._getNumberOfLines=function(j){var l=parseInt(j.css("line-height"),10);var h=j.height();if(!h){return 0;}return((h/l)>1)?2:1;};sap.ushell.ui.appfinder.AppBox.prototype.onsapenter=sap.ushell.ui.appfinder.AppBox.prototype.onsapspace;}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.appfinder.AppBoxRenderer')){(function(){"use strict";jQuery.sap.require('sap.ui.core.Control');jQuery.sap.declare("sap.ushell.ui.appfinder.AppBoxRenderer");sap.ushell.ui.appfinder.AppBoxRenderer=sap.ui.core.Renderer.extend(sap.ui.core.Control);sap.ushell.ui.appfinder.AppBoxRenderer.render=function(r,a){var c=a.getParent(),A=c.getAppBoxesContainer?c.getAppBoxesContainer():[],v=A.filter(function(a){return a.getVisible();}),C=v.indexOf(a)>-1?v.indexOf(a)+1:"",s=a.getTitle();s=a.getSubtitle()?s+" "+a.getSubtitle():s;r.write("<li");r.writeControlData(a);r.addClass("sapUshellAppBox");r.writeAccessibilityState(a,{role:"option",posinset:C,setsize:v.length});r.writeAttribute("aria-label",s);r.writeAttribute("aria-describedby",a.getParent().getId()+"-groupheader");r.writeClasses();r.write(">");r.write("<div");r.addClass("sapUshellAppBoxInner");r.writeClasses();r.write(">");var h=a.getIcon();if(h){var i=new sap.ui.core.Icon({src:a.getIcon()});i.addStyleClass("sapUshellAppBoxIcon");r.renderControl(i);}r.write("<div");if(h){r.addClass("sapUshellAppBoxHeader");}else{r.addClass("sapUshellAppBoxHeaderNoIcon");}r.writeClasses();r.write(">");r.write("<div");r.addClass("sapUshellAppBoxTitle");r.writeClasses();r.write(">");r.writeEscaped(a.getTitle());r.write("</div>");if(a.getSubtitle()){r.write("<div");r.addClass("sapUshellAppBoxSubtitle");r.writeClasses();r.write(">");r.writeEscaped(a.getSubtitle());r.write("</div>");}r.write("</div>");r.renderControl(a.getPinButton());r.write("</div>");r.write("</li>");};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.appfinder.PinButton')){jQuery.sap.declare('sap.ushell.ui.appfinder.PinButton');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.Button');sap.ui.define("sap/ushell/ui/appfinder/PinButton",['jquery.sap.global','sap/m/Button'],function(q,C){"use strict";var P=C.extend("sap.ushell.ui.appfinder.PinButton",{metadata:{properties:{selected:{type:"boolean",group:"Appearance",defaultValue:false}}},renderer:{}});P.prototype.setSelected=function(s){this.setProperty("selected",s,true);this.$("inner").toggleClass("sapUshellPinSelected",s);};P.prototype.onAfterRendering=function(){var s=this.getSelected();this.$("inner").toggleClass("sapUshellPinSelected",s);};return P;});};if(!jQuery.sap.isDeclared('sap.ushell.ui.footerbar.AddBookmarkButton')){jQuery.sap.declare("sap.ushell.ui.footerbar.AddBookmarkButton");jQuery.sap.require('sap.m.Button');sap.m.Button.extend("sap.ushell.ui.footerbar.AddBookmarkButton",{metadata:{library:"sap.ushell",properties:{"beforePressHandler":{type:"any",group:"Misc",defaultValue:null},"afterPressHandler":{type:"any",group:"Misc",defaultValue:null},"title":{type:"string",group:"Misc",defaultValue:null},"subtitle":{type:"string",group:"Misc",defaultValue:null},"info":{type:"string",group:"Misc",defaultValue:null},"tileIcon":{type:"string",group:"Misc",defaultValue:null},"numberUnit":{type:"string",group:"Misc",defaultValue:null},"keywords":{type:"string",group:"Misc",defaultValue:null},"customUrl":{type:"any",group:"Misc",defaultValue:null},"serviceUrl":{type:"any",group:"Misc",defaultValue:null},"serviceRefreshInterval":{type:"string",group:"Misc",defaultValue:null},"showGroupSelection":{type:"boolean",group:"Misc",defaultValue:true},"appData":{type:"object",group:"Misc",defaultValue:null}}}});(function(){"use strict";jQuery.sap.require('sap.ui.layout.form.SimpleForm');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.Input');jQuery.sap.require('sap.m.Dialog');jQuery.sap.require('sap.m.Button');jQuery.sap.declare("sap.ushell.ui.footerbar.AddBookmarkButton");sap.ushell.ui.footerbar.AddBookmarkButton.prototype.init=function(){this.setIcon('sap-icon://add-favorite');this.setText(sap.ushell.resources.i18n.getText("addToHomePageBtn"));this.setEnabled();this.oModel=new sap.ui.model.json.JSONModel({showGroupSelection:true,title:'',subtitle:'',numberValue:'',info:'',icon:'',numberUnit:'',keywords:''});var t=this;this.attachPress(function(){if(t.getBeforePressHandler()){t.getBeforePressHandler()();}t.showAddBookmarkDialog(function(){if(t.getAfterPressHandler()){t.getAfterPressHandler()();}});});if(sap.m.Button.prototype.init){sap.m.Button.prototype.init.apply(this,arguments);}};sap.ushell.ui.footerbar.AddBookmarkButton.prototype.exit=function(){if(this.oDialog){this.oDialog.destroy();}if(this.oModel){this.oModel.destroy();}if(sap.m.Button.prototype.exit){sap.m.Button.prototype.exit.apply(this,arguments);}};sap.ushell.ui.footerbar.AddBookmarkButton.prototype.setBookmarkTileView=function(v){this.bookmarkTileView=v;};sap.ushell.ui.footerbar.AddBookmarkButton.prototype.getBookmarkTileView=function(){return this.bookmarkTileView;};sap.ushell.ui.footerbar.AddBookmarkButton.prototype.showAddBookmarkDialog=function(c){this.oResourceBundle=sap.ushell.resources.i18n;this.appData=this.getAppData()||{};var t=this;this.cb=c;var i=jQuery.isEmptyObject(this.appData),b=sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.ushell.ui.footerbar.SaveAsTile",viewData:{appData:this.appData,serviceUrl:i?this.getServiceUrl():this.appData.serviceUrl,customUrl:i?this.getCustomUrl():this.appData.customUrl,numberUnit:i?this.getNumberUnit():this.appData.numberUnit,serviceRefreshInterval:i?this.getServiceRefreshInterval():this.appData.serviceRefreshInterval,keywords:i?this.getKeywords():this.appData.keywords}});if(jQuery.isEmptyObject(this.appData)){b.setModel(this.oModel);}t.setBookmarkTileView(b);this.oSimpleForm=new sap.ui.layout.form.SimpleForm({id:'bookmarkFormId',layout:sap.ui.layout.form.SimpleFormLayout.GridLayout,content:[b]}).addStyleClass("sapUshellAddBookmarkForm");t._openDialog(this.oSimpleForm);b.getTitleInput().attachLiveChange(function(){this.setValueState(sap.ui.core.ValueState.NONE);});};sap.ushell.ui.footerbar.AddBookmarkButton.prototype._openDialog=function(c){var o=new sap.m.Button('bookmarkOkBtn',{text:this.oResourceBundle.getText('okBtn'),press:this._handleOkButtonPress.bind(this)}),a=new sap.m.Button('bookmarkCancelBtn',{text:this.oResourceBundle.getText('cancelBtn'),press:function(){this.oDialog.close();this.cb();}.bind(this)});this.oDialog=new sap.m.Dialog({id:'bookmarkDialog',title:this.oResourceBundle.getText('addToHomePageBtn'),contentWidth:'25rem',content:c,beginButton:o,endButton:a,stretch:sap.ui.Device.system.phone,horizontalScrolling:false,afterClose:function(){this.oDialog.destroy();delete(this.oDialog);}.bind(this)});this.oDialog.open();return this.oDialog;};sap.ushell.ui.footerbar.AddBookmarkButton.prototype.setTitle=function(t){this.setProperty("title",t,true);this.oModel.setProperty("/title",t);};sap.ushell.ui.footerbar.AddBookmarkButton.prototype.setSubtitle=function(s){this.setProperty("subtitle",s,true);this.oModel.setProperty("/subtitle",s);};sap.ushell.ui.footerbar.AddBookmarkButton.prototype.setInfo=function(i){this.setProperty("info",i,true);this.oModel.setProperty("/info",i);};sap.ushell.ui.footerbar.AddBookmarkButton.prototype.setTileIcon=function(i){this.setProperty("tileIcon",i,true);this.oModel.setProperty("/icon",i);};sap.ushell.ui.footerbar.AddBookmarkButton.prototype.setShowGroupSelection=function(s){this.setProperty("showGroupSelection",s,true);this.oModel.setProperty("/showGroupSelection",s);};sap.ushell.ui.footerbar.AddBookmarkButton.prototype.setNumberUnit=function(n){this.setProperty("numberUnit",n,true);this.oModel.setProperty("/numberUnit",n);};sap.ushell.ui.footerbar.AddBookmarkButton.prototype.setKeywords=function(k){this.setProperty("keywords",k,true);this.oModel.setProperty("/keywords",k);};sap.ushell.ui.footerbar.AddBookmarkButton.prototype._restoreDialogEditableValuesToDefault=function(){if(this.oModel){this.oModel.setProperty('/title',this.getTitle());this.oModel.setProperty('/subtitle',this.getSubtitle());this.oModel.setProperty('/info',this.getInfo());}};sap.ushell.ui.footerbar.AddBookmarkButton.prototype._handleOkButtonPress=function(){var b=this.getBookmarkTileView(),d=b.getBookmarkTileData(),t=d.group?d.group.object:"";if(!d.title){var T=sap.ui.getCore().byId("bookmarkTitleInput");if(T){T.setValueState(sap.ui.core.ValueState.Error);T.setValueStateText(sap.ushell.resources.i18n.getText("bookmarkTitleInputError"));return;}}delete d.group;var r=sap.ushell.Container.getService("Bookmark").addBookmark(d,t),R=sap.ushell.resources.i18n;r.done(function(){jQuery.proxy(this._restoreDialogEditableValuesToDefault(),this);if(sap.ushell.Container){sap.ushell.Container.getService('Message').info(R.getText('tile_created_msg'));}}.bind(this));r.fail(function(m){jQuery.sap.log.error("Failed to add bookmark",m,"sap.ushell.ui.footerbar.AddBookmarkButton");if(sap.ushell.Container){sap.ushell.Container.getService('Message').error(R.getText('fail_to_add_tile_msg'));}});this.oDialog.close();this.cb();};sap.ushell.ui.footerbar.AddBookmarkButton.prototype.setEnabled=function(e){var s="",p=true,S;if(sap.ushell.renderers&&sap.ushell.renderers.fiori2){S=sap.ushell.renderers.fiori2.RendererExtensions.getConfiguration();if(S.appState){s=S.appState;}if(S.enablePersonalization!==undefined){p=S.enablePersonalization;}}if(s==='headerless'||s==='standalone'||s==='embedded'||s==='merged'||!p){e=false;}if(!sap.ushell.Container){if(this.getEnabled()){jQuery.sap.log.warning("Disabling 'Save as Tile' button: unified shell container not initialized",null,"sap.ushell.ui.footerbar.AddBookmarkButton");}e=false;}sap.m.Button.prototype.setEnabled.call(this,e);if(!e){this.addStyleClass("sapUshellAddBookmarkButton");}};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.footerbar.AddBookmarkButtonRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.footerbar.AddBookmarkButtonRenderer");jQuery.sap.require('sap.ui.core.Renderer');jQuery.sap.require('sap.m.ButtonRenderer');sap.ushell.ui.footerbar.AddBookmarkButtonRenderer=sap.ui.core.Renderer.extend(sap.m.ButtonRenderer);}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.footerbar.JamDiscussButton')){jQuery.sap.declare("sap.ushell.ui.footerbar.JamDiscussButton");jQuery.sap.require('sap.m.Button');sap.m.Button.extend("sap.ushell.ui.footerbar.JamDiscussButton",{metadata:{library:"sap.ushell",properties:{"beforePressHandler":{type:"any",group:"Misc",defaultValue:null},"afterPressHandler":{type:"any",group:"Misc",defaultValue:null},"jamData":{type:"object",group:"Misc",defaultValue:null}}}});(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.footerbar.JamDiscussButton");sap.ushell.ui.footerbar.JamDiscussButton.prototype.init=function(){jQuery.sap.require("sap.ushell.services.Container");var t=this;this.setEnabled();this.setIcon('sap-icon://discussion-2');this.setText(sap.ushell.resources.i18n.getText("discussBtn"));this.attachPress(function(){if(t.getBeforePressHandler()){t.getBeforePressHandler()();}this.showDiscussDialog(t.getAfterPressHandler());});if(sap.m.Button.prototype.init){sap.m.Button.prototype.init.apply(this,arguments);}};sap.ushell.ui.footerbar.JamDiscussButton.prototype.showDiscussDialog=function(c){jQuery.sap.require('sap.collaboration.components.fiori.feed.dialog.Component');if(!this.discussComponent){this.discussComponent=sap.ui.getCore().createComponent({name:"sap.collaboration.components.fiori.feed.dialog"});}this.discussComponent.setSettings(this.getJamData());this.discussComponent.open();if(c){c();}};sap.ushell.ui.footerbar.JamDiscussButton.prototype.setEnabled=function(e){if(!sap.ushell.Container){if(this.getEnabled()){jQuery.sap.log.warning("Disabling JamDiscussButton: unified shell container not initialized",null,"sap.ushell.ui.footerbar.JamDiscussButton");}e=false;}else{var u=sap.ushell.Container.getUser();if(!(u&&u.isJamActive())){if(this.getEnabled()){jQuery.sap.log.info("Disabling JamDiscussButton: user not logged in or Jam not active",null,"sap.ushell.ui.footerbar.JamDiscussButton");}e=false;this.setVisible(false);}}sap.m.Button.prototype.setEnabled.call(this,e);};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.footerbar.JamDiscussButtonRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.footerbar.JamDiscussButtonRenderer");jQuery.sap.require('sap.ui.core.Renderer');jQuery.sap.require('sap.m.ButtonRenderer');sap.ushell.ui.footerbar.JamDiscussButtonRenderer=sap.ui.core.Renderer.extend(sap.m.ButtonRenderer);}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.footerbar.JamShareButton')){jQuery.sap.declare("sap.ushell.ui.footerbar.JamShareButton");jQuery.sap.require('sap.m.Button');sap.m.Button.extend("sap.ushell.ui.footerbar.JamShareButton",{metadata:{library:"sap.ushell",properties:{"beforePressHandler":{type:"any",group:"Misc",defaultValue:null},"afterPressHandler":{type:"any",group:"Misc",defaultValue:null},"jamData":{type:"object",group:"Misc",defaultValue:null}}}});(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.footerbar.JamShareButton");sap.ushell.ui.footerbar.JamShareButton.prototype.init=function(){jQuery.sap.require("sap.ushell.services.Container");var t=this;this.setEnabled();this.setIcon('sap-icon://share-2');this.setText(sap.ushell.resources.i18n.getText("shareBtn"));this.attachPress(function(){if(t.getBeforePressHandler()){t.getBeforePressHandler()();}this.showShareDialog(t.getAfterPressHandler());});if(sap.m.Button.prototype.init){sap.m.Button.prototype.init.apply(this,arguments);}};sap.ushell.ui.footerbar.JamShareButton.prototype.showShareDialog=function(c){jQuery.sap.require('sap.collaboration.components.fiori.sharing.dialog.Component');if(!this.shareComponent){this.shareComponent=sap.ui.getCore().createComponent({name:"sap.collaboration.components.fiori.sharing.dialog"});}this.shareComponent.setSettings(this.getJamData());this.shareComponent.open();if(c){c();}};sap.ushell.ui.footerbar.JamShareButton.prototype.exit=function(){if(this.shareComponent){this.shareComponent.destroy();}if(sap.m.Button.prototype.exit){sap.m.Button.prototype.exit.apply(this,arguments);}};sap.ushell.ui.footerbar.JamShareButton.prototype.setEnabled=function(e){if(!sap.ushell.Container){if(this.getEnabled()){jQuery.sap.log.warning("Disabling JamShareButton: unified shell container not initialized",null,"sap.ushell.ui.footerbar.JamShareButton");}e=false;}else{var u=sap.ushell.Container.getUser();if(!(u&&u.isJamActive())){if(this.getEnabled()){jQuery.sap.log.info("Disabling JamShareButton: user not logged in or Jam not active",null,"sap.ushell.ui.footerbar.JamShareButton");}e=false;this.setVisible(false);}}sap.m.Button.prototype.setEnabled.call(this,e);};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.footerbar.JamShareButtonRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.footerbar.JamShareButtonRenderer");jQuery.sap.require('sap.ui.core.Renderer');jQuery.sap.require('sap.m.ButtonRenderer');sap.ushell.ui.footerbar.JamShareButtonRenderer=sap.ui.core.Renderer.extend(sap.m.ButtonRenderer);}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.footerbar.SettingsButton')){jQuery.sap.declare("sap.ushell.ui.footerbar.SettingsButton");jQuery.sap.require('sap.m.Button');sap.m.Button.extend("sap.ushell.ui.footerbar.SettingsButton",{metadata:{library:"sap.ushell"}});(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.footerbar.SettingsButton");sap.ushell.ui.footerbar.SettingsButton.prototype.init=function(){jQuery.sap.require("sap.ushell.ui.footerbar.AboutButton");jQuery.sap.require("sap.ushell.ui.footerbar.UserPreferencesButton");jQuery.sap.require("sap.ushell.ui.footerbar.LogoutButton");this.setIcon('sap-icon://action-settings');this.setTooltip(sap.ushell.resources.i18n.getText("helpBtn_tooltip"));this.attachPress(this.showSettingsMenu);var a=new sap.ushell.ui.footerbar.AboutButton(),u=new sap.ushell.ui.footerbar.UserPreferencesButton(),l=new sap.ushell.ui.footerbar.LogoutButton();this.defaultMenuItems=[a,u,l];if(sap.m.Button.prototype.init){sap.m.Button.prototype.init.apply(this,arguments);}};sap.ushell.ui.footerbar.SettingsButton.prototype.setMenuItems=function(b){this.menuItems=b;};sap.ushell.ui.footerbar.SettingsButton.prototype.showSettingsMenu=function(){var a=new sap.m.ActionSheet({id:'settingsMenu',showHeader:false,buttons:(this.menuItems||[]).concat(this.defaultMenuItems)});a.setPlacement(sap.m.PlacementType.Vertical);a.openBy(this);a.attachAfterClose(function(){a.removeAllButtons();a.destroy();});};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.footerbar.SettingsButtonRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.footerbar.SettingsButtonRenderer");jQuery.sap.require('sap.ui.core.Renderer');jQuery.sap.require('sap.m.ButtonRenderer');sap.ushell.ui.footerbar.SettingsButtonRenderer=sap.ui.core.Renderer.extend(sap.m.ButtonRenderer);}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.AccessibilityCustomData')){
/*!
 * ${copyright}
 */
jQuery.sap.declare('sap.ushell.ui.launchpad.AccessibilityCustomData');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.CustomData');sap.ui.define("sap/ushell/ui/launchpad/AccessibilityCustomData",['jquery.sap.global','sap/ui/core/CustomData','sap/ushell/library'],function(q,C,l){"use strict";var A=C.extend("sap.ushell.ui.launchpad.AccessibilityCustomData"),o=C.prototype._checkWriteToDom;A.prototype._checkWriteToDom=function(r){var k=this.getKey().toLowerCase(),i=sap.ui.getCore().getConfiguration().getAccessibility();if(!i){return;}if(k.indexOf("aria")===0||k==="role"||k==="tabindex"){if(!this.getWriteToDom()){return null;}var v=this.getValue();if(typeof v!="string"){q.sap.log.error("CustomData with key "+k+" should be written to HTML of "+r+" but the value is not a string.");return null;}if(!(sap.ui.core.ID.isValid(k))||(k.indexOf(":")!=-1)){q.sap.log.error("CustomData with key "+k+" should be written to HTML of "+r+" but the key is not valid (must be a valid sap.ui.core.ID without any colon).");return null;}if(k==q.sap._FASTNAVIGATIONKEY){v=/^\s*(x|true)\s*$/i.test(v)?"true":"false";}else if(k.indexOf("sap-ui")==0){q.sap.log.error("CustomData with key "+k+" should be written to HTML of "+r+" but the key is not valid (may not start with 'sap-ui').");return null;}return{key:k,value:v};}else{return o.apply(this,arguments);}};return A;},true);};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.ActionItem')){
/*!
 * Copyright (c) 2009-2014 SAP SE, All Rights Reserved
 */
jQuery.sap.declare("sap.ushell.ui.launchpad.ActionItem");jQuery.sap.require('sap.m.Button');sap.m.Button.extend("sap.ushell.ui.launchpad.ActionItem",{metadata:{library:"sap.ushell",properties:{"actionType":{type:"string",group:"Appearance",defaultValue:'standard'}},events:{"press":{},"afterRendering":{}}}});sap.ushell.ui.launchpad.ActionItem.M_EVENTS={'press':'press','afterRendering':'afterRendering'};(function(){"use strict";sap.ushell.ui.launchpad.ActionItem.prototype.init=function(){if(sap.m.Button.prototype.init){sap.m.Button.prototype.init.apply(this,arguments);}this.sOrigType=undefined;};sap.ushell.ui.launchpad.ActionItem.prototype.setActionType=function(t){if(!this.sOrigType){this.sOrigType=this.getType();}if(t==='action'){this.setType(sap.m.ButtonType.Unstyled);this.addStyleClass("sapUshellActionItem");}else{this.sOrigType?this.setType(this.sOrigType):this.setType(sap.m.ButtonType.Standard);this.removeStyleClass("sapUshellActionItem");}this.setProperty('actionType',t,true);};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.ActionItemRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.launchpad.ActionItemRenderer");jQuery.sap.require('sap.ui.core.Renderer');jQuery.sap.require('sap.m.ButtonRenderer');sap.ushell.ui.launchpad.ActionItemRenderer={};sap.ushell.ui.launchpad.ActionItemRenderer=sap.ui.core.Renderer.extend(sap.m.ButtonRenderer);}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.AnchorItem')){jQuery.sap.declare("sap.ushell.ui.launchpad.AnchorItem");jQuery.sap.require('sap.ui.core.Control');sap.ui.core.Control.extend("sap.ushell.ui.launchpad.AnchorItem",{metadata:{library:"sap.ushell",properties:{"title":{type:"string",group:"Misc",defaultValue:null},"selected":{type:"boolean",group:"Misc",defaultValue:false},"groupId":{type:"string",group:"Misc",defaultValue:null},"defaultGroup":{type:"boolean",group:"Misc",defaultValue:false},"index":{type:"int",group:"Misc",defaultValue:null},"visible":{type:"boolean",group:"Misc",defaultValue:null},"isGroupVisible":{type:"boolean",group:"Misc",defaultValue:true},"isGroupRendered":{type:"boolean",group:"Misc",defaultValue:false}},events:{"press":{},"afterRendering":{}}}});sap.ushell.ui.launchpad.AnchorItem.M_EVENTS={'press':'press','afterRendering':'afterRendering'};(function(){"use strict";sap.ushell.ui.launchpad.AnchorItem.prototype.onAfterRendering=function(){this.fireAfterRendering();};sap.ushell.ui.launchpad.AnchorItem.prototype.setTitle=function(t){this.setProperty("title",t,true);this.$().find(".sapUshellAnchorItemInner").text(t);};sap.ushell.ui.launchpad.AnchorItem.prototype.setGroupId=function(v){this.setProperty("groupId",v,true);};sap.ushell.ui.launchpad.AnchorItem.prototype.setSelected=function(s){s=!!s;this.setProperty("selected",s,true);if(s){var j=jQuery(".sapUshellAnchorItemSelected");j.each(function(){jQuery(this).toggleClass("sapUshellAnchorItemSelected",false);jQuery(this).attr("aria-selected",false);});}this.$().attr("aria-selected",s);this.$().toggleClass("sapUshellAnchorItemSelected",s);};sap.ushell.ui.launchpad.AnchorItem.prototype.setIsGroupRendered=function(r){r=!!r;this.setProperty("isGroupRendered",r,true);if(r){this.removeStyleClass("sapUshellAnchorItemNotRendered");}else{this.addStyleClass("sapUshellAnchorItemNotRendered");}};sap.ushell.ui.launchpad.AnchorItem.prototype.setIsGroupVisible=function(v){v=!!v;this.setProperty("isGroupVisible",v,true);this.toggleStyleClass("sapUshellShellHidden",!v);};sap.ushell.ui.launchpad.AnchorItem.prototype.onclick=function(){this.firePress();};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.AnchorItemRenderer')){(function(){"use strict";jQuery.sap.require('sap.ui.core.Control');jQuery.sap.declare("sap.ushell.ui.launchpad.AnchorItemRenderer");sap.ushell.ui.launchpad.AnchorItemRenderer=sap.ui.core.Renderer.extend(sap.ui.core.Control);sap.ushell.ui.launchpad.AnchorItemRenderer.render=function(r,a){var A=a.getParent(),o=A.getGroups(),b=o.filter(function(g){return g.getVisible();}),c=b.indexOf(a)>-1?b.indexOf(a)+1:"";r.write("<li");r.writeControlData(a);r.addClass("sapUshellAnchorItem");r.writeAccessibilityState(a,{role:"option",posinset:c,setsize:b.length});r.writeAttribute("tabindex","-1");if(!a.getVisible()){r.addClass("sapUshellShellHidden");}r.writeClasses();r.write(">");r.write("<div");r.addClass("sapUshellAnchorItemInner");r.writeClasses();r.write(">");r.writeEscaped(a.getTitle());r.write("</div>");r.write("</li>");};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.AnchorNavigationBar')){jQuery.sap.declare("sap.ushell.ui.launchpad.AnchorNavigationBar");jQuery.sap.require('sap.m.Bar');sap.m.Bar.extend("sap.ushell.ui.launchpad.AnchorNavigationBar",{metadata:{library:"sap.ushell",properties:{"accessibilityLabel":{type:"string",group:"",defaultValue:null},"selectedItemIndex":{type:"int",group:"Misc",defaultValue:0}},aggregations:{"groups":{type:"sap.ushell.ui.launchpad.AnchorItem",multiple:true,singularName:"group"}},events:{"afterRendering":{},"itemPress":{}}}});sap.ushell.ui.launchpad.AnchorNavigationBar.M_EVENTS={'afterRendering':'afterRendering','itemPress':'itemPress'};(function(){"use strict";var u=sap.ushell.override.updateAggregatesFactory("groups");sap.ushell.ui.launchpad.AnchorNavigationBar.prototype.updateGroups=function(){u.apply(this,arguments);if(this.getDomRef()&&this.getGroups().length){this.reArrangeNavigationBarElements();}};sap.ushell.ui.launchpad.AnchorNavigationBar.prototype.init=function(){sap.ui.Device.resize.attachHandler(this.reArrangeNavigationBarElements,this);this.bGroupWasPressed=false;this.bIsRtl=sap.ui.getCore().getConfiguration().getRTL();};sap.ushell.ui.launchpad.AnchorNavigationBar.prototype.handleExit=function(){if(this.oPopover){this.oPopover.destroy();}if(this.oOverflowButton){this.oOverflowButton.destroy();}};sap.ushell.ui.launchpad.AnchorNavigationBar.prototype.updateVisibility=function(){var g=this.getGroups(),v=0;for(var i=0;i<g.length;i++){if(g[i].getProperty("visible")){v++;}}if(v>1){this.$().removeClass("sapUshellAnchorNavigationBarInvisible");this.$().next().removeClass("sapUshellSectionNoTop");}else{this.$().addClass("sapUshellAnchorNavigationBarInvisible");this.$().next().addClass("sapUshellSectionNoTop");}};sap.ushell.ui.launchpad.AnchorNavigationBar.prototype.onAfterRendering=function(){this.reArrangeNavigationBarElements();var s=this.getSelectedItemIndex()||0;setTimeout(function(){this.adjustItemSelection(s);}.bind(this),100);var g=this.getGroups(),t=this;jQuery.each(g,function(i,G){this.attachPress(function(e){t.fireItemPress({group:e.getSource(),manualPress:true});t.bGroupWasPressed=true;});});if(this.bIsRtl){jQuery(".sapUshellAnchorNavigationBarItemsScroll").addClass("sapUshellRtl");}jQuery(".sapUshellAnchorNavigationBarItemsScroll").scroll(this.setNavigationBarItemsVisibility.bind(this));this.updateVisibility();jQuery(".sapUshellAnchorItem:visible:first").attr("accesskey","h");};sap.ushell.ui.launchpad.AnchorNavigationBar.prototype.openOverflowPopup=function(){var o=jQuery('.sapUshellAnchorItemOverFlow').hasClass("sapUshellAnchorItemOverFlowOpen");if(this.oOverflowButton&&!o){this.oOverflowButton.firePress();}};sap.ushell.ui.launchpad.AnchorNavigationBar.prototype.closeOverflowPopup=function(){this.oPopover.close();};sap.ushell.ui.launchpad.AnchorNavigationBar.prototype.reArrangeNavigationBarElements=function(){this.anchorItems=this.getVisibleGroups();var s=this.getSelectedItemIndex()||0;if(this.anchorItems.length){this.adjustItemSelection(s);}if(sap.ui.Device.system.phone&&this.anchorItems.length){this.anchorItems.forEach(function(i,a){i.setIsGroupVisible(false);});this.anchorItems[this.getSelectedItemIndex()].setIsGroupVisible(true);}else{setTimeout(function(){this.setNavigationBarItemsVisibility();}.bind(this),200);}this._adjustAnchorBarAriaProperties(this.anchorItems);};sap.ushell.ui.launchpad.AnchorNavigationBar.prototype._scrollToGroupByGroupIndex=function(g){var a=sap.ui.Device.system.tablet?jQuery(".sapUshellAnchorNavigationBarItemsScroll"):jQuery(".sapUshellAnchorNavigationBarItems"),b=a.offset()?a.offset().left:0,j=this.anchorItems[g].getDomRef(),s,c;if(j){s=j.offsetLeft;c=this.bIsRtl?this._normalizeScrollBarWidth()+s+64:s-b-48;a.animate({scrollLeft:c},200,this.setNavigationBarItemsVisibility.bind(this));}};sap.ushell.ui.launchpad.AnchorNavigationBar.prototype._normalizeScrollBarWidth=function(){var l=this.anchorItems[this.anchorItems.length-1].getDomRef().offsetLeft,f=this.anchorItems[0].getDomRef().offsetLeft,t=Math.abs(l)-Math.abs(f);return t;};sap.ushell.ui.launchpad.AnchorNavigationBar.prototype.setNavigationBarItemsVisibility=function(){if(!sap.ui.Device.system.phone){if(this.anchorItems.length&&(!this.isMostRightAnchorItemVisible()||!this.isMostLeftAnchorItemVisible())||sap.ui.Device.system.phone){this.oOverflowButton.removeStyleClass("sapUshellShellHidden");jQuery('.sapUshellAnchorItemOverFlow').removeClass("sapUshellShellHidden");}else if(this.oOverflowButton){this.oOverflowButton.addStyleClass("sapUshellShellHidden");jQuery('.sapUshellAnchorItemOverFlow').addClass("sapUshellShellHidden");}if(this.bIsRtl){if(this.anchorItems.length&&!this.isMostLeftAnchorItemVisible()){this.oOverflowRightButton.removeStyleClass("sapUshellShellHidden");jQuery(".sapUshellAnchorNavigationBarItems").addClass("sapUshellOverflowLeft");}else if(this.oOverflowRightButton){this.oOverflowRightButton.addStyleClass("sapUshellShellHidden");jQuery(".sapUshellAnchorNavigationBarItems").removeClass("sapUshellOverflowLeft");}if(this.anchorItems.length&&!this.isMostRightAnchorItemVisible()){this.oOverflowLeftButton.removeStyleClass("sapUshellShellHidden");jQuery(".sapUshellAnchorNavigationBarItems").addClass("sapUshellOverflowRight");}else if(this.oOverflowLeftButton){this.oOverflowLeftButton.addStyleClass("sapUshellShellHidden");jQuery(".sapUshellAnchorNavigationBarItems").removeClass("sapUshellOverflowRight");}}else{if(this.anchorItems.length&&!this.isMostLeftAnchorItemVisible()){this.oOverflowLeftButton.removeStyleClass("sapUshellShellHidden");jQuery(".sapUshellAnchorNavigationBarItems").addClass("sapUshellOverflowLeft");}else if(this.oOverflowLeftButton){this.oOverflowLeftButton.addStyleClass("sapUshellShellHidden");jQuery(".sapUshellAnchorNavigationBarItems").removeClass("sapUshellOverflowLeft");}if(this.anchorItems.length&&!this.isMostRightAnchorItemVisible()){this.oOverflowRightButton.removeStyleClass("sapUshellShellHidden");jQuery(".sapUshellAnchorNavigationBarItems").addClass("sapUshellOverflowRight");}else if(this.oOverflowRightButton){this.oOverflowRightButton.addStyleClass("sapUshellShellHidden");jQuery(".sapUshellAnchorNavigationBarItems").removeClass("sapUshellOverflowRight");}}jQuery(".sapUshellAnchorItem.firstItem").removeClass("firstItem");var j=jQuery(".sapUshellAnchorItem:visible").first();j.addClass("firstItem");}else{if(this.anchorItems.length){this.oOverflowButton.removeStyleClass("sapUshellShellHidden");var s=this.getSelectedItemIndex()||0;this.oPopover.setTitle(this.anchorItems[s].getTitle());}}};sap.ushell.ui.launchpad.AnchorNavigationBar.prototype.adjustItemSelection=function(s){setTimeout(function(){if(this.anchorItems&&this.anchorItems.length){this.anchorItems.forEach(function(i){i.setSelected(false);});this.anchorItems[s].setSelected(true);this._scrollToGroupByGroupIndex(s);}}.bind(this),200);};sap.ushell.ui.launchpad.AnchorNavigationBar.prototype.isMostRightAnchorItemVisible=function(){var j=jQuery('.sapUshellAnchorNavigationBar'),n=!jQuery.isEmptyObject(j)?j.width():0,a=!jQuery.isEmptyObject(j)&&j.offset()?j.offset().left:0,l=this.bIsRtl?this.anchorItems[0].getDomRef():this.anchorItems[this.anchorItems.length-1].getDomRef(),b=!jQuery.isEmptyObject(l)?jQuery(l).width():0,c;if(b<0){b=80;}c=l&&jQuery(l).offset()?jQuery(l).offset().left:0;if(c+b<=a+n){return true;}return false;};sap.ushell.ui.launchpad.AnchorNavigationBar.prototype.isMostLeftAnchorItemVisible=function(){var j=jQuery('.sapUshellAnchorNavigationBar'),n=!jQuery.isEmptyObject(j)&&j.offset()?j.offset().left:0,f=this.bIsRtl?this.anchorItems[this.anchorItems.length-1].getDomRef():this.anchorItems[0].getDomRef(),a=!jQuery.isEmptyObject(f)&&jQuery(f).offset()?jQuery(f).offset().left:0;if(a>=n){return true;}return false;};sap.ushell.ui.launchpad.AnchorNavigationBar.prototype.setSelectedItemIndex=function(s){if(s!==undefined){this.setProperty("selectedItemIndex",s,true);}};sap.ushell.ui.launchpad.AnchorNavigationBar.prototype._getOverflowLeftArrowButton=function(){this.oOverflowLeftButton=new sap.m.Button({icon:'sap-icon://slim-arrow-left',tooltip:sap.ushell.resources.i18n.getText("scroll_beginning"),press:function(e){this._scrollToGroupByGroupIndex(0);}.bind(this)}).addStyleClass("sapUshellShellHidden");return this.oOverflowLeftButton;};sap.ushell.ui.launchpad.AnchorNavigationBar.prototype._getOverflowRightArrowButton=function(){this.oOverflowRightButton=new sap.m.Button({icon:'sap-icon://slim-arrow-right',tooltip:sap.ushell.resources.i18n.getText("scroll_end"),press:function(e){this._scrollToGroupByGroupIndex(this.anchorItems.length-1);}.bind(this)}).addStyleClass("sapUshellShellHidden");return this.oOverflowRightButton;};sap.ushell.ui.launchpad.AnchorNavigationBar.prototype._getOverflowButton=function(){var t=this,l;if(this.oOverflowButton){return this.oOverflowButton;}l=new sap.m.List({mode:sap.m.ListMode.SingleSelectMaster,rememberSelections:false,selectionChange:function(e){t.fireItemPress({group:e.getParameter('listItem')});t.oPopover.close();}});this.bOverFlowBtnClick=false;this.oPopover=new sap.m.Popover("sapUshellAnchorBarOverflowPopover",{showArrow:false,showHeader:false,placement:"Left",content:[l],horizontalScrolling:false,beforeOpen:function(){jQuery('.sapUshellAnchorItemOverFlow').addClass("sapUshellAnchorItemOverFlowOpen");var j=jQuery(".sapUshellAnchorItemOverFlow"),i=sap.ui.getCore().getConfiguration().getRTL(),o=i?-1*j.outerWidth():j.outerWidth();this.setOffsetX(o);},beforeClose:function(){if(document.activeElement.id===this.oOverflowButton.getId()){this.bOverFlowBtnClick=true;}}.bind(this),afterClose:function(){jQuery('.sapUshellAnchorItemOverFlow').removeClass("sapUshellAnchorItemOverFlowOpen");jQuery('.sapUshellAnchorItemOverFlow').toggleClass("sapUshellAnchorItemOverFlowPressed",false);}}).addStyleClass("sapUshellAnchorItemsPopover").addStyleClass('sapContrastPlus');this.oOverflowButton=new sap.m.Button("sapUshellAnchorBarOverflowButton",{icon:'sap-icon://slim-arrow-down',tooltip:sap.ushell.resources.i18n.getText("more_groups"),press:function(e){var o=false;var c=false;if(!sap.ui.Device.system.desktop){if(this.oPopover.isOpen()){c=true;}else{o=true;}}else{if(!this.bOverFlowBtnClick){o=true;}else{this.bOverFlowBtnClick=false;}}if(c){this.oPopover.close();}else if(o){this.anchorItems=this.getVisibleGroups();l.setModel(this.getModel());var a=this.getModel().getProperty("/tileActionModeActive");var v=new sap.ui.model.Filter('','EQ','a');v.fnTest=function(i){if(!i.visibilityModes[a?1:0]){return false;}return i.isGroupVisible||a;}.bind(this);l.bindItems({path:"/groups",template:new sap.ushell.ui.launchpad.GroupListItem({title:"{title}",groupId:"{groupId}",index:"{index}"}),filters:[v]});var s=jQuery(".sapUshellAnchorItemSelected").attr("id");var S=sap.ui.getCore().byId(s);jQuery.each(l.getItems(),function(i,b){if(S.mProperties.groupId===b.mProperties.groupId){b.addStyleClass("sapUshellAnchorPopoverItemSelected");}else{b.addStyleClass("sapUshellAnchorPopoverItemNonSelected");}});jQuery('.sapUshellAnchorItemOverFlow').toggleClass("sapUshellAnchorItemOverFlowPressed",true);this.oPopover.openBy(this.oOverflowButton);}}.bind(this)}).addStyleClass("sapUshellShellHidden").addStyleClass('sapContrastPlus');return this.oOverflowButton;};sap.ushell.ui.launchpad.AnchorNavigationBar.prototype.getVisibleGroups=function(){return this.getGroups().filter(function(g){return g.getVisible();});};sap.ushell.ui.launchpad.AnchorNavigationBar.prototype._adjustAnchorBarAriaProperties=function(g){var i;for(i=0;i<g.length;i++){var j=jQuery(g[i].getDomRef());j.attr("aria-posinset",i+1);j.attr("aria-setsize",g.length);}};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.AnchorNavigationBarRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.launchpad.AnchorNavigationBarRenderer");sap.ushell.ui.launchpad.AnchorNavigationBarRenderer={};sap.ushell.ui.launchpad.AnchorNavigationBarRenderer.render=function(r,c){r.write("<div");r.addClass("sapUshellAnchorNavigationBar");r.writeClasses();r.writeControlData(c);r.write(">");r.write("<div");r.addClass("sapUshellAnchorNavigationBarInner");r.writeClasses();r.write(">");r.write("<div");r.addClass("sapUshellAnchorLeftOverFlowButton");r.writeClasses();r.write(">");r.renderControl(c._getOverflowLeftArrowButton());r.write("</div>");r.write("<div");r.addClass("sapUshellAnchorNavigationBarItems");r.writeClasses();r.writeAccessibilityState(c,{role:"list"});r.write(">");r.write("<ul");r.addClass("sapUshellAnchorNavigationBarItemsScroll");r.writeClasses();r.writeAccessibilityState(c,{role:"listbox"});r.write(">");this.renderAnchorNavigationItems(r,c);r.write("</ul>");r.write("</div>");r.write("<div");r.addClass("sapUshellAnchorRightOverFlowButton");r.writeClasses();r.write(">");r.renderControl(c._getOverflowRightArrowButton());r.write("</div>");r.write("<div");r.addClass("sapUshellAnchorItemOverFlow");r.writeClasses();r.writeAccessibilityState(c._getOverflowButton(),{"aria-hidden":true});r.write(">");r.renderControl(c._getOverflowButton());r.write("</div>");r.write("</div>");r.write("</div>");};sap.ushell.ui.launchpad.AnchorNavigationBarRenderer.renderAnchorNavigationItems=function(r,c){var g=c.getGroups();jQuery.each(g,function(i,G){r.renderControl(this);});};sap.ushell.ui.launchpad.AnchorNavigationBarRenderer.shouldAddIBarContext=function(){return false;};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.CatalogEntryContainer')){jQuery.sap.declare('sap.ushell.ui.launchpad.CatalogEntryContainer');jQuery.sap.require('sap.ui.core.Control');sap.ui.define("sap/ushell/ui/launchpad/CatalogEntryContainer",['sap/ui/core/Control'],function(C){"use strict";var a=C.extend("sap.ushell.ui.launchpad.CatalogEntryContainer",{metadata:{properties:{header:{type:"string",group:"Appearance",defaultValue:null},catalogSearchTerm:{type:"string",group:"Appearance",defaultValue:null},catalogTagSelector:{type:"object",group:"Appearance",defaultValue:null}},aggregations:{appBoxesContainer:{type:"sap.ushell.ui.appfinder.AppBox",multiple:true},customTilesContainer:{type:"sap.ushell.ui.launchpad.Tile",multiple:true}}},renderer:{render:function(r,c){var t=c.getCustomTilesContainer(),A=c.getAppBoxesContainer(),h,b;r.write("<div");r.writeControlData(c);r.addClass("sapUshellTileContainer sapUshellCatalogTileContainer");r.writeClasses();r.write(">");r.write("<div");r.addClass("sapUshellTileContainerContent");r.writeClasses();r.writeAttribute("tabindex","-1");r.write(">");if(c.getHeader()){var R=c.getNumberResults();h=sap.ushell.resources.i18n.getText(c.getHeader(),[R.nAppboxes+R.nCustom]);r.write("<div");r.addClass("sapUshellTileContainerHeader sapUshellCatalogTileContainerHeader");r.writeAttribute("id",c.getId()+"-groupheader");r.writeClasses();r.write(">");r.write("<div");r.writeAttribute("id",c.getId()+"-title");r.addClass("sapUshellCatalogTileContainerHeaderInner");r.writeClasses();r.write(">");r.write("<");r.write('h2');r.addClass("sapUshellContainerTitle sapUshellCatalogContainerTitle");r.writeClasses();r.writeAttributeEscaped("title",h);r.write(">");r.writeEscaped(h);r.write("</");r.write('h2');r.writeAttribute("id",c.getId()+"-groupheader");r.write(">");r.write("</div>");r.write("</div>");}r.write("<ul");b=c.data('containerHeight');if(b){r.writeAttribute("style",'height:'+b);}r.addClass('sapUshellTilesContainer-sortable');r.addClass('sapUshellInner');r.writeClasses();r.writeAccessibilityState(c,{role:"listbox"});r.write(">");jQuery.each(A,function(){if(this.getVisible()){}if(this.getVisible){r.renderControl(this);}});r.write("</ul>");r.write("<ul");b=c.data('containerHeight');if(b){r.writeAttribute("style",'height:'+b);}r.addClass('sapUshellTilesContainer-sortable');r.addClass('sapUshellInner');r.writeClasses();r.writeAccessibilityState(c,{role:"listbox"});r.write(">");jQuery.each(t,function(){if(this.getVisible()){}if(this.getVisible){r.renderControl(this);}});r.write("</ul>");r.write("</div>");r.write("</div>");}}});a.prototype.setCatalogTagSelector=function(t){};a.prototype.setAfterHandleElements=function(c){this.onAfterHandleElements=c;};a.prototype.onAfterUpdate=function(c){this.fnCallback=c;};a.prototype.setCatalogSearchTerm=function(s){};a.prototype.updateAggregation=function(r){jQuery.sap.log.debug("Updating CatalogEntryContainer. Reason: ",r);try{this.handleElements(r);}catch(e){sap.ui.base.ManagedObject.prototype.updateAggregation.apply(this,arguments);}};a.prototype.addNewItem=function(e,n){var N,i,p=e.getPath();if(this.catalogState[n]!="full"){if(this.getAllocatedUnits){if(!this.getAllocatedUnits()){this.catalogState[n]="partial";return false;}}}if(n==="customTilesContainer"){var b=sap.ushell.Container.getService("LaunchPage").getCatalogTileView(e.getProperty("src"));e.getProperty("content")[0]=b;}N=sap.ushell.ui.launchpad.TileContainerUtils.createNewItem.bind(this)(e,n);sap.ushell.ui.launchpad.TileContainerUtils.addNewItem.bind(this)(N,n);i=(n==="appBoxesContainer")?this.getAppBoxesContainer():this.getCustomTilesContainer(),this.indexingMaps[n].onScreenPathIndexMap[p]={aItemsRefrenceIndex:i.length-1,isVisible:true};if(this.newElementCreated){this.newElementCreated(n,this);}return true;};a.prototype.getNumberResults=function(r){return{nAppboxes:this.nNumberOfVisibileElements["appBoxesContainer"],nCustom:this.nNumberOfVisibileElements["customTilesContainer"]};};a.prototype.handleElements=function(r){var n=r,b=this.mBindingInfos[n].binding,B=b.getContexts(),i,s,t,c;if(!this.catalogState){this.catalogState={};}if(!this.catalogState[r]){this.catalogState[r]="start";}if(!this.indexingMaps){this.indexingMaps={};}if(!this.nNumberOfVisibileElements){this.nNumberOfVisibileElements=[];}if(!this.nNumberOfVisibileElements["customTilesContainer"]){this.nNumberOfVisibileElements["customTilesContainer"]=0;}if(!this.nNumberOfVisibileElements["appBoxesContainer"]){this.nNumberOfVisibileElements["appBoxesContainer"]=0;}if(!this.filters){this.filters={};}i=(n==="appBoxesContainer")?this.getAppBoxesContainer():this.getCustomTilesContainer();this.indexingMaps[n]=sap.ushell.ui.launchpad.TileContainerUtils.indexOnScreenElements(i,false);c=sap.ushell.ui.launchpad.TileContainerUtils.markVisibleOnScreenElements(B,this.indexingMaps[n],true);if(sap.ushell.ui.launchpad.TileContainerUtils.createMissingElementsInOnScreenElements(this.indexingMaps[n],B,c,this.addNewItem.bind(this),i,this.filters[n],n)){this.catalogState[r]="full";}i=(n==="appBoxesContainer")?this.getAppBoxesContainer():this.getCustomTilesContainer();s=sap.ushell.ui.launchpad.TileContainerUtils.showHideTilesAndHeaders(this.indexingMaps[n],i);this.nNumberOfVisibileElements[n]=s.nCountVisibElelemnts;if(this.fnCallback){this.fnCallback(this);}t=jQuery("#"+this.getId()+"-title h2");t.html(sap.ushell.resources.i18n.getText(this.getHeader(),[this.nNumberOfVisibileElements["appBoxesContainer"]+this.nNumberOfVisibileElements["customTilesContainer"]]));if(this.onAfterHandleElements){this.onAfterHandleElements(this);}};return a;});};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.CatalogsContainer')){jQuery.sap.declare('sap.ushell.ui.launchpad.CatalogsContainer');jQuery.sap.require('sap.ui.core.Control');sap.ui.define("sap/ushell/ui/launchpad/CatalogsContainer",['sap/ui/core/Control'],function(C){"use strict";var a=C.extend("sap.ushell.ui.launchpad.CatalogsContainer",{metadata:{properties:{categoryFilter:{type:"string",defaultValue:"ALL"},categoryAllocateTiles:{type:"int",defaultValue:"0"}},aggregations:{catalogs:{type:"sap.ushell.ui.launchpad.CatalogEntryContainer",multiple:true}}},renderer:{render:function(r,c){var b=c.getCatalogs();if(b.length){c.setBusy(false);}r.write("<div");r.addClass("sapUshellCatalogsContainer");r.writeClasses();r.writeControlData(c);r.write(">");jQuery.each(b,function(i,d){r.renderControl(this);});r.write("</div>");}}});a.prototype.setPagingManager=function(p){jQuery.sap.measure.start("FLP:DashboardManager.CatalogsRendering","CatalogsRendering","FLP");jQuery.sap.measure.pause("FLP:DashboardManager.CatalogsRendering");this.oPagingManager=p;};a.prototype.setCategoryAllocateTiles=function(n){var i=this.getCatalogs();this.nAllocatedUnits=n;if(!this.indexingMaps){return;}if(!this.filters){this.filters={};}this.filters.pagination=function(e){var p=e.getPath(),c,b,d=this.getCatalogs();if(!this.catalogPagination){return;}if(this.nAllocatedUnits>0){if(this.oLastPaggedCatalog){this.oLastPaggedCatalog.handleElements("appBoxesContainer");this.oLastPaggedCatalog.handleElements("customTilesContainer");}}if(!this.catalogPagination[p]){b=this.indexingMaps.onScreenPathIndexMap[p];if(this.nAllocatedUnits>0){c=d[b.aItemsRefrenceIndex];c.handleElements("appBoxesContainer");c.handleElements("customTilesContainer");this.catalogPagination[p]=true;}else{b.isVisible=false;this.catalogPagination[p]=false;}}}.bind(this);this.indexingMaps=sap.ushell.ui.launchpad.TileContainerUtils.indexOnScreenElements(i);sap.ushell.ui.launchpad.TileContainerUtils.applyFilterOnAllItems(this.mBindingInfos["catalogs"],this.filters);if(this.indexingMaps){sap.ushell.ui.launchpad.TileContainerUtils.showHideTilesAndHeaders(this.indexingMaps,this.getCatalogs());}};a.prototype.setCategoryFilter=function(c){var s,i,o,I=this.getCatalogs();this.sCatalogTerm=c;if(!this.indexingMaps){return;}if(!this.filters){this.filters={};}this.filters.catalogEntry=function(e){var p=e.getPath(),b=e.getProperty("title")===this.sCatalogTerm,d;if(!this.sCatalogTerm){b=true;}d=this.indexingMaps.onScreenPathIndexMap[p];if(d){d.isVisible=b;}}.bind(this);for(s in this.indexingMaps.onScreenPathIndexMap){if(this.indexingMaps.onScreenPathIndexMap.hasOwnProperty(s)){i=this.indexingMaps.onScreenPathIndexMap[s];o=I[i.aItemsRefrenceIndex];if(c===o.getBindingContext().getProperty("title")){if(o.catalogState.appBoxesContainer!=="full"||o.catalogState.customTilesContainer!=="full"){this.oPagingManager.moveToNextPage();this.nAllocatedUnits=this.oPagingManager._calcElementsPerPage();if(o.catalogState.appBoxesContainer!=="full"){o.handleElements("appBoxesContainer");}if(o.catalogState.customTilesContainer!=="full"){o.handleElements("customTilesContainer");}}}}}this.indexingMaps=sap.ushell.ui.launchpad.TileContainerUtils.indexOnScreenElements(I);sap.ushell.ui.launchpad.TileContainerUtils.applyFilterOnAllItems(this.mBindingInfos["catalogs"],this.filters);if(this.indexingMaps){sap.ushell.ui.launchpad.TileContainerUtils.showHideTilesAndHeaders(this.indexingMaps,this.getCatalogs());}};a.prototype.updateAggregation=function(r){jQuery.sap.log.debug("Updating TileContainer. Reason: ",r);try{jQuery.sap.measure.resume("FLP:DashboardManager.CatalogsRendering");this.filterElements();jQuery.sap.measure.pause("FLP:DashboardManager.CatalogsRendering");}catch(e){sap.ui.base.ManagedObject.prototype.updateAggregation.apply(this,arguments);}};a.prototype.addNewItem=function(e,n){var N,b,i,p=e.getPath(),c=!!this.nAllocatedUnits;N=sap.ushell.ui.launchpad.TileContainerUtils.createNewItem.bind(this)(e,n);N.nAllocatedUnits=this.nAllocatedUnits;N.getAllocatedUnits=function(){return this.nAllocatedUnits;}.bind(this);N.elementFiltered=function(d,E,o){b=this.oPagingManager.getSizeofSupportedElementInUnits("tile");this.nAllocatedUnits+=d*b;this.setCategoryAllocateTiles(this.nAllocatedUnits);}.bind(this);N.newElementCreated=function(E,o){this.nAllocatedUnits-=this.oPagingManager.getSizeofSupportedElementInUnits("tile");if(this.nAllocatedUnits<=0){this.nAllocatedUnits=0;this.oLastPaggedCatalog=o;}}.bind(this);sap.ushell.ui.launchpad.TileContainerUtils.addNewItem.bind(this)(N,n);i=this.getCatalogs();this.indexingMaps.onScreenPathIndexMap[p]={aItemsRefrenceIndex:i.length-1,isVisible:true};this.catalogPagination[p]=c;return true;};a.prototype.handleFilters=function(){if(!this.catalogPagination){this.catalogPagination={};}if(!this.catalogsElementsMap){this.catalogsElementsMap={};}if(!this.filters){this.filters={};}};a.prototype.filterElements=function(){var n="catalogs",b=this.mBindingInfos[n].binding,B=b.getContexts(),i=this.getCatalogs(),c;if(!this.indexingMaps){this.indexingMaps=sap.ushell.ui.launchpad.TileContainerUtils.indexOnScreenElements(i);}this.handleFilters();c=sap.ushell.ui.launchpad.TileContainerUtils.markVisibleOnScreenElements(B,this.indexingMaps,false);if(!sap.ushell.ui.launchpad.TileContainerUtils.validateOrder(B,i,c)){throw true;}sap.ushell.ui.launchpad.TileContainerUtils.createMissingElementsInOnScreenElements(this.indexingMaps,B,c,this.addNewItem.bind(this),i,this.filters,n);i=this.getCatalogs();sap.ushell.ui.launchpad.TileContainerUtils.showHideTilesAndHeaders(this.indexingMaps,i);};return a;});};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.DashboardGroupsContainer')){jQuery.sap.declare("sap.ushell.ui.launchpad.DashboardGroupsContainer");jQuery.sap.require('sap.ui.core.Control');sap.ui.core.Control.extend("sap.ushell.ui.launchpad.DashboardGroupsContainer",{metadata:{library:"sap.ushell",properties:{"accessibilityLabel":{type:"string",group:"",defaultValue:null},"displayMode":{type:"string",group:"",defaultValue:null}},aggregations:{"groups":{type:"sap.ui.core.Control",multiple:true,singularName:"group"}},events:{"afterRendering":{}}}});sap.ushell.ui.launchpad.DashboardGroupsContainer.M_EVENTS={'afterRendering':'afterRendering'};(function(){"use strict";sap.ushell.ui.launchpad.DashboardGroupsContainer.prototype.updateGroups=sap.ushell.override.updateAggregatesFactory("groups");sap.ushell.ui.launchpad.DashboardGroupsContainer.prototype.onAfterRendering=function(){this.fireAfterRendering();};sap.ushell.ui.launchpad.DashboardGroupsContainer.prototype.getGroupControlByGroupId=function(g){try{var a=this.getGroups();for(var i=0;i<a.length;i++){if(a[i].getGroupId()==g){return a[i];}}}catch(e){}return null;};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.DashboardGroupsContainerRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.launchpad.DashboardGroupsContainerRenderer");sap.ushell.ui.launchpad.DashboardGroupsContainerRenderer={};sap.ushell.ui.launchpad.DashboardGroupsContainerRenderer.render=function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapUshellDashboardGroupsContainer");r.writeClasses();if(c.getAccessibilityLabel()){r.writeAccessibilityState(c,{role:"navigation",label:c.getAccessibilityLabel()});}r.write(">");var g=c.getGroups();jQuery.each(g,function(i,G){r.write("<div");r.addClass("sapUshellDashboardGroupsContainerItem");if(G.getIsGroupLocked()||G.getDefaultGroup()){r.addClass("sapUshellDisableDragAndDrop");}r.writeClasses();r.write(">");r.renderControl(this);r.write("</div>");});r.write("<div");r.writeAttribute("id","sapUshellDashboardAccessibilityTileText");r.writeAttribute("style","height: 0px; width: 0px; overflow: hidden; float: left;");r.write(">");r.write(sap.ushell.resources.i18n.getText("tile"));r.write("</div>");r.write("</div>");};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.EmbeddedSupportErrorMessage')){jQuery.sap.declare("sap.ushell.ui.launchpad.EmbeddedSupportErrorMessage");jQuery.sap.require('sap.m.Dialog');sap.m.Dialog.extend("sap.ushell.ui.launchpad.EmbeddedSupportErrorMessage",{metadata:{library:"sap.ushell",events:{"afterClose":{}}}});sap.ushell.ui.launchpad.EmbeddedSupportErrorMessage.M_EVENTS={'afterClose':'afterClose'};(function(){"use strict";jQuery.sap.require('sap.m.Dialog');jQuery.sap.require('sap.m.Button');jQuery.sap.declare("sap.ushell.ui.launchpad.EmbeddedSupportErrorMessage");sap.ushell.ui.launchpad.EmbeddedSupportErrorMessage.prototype.open=function(){var c,C;this.translationBundle=sap.ushell.resources.i18n;c=new sap.m.Button({id:sap.ui.core.ElementMetadata.uid("supportBtn"),text:this.translationBundle.getText("contactSupportBtn"),press:function(){this.close();jQuery.sap.require("sap.ushell.ui.footerbar.ContactSupportButton");this.oContactSupport=new sap.ushell.ui.footerbar.ContactSupportButton("ContactSupportErrorMsg",{visible:true});if(this.oContactSupport){this.oContactSupport.showContactSupportDialog();this.oContactSupport.destroy();}}.bind(this)});C=new sap.m.Button({id:sap.ui.core.ElementMetadata.uid("closeBtn"),text:this.translationBundle.getText("close"),press:function(){this.close();}.bind(this)});this.setType(sap.m.DialogType.Message);this.setIcon('sap-icon://alert');this.setRightButton(C);this.setLeftButton(c);this._addStyleClassToContent();this.addStyleClass('sapMMessageBoxError');this.attachAfterClose(function(){this.destroy();}.bind(this));if(sap.m.Dialog.prototype.open){sap.m.Dialog.prototype.open.apply(this,arguments);}};sap.ushell.ui.launchpad.EmbeddedSupportErrorMessage.prototype._addStyleClassToContent=function(){var c=this.getContent(),C,i;for(i in c){C=c[i];if(C.getMetadata().getName()==="sap.m.Text"&&!C.aCustomStyleClasses){C.addStyleClass("sapMMsgBoxText");}}};sap.ushell.ui.launchpad.EmbeddedSupportErrorMessage.prototype.onAfterRendering=function(){var j=jQuery("#EmbeddedSupportErrorMessage").eq(0);if(j){var l=j.attr("aria-labelledby");j.attr("aria-labelledby",l+this.getContent()[0].getId());}};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.EmbeddedSupportErrorMessageRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.launchpad.EmbeddedSupportErrorMessageRenderer");jQuery.sap.require('sap.ui.core.Renderer');jQuery.sap.require('sap.m.DialogRenderer');sap.ushell.ui.launchpad.EmbeddedSupportErrorMessageRenderer=sap.ui.core.Renderer.extend(sap.m.DialogRenderer);}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.Fiori2LoadingDialog')){jQuery.sap.declare("sap.ushell.ui.launchpad.Fiori2LoadingDialog");jQuery.sap.require('sap.ui.core.Control');sap.ui.core.Control.extend("sap.ushell.ui.launchpad.Fiori2LoadingDialog",{metadata:{library:"sap.ushell",properties:{"text":{type:"sap.ui.core.URI",group:"Appearance",defaultValue:null}}}});(function(){"use strict";sap.ushell.ui.launchpad.Fiori2LoadingDialog.prototype.init=function(){var b=document.getElementsByTagName("body")[0],e=document.createElement("DIV"),a=document.createElement("DIV"),c=document.createElement("DIV"),d=document.createElement("DIV"),f=document.createElement("DIV"),g=document.createElement("DIV"),h=document.createElement("DIV");this._oBusyIndicator=new sap.m.BusyIndicator("fiori2LoadingDialogBusyIndicator");this._oBusyIndicator.setBusyIndicatorDelay(100);this._firstLoading=true;this._start=0;this._end=0;h.setAttribute("id","sapUshellFiori2LoadingArea");h.setAttribute("class","sapUshellFiori2LoadingDialogArea");h.setAttribute("style","height: 0px; width: 0px; overflow: hidden; float: left;");b.insertBefore(h,b.firstChild);d.setAttribute("id","sapUshellLoadingAccessibilityHelper");d.setAttribute("class","sapUshellLoadingAccessibilityHelper");f.setAttribute("id","sapUshellLoadingAccessibilityHelper-appInfo");f.setAttribute("aria-atomic","true");d.appendChild(f);g.setAttribute("id","sapUshellLoadingAccessibilityHelper-loadingComplete");g.setAttribute("aria-atomic","true");g.setAttribute("aria-live","polite");d.appendChild(g);h.appendChild(d);c.setAttribute("id","sapUshellFiori2LoadingDialog");c.setAttribute("style","z-index: 8;visibility: visible;");c.setAttribute("class","sapUshellShellHidden");e.setAttribute("id","sapUshellFiori2LoadingOverlay");e.setAttribute("class","sapUshellFiori2LoadingDialogOverlayStyle");c.appendChild(e);a.setAttribute("id","sapUshellFiori2LoadingBusyIndicator");c.appendChild(a);b.insertBefore(c,h);this._oBusyIndicator.placeAt("sapUshellFiori2LoadingBusyIndicator");};sap.ushell.ui.launchpad.Fiori2LoadingDialog.prototype.openLoadingScreen=function(a){this.start=new Date().getTime();var j=jQuery("#sapUshellFiori2LoadingOverlay");a=a||"full";jQuery("#sapUshellFiori2LoadingDialog").toggleClass("sapUshellShellHidden",false);if(this._firstLoading){this._firstLoading=false;if(a==='minimal'){j.toggleClass("sapUshellInitialLoadingDialogOverlayNoAnimation",true);}else{j.toggleClass("sapUshellInitialLoadingDialogOverlayAnimation",true);}}else{if(a==='minimal'){j.toggleClass("sapUshellLoadingDialogOverlayNoAnimation",true);}else{j.toggleClass("sapUshellLoadingDialogOverlayAnimation",true);}}jQuery("#fiori2LoadingDialogBusyIndicator").toggleClass("sapUshellLoadingDialogBusyIndicatorAnimation",true);};sap.ushell.ui.launchpad.Fiori2LoadingDialog.prototype.isOpen=function(){return!jQuery("#sapUshellFiori2LoadingDialog").hasClass("sapUshellShellHidden");};sap.ushell.ui.launchpad.Fiori2LoadingDialog.prototype.closeLoadingScreen=function(){this.end=new Date().getTime();var t=this.end-this.start;if(t<350){jQuery("#sapUshellFiori2LoadingDialog").toggleClass("sapUshellShellHidden",true);jQuery("#sapUshellFiori2LoadingOverlay").toggleClass("sapUshellLoadingDialogOverlayNoAnimation",false);jQuery("#sapUshellFiori2LoadingOverlay").toggleClass("sapUshellLoadingDialogOverlayAnimation",false);jQuery("#sapUshellFiori2LoadingOverlay").toggleClass("sapUshellInitialLoadingDialogOverlayAnimation",false);jQuery("#fiori2LoadingDialogBusyIndicator").toggleClass("sapUshellLoadingDialogBusyIndicatorAnimation",false);}else{setTimeout(function(){jQuery("#sapUshellFiori2LoadingDialog").toggleClass("sapUshellShellHidden",true);jQuery("#sapUshellFiori2LoadingOverlay").toggleClass("sapUshellLoadingDialogOverlayNoAnimation",false);jQuery("#sapUshellFiori2LoadingOverlay").toggleClass("sapUshellLoadingDialogOverlayAnimation",false);jQuery("#sapUshellFiori2LoadingOverlay").toggleClass("sapUshellInitialLoadingDialogOverlayAnimation",false);jQuery("#fiori2LoadingDialogBusyIndicator").toggleClass("sapUshellLoadingDialogBusyIndicatorAnimation",false);},800-t);}};sap.ushell.ui.launchpad.Fiori2LoadingDialog.prototype.exit=function(){this._oBusyIndicator.destroy();}}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.GroupHeaderActions')){jQuery.sap.declare("sap.ushell.ui.launchpad.GroupHeaderActions");jQuery.sap.require('sap.ui.core.Control');sap.ui.core.Control.extend("sap.ushell.ui.launchpad.GroupHeaderActions",{metadata:{library:"sap.ushell",properties:{"isOverflow":{type:"boolean",group:"Misc",defaultValue:false},"tileActionModeActive":{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{"content":{type:"sap.ui.core.Control",multiple:true,singularName:"content"},"overflowCtrl":{type:"sap.ui.core.Control",multiple:true,singularName:"overflowCtrl"}},events:{"afterRendering":{}}}});sap.ushell.ui.launchpad.GroupHeaderActions.M_EVENTS={'afterRendering':'afterRendering'};(function(){"use strict";sap.ushell.ui.launchpad.GroupHeaderActions.prototype.onAfterRendering=function(){this.fireAfterRendering();};sap.ushell.ui.launchpad.GroupHeaderActions.prototype._getActionOverflowControll=function(){var t=this;return[new sap.m.Button({icon:'sap-icon://overflow',type:'Transparent',press:function(e){var a=new sap.m.ActionSheet({placement:sap.m.PlacementType.Auto});t.getContent().forEach(function(b){var c=b.clone();c.setModel(b.getModel());c.setBindingContext(b.getBindingContext());a.addButton(c);});a.openBy(e.getSource());}}).addStyleClass('sapUshellHeaderActionButton')];};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.GroupHeaderActionsRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.launchpad.GroupHeaderActionsRenderer");sap.ushell.ui.launchpad.GroupHeaderActionsRenderer={};sap.ushell.ui.launchpad.GroupHeaderActionsRenderer.render=function(r,c){var i=c.getIsOverflow(),a=c.getTileActionModeActive();r.write("<div");r.writeControlData(c);r.writeClasses();r.write(">");var C=c.getContent();if(a){if(i){jQuery.each(c._getActionOverflowControll(),function(){r.renderControl(this);});}else{jQuery.each(C,function(){r.renderControl(this);});}}r.write("</div>");};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.GroupListItem')){jQuery.sap.declare("sap.ushell.ui.launchpad.GroupListItem");jQuery.sap.require('sap.m.ListItemBase');sap.m.ListItemBase.extend("sap.ushell.ui.launchpad.GroupListItem",{metadata:{library:"sap.ushell",properties:{"title":{type:"string",group:"Misc",defaultValue:null},"defaultGroup":{type:"boolean",group:"Misc",defaultValue:false},"show":{type:"boolean",group:"Misc",defaultValue:true},"groupId":{type:"string",group:"Misc",defaultValue:null},"index":{type:"int",group:"Misc",defaultValue:null},"numberOfTiles":{type:"int",group:"Misc",defaultValue:0},"isGroupVisible":{type:"boolean",group:"Misc",defaultValue:true}},events:{"press":{},"afterRendering":{}}}});sap.ushell.ui.launchpad.GroupListItem.M_EVENTS={'press':'press','afterRendering':'afterRendering'};(function(){"use strict";jQuery.sap.require('sap.m.Input');sap.ushell.ui.launchpad.GroupListItem.prototype.exit=function(){sap.m.ListItemBase.prototype.exit.apply(this,arguments);};sap.ushell.ui.launchpad.GroupListItem.prototype.onAfterRendering=function(){this.fireAfterRendering();};sap.ushell.ui.launchpad.GroupListItem.prototype.groupHasVisibleTiles=function(){var g=this.getModel().getProperty("/groups/"+this.getIndex()+"/tiles");var a=this.getModel().getProperty("/groups/"+this.getIndex()+"/links");return sap.ushell.utils.groupHasVisibleTiles(g,a);};sap.ushell.ui.launchpad.GroupListItem.prototype.onclick=function(){this.firePress({id:this.getId()});};sap.ushell.ui.launchpad.GroupListItem.prototype.onsapenter=function(){this.firePress({id:this.getId(),action:"sapenter"});};sap.ushell.ui.launchpad.GroupListItem.prototype.setGroupId=function(g){this.setProperty("groupId",g,true);return this;};sap.ushell.ui.launchpad.GroupListItem.prototype.setTitle=function(t){this.setProperty("title",t);this.$().find(".sapMSLITitleOnly").text(t);return this;};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.GroupListItemRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.launchpad.GroupListItemRenderer");jQuery.sap.require('sap.m.ListItemBaseRenderer');sap.ushell.ui.launchpad.GroupListItemRenderer=sap.ui.core.Renderer.extend(sap.m.ListItemBaseRenderer);sap.ushell.ui.launchpad.GroupListItemRenderer.renderLIAttributes=function(r){r.addClass("sapUshellGroupLI");r.addClass("sapUshellGroupListItem");};sap.ushell.ui.launchpad.GroupListItemRenderer.renderLIContent=function(r,l){r.write("<div");r.addClass("sapMSLIDiv");r.addClass("sapMSLITitleDiv");r.writeClasses();if(!l.getVisible()){r.addStyle("display","none");r.writeStyles();}r.write(">");r.write("<div");r.addClass("sapMSLITitleOnly");r.writeClasses();r.write(">");r.writeEscaped(l.getTitle());r.write("</div>");r.write("</div>");};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.HeaderTileRenderer')){jQuery.sap.declare("sap.ushell.ui.launchpad.HeaderTileRenderer");sap.ushell.ui.launchpad.HeaderTileRenderer={};var translationBundle=sap.ushell.resources.i18n;sap.ushell.ui.launchpad.HeaderTileRenderer.render=function(r,c){"use strict";r.write("<");r.write(c.getHeaderLevel().toLowerCase());r.writeControlData(c);r.addClass("sapUshellHeaderTile");if(!c.getVisible()){r.addClass("sapUshellHidden");}r.writeClasses();r.writeAccessibilityState(c,{label:c.getHeaderText()+translationBundle.getText("HeaderCategory")});r.write(">");r.writeEscaped(c.getHeaderText());r.write("</");r.write(c.getHeaderLevel().toLowerCase());r.write(">");};};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.LinkTileWrapper')){jQuery.sap.declare("sap.ushell.ui.launchpad.LinkTileWrapper");jQuery.sap.require('sap.ui.core.Control');sap.ui.core.Control.extend("sap.ushell.ui.launchpad.LinkTileWrapper",{metadata:{library:"sap.ushell",properties:{"uuid":{type:"string",group:"Misc",defaultValue:null},"tileCatalogId":{type:"string",group:"Misc",defaultValue:null},"target":{type:"string",group:"Misc",defaultValue:null},"visible":{type:"boolean",group:"Misc",defaultValue:true},"debugInfo":{type:"string",group:"Misc",defaultValue:null},"animationRendered":{type:"boolean",group:"Misc",defaultValue:false},"isLocked":{type:"boolean",group:"Misc",defaultValue:false},"tileActionModeActive":{type:"boolean",group:"Misc",defaultValue:false},"ieHtml5DnD":{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{"tileViews":{type:"sap.ui.core.Control",multiple:true,singularName:"tileView"},"footItems":{type:"sap.ui.core.Control",multiple:true,singularName:"footItem"}},events:{"press":{},"coverDivPress":{},"afterRendering":{},"showActions":{}}}});sap.ushell.ui.launchpad.LinkTileWrapper.M_EVENTS={'press':'press','coverDivPress':'coverDivPress','afterRendering':'afterRendering','showActions':'showActions'};(function(){"use strict";sap.ushell.ui.launchpad.LinkTileWrapper.prototype.ontap=function(e,u){jQuery.sap.log.info("Tile clicked:",this.getDebugInfo(),"sap.ushell.ui.launchpad.LinkTileWrapper");return;};sap.ushell.ui.launchpad.LinkTileWrapper.prototype.destroy=function(s){this.destroyTileViews();sap.ui.core.Control.prototype.destroy.call(this,s);};sap.ushell.ui.launchpad.LinkTileWrapper.prototype.addTileView=function(o,s){o.setParent(null);jQuery.sap.require('sap.ushell.ui.launchpad.AccessibilityCustomData');o.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"tabindex",value:"-1",writeToDom:true}));sap.ui.base.ManagedObject.prototype.addAggregation.call(this,"tileViews",o,s);};sap.ushell.ui.launchpad.LinkTileWrapper.prototype.destroyTileViews=function(){if(this.mAggregations["tileViews"]){this.mAggregations["tileViews"].length=0;}};sap.ushell.ui.launchpad.LinkTileWrapper.prototype.onAfterRendering=function(){this.fireAfterRendering();};sap.ushell.ui.launchpad.LinkTileWrapper.prototype._launchTileViaKeyboard=function(e){if(e.target.tagName!=="BUTTON"){var t=this.getTileViews()[0];if(t.firePress){this.triggerClickEvent(t);}else{t=t.getContent()[0];this.triggerClickEvent(t);}}};sap.ushell.ui.launchpad.LinkTileWrapper.prototype.triggerClickEvent=function(c){var C=document.createEvent('MouseEvents');C.initEvent('click',false,true);c.getDomRef().dispatchEvent(C);};sap.ushell.ui.launchpad.LinkTileWrapper.prototype.onsapenter=function(e){this._launchTileViaKeyboard(e);};sap.ushell.ui.launchpad.LinkTileWrapper.prototype.onsapspace=function(e){this._launchTileViaKeyboard(e);};sap.ushell.ui.launchpad.LinkTileWrapper.prototype.onclick=function(e){if(this.getTileActionModeActive()){e.preventDefault();}else{var c=this.getTileViews()[0],c=c.getContent?c.getContent()[0]:c,C=c.getHref();sap.ui.getCore().getEventBus().publish("launchpad","dashboardTileLinkClick",{targetHash:C});}};sap.ushell.ui.launchpad.LinkTileWrapper.prototype.setVisible=function(v){this.setProperty("visible",v,true);return this.toggleStyleClass("sapUshellHidden",!v);};sap.ushell.ui.launchpad.LinkTileWrapper.prototype.setAnimationRendered=function(v){this.setProperty('animationRendered',v,true);};sap.ushell.ui.launchpad.LinkTileWrapper.prototype._handleTileShadow=function(j,a){if(j.length){j.unbind('mouseenter mouseleave');var u,t=j.css("border").split("px")[0],m=this.getModel();if(t>0){u=j.css("border-color");}else{u=this.getRgba();}j.hover(function(){if(!m.getProperty('/tileActionModeActive')){var o=jQuery(j).css('box-shadow'),T=o?o.split(') ')[1]:null,U;if(T){U=T+" "+u;jQuery(this).css('box-shadow',U);}}},function(){jQuery(this).css('box-shadow','');});}};sap.ushell.ui.launchpad.LinkTileWrapper.prototype.setUuid=function(u){this.setProperty("uuid",u,true);return this;};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.LinkTileWrapperRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.launchpad.LinkTileWrapperRenderer");sap.ushell.ui.launchpad.LinkTileWrapperRenderer={};sap.ushell.ui.launchpad.LinkTileWrapperRenderer.render=function(r,c){var t=null,m=c.getModel();try{t=c.getTileViews()[0];}catch(e){jQuery.sap.log.warning("Failed to load tile view: ",e.message);t=new sap.m.Text({text:"Failed to load. "});}r.write("<div");if(m&&m.getProperty("/enableHelp")){r.writeAttribute("data-tileCatalogId",c.getTileCatalogId());}r.writeControlData(c);r.addClass("sapUshellLinkTile");if(!c.getVisible()){r.addClass("sapUshellHidden");}if(c.getIsLocked()){r.addClass("sapUshellLockedTile");}r.writeClasses();if(c.getIeHtml5DnD()){r.writeAttribute("draggable","true");}r.writeAttributeEscaped("tabindex","-1");var l=c.data('layoutPosition');if(l){var s='-webkit-transform:'+l.translate3D+';-ms-transform:'+l.translate2D+';transform:'+l.translate3D;r.writeAttribute("style",s);}r.write(">");r.addClass("sapUshellTileInner");if(this.renderTileView){this.renderTileView(r,t,c.getTarget());}r.write("</div>");};sap.ushell.ui.launchpad.LinkTileWrapperRenderer.renderTileView=function(r,t,T){if((T||"")!==""){r.write("<a");r.writeClasses();r.writeAttributeEscaped("href","#"+T);r.write(">");r.renderControl(t);r.write("</a>");}else{r.write("<div");r.writeClasses();r.writeAttribute("title",t.getText?t.getText():'');r.write(">");r.renderControl(t);r.write("</div>");}};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.LoadingDialog')){jQuery.sap.declare("sap.ushell.ui.launchpad.LoadingDialog");jQuery.sap.require('sap.ui.core.Control');sap.ui.core.Control.extend("sap.ushell.ui.launchpad.LoadingDialog",{metadata:{library:"sap.ushell",properties:{"iconUri":{type:"sap.ui.core.URI",group:"Appearance",defaultValue:null},"text":{type:"sap.ui.core.URI",group:"Appearance",defaultValue:null},"loadAnimationWithInterval":{type:"boolean",group:"Appearance",defaultValue:true}}}});(function(){"use strict";jQuery.sap.require('sap.ui.core.Icon');jQuery.sap.require('sap.ui.core.Popup');jQuery.sap.require('sap.m.Label');sap.ushell.ui.launchpad.LoadingDialog.prototype.init=function(){this._oPopup=new sap.ui.core.Popup();this._oPopup.restoreFocus=false;this._oPopup.setShadow(false);this._oPopup.setModal(true,"sapUshellLoadingDialog");this.oIcon=new sap.ui.core.Icon();this._oLabel=new sap.m.Label(this.getId()+'loadingLabel');this.sState="idle";this.sLoadingString=sap.ushell.resources.i18n.getText("genericLoading").replace("..."," ");};sap.ushell.ui.launchpad.LoadingDialog.prototype.exit=function(){this._oPopup.close();this._oPopup.destroy();this.oIcon.destroy();this._oLabel.destroy();};sap.ushell.ui.launchpad.LoadingDialog.prototype.isOpen=function(){return this._oPopup.isOpen();};sap.ushell.ui.launchpad.LoadingDialog.prototype.openLoadingScreen=function(){if(this.sState==="idle"){this.sState="busy";}if(this.getLoadAnimationWithInterval()){this.toggleStyleClass('sapUshellVisibilityHidden',true);this._iTimeoutId=setTimeout(function(){this.toggleStyleClass('sapUshellVisibilityHidden',false);this.$().focus();}.bind(this),3000);}else{this.toggleStyleClass('sapUshellVisibilityHidden',false);this.$().focus();}if(!this.getVisible()){this.setProperty('visible',true,true);this.$().show();}if(!this.isOpen()){this._oPopup.setContent(this);this._oPopup.setPosition("center center","center center",document,"0 0","fit");this._oPopup.open();}};sap.ushell.ui.launchpad.LoadingDialog.prototype.setLoadAnimationWithInterval=function(s){this.setProperty('loadAnimationWithInterval',s,true);};sap.ushell.ui.launchpad.LoadingDialog.prototype.showAppInfo=function(a,i,A){this.setProperty('text',a,true);this.setProperty('iconUri',i,true);this.oIcon.setSrc(i);this._oLabel.setText(a);this._oLabel.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:'aria-hidden',value:"true",writeToDom:true}));if(jQuery("#"+this.getId()+"accessibility-helper")[0]&&A){jQuery("#"+this.getId()+"accessibility-helper")[0].innerText=this.sLoadingString;}};sap.ushell.ui.launchpad.LoadingDialog.prototype.closeLoadingScreen=function(){if(this._iTimeoutId){clearTimeout(this._iTimeoutId);}if(this.getVisible()){this.sState="idle";this.setProperty('visible',false,true);this.$().hide();this._oPopup.close();}};sap.ushell.ui.launchpad.LoadingDialog.prototype.onAfterRendering=function(){this.$().css("width","20rem");};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.LoadingDialogRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.launchpad.LoadingDialogRenderer");sap.ushell.ui.launchpad.LoadingDialogRenderer={};sap.ushell.ui.launchpad.LoadingDialogRenderer.render=function(r,c){var t=c.getTooltip_AsString();c._oLabel.addStyleClass("sapUshellLoadingDialogLabel");r.write("<div");r.writeControlData(c);r.addClass("sapUshellLoadingDialogControl");r.writeClasses();if(t){r.writeAttributeEscaped("title",t);}r.write(">");if(jQuery.os.ios||!c._isPlatformDependent){this.renderAppInfo(r,c);this.renderFioriFlower(r,c);}else{this.renderFioriFlower(r,c);this.renderAppInfo(r,c);}r.write("</div>");};sap.ushell.ui.launchpad.LoadingDialogRenderer.renderAppInfo=function(r,c){r.write("<div").addClass("sapUshellLoadingDialogAppData").writeClasses().write(">");if(c.getIconUri()){r.renderControl(c.oIcon);}r.write("<span");r.writeAttribute("id",c.getId()+"accessibility-helper");r.addClass("sapUshellAccessibilityHelper");r.writeClasses();r.writeAccessibilityState(c,{live:"rude","relevant":"additions text"});r.write(">");r.write("</span>");r.renderControl(c._oLabel);r.write("</div>");};sap.ushell.ui.launchpad.LoadingDialogRenderer.renderFioriFlower=function(r,c){var i,R=false,u=[/Android\s4\.2.+GT-I9505.+Chrome\/18/];if(navigator.userAgent){for(i=0;i<u.length;i=i+1){if(u[i].test(navigator.userAgent)){R=true;break;}}}if(jQuery.support.cssAnimations&&!R){r.write("<div id='fiori2-loader'>");r.write("<div class='fiori2-blossom'>");for(i=1;i<6;i=i+1){r.write("<div class='fiori2-leafContainer fiori2-leafContainer"+i+"'>");r.write("<div class='fiori2-leaf fiori2-leaf"+i+"'></div>");r.write("</div>");}r.write("</div>");r.write("</div>");}};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.Panel')){jQuery.sap.declare("sap.ushell.ui.launchpad.Panel");jQuery.sap.require('sap.m.Panel');sap.m.Panel.extend("sap.ushell.ui.launchpad.Panel",{metadata:{library:"sap.ushell",properties:{"translucent":{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{"headerContent":{type:"sap.ui.core.Control",multiple:true,singularName:"headerContent"},"headerBar":{type:"sap.m.Bar",multiple:false}}}});sap.ushell.ui.launchpad.Panel.prototype.updateAggregation=sap.ushell.override.updateAggregation;};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.PanelRenderer')){jQuery.sap.declare("sap.ushell.ui.launchpad.PanelRenderer");sap.ushell.ui.launchpad.PanelRenderer={};sap.ushell.ui.launchpad.PanelRenderer.render=function(r,c){"use strict";if(!c.getVisible()){return;}r.write("<section");r.writeControlData(c);r.addClass("sapMPanel");r.addClass("sapUshellPanel");if(!c.getTranslucent()){r.addClass("sapMPanelBG");}r.addStyle("width",c.getWidth());r.addStyle("height",c.getHeight());r.writeClasses();r.writeStyles();r.write(">");var h=c.getHeaderContent();var l=h.length;if(c.getHeaderText()||l>0||c.getHeaderBar()){r.write("<header");r.addClass("sapMPanelHdr");r.addClass("sapUshellCatalogHeader");r.writeClasses();r.write(">");if(c.getHeaderText()||l>0){r.write("<");r.write(c.getHeaderLevel().toLowerCase());r.write(">");if(c.getHeaderText()){r.writeEscaped(c.getHeaderText());}for(var j=0;j<l;j++){r.renderControl(h[j]);}r.write("</");r.write(c.getHeaderLevel().toLowerCase());r.write(">");}if(c.getHeaderBar()){r.renderControl(c.getHeaderBar());}r.write("</header>");}r.write("<div");r.addClass("sapMPanelContent");r.addClass("sapUshellPanelContent");r.writeClasses();r.write(">");var C=c.getContent();var L=C.length;for(var i=0;i<L;i++){r.renderControl(C[i]);}r.write("</div>");r.write("</section>");};};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.PlusTileRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.launchpad.PlusTileRenderer");sap.ushell.ui.launchpad.PlusTileRenderer={};var t=sap.ushell.resources.i18n;sap.ushell.ui.launchpad.PlusTileRenderer.render=function(r,c){r.write("<div");r.writeAttribute("tabindex","-1");r.writeControlData(c);r.addClass("sapUshellTile");r.addClass("sapUshellPlusTile");r.addClass("sapMGT");r.writeClasses();r.writeAccessibilityState(c,{label:t.getText("TilePlus_label")});r.write(">");r.renderControl(c.oIcon);r.write("</div>");};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.Tile')){jQuery.sap.declare("sap.ushell.ui.launchpad.Tile");jQuery.sap.require('sap.ui.core.Control');sap.ui.core.Control.extend("sap.ushell.ui.launchpad.Tile",{metadata:{library:"sap.ushell",properties:{"long":{type:"boolean",group:"Misc",defaultValue:false},"uuid":{type:"string",group:"Misc",defaultValue:null},"tileCatalogId":{type:"string",group:"Misc",defaultValue:null},"target":{type:"string",group:"Misc",defaultValue:null},"visible":{type:"boolean",group:"Misc",defaultValue:true},"debugInfo":{type:"string",group:"Misc",defaultValue:null},"rgba":{type:"string",group:"Misc",defaultValue:null},"animationRendered":{type:"boolean",group:"Misc",defaultValue:false},"isLocked":{type:"boolean",group:"Misc",defaultValue:false},"showActionsIcon":{type:"boolean",group:"Misc",defaultValue:false},"tileActionModeActive":{type:"boolean",group:"Misc",defaultValue:false},"ieHtml5DnD":{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{"tileViews":{type:"sap.ui.core.Control",multiple:true,singularName:"tileView"},"pinButton":{type:"sap.ui.core.Control",multiple:true,singularName:"pinButton"}},events:{"press":{},"coverDivPress":{},"afterRendering":{},"showActions":{},"deletePress":{}}}});sap.ushell.ui.launchpad.Tile.M_EVENTS={'press':'press','coverDivPress':'coverDivPress','afterRendering':'afterRendering','showActions':'showActions','deletePress':'deletePress'};(function(){"use strict";sap.ushell.ui.launchpad.Tile.prototype.getActionSheetIcon=function(){if(!this.getTileActionModeActive()){return undefined;}if(!this.actionSheetIcon){this.actionSheetIcon=new sap.ui.core.Icon({src:"sap-icon://overflow"});this.actionSheetIcon.setTooltip(sap.ushell.resources.i18n.getText("configuration.category.tile_actions"));this.actionSheetIcon.addStyleClass('sapUshellTileActionIconDivBottomInner');}return this.actionSheetIcon;};sap.ushell.ui.launchpad.Tile.prototype.ontap=function(e,u){jQuery.sap.log.info("Tile clicked:",this.getDebugInfo(),"sap.ushell.ui.launchpad.Tile");this.firePress();return;};sap.ushell.ui.launchpad.Tile.prototype.destroy=function(s){this.destroyTileViews();sap.ui.core.Control.prototype.destroy.call(this,s);};sap.ushell.ui.launchpad.Tile.prototype.addTileView=function(o,s){o.setParent(null);sap.ui.base.ManagedObject.prototype.addAggregation.call(this,"tileViews",o,s);};sap.ushell.ui.launchpad.Tile.prototype.destroyTileViews=function(){if(this.mAggregations["tileViews"]){this.mAggregations["tileViews"].length=0;}};sap.ushell.ui.launchpad.Tile.prototype.onAfterRendering=function(){var r;r=this.getRgba();if(r){this._redrawRGBA();}this.fireAfterRendering();};sap.ushell.ui.launchpad.Tile.prototype._launchTileViaKeyboard=function(e){if(this.getTileActionModeActive()){this.fireCoverDivPress({id:this.getId()});}else{if(e.target.tagName!=="BUTTON"){var t=this.getTileViews()[0],p=false;if(t.firePress){t.firePress({id:this.getId()});}else{while(t.getContent&&!p){t=t.getContent()[0];if(t.firePress){t.firePress({id:this.getId()});p=true;}}}}}};sap.ushell.ui.launchpad.Tile.prototype.onsapenter=function(e){this._launchTileViaKeyboard(e);if(!this.getTileActionModeActive()){this._announceLoadingApplication();}};sap.ushell.ui.launchpad.Tile.prototype.onsapspace=function(e){this._launchTileViaKeyboard(e);if(!this.getTileActionModeActive()){this._announceLoadingApplication();}};sap.ushell.ui.launchpad.Tile.prototype.onfocusin=function(e){var c=this.getDomRef().getAttribute("class"),p;p=c?c.indexOf("sapUshellPlusTile")!==-1:false;if(!p){var j=jQuery(this.getDomRef()).prevUntil("h3"),a,C="",t,b;if(j.length>0){a=j[j.length-1].previousSibling;}else{a=this.getDomRef().previousSibling;}if(a){C=a.getAttribute('id');}b=this.getDomRef().querySelector(".sapUshellTileInner");var d=this.getDomRef().querySelector(".sapUshellTileDeleteClickArea .sapUiIcon");var f=d?d.id:"";if(b){var A=(C&&C!=="")?"sapUshellCatalogAccessibilityTileText":"sapUshellDashboardAccessibilityTileText";t=b.children[0].getAttribute('id');var l=[A,t,f,C];this.getDomRef().setAttribute("aria-labelledby",l.join(" "));}}};sap.ushell.ui.launchpad.Tile.prototype.onclick=function(e){if(this.getTileActionModeActive()){var s=e.originalEvent.srcElement;if(jQuery(s).closest('.sapUshellTileDeleteClickArea').length>0){this.fireDeletePress();}else{this.fireCoverDivPress({id:this.getId()});}}else{this._announceLoadingApplication();}};sap.ushell.ui.launchpad.Tile.prototype._announceLoadingApplication=function(){var a=document.getElementById("sapUshellLoadingAccessibilityHelper-appInfo"),l=sap.ushell.resources.i18n.getText("screenReaderNavigationLoading");if(a){a.setAttribute("role","alert");a.innerHTML=l;setTimeout(function(){a.removeAttribute("role");a.innerHTML="";},0);}};sap.ushell.ui.launchpad.Tile.prototype._initDeleteAction=function(){var t=this;if(!this.deleteIcon){this.deleteIcon=new sap.ui.core.Icon({src:"sap-icon://decline",tooltip:sap.ushell.resources.i18n.getText("removeButtonTItle")});this.deleteIcon.addEventDelegate({onclick:function(e){t.fireDeletePress();e.stopPropagation();}});this.deleteIcon.addStyleClass("sapUshellTileDeleteIconInnerClass");this.deleteIcon.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-label",value:sap.ushell.resources.i18n.getText("removeButtonLabel"),writeToDom:true}));}return this.deleteIcon;};sap.ushell.ui.launchpad.Tile.prototype.setShowActionsIcon=function(s){var t=this,i;if(s){i=new sap.ui.core.Icon({size:"1rem",src:"sap-icon://overflow",press:function(e){t.fireShowActions();t.addStyleClass('showTileActionsIcon');var E=sap.ui.getCore().getEventBus(),a=function(n,b,c){c.removeStyleClass('showTileActionsIcon');E.unsubscribe("dashboard","actionSheetClose",a);};E.subscribe("dashboard","actionSheetClose",a);}});i.addStyleClass("sapUshellTileActionsIconClass");this.actionIcon=i;}else if(this.actionIcon){this.actionIcon.destroy(true);}this.setProperty("showActionsIcon",s);};sap.ushell.ui.launchpad.Tile.prototype.setVisible=function(v){this.setProperty("visible",v,true);return this.toggleStyleClass("sapUshellHidden",!v);};sap.ushell.ui.launchpad.Tile.prototype.setRgba=function(v){this.setProperty("rgba",v,true);this._redrawRGBA(arguments);};sap.ushell.ui.launchpad.Tile.prototype.setAnimationRendered=function(v){this.setProperty('animationRendered',v,true);};sap.ushell.ui.launchpad.Tile.prototype._handleTileShadow=function(j,a){if(j.length){j.unbind('mouseenter mouseleave');var u,t=j.css("border").split("px")[0],m=this.getModel();if(t>0){u=j.css("border-color");}else{u=this.getRgba();}j.hover(function(){if(!m.getProperty('/tileActionModeActive')){var o=jQuery(j).css('box-shadow'),T=o?o.split(') ')[1]:null,U;if(T){U=T+" "+u;jQuery(this).css('box-shadow',U);}}},function(){jQuery(this).css('box-shadow','');});}};sap.ushell.ui.launchpad.Tile.prototype._redrawRGBA=function(a){var r=this.getRgba(),j,i;if(r){j=jQuery.sap.byId(this.getId());i=(jQuery.browser.msie&&(parseInt(jQuery.browser.version,9)===9));if(!j){return;}if(!this.getModel().getProperty('/animationRendered')){if(i){j.animate({backgroundColor:r},2000);}else{j.css('transition','background-color 2s');j.css('background-color',r);}}else{j.css('background-color',r);}this._handleTileShadow(j,a);}};sap.ushell.ui.launchpad.Tile.prototype.setLong=function(l){this.setProperty("long",l,true);return this.toggleStyleClass("sapUshellLong",l);};sap.ushell.ui.launchpad.Tile.prototype.setUuid=function(u){this.setProperty("uuid",u,true);return this;};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.TileContainer')){jQuery.sap.declare("sap.ushell.ui.launchpad.TileContainer");jQuery.sap.require('sap.ui.core.Control');sap.ui.core.Control.extend("sap.ushell.ui.launchpad.TileContainer",{metadata:{library:"sap.ushell",properties:{"scrollType":{type:"string",group:"Misc",defaultValue:'item'},"animationSpeed":{type:"int",group:"Misc",defaultValue:500},"groupId":{type:"string",group:"Misc",defaultValue:null},"showHeader":{type:"boolean",group:"Misc",defaultValue:true},"showPlaceholder":{type:"boolean",group:"Misc",defaultValue:true},"defaultGroup":{type:"boolean",group:"Misc",defaultValue:false},"isLastGroup":{type:"boolean",group:"Misc",defaultValue:false},"headerText":{type:"string",group:"Misc",defaultValue:null},"headerLevel":{type:"sap.m.HeaderLevel",group:"Misc",defaultValue:sap.m.HeaderLevel.H2},"groupHeaderLevel":{type:"sap.m.HeaderLevel",group:"Misc",defaultValue:sap.m.HeaderLevel.H4},"showGroupHeader":{type:"boolean",group:"Misc",defaultValue:true},"visible":{type:"boolean",group:"Misc",defaultValue:true},"sortable":{type:"boolean",group:"Misc",defaultValue:true},"showNoData":{type:"boolean",group:"Misc",defaultValue:false},"noDataText":{type:"string",group:"Misc",defaultValue:null},"isGroupLocked":{type:"boolean",group:"Misc",defaultValue:null},"editMode":{type:"boolean",group:"Misc",defaultValue:false},"showBackground":{type:"boolean",group:"Misc",defaultValue:false},"icon":{type:"string",group:"Misc",defaultValue:'sap-icon://locked'},"showIcon":{type:"boolean",group:"Misc",defaultValue:false},"deluminate":{type:"boolean",group:"Misc",defaultValue:false},"showMobileActions":{type:"boolean",group:"Misc",defaultValue:false},"enableHelp":{type:"boolean",group:"Misc",defaultValue:false},"tileActionModeActive":{type:"boolean",group:"Misc",defaultValue:false},"ieHtml5DnD":{type:"boolean",group:"Misc",defaultValue:false},"showDragIndicator":{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{"tiles":{type:"sap.ushell.ui.launchpad.Tile",multiple:true,singularName:"tile"},"links":{type:"sap.ui.core.Control",multiple:true,singularName:"link"},"beforeContent":{type:"sap.ui.core.Control",multiple:true,singularName:"beforeContent"},"afterContent":{type:"sap.ui.core.Control",multiple:true,singularName:"afterContent"},"footerContent":{type:"sap.ui.core.Control",multiple:true,singularName:"footerContent"},"headerActions":{type:"sap.ui.core.Control",multiple:true,singularName:"headerAction"}},events:{"afterRendering":{},"add":{},"titleChange":{}}}});sap.ushell.ui.launchpad.TileContainer.M_EVENTS={'afterRendering':'afterRendering','add':'add','titleChange':'titleChange'};(function(){"use strict";sap.ushell.ui.launchpad.TileContainer.prototype.init=function(){jQuery.sap.require("sap.ushell.ui.launchpad.PlusTile");this.bIsFirstTitleChange=true;this._sDefaultValue=sap.ushell.resources.i18n.getText("new_group_name");this._sOldTitle="";this.oIcon=new sap.ui.core.Icon({src:this.getIcon()});this.oIcon.addStyleClass('sapUshellContainerIcon');this.oPlusTile=new sap.ushell.ui.launchpad.PlusTile({groupId:this.getGroupId(),press:[this.fireAdd,this]});this.oPlusTile.setParent(this);};sap.ushell.ui.launchpad.TileContainer.prototype.exit=function(){if(this.oPlusTile){this.oPlusTile.destroy();}};sap.ushell.ui.launchpad.TileContainer.prototype.onAfterRendering=function(){var t=this,j;if(this.getEnableHelp()){this.oPlusTile.addStyleClass("help-id-plusTile");}this.handleNoItemsToDisplayMessage();var E=this.getModel()&&this.getModel().getProperty("/enableRenameLockedGroup")||false;jQuery("#"+this.getId()+"-title").find(this.getHeaderLevel()).click(function(){var e=E||!t.getIsGroupLocked()&&!t.getDefaultGroup()&&t.getTileActionModeActive();t.setEditMode(e);});if((document.documentMode)&&(navigator.maxTouchPoints||navigator.msMaxTouchPoints)){j=jQuery(this.getDomRef());j.on("MSHoldVisual contextmenu",".sapUshellTile",function(e){e.preventDefault();});}this.fireAfterRendering();if(sap.ui.Device.system.desktop){this.handleScreenReaderAttr();}};sap.ushell.ui.launchpad.TileContainer.prototype.updateAggregation=sap.ushell.override.updateAggregation;sap.ushell.ui.launchpad.TileContainer.prototype.updateTiles=function(r){var n="tiles";if(this.isTreeBinding(n)){sap.ui.base.ManagedObject.prototype.updateAggregation.apply(this,arguments);}else{jQuery.sap.log.debug("Updating TileContainer. Reason: ",r);switch(r){case"filter":try{this.filterTiles();}catch(e){this.updateAggregation(n);}break;default:this.updateAggregation(n);}}};sap.ushell.ui.launchpad.TileContainer.prototype.handleNoItemsToDisplayMessage=function(){var t=this.getBinding('tiles'),i=t&&t.getContexts().length;if(i){this.$().find(".sapUshellNoFilteredItems").hide();}else{if(this.getShowNoData()){if(this.getNoDataText()){this.setNoDataText(this.getNoDataText());}else{this.setNoDataText(sap.ushell.resources.i18n.getText("noFilteredItems"));}this.$().find(".sapUshellNoFilteredItems").show();}}};sap.ushell.ui.launchpad.TileContainer.prototype.createMissingElementsInOnScreenElements=function(i,e,a,g,s,b,f,A){var p,n=null,G=null,j=a,S=this.getShowGroupHeader(),c=e.length,o;for(j=a;j<c;j++){p=e[j].getPath();if(!i.onScreenPathIndexMap[p]){if(g&&s.length>0){n=s[0].fnGroup(e[j]);if(typeof n==="string"){n={key:n};}if(G===null&&j>0){G=s[0].fnGroup(e[j-1]);}if(n.key!==G){if(b.groupHeaderFactory){o=b.groupHeaderFactory(n);}if(!i.onScreenHeaders[n.key]){A(n,o);i.onScreenHeaders[n.key]={aItemsRefrenceIndex:this.getTiles().length-1,isVisible:S};}G=n.key;}}f(e[j]);i.onScreenPathIndexMap[p]={aItemsRefrenceIndex:this.getTiles().length-1,isVisible:true};}else{throw true;}}};sap.ushell.ui.launchpad.TileContainer.prototype.addNewItem=function(e){var n="tiles",a=this.getMetadata().getJSONKeys()[n],b=this.mBindingInfos[n],f=b.factory,c=jQuery.proxy(function(C){var i=this.getId()+"-"+jQuery.sap.uid(),o=f(i,C);o.setBindingContext(C,b.model);this[a._sMutator](o);},this);c(e);};sap.ushell.ui.launchpad.TileContainer.prototype.markVisibleOnScreenElements=function(e,i){var a=0,p,b=e.length;for(a=0;a<b;a++){p=e[a].getPath();if(i.onScreenPathIndexMap[p]){i.onScreenPathIndexMap[p].isVisible=true;}else{return a;}}return a;};sap.ushell.ui.launchpad.TileContainer.prototype.indexOnScreenElements=function(o){var p,i,a={onScreenHeaders:{},onScreenPathIndexMap:{}},b=o.length,c;for(i=0;i<b;i++){c=o[i];if(c.getHeaderText){a.onScreenHeaders[c.getHeaderText()]={aItemsRefrenceIndex:i,isVisible:false};}else if(c.getBindingContext()){p=c.getBindingContext().getPath();a.onScreenPathIndexMap[p]={aItemsRefrenceIndex:i,isVisible:false};}}return a;};sap.ushell.ui.launchpad.TileContainer.prototype.showHideTilesAndHeaders=function(i,o){var s,n="tiles",S=this.getShowGroupHeader(),b=this.mBindingInfos[n].binding,g,r,e;for(s in i.onScreenPathIndexMap){if(i.onScreenPathIndexMap.hasOwnProperty(s)){e=i.onScreenPathIndexMap[s];r=o[e.aItemsRefrenceIndex];r.setVisible(e.isVisible);if(e.isVisible){g=b.aSorters[0].fnGroup(r.getBindingContext());i.onScreenHeaders[g].isVisible=S;}}}for(s in i.onScreenHeaders){if(i.onScreenHeaders.hasOwnProperty(s)){e=i.onScreenHeaders[s];o[e.aItemsRefrenceIndex].setVisible(e.isVisible);}}};sap.ushell.ui.launchpad.TileContainer.prototype.filterTiles=function(){var n="tiles",b=this.mBindingInfos[n],B=this.mBindingInfos[n].binding,a=B.getContexts(),i=this.getTiles(),c,d,l,f,s,e,g,h;d=this.indexOnScreenElements(i);c=this.markVisibleOnScreenElements(a,d);if(a[c]&&this.getTiles().length>0){l=this.getTiles()[this.getTiles().length-1].getBindingContext().getPath();f=a[c].getPath();s=l.split('/');e=f.split('/');h=s[s.length-1];g=e[e.length-1];if(parseInt(h,10)>parseInt(g,10)){throw true;}}this.createMissingElementsInOnScreenElements(d,a,c,B.isGrouped(),B.aSorters,b,this.addNewItem.bind(this),this.addTileGroup.bind(this));i=this.getTiles();this.showHideTilesAndHeaders(d,i);this.handleNoItemsToDisplayMessage();if(sap.ui.Device.system.desktop){this.handleScreenReaderAttr();}};sap.ushell.ui.launchpad.TileContainer.prototype.addTileGroup=function(g,h){this.addAggregation("tiles",h||new sap.ushell.ui.launchpad.HeaderTile({headerText:g.text||g.key,headerLevel:g.headerLevel||this.getGroupHeaderLevel(),visible:this.getShowGroupHeader()}));};sap.ushell.ui.launchpad.TileContainer.prototype.setNoDataText=function(n){this.setProperty("noDataText",n,true);if(this.getShowNoData()){this.$().find(".sapUshellNoFilteredItems").text(n);}return this;};sap.ushell.ui.launchpad.TileContainer.prototype.setGroupId=function(v){this.setProperty("groupId",v,true);if(this.oPlusTile){this.oPlusTile.setGroupId(v);}return this;};sap.ushell.ui.launchpad.TileContainer.prototype.setHeaderText=function(h){this.setProperty("headerText",h,true);this.$().find(".sapUshellContainerTitle").text(h);return this;};sap.ushell.ui.launchpad.TileContainer.prototype.setShowGroupHeader=function(v){this.setProperty("showGroupHeader",v,true);this.$().find(".sapUshellTileContainerHeader").toggleClass("sapUshellGroupHeaderHidden",!v);return this;};sap.ushell.ui.launchpad.TileContainer.prototype.setVisible=function(v){this.setProperty("visible",v,true);this.toggleStyleClass("sapUshellHidden",!v);return this;};sap.ushell.ui.launchpad.TileContainer.prototype.setShowMobileActions=function(s){var S=true;if(this.oHeaderButton){this.oHeaderButton.setVisible(s);}else if(s){S=false;}this.setProperty('showMobileActions',s,S);};sap.ushell.ui.launchpad.TileContainer.prototype.setShowIcon=function(s){this.setProperty('showIcon',s,true);jQuery('#'+this.getId()).find('.'+'sapUshellContainerIcon').toggleClass('sapUshellContainerIconHidden',!s);};sap.ushell.ui.launchpad.TileContainer.prototype.setDeluminate=function(d){this.setProperty('deluminate',d,true);this.toggleStyleClass('sapUshellDisableLockedGroupDuringDrag',d);return this;};sap.ushell.ui.launchpad.TileContainer.prototype.groupHasTiles=function(){var p='',t=this.getTiles(),l=[];if(this.getBindingContext()){p=this.getBindingContext().sPath;t=this.getModel().getProperty(p).tiles;}return sap.ushell.utils.groupHasVisibleTiles(t,l);};sap.ushell.ui.launchpad.TileContainer.prototype.handleScreenReaderAttr=function(){var c=this.getInnerContainerDomRef();var C=c.children;if(!C||C.length==0||!C[0].classList.contains("sapUshellHeaderTile")){return;}var o;var a;var b=[];for(var i=0;i<C.length;i++){if(C[i].classList.contains("sapUshellHidden")){continue;}if(C[i].classList.contains("sapUshellHeaderTile")){o=C[i];jQuery(o).attr("role","heading");jQuery(o).attr("aria-level","3");a=0;b=[];}else if(C[i].tagName=="LI"){a++;jQuery(C[i]).attr("aria-posinset",a);b.push(C[i]);var n=C[i+1];if(!n||n.tagName!="LI"){for(var j=0;j<b.length;j++){jQuery(b[j]).attr("aria-setsize",b.length);}}}}};sap.ushell.ui.launchpad.TileContainer.prototype.getInnerContainerDomRef=function(){var c=this.getDomRef(),i;if(!c){return null;}i=jQuery(c).find('.sapUshellTilesContainer-sortable');return i[0];};sap.ushell.ui.launchpad.TileContainer.prototype.setEditMode=function(v){this.setProperty('editMode',v,false);if(v){this.addStyleClass('sapUshellEditing');this._startEdit();}else{this.removeStyleClass('sapUshellEditing');}};sap.ushell.ui.launchpad.TileContainer.prototype._startEdit=function(){if(this.getModel()&&!this.getModel().getProperty("/editTitle")){this.getModel().setProperty("/editTitle",true,false);}if(!this.oEditInputField){jQuery.sap.require("sap.m.Input");var t=this;this.oEditInputField=new sap.m.Input({placeholder:this._sDefaultValue,value:this.getHeaderText()}).addStyleClass('sapUshellTileContainerTitleInput');this.oEditInputField.addEventDelegate({onAfterRendering:function(){setTimeout(function(){var e=this.oEditInputField.getDomRef();if(e){if(jQuery('#'+e.id+":visible").length>0){jQuery(e).find('input').focus();this.oEditInputField.selectText(0,t.oEditInputField.getValue().length);}}}.bind(this),0);}.bind(this),onfocusout:function(e){t._stopEdit();jQuery.proxy(t.setEditMode,t,false)();},onsapenter:function(e){t._stopEdit();jQuery.proxy(t.setEditMode,t,false)();setTimeout(function(){var T=e.srcControl,j=jQuery(T.getDomRef()).prev();j.focus();},0);}});}this._sOldTitle=this._sDefaultValue;this.oEditInputField.setValue(this.getHeaderText());if(sap.ui.Device.system.phone){var t=this;setTimeout(function(){var e=sap.ui.getCore().getEventBus();e.publish("launchpad","scrollToGroup",{group:t,groupChanged:false,focus:false});},100);}};sap.ushell.ui.launchpad.TileContainer.prototype._stopEdit=function(){var c=this.getHeaderText();var n=this.oEditInputField.getValue(),h;n=n.substring(0,256).trim()||this._sDefaultValue;h=n!==c;if(this.bIsFirstTitleChange&&n===this.oEditInputField.getPlaceholder()){h=true;}this.bIsFirstTitleChange=false;if(this.getModel()&&this.getModel().getProperty("/editTitle")){this.getModel().setProperty("/editTitle",false,false);}if(!this._sOldTitle){this._sOldTitle=c;this.setHeaderText(c);}else if(h){this.fireTitleChange({newTitle:n});this.setHeaderText(n);}};sap.ushell.ui.launchpad.TileContainer.prototype.exit=function(){if(this.oHeaderButton){this.oHeaderButton.destroy();}if(this.oActionSheet){this.oActionSheet.destroy();}if(sap.ui.core.Control.prototype.exit){sap.ui.core.Control.prototype.exit.apply(this,arguments);}};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.TileContainerRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.launchpad.TileContainerRenderer");sap.ushell.ui.launchpad.TileContainerRenderer={};sap.ushell.ui.launchpad.TileContainerRenderer.render=function(r,c){var t=c.getTiles(),h=c.getHeaderActions(),b=c.getBeforeContent(),a=c.getAfterContent(),f=c.getFooterContent()||[],v=false,d,l=c.getLinks();r.write("<div");r.writeControlData(c);r.addClass("sapUshellTileContainer");r.writeClasses();r.write(">");if(b.length){r.write("<div");r.addClass("sapUshellTileContainerBeforeContent");r.addClass("sapContrastPlus ");r.writeClasses();r.write(">");jQuery.each(b,function(){r.renderControl(this);});r.write("</div>");}r.write("<div");r.addClass("sapUshellTileContainerContent");if(c.getIsGroupLocked()){r.addClass("sapUshellTileContainerLocked");}if(c.getDefaultGroup()){r.addClass("sapUshellTileContainerDefault");}if(c.getShowBackground()){r.addClass("sapUshellTileContainerEditMode");}r.writeClasses();r.writeAttribute("tabindex","-1");r.write(">");if(c.getShowDragIndicator()){r.write("<div");r.addClass("sapUshellCircleBase");r.writeClasses();r.write(">");r.write("<div");r.addClass("sapUshellCircle");r.writeClasses();r.write(">");r.write("</div>");r.write("<div");r.addClass("sapUshellCircle");r.writeClasses();r.write(">");r.write("</div>");r.write("<div");r.addClass("sapUshellCircle");r.writeClasses();r.write(">");r.write("</div>");r.write("<div");r.addClass("sapUshellCircle");r.writeClasses();r.write(">");r.write("</div>");r.write("</div>");}if(c.getShowBackground()){r.write("<div");r.addClass("sapUshellGroupBackgroundContainer sapContrastPlus");r.writeClasses();r.write(">");r.write("</div>");}if(c.getShowHeader()){r.write("<div");r.addClass("sapUshellTileContainerHeader sapContrastPlus");r.writeAttribute("id",c.getId()+"-groupheader");r.writeClasses();if(c.getIeHtml5DnD()&&!c.getIsGroupLocked()&&!c.getDefaultGroup()&&c.getTileActionModeActive()){r.writeAttribute("draggable","true");}r.write(">");r.write("<div");r.writeAttribute("id",c.getId()+"-title");r.write(">");r.write("<");r.write(c.getHeaderLevel().toLowerCase());r.addClass('sapUshellContainerTitle');r.writeClasses();r.writeAttributeEscaped("title",c.getHeaderText());r.writeAttribute("id",c.getId()+"-titleText");var A={};A.role="group";if(c.getDefaultGroup()){A.label=sap.ushell.resources.i18n.getText("ariaLabelEditModeGroupDefault",c.getHeaderText());}else if(c.getIsGroupLocked()){A.label=sap.ushell.resources.i18n.getText("ariaLabelEditModeGroupLocked",c.getHeaderText());}else{A.label=sap.ushell.resources.i18n.getText("ariaLabelEditModeGroup",c.getHeaderText());}r.writeAccessibilityState(c,A);r.write(">");r.writeEscaped(c.getHeaderText());r.write("</");r.write(c.getHeaderLevel().toLowerCase());r.writeAttribute("id",c.getId()+"-groupheader");r.write(">");if(c.getShowIcon()){c.oIcon.removeStyleClass('sapUshellContainerIconHidden');}else{c.oIcon.addStyleClass('sapUshellContainerIconHidden');}r.renderControl(c.oIcon);r.renderControl(c.oEditInputField);r.write("<div");r.addClass('sapUshellContainerHeaderActions');r.writeClasses();r.write(">");jQuery.each(h,function(){r.renderControl(this);});r.write("</div>");r.write("</div>");r.write("</div>");}r.write("<ul");d=c.data('containerHeight');if(d){r.writeAttribute("style",'height:'+d);}r.addClass('sapUshellTilesContainer-sortable');r.addClass('sapUshellInner');r.writeClasses();r.writeAccessibilityState(c,{role:"listbox"});r.write(">");jQuery.each(t,function(){if(this.getVisible()){v=true;}if(this.getVisible){r.renderControl(this);}});if(c.getShowPlaceholder()){r.renderControl(c.oPlusTile);}if(c.getShowNoData()){this.renderNoData(r,c,!t.length||!v);}r.write("</ul>");if(l.length>0){if(c.getShowBackground()&&!(c.getIsGroupLocked()&&t.length===0)){r.write("<div");r.addClass('sapUshellTilesContainerSeparator');r.writeClasses();r.write(">");r.write("</div>");}var e=window.location.search.indexOf("new_links_container=true")!==-1;r.write("<div");var g=e?"sapUshellLineModeContainer":"sapUshellLinksContainer";r.addClass(g);r.writeClasses();r.write(">");if(e){r.write("<div class='sapUshellLinksInnerContainer'>");}l.map(function(i,j,l){if(e){var k=new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"tabindex",value:"-1",writeToDom:true});i.getCustomData().map(function(m){if(m.getKey()=='tabindex'&&m.getValue("0")){k=m;}i.removeCustomData(m);});i.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-posinset",value:(j+1).toString(),writeToDom:true}));i.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-setsize",value:l.length.toString(),writeToDom:true}));i.addCustomData(k);}r.renderControl(i);});if(e){r.write("</div>");}r.write("</div>");}if(f.length>0){r.write("<footer");r.addClass('sapUshellTilesContainerFtr');r.writeClasses();r.write(">");jQuery.each(f,function(){r.renderControl(this);});r.write("</footer>");}r.write("</div>");if(a.length){r.write("<div");r.addClass("sapUshellTileContainerAfterContent");r.addClass("sapContrastPlus ");r.writeClasses();r.write(">");jQuery.each(a,function(){r.renderControl(this);});r.write("</div>");}r.write("</div>");};sap.ushell.ui.launchpad.TileContainerRenderer.renderNoData=function(r,c,d){r.write("<div id='"+c.getId()+"-listNoData' class='sapUshellNoFilteredItems sapUiStrongBackgroundTextColor'>");if(d){if(c.getNoDataText()){r.writeEscaped(c.getNoDataText());}else{r.writeEscaped(c.getNoDataText(sap.ushell.resources.i18n.getText("noFilteredItems")));}}else{r.writeEscaped("");}r.write("</div>");};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.TileContainerUtils')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.launchpad.TileContainerUtils");sap.ushell.ui.launchpad.TileContainerUtils={};sap.ushell.ui.launchpad.TileContainerUtils.showHideTilesAndHeaders=function(i,o){var s,r,e,n=0,a=0;for(s in i.onScreenPathIndexMap){if(i.onScreenPathIndexMap.hasOwnProperty(s)){e=i.onScreenPathIndexMap[s];r=o[e.aItemsRefrenceIndex];if(r.getVisible()&&!e.isVisible){a++;}r.setVisible(e.isVisible);if(e.isVisible){n++;}}}return{nCountVisibElelemnts:n,nCountFilteredElement:a};};sap.ushell.ui.launchpad.TileContainerUtils.applyFilterOnItem=function(e,f){var a;for(a in f){if(f.hasOwnProperty(a)){f[a](e);}}};sap.ushell.ui.launchpad.TileContainerUtils.createNewItem=function(e,n){var b=this.mBindingInfos[n],f=b.factory,a=jQuery.proxy(function(c){var i=this.getId()+"-"+jQuery.sap.uid(),C=f(i,c);C.setBindingContext(c,b.model);return C;},this);return a(e);};sap.ushell.ui.launchpad.TileContainerUtils.addNewItem=function(c,n){var a=this.getMetadata().getJSONKeys()[n];this[a._sMutator](c);return true};sap.ushell.ui.launchpad.TileContainerUtils.createMissingElementsInOnScreenElements=function(i,e,a,f,I,b,n){var p,N=0,j,c=e.length;for(j=a;j<c;j++){N++;p=e[j].getPath();if(!i.onScreenPathIndexMap[p]){if(f(e[j],n)==false){return false;}sap.ushell.ui.launchpad.TileContainerUtils.applyFilterOnItem(e[j],b);}else{throw true;}}return true;};sap.ushell.ui.launchpad.TileContainerUtils.applyFilterOnAllItems=function(b,f){var B;var o=b.binding,a;if(!o){return;}a=o.getContexts();for(B=0;B<a.length;B++){sap.ushell.ui.launchpad.TileContainerUtils.applyFilterOnItem(a[B],f);}};sap.ushell.ui.launchpad.TileContainerUtils.validateOrder=function(b,i,a){var l,f,p,L,F,n,s,c;if(b[a]&&i.length>0){l=i[i.length-1].getBindingContext().getPath();f=b[a].getPath();L=l.split("/");F=f.split("/");for(n=0;n<L.length&&n<F.length;n++){s=L[n];c=F[n];if(!!parseInt(s,10)&&!!parseInt(c,10)){if(parseInt(s,10)>parseInt(c,10)){return false;}else if(parseInt(s,10)<parseInt(c,10)){return true;}}else{for(p=0;p<c.length&&p<s.length;p++){if(s[p].charCodeAt()>c[p].charCodeAt()){return false;}else if(s[p].charCodeAt()<c[p].charCodeAt()){return true;}}}}}return true;};sap.ushell.ui.launchpad.TileContainerUtils.markVisibleOnScreenElements=function(e,i,u){var a=0,p,b=e.length;for(a=0;a<b;a++){p=e[a].getPath();if(i.onScreenPathIndexMap[p]){if(u){i.onScreenPathIndexMap[p].isVisible=true;}}else{return a;}}return a;};sap.ushell.ui.launchpad.TileContainerUtils.indexOnScreenElements=function(o,i){var p,a,b={onScreenPathIndexMap:{}},c=o.length,d,v=true;if(i===false){v=false;}for(a=0;a<c;a++){d=o[a];if(d.getBindingContext()){p=d.getBindingContext().getPath();if(!b.onScreenPathIndexMap[p]){b.onScreenPathIndexMap[p]={aItemsRefrenceIndex:a,isVisible:v};}}}return b;};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.TileRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.launchpad.TileRenderer");sap.ushell.ui.launchpad.TileRenderer={};sap.ushell.ui.launchpad.TileRenderer.render=function(r,c){var t=null,m=c.getModel(),C,p=c.getPinButton();p=p.length?p[0]:undefined;try{t=c.getTileViews()[0];}catch(e){jQuery.sap.log.warning("Failed to load tile view: ",e.message);t=new sap.m.Text({text:"Failed to load. "});}var T=c.getParent(),o=T.getTiles?T.getTiles():[],v=o.filter(function(a){return a.getVisible();}),i=v.indexOf(c)>-1?v.indexOf(c)+1:"";r.write("<li");if(m&&m.getProperty("/enableHelp")){r.writeAttribute("data-tileCatalogId",c.getTileCatalogId());}r.writeControlData(c);r.addClass("sapUshellTile");if(t&&t.getContent&&sap.suite&&sap.suite.ui&&sap.suite.ui.commons&&sap.suite.ui.commons.FeedTile){C=t.getContent();C.forEach(function(I){if(I instanceof sap.suite.ui.commons.FeedTile){r.addClass("sapUshellFeedTileBG");}});}if(c.getLong()){r.addClass("sapUshellLong");}if(!c.getVisible()){r.addClass("sapUshellHidden");}if(c.getIsLocked()){r.addClass("sapUshellLockedTile");}r.writeClasses();r.writeAccessibilityState(c,{role:"option",posinset:i,setsize:v.length});r.writeAttribute("aria-describedby",c.getParent().getId()+"-titleText");if(c.getIeHtml5DnD()){r.writeAttribute("draggable","true");}r.writeAttributeEscaped("tabindex","-1");var l=c.data('layoutPosition');if(l){var s='-webkit-transform:'+l.translate3D+';-ms-transform:'+l.translate2D+';transform:'+l.translate3D;r.writeAttribute("style",s);}r.write(">");this.renderTileActionMode(r,c);r.addClass("sapUshellTileInner");if(c.getProperty('tileActionModeActive')){r.addClass("sapUshellTileActionBG");}if(this.renderTileView){this.renderTileView(r,t,p,c.getTarget());}if(c.getShowActionsIcon()){r.renderControl(c.actionIcon);}r.write("</li>");};sap.ushell.ui.launchpad.TileRenderer.renderTileView=function(r,t,p,T){if((T||"")!==""){r.write("<a");r.writeClasses();r.writeAttributeEscaped("href","#"+T);r.write(">");r.renderControl(t);r.write("</a>");}else{r.write("<div");r.writeClasses();r.write(">");r.renderControl(t);r.write("</div>");if(p){r.write("<div");r.addClass("sapUshellTilePinButtonOverlay");r.writeClasses();r.write(">");r.renderControl(p);r.write("</div>");}}};sap.ushell.ui.launchpad.TileRenderer.renderTileActionMode=function(r,c){if(!c.getTileActionModeActive()){return;}r.write("<div");r.addClass("sapUshellTileActionLayerDiv");r.writeClasses();r.write(">");if(!c.getShowActionsIcon()){if(!c.getIsLocked()&&c.getTileActionModeActive()){r.write("<div");r.addClass("sapUshellTileDeleteClickArea");r.writeClasses();r.write(">");r.write("<div");r.addClass("sapUshellTileDeleteIconOuterClass");r.writeClasses();r.write(">");r.renderControl(c._initDeleteAction());r.write("</div>");r.write("</div>");}}r.write("<div class='sapUshellTileActionDivCenter'></div>");r.write("<div");r.addClass("sapUshellTileActionIconDivBottom");r.writeClasses();r.write(">");r.write("<div");r.addClass("sapUshellTileActionIconDivBottomInnerDiv");r.writeClasses();r.write(">");r.renderControl(c.getActionSheetIcon());r.write("</div>");r.write("</div>");r.write("</div>");};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.TileState')){jQuery.sap.declare("sap.ushell.ui.launchpad.TileState");jQuery.sap.require('sap.ui.core.Control');sap.ui.core.Control.extend("sap.ushell.ui.launchpad.TileState",{metadata:{library:"sap.ushell",properties:{"state":{type:"string",group:"Misc",defaultValue:'Loaded'}}}});jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.ui.core.IconPool');sap.ushell.ui.launchpad.TileState.prototype.init=function(){"use strict";this._rb=sap.ushell.resources.i18n;this._sFailedToLoad=this._rb.getText("cannotLoadTile");this._oWarningIcon=new sap.ui.core.Icon(this.getId()+"-warn-icon",{src:"sap-icon://notification",size:"1.37rem"});this._oWarningIcon.addStyleClass("sapSuiteGTFtrFldIcnMrk");};sap.ushell.ui.launchpad.TileState.prototype.exit=function(){"use strict";this._oWarningIcon.destroy();};sap.ushell.ui.launchpad.TileState.prototype.setState=function(s,i){"use strict";this.setProperty("state",s,i);return this;};};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.TileStateRenderer')){jQuery.sap.declare("sap.ushell.ui.launchpad.TileStateRenderer");sap.ushell.ui.launchpad.TileStateRenderer={};sap.ushell.ui.launchpad.TileStateRenderer.render=function(r,c){"use strict";r.write("<div");r.writeControlData(c);r.addClass("sapUshellGT");r.writeClasses();r.write(">");var s=c.getState();r.write("<div");r.addClass("sapUshellOverlay");r.writeClasses();r.writeAttribute("id",c.getId()+"-overlay");if(s==="Failed"){r.writeAttribute("title",c._sFailedToLoad);}r.write(">");switch(s){case"Loading":var b=new sap.ui.core.HTML({content:"<div class='sapUshellTileStateLoading'><div>"});b.setBusyIndicatorDelay(0);b.setBusy(true);r.renderControl(b);break;case"Failed":r.write("<div");r.writeAttribute("id",c.getId()+"-failed-ftr");r.addClass("sapUshellTileStateFtrFld");r.writeClasses();r.write(">");r.write("<div");r.writeAttribute("id",c.getId()+"-failed-icon");r.addClass("sapUshellTileStateFtrFldIcn");r.writeClasses();r.write(">");r.renderControl(c._oWarningIcon);r.write("</div>");r.write("<div");r.writeAttribute("id",c.getId()+"-failed-text");r.addClass("sapUshellTileStateFtrFldTxt");r.writeClasses();r.write(">");r.writeEscaped(c._sFailedToLoad);r.write("</div>");r.write("</div>");break;default:}r.write("</div>");r.write("</div>");};};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.UserStatusItem')){
/*!
 * ${copyright}
 */
jQuery.sap.declare('sap.ushell.ui.launchpad.UserStatusItem');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ushell/ui/launchpad/UserStatusItem",['jquery.sap.global','sap/ushell/library'],function(q,M){"use strict";var t=sap.ushell.resources.i18n,U;U=sap.m.ListItemBase.extend("sap.ushell.ui.launchpad.UserStatusItem",{metadata:{properties:{status:{type:"object",group:"Appearance"},visible:{type:"boolean",group:"Appearance",defaultValue:true},isOpener:{type:"boolean",group:"Appearance",defaultValue:true},ariaLabel:{type:"string",group:"Appearance",defaultValue:null}},aggregations:{contentList:{type:"sap.ui.core.Control",multiple:false}},events:{press:{}}},renderer:{renderLIContent:function(r,c){var a=c.getStatus()||U.prototype.STATUS_ENUM.AVAILABLE;r.write("<div");if(!c.getVisible()){r.addClass("sapUshellShellHidden");}if(!c.getIsOpener()){c.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"tabindex",value:"0",writeToDom:true}));}r.addClass("sapUserStatusContent");r.writeClasses();r.write(">");r.write("<div ");r.addClass(a.styleClass);r.writeClasses();r.write(">");r.write("</div>");r.write("<div");if(a.status==="signOut"){r.addClass("sapUserStatusSignOutText");}r.addClass("sapUserStatusText");r.writeClasses();r.write(">");r.writeEscaped(a.text);r.write("</div>");if(c.getIsOpener()){r.write("<div class='sapUshellUserStatusExp sapUshellUserStatusDropDownArrow'></div>");}r.write("</div>");}}});U.prototype.onclick=function(e){this.firePress();e.preventDefault();};U.prototype.onsapspace=U.prototype.onclick;U.prototype.STATUS_ENUM={AVAILABLE:{text:t.getText("userStatus_available"),id:0,styleClass:"sapUshellUserStatusAvailableIndicator",status:"Available"},AWAY:{text:t.getText("userStatus_away"),id:1,styleClass:"sapUshellUserStatusAwayIndicator",status:"Away"},BUSY:{text:t.getText("userStatus_busy"),id:2,styleClass:"sapUshellUserStatusBusyIndicator",status:"Busy"},APPEAR_OFFLINE:{text:t.getText("userStatus_appearOffline"),id:3,styleClass:"sapUshellUserStatusAppearOfflineIndicator",status:"AppearOffline"},SIGNOUT:{text:t.getText("userStatus_signOut"),id:4,styleClass:"sapUshellUserSignOutExp sapUserStatusText",status:"signOut"}};U.prototype.setVisible=function(v){this.setProperty('visible',v,true);if(v){this.$().removeClass('sapUshellShellHidden');}else{this.$().addClass('sapUshellShellHidden');}return this;};U.prototype.setImage=function(i){};U.prototype.setAriaLabel=function(a){this.setProperty('ariaLabel',a);return this;};return U;},true);};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.ViewPortContainer')){
/*!
 * Copyright (c) 2009-2014 SAP SE, All Rights Reserved
 */
jQuery.sap.declare("sap.ushell.ui.launchpad.ViewPortContainer");jQuery.sap.require('sap.ui.core.Control');sap.ui.core.Control.extend("sap.ushell.ui.launchpad.ViewPortContainer",{metadata:{library:"sap.ushell",properties:{"height":{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:'100%'},"width":{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:'100%'},"visible":{type:"boolean",group:"Appearance",defaultValue:true},"defaultState":{type:"sap.ushell.ui.launchpad.ViewPortState",group:"Appearance",defaultValue:sap.ushell.ui.launchpad.ViewPortState.Center}},aggregations:{"leftViewPort":{type:"sap.ui.core.Control",multiple:true,singularName:"leftViewPort"},"centerViewPort":{type:"sap.ui.core.Control",multiple:true,singularName:"centerViewPort"},"rightViewPort":{type:"sap.ui.core.Control",multiple:true,singularName:"rightViewPort"}},associations:{"initialCenterViewPort":{type:"sap.ui.core.Control",multiple:false},"initialRightViewPort":{type:"sap.ui.core.Control",multiple:false},"initialLeftViewPort":{type:"sap.ui.core.Control",multiple:false}},events:{"navigate":{},"afterSwitchState":{parameters:{"from":{type:"sap.ui.core.Control"},"to":{type:"sap.ui.core.Control"}}},"afterSwitchStateAnimationFinished":{parameters:{"from":{type:"sap.ui.core.Control"},"to":{type:"sap.ui.core.Control"}}},"afterNavigate":{parameters:{"from":{type:"sap.ui.core.Control"},"to":{type:"sap.ui.core.Control"}}}}}});sap.ushell.ui.launchpad.ViewPortContainer.M_EVENTS={'navigate':'navigate','afterSwitchState':'afterSwitchState','afterSwitchStateAnimationFinished':'afterSwitchStateAnimationFinished','afterNavigate':'afterNavigate'};(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.launchpad.ViewPortContainer");jQuery.sap.require('sap.ui.core.theming.Parameters');sap.ushell.ui.launchpad.ViewPortContainer.prototype.init=function(){this.bShiftCenterTransition=true;this.bShiftCenterTransitionEnabled=false;var c=sap.ui.getCore().getConfiguration();this.bIsRTL=!jQuery.isEmptyObject(c)&&c.getRTL?c.getRTL():false;this._oViewPortsNavigationHistory={leftViewPort:{visitedControls:[],indexOfCurrentlyDisplayedControl:null},centerViewPort:{visitedControls:[],indexOfCurrentlyDisplayedControl:null},rightViewPort:{visitedControls:[],indexOfCurrentlyDisplayedControl:null}};this._states={Left:{translateX:'',visibleViewPortsData:[{viewPortId:'leftViewPort',className:"leftClass",isActive:true}]},Center:{translateX:'',visibleViewPortsData:[{viewPortId:'centerViewPort',className:"centerClass",isActive:true}]},Right:{translateX:'',visibleViewPortsData:[{viewPortId:'rightViewPort',className:"rightClass",isActive:true}]},LeftCenter:{translateX:'',visibleViewPortsData:[{viewPortId:'leftViewPort',className:"front",isActive:true},{viewPortId:'centerViewPort',className:"backLeft",isActive:false}]},CenterLeft:{translateX:'',visibleViewPortsData:[{viewPortId:'centerViewPort',className:"frontLeft",isActive:true},{viewPortId:'leftViewPort',className:"back",isActive:false}]},RightCenter:{translateX:'',visibleViewPortsData:[{viewPortId:'rightViewPort',className:"front",isActive:true},{viewPortId:'centerViewPort',className:"backRight",isActive:false}]},CenterRight:{translateX:'',visibleViewPortsData:[{viewPortId:'centerViewPort',className:"frontRight",isActive:true},{viewPortId:'rightViewPort',className:"back",isActive:false}]}};sap.ui.Device.media.attachHandler(this._handleSizeChange.bind(this),null,sap.ui.Device.media.RANGESETS.SAP_STANDARD);sap.ui.Device.orientation.attachHandler(this._handleSizeChange,this);jQuery(window).bind("resize",function(){this._handleSizeChange();}.bind(this));};sap.ushell.ui.launchpad.ViewPortContainer.prototype.removeCenterViewPort=function(c,s){this.removeAggregation('centerViewPort',c,s);this._popFromViewPortNavigationHistory('centerViewPort',c);};sap.ushell.ui.launchpad.ViewPortContainer.prototype._popFromViewPortNavigationHistory=function(v,c){var n=this._oViewPortsNavigationHistory[v],V=n?n.visitedControls:[],i=V.indexOf(c);if(V.length>0){n.visitedControls=V.slice(i+1,n.visitedControls.length);n.indexOfCurrentlyDisplayedControl=n.visitedControls.length-1;}};sap.ushell.ui.launchpad.ViewPortContainer.prototype.addCenterViewPort=function(c){jQuery.sap.measure.start("FLP:ViewPortContainer.addCenterViewPort","addCenterViewPort","FLP");var i=this._isInCenterViewPort(c);c.toggleStyleClass("hidden",true);c.addStyleClass("sapUshellViewPortItemSlideFrom");if(!i){this.addAggregation('centerViewPort',c,true);}if(this.domRef&&!i){this.getRenderer().renderViewPortPart(c,this.domRef,'centerViewPort');}jQuery.sap.measure.end("FLP:ViewPortContainer.addCenterViewPort");};sap.ushell.ui.launchpad.ViewPortContainer.prototype.addLeftViewPort=function(c){c.toggleStyleClass("hidden",true);if(this.domRef){this.getRenderer().renderViewPortPart(c,this.domRef,'leftViewPort');}this.addAggregation('leftViewPort',c,true);};sap.ushell.ui.launchpad.ViewPortContainer.prototype.addRightViewPort=function(c){c.toggleStyleClass("hidden",true);if(this.domRef){this.getRenderer().renderViewPortPart(c,this.domRef,'rightViewPort');}this.addAggregation('rightViewPort',c,true);};sap.ushell.ui.launchpad.ViewPortContainer.prototype.setInitialCenterViewPort=function(c){var C=this._getCurrentlyDispalyedControl('centerViewPort'),i=this._isInCenterViewPort(c);c.addStyleClass("sapUshellViewPortItemSlideFrom");if(this.domRef&&!i){this.getRenderer().renderViewPortPart(c,this.domRef,'centerViewPort');}this._setCurrentlyDisplayedControl('centerViewPort',c);if(!i){this.addAggregation('centerViewPort',c,true);}this.setAssociation('initialCenterViewPort',c,true);if(C&&C!==c.getId()){this.fireAfterNavigate({fromId:C,from:sap.ui.getCore().byId(C),to:sap.ui.getCore().byId(c),toId:c.getId()});}};sap.ushell.ui.launchpad.ViewPortContainer.prototype.setInitialLeftViewPort=function(c){var C=this._getCurrentlyDispalyedControl('leftViewPort');this.addAggregation('leftViewPort',c,true);this._setCurrentlyDisplayedControl('leftViewPort',c);if(this.domRef){this.getRenderer().renderViewPortPart(c,this.domRef,'leftViewPort');}this.setAssociation('initialLeftViewPort',c,true);if(C&&C!==c.getId()){this.fireAfterNavigate({fromId:C,from:sap.ui.getCore().byId(C),to:sap.ui.getCore().byId(c),toId:c.getId()});}};sap.ushell.ui.launchpad.ViewPortContainer.prototype.setInitialRightViewPort=function(c){var C=this._getCurrentlyDispalyedControl('rightViewPort');this.addAggregation('rightViewPort',c,true);this._setCurrentlyDisplayedControl('rightViewPort',c);if(this.domRef){this.getRenderer().renderViewPortPart(c,this.domRef,'rightViewPort');}this.setAssociation('initialRightViewPort',c,true);if(C&&C!==c.getId()){this.fireAfterNavigate({fromId:C,from:sap.ui.getCore().byId(C),to:sap.ui.getCore().byId(c),toId:c.getId()});}};sap.ushell.ui.launchpad.ViewPortContainer.prototype._isInViewPort=function(v,c){var V=this.getAggregation(v),i=V?V.indexOf(c)>-1:false;return i;};sap.ushell.ui.launchpad.ViewPortContainer.prototype._isInCenterViewPort=function(c){return this._isInViewPort('centerViewPort',c);};sap.ushell.ui.launchpad.ViewPortContainer.prototype._isInLeftViewPort=function(c){return this._isInViewPort('leftViewPort',c);};sap.ushell.ui.launchpad.ViewPortContainer.prototype._isInRightViewPort=function(c){return this._isInViewPort('rightViewPort',c);};sap.ushell.ui.launchpad.ViewPortContainer.prototype.getCurrentCenterPage=function(){return this._getCurrentlyDispalyedControl('centerViewPort');};sap.ushell.ui.launchpad.ViewPortContainer.prototype.getCurrentRightPage=function(){return this._getCurrentlyDispalyedControl('rightViewPort');};sap.ushell.ui.launchpad.ViewPortContainer.prototype.getCurrentLeftPage=function(){return this._getCurrentlyDispalyedControl('leftViewPort');};sap.ushell.ui.launchpad.ViewPortContainer.prototype.navTo=function(v,c,t,d,T){jQuery.sap.measure.start("FLP:ShellController.navTo","navTo","FLP");var C=this._getCurrentlyDispalyedControl(v),V=this.getAggregation(v),b=V.some(function(a,i){if(a.getId()===c){return true;}});if(!b){jQuery.sap.log.error("ViewPort Container Error: Couldn't find target control");}else if(!C||C!==c){var o=sap.ui.getCore().byId(c);o.toggleStyleClass("hidden",false);var O=function(){this.fireAfterNavigate({toId:c,to:c?sap.ui.getCore().byId(c):null,fromId:C,from:C?sap.ui.getCore().byId(C):null});}.bind(this);this._setCurrentlyDisplayedControl(v,o,t,O);}jQuery.sap.measure.end("FLP:ShellController.navTo");};sap.ushell.ui.launchpad.ViewPortContainer.prototype._getCurrentlyDispalyedControl=function(v){var n=this._oViewPortsNavigationHistory[v];return n.visitedControls[n.indexOfCurrentlyDisplayedControl];};sap.ushell.ui.launchpad.ViewPortContainer.prototype._setCurrentlyDisplayedControl=function(v,c,t,o){jQuery.sap.measure.start("FLP:ViewPortContainer._setCurrentlyDisplayedControl","_setCurrentlyDisplayedControl","FLP");var n=this._oViewPortsNavigationHistory[v],V=n.visitedControls,C=this._getCurrentlyDispalyedControl(v),a=C?sap.ui.getCore().byId(C):null,T=(v==='centerViewPort'&&t)?t:'show';V.push(c.getId());n.indexOfCurrentlyDisplayedControl=jQuery.isNumeric(n.indexOfCurrentlyDisplayedControl)?n.indexOfCurrentlyDisplayedControl+1:0;this._handleViewPortTransition(v,T,c,a,o);if(v==="rightViewPort"&&T==="show"){this._setStateVisibility("rightViewPort","start");}this._updateTranslateXvalues();jQuery.sap.measure.end("FLP:ViewPortContainer._setCurrentlyDisplayedControl");};sap.ushell.ui.launchpad.ViewPortContainer.prototype._handleSizeChange=function(){this._updateTranslateXvalues();var t=this._getTranslateXValue(this.sCurrentState),c=this._getTranslateXValue("Center"),f=c.replace("-","");if(this.getDomRef()){jQuery(this.getDomRef()).css(this.bIsRTL?'right':'left',t);}var p=this.bIsRTL?'right':'left';if(jQuery(window).width()<600){jQuery(".sapUshellViewPortWrapper").css(p,f);}else{jQuery(".sapUshellViewPortWrapper").css(p,'');}this.fixViewportScrollbars();};sap.ushell.ui.launchpad.ViewPortContainer.prototype._applyTransitionToViewPort=function(j,t,T){var d=jQuery.Deferred();if(!j||t===undefined||T===undefined){d.resolve();return;}var o={'transform':"translateX("+T+") translateY(0) translateZ(0)",'transition':t?"transform "+t+"s":"initial"};if(t!==0){j.on('transitionend',function(e){if(e.target!==j.get(0)){return;}j.off('transitionend');d.resolve();});}else{d.resolve();}o.offsetHeight;j.css(o);if(sap.ui.Device.browser.internet_explorer){setTimeout(function(){j.trigger('transitionend');},300);}return d.promise();};sap.ushell.ui.launchpad.ViewPortContainer.prototype._updateTranslateXvalues=function(){var t=sap.ui.core.theming.Parameters,l,r;if(window.matchMedia('(min-width: 1920px)').matches){l=t.get('sapUshellLeftViewPortWidthLarge');r=t.get('sapUshellRightViewPortWidthXXXLarge');}else if(window.matchMedia('(min-width: 1600px)').matches){l=t.get('sapUshellLeftViewPortWidthMedium');r=t.get('sapUshellRightViewPortWidthXXLarge');}else if(window.matchMedia('(min-width: 1440px)').matches){l=t.get('sapUshellLeftViewPortWidthMedium');r=t.get('sapUshellRightViewPortWidthXLarge');}else if(window.matchMedia('(min-width: 1280px)').matches){l=t.get('sapUshellLeftViewPortWidthMedium');r=t.get('sapUshellRightViewPortWidthLarge');}else if(window.matchMedia('(min-width: 1024px)').matches){l=t.get('sapUshellLeftViewPortWidthSmall');r=t.get('sapUshellRightViewPortWidthMedium');}else if(window.matchMedia('(min-width: 601px)').matches){l=t.get('sapUshellLeftViewPortWidthSmall');r=t.get('sapUshellRightViewPortWidthSmall');}else if(window.matchMedia('(max-width : 600px)').matches){l=jQuery(window).width()/parseFloat(jQuery("body").css("font-size"));r=jQuery(window).width()/parseFloat(jQuery("body").css("font-size"));}this._updateStatesWithTranslateXvalues(l,r);};sap.ushell.ui.launchpad.ViewPortContainer.prototype._updateStatesWithTranslateXvalues=function(l,r){var t=0,L;if(l!==null&&r!==null){this._states.Center.translateX='-'+parseFloat(l)+'rem';this._states.LeftCenter.translateX="0";t=-1*(parseFloat(l)+parseFloat(r));this._states.RightCenter.translateX=t.toString()+'rem';L=this._calculateRightViewPortLeftPosotion();jQuery(".sapUshellViewPortRight").css("left",L);}};sap.ushell.ui.launchpad.ViewPortContainer.prototype._calculateRightViewPortLeftPosotion=function(){var l=0,w,L,b=jQuery(".sapUshellViewPortLeft").hasClass("sapUshellShellHidden");w=jQuery(window).width();jQuery(".sapUshellViewPortLeft").removeClass("sapUshellShellHidden");L=jQuery(".sapUshellViewPortLeft").width();if(b){jQuery(".sapUshellViewPortLeft").addClass("sapUshellShellHidden");}l=w+L;return l;};sap.ushell.ui.launchpad.ViewPortContainer.prototype._handleViewPortTransition=function(v,t,T,c,o){var a=this;if(v!=='centerViewPort'){return;}if(!c){t='show';}switch(t){case'show':T.toggleStyleClass("hidden",false);if(c){c.toggleStyleClass("hidden");}if(o){o();}break;case'slide':T.toggleStyleClass("hidden",false);var j=jQuery(T);a._applyTransitionToViewPort(j,0.4,"-100%").then(function(){return a._applyTransitionToViewPort(j,0,0);}).then(function(){c.toggleStyleClass("hidden",true);if(o){o();}});break;case'slideBack':var b=jQuery('#'+this.getCurrentCenterPage());a._applyTransitionToViewPort(b,0.7,"100%").then(function(){T.toggleStyleClass("hidden",false);}).then(function(){if(c){return a._applyTransitionToViewPort(b,0,0);}}).then(function(){c.toggleStyleClass("hidden",true);}).done(function(){c.toggleStyleClass("hidden",true);if(o){o();}});break;case'fade':var j=jQuery(T);if(c){var d=jQuery(c.getDomRef());d.fadeToggle(250);}j.fadeIn(500,o?o:null);break;}};sap.ushell.ui.launchpad.ViewPortContainer.prototype.onAfterRendering=function(){this.domRef=this.getDomRef();if(this.sCurrentState.indexOf("Center")==0){var r=this._states["Right"].visibleViewPortsData[0].viewPortId;jQuery(document.getElementById(r)).css("display","none");}this._handleSizeChange;};sap.ushell.ui.launchpad.ViewPortContainer.prototype.onBeforeRendering=function(){this._updateTranslateXvalues();};sap.ushell.ui.launchpad.ViewPortContainer.prototype.setDefaultState=function(s){this.setCurrentState(s);this.setProperty("defaultState",s,true);};sap.ushell.ui.launchpad.ViewPortContainer.prototype.endOfAnimationEventHandler=function(){var t=this._states[this.sTargetState].translateX,j=jQuery(this.domRef);this._setStateVisibility(this.sTargetState,"end");return this._applyTransitionToViewPort(j,0,0).then(function(){j.css(this.bIsRTL?'right':'left',t);}.bind(this));};sap.ushell.ui.launchpad.ViewPortContainer.prototype.switchState=function(s){var a,t=[],f=[],b;this.sTargetState=s;if(s!==this.sCurrentState){this._setStateVisibility(s,"start");var T=this._getTranslateXValue(s),v=this._states[this.sCurrentState].visibleViewPortsData,V=this._states[s].visibleViewPortsData,j=jQuery(this.domRef),c=this;if(s.indexOf("Right")==0){var r=V[0].viewPortId;jQuery(document.getElementById(r)).css("display","block");}v.forEach(function(e){j.find('#'+e.viewPortId).removeClass(e.className);});if(this.bIsRTL){T=(-1*parseInt(T,10)).toString()+"rem";}this._handleCenterViewPortAnimation(s);this._applyTransitionToViewPort(j,0.47,T).then(function(){return c.endOfAnimationEventHandler();}).then(function(){for(b=0;b<c._states[c.sCurrentState].visibleViewPortsData.length;b++){f.push(c._states[c.sCurrentState].visibleViewPortsData[b].viewPortId);}for(b=0;b<c._states[s].visibleViewPortsData.length;b++){t.push(c._states[s].visibleViewPortsData[b].viewPortId);}}).then(function(){var e=0,k;if(c.sCurrentState.indexOf("Center")==0){var r=c._states["Right"].visibleViewPortsData[0].viewPortId;jQuery(document.getElementById(r)).css("display","none");}for(k=0;k<f.length;k++){a=c.getAggregation(f[k]);for(e=0;e<a.length;e++){if(a[e].onViewStateHide){a[e].onViewStateHide();}}}c.fixViewportScrollbars();for(k=0;k<t.length;k++){a=c.getAggregation(t[k]);for(e=0;e<a.length;e++){if(a[e].onViewStateShow){a[e].onViewStateShow();}}}V.forEach(function(l){j.find('#'+l.viewPortId).addClass(l.className);});c.fireAfterSwitchStateAnimationFinished({to:s,from:c.sCurrentState});});jQuery('#'+v[0].viewPortId).removeClass("active");var S=function(){this.switchState('Center');}.bind(this);var d=function(e){var k=parseInt(window.getComputedStyle(e.currentTarget).width,10);if(e.offsetX>k){this.switchState('Center');}}.bind(this);var g=jQuery(this.domRef).find('.sapUshellViewPortWrapper');var h=jQuery(this.domRef).find('.sapUshellViewPortLeft');var i=jQuery(this.domRef).find('.sapUshellViewPortCursorPointerArea');if(s!=='Center'){if(s==='LeftCenter'){i.on('click',S);}else if(s==='RightCenter'){g.on('click',S);g.addClass('sapUshellViewPortWrapperClickable');}h.on('click',d);}else{if(this.sCurrentState==='LeftCenter'){i.off('click',d);}else if(this.sCurrentState==='RightCenter'){g.off('click',S);g.removeClass('sapUshellViewPortWrapperClickable');}h.off('click',d);}this.setCurrentState(s);}};sap.ushell.ui.launchpad.ViewPortContainer.prototype._setStateVisibility=function(s,t){var e=["leftViewPort","rightViewPort"],v;v=s!=="Center";if((t==="start"&&v)||(t==="end"&&!v)){for(var i=0;i<e.length;i++){jQuery("#"+e[i]).toggleClass("sapUshellShellHidden",!v);}}};sap.ushell.ui.launchpad.ViewPortContainer.prototype.fixViewportScrollbars=function(){var a=this.getCurrentState(),v=this._states[a].visibleViewPortsData;jQuery('#'+v[0].viewPortId).css("height","100%");if(v[0].viewPortId==="leftViewPort"){if(this.bIsRTL){var p=window.innerWidth-jQuery("#leftViewPort").width();jQuery("#leftViewPort").css("padding-left",p);jQuery("#viewPortCursorPointerArea").css("width",p);jQuery("#viewPortCursorPointerArea").css("left","0");}else{var b=window.innerWidth-jQuery("#leftViewPort").width();jQuery("#leftViewPort").css("padding-right",b);jQuery("#viewPortCursorPointerArea").css("width",b);jQuery("#viewPortCursorPointerArea").css("right","0");}}jQuery('#'+v[0].viewPortId).addClass("active");};sap.ushell.ui.launchpad.ViewPortContainer.prototype.setCurrentState=function(s){var f=this.sCurrentState;this.sCurrentState=s;this.fireAfterSwitchState({to:s,from:f});};sap.ushell.ui.launchpad.ViewPortContainer.prototype.getCurrentState=function(){return this.sCurrentState;};sap.ushell.ui.launchpad.ViewPortContainer.prototype.getViewPortControl=function(v,d){var V=this.getAggregation(v),i;if(V){for(i=0;i<V.length;i++){if(V[i]&&(V[i].getId()===d)){return V[i];}}}return null;};sap.ushell.ui.launchpad.ViewPortContainer.prototype.getViewPort=function(p){var P=this.getCenterViewPort(),i;for(i=0;i<P.length;i++){if(P[i]&&(P[i].getId()===p)){return P[i];}}return null;};sap.ushell.ui.launchpad.ViewPortContainer.prototype._handleCenterViewPortAnimation=function(n){var m=this.getModel();if(m){var a=m.getProperty('/animationMode');var a=a||'full';if(a!=='full'){return;}}var c=this._getCenterViewPortJQueryObject(),s=this._shiftCenterTransition();if(this.sCurrentState==="Center"){if(n==="RightCenter"){if(s===true){c.addClass('sapUshellScaledShiftedCenterWhenInRightViewPort');}else{c.addClass('sapUshellScaledCenterWhenInRightViewPort');}}else if(n==="LeftCenter"){c.addClass('sapUshellScaledCenterWhenInLeftViewPort');}}else if(n==="Center"){if(this.sCurrentState==="RightCenter"){c.removeClass('sapUshellScaledCenterWhenInRightViewPort');c.removeClass('sapUshellScaledShiftedCenterWhenInRightViewPort');}else if(this.sCurrentState==="LeftCenter"){c.removeClass('sapUshellScaledCenterWhenInLeftViewPort');}}else if((this.sCurrentState==="LeftCenter")&&(n==="RightCenter")){if(s===true){c.addClass('sapUshellScaledShiftedCenterWhenInRightViewPort');}else{c.addClass('sapUshellScaledCenterWhenInRightViewPort');}c.removeClass('sapUshellScaledCenterWhenInLeftViewPort');}else if((this.sCurrentState==="RightCenter")&&(n==="LeftCenter")){c.addClass('sapUshellScaledCenterWhenInLeftViewPort');c.removeClass('sapUshellScaledCenterWhenInRightViewPort');c.removeClass('sapUshellScaledShiftedCenterWhenInRightViewPort');}};sap.ushell.ui.launchpad.ViewPortContainer.prototype.shiftCenterTransitionEnabled=function(e){this.bShiftCenterTransitionEnabled=e;};sap.ushell.ui.launchpad.ViewPortContainer.prototype.shiftCenterTransition=function(s){this.bShiftCenterTransition=s;};sap.ushell.ui.launchpad.ViewPortContainer.prototype._shiftCenterTransition=function(){return sap.ushell.Container.getService("Notifications").isEnabled()&&this.bShiftCenterTransitionEnabled&&this.bShiftCenterTransition;};sap.ushell.ui.launchpad.ViewPortContainer.prototype._getCenterViewPortJQueryObject=function(){var j=jQuery(this.domRef),c=this._states.Center.visibleViewPortsData[0].viewPortId,a=j.find('#'+c);return a;};sap.ushell.ui.launchpad.ViewPortContainer.prototype._getTranslateXValue=function(t,g){var T=this._states[t].translateX,c,i,C;if(g!==undefined){c=this._states[g].translateX;}else{c=this._states[this.sCurrentState].translateX;}C=parseInt(c,10);i=parseInt(T,10);if(!g&&(t===this.sCurrentState)){return T;}return(i-C).toString()+"rem";};sap.ushell.ui.launchpad.ViewPortContainer.transitions=sap.ushell.ui.launchpad.ViewPortContainer.transitions||{};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.ViewPortContainerRenderer')){
/*!
 * ${copyright}
 */
jQuery.sap.declare('sap.ushell.ui.launchpad.ViewPortContainerRenderer');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ushell/ui/launchpad/ViewPortContainerRenderer",['jquery.sap.global'],function(q){"use strict";q.sap.declare("sap.ushell.ui.launchpad.ViewPortContainerRenderer");var V={};V.renderViewPortPart=function(c,a,v){q.sap.measure.start("FLP:ViewPortContainerRenderer.renderViewPortPart","renderViewPortPart","FLP");var j=q(a).find("#"+v);var r=sap.ui.getCore().createRenderManager();r.render(c,j[0]);r.destroy();q.sap.measure.end("FLP:ViewPortContainerRenderer.renderViewPortPart");};V._renderViewPort=function(r,v,i,a){r.write("<div");a.forEach(function(c){r.addClass(c);});r.writeClasses();r.writeAttribute("id",i);r.write(">");v.forEach(function(o){r.renderControl(o);});if(i==='leftViewPort'){this._renderViewPortCursorPointerArea(r);}r.write("</div>");};V._renderCenterViewPort=function(r,v,i,a){r.write("<div");r.addClass('sapUshellViewPortWrapper');r.writeClasses();r.writeAttribute("id",i+'-wrapper');r.write(">");V._renderViewPort(r,v,i,a);r.write("</div>");};V._renderViewPortCursorPointerArea=function(r){r.write("<div id='viewPortCursorPointerArea'");r.addClass('sapUshellViewPortCursorPointerArea');r.writeClasses();r.write(">");r.write("</div>");};V.render=function(r,c){if(!c.getVisible()){return;}r.write("<div");r.writeControlData(c);if(c.getWidth()){r.addStyle("width",c.getWidth());}c.getHeight();if(c.getHeight()){r.addStyle("height",c.getHeight());}if(this.renderAttributes){this.renderAttributes(r,c);}var s=c._states,S=s[c.sCurrentState],v=S.visibleViewPortsData,t=c._getTranslateXValue(c.sCurrentState),l=["sapUshellViewPortLeft"],C=["sapUshellViewPortCenter"],R=["sapUshellViewPortRight"];if(c.getCurrentState()==="Center"){l.push("sapUshellShellHidden");R.push("sapUshellShellHidden");}var o=sap.ui.getCore().getConfiguration();this.bIsRTL=!q.isEmptyObject(o)&&o.getRTL?o.getRTL():false;r.addStyle(this.bIsRTL?'right':'left',t);r.writeStyles();r.write(">");v.forEach(function(e){switch(e.viewPortId){case'leftViewPort':l.push(e.className);break;case'centerViewPort':C.push(e.className);break;case'rightViewPort':R.push(e.className);break;}});V._renderViewPort(r,c.getLeftViewPort(),'leftViewPort',l);V._renderCenterViewPort(r,c.getCenterViewPort(),'centerViewPort',C);V._renderViewPort(r,c.getRightViewPort(),'rightViewPort',R);r.write("</div>");};return V;},true);};if(!jQuery.sap.isDeclared('sap.ushell.ui.shell.FloatingContainer')){jQuery.sap.declare('sap.ushell.ui.shell.FloatingContainer');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.Device');sap.ui.define("sap/ushell/ui/shell/FloatingContainer",['jquery.sap.global','sap/ushell/library','sap/ui/Device'],function(q,l,D){"use strict";var F=sap.ui.core.Control.extend("sap.ushell.ui.shell.FloatingContainer",{metadata:{properties:{},aggregations:{content:{type:"sap.ui.core.Control",multiple:true}}},renderer:{render:function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapUshellFloatingContainer");r.writeClasses();r.write(">");if(c.getContent()&&c.getContent().length){r.renderControl(c.getContent()[0]);}r.write("</div>");}}});F.prototype.init=function(){sap.ui.Device.resize.attachHandler(F.prototype._handleResize,this);};F.prototype._getWindowHeight=function(){return q(window).height();};F.prototype._setContainerHeight=function(c,f){c.css("max-height",f);};F.prototype._handleResize=function(e){if(q(".sapUshellFloatingContainer").parent()[0]){this.oWrapper=q(".sapUshellFloatingContainer").parent()[0];this.oWrapper.setAttribute("style",this.oStorage.get("floatingContainerStyle"));var i=window.matchMedia?window.matchMedia("(max-width: 417px)").matches:false;this.adjustPosition(e,i);}};F.prototype.adjustPosition=function(e,i){var w=e?e.width:q(window).width(),W=e?e.height:q(window).height(),c=this.oContainer.width(),C=this.oContainer.height(),b,a,L,t,d=sap.ui.getCore().getConfiguration().getRTL();i=i!==undefined?i:false;if(this.oWrapper){L=this.oWrapper.style.left.replace("%","");L=w*L/100;t=this.oWrapper.style.top.replace("%","");t=W*t/100;if(!isNaN(L)&&!isNaN(t)&&!i){if(d){b=(L<c)||(L>w);if(b){L=L<c?c:w;}}else{b=(L<0)||(w<(L+c));if(b){L=L<0?0:(w-c);}}a=(t<0)||(W<(t+C));if(a){t=t<0?0:(W-C);}if(!b&&!a){this.oWrapper.setAttribute("style","left:"+L*100/w+"%;top:"+t*100/W+"%;position:absolute;");return;}this.oWrapper.setAttribute("style","left:"+L*100/w+"%;top:"+t*100/W+"%;position:absolute;");}}};F.prototype.handleDrop=function(){if(this.oWrapper){this.adjustPosition();this.oStorage.put("floatingContainerStyle",this.oWrapper.getAttribute("style"));}};F.prototype.setContent=function(c){if(this.getDomRef()){var r=sap.ui.getCore().createRenderManager();r.renderControl(c);r.flush(this.getDomRef());r.destroy();}this.setAggregation("content",c,true);};F.prototype.onAfterRendering=function(){this.oStorage=this.oStorage||q.sap.storage(q.sap.storage.Type.local,"com.sap.ushell.adapters.local.FloatingContainer");this.oContainer=q(".sapUshellFloatingContainer");this.oWrapper=q(".sapUshellFloatingContainer").parent()[0];};F.prototype.exit=function(){sap.ui.Device.resize.detachHandler(F.prototype._resizeHandler,this);};return F;},true);};if(!jQuery.sap.isDeclared('sap.ushell.ui.shell.NavigationMiniTile')){jQuery.sap.declare('sap.ushell.ui.shell.NavigationMiniTile');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.layout.Grid');sap.ui.define("sap/ushell/ui/shell/NavigationMiniTile",['jquery.sap.global','sap/ushell/library','sap/ui/layout/Grid'],function(q){"use strict";var N=sap.ui.core.Control.extend("sap.ushell.ui.shell.NavigationMiniTile",{metadata:{properties:{title:{type:"string",group:"Misc",defaultValue:null},subtitle:{type:"string",group:"Misc",defaultValue:null},icon:{type:"sap.ui.core.URI",group:"Appearance",defaultValue:null},intent:{type:"string",group:"Misc",defaultValue:null}},aggregations:{},events:{press:{}}},renderer:{render:function(r,c){var t=c.getTitle();var s=c.getSubtitle();var i=c.getIcon();var I=sap.ui.core.IconPool.createControlByURI(i);r.write('<div tabindex="-1" class="sapUshellNavMiniTile" ');r.writeControlData(c);r.writeAttributeEscaped("role","option");r.writeAttributeEscaped("aria-label",s?t+" "+s:t);r.write('>');r.write('<div>');r.write('<span class="sapUshellNavMiniTileTitle" >');if(t){r.writeEscaped(t);}r.write('</span>');r.write('</div>');if(I){r.write('<div>');r.write('<span class="sapUshellNavMiniTileIcon">');r.renderControl(I);r.write("</span>");r.write('</div>');}else{r.write('<div>');r.write('<span class="sapUshellNavMiniTileSubtitle" >');if(s){r.writeEscaped(s);}r.write("</span>");r.write('</div>');}r.write('</div>');}}});N.prototype.ontap=function(e){this.firePress({});};N.prototype.onsapenter=function(e){this.firePress({});};N.prototype.onsapspace=function(e){this.firePress({});};return N;},true);};if(!jQuery.sap.isDeclared('sap.ushell.ui.shell.RightFloatingContainer')){jQuery.sap.declare('sap.ushell.ui.shell.RightFloatingContainer');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.core.theming.Parameters');sap.ui.define("sap/ushell/ui/shell/RightFloatingContainer",['jquery.sap.global','sap/ushell/library','sap/ui/Device','sap/ui/core/theming/Parameters'],function(q,l,D,t,R){"use strict";var a=sap.ui.core.Control.extend("sap.ushell.ui.shell.RightFloatingContainer",{metadata:{properties:{size:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:'56px'},top:{type:"string",group:"Appearance",defaultValue:'0'},right:{type:"string",group:"Appearance",defaultValue:'0'},textVisible:{type:"boolean",group:"Appearance",defaultValue:true},insertItemsWithAnimation:{type:"boolean",group:"Appearance",defaultValue:true},hideItemsAfterPresentation:{type:"boolean",group:"Appearance",defaultValue:false},enableBounceAnimations:{type:"boolean",group:"Appearance",defaultValue:false}},aggregations:{floatingContainerItems:{type:"sap.ui.core.Control",multiple:true}},events:{afterRendering:{}}},renderer:{render:function(r,o){var i=sap.ui.getCore().getConfiguration().getRTL();r.write("<div");r.writeControlData(o);r.addClass("sapUshellRightFloatingContainer");r.writeClasses();r.addStyle('top',o.getTop()+'rem');r.addStyle(i?'left':'right',o.getRight());r.writeStyles();r.writeAttribute("role","alert");r.write(">");r.write("<ul");r.addClass("sapUshellNotificationListContainer");r.writeClasses();r.writeAttribute("role","listbox");r.write(">");this.renderFloatingContainerItems(r,o);r.write("</ul>");r.write("</div>");},renderFloatingContainerItems:function(r,o){var I=o.getFloatingContainerItems(),i;for(i=0;i<I.length;i++){r.renderControl(I[i]);}}}});a.prototype.init=function(){var b;q(window).bind("resize",function(){clearTimeout(b);b=setTimeout(this._handleResize.bind(this),100);}.bind(this));this.iRequiredItemsNumber=5;};a.prototype.onBeforeRendering=function(){};a.prototype._setSize=function(){};a.prototype._handleResize=function(){if(this.getDomRef()&&this.getFloatingContainerItems().length){var n=this.iRequiredItemsNumber,b=window.innerHeight,d=this.getDomRef(),c=d.getBoundingClientRect().top,e=q(".sapUiSizeCompact").length>0?56:64,j=q(d).find('li').first(),f,I;if(!j.length){return;}f=j[0].clientHeight;var g=q("#sapUshellDashboardFooter").outerHeight();this.iRequiredItemsNumber=Math.min(parseInt((b-c-e-g)/f,10),5);if(n!==this.iRequiredItemsNumber){I=this.getFloatingContainerItems();for(var i=0;i<I.length;i++){if(i<this.iRequiredItemsNumber||isNaN(this.iRequiredItemsNumber)){I[i].removeStyleClass('sapUshellShellHidden');}else{I[i].addStyleClass('sapUshellShellHidden');}}}}};a.prototype.onAfterRendering=function(){this.fireAfterRendering();setTimeout(function(){this._handleResize();}.bind(this),500);this.addStyleClass('sapContrastPlus');this.addStyleClass('sapContrast');this.addStyleClass('sapUshellNotificationsListItem');};a.prototype.setVisible=function(v){this.setProperty('visible',v,true);if(v){q(this.getDomRef()).css('visibility','visible');}else{q(this.getDomRef()).css('visibility','hidden');}};a.prototype.setFloatingContainerItemsVisiblity=function(v){var b=this.getFloatingContainerItems(),c=v?300:0;for(var i=0;i<b.length;i++){(function(d){return function(){setTimeout(function(){if(v){b[d].removeStyleClass("sapUshellRightFloatingContainerItemBounceOut").addStyleClass("sapUshellRightFloatingContainerItemBounceIn");}else{b[d].removeStyleClass("sapUshellRightFloatingContainerItemBounceIn").addStyleClass("sapUshellRightFloatingContainerItemBounceOut");}},c+d*100);};})(i)();}};a.prototype._animationBouncer=function _animationBouncer(n){var _=function(){if(!_animationBouncer._animationQueue.length){_animationBouncer._itemTimeoutId=undefined;return;}var i=_animationBouncer._animationQueue.shift();i.addStyleClass("sapUshellRightFloatingContainerItmHeightVisible").addStyleClass('sapUshellRightFloatingContainerItemBounceIn');_animationBouncer._itemTimeoutId=setTimeout(_,100);}.bind(this);if(!_animationBouncer._animationQueue){_animationBouncer._animationQueue=[];}_animationBouncer._animationQueue.push(n);if(_animationBouncer._mainTimeoutId||_animationBouncer._itemTimeoutId){return;}_animationBouncer._mainTimeoutId=setTimeout(function(){_animationBouncer._mainTimeoutId=undefined;_();}.bind(this),500);};a.prototype.addFloatingContainerItem=function(n){this.addAggregation('floatingContainerItems',n);n.addStyleClass('sapContrastPlus');if(this.getInsertItemsWithAnimation()){n.addStyleClass("sapUshellNotificationsListItem");n.addStyleClass("sapUshellRightFloatingContainerItemHidden");if(this.getEnableBounceAnimations()){a.prototype._animationBouncer(n);}else{setTimeout(function(){var i=this.getFloatingContainerItems();if(i.length>5){var b=i[i.length-1];b.addStyleClass("sapUshellRightFloatingContainerHideLastItem");}n.addStyleClass('sapUshellRightFloatingContainerItemBackToViewport').addStyleClass("sapUshellRightFloatingContainerItmHeightVisible");}.bind(this),500);}}if(this.getHideItemsAfterPresentation()){setTimeout(function(){n.removeStyleClass("sapUshellRightFloatingContainerItemBackToViewport");},3200);}};return a;},true);};if(!jQuery.sap.isDeclared('sap.ushell.ui.shell.ShellFloatingAction')){jQuery.sap.declare('sap.ushell.ui.shell.ShellFloatingAction');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.Button');sap.ui.define("sap/ushell/ui/shell/ShellFloatingAction",['jquery.sap.global','sap/m/Button','sap/ushell/library'],function(q,B){"use strict";var S=B.extend("sap.ushell.ui.shell.ShellFloatingAction");S.prototype.init=function(){this.addStyleClass("sapUshellShellFloatingAction");if(B.prototype.init){B.prototype.init.apply(this,arguments);}};S.prototype.exit=function(){B.prototype.exit.apply(this,arguments);};S.prototype.onAfterRendering=function(){if(this.data("transformY")){this.removeStyleClass('sapUshellShellFloatingActionTransition');q(this.getDomRef()).css('transform',"translateY("+this.data("transformY")+")");}else{this.addStyleClass('sapUshellShellFloatingActionTransition');}};});};if(!jQuery.sap.isDeclared('sap.ushell.ui.shell.ShellFloatingActionRenderer')){
// Copyright (c) 2009-2014 SAP SE, All Rights Reserved
jQuery.sap.declare('sap.ushell.ui.shell.ShellFloatingActionRenderer');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Renderer');jQuery.sap.require('sap.m.ButtonRenderer');sap.ui.define("sap/ushell/ui/shell/ShellFloatingActionRenderer",['jquery.sap.global','sap/ui/core/Renderer','sap/m/ButtonRenderer'],function(q,R,B){"use strict";var S=R.extend(B);return S;},true);};if(!jQuery.sap.isDeclared('sap.ushell.ui.shell.ShellFloatingActions')){
/*!
 * ${copyright}
 */
jQuery.sap.declare('sap.ushell.ui.shell.ShellFloatingActions');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ushell/ui/shell/ShellFloatingActions",['jquery.sap.global','./ShellFloatingAction','sap/ushell/library'],function(q,S){"use strict";var a=sap.ui.core.Control.extend("sap.ushell.ui.shell.ShellFloatingActions",{metadata:{properties:{isFooterVisible:{type:"boolean",defaultValue:false}},aggregations:{floatingActions:{type:"sap.ushell.ui.shell.ShellFloatingAction",multiple:true,singularName:"floatingAction"}}},renderer:{render:function(r,A){var f=A.getFloatingActions();r.write("<div");r.writeControlData(A);r.addClass("sapUshellShellFloatingActions");r.writeClasses();r.write(">");if(f.length){var F;if(f.length===1){F=f[0];}else{F=A._createMultipleFloatingActionsButton(f);q.each(f,function(){this.setVisible(false);r.renderControl(this);});}r.renderControl(F);}r.write("</div>");}}});a.prototype._createMultipleFloatingActionsButton=function(f){var F;var t=this;return new S({id:this.getId()+"-multipleFloatingActions",icon:'sap-icon://add',visible:true,press:function(){if(!this.hasStyleClass('sapUshellShellFloatingActionRotate')){this.addStyleClass('sapUshellShellFloatingActionRotate');if(!F){F=parseInt(this.$().outerHeight(),10)+parseInt(t.$().css('bottom'),10);}f.forEach(function(o){o.setVisible(true);});setTimeout(function(){f.forEach(function(o,i){var b=F*(i+1);o.$().css('transform',"translateY(-"+b+"px)");o.data("transformY","-"+b+"px");});},0);}else{this.removeStyleClass('sapUshellShellFloatingActionRotate');f.forEach(function(o){o.$().css('transform',"translateY(0)");});setTimeout(function(){f.forEach(function(o){o.setVisible(false);o.data("transformY",undefined);});},150);}},tooltip:sap.ushell.resources.i18n.getText("XXX")});};a.prototype.addFloatingAction=function(A){this.addAggregation('floatingActions',A,true);if(this.getDomRef()){var r=sap.ui.getCore().createRenderManager();r.renderControl(A);r.flush(this.getDomRef());r.destroy();}return this;};a.prototype.removeFloatingAction=function(A){if(typeof A==='number'){A=this.getAggregation('floatingActions')[A];}this.removeAggregation('floatingActions',A,true);var i=A.getId();q('#'+i).remove();return this;};return a;},true);};if(!jQuery.sap.isDeclared('sap.ushell.ui.shell.ShellHeadItem')){jQuery.sap.declare('sap.ushell.ui.shell.ShellHeadItem');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.core.IconPool');sap.ui.define("sap/ushell/ui/shell/ShellHeadItem",['jquery.sap.global','sap/ui/core/Control','sap/ui/core/IconPool','sap/ushell/library'],function(q,C,I){"use strict";var S=C.extend("sap.ushell.ui.shell.ShellHeadItem",{metadata:{properties:{startsSection:{type:"boolean",group:"Appearance",defaultValue:false,deprecated:true},showSeparator:{type:"boolean",group:"Appearance",defaultValue:true},enabled:{type:"boolean",group:"Appearance",defaultValue:true},selected:{type:"boolean",group:"Appearance",defaultValue:false},showMarker:{type:"boolean",group:"Appearance",defaultValue:false,deprecated:true},icon:{type:"sap.ui.core.URI",group:"Appearance",defaultValue:null},target:{type:"sap.ui.core.URI",group:"Appearance",defaultValue:null},ariaLabel:{type:"string",group:"Appearance",defaultValue:null},text:{type:"string",group:"Appearance",defaultValue:null},visible:{type:"boolean",group:"Appearance",defaultValue:true},floatingNumber:{type:"int",group:"Appearance",defaultValue:null},floatingNumberMaxValue:{type:"int",group:"Appearance",defaultValue:999}},events:{press:{}}},renderer:{render:function(r,i){if((i.getTarget()||"")!==""){r.write("<a tabindex='0' href='");r.writeEscaped(i.getTarget());r.write("'");}else{r.write("<a tabindex='0'");}r.writeAccessibilityState(i,{role:'button'});r.writeControlData(i);r.addClass("sapUshellShellHeadItm");var R=i._shouldRenderText();if(R){r.addClass("sapUshellShellHeadItmText");}if(i._headerHideSeperators){r.addClass("sapUshellHeaderHideSeparators");}if(!i.getEnabled()){r.addClass("sapUshellShellHeadItmDisabled");}if(i.getFloatingNumber&&i.getFloatingNumber()>0&&i.getVisible()){var f=i.getDisplayFloatingNumber();r.addClass("sapUshellShellHeadItmCounter");r.writeAttribute("counter-content",f);}if(i.getStartsSection()){r.addClass("sapUshellShellHeadItmDelim");}if(i.getShowSeparator()){r.addClass("sapUshellShellHeadItmSep");}if(!i.getVisible()){r.addClass("sapUshellShellHidden");}if(i.getAriaLabel()){r.writeAccessibilityState({label:i.getAriaLabel(),role:"button"});}if(i.getSelected()){r.addClass("sapUshellShellHeadItmSel");}if(i.getShowMarker()){r.addClass("sapUshellShellHeadItmMark");}r.writeClasses();var t=i.getTooltip_AsString();if(t){r.writeAttributeEscaped("title",t);}r.write("><span></span><div class='sapUshellShellHeadItmMarker'><div></div></div>");if(R){r.write("<b class='sapUshellShellHeadItmCenterText'>");r.writeEscaped(i.getText());r.write("</b>");}r.write("</a>");}}});S.prototype._shouldRenderText=function(){if(this.getText()&&this.getParent()){return!(this.getParent()instanceof sap.ushell.ui.shell.ShellHeader);}return false;};S.prototype.onAfterRendering=function(){this._refreshIcon();};S.prototype.onclick=function(e){if(this.getEnabled()){this.firePress();if(!this.getTarget()){e.preventDefault();}}};S.prototype.onsapspace=function(){var d=this.getDomRef();if(d){d.click();}};S.prototype.onsapenter=function(){this.onsapspace();};S.prototype.setStartsSection=function(s){s=!!s;this.setProperty("startsSection",s,true);this.$().toggleClass("sapUshellShellHeadItmDelim",s);return this;};S.prototype.setShowSeparator=function(s){s=!!s;this.setProperty("showSeparator",s,true);this.$().toggleClass("sapUshellShellHeadItmSep",s);return this;};S.prototype.setSelected=function(s){s=!!s;this.setProperty("selected",s,true);this.$().toggleClass("sapUshellShellHeadItmSel",s);return this;};S.prototype.setEnabled=function(e){e=!!e;this.setProperty("enabled",e,true);this.$().toggleClass("sapUshellShellHeadItmDisabled",!e);return this;};S.prototype.setAriaLabel=function(a){this.setProperty('ariaLabel',a);return this;};S.prototype.setVisible=function(v){if(sap.ui.Device.system.phone){this.setProperty("visible",!!v,false);}else{this.setProperty("visible",!!v,true);}if(v){this.$().removeClass('sapUshellShellHidden');}else{this.$().addClass('sapUshellShellHidden');}return this;};S.prototype.setShowMarker=function(m){m=!!m;this.setProperty("showMarker",m,true);this.$().toggleClass("sapUshellShellHeadItmMark",m);return this;};S.prototype.setIcon=function(i){this.setProperty("icon",i,true);if(this.getDomRef()){this._refreshIcon();}return this;};S.prototype._refreshIcon=function(){var i=q(this.$().children()[0]);var s=this.getIcon();if(I.isIconURI(s)){var o=I.getIconInfo(s);i.html("").css("style","");if(o){i.text(o.content).css("font-family","'"+o.fontFamily+"'");}}else{var $=this.$("img-inner");if($.length===0||$.attr("src")!==s){q(this.$().children()[0]).addClass('userImgSpan');q(this.$().children().first().before("<div class='userImg'></div>"));i.css("style","").html("<img id='"+this.getId()+"-img-inner' src='"+q.sap.encodeHTML(s)+"'></img>");}}};S.prototype.getDisplayFloatingNumber=function(){var n=this.getFloatingNumber(),m=this.getFloatingNumberMaxValue();var d=n+"";if(n>m){d=m+"+";}return d;};q.sap.declare('sap.ui.unified.ShellHeadItem');sap.ui.unified.ShellHeadItem=S;return S;},true);};if(!jQuery.sap.isDeclared('sap.ushell.ui.shell.ShellHeadUserItem')){jQuery.sap.declare('sap.ushell.ui.shell.ShellHeadUserItem');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Element');jQuery.sap.require('sap.ui.core.IconPool');sap.ui.define("sap/ushell/ui/shell/ShellHeadUserItem",['jquery.sap.global','sap/ui/core/Element','sap/ui/core/IconPool','sap/ushell/library'],function(q,E,I){"use strict";var S=E.extend("sap.ushell.ui.shell.ShellHeadUserItem",{metadata:{properties:{username:{type:"string",group:"Appearance",defaultValue:''},ariaLabel:{type:"string",group:"Appearance",defaultValue:null},image:{type:"sap.ui.core.URI",group:"Appearance",defaultValue:null}},events:{press:{}}}});I.getIconInfo("","");S.prototype.onclick=function(e){this.firePress();e.preventDefault();};S.prototype.onsapspace=S.prototype.onclick;S.prototype.setImage=function(i){this.setProperty("image",i,true);if(this.getDomRef()){this._refreshImage();}return this;};S.prototype.setAriaLabel=function(a){this.setProperty('ariaLabel',a);return this;};S.prototype._refreshImage=function(){var i=this.$("img");var s=this.getImage();if(!s){i.html("").css("style","").css("display","none");}else if(I.isIconURI(s)){var o=I.getIconInfo(s);i.html("").css("style","");if(o){i.text(o.content).css("font-family","'"+o.fontFamily+"'");}}else{var $=this.$("img-inner");if($.length===0||$.attr("src")!==s){i.css("style","").html("<img id='"+this.getId()+"-img-inner' src='"+q.sap.encodeHTML(s)+"'></img>");}}};S.prototype._checkAndAdaptWidth=function(s){if(!this.getDomRef()){return false;}var r=this.$(),n=this.$("name");var b=r.width();r.toggleClass("sapUshellShellHeadActionLimit",false);var m=240;if(s){m=Math.min(m,0.5*document.documentElement.clientWidth-225);}if(m<n.width()){r.toggleClass("sapUshellShellHeadActionLimit",true);}return b!==r.width();};return S;},true);};if(!jQuery.sap.isDeclared('sap.ushell.ui.shell.ShellLayoutRenderer')){jQuery.sap.declare('sap.ushell.ui.shell.ShellLayoutRenderer');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ushell/ui/shell/ShellLayoutRenderer",['jquery.sap.global'],function(q){"use strict";var S={};S.render=function(r,s){var i=s.getId(),c,a=(window.innerWidth>0)?window.innerWidth:screen.width,b=(window.innerHeight>0)?window.innerHeight:screen.height;r.write("<div");r.writeControlData(s);r.addClass("sapUshellShell");if(s.getShowAnimation()){r.addClass("sapUshellShellAnim");}if(!s.getHeaderVisible()){r.addClass("sapUshellShellNoHead");}r.addClass("sapUshellShellHead"+(s._showHeader?"Visible":"Hidden"));r.writeClasses();r.write(">");if(!s.getShowBrandLine()){r.write("<div id='",i,"-strgbg' class='sapUshellShellBG sapContrastPlus"+(s._useStrongBG?" sapUiStrongBackgroundColor":"")+"'></div>");r.write("<div class='sapUiShellBackgroundImage sapUiGlobalBackgroundImageForce sapUshellShellBG sapContrastPlus'></div>");}if(s.getEnableCanvasShapes()){r.write("<canvas id='",i,"-shapes' height='",b,"'width='",a,"' style='position: absolute;'>");r.write("</canvas>");}if(s.getShowBrandLine()){r.write("<hr id='",i,"-brand' class='sapUshellShellBrand'/>");}r.write("<header id='",i,"-hdr'  class='sapContrastPlus sapUshellShellHead'><div>");r.write("<div id='",i,"-hdrcntnt' class='sapUshellShellCntnt'>");if(s.getHeader()){r.renderControl(s.getHeader());}r.write("</div>","</div>","</header>");if(s.getToolArea()){r.write("<aside>");r.renderControl(s.getToolArea());r.write("</aside>");}if(s.getRightFloatingContainer()){r.write("<aside>");r.renderControl(s.getRightFloatingContainer());r.write("</aside>");}c="sapUshellShellCntnt sapUshellShellCanvas";if(s.getBackgroundColorForce()){c+=" sapUiShellBackground sapUiGlobalBackgroundColorForce";}r.write("<div id='",i,"-cntnt' class='"+c+"'>");if(s.getShowBrandLine()){r.write("<div id='",i,"-strgbg' class='sapUshellShellBG sapContrastPlus"+(s._useStrongBG?" sapUiStrongBackgroundColor":"")+"'></div>");r.write("<div class='sapUiShellBackgroundImage sapUiGlobalBackgroundImageForce sapUshellShellBG sapContrastPlus'></div>");}r.renderControl(s.getCanvasSplitContainer());r.write("</div>");r.write("<span id='",i,"-main-focusDummyOut' tabindex='-1'></span>");r.renderControl(s.getFloatingActionsContainer());r.write("</div>");};return S;},true);};if(!jQuery.sap.isDeclared('sap.ushell.ui.shell.ShellNavigationMenu')){jQuery.sap.declare('sap.ushell.ui.shell.ShellNavigationMenu');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.FlexBox');jQuery.sap.require('sap.m.List');sap.ui.define("sap/ushell/ui/shell/ShellNavigationMenu",['jquery.sap.global','sap/ushell/library','sap/m/FlexBox','sap/m/List','sap/ushell/ui/launchpad/AccessibilityCustomData'],function(q){"use strict";var S=sap.ui.core.Control.extend("sap.ushell.ui.shell.ShellNavigationMenu",{metadata:{properties:{title:{type:"string",group:"Misc",defaultValue:null},icon:{type:"sap.ui.core.URI",group:"Appearance",defaultValue:null},showTitle:{type:"boolean",defaultValue:false}},aggregations:{items:{type:"sap.m.ListItem",group:"Misc",defaultValue:null,singularName:"item"},miniTiles:{type:"sap.ushell.ui.shell.NavigationMiniTile",group:"Misc",defaultValue:null,singularName:"miniTile"}},events:{}},renderer:{render:function(r,c){r.write('<div ');r.writeControlData(c);r.write('>');if(c.getShowTitle()){var t=c.oTitle;t.setIcon(c.getIcon());t.setTitle(c.getTitle());r.write('<div id="sapUshellNavTitle" >');r.renderControl(t);r.write('</div>');}r.renderControl(c.oItemsList);var m=c.getMiniTiles();if(m&&m.length>0){r.renderControl(c.oRelatedAppsVbox);}r.write('</div>');}}});var K=function(m){this.init(m);};K.prototype.init=function(m){this.keyCodes=q.sap.KeyCodes;this.jqElement=m.$();this.jqElement.on('keydown.keyboardNavigation',this.keydownHandler.bind(this));};K.prototype.destroy=function(){if(this.jqElement){this.jqElement.off(".keyboardNavigation");}delete this.jqElement;};K.prototype.keydownHandler=function(e){switch(e.keyCode){case this.keyCodes.ARROW_UP:this.upDownHandler(e,true);break;case this.keyCodes.ARROW_DOWN:this.upDownHandler(e,false);break;case this.keyCodes.ARROW_LEFT:this.leftRightHandler(e,false);break;case this.keyCodes.ARROW_RIGHT:this.leftRightHandler(e,true);break;case this.keyCodes.HOME:this.homeEndHandler(e,true);break;case this.keyCodes.END:this.homeEndHandler(e,false);break;case this.keyCodes.PAGE_UP:this.homeEndHandler(e,true);break;case this.keyCodes.PAGE_DOWN:this.homeEndHandler(e,false);break;default:break;}};K.prototype.upDownHandler=function(e,i){var j=q(document.activeElement);if(!j.hasClass("sapUshellNavMiniTile")){return false;}var a=j.parent().parent();var c=j.parent().index();var b=a.children();var n;if(i){n=c-3;if(n<0){n+=9;}}else{n=(c+3)%b.length;}var d=b[n].children[0];this._setItemFocus(e,q(d));};K.prototype.leftRightHandler=function(e,i){var n=i?"next":"prev";var j=q(document.activeElement);if(!j.hasClass("sapUshellNavMiniTile")){return false;}var c=j.parent();var a=c[n]();var b=a.index();var d=c.parent();var f;if(b===-1){f=i?0:d.children().length-1;}else{f=b;}var g=d.children()[f].children[0];if(!g){return false;}this._setItemFocus(e,q(g));};K.prototype.homeEndHandler=function(e,i){var n=i?"first":"last";var j=q(document.activeElement);if(!j.hasClass("sapUshellNavMiniTile")){return false;}e.preventDefault();var a=this.jqElement.find(".sapUshellNavMiniTile")[n]();this._setItemFocus(e,a);};K.prototype._setItemFocus=function(e,j){e.preventDefault();e.stopImmediatePropagation();q(".sapUshellNavMiniTile").attr("tabindex",-1);j.attr("tabindex",0);j.focus();};K.prototype.setFocusToLastFocusedMiniTile=function(e){var j=q.find(".sapUshellNavMiniTile[tabindex='0']");if(j&&j[0]){this._setItemFocus(e,q(j));}else{this._setItemFocus(e,q(q(".sapUshellNavMiniTile")[0]));}};S.prototype.init=function(){this.oItemsList=new sap.m.List("sapUshellNavHierarchyItems");this.oMiniTilesBox=new sap.m.FlexBox("sapUshellNavRelatedAppsFlexBox");};S.prototype._beforeOpen=function(){if(!this.bInitialized){this.oTitle=new sap.m.StandardListItem("navMenuInnerTitle").addStyleClass("sapUshellNavigationMenuTitleItem");this.oRelatedAppsTitle=new sap.m.Label("sapUshellRelatedAppsLabel",{text:sap.ushell.resources.i18n.getText("shellNavMenu_relatedApps")});this.oRelatedAppsVbox=new sap.m.VBox("sapUshellRelatedAppsItems",{items:[this.oRelatedAppsTitle,this.oMiniTilesBox]});this._extendInnerControlsForAccKeyboard();this.bInitialized=true;}};S.prototype._afterOpen=function(){if(sap.ui.Device.system.desktop){if(this.keyboardNavigation){this.keyboardNavigation.destroy();}this.keyboardNavigation=new K(this.oMiniTilesBox);}};S.prototype._extendInnerControlsForAccKeyboard=function(){this.oTitle.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-level",value:"1",writeToDom:true}));if(sap.ui.Device.system.desktop){this.oTitle.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"tabindex",value:"0",writeToDom:true}));this.oItemsList.addEventDelegate({onsaptabprevious:function(e){if(this.getShowTitle()){e.preventDefault();e.stopImmediatePropagation();q('#navMenuInnerTitle').focus();}else{this.keyboardNavigation.setFocusToLastFocusedMiniTile(e);}}.bind(this),onsaptabnext:function(e){this.keyboardNavigation.setFocusToLastFocusedMiniTile(e);}.bind(this)});}};S.prototype.getMiniTiles=function(){return this.oMiniTilesBox.getItems();};S.prototype.insertMiniTile=function(m,i){this.oMiniTilesBox.insertItem(m,i);return this;};S.prototype.addMiniTile=function(m){if(this.oMiniTilesBox.getItems().length<9){this.oMiniTilesBox.addItem(m);}else{q.sap.log.warning("ShellNavigationMenu.addMiniTile - miniTiles aggregation is already at maximum size of 9 elements "+"- current item was not added.");}return this;};S.prototype.removeMiniTile=function(i){this.oMiniTilesBox.removeItem(i);return this;};S.prototype.removeAllMiniTiles=function(){this.oMiniTilesBox.removeAllItems();return this;};S.prototype.destroyMiniTiles=function(){this.oMiniTilesBox.destroyItems();return this;};S.prototype.indexOfMiniTile=function(m){return this.oMiniTilesBox.indexOfItem(m);};S.prototype.getItems=function(){return this.oItemsList.getItems();};S.prototype.insertItem=function(h,i){h=this._extendHierarchyItemForAcc(h);this.oItemsList.insertItem(h,i);return this;};S.prototype.addItem=function(h){h=this._extendHierarchyItemForAcc(h);this.oItemsList.addItem(h);return this;};S.prototype.removeItem=function(i){this.oItemsList.removeItem(i);return this;};S.prototype.removeAllItems=function(){this.oItemsList.removeAllItems();return this;};S.prototype.destroyItems=function(){this.oItemsList.destroyItems();return this;};S.prototype.indexOfItem=function(h){return this.oItemsList.indexOfItem(h);};S.prototype._extendHierarchyItemForAcc=function(i){i.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-readonly",value:"true",writeToDom:true}));i.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"readonly",value:"readonly",writeToDom:true}));i.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"role",value:"heading",writeToDom:true}));i.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-level",value:"2",writeToDom:true}));if(sap.ui.Device.system.desktop){i.addEventDelegate({onsapspace:function(e){this.firePress();}.bind(i)});}return i;};S.prototype.exit=function(){this.oItemsList.destroy();this.oMiniTilesBox.destroy();if(this.bInitialized){this.oTitle.destroy();this.oRelatedAppsVbox.destroy();this.oRelatedAppsTitle.destroy();}if(this.keyboardNavigation){this.keyboardNavigation.destroy();}};S.prototype.onAfterRendering=function(){if(this.getShowTitle()){q("#sapUshellAppTitlePopover-intHeader").css("height",0);}else{q("#sapUshellAppTitlePopover-intHeader").css("height","0.5rem");}if(this.getShowTitle()){var j=q("#navMenuInnerTitle");j.attr("role","heading");j.attr("aria-readonly","true");j.attr("readonly","readonly");}var a=q("#sapUshellNavHierarchyItems ul");a.attr("role","group");a.attr("aria-label",sap.ushell.resources.i18n.getText("ShellNavigationMenu_HierarchyItemsAriaLabel"));var b=q("#sapUshellNavRelatedAppsFlexBox");b.attr("role","listbox");b.attr("aria-labelledBy","sapUshellRelatedAppsLabel");var c=q(".sapUshellNavMiniTile");for(var i=0;i<c.length;i++){q(c[i]).attr("aria-setsize",c.length);q(c[i]).attr("aria-posinset",i+1);}};return S;},true);};if(!jQuery.sap.isDeclared('sap.ushell.ui.shell.ShellTitle')){jQuery.sap.declare('sap.ushell.ui.shell.ShellTitle');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.ui.core.IconPool');sap.ui.define("sap/ushell/ui/shell/ShellTitle",['jquery.sap.global','sap/m/Button','sap/ui/core/IconPool','sap/ushell/library'],function(q,B,I){"use strict";var S=B.extend("sap.ushell.ui.shell.ShellTitle",{metadata:{properties:{text:{type:"string",group:"Misc",defaultValue:null},icon:{type:"sap.ui.core.URI",group:"Appearance",defaultValue:null}},events:{press:{}}},renderer:{render:function(r,c){var i=c.getInnerControl();var t=c.getText();if(!t){return;}if(i){r.write("<a tabindex='0' href='javascript:void(0);'");r.addClass("sapUshellShellHeadAction sapUshellHideIconOnDesktop");r.writeClasses();if(c.getTooltip()){r.writeAttributeEscaped("title",c.getTooltip());}r.writeControlData(c);r.write("><span class='sapUshellShellHeadActionImg sapUshellShellTitleHeadActionImg'>");var o=I.createControlByURI(c.getIcon());r.renderControl(o);r.write("</span>");r.write("<span class='sapUshellShellHeadActionName sapUshellHeadTitle'");r.writeAttributeEscaped("title",c.getText());r.write(">");r.writeEscaped(c.getText());r.write("</span><span class='sapUshellShellHeadActionExp'></span></a>");}else{r.write('<span id="shell-header-hdr-shell-title" class="sapUshellHeadTitle">');r.writeEscaped(c.getText());r.write("</span>");}}}});S.prototype.init=function(){if(B.prototype.init){B.prototype.init.apply(this,arguments);}this.innerControl=null;this.oPopover=null;};S.prototype.getInnerControl=function(){return this.innerControl;};S.prototype.setInnerControl=function(i){this.innerControl=i;};S.prototype.onclick=function(e){if(!this.oPopover){this.oPopover=new sap.m.Popover("shellTitlePopover",{showHeader:false,content:this.getInnerControl(),placement:sap.m.PlacementType.VerticalPreferedBottom});}this.oPopover.openBy(this);this.firePress();};S.prototype.exit=function(){if(this.oPopover){this.innerControl.destroy();this.oPopover.destroy();}};S.prototype.onsapspace=S.prototype.onclick;return S;},true);};if(!jQuery.sap.isDeclared('sap.ushell.ui.shell.ShellUtilities')){jQuery.sap.declare('sap.ushell.ui.shell.ShellUtilities');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ushell/ui/shell/ShellUtilities",['jquery.sap.global','sap/ushell/library'],function(q){"use strict";sap.ui.base.Object.extend("sap.ushell.ui.shell.shell_ContentRenderer",{constructor:function(c,C,o,a){sap.ui.base.Object.apply(this);this._id=C;this._cntnt=o;this._ctrl=c;this._rm=sap.ui.getCore().createRenderManager();this._cb=a||function(){};},destroy:function(){this._rm.destroy();delete this._rm;delete this._id;delete this._cntnt;delete this._cb;delete this._ctrl;if(this._rerenderTimer){q.sap.clearDelayedCall(this._rerenderTimer);delete this._rerenderTimer;}sap.ui.base.Object.prototype.destroy.apply(this,arguments);},render:function(){if(!this._rm){return;}if(this._rerenderTimer){q.sap.clearDelayedCall(this._rerenderTimer);}this._rerenderTimer=q.sap.delayedCall(0,this,function(){var $=q.sap.byId(this._id);var d=$.length>0;if(d){if(typeof(this._cntnt)==="string"){var c=this._ctrl.getAggregation(this._cntnt,[]);for(var i=0;i<c.length;i++){this._rm.renderControl(c[i]);}}else{this._cntnt(this._rm);}this._rm.flush($[0]);}this._cb(d);});}});sap.ushell.ui.shell.shell_iNumberOfOpenedShellOverlays=0;},false);};if(!jQuery.sap.isDeclared('sap.ushell.ui.shell.SplitContainer')){jQuery.sap.declare('sap.ushell.ui.shell.SplitContainer');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.core.theming.Parameters');sap.ui.define("sap/ushell/ui/shell/SplitContainer",['jquery.sap.global','sap/ui/core/Control','sap/ui/core/theming/Parameters','sap/ushell/library','./ShellUtilities'],function(q,C,P){"use strict";var S=C.extend("sap.ushell.ui.shell.SplitContainer",{metadata:{library:"sap.ushell.ui.shell",properties:{showSecondaryContent:{type:"boolean",group:"Appearance",defaultValue:null},secondaryContentSize:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:'250px'},secondaryContentWidth:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:'250px',deprecated:true},orientation:{type:"sap.ui.core.Orientation",group:"Appearance",defaultValue:sap.ui.core.Orientation.Horizontal}},defaultAggregation:"content",aggregations:{content:{type:"sap.ui.core.Control",multiple:true,singularName:"content"},secondaryContent:{type:"sap.ui.core.Control",multiple:true,singularName:"secondaryContent"},subHeader:{type:"sap.ui.core.Control",multiple:true,singularName:"subHeader"}}}});(function(w){S.prototype.init=function(){this.bRtl=sap.ui.getCore().getConfiguration().getRTL();this._paneRenderer=new sap.ushell.ui.shell.shell_ContentRenderer(this,this.getId()+"-panecntnt","secondaryContent");this._subHeadersRenderer=new sap.ushell.ui.shell.shell_ContentRenderer(this,this.getId()+"-canvassubHeader","subHeader");this._canvasRenderer=new sap.ushell.ui.shell.shell_ContentRenderer(this,this.getId()+"-canvasrootContent","content");this._moveContent=true;};S.prototype.exit=function(){this._paneRenderer.destroy();delete this._paneRenderer;this._canvasRenderer.destroy();delete this._canvasRenderer;this._subHeadersRenderer.destroy();delete this._subHeadersRenderer;delete this._contentContainer;delete this._secondaryContentContainer;};S.prototype.onAfterRendering=function(){this._contentContainer=this.$("canvas");this._secondaryContentContainer=this.$("pane");this._toolArea=this.getParent()&&this.getParent().getToolArea&&this.getParent().getToolArea()?this.getParent().getToolArea():{};this._shellLayout=this.getParent();this._applySecondaryContentSize();};S.prototype._applySecondaryContentSize=function(){if(this.getDomRef()){var v=this.getOrientation()===sap.ui.core.Orientation.Vertical;var s,o;var d,O,D;var a=this.getSecondaryContentSize();var b=this.getShowSecondaryContent();if(v){s="height";o="width";d="top";O=this.bRtl?"right":"left";}else{s="width";o="height";d=this.bRtl?"right":"left";O="top";}if(this._closeContentDelayId){q.sap.clearDelayedCall(this._closeContentDelayId);}this._secondaryContentContainer.css(s,a);this._secondaryContentContainer.css(o,"");if(this.getParent().getToolAreaVisible&&!this.getParent().getToolAreaVisible()){D="0";}else{D=this._toolArea.getSize?this._toolArea.getSize():"0";}this._secondaryContentContainer.css(d,b?D:"-"+a);this._secondaryContentContainer.css(O,"");if(this._moveContent){a=this._adjustSecondaryContentSize();this._contentContainer.css(d,b?a:D);}else{this._contentContainer.css(d,D);}if(!b){var h=parseInt(P.get("sapUshellSplitContAnimationDuration"),10);this._closeContentDelayId=q.sap.delayedCall(h,this,function(){if(this._secondaryContentContainer){this._secondaryContentContainer.toggleClass("sapUshellSplitContSecondClosed",true);}});}else{this._secondaryContentContainer.toggleClass("sapUshellSplitContSecondClosed",false);}}};S.prototype._modifyAggregationOrProperty=function(m,d){var r=!!this.getDomRef();var a=m.apply(this,[r]);if(r&&d){d.render();}return a;};S.prototype._adjustSecondaryContentSize=function(){var c=this.getProperty("secondaryContentSize"),b=this._shellLayout.getToolAreaVisible&&this._shellLayout.getToolAreaVisible()?this._toolArea.getSize():"0rem";c=parseFloat(c,10)+parseFloat(b,10)+"rem";return c;};S.prototype.setShowSecondaryContent=function(s){var r=this.getDomRef();this.setProperty("showSecondaryContent",!!s,r);this._applySecondaryContentSize();return this;};S.prototype.setSecondaryContentSize=function(s){this.setProperty("secondaryContentSize",s,true);this._applySecondaryContentSize();return this;};S.prototype.getSecondaryContentWidth=function(){q.sap.log.warning("SplitContainer: Use of deprecated property \"SecondaryContentWidth\", please use "+"\"SecondaryContentSize\" instead.");return this.getSecondaryContentSize.apply(this,arguments);};S.prototype.setSecondaryContentWidth=function(){q.sap.log.warning("SplitContainer: Use of deprecated property \"SecondaryContentWidth\", please use "+"\"SecondaryContentSize\" instead.");return this.setSecondaryContentSize.apply(this,arguments);};S.prototype.insertContent=function(c,i){return this._modifyAggregationOrProperty(function(r){return this.insertAggregation("content",c,i,r);},this._canvasRenderer);};S.prototype.addContent=function(c){return this._modifyAggregationOrProperty(function(r){return this.addAggregation("content",c,r);},this._canvasRenderer);};S.prototype.removeContent=function(i){return this._modifyAggregationOrProperty(function(r){return this.removeAggregation("content",i,r);},this._canvasRenderer);};S.prototype.removeAllContent=function(){return this._modifyAggregationOrProperty(function(r){return this.removeAllAggregation("content",r);},this._canvasRenderer);};S.prototype.destroyContent=function(){return this._modifyAggregationOrProperty(function(r){return this.destroyAggregation("content",r);},this._canvasRenderer);};S.prototype.insertSecondaryContent=function(c,i){return this._modifyAggregationOrProperty(function(r){return this.insertAggregation("secondaryContent",c,i,r);},this._paneRenderer);};S.prototype.addSecondaryContent=function(c){return this._modifyAggregationOrProperty(function(r){return this.addAggregation("secondaryContent",c,r);},this._paneRenderer);};S.prototype.removeSecondaryContent=function(i){return this._modifyAggregationOrProperty(function(r){return this.removeAggregation("secondaryContent",i,r);},this._paneRenderer);};S.prototype.removeAllSecondaryContent=function(){return this._modifyAggregationOrProperty(function(r){return this.removeAllAggregation("secondaryContent",r);},this._paneRenderer);};S.prototype.destroySecondaryContent=function(){return this._modifyAggregationOrProperty(function(r){return this.destroyAggregation("secondaryContent",r);},this._paneRenderer);};S.prototype.setSubHeader=function(c){return this._modifyAggregationOrProperty(function(r){return this.setAggregation("subHeader",c,r);},this._subHeadersRenderer);};S.prototype.removeSubHeader=function(){return this._modifyAggregationOrProperty(function(r){return this.removeAllAggregation("subHeader",r);},this._subHeadersRenderer);};S.prototype.destroySubHeader=function(){return this._modifyAggregationOrProperty(function(r){return this.destroyAggregation("subHeader",r);},this._subHeadersRenderer);};})(window);return S;},true);};if(!jQuery.sap.isDeclared('sap.ushell.ui.shell.SplitContainerRenderer')){jQuery.sap.declare('sap.ushell.ui.shell.SplitContainerRenderer');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ushell/ui/shell/SplitContainerRenderer",['jquery.sap.global'],function(q){"use strict";var S={};S.render=function(r,c){var i=c.getId();var v=c.getOrientation()===sap.ui.core.Orientation.Vertical;r.write("<div");r.writeControlData(c);r.addClass("sapUshellSpltCont");r.addClass("sapUshellSpltCont"+(v?"V":"H"));if(sap.ui.getCore().getConfiguration().getAnimation()){r.addClass("sapUshellSpltContAnim");}if(!c.getShowSecondaryContent()){r.addClass("sapUshellSpltContPaneHidden");}r.writeClasses();r.write(">");var s=i+"-pane";var w=c.getShowSecondaryContent()?c.getSecondaryContentSize():"0";r.write("<aside id='",s,"' style='width:",w,"'");r.addClass("sapUshellSpltContPane");if(!c.getShowSecondaryContent()){r.addClass("sapUshellSplitContSecondClosed");}r.writeClasses();r.write(">");this.renderSecondaryContent(r,s,c.getSecondaryContent());r.write("</aside>");var C=i+"-canvas";r.write("<section id='",C,"' class='sapUshellSpltContCanvas'>");var o=c.getAggregation('subHeader');this.renderRootContent(r,C,c.getContent(),o);r.write("</section>");r.write("</div>");};S.renderRootContent=function(r,i,c,s){r.write("<div id='",i,"cntnt' class='sapUshellSpltContCntnt'");r.writeAttribute("data-sap-ui-root-content","true");r.write(">");if(s&&s.length){r.write("<div id='",i,"subHeader'>");r.renderControl(s[0]);r.write("</div>");}if(c&&c.length){r.write("<div id='",i,"rootContent' class='sapUshellSpltContainerContentWrapper'>");c.forEach(function(C,a){r.renderControl(C);});r.write("</div>");}r.write("</div>");};S.renderSecondaryContent=function(r,I,c){r.write("<div id='",I,"cntnt' class='sapUshellSpltContCntnt'");r.writeAttribute("data-sap-ui-root-content","true");r.write(">");for(var i=0;i<c.length;i++){r.renderControl(c[i]);}r.write("</div>");};return S;},true);};if(!jQuery.sap.isDeclared('sap.ushell.ui.shell.ToolAreaItem')){jQuery.sap.declare('sap.ushell.ui.shell.ToolAreaItem');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.core.IconPool');sap.ui.define("sap/ushell/ui/shell/ToolAreaItem",['jquery.sap.global','sap/ui/core/Control','sap/ui/core/IconPool','sap/ushell/library'],function(q,C,I){"use strict";var T=C.extend("sap.ushell.ui.shell.ToolAreaItem",{metadata:{properties:{icon:{type:"sap.ui.core.URI",group:"Appearance",defaultValue:null},selected:{type:"boolean",group:"Appearance",defaultValue:false},text:{type:"string",group:"Appearance",defaultValue:null},ariaLabel:{type:"string",group:"Appearance",defaultValue:null},visible:{type:"boolean",group:"Appearance",defaultValue:true},expandable:{type:"boolean",group:"Appearance",defaultValue:false}},events:{press:{},expand:{}}},renderer:{render:function(r,t){var i;r.write("<div");r.writeControlData(t);if(!t.getIcon()){r.addClass("sapUshellToolAreaItmTextOnly");}else{r.addClass("sapUshellToolAreaItm");}if(!t.getVisible()){r.addClass("sapUshellShellHidden");}if(t.getAriaLabel()){r.writeAccessibilityState({label:this.getAriaLabel(),role:"button"});}r.writeClasses();var a=t.getTooltip_AsString();if(a){r.writeAttributeEscaped("title",a);}r.write(">");if(t.getIcon()){i=I.createControlByURI(t.getIcon());i.setUseIconTooltip(false);i.addStyleClass("sapUshellToolAreaItemIcon");r.renderControl(i);}if(t.getText()){r.write("<span");r.addClass("sapUshellToolAreaItemText");r.writeClasses();r.write(">");r.writeEscaped(t.getText());r.write("</span>");}if(t.getExpandable()){this.renderExpandable(r);}r.write("</div>");},renderExpandable:function(r){var i=I.createControlByURI("sap-icon://icon-dropdown");i.addStyleClass("sapUshellToolAreaItemExpandable");r.renderControl(i);}}});T.prototype.onclick=function(e){if(this.$().parent().hasClass("sapUshellToolAreaItemSelected")){this.setSelected(false);}else{this.setSelected(true);}if(e.target.className.indexOf("sapUshellToolAreaItemExpandable")>0){this.fireExpand();}else{this.firePress();}};T.prototype.onsapenter=T.prototype.onclick;T.prototype.setExpandable=function(e){e=!!e;this.setProperty("expandable",e,true);this.$().toggleClass("sapUshellToolAreaItemExpandable",e);};T.prototype.setSelected=function(s){s=!!s;if(s){var j=q(".sapUshellToolAreaItemSelected");j.each(function(){q(this).removeClass("sapUshellToolAreaItemSelected");});}this.setProperty("selected",s,true);this.$().parent().toggleClass("sapUshellToolAreaItemSelected",s);};T.prototype.setVisible=function(v){var r=this.getParent().getDomRef();this.setProperty("visible",!!v,r);this.$().toggleClass("sapUshellShellHidden",!v);};T.prototype.setAriaLabel=function(a){this.setProperty('ariaLabel',a);return this;};return T;},true);};if(!jQuery.sap.isDeclared('sap.ushell.ui.tile.TileBase')){
/*!
 * Copyright (c) 2009-2014 SAP SE, All Rights Reserved
 */
jQuery.sap.declare("sap.ushell.ui.tile.TileBase");jQuery.sap.require('sap.ui.core.Control');sap.ui.core.Control.extend("sap.ushell.ui.tile.TileBase",{metadata:{library:"sap.ushell",properties:{"title":{type:"string",group:"Data",defaultValue:null},"subtitle":{type:"string",group:"Data",defaultValue:null},"icon":{type:"string",group:"Data",defaultValue:null},"info":{type:"string",group:"Data",defaultValue:null},"infoState":{type:"sap.ushell.ui.tile.State",group:"",defaultValue:sap.ushell.ui.tile.State.Neutral},"targetURL":{type:"string",group:"Behavior",defaultValue:null},"highlightTerms":{type:"any",group:"Appearance",defaultValue:[]}},aggregations:{"content":{type:"sap.ui.core.Control",multiple:true,singularName:"content"}},events:{"press":{}}}});sap.ushell.ui.tile.TileBase.M_EVENTS={'press':'press'};(function(){"use strict";sap.ushell.ui.tile.TileBase.prototype.ontap=function(e){this.firePress({});};sap.ushell.ui.tile.TileBase.prototype.onsapenter=function(e){this.firePress({});};sap.ushell.ui.tile.TileBase.prototype.onsapspace=function(e){this.firePress({});};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.tile.TileBaseRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.tile.TileBaseRenderer");sap.ushell.ui.tile.TileBaseRenderer={};var t=sap.ushell.resources.i18n;sap.ushell.ui.tile.TileBaseRenderer.highlight=function(h,T){var i,r,e=jQuery.sap.encodeHTML(T).replace(/&#xa;/g,"<br/>");if(h&&h.length&&h.length>0){for(i=0;i<h.length;i=i+1){r=new RegExp("("+jQuery.sap.encodeHTML(h[i]).replace(/([.*+?\^=!:${}()|\[\]\/\\])/g,"\\$1")+")","gi");e=e.replace(r,"<b>$1</b>");}}return e;};sap.ushell.ui.tile.TileBaseRenderer.render=function(r,c){var i,I;r.write("<div");r.writeControlData(c);if(c.getTargetURL()){r.writeAttributeEscaped("data-targeturl",c.getTargetURL());}r.addClass("sapUshellTileBase");r.writeClasses();r.write(">");r.write("<div");r.addClass("sapUshellTileBaseHeader");r.writeClasses();r.write(">");r.write("<h3");r.addClass("sapUshellTileBaseTitle");r.writeClasses();r.writeAccessibilityState(c,{label:t.getText("tileTypeListItem")+t.getText("TileDetails_lable")+t.getText("TileTitle_lable")+c.getTitle()});r.write(">");r.write(this.highlight(c.getHighlightTerms(),c.getTitle()||""));r.write("</h3>");if(c.getSubtitle()){r.write("<h4");r.addClass("sapUshellTileBaseSubtitle");r.writeClasses();r.writeAccessibilityState(c,{label:t.getText("TileSubTitle_lable")+c.getSubtitle()});r.write(">");r.write(this.highlight(c.getHighlightTerms(),c.getSubtitle()));r.write("</h4>");}r.write("</div>");if(typeof(this.renderPart)==='function'){this.renderPart(r,c);}if(c.getIcon()){I=new sap.ui.core.Icon({src:c.getIcon()});I.addStyleClass("sapUshellTileBaseIcon");r.renderControl(I);}if(c.getInfo()||((typeof(this.getInfoPrefix)==='function'))&&this.getInfoPrefix(c)){r.write("<div");r.addClass("sapUshellTileBaseInfo");r.addClass(c.getInfoState()?"sapUshellTileBase"+c.getInfoState():"sapUshellTileBase"+sap.ushell.ui.tile.State.Neutral);r.writeClasses();r.writeAccessibilityState(c,{label:t.getText("TileInfo_lable")+c.getInfo()});r.write(">");if(typeof(this.getInfoPrefix)==='function'){i=this.getInfoPrefix(c);r.writeEscaped(i);}if(c.getInfo()){if(i){r.write(", ");}r.write(this.highlight(c.getHighlightTerms(),c.getInfo()));}r.write("</div>");}r.write("</div>");};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui5service.ShellUIService')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui5service.ShellUIService");jQuery.sap.require('sap.ui.core.service.ServiceFactoryRegistry');jQuery.sap.require('sap.ui.core.service.ServiceFactory');jQuery.sap.require('sap.ui.base.EventProvider');jQuery.sap.require('sap.ui.thirdparty.hasher');var l;var e=new sap.ui.base.EventProvider();var O={hierarchyChanged:"hierarchyChanged",relatedAppsChanged:"relatedAppsChanged",titleChanged:"titleChanged",backNavigationChanged:"backNavigationChanged"};var a;sap.ui.core.service.Service.extend("sap.ushell.ui5service.ShellUIService",{init:function(){var t=this,p=this.getInterface();p.init=function(){t._amendPublicServiceInstance.call(t,this);};sap.ui.core.service.ServiceFactoryRegistry.register("sap.ushell.ui5service.ShellUIService",new sap.ui.core.service.ServiceFactory(p));},_setActiveComponentId:function(i){a=i;},_getActiveComponentId:function(){return a;},_shouldEnableAutoHierarchy:function(A){return typeof A.getManifestEntry==="function"&&A.getManifestEntry("/sap.ui5/services/ShellUIService/settings/setHierarchy")==="auto";},_shouldEnableAutoTitle:function(A){return typeof A.getManifestEntry==="function"&&A.getManifestEntry("/sap.ui5/services/ShellUIService/settings/setTitle")==="auto";},_enableAutoHierarchy:function(A){var t=this;var r=A.getRouter&&A.getRouter();if(!r){jQuery.sap.log.error("Could not enable automatic setHierarchy on the current app","Router could not be obtained on the app root component via getRouter","sap.ushell.ui5service.ShellUIService");return;}r.attachTitleChanged(function(E){var h=E.getParameter("history");t.setHierarchy(h.reverse().map(function(u){var s=t._getCurrentShellHashWithoutAppRoute();return{title:u.title,intent:s+"&/"+u.hash};}));});},_enableAutoTitle:function(A){var t=this;var r=A.getRouter&&A.getRouter();if(!r){jQuery.sap.log.error("Could not enable automatic setTitle on the current app","Router could not be obtained on the app root component via getRouter","sap.ushell.ui5service.ShellUIService");return;}var T=r.getTitleHistory()[0];if(T&&T.title){setTimeout(function(){t.setTitle(T.title);},0);}r.attachTitleChanged(function(E){var s=E.getParameter("title");t.setTitle(s);});},_getCurrentShellHashWithoutAppRoute:function(){var f="#"+hasher.getHash();var u=sap.ushell.Container.getService("URLParsing");var U=u.getShellHash(f);if(!U){jQuery.sap.log.error("Cannot get the current shell hash","URLParsing service returned a falsy value for "+f,"sap.ushell.ui5service.ShellUIService");return"";}return"#"+U;},_getEventProvider:function(){return e;},_getLastSetTitle:function(){return l;},_ensureArrayOfObjectOfStrings:function(A,m){var v=jQuery.isArray(A)&&A.every(function(o){return jQuery.isPlainObject(o)&&Object.keys(o).length>0&&Object.keys(o).every(function(k){return typeof o[k]==="string";});});if(!v){jQuery.sap.log.error("'"+m+"' was called with invalid parameters","An array of non-empty objects with string values is expected","sap.ushell.ui5service.ShellUIService");}return v;},_ensureFunction:function(A,m){var t=typeof A;if(t!=="function"){jQuery.sap.log.error("'"+m+"' was called with invalid arguments","the parameter should be a function, got '"+t+"' instead","sap.ushell.ui5service.ShellUIService");return false;}return true;},_ensureString:function(A,m){var t=typeof A;if(t!=="string"){jQuery.sap.log.error("'"+m+"' was called with invalid arguments","the parameter should be a string, got '"+t+"' instead","sap.ushell.ui5service.ShellUIService");return false;}return true;},_addCallAllowedCheck:function(p,P){var t=this;p[P]=function(){var c=p.getContext();if(!c||c.scopeObject.getId()!==a){jQuery.sap.log.warning("Call to "+P+" is not allowed","This may be caused by an app component other than the active '"+a+"' that tries to call the method","sap.ushell.ui5service.ShellUIService");return undefined;}if(P==="setHierarchy"&&c.scopeType==="component"&&c.scopeObject&&t._shouldEnableAutoHierarchy(c.scopeObject)){jQuery.sap.log.warning("Call to "+P+" is not allowed","The app defines that setHierarchy should be called automatically","sap.ushell.ui5service.ShellUIService");return undefined;}if(P==="setTitle"&&c.scopeType==="component"&&c.scopeObject&&t._shouldEnableAutoTitle(c.scopeObject)){jQuery.sap.log.warning("Call to "+P+" is not allowed","The app defines that setTitle should be called automatically","sap.ushell.ui5service.ShellUIService");return undefined;}return t[P].apply(p,arguments);};},_amendPublicServiceInstance:function(p){var t=this,c;c=p.getContext();if(typeof c==="undefined"){return;}["setTitle","setHierarchy","setRelatedApps","setBackNavigation"].forEach(function(m){t._addCallAllowedCheck(p,m);});var A=c.scopeObject;if(c.scopeType==="component"&&A){this._setActiveComponentId(A.getId());if(this._shouldEnableAutoHierarchy(A)){this._enableAutoHierarchy(A);}if(this._shouldEnableAutoTitle(A)){this._enableAutoTitle(A);}return;}jQuery.sap.log.error("Invalid context for ShellUIService interface","The context must be empty or an object like { scopeType: ..., scopeObject: ... }","sap.ushell.ui5service.ShellUIService");},setHierarchy:function(h){if(typeof h!=="undefined"&&!sap.ushell.ui5service.ShellUIService.prototype._ensureArrayOfObjectOfStrings(h,"setHierarchy")){return;}var c=this.getContext().scopeObject;e.fireEvent(O.hierarchyChanged,{data:h,component:c});return;},setTitle:function(t){if(typeof t!=="undefined"&&!sap.ushell.ui5service.ShellUIService.prototype._ensureString(t,"setTitle")){return;}var c=this.getContext().scopeObject;l=t;e.fireEvent(O.titleChanged,{data:t,component:c});return;},setBackNavigation:function(c){if(typeof c!=="undefined"&&!sap.ushell.ui5service.ShellUIService.prototype._ensureFunction(c,"setBackNavigation")){return;}var C=this.getContext().scopeObject;e.fireEvent(O.backNavigationChanged,{data:c,component:C});return;},getTitle:function(){return this._getLastSetTitle();},setRelatedApps:function(r){if(typeof r!=="undefined"&&!sap.ushell.ui5service.ShellUIService.prototype._ensureArrayOfObjectOfStrings(r,"setRelatedApps")){return;}var c=this.getContext().scopeObject;e.fireEvent(O.relatedAppsChanged,{data:r,component:c});return;},getUxdVersion:function(){if((new jQuery.sap.Version(sap.ui.version).compareTo("1.37.0"))>=0){return 2;}return 1;},_attachHierarchyChanged:function(f){this._getEventProvider().attachEvent(O.hierarchyChanged,f);},_detachHierarchyChanged:function(f){this._getEventProvider().detachEvent(O.hierarchyChanged,f);},_attachTitleChanged:function(f){this._getEventProvider().attachEvent(O.titleChanged,f);},_attachBackNavigationChanged:function(f){this._getEventProvider().attachEvent(O.backNavigationChanged,f);},_detachBackNavigationChanged:function(f){this._getEventProvider().detachEvent(O.backNavigationChanged,f);},_detachTitleChanged:function(f){this._getEventProvider().detachEvent(O.titleChanged,f);},_attachRelatedAppsChanged:function(f){this._getEventProvider().attachEvent(O.relatedAppsChanged,f);},_detachRelatedAppsChanged:function(f){this._getEventProvider().detachEvent(O.relatedAppsChanged,f);}});}());};if(!jQuery.sap.isDeclared('sap.ushell.ui5service.UserStatus')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui5service.UserStatus");jQuery.sap.require('sap.ui.core.service.ServiceFactoryRegistry');jQuery.sap.require('sap.ui.core.service.ServiceFactory');jQuery.sap.require('sap.ui.base.EventProvider');var e=new sap.ui.base.EventProvider(),O={statusChanged:"statusChanged",serviceEnabled:"serviceEnabled"},a;sap.ui.core.service.Service.extend("sap.ushell.ui5service.UserStatus",{init:function(){var t=this,p=this.getInterface();sap.ushell.ui5service.UserStatus.prototype.isEnabled=false;p.init=function(){t._amendPublicServiceInstance.call(t,this);};sap.ui.core.service.ServiceFactoryRegistry.register("sap.ushell.ui5service.UserStatus",new sap.ui.core.service.ServiceFactory(p));sap.ushell.ui5service.UserStatus.prototype.AvailableStatus={AVAILABLE:"AVAILABLE",AWAY:"AWAY",BUSY:"BUSY",APPEAR_OFFLINE:"APPEAR_OFFLINE"};},_setActiveComponentId:function(i){a=i;},_getActiveComponentId:function(){return a;},_getEventProvider:function(){return e;},_ensureArrayOfObjectOfStrings:function(A,m){var v=jQuery.isArray(A)&&A.every(function(o){return jQuery.isPlainObject(o)&&Object.keys(o).length>0&&Object.keys(o).every(function(k){return typeof o[k]==="string";});});if(!v){jQuery.sap.log.error("'"+m+"' was called with invalid parameters","An array of non-empty objects with string values is expected","sap.ushell.ui5service.UserStatus");}return v;},_ensureFunction:function(A,m){var t=typeof A;if(t!=="function"){jQuery.sap.log.error("'"+m+"' was called with invalid arguments","the parameter should be a function, got '"+t+"' instead","sap.ushell.ui5service.UserStatus");return false;}return true;},_ensureString:function(A,m){var t=typeof A;if(t!=="string"){jQuery.sap.log.error("'"+m+"' was called with invalid arguments","the parameter should be a string, got '"+t+"' instead","sap.ushell.ui5service.UserStatus");return false;}return true;},_addCallAllowedCheck:function(p,P){var t=this;p[P]=function(){var c=p.getContext();if(!c||c.scopeObject.getId()!==a){jQuery.sap.log.warning("Call to "+P+" is not allowed","This may be caused by an app component other than the active '"+a+"' that tries to call the method","sap.ushell.ui5service.UserStatus");return undefined;}return t[P].apply(p,arguments);};},_amendPublicServiceInstance:function(p){var t=this,c;c=p.getContext();if(typeof c==="undefined"){return;}["setStatus","attachStatusChanged","detachStatusChanged"].forEach(function(m){t._addCallAllowedCheck(p,m);});if(c.scopeType==="component"){this._setActiveComponentId(c.scopeObject.getId());return;}jQuery.sap.log.error("Invalid context for UserStatus interface","The context must be empty or an object like { scopeType: ..., scopeObject: ... }","sap.ushell.ui5service.UserStatus");},setEnabled:function(E){e.fireEvent(O.serviceEnabled,{data:E});sap.ushell.ui5service.UserStatus.prototype.isEnabled=E;return;},attachEnabledStatusChanged:function(f){this._getEventProvider().attachEvent(O.serviceEnabled,f);},detachEnabledStatusChanged:function(f){this._getEventProvider().detachEvent(O.serviceEnabled,f);},setStatus:function(n){if(!sap.ushell.ui5service.UserStatus.prototype.isEnabled){throw new Error("Unable to change status because the UserStatus service is disabled.");}if(!sap.ushell.ui5service.UserStatus.prototype.AvailableStatus[n]){throw new Error("Enter a valid status.");}e.fireEvent(O.statusChanged,{data:n});return;},getUxdVersion:function(){if((new jQuery.sap.Version(sap.ui.version).compareTo("1.37.0"))>=0){return 2;}return 1;},attachStatusChanged:function(f){this._getEventProvider().attachEvent(O.statusChanged,f);},detachStatusChanged:function(f){this._getEventProvider().detachEvent(O.statusChanged,f);}});}());};if(!jQuery.sap.isDeclared('sap.ushell.User')){(function(){"use strict";jQuery.sap.declare("sap.ushell.User");function c(o){if(o===undefined){return undefined;}return jQuery.extend(true,{},o);}function g(u){var o;if(u.host&&typeof u.host==="function"&&u.host()){o=u.host();if(typeof u.protocol==="function"&&u.protocol()){o=u.protocol()+"://"+o;}return o;}return"";}function i(t){return t.indexOf("sap_")===0;}sap.ushell.User=function(C){var a=[],b,s,o,n,e=new sap.ui.base.EventProvider();this.getEmail=function(){return C.email;};this.getFirstName=function(){return C.firstName;};this.getFullName=function(){return C.fullName;};this.getId=function(){return C.id;};this.getLanguage=function(){return C.language;};this.getLanguageBcp47=function(){return C.languageBcp47;};this.getLastName=function(){return C.lastName;};this.getImage=function(){return C.image;};this.setImage=function(u){C.image=u;e.fireEvent('onSetImage',u);};this.attachOnSetImage=function(f,d){e.attachEvent('onSetImage',f,d);};this.isJamActive=function(){return C.isJamActive===true;};this.getTheme=function(t){if(t===sap.ushell.User.prototype.constants.themeFormat.ORIGINAL_THEME){return o.originalTheme.theme;}if(t===sap.ushell.User.prototype.constants.themeFormat.THEME_NAME_PLUS_URL){return o.theme+(o.locationPath?"@"+o.locationOrigin+o.locationPath:"");}if(t===sap.ushell.User.prototype.constants.themeFormat.NWBC){if(i(o.theme)){return o.theme;}else{return this.getTheme(sap.ushell.User.prototype.constants.themeFormat.THEME_NAME_PLUS_URL);}}return o.theme;};this.setTheme=function(N){if(this.isSetThemePermitted()===false){var E="setTheme not permitted";jQuery.sap.log.error(E);throw new Error(E);}o=this._amendTheme({theme:N,root:""},s);if(N!==n.originalTheme.theme){this.setChangedProperties("THEME",n.originalTheme.theme,N);n=o;}if(o.suppliedRoot){sap.ui.getCore().applyTheme(o.theme,o.suppliedRoot+"/UI5/");}else if(o.path){sap.ui.getCore().applyTheme(o.theme,o.path+"/UI5/");}else{sap.ui.getCore().applyTheme(o.theme);}};this.getAccessibilityMode=function(){return C.accessibility;};this.setAccessibilityMode=function(A){if(this.isSetAccessibilityPermitted()===false){var E="setAccessibilityMode not permitted";jQuery.sap.log.error(E);throw new Error(E);}C.accessibility=A;};this.isSetAccessibilityPermitted=function(){return C.setAccessibilityPermitted;};this.isSetThemePermitted=function(){return C.setThemePermitted;};this.getContentDensity=function(){return C.contentDensity;};this.setContentDensity=function(d){if(this.isSetContentDensityPermitted()===false){var E="setContentDensity not permitted";jQuery.sap.log.error(E);throw new Error(E);}this.setChangedProperties("CONTENT_DENSITY",C.contentDensity,d);C.contentDensity=d;};this.isSetContentDensityPermitted=function(){return C.setContentDensityPermitted;};this.getChangedProperties=function(){return jQuery.extend(true,[],a);};this.setChangedProperties=function(p,d,f){a.push({name:p,oldValue:d,newValue:f});};this.resetChangedProperties=function(){a=[];};this.getTrackUsageAnalytics=function(){return C.trackUsageAnalytics;};this.setTrackUsageAnalytics=function(t){this.setChangedProperties("TRACKING_USAGE_ANALYTICS",C.trackUsageAnalytics,t);C.trackUsageAnalytics=t;};s={locationPathUi5:(new URI(jQuery.sap.getModulePath(""))).absoluteTo(document.location).pathname(),locationPathCustom:C.themeRoot||"",locationOrigin:g(new URI(document.location))};if(!s.locationPathUi5){jQuery.sap.log.warning("User: Could not set UI5 location path");}if(!s.locationPathCustom){jQuery.sap.log.warning("User: Could not set location path for custom themes");}if(!s.locationOrigin){jQuery.sap.log.warning("User: Could not set front-end server location origin");}b=C.bootTheme||{theme:"",root:""};o=this._amendTheme(b,s);n=o;};sap.ushell.User.prototype._amendTheme=function(t,s){var T={},a,r;function b(R,s){var u,o,p={};u=new URI(R);o=g(u);if(o){p.locationOrigin=o;p.locationPath=u.path();}else{p.locationOrigin=s.locationOrigin;p.locationPath=R;}return p;}if(!t||!t.theme||!s){return{originalTheme:{theme:"",root:""},theme:"",suppliedRoot:"",path:"",locationPath:"",locationOrigin:""};}T.originalTheme=c(t);if(T.originalTheme.theme.indexOf("@")>0){a=T.originalTheme.theme.split('@',2);T.theme=a[0];T.suppliedRoot=a[1];r=b(a[1],s);T.locationPath=r.locationPath;T.path=T.locationPath;T.locationOrigin=r.locationOrigin;return T;}T.theme=T.originalTheme.theme;if(T.originalTheme.root){T.suppliedRoot=T.originalTheme.root;r=b(T.originalTheme.root,s);T.locationPath=r.locationPath;T.path=T.locationPath;T.locationOrigin=r.locationOrigin;return T;}T.suppliedRoot="";if(i(T.theme)){T.locationOrigin=s.locationOrigin;T.locationPath=s.locationPathUi5;T.path="";return T;}T.locationOrigin=s.locationOrigin;T.locationPath=s.locationPathCustom;T.path=T.locationPath;return T;};sap.ushell.User.prototype.constants={themeFormat:{ORIGINAL_THEME:"O",THEME_NAME_PLUS_URL:"N+U",NWBC:"NWBC"}};}());};if(!jQuery.sap.isDeclared('sap.ushell.UserActivityLog')){(function(){"use strict";jQuery.sap.declare("sap.ushell.UserActivityLog");var U=function(){};U.prototype={_maxLoggedMessages:30,_maxMessageByteSize:2048,_maxQueueByteSize:30720,_isActive:false,_observedLaunchpadActions:["createGroup","deleteGroup","resetGroup","changeGroupTitle","moveGroup","addTile","deleteTile","moveTile","externalSearch","appOpened","addBookmarkTile"],_observedGeneralActions:["showCatalog","openApp"],messageType:{ACTION:0,ERROR:1},_tileOntapOrigFunc:undefined,activate:function(c){if(this._isActive){return;}this._isActive=true;var e=sap.ui.getCore().getEventBus(),t=this;this._observedLaunchpadActions.forEach(function(a,i,b){e.subscribe("launchpad",a,t._handleAction,t);});this._observedGeneralActions.forEach(function(a,i,b){e.subscribe(a,t._handleAction,t);});jQuery.sap.log.addLogListener(this);jQuery.sap.log.debug("requiring sap.ushell.ui.launchpad.Tile",new Error().stack,"sap.ushell.UserActivityLog");jQuery.sap.require("sap.ushell.ui.launchpad.Tile");t._tileOntapOrigFunc=sap.ushell.ui.launchpad.Tile.prototype.ontap;sap.ushell.ui.launchpad.Tile.prototype.ontap=t._tileOnTapDecorator(t._tileOntapOrigFunc);},deactivate:function(){if(!this._isActive){return;}this._isActive=false;var e=sap.ui.getCore().getEventBus(),t=this;this._observedLaunchpadActions.forEach(function(a,i,b){e.unsubscribe("launchpad",a,t._handleAction,t);});this._observedGeneralActions.forEach(function(a,i,b){e.unsubscribe(a,t._handleAction,t);});jQuery.sap.log.removeLogListener(this);sap.ushell.ui.launchpad.Tile.prototype.ontap=this._tileOntapOrigFunc;},addMessage:function(t,m,a){if(this._isActive){this._addMessageInternal(t,m,a);}},getLog:function(){return this._getLoggingQueueFromStorage();},getMessageInfo:function(u){var r={userDetails:this._getUserDetails(),shellState:this._getShellState(),navigationData:this._getLastNavActionFromStorage(),userLog:this.getLog(),formFactor:sap.ushell.utils.getFormFactor()};return r;},getMessageInfoAsString:function(u){return JSON.stringify(this.getMessageInfo(u));},onLogEntry:function(d){var e=(typeof d.details!="undefined"&&(d.details!==""))?(d.message+" , "+d.details):d.message;this.addMessage(this.messageType.ERROR,e);},onAttachToLog:function(){},onDetachFromLog:function(){},_tileOnTapDecorator:function(o){var t=this,n,l,a,b,c,d;return function(e,u){var f=this.getMetadata().getName();if(f=="sap.ushell.ui.launchpad.PlusTile"){t.addMessage(t.messageType.ACTION,"Open Catalog for empty group "+this.getGroupId());}else if(f=="sap.ushell.ui.launchpad.Tile"){n=hasher.getHash();if(n){var g=sap.ushell.Container.getService("URLParsing");var h=g.parseShellHash(n);n='#'+g.constructShellHash({target:{semanticObject:h.semanticObject,action:h.action}});}l=t._getLastNavActionFromStorage();l.time=new Date();l.navigationHash=n;l.tileDebugInfo=this.getDebugInfo();a=sap.ui.getCore().byId(this.getId());b=a.getModel();c=this.getBindingContext();d=c.getPath();l.tileTitle=c.getModel().getProperty(d).title;t._putInLocalStorage("sap.ushell.UserActivityLog.lastNavigationActionData",JSON.stringify(l));t.addMessage(t.messageType.ACTION,"Click on Tile: "+b.getData().title+" Tile debugInfo: "+this.getDebugInfo());}o.apply(this,arguments);};},_addMessageInternal:function(t,m,a){var l=this._getLoggingQueueFromStorage(),b={type:null},p;for(p in this.messageType){if(t==this.messageType[p]){b.type=p;break;}}if(b.type===null){return;}jQuery.extend(b,{messageID:a,messageText:m,time:new Date(),toString:function(){var c=[this.type,this.time];if(typeof this.messageID!=="undefined"){c.push(this.messageID);}c.push(this.messageText);return c.join(" :: ");}});l.push(b);if(l.length>this._maxLoggedMessages){l.shift();}this._putInLocalStorage("sap.ushell.UserActivityLog.loggingQueue",JSON.stringify(l));},_handleAction:function(c,e,d){var m;switch(e){case'deleteTile':m="Delete Tile "+(d.tileId||"");break;case'moveTile':m="Move Tile "+(d.sTileId||"")+" to Group "+(d.toGroupId||"");break;case'createGroup':m="Create Group";break;case'changeGroupTitle':m="Change Group Title of "+(d.groupId||"")+" to "+(d.newTitle||"");break;case'deleteGroup':m="Delete Group "+(d.groupId||"");break;case'addTile':var t=d.catalogTileContext.oModel.oData,T=d.catalogTileContext.sPath,a=this._findInModel(T,t),b=a.id,g=d.groupContext.oModel.oData,G=d.groupContext.sPath,f=this._findInModel(G,g),h=f.groupId;m="Add Tile "+(b||"")+" to Group "+(h||"");break;case'moveGroup':m="Move Group from index "+(d.fromIndex||"")+" to index "+(d.toIndex||"");break;case'appOpened':m="Open application "+d.action;var l=this._getLastNavActionFromStorage();l.applicationInformation={};["applicationType","ui5ComponentName","url","additionalInformation","text"].forEach(function(p){l.applicationInformation[p]=d[p];});if(!this._hashSegmentsEqual(l.navigationHash,d.sShellHash)){l.tileDebugInfo="";}l.navigationHash=d.sShellHash;this._putInLocalStorage("sap.ushell.UserActivityLog.lastNavigationActionData",JSON.stringify(l));break;case'addBookmarkTile':m="Add Bookmark "+(d.title||"")+" "+(d.subtitle||"")+" for URL: "+(d.url||"");break;case'showCatalog':m="Show Catalog";break;default:break;}this.addMessage(this.messageType.ACTION,m);},_findInModel:function(p,m){var a,b=m,i,c;try{a=p.split("/");for(i=0;i<a.length;i=i+1){if(c!==a[i]){continue;}b=b[c];}}catch(e){return undefined;}return b;},_getUserDetails:function(u){var a=sap.ushell.Container.getUser();return{fullName:a.getFullName()||"",userId:a.getId()||"",eMail:a.getEmail()||"",Language:a.getLanguage()||""};},_getShellState:function(){var v=sap.ui.getCore().byId("viewPortContainer"),m,r="";if(v!==undefined){m=v.getModel();r=m.getProperty("/currentState/stateName");}return r;},_getLoggingQueueFromStorage:function(){var l=this._getFromLocalStorage("sap.ushell.UserActivityLog.loggingQueue");var q=[];if(l){try{q=JSON.parse(l);}catch(e){}}return q;},_getLastNavActionFromStorage:function(){var l=this._getFromLocalStorage("sap.ushell.UserActivityLog.lastNavigationActionData");return(l?JSON.parse(l):{});},_hashSegmentsEqual:function(u,a){if((!u)||(!a)){return false;}return(this._getHashSegment(u)==this._getHashSegment(a))?true:false;},_getHashSegment:function(u){var i=u.indexOf("~"),a;if(i>-1){return u.substring(0,i);}a=u.indexOf("?");if(a>-1){return u.substring(0,a);}return u;},_getFromLocalStorage:function(k){var r=null;try{r=localStorage.getItem(k);}catch(e){}return r;},_putInLocalStorage:function(k,v){try{localStorage.setItem(k,v);}catch(e){}}};sap.ushell.UserActivityLog=new U();})();};if(!jQuery.sap.isDeclared('sap.ushell.adapters.cdm.LaunchPageAdapter')){(function(){"use strict";jQuery.sap.declare("sap.ushell.adapters.cdm.LaunchPageAdapter");jQuery.sap.require('sap.m.Text');sap.ushell.adapters.cdm.LaunchPageAdapter=function(u,p,a){var _;this._mResolvedTiles={};this._mResolvedCatalogTiles={};this._mCatalogTilePromises={};this._mFailedResolvedCatalogTiles={};this._mFailedResolvedTiles={};this.TileType={Tile:"tile",Link:"link"};this.getGroups=function(){var D=new jQuery.Deferred();this._assureLoaded().done(function(G){D.resolve(G);}).fail(function(){D.resolve([]);});return D.promise();};this._getTileFromHash=function(H){var D=new jQuery.Deferred(),C=this._mCatalogTilePromises[H];if(!C){C=sap.ushell.Container.getService("ClientSideTargetResolution").resolveTileIntent(H);this._mCatalogTilePromises[H]=C;}C.done(function(T){var o={tileIntent:H,tileResolutionResult:T};D.resolve(o);}).fail(function(e){D.reject("Hash '"+H+"' could not be resolved to a tile. "+e);});return D.promise();};this._assureGroupItemsResolved=function(G){var P=[],r,R;if(G.payload&&G.payload.tiles){r=this._assureGroupTilesResolved(G.payload.tiles);Array.prototype.push.apply(P,r);}if(G.payload&&G.payload.links){R=this._assureGroupLinksResolved(G.payload.links,G.identification.id);Array.prototype.push.apply(P,R);}return P;};this._assureGroupTilesResolved=function(G){return(G||[]).map(function(T,I){return this._getResolvedTile(T,I).then(function(r){r.isLink=false;return r;});},this);};this._assureGroupLinksResolved=function(G,s){return(G||[]).map(function(l,I){return this._getResolvedTile(l,I).then(function(r){r.isLink=true;return r;});},this);};this._prepareTileHash=function(T){var U=sap.ushell.Container.getService("URLParsing"),P={},o,r;if(this._isCatalogTile(T)){return T.tileIntent;}if(this._isGroupTile(T)){r=T.target.parameters||[];r.forEach(function(e){if(e.name&&e.value){P[e.name]=[e.value];}});o={target:{semanticObject:T.target.semanticObject,action:T.target.action},params:P,appSpecificRoute:T.target.appSpecificRoute};return"#"+U.constructShellHash(o);}return undefined;};this._allPromisesDone=function(P){var D=new jQuery.Deferred(),o;if(P.length===0){D.resolve();}else{var n=P.map(function(e){o=new jQuery.Deferred();e.always(o.resolve.bind(o));return o.promise();});jQuery.when.apply(this,n).done(function(){var A=Array.prototype.slice.call(arguments);D.resolve(A);});}return D.promise();};this._generateDefaultGroup=function(){var G,o,D=new jQuery.Deferred(),C=sap.ushell.Container.getService("CommonDataModel");C.getSite().done(function(s){G=sap.ushell.utils.generateUniqueId(s.site.payload.groupsOrder);o={"identification":{"id":G,"namespace":"","title":"Home"},"payload":{"isDefaultGroup":true,"locked":false,"tiles":[],"links":[],"groups":[]}};_=o;s.groups[G]=o;s.site.payload.groupsOrder.unshift(G);D.resolve(o);}).fail(function(e){D.reject("Failed to access site. "+e);});return D.promise();};this._assureLoaded=function(){var e=this,C=sap.ushell.Container.getService("CommonDataModel"),D,l=[],o;if(this._assureLoadedDeferred){return this._assureLoadedDeferred.promise();}o=new jQuery.Deferred();this._assureLoadedDeferred=o;C.getSite().done(function(s){var I=[];s.site.payload.groupsOrder.forEach(function(G,j){var k=s.groups[G];if(k){k.payload=k.payload||{};if(k.payload.hasOwnProperty("isDefaultGroup")){_=k;}l.push(k);I=e._assureGroupItemsResolved(k).concat(I);}});if(_===undefined){D=e._generateDefaultGroup();I.push(D);D.done(function(G){l.unshift(G);}).fail(function(E){jQuery.sap.log.error("Delivering hompage groups failed - "+E);e._assureLoadedDeferred.resolve([]);});}e._allPromisesDone(I).done(function(){e._assureLoadedDeferred.resolve(l);delete e._assureLoadedDeferred;});}).fail(function(E){jQuery.sap.log.error("Delivering hompage groups failed - "+E);e._assureLoadedDeferred.resolve([]);delete e._assureLoadedDeferred;});return o.promise();};this.getDefaultGroup=function(){var D=new jQuery.Deferred(),A;if(!_){A=this._assureLoaded();}if(A){A.done(function(){D.resolve(_);}).fail(function(m){D.reject("Failed to access default group. "+m);});}else{D.resolve(_);}return D.promise();};this._isValidTitle=function(T){if(typeof T!=='string'||!T){return false;}return true;};this._isGroupPreset=function(G){if(!G.payload.hasOwnProperty("isPreset")){return true;}return!!G.payload.isPreset;};this._isGroupLocked=function(G){return!!G.payload.locked;};this.addGroup=function(T){var D=new jQuery.Deferred(),C=sap.ushell.Container.getService("CommonDataModel"),G,s,e;if(!this._isValidTitle(T)){return D.reject("No valid group title").promise();}e="Failed to add the group with title '"+T+"' to the homepage. ";C.getSite().done(function(S){s=sap.ushell.utils.generateUniqueId(S.site.payload.groupsOrder);G={"identification":{"id":s,"namespace":"","title":T},"payload":{"locked":false,"isPreset":false,"tiles":[],"links":[],"groups":[]}};S.groups[s]=G;S.site.payload.groupsOrder.push(G.identification.id);C.save().done(function(){D.resolve(S.groups[s],s);}).fail(function(E){D.reject(E);});}).fail(function(E){D.reject(e+E);});return D.promise();};this.getGroupTitle=function(G){return G.identification.title;};this.setGroupTitle=function(G,n){var e=this,D=new jQuery.Deferred(),C=sap.ushell.Container.getService("CommonDataModel"),o,s;if(typeof G!=='object'||!G.identification||!G.identification.id){return D.reject("Unexpected group value").promise();}if(!e._isValidTitle(n)){return D.reject("Unexpected oGroup title value").promise();}s="Failed to set new title for group with id '"+G.identification.id+"'. ";o=G.identification.title;C.getSite().done(function(S){if(S.groups[G.identification.id]){S.groups[G.identification.id].identification.title=n;}C.save().done(function(){D.resolve();}).fail(function(E){jQuery.sap.log.error(E);D.reject(o);});}).fail(function(E){D.reject(o,s+E);});return D.promise();};this.getGroupId=function(G){return G.identification.id;};this.hideGroups=function(H){var D=new jQuery.Deferred(),C=sap.ushell.Container.getService("CommonDataModel"),G;if(H&&jQuery.isArray(H)){G="Failed to hide group. ";C.getSite().done(function(s){if(H.length>0){Object.keys(s.groups).forEach(function(e){if(jQuery.inArray(s.groups[e].identification.id,H)>-1){s.groups[e].identification.isVisible=false;}else{delete s.groups[e].identification.isVisible;}});}if(H.length===0){Object.keys(s.groups).forEach(function(e){delete s.groups[e].identification.isVisible;});}C.save().done(function(){D.resolve();}).fail(function(e){D.reject("Hiding of groups did not work as expected - "+e);});}).fail(function(e){D.reject(G+e);});}else{D.reject("Invalid input parameter aHiddenGroupIds. Please pass a valid input parameter.");}return D.promise();};this.isGroupVisible=function(G){if(G.identification.isVisible===undefined||G.identification.isVisible===true){return true;}else{return false;}};this.moveGroup=function(G,n){var D=new jQuery.Deferred(),C=sap.ushell.Container.getService("CommonDataModel"),e,s;if(!G||!G.identification||!G.identification.id||n<0){return D.reject("Unable to move groups - invalid parameters").promise();}s="Failed to move group with id '"+G.identification.id+"'. ";C.getSite().done(function(S){if(!S.site.payload.groupsOrder){return D.reject("groupsOrder not found - abort operation of adding a group.");}else if(S.site.payload.groupsOrder.indexOf(G.identification.id)===n){return D.resolve();}e=sap.ushell.utils.moveElementInsideOfAnArray(S.site.payload.groupsOrder,S.site.payload.groupsOrder.indexOf(G.identification.id),n);if(!e){return D.reject("invalid move group operation - abort.");}C.save().done(function(){D.resolve();}).fail(function(E){D.reject(E);});}).fail(function(E){D.reject(s+E);});return D.promise();};this.removeGroup=function(G){var D=new jQuery.Deferred(),C=sap.ushell.Container.getService("CommonDataModel"),s;if(!G||typeof G!=="object"||!G.identification||!G.identification.id){return D.reject("no valid input parameter for 'oGroup'").promise();}s="Failed to remove group with id '"+G.identification.id+"'. ";C.getSite().done(function(S){if(S&&S.groups&&S.groups[G.identification.id]){delete S.groups[G.identification.id];}if(S&&S.site&&S.site.payload&&S.site.payload.groupsOrder){S.site.payload.groupsOrder=jQuery.grep(S.site.payload.groupsOrder,function(e){return e!==G.identification.id;});}C.save().done(function(){D.resolve();}).fail(function(e){D.reject(e);});}).fail(function(e){D.reject(s+e);});return D.promise();};this.resetGroup=function(G){var D=new jQuery.Deferred(),C=sap.ushell.Container.getService("CommonDataModel"),s={},e=this,j;if(G&&typeof G==="object"&&G.identification&&G.identification.id){j="Failed to reset group with id '"+G.identification.id+"'. ";C.getSite().done(function(S){jQuery.extend(true,s,S.groups);if(e.isGroupRemovable(G)===false){C.getGroupFromOriginalSite(G.identification.id).done(function(o){if(S&&typeof S==="object"&&S.groups&&S.groups[G.identification.id]){S.groups[G.identification.id]=o;}C.save().done(function(){D.resolve(o);}).fail(function(E){D.reject("Group could not be reset - "+E,s);});}).fail(function(E){D.reject("Group could not be reset - "+E,s);});}else{D.reject("Group could not be reset as it was created by the user",s);}}).fail(function(E){D.reject(j+E,s);});}return D.promise();};this.getTileTitle=function(T){var r;if(T&&T.isBookmark){return T.title;}r=this._mResolvedTiles[T.id];if(r){return T.title||r.tileResolutionResult.title;}else{return"";}};this.getTileSubtitle=function(T){var r;if(T.isBookmark){return T.subTitle;}r=this._mResolvedTiles[T.id];return T.subTitle||r.tileResolutionResult.subTitle;};this.getTileIcon=function(T){var r;if(T.isBookmark){return T.icon;}r=this._mResolvedTiles[T.id];return T.icon||r.tileResolutionResult.icon;};this.getTileIndicatorDataSource=function(T){var r=this._mResolvedTiles[T.id];var R={};var o;if(T.indicatorDataSource){R.indicatorDataSource=T.indicatorDataSource;if(T.dataSource){R.dataSource=T.dataSource;}return R;}if(r){o=r.tileResolutionResult;if(o.indicatorDataSource){R.indicatorDataSource=o.indicatorDataSource;}if(o.dataSource){R.dataSource=o.dataSource;}}return R;};this.isGroupRemovable=function(G){return!this._isGroupPreset(G);};this.isGroupLocked=function(G){return this._isGroupLocked(G);};this.getGroupTiles=function(G){var T=G.payload.tiles||[];if(G.payload.links&&jQuery.isArray(G.payload.links)&&G.payload.links.length>0){T=T.concat(G.payload.links);}return T;};this.getLinkTiles=function(G){if(G.payload.links&&jQuery.isArray(G.payload.links)&&G.payload.links.length>0){return G.payload.links;}else{return[];}};this.getTileType=function(T){var r=this._mResolvedTiles[T.id];if(r&&r.isLink){return this.TileType.Link;}return this.TileType.Tile;};this.getTileId=function(T){return T.id;};this.getTileSize=function(T){var r=this._mResolvedTiles[T.id];if(r&&r.tileResolutionResult&&r.tileResolutionResult.size){return r.tileResolutionResult.size;}return"1x1";};this.getTileTarget=function(T){var r,R=this._mResolvedTiles[T.id],s;if(R&&R.tileResolutionResult){r=R.tileResolutionResult;if(r.isCustomTile!==true){return R.tileIntent;}if(r&&typeof r.targetOutbound==="object"){s=this._toHashFromOutbound(r.targetOutbound);if(s){return s;}}}jQuery.sap.log.warning("Could not find a target for Tile with id '"+T.id+"'","sap.ushell.adapters.cdm.LaunchPageAdapter");return"";};this.isTileIntentSupported=function(T){return(this._mFailedResolvedTiles[T.id]===undefined)?true:false;};this.refreshTile=function(T){};this.setTileVisible=function(T,n){var r=this._mResolvedTiles[T.id];if(r&&r.tileComponent&&typeof r.tileComponent.tileSetVisible==="function"){if(r.visibility!==n){r.visibility=n;r.tileComponent.tileSetVisible(n);}}};this.getTileView=function(G){var A=this;return new jQuery.Deferred(function(D){return A._getTileView(G,false).then(function(T){if(!T){D.reject("Tile view or component could not be initialized");}D.resolve(T);},function(r){var e="Tile with ID '"+G.id+"' could not be initialized"+(r?":\n"+r:".");jQuery.sap.log.error(e,null,G.tileType);D.reject(e);});});};this._getResolvedTile=function(T,I){var H;var s=this._mResolvedTiles;var F=this._mFailedResolvedTiles;if(s[T.id]){return(new jQuery.Deferred()).resolve(s[T.id]).promise();}H=this._prepareTileHash(T,I);return this._getTileFromHash(H).then(function(r){s[T.id]=r;if(F[T.id]){delete F[T.id];}return r;},function(e){F[T.id]=e;return e;});};this._getTileUiComponentContainer=function(T,r,I){var e=this,s,j,R,m,C,o,k;if(I===true){s=e.getCatalogTileTitle(T);o=e._createTileComponentData(T,true);}else{s=e.getTileTitle(T);o=e._createTileComponentData(T,false);}R=r.tileResolutionResult;if(r.isLink){j=e.getTileTarget(T);return e._createLinkInstance(s,j);}if(typeof R.tileComponentLoadInfo==="string"){if(o.properties.indicatorDataSource&&o.properties.indicatorDataSource.path){C="sap.ushell.components.tiles.cdm.applauncherdynamic";}else{C="sap.ushell.components.tiles.cdm.applauncher";}}else if(typeof R.tileComponentLoadInfo==="object"){C=R.tileComponentLoadInfo.componentName;m=R.tileComponentLoadInfo.url;if(C&&m){jQuery.sap.registerModulePath(C,m);}}if(C){var l=new sap.ui.core.ComponentContainer({component:sap.ui.getCore().createComponent({componentData:o,name:C})});k=l.getComponentInstance();if(I===true){e._mResolvedCatalogTiles[T.id].tileComponent=k;}else{e._mResolvedTiles[T.id].tileComponent=k;}return l;}return null;};this._getTileView=function(G){var e=this,T,s,o,E,D=new jQuery.Deferred();if(typeof G!=="object"||!G.id){E="Invalid input parameter passed to _getTileView: "+G;jQuery.sap.log.error(E);return D.reject(E).promise();}s=this._prepareTileHash(G);T=(G.id&&this._mResolvedTiles[G.id])||this._getTileFromHash(s);jQuery.when(T).then(function(r){if(e._mResolvedTiles.hasOwnProperty(G.id)===false){e._mResolvedTiles[G.id]=r;}try{o=e._getTileUiComponentContainer(G,r,false);}catch(j){D.reject(j.message);}D.resolve(o);});return D.promise();};this._getCatalogTileView=function(C){if(typeof C!=="object"){throw new Error(C);}return this._getTileUiComponentContainer(C,C,true);};this._createTileComponentData=function(T,I){var s=I?this.getCatalogTileTitle(T):this.getTileTitle(T),S=I?this.getCatalogTilePreviewSubtitle(T):this.getTileSubtitle(T),e=I?this.getCatalogTilePreviewIcon(T):this.getTileIcon(T),j=I?this.getCatalogTileTargetURL(T):this.getTileTarget(T),o=this.getTileIndicatorDataSource(T),C={properties:{},startupParameters:{}};if(s){C.properties.title=s;}if(S){C.properties.subTitle=S;C.properties.subtitle=S;}if(e){C.properties.icon=e;}if(j){C.properties.targetURL=j;}if(o.indicatorDataSource){C.properties.indicatorDataSource=o.indicatorDataSource;if(o.dataSource){C.properties.dataSource=o.dataSource;}}return C;};this._createLinkInstance=function(T,U){var s={text:T};if(typeof U==="string"&&U!==""){s.href=U;}else{s.enabled=false;}return new sap.m.Link(s);};this._addTileToSite=function(P,G,n,C){var e=this,D=new jQuery.Deferred(),I=sap.ushell.Container.getService("URLParsing").parseShellHash(n.properties.targetURL),T={"id":e.getTileId(n),"target":{"semanticObject":I.semanticObject,"action":I.action,"parameters":h(I.params)}};P.groups[G.identification.id].payload.tiles.push(T);C.save().done(function(){D.resolve(T);}).fail(function(m){D.reject(m);});return D.promise();};this.addTile=function(C,G){if(!G){G=_;}var D=new jQuery.Deferred(),e=this,s;var H=e.getCatalogTileTargetURL(C);var U=sap.ushell.Container.getService("URLParsing");var I=U.parseShellHash(H);var T=b({},g(I));s="Failed to add tile with id '"+T.id+"' to group with id '"+G.identification.id+"'. ";e._getTileFromHash(H).fail(function(E){e._mFailedResolvedTiles[T.id]=E;}).done(function(n){e._mResolvedTiles[T.id]=n;var o=sap.ushell.Container.getService("CommonDataModel");o.getSite().done(function(S){S.groups[G.identification.id].payload.tiles.push(T);o.save().done(function(){D.resolve(T);}).fail(function(r){D.reject(r);});}).fail(function(E){D.reject(s+E);});});return D.promise();};this.removeTile=function(G,T,I){var C,s,D=new jQuery.Deferred();if(!G||typeof G!=="object"||!G.identification||!G.identification.id||!T||typeof T!=="object"||!T.id){return D.reject({},"Failed to remove tile. No valid input parameters passed to removeTile method.").promise();}s="Failed to remove tile with id '"+T.id+"' from group with id '"+G.identification.id+"'. ";C=sap.ushell.Container.getService("CommonDataModel");C.getSite().done(function(S){var P;I=+I;try{P=S.groups[G.identification.id].payload;}catch(e){D.reject(S.groups[G.identification.id],s);}if(I>=0){P.tiles.splice(I,1);}else{P.tiles=P.tiles.filter(function(o){return o.id!==T.id;});}C.save().done(function(){D.resolve();}).fail(function(E){jQuery.sap.log.error(E);D.reject(S.groups[G.identification.id],E);});}).fail(function(e){D.reject({},s+e);});return D.promise();};this.moveTile=function(T,s,e,S,o){var D=new jQuery.Deferred(),C=sap.ushell.Container.getService("CommonDataModel"),G,j;if(!T||jQuery.isEmptyObject(T)||s===undefined||s<0||e===undefined||e<0||!S||!S.identification||!S.identification.id||!o||!o.identification||!o.identification.id){return D.reject("Invalid input parameters").promise();}j="Failed to move tile with id '"+T.id+"'. ";C.getSite().done(function(k){if(S.identification.id===o.identification.id){if(s!==e){G=k.groups[o.identification.id].payload.tiles;G.splice(s,1);G.splice(e,0,T);}else{return D.resolve(T).promise();}}else{k.groups[S.identification.id].payload.tiles.splice(s,1);k.groups[o.identification.id].payload.tiles.splice(e,0,T);}C.save().done(function(){D.resolve(T);}).fail(function(E){jQuery.sap.log.error(E);C.getSite().done(function(l){D.reject(l.groups,E);}).fail(function(l){jQuery.sap.log.error(l);D.reject([],l);});});}).fail(function(E){D.reject([],j+E);});return D.promise();};this.getCatalogs=function(){var D=new jQuery.Deferred(),C=[],o=sap.ushell.Container.getService("CommonDataModel");window.setTimeout(function(){o.getSite().done(function(s){Object.keys(s.catalogs).forEach(function(e){var j=s.catalogs[e];j.id=e;C.push(j);D.notify(j);});D.resolve(C);});},0);return D.promise();};this._isStartableInbound=function(I){if(!jQuery.sap.getObject("signature.parameters",undefined,I)){return true;}var r=Object.keys(I.signature.parameters).every(function(p){return!I.signature.parameters[p].filter||(p==="sap-external-url");});return r;};this._isHiddenInbound=function(I){return!!I.hideLauncher;};this._toHashFromInbound=function(I){var s,P,C;s={target:{semanticObject:I.semanticObject,action:I.action},params:{}};P=jQuery.sap.getObject("signature.parameters",undefined,I)||{};Object.keys(P).forEach(function(k){if(P[k].filter&&Object.prototype.hasOwnProperty.call(P[k].filter,"value")&&(P[k].filter.format===undefined||P[k].filter.format==="plain")){s.params[k]=[P[k].filter.value];}if(P[k].launcherValue&&Object.prototype.hasOwnProperty.call(P[k].launcherValue,"value")&&(P[k].launcherValue.format===undefined||P[k].launcherValue.format==="plain")){s.params[k]=[P[k].launcherValue.value];}});C=sap.ushell.Container.getService("URLParsing").constructShellHash(s);if(!C){return undefined;}return"#"+C;};this._toHashFromOutbound=function(o){var s,P,C;s={target:{semanticObject:o.semanticObject,action:o.action},params:{}};P=o.parameters||{};Object.keys(P).forEach(function(k){if(P.hasOwnProperty(k)&&P[k].value!==undefined){s.params[k]=[P[k].value];}});C=sap.ushell.Container.getService("URLParsing").constructShellHash(s);if(!C){return undefined;}return"#"+C;};this._isCustomTile=function(A){if(sap.ushell.utils.getMember(A,"sap|flp.type")==="tile"){return true;}return false;};this.getCatalogTiles=function(C){var e=this,D=new jQuery.Deferred(),o,j=[],k=[],T;if(typeof C!=="object"){return D.reject("Invalid input parameter '"+C+"' passed to getCatalogTiles.").promise();}o=sap.ushell.Container.getService("CommonDataModel");o.getSite().done(function(s){C.payload=C.payload||{};(C.payload.appDescriptors||[]).forEach(function(A){var l=s.applications[A.id];var I=e._getMember(l,"sap|app.crossNavigation.inbounds")||{},m={};Object.keys(I).forEach(function(K){var n=I[K],q=e._toHashFromInbound(n,l);if(m.hasOwnProperty(n.semanticObject+"-"+n.action)){return;}else{m[n.semanticObject+"-"+n.action]=n;}if(e._isStartableInbound(n)&&!e._isHiddenInbound(n)){if(e._mResolvedCatalogTiles){if(!e._mResolvedCatalogTiles[q]&&!e._mFailedResolvedCatalogTiles[q]){T=e._getTileFromHash(q);k.push(T);T.done(function(r){r.id=q;j.push(r);e._mResolvedCatalogTiles[q]=r;}).fail(function(E){jQuery.sap.log.error(E,"sap.ushell.adapters.cdm.LaunchPageAdapter");e._mFailedResolvedCatalogTiles[q]=E;});}else{T=new jQuery.Deferred().resolve(e._mResolvedCatalogTiles[q]).promise();k.push(T);T.done(function(r){j.push(r);});}}}});});e._allPromisesDone(k).done(function(){D.resolve(j);}).fail(function(E){if(C.identification&&C.identification.id){D.reject("Failed to deliver tiles for catalog '"+C.identification.id+"'. "+E);}});}).fail(function(E){D.reject("Failed to get site: "+E);});return D.promise();};this.getCatalogError=function(C){return undefined;};this.getCatalogId=function(C){return C.identification.id;};this.getCatalogTitle=function(C){return C.identification.title;};this._isGroupTile=function(T){return!!(T&&T.id&&T.target);};this._isCatalogTile=function(T){return!!(T&&T.id&&T.tileIntent&&T.tileResolutionResult);};this._isFailedGroupTile=function(T){return!!(T&&this._mFailedResolvedTiles&&this._mFailedResolvedTiles[T.id]);};this._isFailedCatalogTile=function(T){return!!(T&&this._mFailedResolvedCatalogTiles&&this._mFailedResolvedCatalogTiles[T.id]);};this.getCatalogTileId=function(G){if(this._isGroupTile(G)){if(this._isFailedGroupTile(G)){return undefined;}return this._mResolvedTiles[G.id].tileIntent;}if(this._isCatalogTile(G)){return G.id;}};this.getCatalogTileTitle=function(G){if(this._isGroupTile(G)){if(this._isFailedGroupTile(G)){return"";}return this._mResolvedTiles[G.id].tileResolutionResult.title;}if(this._isCatalogTile(G)){if(this._isFailedCatalogTile(G)){return undefined;}return G.tileResolutionResult.title;}};this.getCatalogTileSize=function(C){return this.getTileSize(C);};this.getCatalogTileView=function(C){return this._getCatalogTileView(C);};this.getCatalogTileTargetURL=function(G){return this.getCatalogTileId(G);};this.getCatalogTilePreviewTitle=function(C){return(C.tileResolutionResult&&C.tileResolutionResult.title)||"";};this.getCatalogTilePreviewSubtitle=function(C){return(C.tileResolutionResult&&C.tileResolutionResult.subTitle)||"";};this.getCatalogTilePreviewIcon=function(C){return(C.tileResolutionResult&&C.tileResolutionResult.icon)||"";};this.getCatalogTileKeywords=function(G){var k=[],r=G;if(!r){jQuery.sap.log.error("Could not find the Tile","sap.ushell.adapters.cdm.LaunchPageAdapter");return k;}if(this._mResolvedTiles&&this._mResolvedTiles[G.id]){r=this._mResolvedTiles[G.id];}if(r&&r.tileResolutionResult&&r.tileResolutionResult.title){k.push(r.tileResolutionResult.title);}if(r&&r.tileResolutionResult&&r.tileResolutionResult.subTitle){k.push(r.tileResolutionResult.subTitle);}return k;};this._visitBookmarks=function(U,v){var C=sap.ushell.Container;var o=C.getService("URLParsing");var e=C.getService("CommonDataModel");var r=g(o.parseShellHash(U));return e.getSite().then(function(s){var G=s.groups;var T=Object.keys(G).filter(function(k){return!G[k].payload.locked;}).map(function(k){return G[k].payload.tiles.filter(function(j){return j.isBookmark&&i(r,j.target);});}).reduce(function(A,j){Array.prototype.push.apply(A,j);return A;},[]);if(!v){return T.length;}return jQuery.when(T.map(v)).then(function(){return T.length;});});};this.addBookmark=function(P,G){var T=this;return new jQuery.Deferred(function(D){var C=sap.ushell.Container;var U=C.getService("URLParsing");var o=C.getService("CommonDataModel");jQuery.when(G||T.getDefaultGroup(),o.getSite()).done(function(G,s){var e;var I=U.parseShellHash(P.url);if(!I){D.reject("Failed to parse bookmark URL.");return;}e=c(P,g(I));s.groups[G.identification.id].payload.tiles.push(e);o.save().done(function(){D.resolve(e);}).fail(function(r){D.reject(r);});}).fail(function(r){D.reject(r);});}).promise();};this.countBookmarks=function(U){return this._visitBookmarks(U);};this.updateBookmarks=function(U,P){var C=sap.ushell.Container;var o=C.getService("URLParsing");var e=C.getService("CommonDataModel");var r=this._mResolvedTiles;function j(T){return new jQuery.Deferred(function(D){var I,n;var k;var l=false;var m=Object.create(null);if(P.url||P.url===""){I=o.parseShellHash(P.url);if(!I){D.reject("Failed to parse bookmark URL.");return;}n=g(I);}if(T.icon!==P.icon){m.icon=P.icon;l=true;}if(T.title!==P.title){m.title=P.title;l=true;}if(T.subTitle!==P.subtitle){m.subtitle=P.subtitle;l=true;}d(T,P,n);if(l&&r[T.id]){k=r[T.id].tileComponent;k.tileSetVisualProperties(m);}D.resolve(T);}).promise;}return this._visitBookmarks(U,j).then(function(k){return e.save().then(function(){return k;});});};this.deleteBookmarks=function(U){var C=sap.ushell.Container;var o=C.getService("URLParsing");var e=C.getService("CommonDataModel");var r=g(o.parseShellHash(U));return e.getSite().then(function(s){var G=s.groups;var D=Object.keys(G).map(function(k){var P=G[k].payload;var j=0;P.tiles=P.tiles.filter(function(T){if(T.isBookmark&&i(r,T.target)){++j;return false;}return true;});return j;}).reduce(function(j,k){j+=k;return j;},0);return e.save().then(function(){return D;});});};this.onCatalogTileAdded=function(T){};this._onTileSettingsSave=function(T,s){var C,U,n,N,o,O;if(T&&T.id&&s){n=s.oTitleInput.getValue();N=s.oSubTitleInput.getValue();o=this.getTileTitle(T);O=this.getTileSubtitle(T);if(o===n&&O===N){return;}C=sap.ushell.Container.getService("CommonDataModel");var e=this;C.getSite().done(function(S){if(!S.modifiedTiles){S.modifiedTiles={};}if(!S.modifiedTiles[T.id]){S.modifiedTiles[T.id]={id:T.id};}U={};if(o!==n){U.title=n;S.modifiedTiles[T.id].title=n;T.title=n;}if(O!==N){U.subtitle=N;S.modifiedTiles[T.id].subTitle=N;T.subTitle=N;}e._mResolvedTiles[T.id].tileComponent&&e._mResolvedTiles[T.id].tileComponent.tileSetVisualProperties(U);C.save().fail(function(E){jQuery.sap.log.error(E);});}).fail(function(E){jQuery.sap.log.error(E);});}};this.getTileActions=function(T){var e=[],o,m;if(this._isGroupTile(T)&&!this._isFailedGroupTile(T)){m=new sap.ui.model.json.JSONModel({config:{display_title_text:this.getTileTitle(T),display_subtitle_text:this.getTileSubtitle(T)}});o=sap.ushell.components.tiles.utilsRT.getTileSettingsAction(m,this._onTileSettingsSave.bind(this,T));e.push(o);}return e;};function c(P,T){var o=b(P,T);o.isBookmark=true;return o;}function b(P,T){var o={id:sap.ushell.utils.generateUniqueId([])};d(o,P,T);return o;}function d(T,P,o){P=jQuery.extend(true,{},P);if(o){T.target=o;}if(P.title||P.title===""){T.title=P.title;}if(P.icon||P.icon===""){T.icon=P.icon;}if(P.subtitle||P.subtitle===""){T.subTitle=P.subtitle;}if(P.dataSource){T.dataSource={};jQuery.extend(true,T.dataSource,P.dataSource);delete P.serviceUrl;}else if(P.dataSource===null){delete T.dataSource;delete T.indicatorDataSource;delete P.serviceUrl;}if((P.dataSource||T.dataSource)&&P.serviceUrlPath){T.indicatorDataSource={path:P.serviceUrlPath};}if(P.serviceUrl||P.serviceUrl===""){if(T.dataSource){jQuery.sap.log.warning("`serviceUrl` is marked for deprecation in the future."+"It is not the preferred means for defining a dynamic "+"tile's data source. Please use `oParameter.dataSource`");delete T.dataSource;}T.indicatorDataSource={path:P.serviceUrl};}else if(P.serviceUrl===null&&!T.dataSource){delete T.indicatorDataSource;}if(P.serviceRefreshInterval||P.serviceRefreshInterval===0){T.indicatorDataSource.refresh=P.serviceRefreshInterval;}}function i(T,o){if(T&&o){return T.semanticObject===o.semanticObject&&T.action===o.action&&f(T.parameters,o.parameters);}return T===o;}function f(P,o){var F,O;P=P||[];o=o||[];if(P.length===o.length){F=t(P);O=t(o);return F===O;}return false;}function t(l){return l.map(function(P){return P.name+P.value;}).sort().join();}function g(I){var T={semanticObject:I.semanticObject,action:I.action,parameters:h(I.params)};if(I.appSpecificRoute){T.appSpecificRoute=I.appSpecificRoute;}return T;}function h(I){return Object.keys(I).map(function(k){var v=I[k]&&I[k][0];return{name:k,value:v||""};});}};sap.ushell.adapters.cdm.LaunchPageAdapter.prototype._getMember=function(o,a){return sap.ushell.utils.getMember(o,a);};}());};if(!jQuery.sap.isDeclared('sap.ushell.adapters.local.ContainerAdapter')){(function(){"use strict";jQuery.sap.declare("sap.ushell.adapters.local.ContainerAdapter");sap.ushell.adapters.local.ContainerAdapter=function(s,p,a){var A,u,U,k;A=jQuery.sap.getObject("config",0,a);u={id:"DEFAULT_USER",firstName:"Default",lastName:"User",fullName:"Default User",accessibility:false,isJamActive:false,language:sap.ui.getCore().getConfiguration().getLanguage()||"en",bootTheme:{theme:"sap_belize",root:""},themeRoot:"/sap/public/bc/themes/",setAccessibilityPermitted:true,setThemePermitted:true,trackUsageAnalytics:null};for(k in A){if(A.hasOwnProperty(k)){u[k]=A[k];}}this.getSystem=function(){return s;};this.getUser=function(){return U;};this.load=function(){var b,c,o,d,D=new jQuery.Deferred();if(A&&typeof A.setUserCallback==="string"){d=new jQuery.Deferred();b=A.setUserCallback.split(".");c=b.pop();if(b.length===0){o=window;}else{o=jQuery.sap.getObject(b.join("."));}if(o&&typeof o[c]==="function"){o[c](d);}else{throw new sap.ushell.utils.Error("ContainerAdapter local platform: Cannot execute setUserCallback - "+A.setUserCallback);}d.done(function(e){["id","firstName","lastName","fullName"].forEach(function(v){if(e[v]&&typeof A.setUserCallback!=="function"){u[v]=e[v];}});U=new sap.ushell.User(u);D.resolve();});}else{U=new sap.ushell.User(u);D.resolve();}return D.promise();};this.logout=function(l){jQuery.sap.log.info("Demo system logged out: "+s.getAlias(),null,"sap.ushell.adapters.local.ContainerAdapter");sap.ushell.utils.reload();return(new jQuery.Deferred()).resolve().promise();};};}());};if(!jQuery.sap.isDeclared('sap.ushell.adapters.local.LaunchPageAdapter')){(function(){"use strict";jQuery.sap.declare("sap.ushell.adapters.local.LaunchPageAdapter");jQuery.sap.require('sap.m.Text');sap.ushell.adapters.local.LaunchPageAdapter=function(u,p,a){var c=jQuery.extend(true,[],a.config.groups),C=a.config.catalogs||[],f=0,g=10,m=10,M=10,b,d,I,h;for(I=0;I<c.length;I++){if(c[I].isDefaultGroup===true){h=c[I];break;}}if(!h&&c.length>0){h=c[0];h.isDefaultGroup=true;}this.translationBundle=sap.ushell.resources.i18n;this.TileType={Tile:"tile",Link:"link"};if(!b&&a.config.pathToLocalizedContentResources){jQuery.sap.require("sap.ui.model.resource.ResourceModel");b=new sap.ui.model.resource.ResourceModel({bundleUrl:a.config.pathToLocalizedContentResources,bundleLocale:sap.ui.getCore().getConfiguration().getLanguage()});d=b.getResourceBundle();}function _(K){if(d){return d.getText(K);}return K;}jQuery.each(C,function(i,e){if(d){e.title=_(e.title);}jQuery.each(e.tiles,function(i,t){t.getTitle=function(){return t.title;};});});jQuery.each(c,function(i,G){if(d){G.title=_(G.title);}jQuery.each(G.tiles,function(i,t){s(t,true);});});function j(){return(100*Math.random())<f;}function k(){return(100*Math.random())<g;}function l(){return m+M*Math.random();}function o(G,t){var i;for(i=0;i<G.tiles.length;i=i+1){if(t.id===G.tiles[i].id){return i;}}return-1;}function q(G,e){var i;for(i=0;i<G.length;i=i+1){if(e.id===G[i].id){return i;}}return-1;}function r(G){var D=jQuery.Deferred();window.setTimeout(function(){D.resolve(G);},l());return D.promise();}function s(t,n){if(t.tileType!=='sap.ushell.ui.tile.DynamicTile'||!t.properties||!t.properties.serviceUrl){return;}if(t.intervalTimer){clearInterval(t.intervalTimer);t.intervalTimer=undefined;}if(n){var e=t.serviceRefreshInterval;if(e){e=e*1000;}else{e=10000;}t.intervalTimer=setInterval(function(){OData.read(t.properties.serviceUrl+'?id='+t.id+'&t='+new Date().getTime(),function(R){jQuery.sap.log.debug('Dynamic tile service call succeed for tile '+t.id);},function(i){jQuery.sap.log.debug('Dynamic tile service call failed for tile '+t.id+', error message:'+i);});},e);}}this.getGroups=function(){var D=jQuery.Deferred();window.setTimeout(function(){D.resolve(c.slice(0));},l());return D.promise();};this.getDefaultGroup=function(){var D=new jQuery.Deferred();D.resolve(h);return D.promise();};this.addGroup=function(t){var D=jQuery.Deferred(),F=j(),e=this;window.setTimeout(function(){if(!F){var n={id:"group_"+c.length,title:t,tiles:[]};c.push(n);D.resolve(n);}else{e.getGroups().done(function(E){D.reject(E);}).fail(function(){D.reject();});}},l());return D.promise();};this.getGroupTitle=function(G){return G.title;};this.setGroupTitle=function(G,n){var D=jQuery.Deferred(),F=j();window.setTimeout(function(){if(!F){G.title=n;D.resolve();}else{r(G).done(function(e){D.reject(e.title);}).fail(function(){D.reject();});}},l());return D.promise();};this.getGroupId=function(G){return G.id;};this.hideGroups=function(H){if(H&&c){for(var i=0;i<c.length;i++){if(H.indexOf(c[i].id)!=-1){c[i].isVisible=false;}else{c[i].isVisible=true;}}}return jQuery.Deferred().resolve();};this.isGroupVisible=function(G){return G&&(G.isVisible===undefined?true:G.isVisible);};this.moveGroup=function(G,n){var D=jQuery.Deferred(),F=j(),t=this;window.setTimeout(function(){if(!F){c.splice(n,0,c.splice(q(c,G),1)[0]);D.resolve();}else{t.getGroups().done(function(e){D.reject(e);}).fail(function(){D.reject();});}},l());return D.promise();};this.removeGroup=function(G){var D=jQuery.Deferred(),F=j(),t=this;window.setTimeout(function(){if(!F){c.splice(q(c,G),1);jQuery.each(G.tiles,function(i,T){s(T,false);});D.resolve();}else{t.getGroups().done(function(e){D.reject(e);}).fail(function(){D.reject();});}},l());return D.promise();};this.resetGroup=function(G){var D=jQuery.Deferred(),F=j(),t=this;window.setTimeout(function(){if(!F){jQuery.each(G.tiles,function(i,T){s(T,false);});G=jQuery.extend(true,{},a.config.groups[q(a.config.groups,G)]);c.splice(q(c,G),1,G);jQuery.each(G.tiles,function(i,T){s(T,true);});D.resolve(G);}else{t.getGroups().done(function(e){D.reject(e);}).fail(function(){D.reject();});}},l());return D.promise();};this.isGroupRemovable=function(G){return G&&!G.isPreset;};this.isGroupLocked=function(G){return G.isGroupLocked;};this.getGroupTiles=function(G){return G.tiles;};this.getLinkTiles=function(G){return G.links;};this.getTileTitle=function(t){return t.title;};this.getTileType=function(t){if(t.isLink){return this.TileType.Link;}return this.TileType.Tile;};this.getTileId=function(t){return t.id;};this.getTileSize=function(t){return t.size;};this.getTileTarget=function(t){return t.target_url||"";};this.isTileIntentSupported=function(t){if(t&&t.formFactor){var e=t.formFactor;var S=sap.ui.Device.system;var i;if(S.desktop){i="Desktop";}else if(S.tablet){i="Tablet";}else if(S.phone){i="Phone";}if(e.indexOf(i)===-1){return false;}}return true;};this.getTileView=function(t){var D=jQuery.Deferred(),F=j(),e=this;if(k()){window.setTimeout(function(){if(!F){D.resolve(e._getTileView(t));}else{D.reject();}},l());}else{if(!F){D.resolve(e._getTileView(t));}else{D.reject();}}return D.promise();};this._getTileView=function(t){var E='unknown error',T,i,n=this.getTileType(t)==="link";this._translateTileProperties(t);if(t.namespace&&t.path&&t.moduleType){jQuery.sap.registerModulePath(t.namespace,t.path);if(t.moduleType==="UIComponent"){T=new sap.ui.core.ComponentContainer({component:sap.ui.getCore().createComponent({componentData:{properties:t.properties},name:t.moduleName}),height:'100%',width:'100%'});}else{T=sap.ui.view({viewName:t.moduleName,type:sap.ui.core.mvc.ViewType[t.moduleType],viewData:{properties:t.properties},height:'100%'});}return T;}else if(t.tileType){i=n?"Link":t.tileType;if(i){var v=t.properties.targetURL||t.properties.href;try{if(v){delete t.properties.targetURL;T=this._createTileInstance(t,i);if(n&&window.location.search.indexOf("new_links_container=true")===-1){T.setHref(v);if(v[0]!=='#'){T.setTarget('_blank');}}else{if(typeof(T.setTargetURL)==='function'){T.setTargetURL(v);}t.properties.targetURL=v;}}else{T=this._createTileInstance(t,i);}this._handleTilePress(T);return T;}catch(e){return new sap.m.GenericTile({header:e&&(e.name+": "+e.message)||this.translationBundle.getText("failedTileCreationMsg"),frameType:this._parseTileSizeToGenericTileFormat(t.size)});}}else{E='TileType: '+t.tileType+' not found!';}}else{E='No TileType defined!';}return new sap.m.GenericTile({header:E,frameType:this._parseTileSizeToGenericTileFormat(t.size)});};this._createTileInstance=function(t,T){var e;jQuery.sap.require('sap.m.GenericTile');switch(T){case'sap.ushell.ui.tile.DynamicTile':e=new sap.m.GenericTile({header:t.properties.title,subheader:t.properties.subtitle,frameType:this._parseTileSizeToGenericTileFormat(t.size),size:"Auto",tileContent:new sap.m.TileContent({size:"Auto",footer:t.properties.info,unit:t.properties.numberUnit,content:new sap.m.NumericContent({scale:t.properties.numberFactor,value:t.properties.numberValue,truncateValueTo:5,indicator:t.properties.stateArrow,valueColor:this._parseTileValueColor(t.properties.numberState),icon:t.properties.icon,width:"100%"})}),press:function(){this._genericTilePressHandler(t);}.bind(this)});break;case'sap.ushell.ui.tile.StaticTile':e=new sap.m.GenericTile({header:t.properties.title,subheader:t.properties.subtitle,frameType:this._parseTileSizeToGenericTileFormat(t.size),size:"Auto",tileContent:new sap.m.TileContent({size:"Auto",footer:t.properties.info,content:new sap.m.ImageContent({src:t.properties.icon,width:"100%"})}),press:function(){this._genericTilePressHandler(t);}.bind(this)});break;case'Link':if(window.location.search.indexOf("new_links_container=true")===-1){e=new sap.m.Link({text:t.properties.text});}else{e=new sap.m.GenericTile({mode:sap.m.GenericTileMode.LineMode,subheader:t.properties.text,header:t.properties.text});}break;default:jQuery.sap.require(t.tileType);var i=jQuery.sap.getObject(t.tileType);e=new i(t.properties||{});}return e;};this._genericTilePressHandler=function(t){if(t.properties.targetURL){if(t.properties.targetURL[0]==='#'){hasher.setHash(t.properties.targetURL);}else{window.open(t.properties.targetURL,'_blank');}}};this._parseTileSizeToGenericTileFormat=function(t){return t==="1x2"?"TwoByOne":"OneByOne";};this._parseTileValueColor=function(t){var e=t;switch(t){case"Positive":e="Good";break;case"Negative":e="Critical";break;}return e;};this._handleTilePress=function(t){if(typeof t.attachPress==='function'){t.attachPress(function(){if(typeof t.getTargetURL==='function'){var T=t.getTargetURL();if(T){if(T[0]==='#'){hasher.setHash(T);}else{window.open(T,'_blank');}}}});}};this._translateTileProperties=function(t){if(d){if(!t.properties.isTranslated){t.properties.title=_(t.properties.title);t.properties.subtitle=_(t.properties.subtitle);t.properties.info=_(t.properties.info);if(t.keywords){for(var e=0;e<t.keywords.length;e++){t.keywords[e]=_(t.keywords[e]);}}t.properties.isTranslated=true;}}};this.refreshTile=function(t){};this.setTileVisible=function(t,n){s(t,n);};this.addTile=function(e,G){if(!G){G=h;}var D=jQuery.Deferred(),F=j(),t=this;window.setTimeout(function(){if(!F){var n=jQuery.extend(true,{title:"A new tile was added",size:"1x1"},e,{id:"tile_0"+e.chipId});G.tiles.push(n);s(n,true);D.resolve(n);}else{t.getGroups().done(function(E){D.reject(E);}).fail(function(){D.reject();});}},l());return D.promise();};this.removeTile=function(G,t){var D=jQuery.Deferred(),F=j(),e=this;window.setTimeout(function(){if(!F){G.tiles.splice(o(G,t),1);s(t,false);D.resolve();}else{e.getGroups().done(function(E){D.reject(E);}).fail(function(){D.reject();});}},l());return D.promise();};this.moveTile=function(t,e,i,S,T){var D=jQuery.Deferred(),F=j(),n=this;window.setTimeout(function(){if(!F){if(T===undefined){T=S;}S.tiles.splice(e,1);T.tiles.splice(i,0,t);D.resolve(t);}else{n.getGroups().done(function(E){D.reject(E);}).fail(function(){D.reject();});}},l());return D.promise();};this.getTile=function(S,A){var D=jQuery.Deferred();return D.promise();};this.getCatalogs=function(){var D=jQuery.Deferred();C.forEach(function(e){window.setTimeout(function(){D.notify(e);},300);});window.setTimeout(function(){D.resolve(C);},1500);return D.promise();};this.isCatalogsValid=function(){return true;};this.getCatalogError=function(e){return;};this.getCatalogId=function(e){return e.id;};this.getCatalogTitle=function(e){return e.title;};this.getCatalogTiles=function(e){var D=jQuery.Deferred();window.setTimeout(function(){D.resolve(e.tiles);},l());return D.promise();};this.getCatalogTileId=function(e){if(e.chipId){return e.chipId;}else{return"UnknownCatalogTileId";}};this.getCatalogTileTitle=function(e){return e.title;};this.getCatalogTileSize=function(e){return e.size;};this.getCatalogTileView=function(e){return this._getTileView(e);};this.getCatalogTileTargetURL=function(e){return(e.properties&&e.properties.targetURL)||null;};this.getCatalogTilePreviewTitle=function(e){return(e.properties&&e.properties.title)||null;};this.getCatalogTilePreviewSubtitle=function(e){return(e.properties&&e.properties.subtitle)||null;};this.getCatalogTilePreviewIcon=function(e){return(e.properties&&e.properties.icon)||null;};this.getCatalogTileKeywords=function(e){return jQuery.merge([],jQuery.grep(jQuery.merge([e.title,e.properties&&e.properties.subtitle,e.properties&&e.properties.info],(e&&e.keywords)||[]),function(n,i){return n!==""&&n;}));};this.getCatalogTileTags=function(e){return(e&&e.tags)||[];};this.addBookmark=function(P,G){var G=G?G:h,D=jQuery.Deferred(),F=j(),t=this,e=P.title,i=P.subtitle,n=P.info,v=P.url;window.setTimeout(function(){if(!F){var w={title:e,size:"1x1",chipId:"tile_0"+G.tiles.length,tileType:"sap.ushell.ui.tile.StaticTile",id:"tile_0"+G.tiles.length,keywords:[],properties:{icon:"sap-icon://time-entry-request",info:n,subtitle:i,title:e,targetURL:v}};G.tiles.push(w);s(w,true);D.resolve(w);}else{t.getGroups().done(function(E){D.reject(E);}).fail(function(){D.reject();});}},l());return D.promise();};this.updateBookmarks=function(U,P){var D=new jQuery.Deferred(),G=this.getGroups();G.done(function(R){R.forEach(function(e){e.tiles.forEach(function(t){if(t.properties&&t.properties.targetURL===U){for(var i in P){if(P.hasOwnProperty(i)){t.properties[i]=P[i];}}}});});D.resolve();});G.fail(function(){D.reject();});return D.promise();};this.countBookmarks=function(U){var D=jQuery.Deferred();var i=0;var G,t,e,T;for(e=0;e<c.length;e++){G=c[e];for(T=0;T<G.tiles.length;T++){t=G.tiles[T];if(t.properties.targetURL===U){i++;}}}D.resolve(i);return D.promise();};this.onCatalogTileAdded=function(t){};this.getTileActions=function(t){return(t&&t.actions)||null;};};}());};if(!jQuery.sap.isDeclared('sap.ushell.adapters.local.PersonalizationAdapter')){(function(){"use strict";jQuery.sap.declare("sap.ushell.adapters.local.PersonalizationAdapter");var m;sap.ushell.adapters.local.PersonalizationAdapter=function(u,P,a){this._sStorageType=jQuery.sap.getObject("config.storageType",undefined,a)||sap.ushell.adapters.local.PersonalizationAdapter.prototype.constants.storage.LOCAL_STORAGE;switch(this._sStorageType){case sap.ushell.adapters.local.PersonalizationAdapter.prototype.constants.storage.LOCAL_STORAGE:jQuery.sap.require("jquery.sap.storage");break;case sap.ushell.adapters.local.PersonalizationAdapter.prototype.constants.storage.MEMORY:m=jQuery.sap.getObject("config.personalizationData",undefined,a)||{};break;default:throw new sap.ushell.utils.Error("Personalization Adapter Local Platform: unsupported storage type '"+this._sStorageType+"'");}};sap.ushell.adapters.local.PersonalizationAdapter.prototype.constants={"storage":{"MEMORY":"MEMORY","LOCAL_STORAGE":"LOCAL_STORAGE"}};sap.ushell.adapters.local.PersonalizationAdapter.prototype.getAdapterContainer=function(C){return new sap.ushell.adapters.local.AdapterContainer(C,this._sStorageType);};sap.ushell.adapters.local.PersonalizationAdapter.prototype.delAdapterContainer=function(C){return this.getAdapterContainer(C).del();};sap.ushell.adapters.local.AdapterContainer=function(C,S){this._sContainerKey=C;this._sStorageType=S;this._oItemMap=new sap.ushell.utils.Map();};function g(){return jQuery.sap.storage(jQuery.sap.storage.Type.local,"com.sap.ushell.adapters.sandbox.Personalization");}function p(j){try{return JSON.parse(j);}catch(e){return undefined;}}function s(j){return JSON.stringify(j);}function c(j){if(j===undefined){return undefined;}try{return JSON.parse(JSON.stringify(j));}catch(e){return undefined;}}sap.ushell.adapters.local.AdapterContainer.prototype.load=function(){var d=new jQuery.Deferred(),l,i,t=this;switch(this._sStorageType){case sap.ushell.adapters.local.PersonalizationAdapter.prototype.constants.storage.LOCAL_STORAGE:l=g();setTimeout(function(){i=l.get(t._sContainerKey);t._oItemMap.entries=p(i)||{};d.resolve(t);},0);break;case sap.ushell.adapters.local.PersonalizationAdapter.prototype.constants.storage.MEMORY:setTimeout(function(){t._oItemMap.entries=c(m[t._sContainerKey])||{};d.resolve(t);},0);break;default:setTimeout(function(){d.reject("unknown storage type");},0);}return d.promise();};sap.ushell.adapters.local.AdapterContainer.prototype.save=function(){var d=new jQuery.Deferred(),l,i,t=this;switch(this._sStorageType){case sap.ushell.adapters.local.PersonalizationAdapter.prototype.constants.storage.LOCAL_STORAGE:l=g();setTimeout(function(){i=s(t._oItemMap.entries);l.put(t._sContainerKey,i);d.resolve();},0);break;case sap.ushell.adapters.local.PersonalizationAdapter.prototype.constants.storage.MEMORY:setTimeout(function(){m[t._sContainerKey]=c(t._oItemMap.entries);d.resolve();},0);break;default:setTimeout(function(){d.reject("unknown storage type");},0);}return d.promise();};sap.ushell.adapters.local.AdapterContainer.prototype.del=function(){var d=new jQuery.Deferred(),l,t=this;switch(this._sStorageType){case sap.ushell.adapters.local.PersonalizationAdapter.prototype.constants.storage.LOCAL_STORAGE:l=g();setTimeout(function(){l.remove(t._sContainerKey);t._oItemMap.entries={};d.resolve();},0);break;case sap.ushell.adapters.local.PersonalizationAdapter.prototype.constants.storage.MEMORY:setTimeout(function(){if(m&&m[t._sContainerKey]){delete m[t._sContainerKey];}t._oItemMap.entries={};d.resolve();},0);break;default:setTimeout(function(){d.reject("unknown storage type");},0);}return d.promise();};sap.ushell.adapters.local.AdapterContainer.prototype.getItemKeys=function(){return this._oItemMap.keys();};sap.ushell.adapters.local.AdapterContainer.prototype.containsItem=function(i){return this._oItemMap.containsKey(i);};sap.ushell.adapters.local.AdapterContainer.prototype.getItemValue=function(i){return this._oItemMap.get(i);};sap.ushell.adapters.local.AdapterContainer.prototype.setItemValue=function(i,I){this._oItemMap.put(i,I);};sap.ushell.adapters.local.AdapterContainer.prototype.delItem=function(i){this._oItemMap.remove(i);};}());};if(!jQuery.sap.isDeclared('sap.ushell.components.container.ApplicationContainer')){(function(){"use strict";var p="sap.ushell.components.container.",c=p+"ApplicationContainer",d="sap.ushell.Container.dirtyState.",l,r,f=true;jQuery.sap.declare("sap.ushell.components.container.ApplicationContainer");jQuery.sap.require('sap.ui.core.UIComponent');jQuery.sap.require('sap.m.MessagePopover');function a(T){var e=sap.ushell.Container.getService("CrossApplicationNavigation");e.isUrlSupported(T.url).done(function(){T.promise.resolve({"allowed":true,"id":T.id});}).fail(function(){T.promise.resolve({"allowed":false,"id":T.id});});}l=new sap.ushell.utils.Map();sap.ushell.components.container.ApplicationType={URL:"URL",WDA:"WDA",NWBC:"NWBC",TR:"TR"};function g(e){return l.get(e.getId());}function b(U){var P=jQuery.sap.getUriParameters(U).mParams,e=P["sap-xapp-state"],R;delete P["sap-xapp-state"];R={startupParameters:P};if(e){R["sap-xapp-state"]=e;}return R;}function h(K,e){if(!r){r=jQuery.sap.resources({url:jQuery.sap.getModulePath(p)+"/resources/resources.properties",language:sap.ui.getCore().getConfiguration().getLanguage()});}return r.getText(K,e);}function i(){return new sap.ui.core.Icon({size:"2rem",src:"sap-icon://error",tooltip:sap.ushell.components.container.ApplicationContainer.prototype._getTranslatedText("an_error_has_occured")});}function j(e){var D=e.getAggregation("child"),E;if(D instanceof sap.ui.core.ComponentContainer){E=D.getComponentInstance().getMetadata().getName().replace(/\.Component$/,"");jQuery.sap.log.debug("unloading component "+E,null,c);}e.destroyAggregation("child");}function k(e,U,D){var E,F,I,L,M,G,N,V={},H,J;I=U.indexOf("?");if(I>=0){G=sap.ushell.components.container.ApplicationContainer.prototype._getParameterMap(U);V=G.startupParameters;U=U.slice(0,I);}if(U.slice(-1)!=='/'){U+='/';}if(/\.view\.(\w+)$/i.test(D)){M=/^SAPUI5=(?:([^\/]+)\/)?([^\/]+)\.view\.(\w+)$/i.exec(D);if(!M){jQuery.sap.log.error("Invalid SAPUI5 URL",D,c);return sap.ushell.components.container.ApplicationContainer.prototype._createErrorControl();}N=M[1];H=M[2];J=M[3].toUpperCase();if(N){H=N+"."+H;}else{L=H.lastIndexOf(".");if(L<1){jQuery.sap.log.error("Missing namespace",D,c);return sap.ushell.components.container.ApplicationContainer.prototype._createErrorControl();}N=H.slice(0,L);}}else{N=D.replace(/^SAPUI5=/,"");}jQuery.sap.registerModulePath(N,U+N.replace(/\./g,'/'));sap.ushell.components.container.ApplicationContainer.prototype._destroyChild(e);if(H){if(e.getApplicationConfiguration()){V.config=e.getApplicationConfiguration();}F=sap.ui.view({id:e.getId()+"-content",type:J,viewData:V||{},viewName:H});e.fireEvent("applicationConfiguration");}else{jQuery.sap.log.debug("loading component "+N,null,c);var K=G?{startupParameters:G.startupParameters}:{startupParameters:{}};if(G&&G["sap-xapp-state"]){K["sap-xapp-state"]=G["sap-xapp-state"];}if(e.getApplicationConfiguration()){K.config=e.getApplicationConfiguration();}E=sap.ui.component({id:e.getId()+"-component",componentData:K,name:N});e.fireEvent("applicationConfiguration",{"configuration":E.getMetadata().getConfig()});F=new sap.ui.core.ComponentContainer({id:e.getId()+"-content",component:E});}F.setWidth(e.getWidth());F.setHeight(e.getHeight());F.addStyleClass("sapUShellApplicationContainer");e.setAggregation("child",F,true);return F;}function m(e,D){setTimeout(function(){sap.ui.getCore().getEventBus().publish("sap.ushell.components.container.ApplicationContainer",e,D);},0);}function n(e,U,D){var I,E,F,G,H={startupParameters:{}},J,K=e.getComponentHandle(),P=sap.ushell.Container.getService("PluginManager"),L,M;sap.ushell.utils.addTime("createUi5Component");I=U.indexOf("?");if(I>=0){G=sap.ushell.components.container.ApplicationContainer.prototype._getParameterMap(U);H={startupParameters:G.startupParameters};if(G["sap-xapp-state"]){H["sap-xapp-state"]=G["sap-xapp-state"];}U=U.slice(0,I);}if(e.getApplicationConfiguration()){H.config=e.getApplicationConfiguration();}if(U.slice(-1)!=='/'){U+='/';}jQuery.sap.registerModulePath(D,U);jQuery.sap.require("sap.ushell.services.CrossApplicationNavigation");sap.ushell.components.container.ApplicationContainer.prototype._destroyChild(e);J={id:e.getId()+"-component",name:D,componentData:H};jQuery.sap.log.debug("Creating component instance for "+D,JSON.stringify(J),c);sap.ui.getCore().getEventBus().publish("sap.ushell.components.container.ApplicationContainer","_prior.newUI5ComponentInstantion",{name:D});if(K){E=K.getInstance(J);}else{jQuery.sap.log.error("No component handle available for '"+D+"'; fallback to component.load()",null,c);E=sap.ui.component({id:e.getId()+"-component",name:D,componentData:H});}e.fireEvent("applicationConfiguration",{"configuration":E.getMetadata().getConfig()});F=new sap.ui.core.ComponentContainer({id:e.getId()+"-content",component:E});F.setHeight(e.getHeight());F.setWidth(e.getWidth());F.addStyleClass("sapUShellApplicationContainer");e._disableRouterEventHandler=sap.ushell.components.container.ApplicationContainer.prototype._disableRouter.bind(this,E);sap.ui.getCore().getEventBus().subscribe("sap.ushell.components.container.ApplicationContainer","_prior.newUI5ComponentInstantion",e._disableRouterEventHandler);e.setAggregation("child",F,true);if(P){L=P.getPluginLoadingPromise("RendererExtensions");M=L&&L.state();if(M==="pending"){L.done(function(){sap.ushell.components.container.ApplicationContainer.prototype._publishExternalEvent("componentCreated",{component:E});}).fail(function(){sap.ushell.components.container.ApplicationContainer.prototype._publishExternalEvent("componentCreated",{component:E});});}if(M==="resolved"||M==="rejected"){sap.ushell.components.container.ApplicationContainer.prototype._publishExternalEvent("componentCreated",{component:E});}}sap.ushell.components.container.ApplicationContainer.prototype._publishExternalEvent("componentCreated",{component:E});return F;}function o(e){var D;if((e instanceof sap.ui.core.Component)&&(typeof e.getRouter==="function")){D=e.getRouter();if(D&&(typeof D.stop==="function")){jQuery.sap.log.info("router stopped for instance "+e.getId());D.stop();}}}function q(U){var e=document.createElement("a"),D=jQuery.sap.getUriParameters(U).get("sap-client"),E;e.href=U;E=e.protocol+"//"+e.host;return new sap.ushell.System({alias:D?E+"?sap-client="+D:E,baseUrl:E,client:D||undefined,platform:"abap"});}function s(e,M){var T=false,D=e.getDomRef(),E=e.getApplicationType(),U,O;if(D){if(sap.ushell.utils.isApplicationTypeNWBCRelated(E)){U=URI(D.src);O=U.protocol()+"://"+U.host();T=(M.source===D.contentWindow)||(M.origin===O);}else if(E===sap.ushell.components.container.ApplicationType.URL){U=URI();O=U.protocol()+"://"+U.host();T=(M.origin===O);}}return T;}function t(S,e,O){var R=JSON.stringify({type:"request",service:e,request_id:jQuery.sap.uid(),body:{}});jQuery.sap.log.debug("Sending post message request to origin ' "+O+"': "+R,null,"sap.ushell.components.container.ApplicationContainer");S.postMessage(R,O);}function u(e,M,D){var P=jQuery.sap.getObject("sap-ushell-config.services.PostMessage.config",0),S=D&&D.service,E;jQuery.sap.log.debug("Received post message request from origin '"+M.origin+"': "+JSON.stringify(D),null,"sap.ushell.components.container.ApplicationContainer");if(D.type!=="request"||!S||(S.indexOf("sap.ushell.services.CrossApplicationNavigation")!==0&&S.indexOf("sap.ushell.CrossApplicationNavigation")!==0&&S.indexOf("sap.ushell.ui5service.ShellUIService")!==0)){return;}E=S.split(".")[3];if(P&&P.enabled===false){jQuery.sap.log.warning("Received message for "+E+", but this "+"feature is disabled. It can be enabled via launchpad configuration "+"property 'services.PostMessage.config.enabled: true'",undefined,"sap.ushell.components.container.ApplicationContainer");return;}if(!sap.ushell.components.container.ApplicationContainer.prototype._isTrustedPostMessageSource(e,M)){jQuery.sap.log.warning("Received message from untrusted origin '"+M.origin+"': "+JSON.stringify(M.data),null,"sap.ushell.components.container.ApplicationContainer");return;}function F(J,K){var R=JSON.stringify({type:"response",service:D.service,request_id:D.request_id,status:J,body:K});jQuery.sap.log.debug("Sending post message response to origin ' "+M.origin+"': "+R,null,"sap.ushell.components.container.ApplicationContainer");M.source.postMessage(R,M.origin);}function G(M,D){var J=new jQuery.Deferred(),K;if(D.body&&D.body.callbackMessage&&D.body.callbackMessage.service){K=sap.ushell.components.container.ApplicationContainer.prototype._backButtonPressedCallback.bind(null,M.source,D.body.callbackMessage.service,M.origin);}J.resolve(e.getShellUIService().setBackNavigation(K));return J.promise();}function H(E){switch(E){case"sap.ushell.services.CrossApplicationNavigation.hrefForExternal":return new jQuery.Deferred().resolve(sap.ushell.Container.getService("CrossApplicationNavigation").hrefForExternal(D.body.oArgs)).promise();case"sap.ushell.services.CrossApplicationNavigation.getSemanticObjectLinks":return sap.ushell.Container.getService("CrossApplicationNavigation").getSemanticObjectLinks(D.body.sSemanticObject,D.body.mParameters,D.body.bIgnoreFormFactors,undefined,undefined,D.body.bCompactIntents);case"sap.ushell.services.CrossApplicationNavigation.isIntentSupported":return sap.ushell.Container.getService("CrossApplicationNavigation").isIntentSupported(D.body.aIntents);case"sap.ushell.services.CrossApplicationNavigation.isNavigationSupported":return sap.ushell.Container.getService("CrossApplicationNavigation").isNavigationSupported(D.body.aIntents);case"sap.ushell.services.CrossApplicationNavigation.toExternal":return new jQuery.Deferred().resolve(sap.ushell.Container.getService("CrossApplicationNavigation").toExternal(D.body.oArgs)).promise();case"sap.ushell.CrossApplicationNavigation.backToPreviousApp":sap.ushell.Container.getService("CrossApplicationNavigation").backToPreviousApp();return new jQuery.Deferred().resolve().promise();case"sap.ushell.services.CrossApplicationNavigation.backToPreviousApp":sap.ushell.Container.getService("CrossApplicationNavigation").backToPreviousApp();return new jQuery.Deferred().resolve().promise();case"sap.ushell.services.CrossApplicationNavigation.getAppStateData":return sap.ushell.Container.getService("CrossApplicationNavigation").getAppStateData(D.body.sAppStateKey);case"sap.ushell.ui5service.ShellUIService.setTitle":return new jQuery.Deferred().resolve(e.getShellUIService().setTitle(D.body.sTitle)).promise();case"sap.ushell.ui5service.ShellUIService.setBackNavigation":return G(M,D);default:return undefined;}}try{H(D.service).done(function(R){F("success",{result:R});}).fail(function(J){F("error",{message:J});});}catch(I){F("error",{message:I.message});}}function v(D,M){var E=M.data;if(typeof E==="string"){try{E=JSON.parse(M.data);}catch(e){jQuery.sap.log.debug("Message received from origin '"+M.origin+"' cannot be parsed: "+e,E,"sap.ushell.components.container.ApplicationContainer");return;}}if(E.action==="pro54_setGlobalDirty"&&localStorage.getItem(D.globalDirtyStorageKey)===sap.ushell.Container.DirtyState.PENDING){if(!sap.ushell.components.container.ApplicationContainer.prototype._isTrustedPostMessageSource(D,M)){jQuery.sap.log.warning("Received message from untrusted origin: "+M.origin,E,"sap.ushell.components.container.ApplicationContainer");return;}jQuery.sap.log.debug("getGlobalDirty() pro54_setGlobalDirty SetItem key:"+D.globalDirtyStorageKey+" value: "+E.parameters.globalDirty,null,"sap.ushell.components.container.ApplicationContainer");sap.ushell.utils.localStorageSetItem(D.globalDirtyStorageKey,E.parameters.globalDirty,true);}else{sap.ushell.components.container.ApplicationContainer.prototype._handleServiceMessageEvent(D,M,E);}}function w(e,E){var I=e.getDomRef(),D=e.getApplicationType();if(sap.ushell.utils.isApplicationTypeNWBCRelated(e.getApplicationType(D))&&I&&I.tagName==="IFRAME"){I.contentWindow.postMessage(JSON.stringify({action:"pro54_disableDirtyHandler"}),'*');E.preventDefault();}}function x(R,e,D){R.write("<div").writeControlData(e).writeAccessibilityState(e).addClass("sapUShellApplicationContainer").writeClasses(e).addStyle("height",e.getHeight()).addStyle("width",e.getWidth()).writeStyles().write(">").renderControl(D);R.write("</div>");}function y(U,D){var E=D==="TR"?"":"-NWBC";var V,F=function(){var V,M;try{V=sap.ui.getVersionInfo().version;}catch(e){jQuery.sap.log.error("sap ui version could not be determined, using sap.ui.version (core version) as fallback "+e);V=window.sap&&sap.ui&&sap.ui.version;}M=/\d+\.\d+\.\d+/.exec(V);if(M&&M[0]){V=M[0];}else{V=undefined;}return V;};V=F();if(V){U+=U.indexOf("?")>=0?"&":"?";U+="sap-shell="+encodeURIComponent("FLP"+V+E);}return U;}function z(U,e){var T,D=function(){var F=sap.ushell.utils.getParameterValueBoolean("sap-accessibility");if(F!==undefined){return F;}return sap.ushell.Container.getUser().getAccessibilityMode();},E=function(){var F=false,R=jQuery.sap.getUriParameters(U)||{mParams:{}};F=sap.ui.getCore().getConfiguration().getStatistics()&&!R.mParams.hasOwnProperty("sap-statistics");return F;};U+=U.indexOf("?")>=0?"&":"?";U+="sap-ie=edge";T=sap.ushell.Container.getUser().getTheme(sap.ushell.User.prototype.constants.themeFormat.NWBC);if(T){U+=U.indexOf("?")>=0?"&":"?";U+="sap-theme="+encodeURIComponent(T);}if(D()){U+=U.indexOf("?")>=0?"&":"?";U+="sap-accessibility=X";}if(E()){U+=U.indexOf("?")>=0?"&":"?";U+="sap-statistics=true";}return y(U,e);}function A(R,e,U,D){var E=e.getAggregation("child");if(!E||e._bRecreateChild){E=sap.ushell.components.container.ApplicationContainer.prototype._createUi5Component(e,U,D);e._bRecreateChild=false;}sap.ushell.components.container.ApplicationContainer.prototype._renderControlInDiv(R,e,E);}function B(e,K,V){var O=e.getProperty(K);if(jQuery.sap.equal(O,V)){return;}e.setProperty(K,V);e._bRecreateChild=true;}function C(R,e,D,U,E){var L;localStorage.removeItem(e.globalDirtyStorageKey);if(E&&E.indexOf("SAPUI5.Component=")===0&&D===sap.ushell.components.container.ApplicationType.URL){A(R,e,U,E.replace(/^SAPUI5\.Component=/,""));return;}if(E&&E.indexOf("SAPUI5=")===0&&D===sap.ushell.components.container.ApplicationType.URL){sap.ushell.components.container.ApplicationContainer.prototype._renderControlInDiv(R,e,sap.ushell.components.container.ApplicationContainer.prototype._createUi5View(e,U,E));return;}jQuery.sap.log.debug("Not resolved as \"SAPUI5.Component=\" or \"SAPUI5=\" , "+"will attempt to load into iframe "+E);try{U=e.getFrameSource(D,U,E);}catch(F){jQuery.sap.log.error(F.message||F,null,c);e.fireEvent("applicationConfiguration");R.renderControl(sap.ushell.components.container.ApplicationContainer.prototype._createErrorControl());return;}if(sap.ushell.Container){L=sap.ushell.components.container.ApplicationContainer.prototype._getLogoutHandler(e);if(!L){if(sap.ushell.utils.isApplicationTypeNWBCRelated(D)){L=sap.ushell.components.container.ApplicationContainer.prototype._logout.bind(null,e);l.put(e.getId(),L);sap.ushell.Container.attachLogoutEvent(L);sap.ushell.Container.addRemoteSystem(sap.ushell.components.container.ApplicationContainer.prototype._createSystemForUrl(U));}}else{if(!sap.ushell.utils.isApplicationTypeNWBCRelated(D)){sap.ushell.Container.detachLogoutEvent(L);l.remove(e.getId());}}}if(sap.ushell.utils.isApplicationTypeNWBCRelated(D)){U=sap.ushell.components.container.ApplicationContainer.prototype._adjustNwbcUrl(U,D);sap.ushell.utils.localStorageSetItem(e.globalDirtyStorageKey,sap.ushell.Container.DirtyState.INITIAL);}e.fireEvent("applicationConfiguration");R.write("<iframe").writeControlData(e).writeAccessibilityState(e).writeAttributeEscaped("src",U).addClass("sapUShellApplicationContainer").writeClasses(e).addStyle("height",e.getHeight()).addStyle("width",e.getWidth()).writeStyles().write("></iframe>");}sap.ui.core.Control.extend(c,{metadata:{properties:{additionalInformation:{defaultValue:"",type:"string"},application:{type:"object"},applicationConfiguration:{type:"object"},applicationType:{defaultValue:"URL",type:p+"ApplicationType"},height:{defaultValue:"100%",type:"sap.ui.core.CSSSize"},navigationMode:{defaultValue:"",type:"string"},text:{defaultValue:"",type:"string"},url:{defaultValue:"",type:"string"},visible:{defaultValue:true,type:"boolean"},"sap-system":{defaultValue:undefined,type:"string"},applicationDependencies:{type:"object"},componentHandle:{type:"object"},ui5ComponentName:{type:"string"},width:{defaultValue:"100%",type:"sap.ui.core.CSSSize"},shellUIService:{type:"object"}},events:{"applicationConfiguration":{}},aggregations:{child:{multiple:false,type:"sap.ui.core.Control",visibility:"hidden"}},library:"sap.ushell"},exit:function(){var L,e=this;if(sap.ushell.Container){L=sap.ushell.components.container.ApplicationContainer.prototype._getLogoutHandler(e);if(L){sap.ushell.Container.detachLogoutEvent(L);l.remove(e.getId());}}localStorage.removeItem(e.globalDirtyStorageKey);if(e._unloadEventListener){removeEventListener("unload",e._unloadEventListener);}if(e._disableRouterEventHandler){sap.ui.getCore().getEventBus().unsubscribe("sap.ushell.components.container.ApplicationContainer","_prior.newUI5ComponentInstantion",e._disableRouterEventHandler);}if(e._storageEventListener){removeEventListener("storage",e._storageEventListener);}if(e._messageEventListener){removeEventListener("message",e._messageEventListener);}sap.ushell.components.container.ApplicationContainer.prototype._destroyChild(e);if(sap.ui.core.Control.exit){sap.ui.core.Control.exit.apply(e);}},init:function(){var e=this;e.globalDirtyStorageKey=d+jQuery.sap.uid();e._unloadEventListener=e.exit.bind(e);addEventListener("unload",e._unloadEventListener);e._storageEventListener=function(S){var D=e.getApplicationType();if(S.key===e.globalDirtyStorageKey&&S.newValue===sap.ushell.Container.DirtyState.PENDING&&sap.ushell.utils.isApplicationTypeNWBCRelated(D)){var I=e.getDomRef();if(I&&I.tagName==="IFRAME"){jQuery.sap.log.debug("getGlobalDirty() send pro54_getGlobalDirty ",null,"sap.ushell.components.container.ApplicationContainer");I.contentWindow.postMessage(JSON.stringify({action:"pro54_getGlobalDirty"}),'*');}}};addEventListener('storage',e._storageEventListener);e._messageEventListener=sap.ushell.components.container.ApplicationContainer.prototype._handleMessageEvent.bind(null,e);addEventListener('message',e._messageEventListener);if(f){var M={"asyncURLHandler":sap.ushell.components.container.ApplicationContainer.prototype._adaptIsUrlSupportedResultForMessagePopover};if(sap.m.MessagePopover&&sap.m.MessagePopover.setDefaultHandlers){sap.m.MessagePopover.setDefaultHandlers(M);}f=false;}},renderer:function(R,e){var D=e.getApplication(),L=e.launchpadData,E;if(!e.getVisible()){sap.ushell.components.container.ApplicationContainer.prototype._renderControlInDiv(R,e);return;}if(e.error){delete e.error;sap.ushell.components.container.ApplicationContainer.prototype._renderControlInDiv(R,e,sap.ushell.components.container.ApplicationContainer.prototype._createErrorControl());}else if(!D){sap.ushell.components.container.ApplicationContainer.prototype._render(R,e,e.getApplicationType(),e.getUrl(),e.getAdditionalInformation());}else if(!D.isResolvable()){sap.ushell.components.container.ApplicationContainer.prototype._render(R,e,D.getType(),D.getUrl(),"");}else if(L){sap.ushell.components.container.ApplicationContainer.prototype._render(R,e,L.applicationType,L.Absolute.url.replace(/\?$/,""),L.applicationData);}else{jQuery.sap.log.debug("Resolving "+D.getUrl(),null,c);D.resolve(function(F){jQuery.sap.log.debug("Resolved "+D.getUrl(),JSON.stringify(F),c);e.launchpadData=F;sap.ushell.components.container.ApplicationContainer.prototype._destroyChild(e);},function(F){var G=D.getMenu().getDefaultErrorHandler();if(G){G(F);}sap.ushell.components.container.ApplicationContainer.prototype._destroyChild(e);e.error=F;});E=new sap.m.Text({text:sap.ushell.components.container.ApplicationContainer.prototype._getTranslatedText("loading",[D.getText()])});sap.ushell.components.container.ApplicationContainer.prototype._destroyChild(e);e.setAggregation("child",E);sap.ushell.components.container.ApplicationContainer.prototype._renderControlInDiv(R,e,E);}}});sap.ushell.components.container.ApplicationContainer.prototype.getFrameSource=function(e,U,D){if(!Object.prototype.hasOwnProperty.call(sap.ushell.components.container.ApplicationType,e)){throw new Error("Illegal application type: "+e);}return U;};sap.ushell.components.container.ApplicationContainer.prototype.setUrl=function(V){B(this,"url",V);};sap.ushell.components.container.ApplicationContainer.prototype.setAdditionalInformation=function(V){B(this,"additionalInformation",V);};sap.ushell.components.container.ApplicationContainer.prototype.setApplicationType=function(V){B(this,"applicationType",V);};sap.ushell.components.container.ApplicationContainer.prototype._adaptIsUrlSupportedResultForMessagePopover=a;sap.ushell.components.container.ApplicationContainer.prototype._getLogoutHandler=g;sap.ushell.components.container.ApplicationContainer.prototype._getParameterMap=b;sap.ushell.components.container.ApplicationContainer.prototype._getTranslatedText=h;sap.ushell.components.container.ApplicationContainer.prototype._createErrorControl=i;sap.ushell.components.container.ApplicationContainer.prototype._destroyChild=j;sap.ushell.components.container.ApplicationContainer.prototype._createUi5View=k;sap.ushell.components.container.ApplicationContainer.prototype._publishExternalEvent=m;sap.ushell.components.container.ApplicationContainer.prototype._createUi5Component=n;sap.ushell.components.container.ApplicationContainer.prototype._disableRouter=o;sap.ushell.components.container.ApplicationContainer.prototype._createSystemForUrl=q;sap.ushell.components.container.ApplicationContainer.prototype._isTrustedPostMessageSource=s;sap.ushell.components.container.ApplicationContainer.prototype._handleServiceMessageEvent=u;sap.ushell.components.container.ApplicationContainer.prototype._handleMessageEvent=v;sap.ushell.components.container.ApplicationContainer.prototype._logout=w;sap.ushell.components.container.ApplicationContainer.prototype._renderControlInDiv=x;sap.ushell.components.container.ApplicationContainer.prototype._adjustNwbcUrl=z;sap.ushell.components.container.ApplicationContainer.prototype._render=C;sap.ushell.components.container.ApplicationContainer.prototype._backButtonPressedCallback=t;}());};if(!jQuery.sap.isDeclared('sap.ushell.components.factsheet.controls.PictureTile')){jQuery.sap.declare("sap.ushell.components.factsheet.controls.PictureTile");jQuery.sap.require('sap.m.CustomTile');sap.m.CustomTile.extend("sap.ushell.components.factsheet.controls.PictureTile",{metadata:{deprecated:true,library:"sap.ushell",properties:{"height":{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:'32px'},"width":{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:'32px'}},associations:{"tileContent":{type:"sap.ushell.components.factsheet.controls.PictureViewerItem",multiple:false}},events:{"pictureDelete":{}}}});sap.ushell.components.factsheet.controls.PictureTile.M_EVENTS={'pictureDelete':'pictureDelete'};sap.ushell.components.factsheet.controls.PictureTile.prototype.init=function(t){this._oDeletePictureButton=new sap.m.Button({icon:"sap-icon://sys-cancel",press:jQuery.proxy(this._deletePictureRequestHandler,this),type:sap.m.ButtonType.Transparent}).addStyleClass("sapCaUiPTDeleteButton");if(!sap.ui.Device.system.desktop){this.attachPress(this._tilePressedHandler);this.attachBrowserEvent("swipe",jQuery.proxy(this._tileSwipedHandler,this));this._oDeletePictureButton.addStyleClass("hide");}};sap.ushell.components.factsheet.controls.PictureTile.prototype.setTileContent=function(t){this.setContent(null);if(t){var i=t.getImage();this.setContent(i);}else{this.setContent(null);}this.setAssociation("tileContent",t);};sap.ushell.components.factsheet.controls.PictureTile.prototype.setSize=function(w,h){this._width=w;this._height=h;var $=this.$();if($){$.css({width:w+"px",height:h+"px"});jQuery.sap.byId(this.getId()+"-wrapper").addClass("sapCaUiPTWrapper");}};sap.ushell.components.factsheet.controls.PictureTile.prototype._tilePressedHandler=function(e){this.switchVisibility();};sap.ushell.components.factsheet.controls.PictureTile.prototype.switchVisibility=function(v){var $=this._oDeletePictureButton.$();if(v===undefined){$.toggleClass("hide");}else{$.toggleClass("hide",!v);}};sap.ushell.components.factsheet.controls.PictureTile.prototype._tileSwipedHandler=function(e){var $=this._oDeletePictureButton.$();if($&&!$.hasClass("hide")){$.addClass("hide");}};sap.ushell.components.factsheet.controls.PictureTile.prototype._deletePictureRequestHandler=function(){this.firePictureDelete();};};if(!jQuery.sap.isDeclared('sap.ushell.components.factsheet.controls.PictureViewer')){jQuery.sap.declare("sap.ushell.components.factsheet.controls.PictureViewer");jQuery.sap.require('sap.m.TileContainer');sap.m.TileContainer.extend("sap.ushell.components.factsheet.controls.PictureViewer",{metadata:{deprecated:true,library:"sap.ushell",properties:{"tileScaling":{type:"float",group:"Misc",defaultValue:0.95},"removable":{type:"boolean",group:"Misc",defaultValue:false}},defaultAggregation:"items",aggregations:{"items":{type:"sap.ushell.components.factsheet.controls.PictureViewerItem",multiple:true,singularName:"item"}},events:{"pictureDeleted":{}}}});sap.ushell.components.factsheet.controls.PictureViewer.M_EVENTS={'pictureDeleted':'pictureDeleted'};jQuery.sap.declare("sap.ushell.components.factsheet.controls.PictureViewer");jQuery.sap.require('sap.ui.core.ResizeHandler');jQuery.sap.require('sap.m.TileContainer');sap.ushell.components.factsheet.controls.PictureViewer.prototype.init=function(){sap.m.TileContainer.prototype.init.apply(this);this.setEditable(false);if(sap.ui.getCore().isMobile()){jQuery(window).bind("tap",jQuery.proxy(this._reset,this));var s=sap.ui.getCore().getStaticAreaRef();this.$blocker=jQuery("<div class='sapCaPVBly sapUiBLy'></div>").css("visibility","hidden");jQuery(s).append(this.$blocker);}if(!sap.ui.getCore().isMobile()){jQuery(window).bind("resize",jQuery.proxy(this._resize,this));}this.addStyleClass("sapCaPW");this.addStyleClass("sapCaPWRendering");};sap.ushell.components.factsheet.controls.PictureViewer.prototype._resize=function(){if(this._oDragSession){return;}setTimeout(jQuery.proxy(function(){this._applyDimension();this._update(false);delete this._iInitialResizeTimeout;},this),this._iInitialResizeTimeout);this._iInitialResizeTimeout=0;};sap.ushell.components.factsheet.controls.PictureViewer.prototype.exit=function(){this.$blocker.remove();if(!sap.ui.getCore().isMobile()){jQuery(window).unbind("resize",jQuery.proxy(this._resize,this));}sap.m.TileContainer.prototype.exit.apply(this);if(!sap.ui.Device.system.desktop){jQuery(window).unbind("tap",jQuery.proxy(this._reset,this));}};sap.ushell.components.factsheet.controls.PictureViewer.prototype.setTileScaling=function(t){if(t<0||t>1){t=0.75;jQuery.sap.log.error("Tile Scaling should be a float value between 0 and 1 and not "+t+". Setting it to 0.75 by default.");}this.setProperty('tileScaling',t);};sap.ushell.components.factsheet.controls.PictureViewer.prototype.addItem=function(i){this.insertItem(i,this.getItems().length);};sap.ushell.components.factsheet.controls.PictureViewer.prototype.insertItem=function(i,I){var t=new sap.ushell.components.factsheet.controls.PictureTile({tileContent:i});t.attachPictureDelete(jQuery.proxy(this._deletePictureRequestHandler,this));this.insertTile(t,I);this.insertAggregation("items",i,I);return this;};sap.ushell.components.factsheet.controls.PictureViewer.prototype.insertTile=function(t,i){t.attachPictureDelete(jQuery.proxy(this._deletePictureRequestHandler,this));sap.m.TileContainer.prototype.insertTile.apply(this,arguments);};sap.ushell.components.factsheet.controls.PictureViewer.prototype.deleteTile=function(t){sap.m.TileContainer.prototype.deleteTile.apply(this,arguments);t.destroy();};sap.ushell.components.factsheet.controls.PictureViewer.prototype.deletePicture=function(i){var p,a,n;n=this.getTiles().length;if(typeof i!="number"||i<0||i>=n){p=this.getPageFirstTileIndex();}else{p=i;}if(p>-1){a=this.getTiles()[p];a.detachPictureDelete(jQuery.proxy(this._deletePictureRequestHandler,this));this.deleteTile(a);this.removeAggregation("items",p,true);}else{jQuery.sap.log.warning("Cannot find and delete a picture at index : "+i);}return this;};sap.ushell.components.factsheet.controls.PictureViewer.prototype.selectPicture=function(i){var n=this.getTiles().length;if(typeof i!="number"){i=0;}else if(i<0){i=0;}else if(i>=n){i=n-1;}if(this._bRendered){this.addStyleClass("sapCaPWRendering");}this._selectedIndex=i;return this;};sap.ushell.components.factsheet.controls.PictureViewer.prototype.setSelectedIndex=function(i){this.selectPicture(i);};sap.ushell.components.factsheet.controls.PictureViewer.prototype.getCurrentPictureIndex=function(){return this.getPageFirstTileIndex();};sap.ushell.components.factsheet.controls.PictureViewer.prototype._deletePictureRequestHandler=function(e){var p=this.indexOfTile(e.getSource());this.deleteTile(e.getSource());this.firePictureDeleted({index:p});};sap.ushell.components.factsheet.controls.PictureViewer.prototype._reset=function(e){var i=this.getCurrentPictureIndex();var t=this.getTiles();if(i>-1&&t&&t.length>i){var T=t[i];if(T){var $=jQuery(e.target);var a=this.$();if(a.length>0&&$.length>0){var b=$.closest(this.$());if(b.length===0){T.switchVisibility(false);}}}}};sap.ushell.components.factsheet.controls.PictureViewer.prototype.setRemovable=function(v){this.setProperty("removable",v,true);this.toggleStyleClass("sapCaPWEditable",v);};sap.ushell.components.factsheet.controls.PictureViewer.prototype.setEditable=function(v){sap.m.TileContainer.prototype.setEditable.call(this,false);};sap.ushell.components.factsheet.controls.PictureViewer.prototype._getTileDimension=function(){if(!this._bRendered){return;}var $=jQuery.sap.byId(this.getId()+"-scrl");var t={width:$.width(),height:$.height()};return t;};sap.ushell.components.factsheet.controls.PictureViewer.prototype.onBeforeRendering=function(){this.addStyleClass("sapCaPWRendering");};sap.ushell.components.factsheet.controls.PictureViewer.prototype.onAfterRendering=function(){var t=this;this._bRendered=true;this._applyDimension();this.$().toggleClass("sapCaPWEditable",this.getRemovable()===true);this._sInitialResizeTimeoutId=setTimeout(function(){t.addStyleClass("sapCaPWRendering");t._applyPageStartIndex(t._selectedIndex);t._update(false);},this._iInitialResizeTimeout);if(sap.ui.Device.system.desktop){var f=this.getTiles()[0],T=this._iInitialResizeTimeout;if(!!f){setTimeout(jQuery.proxy(function(){this._findTile(f.$()).focus();},this),T);}}};sap.ushell.components.factsheet.controls.PictureViewer.prototype._update=function(a){sap.m.TileContainer.prototype._update.apply(this,arguments);this.removeStyleClass("sapCaPWRendering");if(sap.ui.getCore().isMobile()){var t=this;var b=this.$blocker;setTimeout(jQuery.proxy(function(){b.fadeOut(200,function(){t.css("visibility","hidden").css("z-index",0);});},this),250);}};sap.ushell.components.factsheet.controls.PictureViewer.prototype._applyDimension=function(){var d=this._getContainerDimension(),i=this.getId(),$=this.$(),t,o=10,T=60,c=jQuery.sap.byId(i+"-cnt"),a,b,p=jQuery.sap.byId(i+"-pager").outerHeight();jQuery.sap.byId(i+"-scrl").css({width:d.outerwidth+"px",height:(d.outerheight-p)+"px"});c.css({height:(d.outerheight-p)+"px",visibility:"visible"});$.css("visibility","visible");t=$.position();a=c.position();b=c.outerHeight();if(jQuery.device.is.phone){o=2;}else if(sap.ui.Device.system.desktop){o=0;}jQuery.sap.byId(i+"-blind").css({top:(a.top+o)+"px",left:(a.left+o)+"px",width:(c.outerWidth()-o)+"px",height:(b-o)+"px"});jQuery.sap.byId(i+"-rightedge").css({top:(t.top+o+T)+"px",right:o+"px",height:(b-o-T)+"px"});jQuery.sap.byId(i+"-leftedge").css({top:(t.top+o+T)+"px",left:(t.left+o)+"px",height:(b-o-T)+"px"});};sap.ushell.components.factsheet.controls.PictureViewer.prototype.showBlockerLayer=function(c){if(sap.ui.getCore().isMobile()){var a=20;jQuery(sap.ui.getCore().getStaticAreaRef()).children().each(function(i,v){var z=parseInt(jQuery(v).css("z-index"),10);if(!isNaN(z)){a=Math.max(a,z);}});jQuery.sap.log.debug("blocker layer z-index calculated : "+a+1);this.$blocker.css("z-index",a+1).css("visibility","visible").fadeIn(200,function(){if(c){c.call();}});}else{if(c){c.call();}}};};if(!jQuery.sap.isDeclared('sap.ushell.components.factsheet.controls.PictureViewerItem')){jQuery.sap.declare("sap.ushell.components.factsheet.controls.PictureViewerItem");jQuery.sap.require('sap.ui.core.Control');sap.ui.core.Control.extend("sap.ushell.components.factsheet.controls.PictureViewerItem",{metadata:{deprecated:true,library:"sap.ushell",properties:{"src":{type:"string",group:"Misc",defaultValue:null}},aggregations:{"image":{type:"sap.m.Image",multiple:false}}}});
/*!
 * @copyright@
*/
sap.ushell.components.factsheet.controls.PictureViewerItem.prototype.setSrc=function(s){this.setProperty("src",s);var i=this.getImage();if(i==null){i=new sap.m.Image();}i.setSrc(s);this.setImage(i);return this;};sap.ushell.components.factsheet.controls.PictureViewerItem.prototype.exit=function(){var i=this.getImage();if(i){i.destroy();}};};if(!jQuery.sap.isDeclared('sap.ushell.components.flp.ComponentKeysHandler')){
// Copyright (c) 2009-2014 SAP SE, All Rights Reserved
(function(){"use strict";jQuery.sap.declare("sap.ushell.components.flp.ComponentKeysHandler");var c=function(){this.aTileWrapperClasses=['.sapUshellTile','.sapUshellLinkTile'];};c.prototype={keyCodes:jQuery.sap.KeyCodes,tileFocusCustomData:new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"tabindex",value:"0",writeToDom:true}),handleCatalogKey:function(){this.oRouter.navTo("appFinder",{'menu':'catalog'});},handleHomepageKey:function(){this.oRouter.navTo("home");var m=sap.ui.getCore().byId("meAreaHeaderButton");if(m&&m.getSelected()){m.firePress();return;}var n=sap.ui.getCore().byId("NotificationsCountButton");if(n&&n.getSelected()){n.firePress();}},handleDoneEditMode:function(){var i=this.oModel.getProperty('/tileActionModeActive');if(i){var d=sap.ui.getCore().byId("sapUshellDashboardFooterDoneBtn");if(d){d.firePress();}}},getNumberOfTileInRow:function(p,i){var j=jQuery(i?".sapUshellLinkTile:first":".sapUshellTile:first");if(!j.length){return false;}var a;if(p==="catalog"){a=jQuery("#catalogTiles .sapUshellTileContainerContent").width();}else{a=jQuery("#dashboardGroups").width();}var n=Math.floor(a/j.outerWidth(true));return n;},goToTileContainer:function(k){var i=this.oModel.getProperty('/tileActionModeActive');if(i){sap.ushell.components.flp.ComponentKeysHandler.goToFirstVisibleTileContainer();}else{sap.ushell.components.flp.ComponentKeysHandler.goToLastVisitedTile();}return true;},goToLastVisitedTile:function(j,l){var a=jQuery('#dashboardGroups').find('.sapUshellTileContainer:visible'),t=this.oModel.getProperty("/topGroupInViewPortIndex");var b=j||jQuery(a.get(t));var d=b.find('.sapUshellTile:visible')["first"](),e,f;if(b&&l){e=b.find(".sapUshellTile:visible[tabindex='0']");if(window.location.search.indexOf("new_links_container=true")===-1){f=b.find(".sapUshellLinkTile:visible[tabindex='0']");}else{f=b.find(".sapMGTLineMode:visible[tabindex='0']");}}else{e=jQuery(".sapUshellTile:visible[tabindex='0']");if(window.location.search.indexOf("new_links_container=true")===-1){f=jQuery(".sapUshellLinkTile:visible[tabindex='0']");}else{f=jQuery(".sapMGTLineMode:visible[tabindex='0']");}}if(!d.length&&!e.length&&!f.length){return false;}if(e.length){this.setTileFocus(e);return true;}if(f.length){this.setTileFocus(f);return true;}this.setTileFocus(d);return true;},goToFirstVisibleTileContainer:function(){var j=jQuery('#dashboardGroups').find('.sapUshellTileContainer:visible'),t=this.oModel.getProperty("/topGroupInViewPortIndex"),a=jQuery(j.get(t));if(!a[0]){return false;}this.setTileContainerSelectiveFocus(a);return true;},goToFirstTileOfSiblingGroup:function(s,e){e.preventDefault();var a=jQuery(document.activeElement).closest(".sapUshellDashboardGroupsContainerItem");if(!a.length)return;var t='first',n=a[s+"All"](".sapUshellDashboardGroupsContainerItem:has(.sapUshellTile:visible):not(.sapUshellCloneArea)");if(!n.length){n=a;t=(s==="next")?'last':'first';}else{n=n.first();}var j=n.find(".sapUshellTile:visible")[t]();this.moveScrollDashboard(j);return false;},animateTileMoveInGroup:function(g,f,s){var d=jQuery.Deferred();sap.ushell.Layout.initGroupDragMode(g);var t=g.getTiles().slice();var a=t.indexOf(f);var b=t.indexOf(s);t.splice(b,0,t.splice(a,1)[0]);var e=sap.ushell.Layout.organizeGroup(t);setTimeout(function(){sap.ushell.Layout.renderLayoutGroup(g,e);});setTimeout(function(){sap.ushell.Layout.endDragMode();d.resolve();},300);return d.promise();},_moveTileInGroup:function(g,f,s){var a=g.getBindingContext().getObject();var b=a.tiles.indexOf(f.getBindingContext().getObject());var d=a.tiles.indexOf(s.getBindingContext().getObject());var e=a.tiles.splice(b,1);a.tiles.splice(d,0,e[0]);var h=g.getBindingContext().getPath();g.getModel().setProperty(h,a);setTimeout(function(){this.setTileFocus(jQuery(s.getDomRef()));}.bind(this),100);},moveTileInGroup:function(g,f,s){if(!this.oModel.getProperty("/personalization")){return;}document.activeElement.blur();if(sap.ushell.Layout.isAnimationsEnabled()){this.animateTileMoveInGroup(g,f,s).then(function(){this._moveTileInGroup(g,f,s);}.bind(this));}else{this._moveTileInGroup(g,f,s);}},animateMoveTileToDifferentGroup:function(s,d,a,b){var e=jQuery.Deferred();sap.ushell.Layout.initGroupDragMode(s);sap.ushell.Layout.initGroupDragMode(d);var f=s.getTiles().slice();var g=d.getTiles().slice();var t=f.indexOf(a);if(b==="left"||b==="up"||b==="down"){g.push(f.splice(t,1)[0]);}if(b==="right"){g.unshift(f.splice(t,1)[0]);}var h=sap.ushell.Layout.organizeGroup(f);var i=sap.ushell.Layout.organizeGroup(g);var j=sap.ushell.Layout.getTilePositionInMatrix(a,i);var k=d.getDomRef().querySelector(".sapUshellInner").getBoundingClientRect();var l=sap.ushell.Layout.calcTranslate(j.row,j.col);var m=k.left+l.x;var n=k.top+l.y;var o=jQuery("#dashboardGroups");var D=o.get(0).getBoundingClientRect();var p=a.getDomRef().getBoundingClientRect();var q=(-D.top)+p.top;var r=(-D.left)+p.left;var u=(-D.top)+n;var v=(-D.left)+m;o.css("position","relative");var w=a.$().clone().removeAttr("id data-sap-ui").css({"transform":"translate3d("+r+"px, "+q+"px, 0px)","list-style-type":"none","transition":"transform 0.3s cubic-bezier(0.46, 0, 0.44, 1)",position:"absolute",left:0,top:0});o.append(w);a.$().css("visibility","hidden");w.height();w.css("transform","translate3d("+v+"px, "+u+"px, 0px)");setTimeout(function(){sap.ushell.Layout.renderLayoutGroup(s,h);sap.ushell.Layout.renderLayoutGroup(d,i);});setTimeout(function(){sap.ushell.Layout.endDragMode();w.remove();o.removeAttr("style");e.resolve();},300);return e.promise();},_moveTileToDifferentGroup:function(s,d,a,b,e){if(this.oModel.getProperty("/personalization")){if(s.getIsGroupLocked()||d.getIsGroupLocked()){return;}var f=s.getBindingContext().getObject();var g=d.getBindingContext().getObject();var t=f.tiles.indexOf(a.getBindingContext().getObject());if(b==="left"||b==="up"||b==="down"){g.tiles.push(f.tiles[t]);}if(b==="right"){g.tiles.splice(0,0,f.tiles[t]);}f.tiles.splice(t,1);var h=d.getBindingContext().getPath();d.getModel().setProperty(h,g);var i=s.getBindingContext().getPath();s.getModel().setProperty(i,f);var j=d.getTiles();if(b==="left"||b==="up"||b==="down"){var k=j[j.length-1];}else{var k=j[0];}setTimeout(function(){this.setTileFocus(jQuery(k.getDomRef()));}.bind(this),100);}},moveTileToDifferentGroup:function(s,d,a,b){if(!this.oModel.getProperty("/personalization")){return;}document.activeElement.blur();if(sap.ushell.Layout.isAnimationsEnabled()){this.animateMoveTileToDifferentGroup(s,d,a,b).then(function(){this._moveTileToDifferentGroup(s,d,a,b);}.bind(this));}else{this._moveTileToDifferentGroup(s,d,a,b);}},moveTile:function(d){var j=jQuery(".sapUshellDashboardView"),a=sap.ui.getCore().byId(j.attr("id"));a.getModel().setProperty('/isInDrag',true);setTimeout(function(){a.getModel().setProperty('/isInDrag',false);},300);if(this.oModel.getProperty("/personalization")){var i=this.getGroupAndTilesInfo();if(!i||i.group.getProperty('isGroupLocked')){return;}var m=true,I,n=this.getNextTile(d,i,I,m);if(!n){return;}else{var b=n.getParent();}if(b===i.group){this.moveTileInGroup(i.group,i.curTile,n);}else{n=this.moveTileToDifferentGroup(i.group,b,i.curTile,d);}}},_findClosestTile:function(d,t,a){var b=(a instanceof HTMLElement)?a.getBoundingClientRect():a.getDomRef().getBoundingClientRect();var e=b.right-((b.right-b.left)/2);if(a.getMode&&a.getMode()==="LineMode"){var m=a.$().height()>parseInt(a.$().css("line-height"),10);if(m){e=(d==="down")?b.right:b.left;}}var f=t.indexOf(a);var s=d==="down"?1:-1;var n,g,r;var h=Infinity;for(var i=f+s;!n;i+=s){var j=t[i];if(!j){break;}var k=(j instanceof HTMLElement)?j.getBoundingClientRect():j.getDomRef().getBoundingClientRect();if(d==="down"&&b.top>=k.top){continue;}if(d==="up"&&b.bottom<=k.bottom){continue;}if(g&&r!=k.top){n=g;break;}r=k.top;var l=Math.abs(k.left-e);var o=Math.abs(k.right-e);var p=l>o?o:l;if(h>p){h=p;g=j;r=k.top;}else{n=g;}}return n||g;},getNextUpDownTileWithScreenPosition:function(d,i,m){var g=i.tiles.concat(i.links);if(!g.length){g.push(i.group.oPlusTile)}var n=this.getNextGroup(d,i);if(n){var a=n.getTiles().concat(n.getLinks());if(!a.length){a.push(n.oPlusTile);}}var b=d==="down"?g.concat(a):a.concat(g);return this._findClosestTile(d,b,i.curTile);},getNextUpDownTileWithLayout:function(d,i,m){var n,a;var b=d==="down"?1:-1;var e=!i.tiles.length&&!i.links.length;var I=i.group.getIsGroupLocked();var f=jQuery(i.curTile.getDomRef()).hasClass('sapUshellPlusTile');var l=i.group.getLinks();var g=sap.ushell.Layout.organizeGroup(i.curTile.isLink?i.links:i.tiles,i.curTile.isLink);var t=sap.ushell.Layout.getTilePositionInMatrix(i.curTile,g);if(!t&&!e&&!f){return;}if(!g[t.row+b]){if(!i.curTile.isLink&&l.length&&d==='down'){if(!m){return l[0];}}if(i.curTile.isLink&&i.tiles.length&&d==='up'){return i.tiles[0];}t=e||f?{row:0,col:0}:t;a=this.getNextGroup(d,i);if(!a){return;}e=!a.getTiles().length&&!a.getLinks().length;if(!e){var F=this._getAggregationToFocusInNextGroup(a,d);var N=this._isNextTileLink(F);g=sap.ushell.Layout.organizeGroup(F,N);b=0;t.row=d==="down"?0:g.length-1;}}if(e&&I){return undefined;}if(e){return a.oPlusTile;}if(typeof g[t.row+b][t.col]==="object"&&!e){n=g[t.row+b][t.col];}else{n=this.getNextUpDownTile(g,t.row+b,t.col,d);}return n;},_isNextTileLink:function(t){if(t&&t.length){var j=jQuery(t[0].getDomRef());return j.hasClass("sapUshellLinkTile")||j.hasClass("sapMGTLineMode");}return false;},_getAggregationToFocusInNextGroup:function(n,d){var g=function(){if(n.getTiles().length){return n.getShowPlaceholder()?[].concat(n.getTiles(),n.oPlusTile):n.getTiles();}};var a=function(){if(n.getLinks().length){return n.getLinks();}};var i=sap.ui.getCore().getConfiguration().getRTL();if(i){if(d==="down"||d==="left"){return g()||a();}else if(d==="up"||d==="right"){return a()||g();}}else{if(d==="down"||d==="right"){return g()||a();}else if(d==="up"||d==="left"){return a()||g();}}},isLastLineFull:function(l){var m=this.getNumberOfTileInRow(),a=l[l.length-1].filter(Boolean);return a.length===m;},getNextUpDownTile:function(l,r,a,d){var n=r,b=l.length,e,f=d==="up"?-1:1;while((n>=0&&n<b)&&!e){if(typeof l[n][a]!=="object"){e=l[n][a];}n=n+f;}if(e){return;}n=r;while((typeof l[n][a]!=="object")&&a>=0){a--;}return l[n][a];},getNextTile:function(d,a,I,m){var n,b,e,s,t,l,w,f,o,g=sap.ui.getCore().getConfiguration().getRTL()?-1:1,h=!a.tiles.length,j=d==="right"?1:-1;if(a.pageName==='catalog'){if(d=='right'||d=='left'){n=!h?a.tiles[a.curTileIndex+(g*j)]:undefined;return n;}if(a.curTileIndex==='0'&&d==='up'){return undefined;}b=this.whichTileRow(a.curTileIndex,a);o=parseFloat(a.curTile.getDomRef().offsetLeft);if(d=="down"){e=a.tiles.slice(a.curTileIndex+1,a.curTileIndex+(a.sizeOfLine*2));}else{s=(s>0)?s:0;e=a.tiles.slice(s,a.curTileIndex).reverse();}for(var i=0,k=e.length;i<k;i++){t=e[i].getDomRef();l=parseFloat(t.offsetLeft);w=parseFloat(t.offsetWidth);f=l+w;if(l<=o&&f>=o){n=e[i];return n;}}if(this.nextRowIsShorter(d,b,a)){n=this.getNextTileInShorterRow(d,b,a);return n;}}else{if(d==="left"||d==="right"){var p=a.curTileIndex+(g*j);var F=a.curTile.isLink?a.links:a.tiles;if(F[p]&&!(m&&F[p].getDomRef().className.indexOf("sapUshellPlusTile")>0)){n=F.length?F[p]:undefined;}if(n){return n;}if(g==1){if(d==="right"&&!a.curTile.isLink&&a.links.length&&!m){return a.links[0];}if(d==="left"&&a.curTile.isLink&&a.tiles.length){return a.group.getShowPlaceholder()?a.group.oPlusTile:a.tiles[a.tiles.length-1];}}else{if(d==="left"&&!a.curTile.isLink&&a.links.length&&!m){return a.links[0];}if(d==="right"&&a.curTile.isLink&&a.tiles.length){return a.group.getShowPlaceholder()?a.group.oPlusTile:a.tiles[a.tiles.length-1];}}var q=this.getNextGroup(d,a);if(!q){return;}else{var r=this._getAggregationToFocusInNextGroup(q,d);if(r&&r.length){var u=r.length-1;if(d==="right"){n=r[g===1?0:u];}else{n=r[g===1?u:0];}}else{n=q.oPlusTile;}}}if(d==="down"||d==="up"){if(window.location.search.indexOf("new_links_container=true")===-1){n=this.getNextUpDownTileWithLayout(d,a,m);}else{n=this.getNextUpDownTileWithScreenPosition(d,a,m);}}}return n;},getNextTileInShorterRow:function(d,a,i){var l=d==='down'?this.getLastTileIdInRow(i,a+1):this.getLastTileIdInRow(i,a-1);return i.tiles[l];},getLastTileIdInRow:function(a,l){var b=0;for(var i=0;i<a.rowsData.length;i++){b+=a.rowsData[i];if(i===l){break;}}return b-1;},nextRowIsShorter:function(d,a,i){if(d==='down'&&a!=i.rowsData.length-1){return i.rowsData[a]>i.rowsData[a+1];}if(d==='up'&&a!=0){return i.rowsData[a]>i.rowsData[a-1];}else{return false;}},getNextGroup:function(d,i){var n,g=i.group.getParent().getGroups(),a=sap.ui.getCore().getConfiguration().getRTL(),b=g.indexOf(i.group);if(d==="right"||d==="left"){if(a){d=(d==="right")?"up":"down";}else{d=(d==="right")?"down":"up";}}if(d==="down"||d==="up"){var e=d==="up"?-1:1;n=g[b+e];if(!n){return;}while(!n.getVisible()&&(b>=0&&b<g.length)){b=b+e;n=g[b];if(!n){return;}}}if(!n.getVisible()){return;}return n;},getGroupAndTilesInfo:function(j,p){if(!j){j=this.getFocusOnTile(jQuery(document.activeElement));}if(!j.length){return;}var a=sap.ui.getCore().byId(j.attr('id'));var g=a.getParent();var r;var t;var l;if(!g.getTiles){a=g;g=g.getParent();}a.isLink=j.hasClass('sapUshellLinkTile')||j.hasClass('sapMGTLineMode');if(p=="catalog"){r=this.getCatalogLayoutData();t=[];var b=jQuery('#catalogTiles').find('.sapUshellTile:visible');for(var i=0;i<b.length;i++){t.push(sap.ui.getCore().byId(b[i].id));}}else{if(g.getTiles){t=g.getTiles();l=g.getLinks();if(g.getShowPlaceholder()&&!a.isLink){t.push(g.oPlusTile);}}}var s=this.getNumberOfTileInRow(p,a.isLink);return{pageName:p,curTile:a,curTileIndex:a.isLink?l.indexOf(a):t.indexOf(a),tiles:t,links:l,sizeOfLine:s,group:g,rowsData:r};},getCatalogLayoutData:function(){var j=jQuery('#catalogTiles .sapUshellInner').children(':visible'),m=this.getNumberOfTileInRow('catalog'),r=[],a=0;for(var i=1;i<j.length;i++){if(jQuery(j[i]).hasClass("sapUshellTile")){a++;}if(jQuery(j[i]).hasClass("sapUshellHeaderTile")){r.push(a);a=0;}if(a>=m){r.push(a);a=0;}}if(a>0){r.push(a);}return r;},whichTileRow:function(a,b){var t=0,i;for(i=0;i<b.rowsData.length;i++){t+=b.rowsData[i];if(a<t){return i;}}},goToSiblingElementInTileContainer:function(d,j,p){var a=j.closest('.sapUshellTileContainer'),b,e,f;if(b=this.getFocusTileContainerBeforeContent(j)){if(d==='up'||d==="left"){this._goToNextTileContainer(b,d);}else{f=a.find('.sapUshellTileContainerHeader:first');this.setTabIndexOnTileContainerHeader(f);f.focus();}return;}if(b=this.getFocusTileContainerHeader(j)){if(d==='up'){this.setTabIndexOnTileContainerHeader(f);if(!this._goToTileContainerBeforeContent(a)){this._goToNextTileContainer(b,d);}}else if(d==="down"){e=a.find('.sapUshellTile:first');if(e.length){var t=jQuery(e);this.scrollToTileAndSetFocus(t,p);}else{this._goToNextTileContainer(b,d);}}else if(d==="left"){if(j.hasClass("sapUshellTileContainerHeader")){if(!this._goToTileContainerBeforeContent(a)){this._goToNextTileContainer(b,"left");}}else{f=j.closest(".sapUshellTileContainerHeader");f.focus();}}else if(d==="right"){var g=j.hasClass("sapMInputBaseInner");if(!g){e=a.find('.sapUshellTile:first');if(e.length){this.setTileFocus(e);}else{this._goToNextTileContainer(b,"down");}}}return;}if(b=this.getFocusOnTile(j)){this.goFromFocusedTile(d,b,p,true);return;}if(b=this.getFocusOnTileContainerAfterContent(j)){if(d==='up'||d==="left"){this._goToFirstTileInTileContainer(b);}else{this._goToNextTileContainer(b,d);}}},_goToNextTileContainer:function(j,d){var a=j.closest('.sapUshellTileContainer'),A=jQuery('.sapUshellTileContainer:visible'),n=(d==='down')?1:-1,b,e;b=jQuery(A[A.index(a)+n]);if(b){e=b.find('.sapUshellTileContainerHeader');if(d==='down'){if(!this._goToTileContainerBeforeContent(b)){this.setTabIndexOnTileContainerHeader(e);this.setTileContainerSelectiveFocus(b);}}else{if(this._goToTileContainerAfterContent(b)){return;}if(d==='up'){if(!this._goToFirstTileInTileContainer(b)){this.setTabIndexOnTileContainerHeader(e);e.focus();}}else if(d==='left'){if(!this._goToLastTileInTileContainer(b)){this.setTabIndexOnTileContainerHeader(e);e.focus();}}}}},_goToLastTileInTileContainer:function(j){var a=j.hasClass('sapUshellTileContainer')?j:j.closest('.sapUshellTileContainer'),b=a.find('.sapUshellTile:last'),d=a.find('.sapUshellLinkTile:last');if(!d.length&&!b.length){return false;}this.setTileFocus(d.length?d:b);return true;},_goToFirstTileInTileContainer:function(j){var a=j.hasClass('sapUshellTileContainer')?j:j.closest('.sapUshellTileContainer'),b=jQuery(a.find('.sapUshellTile').get(0));if(b.length){this.setTileFocus(b);return true;}else{return false;}},_goToTileContainerBeforeContent:function(j){var a=j.hasClass('sapUshellTileContainer')?j:j.closest('.sapUshellTileContainer'),b=a.find('.sapUshellTileContainerBeforeContent button:visible');if(b.length){b.focus();return true;}else{return false;}},_goToTileContainerAfterContent:function(j){var a=j.hasClass('sapUshellTileContainer')?j:j.closest('.sapUshellTileContainer'),b=a.find('.sapUshellTileContainerAfterContent button:visible');if(b.length){b.focus();return true;}else{return false;}},goFromFocusedTile:function(d,j,p,i){var a=this.getGroupAndTilesInfo(j,p),n,b,e,f,g,I;if(!a){return;}n=this.getNextTile(d,a,i);if(i){b=jQuery(j).closest('.sapUshellTileContainer');if(!n){if(d==='down'||d==='right'){g=jQuery(b).find('.sapUshellTileContainerAfterContent button:visible');g.focus();return;}if(d==='up'){this.setTabIndexOnTileContainerHeader(b.find('.sapUshellTileContainerHeader'));this.setTileContainerSelectiveFocus(b);return;}if(d==='left'){f=b.find('.sapUshellTileContainerHeader');f.focus();}}else{e=jQuery(n.getDomRef()).closest('.sapUshellTileContainer');I=b.length&&e.length&&(b.attr('id')===e.attr('id'));if(I){var t=jQuery(n.getDomRef());this.scrollToTileAndSetFocus(t,p);}else{if(d==='down'||d==='right'){if(!this._goToTileContainerAfterContent(b)){this.setTabIndexOnTileContainerHeader(e.find('.sapUshellTileContainerHeader'));this.setTileContainerSelectiveFocus(e);}}else if(d==='up'||'left'){f=b.find('.sapUshellTileContainerHeader');this.setTabIndexOnTileContainerHeader(f);f.focus();}}}}else if(n){var t=jQuery(n.getDomRef());this.scrollToTileAndSetFocus(t,p);}},scrollToTileAndSetFocus:function(t,p){var a=t.offset().top+t.height();if(p==="catalog"){var o=(a-jQuery("body").height())-jQuery("#catalogTilesPage").offset().top+200;jQuery('#catalogTilesPage section').animate({scrollTop:o},0,function(){this.setTileFocus(t);}.bind(this));}else{this.moveScrollDashboard(t);}},deleteTile:function(j){var t=j.attr("id");if(!t){return;}var T=sap.ui.getCore().byId(t);var a=this.getGroupAndTilesInfo(j);var n=this.getNextTile("right",a);if(!n||(n&&n.getParent()!=a.group)){n=this.getNextTile("left",a);}if(!n||(n&&n.getParent()!=a.group)){n=a.group.oPlusTile;}if(n){if(!a.curTile.isLink){this.setTileFocus(jQuery(n.getDomRef()));}setTimeout(function(g,b){var d=g.getTiles();if(!d.length){if(a.links.length&&a.curTile.isLink){n=this.getNextTile("right",a);if(!n||(n&&n.getParent()!=a.group)){n=a.curTile;}this.setTileFocus(jQuery(n.getDomRef()));return;}if(a.group.getProperty('defaultGroup')){var f=this.getNextGroup("right",a);n=f.getTiles()[0]||f.oPlusTile;this.setTileFocus(jQuery(n.getDomRef()));}this.setTileFocus(jQuery(g.oPlusTile.getDomRef()));return;}var n;for(var i=0;i<d.length;i++){if(d[i].getProperty('uuid')==b){n=d[i];break;}}if(n){this.setTileFocus(jQuery(n.getDomRef()));}}.bind(this,a.group,n.getProperty('uuid')),100);}var e=sap.ui.getCore().getEventBus();e.publish("launchpad","deleteTile",{tileId:T.getUuid()});},setTabIndexOnTileContainerHeader:function(j){jQuery(".sapUshellTileContainerHeader").attr("tabindex",-1);jQuery(".sapUshellTileContainerHeader .sapUshellContainerTitle").attr("tabindex",-1);jQuery(".sapUshellTileContainerHeader .sapUshellContainerHeaderActions button").attr("tabindex",-1);if(j){var a=j.find('.sapUshellContainerTitle:first'),b=j.find('.sapUshellContainerHeaderActions:first');j.attr('tabindex',0);a.attr('tabindex',0);b.find('button').attr('tabindex',0);}},setTileContainerSelectiveFocus:function(j){var a=j.find('.sapUshellTileContainerBeforeContent button'),b=j.find('.sapUshellTileContainerHeader:first'),B=a.length&&a.is(":visible");if(B){a.focus();}else if(b.length){this.setTabIndexOnTileContainerHeader(b);b.focus();}},setTileFocus:function(j){if(!j.hasClass('sapUshellPlusTile')){var n=sap.ui.getCore().byId('navContainerFlp'),C=n.getCurrentPage(),o=n?n.getCurrentPage().getViewName():undefined,a;var i=!!((o==="sap.ushell.components.flp.launchpad.appfinder.AppFinder")&&(C.getController().getCurrentMenuName()==="catalog"));a=j.find('[tabindex]');if(i){var h=sap.ushell.components.flp.ComponentKeysHandler;h.setFocusOnCatalogTile(a.eq(0));}}jQuery(".sapUshellTile").attr("tabindex",-1);if(window.location.search.indexOf("new_links_container=true")===-1){jQuery(".sapUshellLinkTile").attr("tabindex",-1);}else{jQuery(".sapMGTLineMode").attr("tabindex",-1);}j.attr("tabindex",0);var b=jQuery("#Fiori2LoadingDialog")[0];if(!b||b.style.visibility==="hidden"){j.focus();var t;if(j[0]&&j[0].id){var t=sap.ui.getCore().byId(j[0].id);var d=this.tileFocusCustomData.getParent&&this.tileFocusCustomData.getParent();if(d){d.removeAggregation("customData",this.tileFocusCustomData,true);}t.addAggregation("customData",this.tileFocusCustomData,true);}}},setFocusOnCatalogTile:function(j){var p=jQuery(".sapUshellTile[tabindex=0]"),a,v;if(p.length){jQuery(".sapUshellTileContainerContent").find('[tabindex*=0]').attr("tabindex",-1);a=p.find('[tabindex], a').andSelf().filter('[tabindex], a');a.attr("tabindex",-1);}if(!j){v=jQuery(".sapUshellTile:visible,.sapUshellAppBox:visible");if(v.length){j=jQuery(v[0]);}else{return;}}j.attr("tabindex",0);j.find("button").attr("tabindex",0);j.focus();},moveScrollDashboard:function(j){var a=j.closest(".sapUshellTileContainer")[0].id,y=-1*(document.getElementById('dashboardGroups').getBoundingClientRect().top)+document.getElementById(a).getBoundingClientRect().top;y+=49;jQuery('#sapUshellDashboardPage section').stop().animate({scrollTop:y},0,function(){this.setTileFocus(j);}.bind(this));},moveGroupFromDashboard:function(d,j){var a,t=jQuery(".sapUshellDashboardGroupsContainerItem"),i,b;a=j.closest(".sapUshellDashboardGroupsContainerItem");i=t.index(a);b=d=="up"||d=="left"?i-1:i+1;this.moveGroup(i,b);},moveGroup:function(f,t){var g=jQuery(".sapUshellDashboardGroupsContainerItem"),n=jQuery(".sapUshellDisableDragAndDrop").length;if(t<0||t>=g.length||t<n){return;}var a=sap.ui.getCore();var d={fromIndex:f,toIndex:t};var b=a.getEventBus();b.publish("launchpad","moveGroup",d);setTimeout(function(){var e=jQuery(".sapUshellTileContainerHeader")[t];this.setTabIndexOnTileContainerHeader(jQuery(e));jQuery(e).focus();}.bind(this),100);},getFocusGroupFromDashboard:function(j){var i=j.closest('.sapUshellTileContainerHeader').length&&j[0].tagName==='H2';return i?j:false;},getFocusTileContainerBeforeContent:function(j){var a=j.closest('.sapUshellTileContainerBeforeContent');return a.length?a:false;},getFocusTileContainerHeader:function(j){var a=j.closest('.sapUshellTileContainerHeader');return a.length?a:false;},getFocusOnTileContainerAfterContent:function(j){var a=j.closest('.sapUshellTileContainerAfterContent');return a.length?a:false;},getFocusOnTile:function(j){var a;jQuery.each(this.aTileWrapperClasses,function(i,t){var b=j.closest(t);a=b.length?b:false;return!(a);});return a;},renameGroup:function(){var j=jQuery(document.activeElement);var a=this.getFocusGroupFromDashboard(j);if(a){a.click();}},arrowsButtonsHandler:function(d,e){var j=jQuery(document.activeElement),i=this.oModel.getProperty('/tileActionModeActive');if(j.hasClass("sapUshellAnchorItem")){e.preventDefault();this.handleAnchorNavigationItemsArrowKeys(d);}else{if(i){if(!j.hasClass('sapMInputBaseInner')){e.preventDefault();this.goToSiblingElementInTileContainer(d,j);}}else{e.preventDefault();this.goFromFocusedTile(d,j);}}},handleAnchorNavigationItemsArrowKeys:function(d){var a=jQuery(".sapUshellAnchorItem:visible"),j=jQuery(document.activeElement),i=a.index(j),n=j,I=sap.ui.getCore().getConfiguration().getRTL();if(I){d=d==='left'?'right':'left';}if(d==="left"||d==="up"){if(i>0){n=a.get(i-1);}}else if(d==="right"||d==="down"){if(i<a.length-1){n=a.get(i+1);}}this.setAnchorItemFocus(jQuery(n));},setAnchorItemFocus:function(j){jQuery(".sapUshellAnchorItem").attr("tabindex",-1);j.attr("tabindex",0);j.focus();},appFinderHomeEndButtonsHandler:function(d,k){k.preventDefault();var v=jQuery(".sapUshellTile:visible,.sapUshellAppBox:visible"),j=jQuery(document.activeElement),a;if(v.length){if(d==="home"){a=jQuery(v.get(0));}if(d==="end"){a=jQuery(v.get(v.length-1));}}if(a){this.appFinderFocusAppBox(j,a);}},appFinderPageUpDownButtonsHandler:function(d,k){k.preventDefault();var j=jQuery(document.activeElement);var a=jQuery(j.parents()[2]);var n=this.getNextCatalog(d,a);if(n){var b=n.find("li"),f=jQuery(b.get(0));}if(f.length){this.appFinderFocusAppBox(j,f);}else if(d==="down"){var e=a.find("li"),l=jQuery(e.get(e.length-1));this.appFinderFocusAppBox(j,l);}},homeEndButtonsHandler:function(s,e){var j=jQuery(document.activeElement),t;if(j.hasClass("sapUshellAnchorItem")){e.preventDefault();this.setAnchorItemFocus(jQuery(".sapUshellAnchorItem:visible:"+s));return;}if(j.hasClass("sapUshellTile")&&j.closest("#dashboardGroups").length){e.preventDefault();if(e.ctrlKey===true){t=jQuery(".sapUshellTile:visible:not('.sapUshellPlusTile')")[s]();}else{t=j.parent().find(".sapUshellTile:visible:not('.sapUshellPlusTile')")[s]();}this.setTileFocus(t);return;}},deleteButtonHandler:function(){if(this.oModel.getProperty("/personalization")&&this.oModel.getProperty("/tileActionModeActive")){var j,a=jQuery(document.activeElement);if(j=this.getFocusOnTile(a)){if(!j.hasClass('sapUshellLockedTile')&&!j.hasClass('sapUshellPlusTile')){this.deleteTile(j);}return;}}},ctrlPlusArrowKeyButtonsHandler:function(s){var j,a=jQuery(document.activeElement),f=jQuery(a).hasClass('sapUshellLinkTile');if(!f&&(j=this.getFocusOnTile(a))){this.moveTile(s);return;}if(j=this.getFocusTileContainerHeader(a)){var b=j.closest('.sapUshellTileContainerContent');if(b.hasClass('sapUshellTileContainerDefault')||b.hasClass('sapUshellTileContainerLocked')){return;}else{this.moveGroupFromDashboard(s,j);}}},spaceButtonHandler:function(e){var j=jQuery(document.activeElement);if(j.hasClass("sapUshellTile")){e.preventDefault();var g=j.find('[role="button"]');if(g){var a=g.attr("id");var b=sap.ui.getCore().byId(a),i=this.oModel.getProperty('/tileActionModeActive');if(b&&!i){b.firePress();return false;}}j.click();return false;}},goToFirstAnchorNavigationItem:function(){this.setAnchorItemFocus(jQuery(".sapUshellAnchorItem:visible:first"));},goToSelectedAnchorNavigationItem:function(){this.setAnchorItemFocus(jQuery(".sapUshellAnchorItemSelected"));return jQuery(document.activeElement).hasClass("sapUshellAnchorItemSelected");},handleFocusOnMe:function(k,f){var h=sap.ushell.components.flp.ComponentKeysHandler,n=sap.ui.getCore().byId('navContainerFlp'),C=n.getCurrentPage(),o=C.getViewName();if(o=="sap.ushell.components.flp.launchpad.dashboard.DashboardContent"){if(f){if(k.shiftKey){var a=jQuery("#sapUshellDashboardFooterDoneBtn:visible");if(a.length){a.focus();}else{h.goToTileContainer(k);}}else{if(!h.goToSelectedAnchorNavigationItem()){sap.ushell.components.flp.ComponentKeysHandler.goToLastVisitedTile()}}}else{h.mainKeydownHandler(k);h.dashboardKeydownHandler(k);}}if(o=="sap.ushell.components.flp.launchpad.appfinder.AppFinder"){if(f){if(!k.shiftKey){var b=sap.ui.getCore().byId("openCloseButtonAppFinderSubheader");if(b&&b.getVisible()){b.focus();}else{h.appFinderFocusMenuButtons(k);}}else{h.setFocusOnCatalogTile();}}else{var m=C.getController().getCurrentMenuName();if(m==="catalog"){h.mainKeydownHandler(k);h.catalogKeydownHandler(k);}else{h.easyAccessKeydownHandler(k);}}}},groupHeaderNavigation:function(){var j=jQuery(document.activeElement),a;if(j.hasClass("sapUshellTileContainerHeader")){a=j.find(".sapUshellContainerTitle");a.focus();}else if(a=j.closest(".sapUshellTileContainerHeader")){a.focus();}},handleShortcuts:function(e){var h=sap.ushell.components.flp.ComponentKeysHandler;if(e.altKey){switch(String.fromCharCode(e.keyCode)){case'A':if(h.oModel.getProperty("/personalization")){h.handleCatalogKey();}break;case'H':h.handleHomepageKey();break;}}if(e.ctrlKey&&e.keyCode===13){h.handleDoneEditMode();}},mainKeydownHandler:function(e){e=e||window.event;switch(e.keyCode){case this.keyCodes.SPACE:this.spaceButtonHandler(e);break;case this.keyCodes.HOME:this.homeEndButtonsHandler("first",e);break;case this.keyCodes.END:this.homeEndButtonsHandler("last",e);break;}},catalogKeydownHandler:function(k){var h=sap.ushell.components.flp.ComponentKeysHandler;switch(k.keyCode){case h.keyCodes.ARROW_UP:h.appFinderUpDownHandler("up",k);break;case h.keyCodes.ARROW_DOWN:h.appFinderUpDownHandler("down",k);break;case h.keyCodes.ARROW_RIGHT:h.appFinderRightLeftHandler("right",k);break;case h.keyCodes.ARROW_LEFT:h.appFinderRightLeftHandler("left",k);break;case h.keyCodes.PAGE_UP:h.appFinderPageUpDownButtonsHandler('up',k);break;case h.keyCodes.PAGE_DOWN:h.appFinderPageUpDownButtonsHandler('down',k);break;case h.keyCodes.HOME:h.appFinderHomeEndButtonsHandler("home",k);break;case h.keyCodes.END:h.appFinderHomeEndButtonsHandler("end",k);break;}},appFinderFocusAppBox:function(j,a){j.attr("tabindex","-1").find(".sapUshellPinButton").attr("tabindex","-1");a.find(".sapUshellPinButton").attr("tabindex","0");a.attr("tabindex","0").focus();},appFinderFocusMenuButtons:function(k){var b=jQuery("#catalog, #userMenu, #sapMenu").filter("[tabindex=0]");if(b.length){b.eq(0).focus();k.preventDefault();return true;}else{return false;}},appFinderUpDownHandler:function(d,k){k.preventDefault();var j=jQuery(document.activeElement);if(!j.is(".sapUshellAppBox, .sapUshellTile")){return;}var a=jQuery(j.parents()[2]);var b=a.find("li"),C=jQuery.makeArray(b),n=[];var e=this.getNextCatalog(d,a);if(e){var f=e.find("li"),n=jQuery.makeArray(f);}var g=d==="down"?C.concat(n):n.concat(C);var h=jQuery(this._findClosestTile(d,g,j.get(0)));this.appFinderFocusAppBox(j,h);},getNextCatalog:function(d,a){var n;if(d==="down"){n=a.next();}if(d==="up"){n=a.prev();}if(!n){return;}return n;},appFinderRightLeftHandler:function(d,k){k.preventDefault();var j=jQuery(document.activeElement);if(!j.is(".sapUshellAppBox, .sapUshellTile")){return;}var a=jQuery(j.parents()[2]);var C=a.find("li");var i=C.index(j);var b=d==="right"?i+1:i-1,e;if(b>=0&&b<C.length){e=jQuery(C[b]);}else if(b<0){var n=this.getNextCatalog("up",a);if(n){var f=n.find("li");if(f.length){e=jQuery(f.get(f.length-1));}}}else if(b===C.length){var n=this.getNextCatalog("down",a);if(n){var f=n.find("li");if(f.length){e=jQuery(f.get(0));}}}this.appFinderFocusAppBox(j,e);},easyAccessRightLeftHandler:function(d,k){k.preventDefault();var h=sap.ushell.components.flp.ComponentKeysHandler;var s=d=="right"?"next":"prev";var j=jQuery(document.activeElement);if(!j.hasClass("sapUshellAppBox")){return;}var n=j.parent()[s]();if(n.length){h.appFinderFocusAppBox(j,n.children());}},easyAccessUpDownHandler:function(d,k){var h=sap.ushell.components.flp.ComponentKeysHandler;k.preventDefault();var f=document.activeElement;var j=jQuery(document.activeElement);if(!j.hasClass("sapUshellAppBox")){return;}var a=f.getBoundingClientRect();var b=[].slice.call(document.querySelectorAll(".sapUshellAppBox"));if(d=="up"){b.reverse();}b.splice(0,b.indexOf(f)+1);var n;for(var i=0;i<b.length;i++){var r=b[i].getBoundingClientRect();var e=(r.left<a.right&&r.right>a.left);if(e){n=b[i];break;}}if(n){h.appFinderFocusAppBox(j,jQuery(n));}},easyAccessHomeEndHandler:function(d,k){k.preventDefault();var h=sap.ushell.components.flp.ComponentKeysHandler;var s=d=="home"?"first":"last";var j=jQuery(document.activeElement);if(!j.hasClass("sapUshellAppBox")){return;}var n=j.parent().parent().children()[s]().children();if(j==n){return;}h.appFinderFocusAppBox(j,jQuery(n));},easyAccessKeydownHandler:function(k){var h=sap.ushell.components.flp.ComponentKeysHandler;switch(k.keyCode){case h.keyCodes.ARROW_UP:h.easyAccessUpDownHandler("up",k);break;case h.keyCodes.ARROW_DOWN:h.easyAccessUpDownHandler("down",k);break;case h.keyCodes.ARROW_RIGHT:h.easyAccessRightLeftHandler("right",k);break;case h.keyCodes.ARROW_LEFT:h.easyAccessRightLeftHandler("left",k);break;case h.keyCodes.HOME:case h.keyCodes.PAGE_UP:h.easyAccessHomeEndHandler("home",k);break;case h.keyCodes.END:case h.keyCodes.PAGE_DOWN:h.easyAccessHomeEndHandler("end",k);break;}},dashboardKeydownHandler:function(k){var h=sap.ushell.components.flp.ComponentKeysHandler;switch(k.keyCode){case h.keyCodes.F2:h.renameGroup();break;case h.keyCodes.F7:h.groupHeaderNavigation();break;case h.keyCodes.DELETE:h.deleteButtonHandler();break;case h.keyCodes.BACKSPACE:h.deleteButtonHandler();break;case h.keyCodes.ARROW_UP:if(k.ctrlKey===true){h.ctrlPlusArrowKeyButtonsHandler("up");}else{h.arrowsButtonsHandler("up",k);}break;case h.keyCodes.ARROW_DOWN:if(k.ctrlKey===true){h.ctrlPlusArrowKeyButtonsHandler("down");}else{h.arrowsButtonsHandler("down",k);}break;case h.keyCodes.ARROW_RIGHT:if(k.ctrlKey===true){h.ctrlPlusArrowKeyButtonsHandler("right");}else{h.arrowsButtonsHandler("right",k);}break;case h.keyCodes.ARROW_LEFT:if(k.ctrlKey===true){h.ctrlPlusArrowKeyButtonsHandler("left");}else{h.arrowsButtonsHandler("left",k);}break;case h.keyCodes.PAGE_UP:h.goToFirstTileOfSiblingGroup("prev",k);break;case h.keyCodes.PAGE_DOWN:h.goToFirstTileOfSiblingGroup("next",k);break;}return true;},init:function(m,r){this.oModel=m;this.oRouter=r;}};sap.ushell.components.flp.ComponentKeysHandler=new c();}());};if(!jQuery.sap.isDeclared('sap.ushell.components.flp.launchpad.DashboardManager')){(function(){"use strict";jQuery.sap.declare("sap.ushell.components.flp.launchpad.DashboardManager");var g=function(m,p){return p?sap.ushell.resources.i18n.getText(m,p):sap.ushell.resources.i18n.getText(m);};sap.ui.base.EventProvider.extend("sap.ushell.components.flp.launchpad.DashboardManager",{metadata:{publicMethods:["getModel","getDashboardView","loadPersonalizedGroups","attachEvent","detachEvent","attachEventOnce","createTile","deleteCatalogTileFromGroup","resetGroupsOnFailure","createGroupAndSaveTile"]},analyticsConstants:{PERSONALIZATION:"FLP: Personalization",RENAME_GROUP:"FLP: Rename Group",MOVE_GROUP:"FLP: Move Group",DELETE_GROUP:"FLP: Delete Group",RESET_GROUP:"FLP: Reset Group",DELETE_TILE:"FLP: Delete Tile",ADD_TILE:"FLP: Add Tile",MOVE_TILE:"FLP: Move Tile"},constructor:function(i,s){if(sap.ushell.components.flp.launchpad.getDashboardManager&&sap.ushell.components.flp.launchpad.getDashboardManager()){return sap.ushell.components.flp.launchpad.getDashboardManager();}sap.ushell.components.flp.launchpad.getDashboardManager=jQuery.sap.getter(this.getInterface());this.oPageBuilderService=sap.ushell.Container.getService("LaunchPage");this.oModel=s.model;this.oConfig=s.config;this.oRouter=s.router;this.oSortableDeferred=$.Deferred();this.oSortableDeferred.resolve();this.aRequestQueue=[];this.aPendingCatalogQueue=[];this.bRequestRunning=false;this.tagsPool=[];this.registerEvents();this.oTileCatalogToGroupsMap={};this.tileViewUpdateQueue=[];this.tileViewUpdateTimeoutID=0;this.oPopover=null;this.tileUuid=null;this.segmentsStore=[];this.oGroupNotLockedFilter=new sap.ui.model.Filter("isGroupLocked",sap.ui.model.FilterOperator.EQ,false);if(this.oRouter){var t=this.oRouter.getTarget('home');t.attachDisplay(function(e){this.oDashboardView=e.getParameter('view');}.bind(this));}},createMoveActionDialog:function(){var G=this.oGroupNotLockedFilter;this.moveDialog=new sap.m.SelectDialog("moveDialog",{title:sap.ushell.resources.i18n.getText('moveTileDialog_title'),rememberSelections:false,search:function(e){var v=e.getParameter("value"),f=new sap.ui.model.Filter("title",sap.ui.model.FilterOperator.Contains,v),b=e.getSource().getBinding("items");b.filter([f,G]);},contentWidth:'400px',confirm:function(e){var c=e.getParameter("selectedContexts"),E=sap.ui.getCore().getEventBus();if(c.length){E.publish("launchpad","moveTile",{sTileId:this.tileUuid,toGroupId:c[0].getObject().groupId,toIndex:c[0].getObject().tiles.length,source:this.moveDialog.getId()});E.publish("launchpad","scrollToGroup",{groupId:c[0].getObject().groupId,groupChanged:false,focus:false});}}.bind(this),cancel:function(){var c=jQuery('.sapUshellTile[tabindex="0"]')[0];if(c){c.focus();}},items:{path:"/groups",filters:[G],template:new sap.m.StandardListItem({title:"{title}"})}});this.moveDialog.setModel(this.oModel);},registerEvents:function(){var e=sap.ui.getCore().getEventBus(),t=this;e.subscribe("launchpad","addBookmarkTile",this._createBookmark,this);e.subscribe("sap.ushell.services.Bookmark","bookmarkTileAdded",this._addBookmarkToModel,this);e.subscribe("sap.ushell.services.Bookmark","catalogTileAdded",this._refreshGroupInModel,this);e.subscribe("sap.ushell.services.Bookmark","bookmarkTileDeleted",this.loadPersonalizedGroups,this);e.subscribe("launchpad","loadDashboardGroups",this.loadPersonalizedGroups,this);e.subscribe("launchpad","createGroupAt",this._createGroupAt,this);e.subscribe("launchpad","createGroup",this._createGroup,this);e.subscribe("launchpad","deleteGroup",this._deleteGroup,this);e.subscribe("launchpad","resetGroup",this._resetGroup,this);e.subscribe("launchpad","changeGroupTitle",this._changeGroupTitle,this);e.subscribe("launchpad","moveGroup",this._moveGroup,this);e.subscribe("launchpad","deleteTile",this._deleteTile,this);e.subscribe("launchpad","moveTile",this._moveTile,this);e.subscribe("launchpad","sortableStart",this._sortableStart,this);e.subscribe("launchpad","sortableStop",this._sortableStop,this);e.subscribe("renderCatalog",this.loadAllCatalogs,this);e.subscribe("showCatalog",this.updateTilesAssociation,this);e.subscribe("launchpad","dashboardModelContentLoaded",this._modelLoaded,this);this.oPageBuilderService.registerTileActionsProvider(function(T){jQuery.sap.require("sap.m.MessageBox");return[{text:sap.ushell.resources.i18n.getText('moveTileDialog_action'),press:function(E){t.tileUuid=t.getModelTileById(t.oPageBuilderService.getTileId(T)).uuid;if(!t.moveDialog){t.createMoveActionDialog();}t.moveDialog.getBinding("items").filter([t.oGroupNotLockedFilter]);t.moveDialog.open();}}];});},destroy:function(){var e=sap.ui.getCore().getEventBus();e.unsubscribe("launchpad","addBookmarkTile",this._createBookmark,this);e.unsubscribe("launchpad","loadDashboardGroups",this.loadPersonalizedGroups,this);e.unsubscribe("launchpad","createGroupAt",this._createGroupAt,this);e.unsubscribe("launchpad","createGroup",this._createGroup,this);e.unsubscribe("launchpad","deleteGroup",this._deleteGroup,this);e.unsubscribe("launchpad","resetGroup",this._resetGroup,this);e.unsubscribe("launchpad","changeGroupTitle",this._changeGroupTitle,this);e.unsubscribe("launchpad","moveGroup",this._moveGroup,this);e.unsubscribe("launchpad","deleteTile",this._deleteTile,this);e.unsubscribe("launchpad","moveTile",this._moveTile,this);e.unsubscribe("launchpad","sortableStart",this._sortableStart,this);e.unsubscribe("launchpad","sortableStop",this._sortableStop,this);e.unsubscribe("renderCatalog",this.loadAllCatalogs,this);e.unsubscribe("showCatalog",this.updateTilesAssociation,this);e.unsubscribe("launchpad","dashboardModelContentLoaded",this._modelLoaded,this);sap.ushell.components.flp.launchpad.getDashboardManager=undefined;},_refreshTiles:function(){var t=this,G=this.oModel.getProperty("/groups");jQuery.each(G,function(n,o){jQuery.each(o.tiles,function(n,T){t.oPageBuilderService.refreshTile(T.object);});});},_sortableStart:function(){this.oSortableDeferred=$.Deferred();},_createBookmark:function(c,e,d){var t=d.group?d.group.object:"";delete d.group;this._addRequest($.proxy(function(){var r=sap.ushell.Container.getService("Bookmark").addBookmark(d,t),R=sap.ushell.resources.i18n;r.always($.proxy(this._checkRequestQueue,this));r.done(function(){if(sap.ushell.Container){sap.ushell.Container.getService('Message').info(R.getText('tile_created_msg'));}});r.fail(function(m){jQuery.sap.log.error("Failed to add bookmark",m,"sap.ushell.ui.footerbar.AddBookmarkButton");if(sap.ushell.Container){sap.ushell.Container.getService('Message').error(R.getText('fail_to_add_tile_msg'));}});},this));},_addBookmarkToModel:function(c,e,d){var t=d.tile,G,o=d.group,s,T,n,i,a,N,I;if(!d||!t){this.bIsGroupsModelDirty=true;if(!this.bGroupsModelLoadingInProcess){this._handleBookmarkModelUpdate();}return;}if(!o){G=this.getModel().getProperty("/groups");for(I=0;I<G.length;I++){if(G[I].isDefaultGroup===true){o=G[I].object;break;}}}s=this.oPageBuilderService;T=s.getTileType(t);n=this._getTileModel(t,s.isGroupLocked(o),T,this._addModelToTileViewUpdateQueue);i=this._getIndexOfGroupByObject(o);a=this.oModel.getProperty("/groups/"+i);a.tiles.push(n);a.visibilityModes=sap.ushell.utils.calcVisibilityModes(a,true);N=a.tiles.length;this._updateModelWithTileView(i,N);this.oModel.setProperty("/groups/"+i,a);},_refreshGroupInModel:function(c,e,G){var l=sap.ushell.Container.getService("LaunchPage"),E='Failed to refresh group with id:'+G+' in the model',t=this;l.getGroups().fail(jQuery.sap.log.error(E,null,"sap.ushell.components.flp.launchpad.DashboardManager")).done(function(a){a.some(function(o){if(l.getGroupId(o)===G){l.getDefaultGroup().done(function(d){var i=G===d.getId()?true:false,b=t._getGroupModel(o,i),f=t._getIndexOfGroupByObject(b.object);t.oModel.setProperty("/groups/"+f,b);});return true;}});});},_sortableStop:function(){this.oSortableDeferred.resolve();},_handleAfterSortable:function(f){return $.proxy(function(){var o=Array.prototype.slice.call(arguments);this.oSortableDeferred.done(function(){f.apply(null,o);});},this);},_addRequest:function(r){this.aRequestQueue.push(r);if(!this.bRequestRunning){this.bRequestRunning=true;this.aRequestQueue.shift()();}},_checkRequestQueue:function(){if(this.aRequestQueue.length===0){this.bRequestRunning=false;}else{this.aRequestQueue.shift()();}},_requestFailed:function(){this.aRequestQueue=[];this.bRequestRunning=false;},_createGroup:function(c,e,d){var G=this._getGroupModel(null),a=this.oModel.getProperty("/groups"),m=this.oModel;m.setProperty("/groupList-skipScrollToGroup",true);window.setTimeout(function(){m.setProperty("/groups/"+a.length,G);},500);window.setTimeout(function(){m.setProperty("/groupList-skipScrollToGroup",false);},1000);},_createGroupAt:function(c,e,d){var n=parseInt(d.location,10),G=this.oModel.getProperty("/groups"),o=this._getGroupModel(null,false,n===G.length,d),m=this.oModel,i;o.index=n;G.splice(n,0,o);for(i=0;i<G.length-1;i++){G[i].isLastGroup=false;}for(i=n+1;i<G.length;i++){G[i].index++;}m.setProperty("/groups",G);},_getIndexOfGroup:function(G){var n=null,a=this.oModel.getProperty("/groups");jQuery.each(a,function(b,o){if(o.groupId===G){n=b;return false;}});return n;},_getIndexOfGroupByObject:function(G){var n=null,a=this.oModel.getProperty("/groups"),s=this.oPageBuilderService.getGroupId(G);a.forEach(function(m,b){var c=this.oPageBuilderService.getGroupId(m.object);if(c===s){n=b;return false;}}.bind(this));return n;},_getPathOfGroup:function(G){return"/groups/"+this._getIndexOfGroup(G);},_getPathOfTile:function(t){var G=this.oModel.getProperty("/groups"),n=null,a=null;jQuery.each(G,function(b,o){jQuery.each(o.tiles,function(c,T){if(T.uuid===t){n=b;a=c;return false;}});if(n!==null){return false;}});return n!==null?"/groups/"+n+"/tiles/"+a:null;},_moveInArray:function(a,n,b){if(b>=a.length){var k=b-a.length;while((k--)+1){a.push(undefined);}}a.splice(b,0,a.splice(n,1)[0]);},_updateGroupIndices:function(a){var k;for(k=0;k<a.length;k++){a[k].index=k;}},_deleteGroup:function(c,e,d){var t=this,G=d.groupId,s,a=this.oModel.getProperty("/groups"),n=this._getIndexOfGroup(G),i=a.length-1===n,o=null,r,m,b,B;b=i?n-1:n;this._destroyGroupModel("/groups/"+n);o=a.splice(n,1)[0].object;if(i){this.oModel.setProperty("/groups/"+b+"/isLastGroup",i);}s=sap.ushell.Container.getService("LaunchPage").getGroupId(o);m=this.oModel;m.setProperty("/groupList-skipScrollToGroup",true);m.setProperty("/groups",a);this._updateGroupIndices(a);if(b>=0){B=sap.ui.getCore().getEventBus();window.setTimeout($.proxy(B.publish,B,"launchpad","scrollToGroup",{groupId:this.oModel.getProperty("/groups")[b].groupId}),200);}window.setTimeout(function(){m.setProperty("/groupList-skipScrollToGroup",false);},1000);this._addRequest($.proxy(function(){var f=sap.ushell.Container.getService("LaunchPage").getGroupTitle(o);try{r=this.oPageBuilderService.removeGroup(o);}catch(h){this._resetGroupsOnFailure("fail_to_delete_group_msg");return;}r.done(function(){sap.ushell.Container.getService("UsageAnalytics").logCustomEvent(this.analyticsConstants.PERSONALIZATION,this.analyticsConstants.DELETE_GROUP,[f,s]);this._showLocalizedMessage("group_deleted_msg",[f]);}.bind(this));r.fail(this._handleAfterSortable(t._resetGroupsOnFailureHelper("fail_to_delete_group_msg")));r.always($.proxy(this._checkRequestQueue,this));},this));},_resetGroup:function(c,e,d){var t=this,G=d.groupId,n=this._getIndexOfGroup(G),o=this.oModel.getProperty("/groups/"+n),s,a,r,b;this.oModel.setProperty("/groups/"+n+"/sortable",false);a=sap.ushell.Container.getService("LaunchPage").getGroupId(o.object);s=sap.ushell.Container.getService("LaunchPage").getGroupTitle(o.object);this._addRequest($.proxy(function(){try{r=this.oPageBuilderService.resetGroup(o.object);}catch(f){this._resetGroupsOnFailure("fail_to_reset_group_msg");return;}r.done(this._handleAfterSortable($.proxy(function(G,o,R){sap.ushell.Container.getService("UsageAnalytics").logCustomEvent(this.analyticsConstants.PERSONALIZATION,this.analyticsConstants.RESET_GROUP,[s,a]);var n=t._getIndexOfGroup(G);this._loadGroup(n,R||o.object,this._addAndUpdateModelWithTileView);this._showLocalizedMessage("group_reset_msg",[o.title]);this.oModel.setProperty("/groups/"+n+"/sortable",true);b=sap.ui.getCore().byId('dashboardGroups').getGroupControlByGroupId(G);if(b){b.rerender();}},this,G,o)));r.fail(this._handleAfterSortable(t._resetGroupsOnFailureHelper("fail_to_reset_group_msg")));r.always($.proxy(this._checkRequestQueue,this));},this));},_moveGroup:function(c,e,d){var f=d.fromIndex,t=d.toIndex,G=this.oModel.getProperty("/groups"),m=this.oModel,a=this.oModel.getProperty("/tileActionModeActive"),r,o,s,b=this,i,D;if(!a){f=this._adjustFromGroupIndex(f,G);}o=G[f];s=o.groupId;if(!a){t=this._adjustToGroupIndex(t,G,s);}D=G[t].object;this._moveInArray(G,f,t);this._updateGroupIndices(G);m.setProperty("/groupList-skipScrollToGroup",true);for(i=0;i<G.length-1;i++){G[i].isLastGroup=false;}G[G.length-1].isLastGroup=true;m.setProperty("/groups",G);window.setTimeout(function(){m.setProperty("/groupList-skipScrollToGroup",false);},1000);this._addRequest($.proxy(function(){var o=this.oModel.getProperty(this._getPathOfGroup(s));try{this._getOriginalGroupIndex(D).done(function(n){r=this.oPageBuilderService.moveGroup(o.object,n);r.done(function(){sap.ushell.Container.getService("UsageAnalytics").logCustomEvent(b.analyticsConstants.PERSONALIZATION,b.analyticsConstants.MOVE_GROUP,[o.title,f,t,s]);});r.fail(this._handleAfterSortable(this._resetGroupsOnFailureHelper("fail_to_move_group_msg")));r.always($.proxy(this._checkRequestQueue,this));}.bind(this));}catch(h){this._resetGroupsOnFailure("fail_to_move_group_msg");return;}},this));},_adjustToGroupIndex:function(t,a,b){var v=0,I=false,i=0;for(i=0;i<a.length&&v<t;i++){if(a[i].isGroupVisible){if(a[i].groupId===b){I=true;}else{v++;}}}if(I){return i-1;}return i;},_adjustFromGroupIndex:function(a,b){var v=0,i;for(i=0;i<b.length;i++){if(b[i].isGroupVisible){v++;}if(v===a+1){return i;}}return a;},_getOriginalGroupIndexByIndex:function(n){var G=this.oModel.getProperty("/groups"),s=G[n].object;return this._getOriginalGroupIndex(s);},_getOriginalGroupIndex:function(s){var a=this.oPageBuilderService,t=this,G=this.oPageBuilderService.getGroups(),d=new jQuery.Deferred();G.done(function(b){var n=null;jQuery.each(b,function(c,o){if(a.getGroupId(o)===a.getGroupId(s)){n=c;return false;}});d.resolve(n);});G.fail(function(){t._showLocalizedErrorHelper("fail_to_load_groups_msg")();d.reject();});return d;},_changeGroupTitle:function(c,e,d){var n=d.newTitle,G=this.oModel.getProperty("/groups"),s=d.groupId,a=d.groupId,b=this._getIndexOfGroup(s),o=this.oModel.getProperty("/groups/"+b),O=o.title,r,t=this;this.oModel.setProperty("/groups/"+b+"/title",n);if(!o.object){this._addRequest($.proxy(function(){try{if(b===G.length-1){r=this.oPageBuilderService.addGroup(n,b);r.done(this._handleAfterSortable($.proxy(function(s,N){var b=this._getIndexOfGroup(s);this._loadGroup(b,N);sap.ushell.Container.getService("UsageAnalytics").logCustomEvent(t.analyticsConstants.PERSONALIZATION,t.analyticsConstants.RENAME_GROUP,[O,n,s]);},this,s)));r.fail(this._handleAfterSortable(this._resetGroupsOnFailureHelper("fail_to_create_group_msg")));r.always($.proxy(this._checkRequestQueue,this));}else{this._getOriginalGroupIndexByIndex(b+1).done(function(h){r=this.oPageBuilderService.addGroupAt(n,h);r.done(this._handleAfterSortable($.proxy(function(s,N){var b=this._getIndexOfGroup(s);this._loadGroup(b,N);sap.ushell.Container.getService("UsageAnalytics").logCustomEvent(t.analyticsConstants.PERSONALIZATION,t.analyticsConstants.RENAME_GROUP,[O,n,s]);},this,s)));r.fail(this._handleAfterSortable(this._resetGroupsOnFailureHelper("fail_to_create_group_msg")));r.always($.proxy(this._checkRequestQueue,this));}.bind(this));}}catch(f){this._resetGroupsOnFailure("fail_to_create_group_msg");return;}},this));}else{this._addRequest($.proxy(function(){try{r=this.oPageBuilderService.setGroupTitle(o.object,n);}catch(f){this._resetGroupsOnFailure("fail_to_rename_group_msg");return;}r.done(function(){a=sap.ushell.Container.getService("LaunchPage").getGroupId(o.object);sap.ushell.Container.getService("UsageAnalytics").logCustomEvent(t.analyticsConstants.PERSONALIZATION,t.analyticsConstants.RENAME_GROUP,[O,n,a]);});r.fail(this._handleAfterSortable($.proxy(function(s,O){var h=this._getPathOfGroup(s);this._showLocalizedError("fail_to__msg");this.oModel.setProperty(h+"/title",O);this._requestFailed();},this,s)));r.always($.proxy(this._checkRequestQueue,this));},this));}},createTile:function(d){var c=d.catalogTileContext,C=d.groupContext,G=this.oModel.getProperty(C.getPath()),s=G.groupId,r,a=jQuery.Deferred(),R={},b;b=sap.ui.getCore().getEventBus();$.proxy(b.publish,b,"launchpad","addTile",{catalogTileContext:c,groupContext:C});if(!c){jQuery.sap.log.warning("DashboardManager: Did not receive catalog tile object. Abort.",this);return;}this._addRequest($.proxy(function(){try{r=this.oPageBuilderService.addTile(c.getProperty("src"),C.getProperty("object"));}catch(e){this._resetGroupsOnFailure("fail_to_add_tile_msg");return;}var t=this;r.done(function(T){var f=t._getPathOfGroup(s),h=sap.ushell.Container.getService("LaunchPage").getTileTitle(T);t._addTileToGroup(f,T);R={group:G,status:1,action:'add'};sap.ushell.Container.getService("UsageAnalytics").logCustomEvent(t.analyticsConstants.PERSONALIZATION,t.analyticsConstants.ADD_TILE,[G.title,h]);a.resolve(R);}).fail(function(){R={group:G,status:0,action:'add'};a.resolve(R);}).always(function(){t._checkRequestQueue();});},this));return a.promise();},createGroup:function(t){var d=jQuery.Deferred();if(!sap.ushell.utils.validHash(t)){return d.reject({status:0,action:'createNewGroup'});}var G=this._getGroupModel(null,false,true);var a=this.oModel.getProperty("/groups");var s=G.groupId;var i=a.length;if(i>0){a[i-1].isLastGroup=false;}G.title=t;G.index=i;G.editMode=false;a.push(G);this.oModel.setProperty("/groups/",a);this._addRequest(function(t){try{var r=this.oPageBuilderService.addGroup(t);}catch(e){this._resetGroupsOnFailure("fail_to_create_group_msg");return;}r.done(this._handleAfterSortable(function(s,n){var b=this._getIndexOfGroup(s);this._loadGroup(b,n);var c=new sap.ui.model.Context(this.oModel,"/groups/"+b);d.resolve(c);}.bind(this,s)));r.fail(function(b){this._handleAfterSortable(this._resetGroupsOnFailureHelper("fail_to_create_group_msg"));var R={group:b.group,status:0,action:'createNewGroup'};d.resolve(R);}.bind(this));r.always($.proxy(this._checkRequestQueue,this));}.bind(this,t));return d.promise();},createGroupAndSaveTile:function(d){var c=d.catalogTileContext,n=d.newGroupName,a=jQuery.Deferred(),r={};if(sap.ushell.utils.validHash(n)&&c){this.createGroup(n).then(function(C){var p=this.createTile({catalogTileContext:c,groupContext:C});p.done(function(b){r={group:b.group,status:1,action:'addTileToNewGroup'};a.resolve(r);}).fail(function(b){r={group:b.group,status:0,action:'addTileToNewGroup'};a.resolve(r);});}.bind(this));}return a.promise();},_deleteTile:function(c,e,d){var t=this,T=d.tileId||d.originalTileId,G=this.oModel.getProperty("/groups");jQuery.each(G,function(n,o){var f=false;jQuery.each(o.tiles,function(a,b){if(b.uuid===T||b.originalTileId===T){t._destroyTileModel("/groups/"+n+"/tiles/"+a);var h=o.tiles.splice(a,1)[0],r,s=sap.ushell.Container.getService("LaunchPage").getTileTitle(h.object),C=sap.ushell.Container.getService("LaunchPage").getCatalogTileId(h.object),i=sap.ushell.Container.getService("LaunchPage").getCatalogTileTitle(h.object),j=sap.ushell.Container.getService("LaunchPage").getTileId(h.object),p=t.oModel.getProperty("/personalization");o.visibilityModes=sap.ushell.utils.calcVisibilityModes(o,p);t.oModel.setProperty("/groups/"+n,o);t._addRequest(function(){try{r=t.oPageBuilderService.removeTile(o.object,h.object);}catch(k){this._resetGroupsOnFailure("fail_to_remove_tile_msg");return;}r.done(t._handleAfterSortable(function(){if(s){t._showLocalizedMessage("tile_deleted_msg",[s,o.title]);}else{t._showLocalizedMessage("tile_deleted_msg",[s,o.title]);}sap.ushell.Container.getService("UsageAnalytics").logCustomEvent(t.analyticsConstants.PERSONALIZATION,t.analyticsConstants.DELETE_TILE,[s||j,C,i,o.title]);}));r.fail(t._handleAfterSortable(t._resetGroupsOnFailureHelper("fail_to_remove_tile_msg")));r.always($.proxy(t._checkRequestQueue,t));});sap.ushell.utils.handleTilesVisibility();f=true;return false;}});if(f){return false;}});},_sendDeleteTileRequest:function(G,t){var r,a=sap.ushell.Container.getService('LaunchPage');try{r=a.removeTile(G,t.object);}catch(e){jQuery.sap.log.error("deleteCatalogTileFromGroup ; removeTile ; Exception occurred: "+e);}return r;},deleteCatalogTileFromGroup:function(d){var t=this,D=decodeURIComponent(d.tileId),G=d.groupIndex,o=this.oModel.getProperty("/groups/"+G),s=sap.ushell.Container.getService("LaunchPage"),a=jQuery.Deferred(),b=[],f,p,c;f=o.tiles.filter(function(T){var e=s.getCatalogTileId(T.object);if(e!==D){return true;}else{p=jQuery.Deferred();c=t._sendDeleteTileRequest(o.object,T);c.done((function(a){return function(){a.resolve({status:true});};})(p));c.fail((function(a){return function(){a.resolve({status:false});};})(p));b.push(p);return false;}});o.tiles=f;o.visibilityModes=sap.ushell.utils.calcVisibilityModes(o,true);jQuery.when.apply(jQuery,b).done(function(r){var S=true,i=0,e=b.length;for(i;i<e;i++){if(!r.status){S=false;break;}}if(S){t.oModel.setProperty("/groups/"+G,o);}a.resolve({group:o,status:S,action:'remove'});});return a.promise();},_moveTile:function(c,e,d){var n=d.toIndex,N=d.toGroupId,t=d.sTileId,s=d.source,T,a,o,b,f,h,i=sap.ushell.Container.getService("LaunchPage"),G=this.oModel.getProperty("/groups"),S,j,r,p;jQuery.each(G,function(k,l){var F=false;jQuery.each(l.tiles,function(m,q){if(q.uuid===t){T=q;a=m;o=l;b=k;F=true;return false;}});if(F){return false;}});jQuery.each(G,function(k,l){if(l.groupId===N){f=l;h=k;}});if(o.groupId==f.groupId&&(s==="moveDialog"||n===null)){return;}if(n&&n>f.tiles.length){n=f.tiles.length;}if(o.groupId===N){if(n===null||n===undefined){o.tiles.splice(a,1);n=o.tiles.length;o.tiles.push(T);}else{n=this._adjustTileIndex(n,T,o);this._moveInArray(o.tiles,a,n);}this.oModel.setProperty("/groups/"+b+"/tiles",o.tiles);}else{p=this.oModel.getProperty("/personalization");o.tiles.splice(a,1);o.visibilityModes=sap.ushell.utils.calcVisibilityModes(o,p);this.oModel.setProperty("/groups/"+b+"/tiles",o.tiles);if(n===null||n===undefined){n=f.tiles.length;f.tiles.push(T);}else{n=this._adjustTileIndex(n,T,f);f.tiles.splice(n,0,T);}f.visibilityModes=sap.ushell.utils.calcVisibilityModes(f,p);this.oModel.setProperty("/groups/"+h+"/tiles",f.tiles);}this.updateTilesAssociation();sap.ushell.utils.handleTilesVisibility();S=this.oModel.getProperty("/groups/"+b).object;j=this.oModel.getProperty("/groups/"+h).object;this._addRequest($.proxy(function(){try{r=this.oPageBuilderService.moveTile(T.object,a,n,S,j);}catch(k){this._resetGroupsOnFailure("fail_to_move_tile_msg");return;}T.tileIsBeingMoved=true;r.done(this._handleAfterSortable($.proxy(function(t,l){var m,u=[i.getTileTitle(T.object),i.getGroupTitle(S),i.getGroupTitle(j),t];sap.ushell.Container.getService("UsageAnalytics").logCustomEvent(this.analyticsConstants.PERSONALIZATION,this.analyticsConstants.MOVE_TILE,u);m=this._getPathOfTile(t);if(m){this.oModel.setProperty(m+"/object",l);this.oModel.setProperty(m+"/originalTileId",this.oPageBuilderService.getTileId(l));this._checkRequestQueue();this.oPageBuilderService.getTileView(l).done(function(v){var q=this.oModel.getProperty(m+"/content");this.oModel.setProperty(m+"/content",[v]);if(q&&q[0]){q[0].destroy();}this.oModel.setProperty(m+"/tileIsBeingMoved",false);}.bind(this));}},this,t)));r.fail(this._handleAfterSortable(this._resetGroupsOnFailureHelper("fail_to_move_tile_msg")));},this));},_adjustTileIndex:function(n,t,a){var v=0,I=false,i=0;for(i=0;i<a.tiles.length&&v<n;i++){if(a.tiles[i].isTileIntentSupported){if(a.tiles[i]===t){I=true;}else{v++;}}}if(I){return i-1;}return i;},getModel:function(){return this.oModel;},getDashboardView:function(){return this.oDashboardView;},updateTilesAssociation:function(){this.mapCatalogTilesToGroups();this.updateCatalogTilesToGroupsMap();},loadAllCatalogs:function(c,e,d){var G=new jQuery.Deferred(),t=this,s;G.resolve();s=function(){G.done(function(){var a=t.getModel().getProperty("/groups");if(a&&a.length!==0){t.updateTilesAssociation();}});};if(!this.oModel.getProperty("/catalogs")){if(!this.oModel.getProperty("/groups")||this.oModel.getProperty("/groups").length===0){G=this.loadPersonalizedGroups();}this._destroyAllGroupModels("/catalogs");this._destroyAllTileModels("/catalogTiles");this.oModel.setProperty("/catalogs",[]);this.oModel.setProperty("/catalogSearchEntity",{appBoxes:[],customTiles:[]});this.aPromises=[];jQuery.sap.measure.start("FLP:DashboardManager.GetCatalogsRequest","GetCatalogsRequest","FLP");jQuery.sap.measure.start("FLP:DashboardManager.getCatalogTiles","getCatalogTiles","FLP");jQuery.sap.measure.pause("FLP:DashboardManager.getCatalogTiles");jQuery.sap.measure.start("FLP:DashboardManager.BuildCatalogModelWithRendering","BuildCatalogModelWithRendering","FLP");jQuery.sap.measure.pause("FLP:DashboardManager.BuildCatalogModelWithRendering");sap.ushell.Container.getService("LaunchPage").getCatalogs().done(function(a){jQuery.sap.measure.end("FLP:DashboardManager.GetCatalogsRequest");jQuery.sap.measure.end("FLP:DashboardManager.getCatalogTiles");jQuery.when.apply(jQuery,this.aPromises).then(this.onDoneLoadingCatalogs(a));s();}.bind(this)).fail(t._showLocalizedErrorHelper("fail_to_load_catalog_msg")).progress(this.addCatalogToModel.bind(this));}else{s();}},updateCatalogTilesToGroupsMap:function(){var c=this.getModel().getProperty("/catalogs"),i,t,a,G,C,b,d,e,A,o,s=sap.ushell.Container.getService("LaunchPage");if(c){for(i=0;i<c.length;i++){b=c[i].appBoxes;if(b){for(e=0;e<b.length;e++){A=b[e];t=encodeURIComponent(s.getCatalogTileId(A.src));G=this.oTileCatalogToGroupsMap[t];a=G?G:[];A.associatedGroups=a;}}C=c[i].customTiles;if(C){for(d=0;d<C.length;d++){o=C[d];t=encodeURIComponent(s.getCatalogTileId(o.src));G=this.oTileCatalogToGroupsMap[t];a=G?G:[];o.associatedGroups=a;}}}}this.getModel().setProperty("/catalogs",c);},_getIsIntentSupported:function(c){var s=sap.ushell.Container.getService("LaunchPage"),i=!!(s.isTileIntentSupported(c));return i;},_getIsAppBox:function(c){var s=sap.ushell.Container.getService("LaunchPage"),i=!!(s.getCatalogTileTargetURL(c)&&(s.getCatalogTilePreviewTitle(c)||s.getCatalogTilePreviewSubtitle(c)));return i;},createCatalogAppBoxes:function(c){var s=sap.ushell.Container.getService("LaunchPage"),a=encodeURIComponent(s.getCatalogTileId(c)),b=this.oTileCatalogToGroupsMap[a]||[],t=s.getCatalogTileTags(c)||[];if(t.length>0){this.tagsPool=this.tagsPool.concat(t);}return{id:a,associatedGroups:b,src:c,title:s.getCatalogTilePreviewTitle(c),subtitle:s.getCatalogTilePreviewSubtitle(c),icon:s.getCatalogTilePreviewIcon(c),tags:t,url:s.getCatalogTileTargetURL(c)};},addCatalogToModel:function(c){var C=this.oModel.getProperty('/catalogs'),s=sap.ushell.Container.getService("LaunchPage"),a=s.getCatalogId(c),o={title:s.getCatalogTitle(c),id:s.getCatalogId(c),numberTilesSupportedOnCurrectDevice:0,static:false,customTiles:[],appBoxes:[]},p;C.forEach(function(b){if(b.id===a){return;}});jQuery.sap.measure.resume("FLP:DashboardManager.getCatalogTiles");p=s.getCatalogTiles(c);this.aPromises.push(p);p.done(function(b){jQuery.sap.measure.pause("FLP:DashboardManager.getCatalogTiles");if(!b.length){return;}this.aPendingCatalogQueue.push({oCatalogEntry:b,oCatalogModel:o});clearTimeout(this.oprocessCatalogsTimer);this.oprocessCatalogsTimer=setTimeout(function(){this.processPendingCatalogs();}.bind(this),20);}.bind(this)).fail(this._showLocalizedErrorHelper("fail_to_load_catalog_tiles_msg"));},processPendingCatalogs:function(){var c=this.oModel.getProperty('/catalogs'),p,C,o,e,i,a,b,d,A,f=this.oModel.getProperty('/masterCatalogs')||[{title:g("all")}];jQuery.sap.measure.resume("FLP:DashboardManager.BuildCatalogModelWithRendering");while(this.aPendingCatalogQueue.length>0){p=this.aPendingCatalogQueue.pop(),C=p.oCatalogEntry,o=p.oCatalogModel,e=this.searchModelCatalogByTitle(o.title),a=this.oModel.getProperty('/catalogSearchEntity');if(e.result){b=this.oModel.getProperty('/catalogs')[e.indexOfPreviousInstanceInModel];i=false;}else{i=true;b=o;}C.forEach(function(C,h){if(this._getIsIntentSupported(C)){if(this._getIsAppBox(C)){A=this.createCatalogAppBoxes(C);b.appBoxes.push(A);a.appBoxes.push(A);}else{d=this.createCatalogTiles(C);b.customTiles.push(d);a.customTiles.push(d);}}}.bind(this));if(b.appBoxes.length>0||b.customTiles.length>0){if(i){c.push(o);f.push({title:o.title});}}}this.oModel.setProperty('/masterCatalogs',f);this.oModel.setProperty('/catalogs',c);jQuery.sap.measure.pause("FLP:DashboardManager.BuildCatalogModelWithRendering");},searchModelCatalogByTitle:function(c){var a=this.oModel.getProperty('/catalogs'),b=false,i,n=0,G=false;$.each(a,function(d,t){if(t.title===sap.ushell.resources.i18n.getText('catalogsLoading')){G=true;}else if(c==t.title){i=d;n=t.numberOfTiles;b=true;return false;}});return{result:b,indexOfPreviousInstanceInModel:i,indexOfPreviousInstanceInPage:G?i-1:i,numOfTilesInCatalog:n};},getTagList:function(m){var i={},c=0,t=[],d,T,s;for(c=0;c<this.tagsPool.length;c++){T=this.tagsPool[c];if(i[T]){i[T]++;}else{i[T]=1;}}for(d in i){t.push({tag:d,occ:i[d]});}s=t.sort(function(a,b){return b.occ-a.occ;});if(s.length===0){this.oModel.setProperty("/tagFiltering",false);}if(m){this.oModel.setProperty("/tagList",s.slice(0,m));}else{this.oModel.setProperty("/tagList",s);}},onDoneLoadingCatalogs:function(c){if(!c.length){this.oModel.setProperty("/catalogsNoDataText",sap.ushell.resources.i18n.getText('noCatalogs'));}var e=sap.ui.getCore().getEventBus();e.publish("launchpad","catalogContentLoaded");var s=sap.ushell.Container.getService("LaunchPage"),l=c.filter(function(C){return!s.getCatalogError(C);});if(l.length!==c.length){this._showLocalizedError("partialCatalogFail");}if(this.oModel.getProperty("/tagFiltering")===true){this.getTagList();}sap.ushell.utils.handleTilesVisibility();},createCatalogTiles:function(c){jQuery.sap.require('sap.ushell.ui.launchpad.TileState');var s=sap.ushell.Container.getService("LaunchPage"),t,a=encodeURIComponent(s.getCatalogTileId(c)),b=this.oTileCatalogToGroupsMap[a]||[],d=s.getCatalogTileTags(c)||[];if(d.length>0){this.tagsPool=this.tagsPool.concat(d);}t=new sap.ushell.ui.launchpad.TileState({state:"Loading"});return{associatedGroups:b,src:c,catalog:c.title,catalogId:c.id,title:s.getCatalogTileTitle(c),tags:d,keywords:(s.getCatalogTileKeywords(c)||[]).join(','),id:a,size:s.getCatalogTileSize(c),content:[t],isTileIntentSupported:s.isTileIntentSupported(c),tileType:c.tileType};},calculateCatalogTileIndex:function(c,n,t){var r=parseInt(c*100000,10);r+=(n!==undefined?n:0)+t;return r;},mapCatalogTilesToGroups:function(){this.oTileCatalogToGroupsMap={};var G=this.oModel.getProperty("/groups"),s=sap.ushell.Container.getService("LaunchPage"),i=0,o,t,T,a,b,c;for(i=0;i<G.length;i++){o=G[i];T=o.tiles;if(T){for(t=0;t<T.length;++t){a=encodeURIComponent(s.getCatalogTileId(T[t].object));b=this.oTileCatalogToGroupsMap[a]||[];c=s.getGroupId(o.object);if(b.indexOf(c)===-1&&(typeof(o.isGroupVisible)==='undefined'||o.isGroupVisible)&&!o.isGroupLocked){b.push(c);}this.oTileCatalogToGroupsMap[a]=b;}}}},_showLocalizedMessage:function(m,p,t){sap.ushell.Container.getService("Message").show(t||sap.ushell.services.Message.Type.INFO,g(m,p),p);},_showLocalizedError:function(m,p){this._showLocalizedMessage(m,p,sap.ushell.services.Message.Type.ERROR);},_showLocalizedErrorHelper:function(m,p){var t=this;return function(){t._showLocalizedError(m,p);};},_resetGroupsOnFailureHelper:function(m){var t=this;return function(G){t._showLocalizedError(m);t._requestFailed();setTimeout(function(){t.loadGroupsFromArray(G);});};},_resetGroupsOnFailure:function(m,p){this._requestFailed();this._showLocalizedError(m,p);this.loadPersonalizedGroups();this.oModel.updateBindings(true);},resetGroupsOnFailure:function(){this._resetGroupsOnFailure.apply(this,arguments);},_bindSegment:function(G,s){var a,o,S,b;for(a=0;a<s.length;a++){S=s[a];b=S.index;o=G[b];o.isRendered=true;o.tiles=o.tiles.concat(S.tiles);o.links=o.links.concat(S.links);}return G;},createGroupsModelFrame:function(G,p){var a,c=[],o,C;C=function(b){var d=jQuery.extend({},b);d.tiles=[];d.links=[];return d;};for(a=0;a<G.length;a++){o=G[a];c[a]=C(o);c[a].isRendered=false;c[a].visibilityModes=sap.ushell.utils.calcVisibilityModes(o,p);}return c;},_splitGroups:function(s,G,f){var a,t,b=s,p=f,c=[],d,e,h,i=["tiles","links"],o=1,C,j;C=function(k){var l=jQuery.extend({},k);l.tiles=[];l.links=[];return l;};for(a=0;a<G.length;a++){j=G[a];d=C(j);c.push(d);for(e=0;e<i.length;e++){h=i[e];o=this.PagingManager.getSizeofSupportedElementInUnits(h==='links'?'link':'tile');for(t=0;t<j[h].length;t++){if(p<=0){p=b;if(c){this.segmentsStore.push(c);}d=C(j);c=[];c.push(d);}d[h].push(j[h][t]);p-=o;}}}if(c){this.segmentsStore.push(c);}},_processSegment:function(m){var e=sap.ui.getCore().getEventBus(),a,b,t;if(this.segmentsStore.length>0){a=this.segmentsStore.shift();b=a[0].index;t=m[b].tiles.length+m[b].links.length;m=this._bindSegment(m,a);this.oModel.setProperty('/groups',m);this._updateModelWithTileView(b,t);this._handleSegment();}else{this._updateModelWithTileView(0,0);sap.ushell.utils.handleTilesVisibility();e.publish("launchpad","dashboardModelContentLoaded");}},_handleBookmarkModelUpdate:function(){this.bIsGroupsModelDirty=false;this.bGroupsModelLoadingInProcess=true;this.loadPersonalizedGroups();},_modelLoaded:function(){this.bGroupsModelLoadingInProcess=false;if(this.bIsGroupsModelDirty){this._handleBookmarkModelUpdate();}},_handleSegment:function(){clearTimeout(this.oSegmentTimer);this.oSegmentTimer=setTimeout(function(){this._processSegment(this.oModel.getProperty('/groups'));}.bind(this),100);},loadGroupsFromArray:function(G){var t=this;jQuery.sap.measure.start("FLP:DashboardManager.loadGroupsFromArray","loadGroupsFromArray","FLP");this.oPageBuilderService.getDefaultGroup().done(function(d){if(G.length==0&&d==undefined){return;}var i=0,l=[],b,a=G.indexOf(d),n,N,c=[],o,e,f,m,s,h,j,k={desktop:5,tablet:10,phone:15},p=0,q=0,r,u=0,D,v;G.splice(a,1);while(i<G.length){o=G[i];e=t.oPageBuilderService.isGroupLocked(o);if(e){l.push(o);G.splice(i,1);}else{i++;}}n=l.length;if(!t.oModel.getProperty('/disableSortedLockedGroups')){l.sort(function(x,y){var w=t.oPageBuilderService.getGroupTitle(x).toLowerCase(),z=t.oPageBuilderService.getGroupTitle(y).toLowerCase();return w<z?-1:1;});}b=l;b.push(d);b.push.apply(b,G);G=b;f=G.length;m=t.oModel.getProperty("/groups/length");t.oModel.setProperty("/groups/indexOfDefaultGroup",n);for(i=f;i<m;++i){t._destroyGroupModel("/groups/"+i);}if(!t.PagingManager){jQuery.sap.require("sap.ushell.components.flp.launchpad.PagingManager");t.PagingManager=new sap.ushell.components.flp.launchpad.PagingManager('dashboardPaging',{supportedElements:{tile:{className:'sapUshellTile'},link:{className:'sapUshellLinkTile'}},containerHeight:window.innerHeight,containerWidth:window.innerWidth});if(t.PagingManager.currentPageIndex===0){t.PagingManager.moveToNextPage();p=t.PagingManager._calcElementsPerPage();}}h=t.PagingManager.getSizeofSupportedElementInUnits('link');j=t.PagingManager.getSizeofSupportedElementInUnits('tile');jQuery.sap.measure.start("FLP:DashboardManager._getGroupModel","_getGroupModel","FLP");for(i=0;i<f;++i){N=t._getGroupModel(G[i],i===n,i===f-1);if(i==0){N.isGroupSelected=true;}N.index=i;u+=N.tiles.length*j+N.links.length*h;c.push(N);}jQuery.sap.measure.end("FLP:DashboardManager._getGroupModel");if(sap.ui.Device.system.desktop){q=k.desktop;}else if(sap.ui.Device.system.tablet){q=k.tablet;}else{q=k.phone;}s=(u-p)/q;if(s<14){s=14;}r=t.createGroupsModelFrame(c,t.oModel.getProperty("/personalization"));t._splitGroups(s,c,p);jQuery.sap.measure.start("FLP:DashboardManager._processSegment","_processSegment","FLP");t._processSegment(r);if(t.oModel.getProperty("/homePageGroupDisplay")&&t.oModel.getProperty("/homePageGroupDisplay")==='tabs'){D=t.getDashboardView();v=D.oDashboardGroupsBox;for(var i=0;i<r.length;i++){if(r[i].isGroupVisible&&r[i].visibilityModes[0]){t.oModel.setProperty("/groups/"+i+"/isGroupSelected",true);break;}}v.getBinding('groups').filter([D.oFilterSelectedGroup]);}jQuery.sap.measure.end("FLP:DashboardManager._processSegment");t.oModel.setProperty("/groups/length",r.length);if(t.oModel.getProperty('/currentState/stateName')==="catalog"){}jQuery.sap.measure.end("FLP:DashboardManager.loadGroupsFromArray");}).fail(t._resetGroupsOnFailureHelper("fail_to_get_default_group_msg"));},_loadGroup:function(n,G,h){var t=this,s="/groups/"+n,d=t.oModel.getProperty("/groups/indexOfDefaultGroup"),i=t.oModel.getProperty(s).isLastGroup,o,N;this._destroyGroupModel(s);o=this.oModel.getProperty(s+"/groupId");N=this._getGroupModel(G,n===d,i,undefined,h);if(o){N.groupId=o;}N.index=n;N.isRendered=true;this.oModel.setProperty(s,N);},_getGroupModel:function(G,d,l,D,h){var s=this.oPageBuilderService,a=(G&&s.getGroupTiles(G))||[],m=[],M=[],i,b,o=this.getModel();b=o.getProperty("/personalization");var c=G&&s.isGroupLocked(G)?true:false;for(i=0;i<a.length;++i){var t=a[i],T=s.getTileType(t).toLowerCase();if(T==="tile"){m.push(this._getTileModel(a[i],c,T,h));}else if(T==="link"){M.push(this._getTileModel(a[i],c,T,h));}else{jQuery.sap.log.error("Unknown tile type: '"+T+"'",undefined,"sap.ushell.components.flp.launchpad.DashboardManager");}}return{title:(d&&g("my_group"))||(G&&s.getGroupTitle(G))||(D&&D.title)||"",object:G,groupId:jQuery.sap.uid(),links:M,tiles:m,isDefaultGroup:d||false,editMode:!G,isGroupLocked:c,visibilityModes:[true,true],removable:!G||s.isGroupRemovable(G),sortable:b,isGroupVisible:!G||s.isGroupVisible(G),isEnabled:!d,isLastGroup:l||false,isRendered:D?!!D.isRendered:false,isGroupSelected:false};},_addTileToGroup:function(G,t){var T=G+"/tiles",o=this.oModel.getProperty(G),n=this.oModel.getProperty(T).length,s=this.oPageBuilderService,a=s.getTileType(t);var i=this.oModel.getProperty(G+"/isGroupLocked"),p=this.oModel.getProperty("/personalization");o.tiles[n]=this._getTileModel(t,i,a,this._addModelToTileViewUpdateQueue);o.visibilityModes=sap.ushell.utils.calcVisibilityModes(o,p);this._updateModelWithTileView(o.index,n);this.oModel.setProperty(G,o);},_addAndUpdateModelWithTileView:function(t,T){this._addModelToTileViewUpdateQueue(t,T);this._updateModelWithTileView(0,0);},_addModelToTileViewUpdateQueue:function(t,T){this.tileViewUpdateQueue.push({uuid:t,view:T});},_updateModelWithTileView:function(s,a){var t=this;if(this.tileViewUpdateTimeoutID){clearTimeout(this.tileViewUpdateTimeoutID);}this.tileViewUpdateTimeoutID=setTimeout(function(){t.tileViewUpdateTimeoutID=undefined;t.oSortableDeferred.done(function(){t._updateModelWithTilesViews(s,a);});},50);},_updateModelWithTilesViews:function(s,a){var G=this.oModel.getProperty("/groups"),t,l,T,u,S,L,b=s||0,c=a||0,h=[];if(!G||this.tileViewUpdateQueue.length===0){return;}for(var i=b;i<G.length;i=i+1){t=G[i].tiles;l=G[i].links;t=t.concat(l);for(var j=c;j<t.length;j=j+1){T=t[j];for(var q=0;q<this.tileViewUpdateQueue.length;q++){u=this.tileViewUpdateQueue[q];if(T.uuid==u.uuid){h.push(q);if(u.view){T.content[0].destroy();T.content=[u.view];S=this.oPageBuilderService.getTileSize(T.object);L=((S!==null)&&(S==="1x2"))||false;if(T['long']!==L){T['long']=L;}}else{T.content[0].setState("Failed");}break;}}}}var d=[],e;for(e=0;e<this.tileViewUpdateQueue.length;e++){if(h.indexOf(e)===-1){d.push(this.tileViewUpdateQueue[e]);}}this.tileViewUpdateQueue=d;this.oModel.setProperty("/groups",G);},getModelTileById:function(i){var G=this.oModel.getProperty('/groups'),m;G.forEach(function(o){o.tiles.forEach(function(t){if(t.uuid===i||t.originalTileId===i){m=t;return;}});});return m;},_getTileModel:function(t,i,T,u){var s=this.oPageBuilderService,a=jQuery.sap.uid(),o,b=this,d,c,U;this.sTileType=T;s.setTileVisible(t,false);d=s.getTileView(t);d.done(function(v){o=v;if(U){U.apply(b,[a,o]);b._handleSegment();}});d.fail(function(){if(U){U.apply(b,[a]);b._handleSegment();}else{jQuery.sap.require('sap.ushell.ui.launchpad.TileState');if(b.sTileType==="link"){o=new sap.m.Link({text:sap.ushell.resources.i18n.getText('cannotLoadTile')});}else{o=new sap.ushell.ui.launchpad.TileState({state:"Failed"});}}});if(!o){U=u?u:this._addModelToTileViewUpdateQueue;jQuery.sap.require('sap.ushell.ui.launchpad.TileState');o=new sap.ushell.ui.launchpad.TileState({state:"Loading"});}if(T==="link"){c={"object":t,"originalTileId":s.getTileId(t),"uuid":a,"tileCatalogId":encodeURIComponent(s.getCatalogTileId(t)),"content":[o],"target":s.getTileTarget(t)||"","debugInfo":s.getTileDebugInfo(t),"isTileIntentSupported":s.isTileIntentSupported(t),"isLocked":i};}else if(T==="tile"){var S=s.getTileSize(t);c={"object":t,"originalTileId":s.getTileId(t),"uuid":a,"tileCatalogId":encodeURIComponent(s.getCatalogTileId(t)),"content":[o],"long":((S!==null)&&(S==="1x2"))||false,"target":s.getTileTarget(t)||"","debugInfo":s.getTileDebugInfo(t),"isTileIntentSupported":s.isTileIntentSupported(t),"rgba":"","isLocked":i,"showActionsIcon":this.oModel.getProperty("/tileActionsIconEnabled")||false};}return c;},_destroyAllGroupModels:function(t){var G=(typeof t==="string")?this.oModel.getProperty(t):t,i;if(G){for(i=0;i<G.length;i=i+1){this._destroyGroupModel(G[i]);}}},_destroyGroupModel:function(t){var G=(typeof t==="string")?this.oModel.getProperty(t):t;if(G){this._destroyAllTileModels(G.tiles);}},_destroyAllTileModels:function(t){var T=(typeof t==="string")?this.oModel.getProperty(t):t,i;if(T){for(i=0;i<T.length;i=i+1){this._destroyTileModel(T[i]);}}},_destroyTileModel:function(t){var T=(typeof t==="string")?this.oModel.getProperty(t):t,i;if(T&&T.content){for(i=0;i<T.content.length;i=i+1){T.content[i].destroy();}}},loadPersonalizedGroups:function(){var t=this,G=this.oPageBuilderService.getGroups(),d=new jQuery.Deferred();G.done(function(a){t.loadGroupsFromArray(a);d.resolve();});G.fail(function(){t._showLocalizedErrorHelper("fail_to_load_groups_msg")();d.reject();});return d;}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.flp.launchpad.appfinder.AppFinder.controller')){jQuery.sap.declare('sap.ushell.components.flp.launchpad.appfinder.AppFinder.controller');(function(){"use strict";sap.ui.controller("sap.ushell.components.flp.launchpad.appfinder.AppFinder",{onInit:function(){sap.ushell.Container.getRenderer("fiori2").createExtendedShellState("appFinderExtendedShellState",function(){sap.ushell.Container.getRenderer("fiori2").showHeaderItem('backBtn',true);sap.ushell.Container.getRenderer("fiori2").showHeaderItem('homeBtn',true);});var v=this.getView(),m=v.getModel(),s=v.showEasyAccessMenu;if(!m.getProperty("/groups")||m.getProperty("/groups").length===0){var d=sap.ushell.components.flp.launchpad.getDashboardManager();d.loadPersonalizedGroups();}this.getView().setModel(this._getSubHeaderModel(),"subHeaderModel");this.oConfig=v.parentComponent.getComponentData().config;this.catalogView=sap.ui.view("catalogView",{type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.ushell.components.flp.launchpad.appfinder.Catalog",height:"100%",viewData:{parentComponent:v.parentComponent,subHeaderModel:this._getSubHeaderModel()}});this.catalogView.addStyleClass('sapUiGlobalBackgroundColor sapUiGlobalBackgroundColorForce');this._addViewCustomData(this.catalogView,"appFinderCatalogTitle");this.oRouter=this.getView().parentComponent.getRouter();this.oRouter.getRoute("catalog").attachPatternMatched(function(e){this._navigateTo.apply(this,["appFinder","catalog"]);}.bind(this));this.oRouter.getRoute("appFinder").attachPatternMatched(function(e){this._preloadAppHandler();this._getPathAndHandleGroupContext(e);v.createSubHeader();this._toggleViewWithToggleButtonClass(this._showOpenCloseSplitAppButton());if(s){this.onShow(e);}else if(this.getView()._showSearch('catalog')){v.updateSubHeader('catalog',false);this._toggleViewWithSearchAndTagsClasses('catalog');}sap.ui.getCore().getEventBus().publish("showCatalog");}.bind(this));if(!s){v.oPage.addContent(this.catalogView);setTimeout(function(){jQuery('#catalogSelect').focus();},0);}sap.ui.Device.resize.attachHandler(this._resizeHandler.bind(this));},_resizeHandler:function(){var s=this._showOpenCloseSplitAppButton();var c=this.oSubHeaderModel.getProperty('/openCloseSplitAppButtonVisible');if(s!=c){this.oSubHeaderModel.setProperty('/openCloseSplitAppButtonVisible',s);if(s){this.oSubHeaderModel.setProperty('/openCloseSplitAppButtonToggled',false);}}this._toggleViewWithToggleButtonClass(s);},_showOpenCloseSplitAppButton:function(){return!sap.ui.Device.orientation.landscape||sap.ui.Device.system.phone;},_resetSubHeaderModel:function(){this.oSubHeaderModel.setProperty('/activeMenu',null);this.oSubHeaderModel.setProperty('/search',{searchMode:false,searchTerm:null});this.oSubHeaderModel.setProperty('/tag',{tagMode:false,selectedTags:[]});this.oSubHeaderModel.setProperty('/openCloseSplitAppButtonVisible',this._showOpenCloseSplitAppButton());this.oSubHeaderModel.setProperty('/openCloseSplitAppButtonToggled',false);},_getSubHeaderModel:function(){if(this.oSubHeaderModel){return this.oSubHeaderModel;}this.oSubHeaderModel=new sap.ui.model.json.JSONModel();this._resetSubHeaderModel();return this.oSubHeaderModel;},onTagsFilter:function(e){var t=e.getSource(),s=t.getModel('subHeaderModel'),S=e.getSource().getSelectedItems(),T=S.length>0,o={tagMode:T,selectedTags:[]};S.forEach(function(a,i){o.selectedTags.push(a.getText());});s.setProperty('/activeMenu',this.getCurrentMenuName());s.setProperty('/tag',o);},searchHandler:function(e){var s=e.getSource().getValue();if(!s){return;}var S=this.oSubHeaderModel.getProperty('/search');var a=this.oSubHeaderModel.getProperty('/activeMenu');if(this.getCurrentMenuName()!=a){a=this.getCurrentMenuName();}if(!S.searchMode&&!e.getParameter('clearButtonPressed')){S.searchMode=true;}if(S.searchMode&&sap.ui.Device.system.phone){this.oSubHeaderModel.setProperty("/openCloseSplitAppButtonToggled",false);}if(s!=S.searchTerm){if(this.containsOnlyWhiteSpac(s)){s='*';}S.searchTerm=s;}this.oSubHeaderModel.setProperty("/search",S);this.oSubHeaderModel.setProperty("/activeMenu",a);this.oSubHeaderModel.refresh(true);},_preloadAppHandler:function(){setTimeout(function(){if(sap.ushell.Container){sap.ushell.Container.getRenderer("fiori2").applyExtendedShellState("appFinderExtendedShellState");}this._updateShellHeader(this.oView.oPage.getTitle());}.bind(this),0);},getCurrentMenuName:function(){return this.currentMenu;},_navigateTo:function(n,m){var g=this.oView.getModel().getProperty("/groupContext");var G=g?g.path:null;if(G){this.oRouter.navTo(n,{'menu':m,filters:JSON.stringify({targetGroup:encodeURIComponent(G)})},true);}else{this.oRouter.navTo(n,{'menu':m},true);}},getSystemsModel:function(){if(this.getSystemsPromise){return this.getSystemsPromise;}var e=new sap.ui.model.json.JSONModel();e.setProperty('/systemSelected',null);e.setProperty('/systemsList',[]);this.getSystemsPromise=this.getSystems().then(function(r){e.setProperty("/systemsList",r);return e;});return this.getSystemsPromise;},onSegmentButtonClick:function(e){switch(e.getParameters().id){case"catalog":this._navigateTo("appFinder","catalog");break;case"userMenu":this._navigateTo("appFinder","userMenu");break;case"sapMenu":this._navigateTo("appFinder","sapMenu");break;}},onShow:function(e){var p=e.getParameter('arguments');var m=p.menu;if(m===this.getCurrentMenuName()){return;}var v=this.getView();v._updateSearchWithPlaceHolder(m);this._updateCurrentMenuName(m);this.getSystemsModel().then(function(s){var a=s.getProperty("/systemsList");v.oPage.removeAllContent();if(a&&a.length){v.updateSubHeader(this.currentMenu,true);}else if(v._showSearch(this.currentMenu)){v.updateSubHeader(this.currentMenu,false);}if(this.currentMenu==='catalog'){v.oPage.addContent(this.catalogView);}else if(this.currentMenu==='userMenu'){if(!this.userMenuView){this.userMenuView=new sap.ui.view("userMenuView",{type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.ushell.components.flp.launchpad.appfinder.EasyAccess",height:"100%",viewData:{menuName:"USER_MENU",easyAccessSystemsModel:s,parentComponent:v.parentComponent,subHeaderModel:this._getSubHeaderModel(),enableSearch:this.getView()._showSearch("userMenu")}});this._addViewCustomData(this.userMenuView,"appFinderUserMenuTitle");}v.oPage.addContent(this.userMenuView);}else if(this.currentMenu==='sapMenu'){if(!this.sapMenuView){this.sapMenuView=new sap.ui.view("sapMenuView",{type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.ushell.components.flp.launchpad.appfinder.EasyAccess",height:"100%",viewData:{menuName:"SAP_MENU",easyAccessSystemsModel:s,parentComponent:v.parentComponent,subHeaderModel:this._getSubHeaderModel(),enableSearch:this.getView()._showSearch("sapMenu")}});this._addViewCustomData(this.sapMenuView,"appFinderSapMenuTitle");}v.oPage.addContent(this.sapMenuView);}this._setFocusToSegmentedButton(a);this.oSubHeaderModel.setProperty("/activeMenu",this.currentMenu);if(this.oSubHeaderModel.getProperty("/openCloseSplitAppButtonVisible")){this.oSubHeaderModel.setProperty("/openCloseSplitAppButtonToggled",false);}this.oSubHeaderModel.refresh(true);}.bind(this));},_updateCurrentMenuName:function(m){var v=this.getView();if(!v.showEasyAccessMenu||(m==="sapMenu"&&!v.enableEasyAccessSAPMenu)||(m==="userMenu"&&!v.enableEasyAccessUserMenu)){this.currentMenu="catalog";}else{this.currentMenu=m;}this._toggleViewWithSearchAndTagsClasses(m);},_toggleViewWithSearchAndTagsClasses:function(m){var v=this.getView();if(v._showSearch(m)){v.oPage.addStyleClass('sapUshellAppFinderSearch');}else{v.oPage.removeStyleClass('sapUshellAppFinderSearch');}if(v._showSearchTag(m)){v.oPage.addStyleClass('sapUshellAppFinderTags');}else{v.oPage.removeStyleClass('sapUshellAppFinderTags');}},_toggleViewWithToggleButtonClass:function(b){var v=this.getView();if(b){v.oPage.addStyleClass('sapUshellAppFinderToggleButton');}else{v.oPage.removeStyleClass('sapUshellAppFinderToggleButton');}},_setFocusToSegmentedButton:function(s){var v=this.getView();if(s&&s.length){var b=v.segmentedButton.getSelectedButton();setTimeout(function(){jQuery("#"+b).focus();},0);}else{setTimeout(function(){jQuery('#catalogSelect').focus();},0);}},_getPathAndHandleGroupContext:function(e){var p=e.getParameter('arguments');var d=p.filters;var D=d?JSON.parse(d):d;var P=(D&&decodeURIComponent(D.targetGroup))||"";P=P==='undefined'?undefined:P;this._updateModelWithGroupContext(P);},_updateModelWithGroupContext:function(p){var l=sap.ushell.Container.getService("LaunchPage"),m=this.oView.getModel(),g,G={path:p,id:"",title:""};if(p&&p!==""){var t=function(){var M=m.getProperty("/groups");if(M.length){g=m.getProperty(p);G.id=l.getGroupId(g.object);G.title=g.title||l.getGroupTitle(g.object);return;}setTimeout(t,100);};t();}m.setProperty("/groupContext",G);},getSystems:function(){var d=new jQuery.Deferred();var s=[];var c=sap.ushell.Container.getService("ClientSideTargetResolution");if(!c){d.reject("cannot get ClientSideTargetResolution service");}else{c.getEasyAccessSystems().done(function(S){var a=Object.keys(S);for(var i=0;i<a.length;i++){var C=a[i];s[i]={"systemName":S[C].text,"systemId":C};}d.resolve(s);}).fail(function(e){d.reject("An error occurred while retrieving the systems: "+e);});}return d.promise();},_addViewCustomData:function(v,t){var r=sap.ushell.resources.i18n;v.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"role",value:"region",writeToDom:true}));v.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-label",value:r.getText(t),writeToDom:true}));},_initializeShellUIService:function(){jQuery.sap.require("sap.ushell.ui5service.ShellUIService");this.oShellUIService=new sap.ushell.ui5service.ShellUIService({scopeObject:this.getOwnerComponent(),scopeType:"component"});},_updateShellHeader:function(t){if(!this.oShellUIService){this._initializeShellUIService();}this.oShellUIService.setTitle(t);this.oShellUIService.setHierarchy([{icon:'sap-icon://home',title:'Home',intent:'#'}]);},containsOnlyWhiteSpac:function(t){if(!t||t==="")return false;var T=t;return(!T.replace(/\s/g,'').length)}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.flp.launchpad.appfinder.HierarchyApps.view')){jQuery.sap.declare('sap.ushell.components.flp.launchpad.appfinder.HierarchyApps.view');(function(){"use strict";sap.ui.jsview("sap.ushell.components.flp.launchpad.appfinder.HierarchyApps",{createContent:function(c){this.oController=c;function g(G,b,s,a,d){var r=sap.ushell.resources.i18n,t;if(s){var i=jQuery.inArray(a,G);var T=i!==-1?"removeAssociatedTileFromContextGroup":"addAssociatedTileToContextGroup";t=r.getText(T,d);}else{t=b?r.getText("EasyAccessMenu_PinButton_Toggled_Tooltip"):r.getText("EasyAccessMenu_PinButton_UnToggled_Tooltip");}return t;}var p=new sap.ushell.ui.appfinder.PinButton({icon:'sap-icon://pushpin-off',selected:{path:"easyAccess>bookmarkCount",formatter:function(b){return(!!b);}},tooltip:{parts:["associatedGroups","easyAccess>bookmarkCount","/groupContext/path","/groupContext/id","/groupContext/title"],formatter:function(G,b,s,a,d){return g(G,b,s,a,d);}},press:c.showSaveAppPopover.bind(c)});p.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"tabindex",value:"-1",writeToDom:true}));p.addStyleClass("sapUshellPinButton");this.oItemTemplate=new sap.ushell.ui.appfinder.AppBox({title:"{easyAccess>text}",subtitle:"{easyAccess>subtitle}",url:"{easyAccess>url}",icon:"{easyAccess>icon}",pinButton:p,tabindex:{path:"easyAccess>text"},press:[c.onAppBoxPressed,c]});this.oItemTemplate.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"tabindex",value:"-1",writeToDom:true}));this.layout=new sap.m.FlexBox(this.getId()+'_hierarchyAppsLayout',{items:{path:"easyAccess>/apps",template:this.oItemTemplate},wrap:sap.m.FlexWrap.Wrap});this.layout.addDelegate({onAfterRendering:function(){var i=this.getItems();var u=function(a){if(a.getKey()==="tabindex"){a.setValue("0");}};if(i.length){i[0].getCustomData().forEach(u);i[0].getPinButton().getCustomData().forEach(u);}}.bind(this.layout)});this.oMessagePage=new sap.m.MessagePage({visible:false,showHeader:false,text:sap.ushell.resources.i18n.getText('EasyAccessMenu_NoAppsToDisplayMessagePage_Text'),description:''});var C=[];if(this.getViewData()&&this.getViewData().navigateHierarchy){this.crumbsModel=new sap.ui.model.json.JSONModel({crumbs:[]});this.linkTemplate=new sap.m.Link({text:"{crumbs>text}",press:function(e){var a=e.oSource.getBinding("text").getContext().getObject();this.getViewData().navigateHierarchy(a.path,false);}.bind(this)});this.breadcrumbs=new sap.m.Breadcrumbs({links:{path:"crumbs>/crumbs",template:this.linkTemplate},currentLocationText:"{/text}"});this.breadcrumbs.setModel(this.crumbsModel,"crumbs");C.push(this.breadcrumbs);}else{this.resultText=new sap.m.Text({text:{parts:[{path:"easyAccessSystemsModel>/systemSelected"},{path:"easyAccess>/total"}],formatter:c.resultTextFormatter.bind(c)}}).addStyleClass('sapUshellEasyAccessSearchResultText');this.resultText.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"role",value:"heading",writeToDom:true}));this.resultText.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-level",value:"3",writeToDom:true}));C.push(this.resultText);this.showMoreResultsLink=new sap.m.Button({text:{parts:[{path:"easyAccess>/apps"},{path:"easyAccess>/total"}],formatter:c.showMoreResultsTextFormatter.bind(c)},press:this.getViewData().getMoreSearchResults,visible:{parts:[{path:"easyAccess>/apps"},{path:"easyAccess>/total"}],formatter:c.showMoreResultsVisibilityFormatter.bind(c)},type:sap.m.ButtonType.Transparent});}C.push(this.oMessagePage);C.push(this.layout);if(this.showMoreResultsLink){C.push(this.showMoreResultsLink)}return C;},updateResultSetMessage:function(i,I){var e;if(I){e='noFilteredItems';}else{e='EasyAccessMenu_NoAppsToDisplayMessagePage_Text';}if(i){if(I){this.resultText.updateProperty('text');this.resultText.setVisible(true);}this.layout.setVisible(true);this.oMessagePage.setVisible(false);}else{if(I){this.resultText.setVisible(false);}this.layout.setVisible(false);this.oMessagePage.setVisible(true);var E=sap.ushell.resources.i18n.getText(e);this.oMessagePage.setText(E);}},setShowMoreResultsBusy:function(b){if(this.showMoreResultsLink){this.showMoreResultsLink.setBusy(b);}},getControllerName:function(){return"sap.ushell.components.flp.launchpad.appfinder.HierarchyApps";}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.flp.launchpad.dashboard.DashboardContent.controller')){jQuery.sap.declare('sap.ushell.components.flp.launchpad.dashboard.DashboardContent.controller');(function(){"use strict";sap.ui.controller("sap.ushell.components.flp.launchpad.dashboard.DashboardContent",{onInit:function(){var e=sap.ui.getCore().getEventBus();this.handleDashboardScroll=this._handleDashboardScroll.bind(this);e.subscribe("launchpad","appClosed",this._resizeHandler,this);e.subscribe("launchpad","appOpened",this._appOpenedHandler,this);e.subscribe("launchpad","dashboardModelContentLoaded",this._modelLoaded,this);e.subscribe('launchpad','actionModeInactive',this._handleGroupVisibilityChanges,this);window.document.addEventListener("visibilitychange",sap.ushell.utils.handleTilesVisibility,false);this.sViewId="#"+this.oView.getId();if(sap.ui.Device.browser.mobile){e.subscribe("launchpad","contentRefresh",this._webkitMobileRenderFix,this);}this.isDesktop=(sap.ui.Device.system.desktop&&(navigator.userAgent.toLowerCase().indexOf('tablet')<0));this.isNotificationPreviewLoaded=false;this._setCenterViewPortShift();},onExit:function(){var e=sap.ui.getCore().getEventBus();e.unsubscribe("launchpad","contentRefresh",this._webkitMobileRenderFix,this);e.unsubscribe("launchpad","appClosed",this._resizeHandler,this);e.unsubscribe("launchpad","appOpened",this._appOpenedHandler,this);e.unsubscribe("launchpad","dashboardModelContentLoaded",this._modelLoaded,this);window.document.removeEventListener("visibilitychange",sap.ushell.utils.handleTilesVisibility,false);},onAfterRendering:function(){var e=sap.ui.getCore().getEventBus(),v=this.getView(),d=v.getDomRef(),s=d.getElementsByTagName('section'),m,t,g,i,a;jQuery(s[0]).off("scrollstop",this.handleDashboardScroll);jQuery(s[0]).on("scrollstop",this.handleDashboardScroll);e.unsubscribe("launchpad","scrollToGroup",this._scrollToGroup,this);e.subscribe("launchpad","scrollToGroup",this._scrollToGroup,this);e.unsubscribe("launchpad","scrollToFirstVisibleGroup",this._scrollToFirstVisibleGroup,this);e.subscribe("launchpad","scrollToFirstVisibleGroup",this._scrollToFirstVisibleGroup,this);sap.ui.Device.orientation.attachHandler(function(){var j=jQuery('#dashboardGroups').find('.sapUshellTileContainer:visible');if(j.length){m=this.getView().getModel();t=m.getProperty('/topGroupInViewPortIndex');if(j.get(t)){g=sap.ui.getCore().byId(j.get(t).id);i=m.getProperty('/editTitle');this._publishAsync("launchpad","scrollToGroup",{group:g,isInEditTitle:i});}}},this);jQuery(window).bind("resize",function(){clearTimeout(a);a=setTimeout(this._resizeHandler.bind(this),300);}.bind(this));if(this.getView().getModel().getProperty("/personalization")&&!sap.ushell.components.flp.ActionMode){jQuery.sap.require("sap.ushell.components.flp.ActionMode");sap.ushell.components.flp.ActionMode.init(this.getView().getModel());}this._updateTopGroupInModel();},_setCenterViewPortShift:function(){var v=sap.ui.getCore().byId("viewPortContainer");if(v){v.shiftCenterTransition(true);}},_dashboardDeleteTileHandler:function(e){var t=e.getSource(),T=t.getBindingContext().getObject().object,d={originalTileId:sap.ushell.Container.getService("LaunchPage").getTileId(T)};sap.ui.getCore().getEventBus().publish("launchpad","deleteTile",d,this);},dashboardTilePress:function(e){var t=e.getSource();if(t&&document.activeElement.tagName!=="INPUT"){sap.ushell.components.flp.ComponentKeysHandler.setTileFocus(t.$());}sap.ui.getCore().getEventBus().publish("launchpad","dashboardTileClick");},_updateTopGroupInModel:function(){var m=this.getView().getModel(),t=this._getIndexOfTopGroupInViewPort();m.setProperty('/topGroupInViewPortIndex',t);},_getIndexOfTopGroupInViewPort:function(){var v=this.getView(),d=v.getDomRef(),s=d.getElementsByTagName('section'),j=$(s).find('.sapUshellTileContainer'),o=j.not('.sapUshellHidden').first().offset(),f=(o&&o.top)||0,t=[],n=s[0].scrollTop,a=0;if(!j||!o){return a;}j.each(function(){if(!jQuery(this).hasClass("sapUshellHidden")){var c=jQuery(this).parent().offset().top;t.push([c,c+jQuery(this).parent().height()]);}});var b=n+f;jQuery.each(t,function(i,c){var e=c[0],g=c[1];if(e-24<=b&&b<=g){a=i;return false;}});return a;},_handleDashboardScroll:function(){var v=this.getView(),m=v.getModel(),n=1000;var h=m.getProperty("/homePageGroupDisplay"),e=h!=="tabs",t=m.getProperty("/tileActionModeActive");function H(){sap.ushell.utils.handleTilesVisibility();}clearTimeout(this.timeoutId);this.timeoutId=setTimeout(H,n);v.oAnchorNavigationBar.closeOverflowPopup();if(e||t){this._updateTopGroupInModel();}v.oAnchorNavigationBar.reArrangeNavigationBarElements();},_handleGroupDeletion:function(g){jQuery.sap.require('sap.m.MessageBox');var e=sap.ui.getCore().getEventBus(),G=g.getObject(),i=G.removable,s=G.title,a=G.groupId,r=sap.ushell.resources.i18n,m=sap.ushell.Container.getService("Message"),A=sap.m.MessageBox.Action,c=(i?A.DELETE:r.getText('ResetGroupBtn')),v=this.getView();m.confirm(r.getText(i?'delete_group_msg':'reset_group_msg',s),function(o){if(o===c){e.publish("launchpad",i?'deleteGroup':'resetGroup',{groupId:a});}},r.getText(i?'delete_group':'reset_group'),[c,A.CANCEL]);v.oAnchorNavigationBar.updateVisibility();},_modelLoaded:function(){this.bModelInitialized=true;sap.ushell.Layout.getInitPromise().then(function(){this._initializeUIActions();}.bind(this));},_initializeUIActions:function(){var d=new sap.ushell.components.flp.launchpad.dashboard.DashboardUIActions();d.initializeUIActions(this);},_forceBrowserRerenderElement:function(e){var a=window.requestAnimationFrame||window.webkitRequestAnimationFrame;if(a){a(function(){var d=e.style.display;e.style.display='none';e.style.display=d;});}else{jQuery.sap.log.info('unsupported browser for animation frame');}},_webkitMobileRenderFix:function(){if(sap.ui.Device.browser.chrome||sap.ui.Device.os.android){this._forceBrowserRerenderElement(document.body);}},_resizeHandler:function(){this._addBottomSpace();sap.ushell.utils.handleTilesVisibility();var i=jQuery.find("#dashboardGroups:visible").length;if(sap.ushell.Layout&&i){sap.ushell.Layout.reRenderGroupsLayout(null);this._initializeUIActions();}},_appOpenedHandler:function(c,e,d){var v,p,P,m=this.getView().getModel();p=this.getOwnerComponent();P=p.getMetadata().getComponentName();if(d.additionalInformation.indexOf(P)===-1){sap.ushell.utils.setTilesNoVisibility();v=sap.ui.getCore().byId("viewPortContainer");if(v){v.shiftCenterTransition(false);}}if(sap.ushell.components.flp.ActionMode&&sap.ushell.components.flp.ActionMode.oModel&&sap.ushell.components.flp.ActionMode.oModel.getProperty("/tileActionModeActive")){sap.ushell.components.flp.ActionMode.toggleActionMode(m,"Menu Item");}},_addBottomSpace:function(){sap.ushell.utils.addBottomSpace();},_scrollToFirstVisibleGroup:function(c,e,d){var g,v=this.oView.oDashboardGroupsBox.getGroups(),f=d.fromTop>0?d.fromTop:0;if(d.group){g=d.group.getGroupId();}else{g=d.groupId;}if(v){jQuery.each(v,function(n,G){if(G.getGroupId()===g){var y=document.getElementById(G.sId).offsetTop;jQuery('.sapUshellDashboardView section').stop().animate({scrollTop:y+f},0);sap.ushell.components.flp.ComponentKeysHandler.setTileFocus(jQuery("#"+G.getId()+" li").first());return false;}});sap.ushell.utils.addBottomSpace();}},_scrollToGroup:function(c,e,d){var g,D,t=this;if(d.iDuration==undefined){D=500;}else{D=d.iDuration;}if(d.group){g=d.group.getGroupId();}else{g=d.groupId;}if(this.oView.oDashboardGroupsBox.getGroups()){jQuery.each(this.oView.oDashboardGroupsBox.getGroups(),function(n,G){if(G.getGroupId()===g){var y;setTimeout(function(){y=-1*(document.getElementById('dashboardGroups').getBoundingClientRect().top)+document.getElementById(G.sId).getBoundingClientRect().top;var a=jQuery(document.getElementById(G.sId)).find(".sapUshellTileContainerHeader").height();var b=jQuery(document.getElementById(G.sId)).find(".sapUshellTileContainerBeforeContent").height();var i=G.getModel().getProperty('/tileActionModeActive');y=a>0&&!i?y+48:y+b+8;jQuery('.sapUshellDashboardView section').stop().animate({scrollTop:y},D,function(){if(d.groupChanged){if(!d.restoreLastFocusedTile){sap.ushell.components.flp.ComponentKeysHandler.setTileFocus(jQuery("#"+G.getId()+" li").first());}}if(d.restoreLastFocusedTile){var T="#"+G.getId();var l=false;if(d.restoreLastFocusedTileContainerById){T="#"+d.restoreLastFocusedTileContainerById;l=true;}sap.ushell.components.flp.ComponentKeysHandler.goToLastVisitedTile(jQuery(T),l);}});if(d.isInEditTitle){G.setEditMode(true);}},300);if(d.groupId||d.groupChanged){t._addBottomSpace();}sap.ushell.utils.handleTilesVisibility();return false;}});}},_handleDrop:function(e,u){var t=sap.ushell.Layout.getLayoutEngine().layoutEndCallback(),E=sap.ui.getCore().getEventBus(),n,a;if(!t.tileMovedFlag){return;}n=true;a=true;if((t.srcGroup!==t.dstGroup)){n=a=false;}else if(t.tile!==t.dstGroup.getTiles()[t.dstTileIndex]){a=false;}t.srcGroup.removeAggregation('tiles',t.tile,n);t.dstGroup.insertAggregation('tiles',t.tile,t.dstTileIndex,a);E.publish("launchpad","moveTile",{sTileId:t.tile.getUuid(),toGroupId:t.dstGroup.getGroupId(),toIndex:t.dstTileIndex});sap.ushell.components.flp.ComponentKeysHandler.setTileFocus(jQuery(u));E.publish("launchpad","sortableStop");},_handleAnchorItemPress:function(e){var v=this.getView(),m=v.getModel();if(sap.ui.Device.system.phone&&e.getParameter("manualPress")){e.oSource.openOverflowPopup();}var g=m.getProperty("/groups");for(var i=0;i<g.length;i++){m.setProperty("/groups/"+i+"/isGroupSelected",false);}m.setProperty("/groups/"+e.getParameter("group").getIndex()+"/isGroupSelected",true);if(m.getProperty("/homePageGroupDisplay")&&m.getProperty("/homePageGroupDisplay")==="tabs"&&!m.getProperty("/tileActionModeActive")){var s=e.getParameter("group").getIndex(),h=0;for(var i=0;i<s;i++){if(!g[i].isGroupVisible||!g[i].visibilityModes[0]){h++;}}var f=s-h;v.oDashboardGroupsBox.getBinding("groups").filter([v.oFilterSelectedGroup]);v.oAnchorNavigationBar.adjustItemSelection(f);v.oAnchorNavigationBar.setSelectedItemIndex(f);}else{v.oDashboardGroupsBox.getBinding("groups").filter([]);this._scrollToGroup("launchpad","scrollToGroup",{group:e.getParameter('group'),groupChanged:true,focus:(e.getParameter("action")==="sapenter")});}},_addGroupHandler:function(d){var i,p=d.getSource().getBindingContext().getPath(),a=p.split("/");i=window.parseInt(a[a.length-1],10);if(d.getSource().sParentAggregationName==="afterContent"){i=i+1;}sap.ui.getCore().getEventBus().publish("launchpad","createGroupAt",{title:sap.ushell.resources.i18n.getText("new_group_name"),location:i,isRendered:true});},_notificationsUpdateCallback:function(){var t=this,r=5,T=0,R=this.getView().getModel().getProperty("/previewNotificationItems"),n=[],N=[],a,b,c,d,e,i,o,f=false,m=r-R.length-1;sap.ushell.Container.getService("Notifications").getNotifications().done(function(g){if(!g){return;}var h=sap.ui.getCore().byId("notifications-preview-container"),v;if(!this.isNotificationPreviewLoaded){h.setEnableBounceAnimations(true);}if(R&&R.length){for(e=0;e<R.length;e++){var O=R[e].originalItemId,j=false;for(i=0;i<g.length;i++){if(g[i].Id===O){j=true;break;}if(R[e].originalTimestamp>g[i].CreatedAt){break;}}if(!j){R.splice(e,1);f=true;e--;}}}if(R&&R.length>0){a=R[0].originalTimestamp;b=sap.ushell.Container.getService("Notifications")._formatAsDate(a);}for(e=0;(e<g.length)&&(T<r);e++){c=g[e].CreatedAt;d=sap.ushell.Container.getService("Notifications")._formatAsDate(c);if((b?d>b:true)){n[T]=g[e];T++;}}var k=n.length;if(R&&R.length>0&&R.length<r&&g.length>R.length){a=R[R.length-1].originalTimestamp;b=sap.ushell.Container.getService("Notifications")._formatAsDate(a);T=0;for(e=0;(e<g.length)&&(T<=m);e++){c=g[e].CreatedAt;d=sap.ushell.Container.getService("Notifications")._formatAsDate(c);if(d<b){n[k+T]=g[e];T++;}}}if(n.length===0&&!f){this._disableNotificationPreviewBouncingAnimation(h);return;}for(i=0;i<n.length;i++){o=new sap.m.NotificationListItem({hideShowMoreButton:true,title:n[i].SensitiveText?n[i].SensitiveText:n[i].Text,datetime:sap.ushell.utils.formatDate(n[i].CreatedAt),priority:sap.ui.core.Priority[n[i].Priority.charAt(0)+n[i].Priority.substr(1).toLowerCase()],press:function(E){var s=this.getBindingContext().getPath(),p=s.split("/"),P="/"+p[1]+"/"+p[2],l=this.getModel().getProperty(P),S=l.NavigationTargetObject,A=l.NavigationTargetAction,q=l.NavigationTargetParams,u=l.originalItemId,w=sap.ushell.Container.getService("Notifications");sap.ushell.utils.toExternalWithParameters(S,A,q);var x=w.markRead(u);x.fail(function(){sap.ushell.Container.getService('Message').error(sap.ushell.resources.i18n.getText('notificationsFailedMarkRead'));});},close:function(E){var s=this.getBindingContext().getPath(),p=s.split("/"),P="/"+p[1]+"/"+p[2],l=this.getModel().getProperty(P),q=l.originalItemId,R=t.getView().getModel().getProperty("/previewNotificationItems"),u=sap.ushell.Container.getService("Notifications"),w=u.dismissNotification(q);w.done(function(){var i;for(i=0;i<R.length;i++){if(R[i].originalItemId===q){break;}}R.splice(i,1);t.getView().getModel().setProperty("/previewNotificationItems",R);});w.fail(function(){sap.ushell.Container.getService('Message').error(sap.ushell.resources.i18n.getText('notificationsFailedDismiss'));t.getView().getModel().setProperty("/previewNotificationItems",R);});}}).addStyleClass("sapUshellNotificationsListItem");N.push({previewItemId:o.getId(),originalItemId:n[i].Id,originalTimestamp:n[i].CreatedAt,NavigationTargetObject:n[i].NavigationTargetObject,NavigationTargetAction:n[i].NavigationTargetAction,NavigationTargetParams:n[i].NavigationTargetParams});v=sap.ui.getCore().byId('viewPortContainer');if(v.getCurrentState()==="RightCenter"){o.addStyleClass("sapUshellRightFloatingContainerItemBounceOut");}}if(R.length===0){t.getView().getModel().setProperty("/previewNotificationItems",N);this._disableNotificationPreviewBouncingAnimation(h);return;}for(e=N.length-1;e>-1;e--){if(R.length>=r){setTimeout(function(){R.pop();t.getView().getModel().setProperty("/previewNotificationItems",R);},1000);}if(N[e].originalTimestamp>R[0].originalTimestamp){R.unshift(N[e]);}else{R.push(N[e]);}}t.getView().getModel().setProperty("/previewNotificationItems",R);this._disableNotificationPreviewBouncingAnimation(h);}.bind(this)).fail(function(){});},_disableNotificationPreviewBouncingAnimation:function(n){if(!this.isNotificationPreviewLoaded){this.isNotificationPreviewLoaded=true;n.setEnableBounceAnimations(false);}},_publishAsync:function(c,e,d){var b=sap.ui.getCore().getEventBus();window.setTimeout(jQuery.proxy(b.publish,b,c,e,d),1);},_changeGroupVisibility:function(g){var b=g.getPath(),m=g.getModel(),G=m.getProperty(b+'/isGroupVisible'),v=this.getView();m.setProperty(b+'/isGroupVisible',!G);v.oAnchorNavigationBar.updateVisibility();},_handleGroupVisibilityChanges:function(c,e,o){var l=sap.ushell.Container.getService('LaunchPage'),m=this.getView().getModel(),C=sap.ushell.utils.getCurrentHiddenGroupIds(m),s=C.length===o.length,i=s,p;C.some(function(h,I){if(!i){return true;}i=jQuery.inArray(h,o)!==-1;return!i;});if(!i){p=l.hideGroups(C);p.done(function(){m.updateBindings('groups');}.bind(this));p.fail(function(){var a=sap.ushell.Container.getService('Message');a.error(sap.ushell.resources.i18n.getText('hideGroups_error'));});}},_updateShellHeader:function(){if(!this.oShellUIService){this._initializeShellUIService();}this.oShellUIService.setTitle();this.oShellUIService.setHierarchy();},_initializeShellUIService:function(){jQuery.sap.require("sap.ushell.ui5service.ShellUIService");this.oShellUIService=new sap.ushell.ui5service.ShellUIService({scopeObject:this.getOwnerComponent(),scopeType:"component"});},_deactivateActionModeInTabsState:function(){var v=this.getView(),m=v.getModel();var g=m.getProperty("/groups");for(var i=0;i<g.length;i++){m.setProperty("/groups/"+i+"/isGroupSelected",false);}var s=v.oAnchorNavigationBar.getSelectedItemIndex();var h=0;if(!this._isGroupVisible(s)){for(var i=0;i<g.length;i++){if(!this._isGroupVisible(i)){h++;}else{s=i;break;}}}else{for(var i=0;i<s;i++){if(!this._isGroupVisible(i)){h++;}}}var f=s-h;v.oAnchorNavigationBar.adjustItemSelection(f);v.oAnchorNavigationBar.setSelectedItemIndex(f);m.setProperty("/groups/"+s+"/isGroupSelected",true);v.oDashboardGroupsBox.getBinding("groups").filter([v.oFilterSelectedGroup]);},_isGroupVisible:function(g){var G=this.getView().getModel().getProperty("/groups");return(G[g].isGroupVisible&&G[g].visibilityModes[0]);}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.flp.launchpad.dashboard.DashboardContent.view')){jQuery.sap.declare('sap.ushell.components.flp.launchpad.dashboard.DashboardContent.view');(function(){"use strict";sap.ui.jsview("sap.ushell.components.flp.launchpad.dashboard.DashboardContent",{createContent:function(c){var d,V=sap.ui.getCore().byId("viewPortContainer"),C,t=this;this.isTouch=sap.ui.Device.system.combi?false:(sap.ui.Device.system.phone||sap.ui.Device.system.tablet);this.isCombi=sap.ui.Device.system.combi;this.parentComponent=sap.ui.core.Component.getOwnerComponentFor(this);this.oModel=this.parentComponent.getModel();this.addStyleClass("sapUshellDashboardView");this.ieHtml5DnD=!!(this.oModel.getProperty("/personalization")&&(sap.ui.Device.browser.msie||sap.ui.Device.browser.edge)&&sap.ui.Device.browser.version>=11&&(sap.ui.Device.system.combi||sap.ui.Device.system.tablet));sap.ui.getCore().getEventBus().subscribe("launchpad","contentRendered",this._onAfterDashboardShow,this);sap.ui.getCore().getEventBus().subscribe("launchpad","initialConfigurationSet",this._onAfterDashboardShow,this);sap.ui.getCore().getEventBus().subscribe("launchpad",'actionModeInactive',this._handleEditModeChange,this);sap.ui.getCore().getEventBus().subscribe("launchpad",'actionModeActive',this._handleEditModeChange,this);sap.ui.getCore().getEventBus().subscribe("sap.ushell.services.Notifications","enablePreviewNotificationChanged",this._enablePreviewNotificationChanged,this);sap.ui.getCore().byId('navContainerFlp').attachAfterNavigate(this.onAfterNavigate,this);this.addEventDelegate({onBeforeFirstShow:function(){var D=sap.ushell.components.flp.launchpad.getDashboardManager();D.loadPersonalizedGroups();this.onAfterNavigate();}.bind(this),onAfterShow:function(){this.getController()._addBottomSpace();this.getController()._updateShellHeader();}.bind(this),onAfterHide:function(e){}});this.oAnchorNavigationBar=this._getAnchorNavigationBar(c);d=new sap.ushell.components.flp.launchpad.dashboard.DashboardGroupsBox();this.oDashboardGroupsBox=d.createGroupsBox(c,this.oModel);C=this._previewNotificationEnabled();if(V){V.shiftCenterTransitionEnabled(C);}var u=function(n){var b=this.mBindingInfos[n],a=this.getMetadata().getJSONKeys()[n],o;jQuery.each(this[a._sGetter](),jQuery.proxy(function(i,v){this[a._sRemoveMutator](v);},this));jQuery.each(b.binding.getContexts(),jQuery.proxy(function(i,v){o=b.factory(this.getId()+"-"+i,v)?b.factory(this.getId()+"-"+i,v).setBindingContext(v,b.model):"";this[a._sMutator](o);},this));};this.oPreviewNotificationsContainerPlaceholder=new sap.ushell.ui.shell.RightFloatingContainer({id:'notifications-preview-container-placeholder',visible:{path:'/enableNotificationsPreview',formatter:function(v){return t._handleNotificationsPreviewVisibility.apply(t,[v]);}}}).addStyleClass('sapUshellPreviewNotificationsConainer');this.oPreviewNotificationsContainer=new sap.ushell.ui.shell.RightFloatingContainer({id:'notifications-preview-container',top:4,right:'1rem',floatingContainerItems:{path:"/previewNotificationItems",factory:function(f,o){return sap.ui.getCore().byId(o.getObject().previewItemId);}},visible:{path:'/enableNotificationsPreview',formatter:this._handleNotificationsPreviewVisibility.bind(this)}}).addStyleClass('sapContrastPlus').addStyleClass('sapContrast');this.oPreviewNotificationsContainer.updateAggregation=u;this.oFilterSelectedGroup=new sap.ui.model.Filter("isGroupSelected",sap.ui.model.FilterOperator.EQ,true);this.oDoneBtn=new sap.m.Button('sapUshellDashboardFooterDoneBtn',{type:sap.m.ButtonType.Emphasized,text:sap.ushell.resources.i18n.getText("doneBtnText"),tooltip:sap.ushell.resources.i18n.getText("doneBtnTooltip"),press:function(){var a=this.oDashboardGroupsBox.getGroups();sap.ushell.components.flp.ActionMode.toggleActionMode(this.oModel,"Menu Item",a);this.oAnchorNavigationBar.updateVisibility();if(this.oModel.getProperty("/homePageGroupDisplay")&&this.oModel.getProperty("/homePageGroupDisplay")==="tabs"){this.getController()._deactivateActionModeInTabsState();}}.bind(this)});this.oDoneBtn.addEventDelegate({onsapskipforward:function(e){e.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(e);},onsapskipback:function(e){e.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.components.flp.ComponentKeysHandler.goToFirstVisibleTileContainer();},onsaptabprevious:function(e){e.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.components.flp.ComponentKeysHandler.goToFirstVisibleTileContainer();},onsaptabnext:function(e){e.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(e);}});this.oFooter=new sap.m.OverflowToolbar('sapUshellDashboardFooter',{visible:{parts:['/tileActionModeActive','/viewPortState'],formatter:function(a,s){return a&&s==='Center';}},layoutData:new sap.m.OverflowToolbarLayoutData({moveToOverflow:false}),content:[new sap.m.ToolbarSpacer(),this.oDoneBtn]});this.oPage=new sap.m.Page('sapUshellDashboardPage',{customHeader:this.oAnchorNavigationBar,content:[this.oDashboardGroupsBox],floatingFooter:true,footer:this.oFooter});return[this.oPage,this.oPreviewNotificationsContainerPlaceholder,this.oPreviewNotificationsContainer];},_handleNotificationsPreviewVisibility:function(e){var r=sap.ushell.Container.getRenderer('fiori2'),c=r.getCurrentViewportState(),i=c==='Center',n=sap.ushell.Container.getService('Notifications');this.oDashboardGroupsBox.toggleStyleClass('sapUshellDashboardGroupsContainerSqueezed',e);this.oAnchorNavigationBar.toggleStyleClass('sapUshellAnchorNavigationBarSqueezed',e);e=e&&i;if(e){if(!this.bNotificationsRegistered){n.registerNotificationsUpdateCallback(this.oController._notificationsUpdateCallback.bind(this.oController));this.bNotificationsRegistered=true;}if(n.isFirstDataLoaded()){setTimeout(function(){if(this.oController&&this.oController._notificationsUpdateCallback){this.oController._notificationsUpdateCallback();}}.bind(this),300);}if(!this.bSubscribedToViewportStateSwitch){this.bHeadsupNotificationsInitialyVisible=r.getRightFloatingContainerVisibility();sap.ui.getCore().getEventBus().subscribe("launchpad","afterSwitchState",this._handleViewportStateSwitch,this);this.bSubscribedToViewportStateSwitch=true;}}return e;},_fOnAfterAnchorBarRenderingHandler:function(e){var x=this.getModel()&&this.getModel().getProperty('/enableHelp');if(this.getDefaultGroup()){if(x){this.addStyleClass("help-id-homeAnchorNavigationBarItem");}}else{if(x){this.addStyleClass("help-id-anchorNavigationBarItem");}}},_getAnchorItemTemplate:function(){var a=new sap.ushell.ui.launchpad.AnchorItem({index:"{index}",title:"{title}",groupId:"{groupId}",defaultGroup:"{isDefaultGroup}",selected:false,isGroupRendered:"{isRendered}",visible:{parts:["/tileActionModeActive","isGroupVisible","visibilityModes"],formatter:function(t,i,v){if(!v[t?1:0]){return false;}return i||t;}},afterRendering:this._fOnAfterAnchorBarRenderingHandler});return a;},_getAnchorNavigationBar:function(c){var a=this._getAnchorItemTemplate(),A=new sap.ushell.ui.launchpad.AnchorNavigationBar("anchorNavigationBar",{selectedItemIndex:"{/topGroupInViewPortIndex}",itemPress:[function(e){this._handleAnchorItemPress(e);},c],groups:{path:"/groups",template:a}});A=this._extendAnchorNavigationBar(A);A.addStyleClass("sapContrastPlus");return A;},_extendAnchorNavigationBar:function(a){var e=jQuery.extend(a,{onsapskipforward:function(E){E.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.components.flp.ComponentKeysHandler.goToTileContainer(E,this.bGroupWasPressed);this.bGroupWasPressed=false;},onsaptabnext:function(E){E.preventDefault();var j=jQuery(":focus");if(!j.parent().parent().siblings().hasClass("sapUshellAnchorItemOverFlow")||(j.parent().parent().siblings().hasClass("sapUshellAnchorItemOverFlow")&&j.parent().parent().siblings().hasClass("sapUshellShellHidden"))){sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.components.flp.ComponentKeysHandler.goToTileContainer(E);this.bGroupWasPressed=false;}else{var b=jQuery(".sapUshellAnchorItemOverFlow button");b.focus();}},onsapskipback:function(E){E.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(E);},onsaptabprevious:function(E){E.preventDefault();var j=jQuery(":focus");if(!j.parent().hasClass("sapUshellAnchorItemOverFlow")){sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(E);}else{var b=jQuery(".sapUshellAnchorItem:visible:first");if(!b.length){sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(E);}else{sap.ushell.components.flp.ComponentKeysHandler.goToSelectedAnchorNavigationItem();}}},onsapenter:function(E){E.srcControl.getDomRef().click();},onsapspace:function(E){E.srcControl.getDomRef().click();}});return e;},_addActionModeButtonsToDashboard:function(){if(sap.ushell.components.flp.ActionMode){sap.ushell.components.flp.ActionMode.init(this.getModel());}},_createActionModeMenuButton:function(){this.oTileActionsButton=sap.ushell.Container.getRenderer("fiori2").addActionButton("sap.ushell.ui.launchpad.ActionItem",{id:"ActionModeBtn",text:sap.ushell.resources.i18n.getText("activateEditMode"),icon:'sap-icon://edit',press:function(){var d=this.oDashboardGroupsBox.getGroups();sap.ushell.components.flp.ActionMode.toggleActionMode(this.oModel,"Menu Item",d);this.oAnchorNavigationBar.updateVisibility();if(this.oModel.getProperty("/homePageGroupDisplay")&&this.oModel.getProperty("/homePageGroupDisplay")==="tabs"){if(this.oModel.getProperty("/tileActionModeActive")){this.oDashboardGroupsBox.getBinding("groups").filter([]);var g=this.oModel.getProperty("/groups"),s;for(var i=0;i<g.length;i++){if(g[i].isGroupSelected){s=i;break;}}this.getController()._scrollToGroup("launchpad","scrollToGroup",{group:{getGroupId:function(){return g[s].groupId}},groupChanged:false,focus:true});}else{this.getController()._deactivateActionModeInTabsState();}}}.bind(this)},false,true);if(this.oModel.getProperty("/enableHelp")){this.oTileActionsButton.addStyleClass('help-id-ActionModeBtn');}sap.ushell.Container.getRenderer("fiori2").showActionButton(this.oTileActionsButton.getId(),true);},_handleEditModeChange:function(){if(this.oTileActionsButton){this.oTileActionsButton.toggleStyleClass('sapUshellAcionItemActive');}},_enablePreviewNotificationChanged:function(c,e,d){this.oModel.setProperty("/userEnableNotificationsPreview",d.bPreviewEnabled);},_previewNotificationEnabled:function(){var c=this.oModel.getProperty("/configEnableNotificationsPreview"),u=this.oModel.getProperty("/userEnableNotificationsPreview");return(c&&u);},_createActionButtons:function(){var e=this.oModel.getProperty("/personalization");if(e){if(this.oModel.getProperty("/actionModeMenuButtonEnabled")){this._createActionModeMenuButton();}}},onAfterNavigate:function(e){var n=sap.ui.getCore().byId('navContainerFlp'),c=n?n.getCurrentPage().getViewName():undefined,i=c=="sap.ushell.components.flp.launchpad.dashboard.DashboardContent",r=sap.ushell.Container.getRenderer("fiori2");if(i){r.createExtendedShellState("dashboardExtendedShellState",function(){this._createActionButtons();r.setHeaderHiding(false);}.bind(this));this.getController()._setCenterViewPortShift();this._addActionModeButtonsToDashboard();setTimeout(function(){if(sap.ushell.Container){r.applyExtendedShellState("dashboardExtendedShellState");}},0);if(this.oAnchorNavigationBar&&this.oAnchorNavigationBar.anchorItems){this.oAnchorNavigationBar.setNavigationBarItemsVisibility();this.oAnchorNavigationBar.adjustItemSelection(this.oAnchorNavigationBar.getSelectedItemIndex());}if(document.activeElement&&document.activeElement.tagName==="BODY"){sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell();}}},_handleViewportStateSwitch:function(c,e,d){var C=d.getParameter('to');if(C=='Center'){var n=sap.ui.getCore().byId("notifications-preview-container");if(n&&n.setFloatingContainerItemsVisiblity){n.setFloatingContainerItemsVisiblity(true);}}},_handleHeadsupNotificationsPresentation:function(c){var r=sap.ushell.Container.getRenderer('fiori2'),i=c==='Center',p=this.oPreviewNotificationsContainer.getDomRef(),h=p&&p.getBoundingClientRect(),P=h?h.bottom<0:false,s=i?P:this.bHeadsupNotificationsInitialyVisible;r.showRightFloatingContainer(s);},_onAfterDashboardShow:function(e){var j=jQuery('.sapUshellTileContainer:visible'),n=sap.ui.getCore().byId('navContainerFlp'),c=n?n.getCurrentPage().getViewName():undefined,i=c=="sap.ushell.components.flp.launchpad.dashboard.DashboardContent",t=this.oModel.getProperty('/tileActionModeActive'),v,p;if(i){if(!t){sap.ushell.utils.handleTilesVisibility();sap.ushell.utils.refreshTiles();var T=this.oModel.getProperty('/topGroupInViewPortIndex'),a=jQuery(j[T]),b=j.find("li[class*='sapUshellTile']li[tabindex=0]"),d=a.find('.sapUshellTile:first'),f;if(b.length){f=b;}else if(d.length){f=d;}else{f=jQuery("#configBtn");}p=this.oModel.getProperty('/enableNotificationsPreview');v=sap.ui.getCore().byId("viewPortContainer");if(v){v.shiftCenterTransition(p);}setTimeout(function(){f.focus();},0)}this.onAfterNavigate();}},getControllerName:function(){return"sap.ushell.components.flp.launchpad.dashboard.DashboardContent";},_isInDeashboard:function(){var n=sap.ui.getCore().byId("viewPortContainer"),c=sap.ui.getCore().byId("dashboardGroups");return((n.getCurrentCenterPage()==="application-Shell-home")&&(c.getModel().getProperty("/currentViewName")==="home"));},exit:function(){if(this.oAnchorNavigationBar){this.oAnchorNavigationBar.handleExit();}if(this.oTileActionsButton){this.oTileActionsButton.destroy();}sap.ui.core.mvc.View.prototype.exit.apply(this,arguments);sap.ui.getCore().getEventBus().unsubscribe("launchpad","contentRendered",this._onAfterDashboardShow,this);sap.ui.getCore().getEventBus().unsubscribe("launchpad","initialConfigurationSet",this._onAfterDashboardShow,this);sap.ui.getCore().getEventBus().unsubscribe("launchpad",'actionModeInactive',this._handleEditModeChange,this);sap.ui.getCore().getEventBus().unsubscribe("launchpad",'actionModeActive',this._handleEditModeChange,this);if(this.bSubscribedToViewportStateSwitch){sap.ui.getCore().getEventBus().unsubscribe("launchpad","afterSwitchState",this._handleViewportStateSwitch,this);this.bSubscribedToViewportStateSwitch=false;}}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.flp.launchpad.group_list.GroupList.view')){jQuery.sap.declare('sap.ushell.components.flp.launchpad.group_list.GroupList.view');(function(){"use strict";jQuery.sap.require('sap.ui.core.IconPool');sap.ui.jsview("sap.ushell.components.flp.launchpad.group_list.GroupList",{createContent:function(c){this.parentComponent=sap.ui.core.Component.getOwnerComponentFor(this);this.oModel=this.parentComponent.getModel();var t=this,g=this._getGroupListItemTemplate(c);this.bAnimate=sap.ui.Device.system.desktop;this.isTouch=!sap.ui.Device.system.desktop;this.oGroupList=new sap.m.List("groupListItems",{items:{path:"/groups",template:g}}).addStyleClass("sapUshellGroupItemList");jQuery.extend(this.oGroupList,{onsapskipforward:function(e){e.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.components.flp.ComponentKeysHandler.goToTileContainer(e);},onsapskipback:function(e){e.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(e);},onsaptabprevious:function(e){e.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(e);}});this.oGroupList.onAfterRendering=function(){this.data("sap-ui-fastnavgroup","false",false);jQuery("#groupListFooter").attr("data-sap-ui-fastnavgroup","false");t.oController.handleScroll();};jQuery.sap.require("sap.ushell.override");this.oGroupList.updateItems=sap.ushell.override.updateAggregatesFactory("items");if(this.getViewData().enablePersonalization===undefined||this.getViewData().enablePersonalization!==false){this.oActionList=new sap.m.List({items:[]});var o=this.oActionList.onAfterRendering;this.oActionList.onAfterRendering=function(e){o.call(this,e);};var a=new sap.m.Bar({id:"groupListFooter",contentMiddle:[this.oActionList]});a.addStyleClass("sapUshellPersonalizationOn");this.groupListPage=new sap.m.Page({id:"groupListPage",showHeader:false,showFooter:true,content:[this.oGroupList]});this.groupListPage.addStyleClass("sapUshellPersonalizationOn");}else{this.groupListPage=new sap.m.Page({id:"groupListPage",showHeader:false,showFooter:false,content:[this.oGroupList]});}this.addStyleClass("sapUshellGroupList");return[this.groupListPage];},_getGroupListItemTemplate:function(c){var o=function(e){var x=this.getModel()&&this.getModel().getProperty('/enableHelp');if(this.getDefaultGroup()){this.addStyleClass("sapUshellDefaultGroupItem");if(x){this.addStyleClass("help-id-homeGroupListItem");}}else{this.addStyleClass("sapUshellGroupListItem");if(x){this.addStyleClass("help-id-groupListItem");}}jQuery(this.getDomRef()).attr("tabindex","0");};return new sap.ushell.ui.launchpad.GroupListItem({index:"{index}",title:"{title}",tooltip:"{title}",defaultGroup:"{isDefaultGroup}",groupId:"{groupId}",numberOfTiles:"{tiles/length}",afterRendering:o,isGroupVisible:"{isGroupVisible}",press:[function(e){this._handleGroupListItemPress(e);},c],visible:{parts:["/tileActionModeActive","isGroupVisible","visibilityModes"],formatter:function(t,i,v){if(!v[t?1:0]){return false;}return i||t;}}});},getControllerName:function(){return"sap.ushell.components.flp.launchpad.group_list.GroupList";}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.action.ActionTile.controller')){jQuery.sap.declare('sap.ushell.components.tiles.action.ActionTile.controller');(function(){"use strict";sap.ui.getCore().loadLibrary("sap.m");jQuery.sap.require('sap.ui.core.IconPool');sap.ui.controller("sap.ushell.components.tiles.action.ActionTile",{onInit:function(){var v=this.getView();var V=v.getViewData();var r=sap.ushell.components.tiles.utils.getResourceBundleModel();var t=V.chip;var c=sap.ushell.components.tiles.utils.getActionConfiguration(t);var m;var a=this;function f(s,S){var b=r.getResourceBundle(),R=b.getText("configuration.semantic_object")+":\n"+s+"\n\n"+b.getText("configuration.semantic_action")+":\n"+S;return R;}v.setModel(r,"i18n");m=new sap.ui.model.json.JSONModel({config:c,displayText:f(c.semantic_object,c.semantic_action)});v.setModel(m);if(t.configurationUi.isEnabled()){t.configurationUi.setUiProvider(function(){var C=sap.ushell.components.tiles.utils.getConfigurationUi(a.getView(),"sap.ushell.components.tiles.action.Configuration");t.configurationUi.attachCancel(this.onCancelConfiguration.bind(null,C));t.configurationUi.attachSave(this.onSaveConfiguration.bind(this,C,f));return C;}.bind(this));v.byId("actionTile").setTooltip(r.getResourceBundle().getText("edit_configuration.tooltip"));}},onPress:function(e){var t=this.getView().getViewData().chip;if(t.configurationUi.isEnabled()){t.configurationUi.display();}},onSaveConfiguration:function(c,f){var d=jQuery.Deferred(),m=c.getModel(),t=m.getProperty("/tileModel"),T=c.getViewData().chip;function l(E){jQuery.sap.log.warning(E,null,"sap.ushell.components.tiles.action.ActionTile.controller");d.reject(E);}var r=sap.ushell.components.tiles.utils.checkTMInputOnSaveConfig(c);if(r){d.reject("mandatory_fields_missing");return d.promise();}if(sap.ushell.components.tiles.utils.tableHasDuplicateParameterNames(m.getProperty("/config/rows"))){var b=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();d.reject(b.getText("configuration.signature.uniqueParamMessage.text"));}else{var F=m.getProperty("/config/formFactorConfigDefault")?undefined:sap.ushell.components.tiles.utils.buildFormFactorsObject(m);var M=sap.ushell.components.tiles.utils.getMappingSignatureString(m.getProperty("/config/rows"),m.getProperty("/config/isUnknownAllowed"));var o=sap.ushell.components.tiles.utils.getMappingSignature(m.getProperty("/config/rows"),m.getProperty("/config/isUnknownAllowed"));var a={semantic_object:jQuery.trim(m.getProperty("/config/semantic_object"))||"",semantic_action:jQuery.trim(m.getProperty("/config/semantic_action"))||"",display_title_text:jQuery.trim(m.getProperty("/config/display_title_text"))||"",url:jQuery.trim(m.getProperty("/config/url"))||"",ui5_component:jQuery.trim(m.getProperty("/config/ui5_component"))||"",navigation_provider:jQuery.trim(m.getProperty("/config/navigation_provider")),navigation_provider_role:jQuery.trim(m.getProperty("/config/navigation_provider_role"))||"",navigation_provider_instance:jQuery.trim(m.getProperty("/config/navigation_provider_instance"))||"",target_application_id:jQuery.trim(m.getProperty("/config/target_application_id"))||"",target_application_alias:jQuery.trim(m.getProperty("/config/target_application_alias"))||"",transaction:{code:jQuery.trim(m.getProperty("/config/transaction/code"))},web_dynpro:{application:jQuery.trim(m.getProperty("/config/web_dynpro/application")),configuration:jQuery.trim(m.getProperty("/config/web_dynpro/configuration"))},target_system_alias:jQuery.trim(m.getProperty("/config/target_system_alias")),display_info_text:jQuery.trim(m.getProperty("/config/display_info_text")),form_factors:F,mapping_signature:M,signature:o};var e=T.bag.getBag('tileProperties');e.setText('display_title_text',a.display_title_text);T.writeConfiguration.setParameterValues({tileConfiguration:JSON.stringify(a)},function(){var C=sap.ushell.components.tiles.utils.getActionConfiguration(T,false);var g=sap.ushell.components.tiles.utils.getActionConfiguration(T,true);m=new sap.ui.model.json.JSONModel({config:C,tileModel:t});c.setModel(m);t.setData({config:g,displayText:f(g.semantic_object,g.semantic_action)},false);e.save(function(){jQuery.sap.log.debug("property bag 'tileProperties' saved successfully");d.resolve();},l);},l);}return d.promise();},onCancelConfiguration:function(c){var v=c.getViewData();var m=c.getModel();var t=m.getProperty("/tileModel");var T=v.chip;var C=sap.ushell.components.tiles.utils.getActionConfiguration(T,false);c.getModel().setData({config:C,tileModel:t},false);}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.action.Configuration.controller')){jQuery.sap.declare('sap.ushell.components.tiles.action.Configuration.controller');(function(){"use strict";sap.ui.controller("sap.ushell.components.tiles.action.Configuration",{sEnterValuePlaceHolder:"",sDuplicateErrorMsg:"",sDuplicateErrorTitle:"",sInvalidParmMsg:"",aDefaultObjects:[{obj:"",name:""},{obj:"*",name:"*"}],onConfigurationInputChange:function(c){sap.ushell.components.tiles.utils.checkTMInput(this.getView(),c);},onInit:function(){var v=this.getView();var s=v.byId("semantic_objectInput");var r=v.byId("navigation_provider_roleInput");var i=v.byId("navigation_provider_instanceInput");var a=v.byId("target_application_aliasInput");var A=v.byId("semantic_actionInput");var t=v.byId("targetTypeInput");var R=sap.ushell.components.tiles.utils.getResourceBundleModel();v.setModel(R,"i18n");v.setViewName("sap.ushell.components.tiles.action.Configuration");sap.ushell.components.tiles.utils.createSemanticObjectModel(this,s,this.aDefaultObjects);sap.ushell.components.tiles.utils.createRoleModel(this,r,i);sap.ushell.components.tiles.utils.createAliasModel(this,a);sap.ushell.components.tiles.utils.createActionModel(this,A);sap.ushell.components.tiles.utils.createNavigationProviderModel(this,t);s.attachChange(function(c){var V=c.getSource().getValue();v.getModel().setProperty("/config/semantic_object",V);});r.attachChange(function(c){var V=c.getSource().getValue();v.getModel().setProperty("/config/navigation_provider_role",V);sap.ushell.components.tiles.utils.updateAliasModel(v,a);});i.attachChange(function(c){var V=c.getSource().getValue();v.getModel().setProperty("/config/navigation_provider_instance",V);});a.attachChange(function(c){var V=c.getSource().getValue();v.getModel().setProperty("/config/target_application_alias",V);});var b=R.getResourceBundle();this.sEnterValuePlaceHolder=b.getText("configuration.signature.table.valueFieldLbl");this.sDuplicateErrorMsg=b.getText("configuration.signature.uniqueParamMessage.text");this.sDuplicateErrorTitle=b.getText("configuration.signature.uniqueParamMessage.title");this.sInvalidParmMsg=b.getText("configuration.signature.invalidParamMessage.text");},handleMandatoryChange:function(m){var i=m.getParameter('id');var p=sap.ui.getCore().byId(i).getParent().getCells();var I=m.getParameter('checked');if(I){p[2].setEnabled(true);p[2].setPlaceholder(this.sEnterValuePlaceHolder);p[4].setEnabled(false);p[4].setValue("");p[4].setPlaceholder("");p[3].setEnabled(true);}else{p[2].setEnabled(false);p[2].setValue("");p[2].setPlaceholder("");p[4].setEnabled(true);p[4].setPlaceholder(this.sEnterValuePlaceHolder);p[3].setEnabled(false);p[3].setChecked(false);}},addRow:function(){var v=this.getView();var m=v.getModel();var r=m.getProperty('/config/rows');var n=sap.ushell.components.tiles.utils.getEmptyRowObj();r.push(n);m.setProperty('/config/rows',r);},deleteRow:function(){var v=this.getView();var m=v.getModel();var r=m.getProperty('/config/rows');var t=v.byId("mappingSignatureTable");var s=t.getSelectedIndices();var S=s.sort(function(a,b){return b-a;}).slice();for(var i=0;i<S.length;i++){t.removeSelectionInterval(S[i],S[i]);r.splice(S[i],1);}m.setProperty('/config/rows',r);},checkDuplicateNames:function(c){var m=this.getView().getModel();var r=m.getProperty('/config/rows');var n=sap.ui.getCore().byId(c.getParameter('id'));var N=c.getParameter('newValue');if(N!=""&&!(/^[\w-/]+$/.test(N))){n.setValueState(sap.ui.core.ValueState.Error);sap.m.MessageBox.alert(this.sInvalidParmMsg,this.focusNameField.bind(n),this.sDuplicateErrorTitle);}if(sap.ushell.components.tiles.utils.tableHasDuplicateParameterNames(r)){n.setValueState(sap.ui.core.ValueState.Error);sap.m.MessageBox.alert(this.sDuplicateErrorMsg,this.focusNameField.bind(n),this.sDuplicateErrorTitle);}else{n.setValueState(sap.ui.core.ValueState.None);}},focusNameField:function(){this.focus();},onValueHelpRequest:function(e){sap.ushell.components.tiles.utils.objectSelectOnValueHelpRequest(this,e,false);},onActionValueHelpRequest:function(e){sap.ushell.components.tiles.utils.actionSelectOnValueHelpRequest(this,e);},onRoleValueHelpRequest:function(e){sap.ushell.components.tiles.utils.roleSelectOnValueHelpRequest(this,e);},onInstanceValueHelpRequest:function(e){sap.ushell.components.tiles.utils.instanceSelectOnValueHelpRequest(this,e);},instanceSuggest:function(e){sap.ushell.components.tiles.utils.instanceSuggest(this,e);},aliasSuggest:function(e){sap.ushell.components.tiles.utils.aliasSuggest(this,e);},onAliasValueHelpRequest:function(e){sap.ushell.components.tiles.utils.applicationAliasSelectOnValueHelpRequest(this,e);},onFormFactorChange:function(){var m=this.getView().getModel();m.setProperty('/config/formFactorConfigDefault',false);},onApplicationTypeChange:function(e){var p=e.getParameters();if(p.selectedItem){sap.ushell.components.tiles.utils.displayApplicationTypeFields(p.selectedItem.getKey(),this.getView());}}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.applauncher.Configuration.controller')){jQuery.sap.declare('sap.ushell.components.tiles.applauncher.Configuration.controller');(function(){"use strict";sap.ui.controller("sap.ushell.components.tiles.applauncher.Configuration",{onConfigurationInputChange:function(c){sap.ushell.components.tiles.utils.checkInput(this.getView(),c);},aDefaultObjects:[{obj:"",name:""}],onInit:function(){var v=this.getView(),t=v.byId("targetUrl"),s=v.byId("navigation_semantic_objectInput"),a=v.byId("navigation_semantic_actionInput"),r=sap.ushell.components.tiles.utils.getResourceBundleModel();v.setModel(r,"i18n");var b=r.getResourceBundle();v.setViewName("sap.ushell.components.tiles.applauncher.Configuration");sap.ushell.components.tiles.utils.createSemanticObjectModel(this,s,this.aDefaultObjects);sap.ushell.components.tiles.utils.createActionModel(this,a);s.attachChange(function(C){var V=C.getSource().getValue();v.getModel().setProperty("/config/navigation_semantic_object",V);});function c(u){return!u;}t.bindProperty("enabled",{formatter:c,path:"/config/navigation_use_semantic_object"});var i=new sap.ui.core.ListItem({key:"URL",text:b.getText("configuration.tile_actions.table.target_type.url")});v.byId("targetTypeCB").addItem(i);i=new sap.ui.core.ListItem({key:"INT",text:b.getText("configuration.tile_actions.table.target_type.intent")});v.byId("targetTypeCB").addItem(i);},onAfterRendering:function(){sap.ushell.components.tiles.utils.updateMessageStripForOriginalLanguage(this.getView());},onValueHelpRequest:function(e){sap.ushell.components.tiles.utils.objectSelectOnValueHelpRequest(this,e,false);},onActionValueHelpRequest:function(e){sap.ushell.components.tiles.utils.actionSelectOnValueHelpRequest(this,e,false);},onCheckBoxChange:function(e){var v=this.getView(),s=v.byId("navigation_semantic_objectInput"),m=s.getModel(),a=e.getSource().getSelected();m.setProperty("/enabled",a);sap.ushell.components.tiles.utils.checkInput(this.getView(),e);},onIconValueHelpRequest:function(e){sap.ushell.components.tiles.utils.iconSelectOnValueHelpRequest(this,e,false);},onSelectIconClose:function(){sap.ushell.components.tiles.utils.onSelectIconClose(this.getView());},onSelectIconOk:function(){sap.ushell.components.tiles.utils.onSelectIconOk(this.getView());},handleTargetTypeChange:function(t){sap.ushell.components.tiles.utils.onTargetTypeChange(t);},onTileActionValueHelp:function(e){sap.ushell.components.tiles.utils.objectSelectOnValueHelpRequest(this,e,true);},onTileActionIconValueHelp:function(e){sap.ushell.components.tiles.utils.iconSelectOnValueHelpRequest(this,e,true);},addRow:function(){sap.ushell.components.tiles.utils.addTileActionsRow(this.getView());},deleteRow:function(){sap.ushell.components.tiles.utils.deleteTileActionsRow(this.getView());}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.applauncher.StaticTile.controller')){jQuery.sap.declare('sap.ushell.components.tiles.applauncher.StaticTile.controller');(function(){"use strict";sap.ui.getCore().loadLibrary("sap.m");jQuery.sap.require('sap.ui.core.IconPool');sap.ui.controller("sap.ushell.components.tiles.applauncher.StaticTile",{onInit:function(){var s=this.getView(),v=s.getViewData(),t=v.chip,c=sap.ushell.components.tiles.utilsRT.getConfiguration(t,t.configurationUi.isEnabled(),false),m,k,K,a=this,N=c.navigation_target_url,S;S=t.url.getApplicationSystem();if(S){N+=((N.indexOf("?")<0)?"?":"&")+"sap-system="+S;}this.navigationTargetUrl=N;m=new sap.ui.model.json.JSONModel({config:c,nav:{navigation_target_url:(t.configurationUi&&t.configurationUi.isEnabled()?"":N)},search:{display_highlight_terms:[]}});s.setModel(m);if(t.types){t.types.attachSetType(function(d){if(a.tileType!=d){if(d==='link'){a.getView().removeAllContent();var l=a.getView().getLinkControl();a.getView().addContent(l);}else{a.getView().removeAllContent();var T=a.getView().getTileControl();a.getView().addContent(T);}a.tileType=d;}});}if(!this.tileType){var T=this.getView().getTileControl();this.getView().addContent(T);this.tileType="tile";}if(t.search){k=s.getModel().getProperty("/config/display_search_keywords");K=jQuery.grep(k.split(/[, ]+/),function(n,i){return n&&n!=="";});if(c.display_title_text&&c.display_title_text!==""&&K.indexOf(c.display_title_text)===-1){K.push(c.display_title_text);}if(c.display_subtitle_text&&c.display_subtitle_text!==""&&K.indexOf(c.display_subtitle_text)===-1){K.push(c.display_subtitle_text);}if(c.display_info_text&&c.display_info_text!==""&&K.indexOf(c.display_info_text)===-1){K.push(c.display_info_text);}t.search.setKeywords(K);t.search.attachHighlight(function(h){s.getModel().setProperty("/search/display_highlight_terms",h);});}if(t.bag&&t.bag.attachBagsUpdated){t.bag.attachBagsUpdated(function(u){if(u.indexOf("tileProperties")>-1){sap.ushell.components.tiles.utils._updateTilePropertiesTexts(s,t.bag.getBag('tileProperties'));}});}if(t.configuration&&t.configuration.attachConfigurationUpdated){t.configuration.attachConfigurationUpdated(function(u){if(u.indexOf("tileConfiguration")>-1){sap.ushell.components.tiles.utils._updateTileConfiguration(s,t.configuration.getParameterValueAsString("tileConfiguration"));}});}if(t.preview){t.preview.setTargetUrl(N);t.preview.setPreviewIcon(c.display_icon_url);t.preview.setPreviewTitle(c.display_title_text);if(t.preview.setPreviewSubtitle&&typeof t.preview.setPreviewSubtitle==='function'){t.preview.setPreviewSubtitle(c.display_subtitle_text);}}if(t.configurationUi.isEnabled()){t.configurationUi.setUiProvider(function(){var C=sap.ushell.components.tiles.utils.getConfigurationUi(s,"sap.ushell.components.tiles.applauncher.Configuration");t.configurationUi.attachCancel(a.onCancelConfiguration.bind(null,C));t.configurationUi.attachSave(a.onSaveConfiguration.bind(null,C));return C;});this.getView().getContent()[0].setTooltip(sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle().getText("edit_configuration.tooltip"));}if(t.actions){var A=c.actions,e;if(A){e=A.slice();}else{e=[];}var b=sap.ushell.components.tiles.utilsRT.getTileSettingsAction(m,this.onSaveRuntimeSettings.bind(this));e.push(b);t.actions.setActionsProvider(function(){return e;});}},onPress:function(e){var s=this.getView(),v=s.getViewData(),t=v.chip;if(t.configurationUi.isEnabled()){t.configurationUi.display();}else if(this.navigationTargetUrl){if(this.navigationTargetUrl[0]==='#'){hasher.setHash(this.navigationTargetUrl);}else{window.open(this.navigationTargetUrl,'_blank');}}},onSaveRuntimeSettings:function(s){var v=s.getModel(),t=this.getView().getViewData().chip,c=this.getView().getModel().getProperty("/config");c.display_title_text=v.getProperty('/title');c.display_subtitle_text=v.getProperty('/subtitle');c.display_info_text=v.getProperty('/info');c.display_search_keywords=v.getProperty('/keywords');var a=t.bag.getBag('tileProperties');a.setText('display_title_text',c.display_title_text);a.setText('display_subtitle_text',c.display_subtitle_text);a.setText('display_info_text',c.display_info_text);a.setText('display_search_keywords',c.display_search_keywords);function l(e){jQuery.sap.log.error(e,null,"sap.ushell.components.tiles.applauncher.StaticTile.controller");}a.save(function(){jQuery.sap.log.debug("property bag 'tileProperties' saved successfully");this.getView().getModel().setProperty('/config/display_title_text',c.display_title_text);this.getView().getModel().setProperty('/config/display_subtitle_text',c.display_subtitle_text);this.getView().getModel().setProperty('/config/display_info_text',c.display_info_text);this.getView().getModel().setProperty('/config/display_search_keywords',c.display_search_keywords);this.getView().getModel().refresh();}.bind(this),l);},onSaveConfiguration:function(c){var d=jQuery.Deferred();var m=c.getModel();var t=m.getProperty("/tileModel");var T=c.getViewData().chip;var a=sap.ushell.components.tiles.utils.tileActionsRows2TileActionsArray(m.getProperty("/config/tile_actions_rows"));var b={display_icon_url:m.getProperty("/config/display_icon_url"),navigation_use_semantic_object:m.getProperty("/config/navigation_use_semantic_object"),navigation_target_url:m.getProperty("/config/navigation_target_url"),navigation_semantic_object:jQuery.trim(m.getProperty("/config/navigation_semantic_object"))||"",navigation_semantic_action:jQuery.trim(m.getProperty("/config/navigation_semantic_action"))||"",navigation_semantic_parameters:jQuery.trim(m.getProperty("/config/navigation_semantic_parameters")),display_search_keywords:m.getProperty("/config/display_search_keywords")};var r=sap.ushell.components.tiles.utils.checkInputOnSaveConfig(c);if(!r){r=sap.ushell.components.tiles.utils.checkTileActions(c);}if(r){d.reject("mandatory_fields_missing");return d.promise();}if(b.navigation_use_semantic_object){b.navigation_target_url=sap.ushell.components.tiles.utilsRT.getSemanticNavigationUrl(b);m.setProperty("/config/navigation_target_url",b.navigation_target_url);}var e=T.bag.getBag('tileProperties');e.setText('display_title_text',m.getProperty("/config/display_title_text"));e.setText('display_subtitle_text',m.getProperty("/config/display_subtitle_text"));e.setText('display_info_text',m.getProperty("/config/display_info_text"));e.setText('display_search_keywords',b.display_search_keywords);var f=T.bag.getBag('tileNavigationActions');sap.ushell.components.tiles.utils.populateTileNavigationActionsBag(f,a);function l(E,o){jQuery.sap.log.error(E,null,"sap.ushell.components.tiles.applauncher.StaticTile.controller");d.reject(E,o);}T.writeConfiguration.setParameterValues({tileConfiguration:JSON.stringify(b)},function(){var C=sap.ushell.components.tiles.utilsRT.getConfiguration(T,false,false),o=sap.ushell.components.tiles.utilsRT.getConfiguration(T,true,false),m=new sap.ui.model.json.JSONModel({config:C,nav:{navigation_target_url:""},tileModel:t});c.setModel(m);t.setData({config:o,nav:{navigation_target_url:""}},false);if(T.preview){T.preview.setTargetUrl(C.navigation_target_url);T.preview.setPreviewIcon(C.display_icon_url);T.preview.setPreviewTitle(C.display_title_text);if(T.preview.setPreviewSubtitle&&typeof T.preview.setPreviewSubtitle==='function'){T.preview.setPreviewSubtitle(C.display_subtitle_text);}}e.save(function(){jQuery.sap.log.debug("property bag 'tileProperties' saved successfully");if(T.title){T.title.setTitle(C.display_title_text,function(){d.resolve();},l);}else{d.resolve();}},l);f.save(function(){jQuery.sap.log.debug("property bag 'navigationProperties' saved successfully");},l);},l);return d.promise();},onCancelConfiguration:function(c){var v=c.getViewData(),m=c.getModel(),t=m.getProperty("/tileModel"),T=v.chip,C=sap.ushell.components.tiles.utilsRT.getConfiguration(T,T.configurationUi.isEnabled(),false);c.getModel().setData({config:C,nav:{navigation_target_url:""},tileModel:t},false);}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.applauncherdynamic.Configuration.controller')){jQuery.sap.declare('sap.ushell.components.tiles.applauncherdynamic.Configuration.controller');(function(){"use strict";sap.ui.controller("sap.ushell.components.tiles.applauncherdynamic.Configuration",{onConfigurationInputChange:function(c){sap.ushell.components.tiles.utils.checkInput(this.getView(),c);},aDefaultObjects:[{obj:"",name:""}],onInit:function(){var v=this.getView(),s=v.byId("navigation_semantic_objectInput"),a=v.byId("navigation_semantic_actionInput"),r=sap.ushell.components.tiles.utils.getResourceBundleModel();v.setModel(r,"i18n");var b=r.getResourceBundle();v.setViewName("sap.ushell.components.tiles.applauncherdynamic.Configuration");sap.ushell.components.tiles.utils.createSemanticObjectModel(this,s,this.aDefaultObjects);sap.ushell.components.tiles.utils.createActionModel(this,a,this.aDefaultObjects);s.attachChange(function(c){var V=c.getSource().getValue();v.getModel().setProperty("/config/navigation_semantic_object",V);});a.attachChange(function(c){var V=c.getSource().getValue();v.getModel().setProperty("/config/navigation_semantic_action",V);});v.byId("targetUrl").bindProperty("enabled",{formatter:function(u){return!u;},path:"/config/navigation_use_semantic_object"});var i=new sap.ui.core.ListItem({key:"URL",text:b.getText("configuration.tile_actions.table.target_type.url")});v.byId("targetTypeCB").addItem(i);i=new sap.ui.core.ListItem({key:"INT",text:b.getText("configuration.tile_actions.table.target_type.intent")});v.byId("targetTypeCB").addItem(i);},onAfterRendering:function(){sap.ushell.components.tiles.utils.updateMessageStripForOriginalLanguage(this.getView());},onValueHelpRequest:function(e){sap.ushell.components.tiles.utils.objectSelectOnValueHelpRequest(this,e,false);},onActionValueHelpRequest:function(e){sap.ushell.components.tiles.utils.actionSelectOnValueHelpRequest(this,e,false);},onCheckBoxChange:function(e){var v=this.getView(),s=v.byId("navigation_semantic_objectInput"),m=s.getModel(),a=e.getSource().getSelected();m.setProperty("/enabled",a);sap.ushell.components.tiles.utils.checkInput(this.getView(),e);},onIconValueHelpRequest:function(e){sap.ushell.components.tiles.utils.iconSelectOnValueHelpRequest(this,e,false);},onSelectIconClose:function(){sap.ushell.components.tiles.utils.onSelectIconClose(this.getView());},onSelectIconOk:function(){sap.ushell.components.tiles.utils.onSelectIconOk(this.getView());},handleTargetTypeChange:function(t){sap.ushell.components.tiles.utils.onTargetTypeChange(t);},onTileActionValueHelp:function(e){sap.ushell.components.tiles.utils.objectSelectOnValueHelpRequest(this,e,true);},onTileActionIconValueHelp:function(e){sap.ushell.components.tiles.utils.iconSelectOnValueHelpRequest(this,e,true);},addRow:function(){sap.ushell.components.tiles.utils.addTileActionsRow(this.getView());},deleteRow:function(){sap.ushell.components.tiles.utils.deleteTileActionsRow(this.getView());}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.applauncherdynamic.DynamicTile.controller')){jQuery.sap.declare('sap.ushell.components.tiles.applauncherdynamic.DynamicTile.controller');(function(){"use strict";sap.ui.getCore().loadLibrary("sap.m");jQuery.sap.require('sap.ui.core.IconPool');jQuery.sap.require('sap.ui.thirdparty.datajs');sap.ui.controller("sap.ushell.components.tiles.applauncherdynamic.DynamicTile",{timer:null,oDataRequest:null,onInit:function(){var v=this.getView(),V=v.getViewData(),t=V.chip,c=sap.ushell.components.tiles.utilsRT.getConfiguration(t,t.configurationUi.isEnabled(),false),m,k,K,a=this,N=c.navigation_target_url,s;this.bIsRequestCompleted=false;s=t.url.getApplicationSystem();if(s){N+=((N.indexOf("?")<0)?"?":"&")+"sap-system="+s;}this.navigationTargetUrl=N;m=new sap.ui.model.json.JSONModel({config:c,data:sap.ushell.components.tiles.utilsRT.getDataToDisplay(c,{number:(t.configurationUi.isEnabled()?1234:"...")}),nav:{navigation_target_url:(t.configurationUi&&t.configurationUi.isEnabled()?"":N)},search:{display_highlight_terms:[]}});v.setModel(m);if(t.types){t.types.attachSetType(function(d){if(a.tileType!=d){if(d==='link'){a.getView().removeAllContent();var l=a.getView().getLinkControl();a.getView().addContent(l);}else{a.getView().removeAllContent();var T=a.getView().getTileControl();a.getView().addContent(T);}a.tileType=d;}});}if(!this.tileType){var T=this.getView().getTileControl();this.getView().addContent(T);this.tileType="tile";}if(t.search){k=v.getModel().getProperty("/config/display_search_keywords");K=jQuery.grep(k.split(/[, ]+/),function(n,i){return n&&n!=="";});if(c.display_title_text&&c.display_title_text!==""&&K.indexOf(c.display_title_text)===-1){K.push(c.display_title_text);}if(c.display_subtitle_text&&c.display_subtitle_text!==""&&K.indexOf(c.display_subtitle_text)===-1){K.push(c.display_subtitle_text);}if(c.display_info_text&&c.display_info_text!==""&&K.indexOf(c.display_info_text)===-1){K.push(c.display_info_text);}t.search.setKeywords(K);t.search.attachHighlight(function(h){v.getModel().setProperty("/search/display_highlight_terms",h);});}if(t.bag&&t.bag.attachBagsUpdated){t.bag.attachBagsUpdated(function(u){if(u.indexOf("tileProperties")>-1){sap.ushell.components.tiles.utils._updateTilePropertiesTexts(v,t.bag.getBag('tileProperties'));}});}if(t.configuration&&t.configuration.attachConfigurationUpdated){t.configuration.attachConfigurationUpdated(function(u){t.configuration.attachConfigurationUpdated(function(u){if(u.indexOf("tileConfiguration")>-1){sap.ushell.components.tiles.utils._updateTileConfiguration(v,t.configuration.getParameterValueAsString("tileConfiguration"));}});});}if(t.preview){t.preview.setTargetUrl(N);t.preview.setPreviewIcon(c.display_icon_url);t.preview.setPreviewTitle(c.display_title_text);if(t.preview.setPreviewSubtitle&&typeof t.preview.setPreviewSubtitle==='function'){t.preview.setPreviewSubtitle(c.display_subtitle_text);}}if(t.refresh){t.refresh.attachRefresh(this.refreshHandler.bind(null,this));}if(t.visible){t.visible.attachVisible(this.visibleHandler.bind(this));}if(t.configurationUi.isEnabled()){t.configurationUi.setUiProvider(function(){var C=sap.ushell.components.tiles.utils.getConfigurationUi(v,"sap.ushell.components.tiles.applauncherdynamic.Configuration");t.configurationUi.attachCancel(a.onCancelConfiguration.bind(null,C));t.configurationUi.attachSave(a.onSaveConfiguration.bind(null,C));return C;});this.getView().getContent()[0].setTooltip(sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle().getText("edit_configuration.tooltip"));}else{if(!t.preview||!t.preview.isEnabled()){if(!s){sap.ushell.Container.addRemoteSystemForServiceUrl(c.service_url);}this.onUpdateDynamicData();}}if(t.actions){var A=c.actions,e;if(A){e=A.slice();}else{e=[];}var b=sap.ushell.components.tiles.utilsRT.getTileSettingsAction(m,this.onSaveRuntimeSettings.bind(this));e.push(b);t.actions.setActionsProvider(function(){return e;});}},stopRequests:function(){if(this.timer){clearTimeout(this.timer);}if(this.oDataRequest){try{this.bIsAbortRequestFlow=true;this.oDataRequest.abort();}catch(e){jQuery.sap.log.warning(e.name,e.message);}this.bIsAbortRequestFlow=undefined;}},onExit:function(){this.stopRequests();},onPress:function(){var v=this.getView(),V=v.getViewData(),m=v.getModel(),t=m.getProperty("/nav/navigation_target_url"),T=V.chip;if(T.configurationUi.isEnabled()){T.configurationUi.display();}else if(t){if(t[0]==='#'){hasher.setHash(t);}else{window.open(t,'_blank');}}},onUpdateDynamicData:function(){var v=this.getView(),c=v.getModel().getProperty("/config"),n=c.service_refresh_interval;if(!n){n=0;}else if(n<10){jQuery.sap.log.warning("Refresh Interval "+n+" seconds for service URL "+c.service_url+" is less than 10 seconds, which is not supported. "+"Increased to 10 seconds automatically.",null,"sap.ushell.components.tiles.applauncherdynamic.DynamicTile.controller");n=10;}if(c.service_url){this.loadData(n);}},extractData:function(d){var n,k=["results","icon","title","number","numberUnit","info","infoState","infoStatus","targetParams","subtitle","stateArrow","numberState","numberDigits","numberFactor"];if(typeof d==="object"&&Object.keys(d).length===1){n=Object.keys(d)[0];if(jQuery.inArray(n,k)===-1){return d[n];}}return d;},onSaveRuntimeSettings:function(s){var v=s.getModel(),t=this.getView().getViewData().chip,c=this.getView().getModel().getProperty("/config");c.display_title_text=v.getProperty('/title');c.display_subtitle_text=v.getProperty('/subtitle');c.display_info_text=v.getProperty('/info');c.display_search_keywords=v.getProperty('/keywords');var a=t.bag.getBag('tileProperties');a.setText('display_title_text',c.display_title_text);a.setText('display_subtitle_text',c.display_subtitle_text);a.setText('display_info_text',c.display_info_text);a.setText('display_search_keywords',c.display_search_keywords);function l(e){jQuery.sap.log.error(e,null,"sap.ushell.components.tiles.applauncherdynamic.DynamicTile.controller");}a.save(function(){jQuery.sap.log.debug("property bag 'tileProperties' saved successfully");this.getView().getModel().setProperty("/config",c);this.getView().getModel().setProperty('/data/display_title_text',c.display_title_text);this.getView().getModel().setProperty('/data/display_subtitle_text',c.display_subtitle_text);this.getView().getModel().setProperty('/data/display_info_text',c.display_info_text);this.getView().getModel().refresh();}.bind(this),l);},onSaveConfiguration:function(c){var d=jQuery.Deferred(),m=c.getModel(),t=m.getProperty("/tileModel"),T=c.getViewData().chip,a=sap.ushell.components.tiles.utils.tileActionsRows2TileActionsArray(m.getProperty("/config/tile_actions_rows")),b={display_icon_url:m.getProperty("/config/display_icon_url"),display_number_unit:m.getProperty("/config/display_number_unit"),service_url:m.getProperty("/config/service_url"),service_refresh_interval:m.getProperty("/config/service_refresh_interval"),navigation_use_semantic_object:m.getProperty("/config/navigation_use_semantic_object"),navigation_target_url:m.getProperty("/config/navigation_target_url"),navigation_semantic_object:jQuery.trim(m.getProperty("/config/navigation_semantic_object"))||"",navigation_semantic_action:jQuery.trim(m.getProperty("/config/navigation_semantic_action"))||"",navigation_semantic_parameters:jQuery.trim(m.getProperty("/config/navigation_semantic_parameters")),display_search_keywords:m.getProperty("/config/display_search_keywords")};var r=sap.ushell.components.tiles.utils.checkInputOnSaveConfig(c);if(!r){r=sap.ushell.components.tiles.utils.checkTileActions(c);}if(r){d.reject("mandatory_fields_missing");return d.promise();}if(b.navigation_use_semantic_object){b.navigation_target_url=sap.ushell.components.tiles.utilsRT.getSemanticNavigationUrl(b);m.setProperty("/config/navigation_target_url",b.navigation_target_url);}var e=T.bag.getBag('tileProperties');e.setText('display_title_text',m.getProperty("/config/display_title_text"));e.setText('display_subtitle_text',m.getProperty("/config/display_subtitle_text"));e.setText('display_info_text',m.getProperty("/config/display_info_text"));e.setText('display_search_keywords',b.display_search_keywords);var f=T.bag.getBag('tileNavigationActions');sap.ushell.components.tiles.utils.populateTileNavigationActionsBag(f,a);function l(E,o){jQuery.sap.log.error(E,null,"sap.ushell.components.tiles.applauncherdynamic.DynamicTile.controller");d.reject(E,o);}T.writeConfiguration.setParameterValues({tileConfiguration:JSON.stringify(b)},function(){var C=sap.ushell.components.tiles.utilsRT.getConfiguration(T,false,false),o=sap.ushell.components.tiles.utilsRT.getConfiguration(T,true,false),m=new sap.ui.model.json.JSONModel({config:C,tileModel:t});c.setModel(m);t.setData({data:o,nav:{navigation_target_url:""}},false);if(T.preview){T.preview.setTargetUrl(C.navigation_target_url);T.preview.setPreviewIcon(C.display_icon_url);T.preview.setPreviewTitle(C.display_title_text);if(T.preview.setPreviewSubtitle&&typeof T.preview.setPreviewSubtitle==='function'){T.preview.setPreviewSubtitle(C.display_subtitle_text);}}e.save(function(){jQuery.sap.log.debug("property bag 'tileProperties' saved successfully");if(T.title){T.title.setTitle(C.display_title_text,function(){d.resolve();},l);}else{d.resolve();}},l);f.save(function(){jQuery.sap.log.debug("property bag 'navigationProperties' saved successfully");},l);},l);return d.promise();},successHandleFn:function(r){this.bIsRequestCompleted=true;var c=this.getView().getModel().getProperty("/config");this.oDataRequest=undefined;var d=r,D;if(typeof r==="object"){var u=jQuery.sap.getUriParameters(c.service_url).get("$inlinecount");if(u&&u==="allpages"){d={number:r.__count};}else{d=this.extractData(d);}}else if(typeof r==="string"){d={number:r};}D=sap.ushell.components.tiles.utilsRT.getDataToDisplay(c,d);this.getView().getModel().setProperty("/data",D);this.navigationTargetUrl=c.navigation_target_url;this.getView().getModel().setProperty("/nav/navigation_target_url",sap.ushell.components.tiles.utilsRT.addParamsToUrl(this.navigationTargetUrl,D));},errorHandlerFn:function(m){if(!this.bIsAbortRequestFlow){this.bIsRequestCompleted=true;}var c=this.getView().getModel().getProperty("/config");this.oDataRequest=undefined;var M=m&&m.message?m.message:m,r=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();if(M==="Request aborted"){jQuery.sap.log.info("Data request from service "+c.service_url+" was aborted",null,"sap.ushell.components.tiles.applauncherdynamic.DynamicTile");}else{if(m.response){M+=" - "+m.response.statusCode+" "+m.response.statusText;}jQuery.sap.log.error("Failed to update data via service "+c.service_url+": "+M,null,"sap.ushell.components.tiles.applauncherdynamic.DynamicTile");}if(!this.bIsAbortRequestFlow){this.getView().getModel().setProperty("/data",sap.ushell.components.tiles.utilsRT.getDataToDisplay(c,{number:"???",info:r.getText("dynamic_data.error"),infoState:"Critical"}));}},onCancelConfiguration:function(c,s,e){var v=c.getViewData(),m=c.getModel(),t=m.getProperty("/tileModel"),T=v.chip,C=sap.ushell.components.tiles.utilsRT.getConfiguration(T,false,false);c.getModel().setData({config:C,tileModel:t},false);},loadData:function(n){var d=this.getView(),c=d.getModel().getProperty("/config"),u=c.service_url,t=this;var T=this.getView().getViewData().chip;if(!u){return;}if(/;o=([;\/?]|$)/.test(u)){u=T.url.addSystemToServiceUrl(u);}if(n>0){jQuery.sap.log.info("Wait "+n+" seconds before calling "+c.service_url+" again",null,"sap.ushell.components.tiles.applauncherdynamic.DynamicTile.controller");this.timer=setTimeout(t.loadData.bind(t,n,false),(n*1000));}if(T.visible.isVisible()&&!t.oDataRequest){t.oDataRequest=OData.read({requestUri:u,headers:{"Cache-Control":"no-cache, no-store, must-revalidate","Pragma":"no-cache","Expires":"0"}},this.successHandleFn.bind(this),this.errorHandlerFn.bind(this));}},refreshHandler:function(d){var t=d.getView().getViewData().chip;if(!t.configurationUi.isEnabled()){d.loadData(0);}else{d.stopRequests();}},visibleHandler:function(i){var v=this.getView(),c=v.getModel().getProperty("/config"),n=c.service_refresh_interval;if(i){if(n>0){this.refreshHandler(this);}else{if(!this.bIsRequestCompleted){this.refreshHandler(this);}}}else{this.stopRequests();}}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.cdm.applauncher.StaticTile.controller')){jQuery.sap.declare('sap.ushell.components.tiles.cdm.applauncher.StaticTile.controller');(function(){"use strict";sap.ui.getCore().loadLibrary("sap.m");jQuery.sap.require('sap.ui.core.IconPool');sap.ui.controller("sap.ushell.components.tiles.cdm.applauncher.StaticTile",{_getConfiguration:function(){var v=this.getView().getViewData(),c={};c.configuration=v.configuration;c.properties=v.properties;var s=c.configuration["sap-system"];var t=c.properties.targetURL;if(t&&s){t+=((t.indexOf("?")<0)?"?":"&")+"sap-system="+s;c.properties.targetURL=t;}return c;},onInit:function(){var v=this.getView();var m=new sap.ui.model.json.JSONModel();m.setData(this._getConfiguration());v.setModel(m);},onPress:function(e){var t=this.getView().getModel().getProperty("/properties/targetURL");if(!t){return;}if(t[0]==='#'){hasher.setHash(t);}else{window.open(t,'_blank');}},updatePropertiesHandler:function(n){var p=this.getView().getModel().getProperty("/properties");var c=false;if(typeof n.title!=='undefined'){p.title=n.title;c=true;}if(typeof n.subtitle!=='undefined'){p.subtitle=n.subtitle;c=true;}if(typeof n.icon!=='undefined'){p.icon=n.icon;c=true;}if(c){this.getView().getModel().setProperty("/properties",p);}}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.cdm.applauncherdynamic.DynamicTile.controller')){jQuery.sap.declare('sap.ushell.components.tiles.cdm.applauncherdynamic.DynamicTile.controller');(function(){"use strict";sap.ui.getCore().loadLibrary("sap.m");jQuery.sap.require('sap.ui.core.IconPool');jQuery.sap.require('sap.ui.thirdparty.datajs');sap.ui.controller("sap.ushell.components.tiles.cdm.applauncherdynamic.DynamicTile",{timer:null,oDataRequest:null,_getConfiguration:function(){var v=this.getView().getViewData(),c={};c.configuration=v.configuration;c.properties=v.properties;c.properties.info=c.properties.info||"";c.properties.number_value='...';c.properties.number_value_state='Neutral';c.properties.number_state_arrow='None';c.properties.number_factor='';c.properties.number_unit='';var s=c.configuration["sap-system"];var t=c.properties.targetURL;if(t&&s){t+=((t.indexOf("?")<0)?"?":"&")+"sap-system="+s;c.properties.targetURL=t;}return c;},onInit:function(){var v=this.getView();var m=new sap.ui.model.json.JSONModel();m.setData(this._getConfiguration());v.setModel(m);this.initUpdateDynamicData();},refreshHandler:function(){this.loadData(0);},visibleHandler:function(i){if(i){if(!this.oDataRequest){this.refreshHandler(this);}}else{this.stopRequests();}},updateVisualPropertiesHandler:function(n){var p=this.getView().getModel().getProperty("/properties");var c=false;if(typeof n.title!=='undefined'){p.title=n.title;c=true;}if(typeof n.subtitle!=='undefined'){p.subtitle=n.subtitle;c=true;}if(typeof n.icon!=='undefined'){p.icon=n.icon;c=true;}if(c){this.getView().getModel().setProperty("/properties",p);}},stopRequests:function(){if(this.timer){clearTimeout(this.timer);}if(this.oDataRequest){try{this.oDataRequest.abort();}catch(e){jQuery.sap.log.warning(e.name,e.message);}}},onPress:function(){var t=this.getView().getModel().getProperty("/properties/targetURL");if(!t){return;}else if(t[0]==='#'){hasher.setHash(t);}else{window.open(t,'_blank');}},initUpdateDynamicData:function(){var v=this.getView(),s=v.getModel().getProperty("/configuration/serviceUrl"),S=v.getModel().getProperty("/configuration/serviceRefreshInterval");if(!S){S=0;}else if(S<10){jQuery.sap.log.warning("Refresh Interval "+S+" seconds for service URL "+s+" is less than 10 seconds, which is not supported. Increased to 10 seconds automatically.",null,"sap.ushell.components.tiles.cdm.applauncherdynamic.DynamicTile.controller");S=10;}if(s){this.loadData(S);}},extractData:function(d){var n,k=["results","icon","title","number","numberUnit","info","infoState","infoStatus","targetParams","subtitle","stateArrow","numberState","numberDigits","numberFactor"];if(typeof d==="object"&&Object.keys(d).length===1){n=Object.keys(d)[0];if(jQuery.inArray(n,k)===-1){return d[n];}}return d;},successHandleFn:function(r){var c=this.getView().getModel().getProperty("/configuration");var d=r;this.oDataRequest=undefined;if(typeof r==="object"){var u=jQuery.sap.getUriParameters(c.serviceUrl).get("$inlinecount");if(u&&u==="allpages"){d={number:r.__count};}else{d=this.extractData(d);}}else if(typeof r==="string"){d={number:r};}this.updatePropertiesHandler(d);},errorHandlerFn:function(m){this.oDataRequest=undefined;var M=m&&m.message?m.message:m,r=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle(),u=this.getView().getModel().getProperty("/configuration/serviceUrl");if(m.response){M+=" - "+m.response.statusCode+" "+m.response.statusText;}jQuery.sap.log.error("Failed to update data via service "+u+": "+M,null,"sap.ushell.components.tiles.cdm.applauncherdynamic.DynamicTile");this.updatePropertiesHandler({number:"???",info:r.getText("dynamic_data.error")});},loadData:function(s){var u=this.getView().getModel().getProperty("/configuration/serviceUrl");if(!u){return;}if(s>0){jQuery.sap.log.info("Wait "+s+" seconds before calling "+u+" again",null,"sap.ushell.components.tiles.cdm.applauncherdynamic.DynamicTile.controller");this.timer=setTimeout(this.loadData.bind(this,s,false),(s*1000));}if(!this.oDataRequest){this.oDataRequest=OData.read({requestUri:u,headers:{"Cache-Control":"no-cache, no-store, must-revalidate","Pragma":"no-cache","Expires":"0"}},this.successHandleFn.bind(this),this.errorHandlerFn.bind(this));}},onExit:function(){this.stopRequests();},addParamsToUrl:function(u,t){var p="",U=u.indexOf("?")!==-1,i;if(t&&t.length>0){for(i=0;i<t.length;i=i+1){p+=t[i];if(i<t.length-1){p+="&";}}}if(p.length>0){if(!U){u+="?";}else{u+="&";}u+=p;}return u;},_normalizeNumber:function(n,m,a,N){var b;if(isNaN(n)){b=n;}else{var o=sap.ui.core.format.NumberFormat.getFloatInstance({maxFractionDigits:N});if(!a){if(n>=1000000000){a='B';n/=1000000000;}else if(n>=1000000){a='M';n/=1000000;}else if(n>=1000){a='K';n/=1000;}}b=o.format(n);}var d=b;var c=d[m-1];m-=(c==='.'||c===',')?1:0;d=d.substring(0,m);return{displayNumber:d,numberFactor:a};},updatePropertiesHandler:function(d){var a=0,i,n,c,C,p=this.getView().getModel().getProperty("/properties"),u={title:d.title||p.title||"",subtitle:d.subtitle||p.subtitle||"",icon:d.icon||p.icon||"",info:d.info||p.info||"",targetURL:d.targetURL||p.targetURL||"",number_value:!isNaN(d.number)?d.number:"...",number_digits:d.numberDigits>=0?d.numberDigits:4,number_unit:d.numberUnit||p.number_unit||"",number_state_arrow:d.stateArrow||p.number_state_arrow||"None",number_value_state:d.numberState||p.number_value_state||"Neutral",number_factor:d.numberFactor||p.number_factor||""};var t=[];if(d.targetParams){t.push(d.targetParams);}if(d.results){for(i=0,n=d.results.length;i<n;i=i+1){c=d.results[i].number||0;if(typeof c==="string"){c=parseInt(c,10);}a=a+c;C=d.results[i].targetParams;if(C){t.push(C);}}u.number_value=a;}if(t.length>0){u.targetURL=this.addParamsToUrl(u.targetURL,t);}if(!isNaN(d.number)){if(typeof d.number==="string"){d.number=d.number.trim();}jQuery.sap.require("sap.ui.core.format.NumberFormat");var s=this._shouldProcessDigits(d.number,d.numberDigits),m=u.icon?4:5;if(d.number&&d.number.length>=m||s){var N=this._normalizeNumber(d.number,m,d.numberFactor,d.numberDigits);u.number_factor=N.numberFactor;u.number_value=N.displayNumber;}else{var o=sap.ui.core.format.NumberFormat.getFloatInstance({maxFractionDigits:m});u.number_value=o.format(d.number);}}if(u.number_value_state){switch(u.number_value_state){case"Positive":u.number_value_state="Good";break;case"Negative":u.number_value_state="Error";break;}}this.getView().getModel().setProperty("/properties",u);},_shouldProcessDigits:function(d,D){var n;d=typeof(d)!=='string'?d.toString():d;if(d.indexOf('.')!==-1){n=d.split(".")[1].length;if(n>D){return true;}}return false;}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.generic')){jQuery.sap.declare('sap.ushell.components.tiles.generic');(function(){"use strict";jQuery.sap.require('sap.ui.model.analytics.odata4analytics');jQuery.sap.require('sap.ui.core.mvc.Controller');sap.ui.core.mvc.Controller.extend("sap.ushell.components.tiles.generic",{onAfterRendering:function(){this.onAfterTileRendering();},onAfterTileRendering:function(){var t=this;this.firstTimeVisible=false;this.oKpiTileView=this.getView();this.updateDatajobScheduled=false;this.updateTimeStampjobScheduled=false;this.oViewData=this.oKpiTileView.getViewData();this.tilePressed=false;this.kpiValueFetchDeferred=true;this.evaluationFetchDeferred=true;this.backEndCallMade=false;if(!sap.ushell.components.tiles.utils){jQuery.sap.require("sap.ushell.components.tiles.utils");}this.oResourceBundle=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();this.oTileApi=this.oViewData.chip;this.system=this.oTileApi.url.getApplicationSystem();this.oKpiTileView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loading);this.getChipConfiguration(function(){t.chipCacheTime=sap.ushell.components.tiles.indicatorTileUtils.util.getCachingTime(t.oConfig);t.chipCacheTimeUnit=sap.ushell.components.tiles.indicatorTileUtils.util.getCachingTimeUnit(t.oConfig);if(t.oTileApi.preview.isEnabled()){t.doDummyProcess();}else if(t.oConfig.BLANKTILE||t.oConfig.TILE_PROPERTIES.blankTile){t.doDummyProcess();}else{if(t.oTileApi.visible&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){t.oTileApi.visible.attachVisible(t.visibleHandler.bind(t));}var n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);t.oKpiTileView.oGenericTile.$().wrap("<a href ='"+n+"'/>");t.oKpiTileView.oGenericTile.attachPress(function(){t.tilePressed=true;sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(t.queryServiceUriODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,null);window.location.hash=n;});if(!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){t.oKpiTileView.oNVConfS.attachRefresh(function(){t.oKpiTileView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loading);jQuery.proxy(t.refreshHandler(true),t);});}t.fetchEvaluation(t.oConfig,function(){t.DEFINITION_DATA=t.oConfig;var u=t.oTileApi.url.addSystemToServiceUrl(t.oConfig.EVALUATION.ODATA_URL);t.getRunTimeODataModel(u,function(){if(t.KPI_VALUE_REQUIRED){t.fetchKpiValue(function(k,T){this.KPIVALUE=k;t.doProcess(k,T);},t.logError);}else{t.doProcess();}});});}});},getRunTimeODataModel:function(u,s){if(!this.oRunTimeODataModel){this.oRunTimeODataModel=sap.ushell.components.tiles.indicatorTileUtils.util.getODataModelByServiceUri(u);}if(this.oRunTimeODataModel.getServiceMetadata()){s();}else{this.oRunTimeODataModel.attachMetadataLoaded(s);}},setTimeStamp:function(d){this.updateTimeStampjobScheduled=false;var f=sap.ui.core.format.DateFormat.getDateTimeInstance({relative:true,relativeSource:"auto",style:"short"});var t=f.format(this.getRelativeTime());this.oKpiTileView.oNVConfS.setRefreshOption(true);this.oKpiTileView.oNVConfS.setTimestamp(t);this.updateTimeStampjobScheduled=false;var k=this.oConfig.TILE_PROPERTIES.id+"time";var r=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(k);if(r){clearTimeout(r);r=undefined;}sap.ushell.components.tiles.indicatorTileUtils.util.scheduleTimeStampJob.call(this,this.oTileApi.visible.isVisible());},getChipConfiguration:function(c){var t=this;try{sap.ushell.components.tiles.indicatorTileUtils.util.getParsedChip(t.oTileApi.configuration.getParameterValueAsString("tileConfiguration"),t.oTileApi.preview.isEnabled(),function(a){t.oConfig=a;var b=sap.ushell.components.tiles.indicatorTileUtils.util.getChipTitle(t.oConfig);var s=sap.ushell.components.tiles.indicatorTileUtils.util.getChipSubTitle(t.oConfig);if(t.oTileApi.search){t.oTileApi.search.setKeywords([b,s]);}if(t.oTileApi.preview){t.oTileApi.preview.setTargetUrl(sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system));}c.call();});}catch(e){t.logError(e.message);}},fetchEvaluation:function(c,a,r,i){var t=this;var p=this.oConfig.TILE_PROPERTIES.sb_metadata||"HANA";t.DEFINITION_DATA=c;t._updateTileModel(this.DEFINITION_DATA);var b=sap.ushell.components.tiles.indicatorTileUtils.util.getBoolValue(r);if((t.oTileApi.visible.isVisible()&&!t.firstTimeVisible)||b||i){jQuery.when(sap.ushell.components.tiles.indicatorTileUtils.util.getFrontendCache(c,t.oTileApi)).done(function(d){t.firstTimeVisible=true;d=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(d||Number(t.oTileApi.configuration.getParameterValueAsString("isSufficient"))){a.call();}else{try{if(!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)||!t.dataCallInProgress){t.dataCallInProgress=true;var f=sap.ushell.components.tiles.indicatorTileUtils.cache.getEvaluationById(t.oConfig.TILE_PROPERTIES.id);if(f){t.oConfig.EVALUATION_FILTERS=f.EVALUATION_FILTERS;a.call();}else if(t.evaluationFetchDeferred){t.evaluationFetchDeferred=false;sap.ushell.components.tiles.indicatorTileUtils.util.getFilterFromRunTimeService(t.oConfig,t.oTileApi,function(g){t.evaluationFetchDeferred=true;t.oConfig.EVALUATION_FILTERS=g;if(p.toUpperCase()==="HANA"){t.parse_sapclient();}sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);a.call();});}}}catch(e){t.evaluationFetchDeferred=true;t.logError("no evaluation data");}}}).fail(function(){t.firstTimeVisible=true;if(Number(t.oTileApi.configuration.getParameterValueAsString("isSufficient"))){a.call();}else{try{var d=sap.ushell.components.tiles.indicatorTileUtils.cache.getEvaluationById(t.oConfig.TILE_PROPERTIES.id);if(d){t.oConfig.EVALUATION_FILTERS=d.EVALUATION_FILTERS;a.call();}else{sap.ushell.components.tiles.indicatorTileUtils.util.getFilterFromRunTimeService(t.oConfig,t.oTileApi,function(f){t.oConfig.EVALUATION_FILTERS=f;if(p.toUpperCase()==="HANA"){t.parse_sapclient();}sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);a.call();});}}catch(e){t.logError("no evaluation data");}}});}},getKeyForCallCheck:function(){if(this.oKpiTileView.getViewName()=="tiles.indicatornumeric.NumericTile"){return this.oConfig.TILE_PROPERTIES.id+"left";}else{return this.oConfig.TILE_PROPERTIES.id+"right";}},fetchKpiValue:function(c,E,r,a){var t=this;var k=0;try{var s=this.DEFINITION_DATA.EVALUATION.ODATA_ENTITYSET;var T=this.setThresholdValues();var m=T.fullyFormedMeasure;var b=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);var d=t.oTileApi.configuration.getParameterValueAsString("timeStamp");var i=sap.ushell.components.tiles.indicatorTileUtils.util.isCacheValid(t.oConfig.TILE_PROPERTIES.id,d,t.chipCacheTime,t.chipCacheTimeUnit,t.tilePressed);var f=sap.ushell.components.tiles.indicatorTileUtils.util.getBoolValue(r);var g=this.getKeyForCallCheck();var h=true;if(sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){var h=sap.ushell.components.tiles.indicatorTileUtils.util.isCallInProgress(g);if(h==undefined){h=true;}}if(h){if((!b||(!i&&t.oTileApi.visible.isVisible())||f||(a&&t.oTileApi.visible.isVisible())||t.getView().getViewData().refresh)){sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(g,false);if(t.kpiValueFetchDeferred){t.kpiValueFetchDeferred=false;var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.DEFINITION_DATA.EVALUATION_FILTERS,this.DEFINITION_DATA.ADDITIONAL_FILTERS);var q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oRunTimeODataModel,s,m,null,v);if(q){this.QUERY_SERVICE_MODEL=q.model;this.queryUriForKpiValue=q.uri;this.queryServiceUriODataReadRef=this.QUERY_SERVICE_MODEL.read(q.uri,null,null,true,function(l){t.backEndCallMade=true;t.kpiValueFetchDeferred=true;sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(g,true);if(l&&l.results&&l.results.length&&l.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME]!=null){k=l.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];var w={};if(q.unit[0]){t._updateTileModel({unit:l.results[0][q.unit[0].name]});w.uom=l.results[0][q.unit[0].name];}if(t.oConfig.TILE_PROPERTIES.frameType=="TwoByOne"){w.numericValue=k;}else{w.value=k;}if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){T.criticalHighValue=l.results[0][T.sCriticalHigh];T.criticalLowValue=l.results[0][T.sCriticalLow];T.warningHighValue=l.results[0][T.sWarningHigh];T.warningLowValue=l.results[0][T.sWarningLow];T.targetValue=l.results[0][T.sTarget];T.trendValue=l.results[0][T.sTrend];}else if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="RELATIVE"){T.targetValue=Number(l.results[0][T.sTarget]);T.criticalHighValue=T.targetValue*T.criticalHighValue/100;T.criticalLowValue=T.targetValue*T.criticalLowValue/100;T.warningHighValue=T.targetValue*T.warningHighValue/100;T.warningLowValue=T.targetValue*T.warningLowValue/100;T.trendValue=Number(l.results[0][T.sTrend]);}w.cl=T.criticalLowValue;w.ch=T.criticalHighValue;w.wl=T.warningLowValue;w.wh=T.warningHighValue;w.trend=T.trendValue;w.target=T.targetValue;w.isCurM=t.isCurrencyMeasure(t.oConfig.EVALUATION.COLUMN_NAME);var n={};n.ChipId=t.oConfig.TILE_PROPERTIES.id;n.Data=JSON.stringify(w);n.CacheMaxAge=Number(t.chipCacheTime);n.CacheMaxAgeUnit=t.chipCacheTimeUnit;n.CacheType=1;var o=t.getLocalCache(n);if(!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,o);var u=false;if(b){u=true;}if(t.chipCacheTime){sap.ushell.components.tiles.indicatorTileUtils.util.writeFrontendCacheByChipAndUserId(t.oTileApi,t.oConfig.TILE_PROPERTIES.id,n,u,function(l){if(l){t.cacheTime=l&&l.CachedTime;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,l);t.setTimeStamp(t.cacheTime);}if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){jQuery.proxy(t.setTimeStamp(t.cacheTime),t);}});}}else{var p=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(p){if(!p.CachedTime){p.CachedTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();}var x=p.Data;if(x){x=JSON.parse(x);if(t.oKpiTileView.getViewName()=="tiles.indicatornumeric.NumericTile"){x.leftData=w;}else{x.rightData=w;}}p.Data=JSON.stringify(x);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,p);}else{var x={};if(t.oKpiTileView.getViewName()=="tiles.indicatornumeric.NumericTile"){x.leftData=w;}else{x.rightData=w;}o.Data=JSON.stringify(x);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,o);}t.cacheWriteData=w;}t.cacheTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();t.updateDatajobScheduled=false;var y=t.oConfig.TILE_PROPERTIES.id+"data";var z=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(y);if(z){clearTimeout(z);z=undefined;}c.call(t,k,T);}else{sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,{empty:"empty"});t.setNoData();}},function(l){t.kpiValueFetchDeferred=true;sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(g,true);if(l&&l.response){jQuery.sap.log.error(l.message+" : "+l.request.requestUri);E.call(t,l);}});}else{t.kpiValueFetchDeferred=true;sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(g,true);t.logError("Error Preparing Query Service URI");}}}else{if(t.DEFINITION_DATA.TILE_PROPERTIES.frameType==sap.suite.ui.commons.FrameType.OneByOne){if(b&&b.Data){var j=b.Data&&JSON.parse(b.Data);k=j.value;if(j.uom){t._updateTileModel({unit:j.uom});}if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){T.criticalHighValue=j.ch;T.criticalLowValue=j.cl;T.warningHighValue=j.wh;T.warningLowValue=j.wl;T.targetValue=j.target;T.trendValue=j.trend;}else if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="RELATIVE"){T.targetValue=Number(j.target);T.criticalHighValue=T.targetValue*T.ch/100;T.criticalLowValue=T.targetValue*T.cl/100;T.warningHighValue=T.targetValue*T.wh/100;T.warningLowValue=T.targetValue*T.wl/100;T.trendValue=Number(j.trend);}t.cacheTime=b.CachedTime;if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){jQuery.proxy(t.setTimeStamp(b.CachedTime),t);}c.call(t,k,T);}else{t.setNoData();}}else{if(b&&b.Data){var j=b.Data&&JSON.parse(b.Data);if(t.oKpiTileView.getViewName()=="tiles.indicatornumeric.NumericTile"){j=j.leftData;}else{j=j.rightData;}k=j.numericValue;if(j.unit){t._updateTileModel({unit:j.unit});}if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){T.criticalHighValue=j.ch;T.criticalLowValue=j.cl;T.warningHighValue=j.wh;T.warningLowValue=j.wl;T.targetValue=j.target;T.trendValue=j.trend;}else if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="RELATIVE"){T.targetValue=Number(j.target);T.criticalHighValue=T.targetValue*T.criticalHighValue/100;T.criticalLowValue=T.targetValue*T.criticalLowValue/100;T.warningHighValue=T.targetValue*T.warningHighValue/100;T.warningLowValue=T.targetValue*T.warningLowValue/100;T.trendValue=Number(j.trend);}t.cacheTime=b.CachedTime;if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){jQuery.proxy(t.setTimeStamp(b.CachedTime),t);}c.call(t,k,T);}else{t.setNoData();}}}}}catch(e){t.logError(e);}},getLocalCache:function(c){var l={};l.ChipId=c.ChipId;l.Data=c.Data;l.CacheMaxAge=c.CacheMaxAgeUnit;l.CacheMaxAgeUnit=c.CacheMaxAgeUnit;l.CacheType=c.CacheType;l.CachedTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();return l;},_setLocalModelToTile:function(){if(!this.getTile().getModel()){this.getTile().setModel(new sap.ui.model.json.JSONModel({}));}},getTile:function(){return this.oKpiTileView.oGenericTile;},_updateTileModel:function(n){var m=this.getTile().getModel().getData();jQuery.extend(m,n);this.getTile().getModel().setData(m);},isCurrencyMeasure:function(m){var t=this;var c=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(c&&c.Data){var k=c.Data&&JSON.parse(c.Data);if(sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){if(t.oKpiTileView.getViewName()=="tiles.indicatornumeric.NumericTile"){k=k.leftData;}else{k=k.rightData;}}if(t.oKpiTileView.getViewName()=="tiles.indicatorcomparison.ComparisonTile"){if(k&&k.data&&k.data.length){for(var i=0;i<k.data.length;i++){if(k.data[i]&&k.data[i].measure==m){if(jQuery.type(k.data[i].isCurM)=="boolean"){return k.data[i].isCurM;}else{return t.isACurrencyMeasure(m);}break;}else{return t.isACurrencyMeasure(m);}}}else{return t.isACurrencyMeasure(m);}}if(k&&jQuery.type(k.isCurM)=="boolean"){return k.isCurM;}else{return t.isACurrencyMeasure(m);}}else{return t.isACurrencyMeasure(m);}},isACurrencyMeasure:function(m){var u=this.DEFINITION_DATA.EVALUATION.ODATA_URL;var e=this.DEFINITION_DATA.EVALUATION.ODATA_ENTITYSET;return sap.ushell.components.tiles.indicatorTileUtils.util.getFormattingMetadata(this.oTileApi.url.addSystemToServiceUrl(u),e,m)._hasCurrency;},autoFormatter:function(n,i){i=i||false;if(!n){return"";}return sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(n),this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION,i);},setToolTip:function(a,c,t){var b=this;var C;var T=this.setThresholdValues();var m=this.oConfig.EVALUATION.COLUMN_NAME;var i=this.isCurrencyMeasure(m);if(t=="CONT"||t=="COMP"){if(this.oKpiTileView.getContent()[0].getTileContent().length){C=b.oKpiTileView.getContent()[0].getTileContent()[0].getContent();var d,e,f,v,g,h,j,k,l;if(c&&c[0]){d=c[0].title;v=this.autoFormatter(c[0].value,i);j=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(c[0].color);}if(c&&c[1]){e=c[1].title;g=this.autoFormatter(c[1].value,i);k=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(c[1].color);}if(c&&c[2]){f=c[2].title;h=this.autoFormatter(c[2].value,i);l=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(c[2].color);}var o={};o["0"]=this.oConfig.EVALUATION.COLUMN_NAME+",asc";o["1"]=this.oConfig.EVALUATION.COLUMN_NAME+",desc";o["2"]=this.oConfig.TILE_PROPERTIES.dimension+",asc";o["3"]=this.oConfig.TILE_PROPERTIES.dimension+",desc";var n=o[this.oConfig.TILE_PROPERTIES.sortOrder||"0"].split(",");var p={measure:this.oConfig.EVALUATION.COLUMN_NAME,contributionTile:n,m1:d,v1:v,c1:j,m2:e,v2:g,c2:k,m3:f,v3:h,c3:l};sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(C,t,p);}}else{var s="";if(a=="Error"){s="sb.error";}if(a=="Neutral"){s="sb.neutral";}if(a=="Critical"){s="sb.critical";}if(a=="Good"){s="sb.good";}var p={status:s,actual:this.autoFormatter(c,i),target:this.autoFormatter(T.targetValue,i),cH:this.autoFormatter(T.criticalHighValue,i),wH:this.autoFormatter(T.warningHighValue,i),wL:this.autoFormatter(T.warningLowValue,i),cL:this.autoFormatter(T.criticalLowValue,i)};var C=b.oKpiTileView.getContent()[0].getTileContent()[0]&&b.oKpiTileView.getContent()[0].getTileContent()[0].getContent();sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(C,t,p);}},getTrendColor:function(t){var a=this,w,c,b,d;try{var i=this.DEFINITION_DATA.EVALUATION.GOAL_TYPE;this.DEFINITION_DATA.EVALUATION_VALUES;var r=sap.suite.ui.commons.InfoTileValueColor.Neutral;if(i==="MI"){if(t.criticalHighValue&&t.warningHighValue){d=Number(t.criticalHighValue);b=Number(t.warningHighValue);if(this.CALCULATED_KPI_VALUE<b){r=sap.suite.ui.commons.InfoTileValueColor.Good;}else if(this.CALCULATED_KPI_VALUE<=d){r=sap.suite.ui.commons.InfoTileValueColor.Critical;}else{r=sap.suite.ui.commons.InfoTileValueColor.Error;}}}else if(i==="MA"){if(t.criticalLowValue&&t.warningLowValue){c=Number(t.criticalLowValue);w=Number(t.warningLowValue);if(this.CALCULATED_KPI_VALUE<c){r=sap.suite.ui.commons.InfoTileValueColor.Error;}else if(this.CALCULATED_KPI_VALUE<=w){r=sap.suite.ui.commons.InfoTileValueColor.Critical;}else{r=sap.suite.ui.commons.InfoTileValueColor.Good;}}}else{if(t.warningLowValue&&t.warningHighValue&&t.criticalLowValue&&t.criticalHighValue){d=Number(t.criticalHighValue);b=Number(t.warningHighValue);w=Number(t.warningLowValue);c=Number(t.criticalLowValue);if(this.CALCULATED_KPI_VALUE<c||this.CALCULATED_KPI_VALUE>d){r=sap.suite.ui.commons.InfoTileValueColor.Error;}else if((this.CALCULATED_KPI_VALUE>=c&&this.CALCULATED_KPI_VALUE<=w)||(this.CALCULATED_KPI_VALUE>=b&&this.CALCULATED_KPI_VALUE<=d)){r=sap.suite.ui.commons.InfoTileValueColor.Critical;}else{r=sap.suite.ui.commons.InfoTileValueColor.Good;}}}return r;}catch(e){a.logError(e);}},getTrendIndicator:function(t){var a=this;t=Number(t);try{var b=sap.suite.ui.commons.DeviationIndicator.None;if(t>this.CALCULATED_KPI_VALUE){b=sap.suite.ui.commons.DeviationIndicator.Down;}else if(t<this.CALCULATED_KPI_VALUE){b=sap.suite.ui.commons.DeviationIndicator.Up;}return b;}catch(e){a.logError(e);}},setThresholdValues:function(){var t=this;try{var T={};T.fullyFormedMeasure=this.DEFINITION_DATA.EVALUATION.COLUMN_NAME;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){var c=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);switch(this.DEFINITION_DATA.EVALUATION.GOAL_TYPE){case"MI":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);if(c&&c.data&&c.data.results&&c.data.results.length){T.trendValue=Number(c.data.results[0][T.sTrend]);T.targetValue=Number(c.data.results[0][T.sTarget]);T.criticalHighValue=Number(c.data.results[0][T.sCriticalHigh]);T.warningHighValue=Number(c.data.results[0][T.sWarningHigh]);}break;case"MA":T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);if(c&&c.data&&c.data.results&&c.data.results.length){T.criticalLowValue=Number(c.data.results[0][T.sCriticalLow]);T.warningLowValue=Number(c.data.results[0][T.sWarningLow]);T.trendValue=Number(c.data.results[0][T.sTrend]);T.targetValue=Number(c.data.results[0][T.sTarget]);}break;case"RA":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);if(c&&c.data&&c.data.results&&c.data.results.length){T.criticalLowValue=Number(c.data.results[0][T.sCriticalLow]);T.warningLowValue=Number(c.data.results[0][T.sWarningLow]);T.trendValue=Number(c.data.results[0][T.sTrend]);T.targetValue=Number(c.data.results[0][T.sTarget]);T.criticalHighValue=Number(c.data.results[0][T.sCriticalHigh]);T.warningHighValue=Number(c.data.results[0][T.sWarningHigh]);}break;}}else if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="RELATIVE"){T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);T.criticalHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","FIXED");T.criticalLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","FIXED");T.warningHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","FIXED");T.warningLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","FIXED");}else{T.criticalHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","FIXED");T.criticalLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","FIXED");T.warningHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","FIXED");T.warningLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","FIXED");T.targetValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","FIXED");T.trendValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","FIXED");}return T;}catch(e){t.logError(e);}},formSelectStatement:function(o){var t=Object.keys(o);var f="";for(var i=0;i<t.length;i++){if((o[t[i]]!==undefined)&&(o.fullyFormedMeasure)){f=f+","+o[t[i]];}}return f;},parse_sapclient:function(){var i,S,r,f,a;S="P_SAPClient";r="$$$";f=this.oConfig.EVALUATION_FILTERS;if(f.constructor!==Array){return;}if(f.length<1){return;}for(i in f){a=f[i];if(a["NAME"]===S&&a["VALUE_1"]===r){break;}a=null;}if(a){jQuery.when(sap.ushell.components.tiles.indicatorTileUtils.util.getHanaClient()).done(function(c){a["VALUE_1"]=c;});}},setTextInTile:function(){var t=this;var a=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.oTileApi);this._updateTileModel({header:a.title||sap.ushell.components.tiles.indicatorTileUtils.util.getChipTitle(t.oConfig),subheader:a.subTitle||sap.ushell.components.tiles.indicatorTileUtils.util.getChipSubTitle(t.oConfig)});},logError:function(e){this._updateTileModel({value:"",scale:"",unit:""});jQuery.sap.log.error(e);if(this.getView().getViewData().deferredObj){this.getView().getViewData().deferredObj.reject();}else{this.oKpiTileView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Failed);}},setNoData:function(){var v=this.getView().getViewData();if(v.parentController){v.parentController.setNoData();if(v.deferredObj){v.deferredObj.resolve();}}else{try{this._updateTileModel({value:"",scale:"",unit:"",footerNum:this.oResourceBundle.getText("sb.noDataAvailable"),footerComp:this.oResourceBundle.getText("sb.noDataAvailable")});this.oKpiTileView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);}catch(e){}}},refreshHandler:function(r,a){var t=this;var i=sap.ushell.components.tiles.indicatorTileUtils.util.getBoolValue(r);var b=sap.ushell.components.tiles.indicatorTileUtils.util.getBoolValue(a);if(!t.firstTimeVisible||i||b){t.fetchEvaluation(t.oConfig,function(){if(t.oConfig.TILE_PROPERTIES.tileType=="NT"||t.oConfig.TILE_PROPERTIES.tileType=="DT"||t.oKpiTileView.getViewName()=="tiles.indicatornumeric.NumericTile"||t.oKpiTileView.getViewName()=="tiles.indicatordeviation.DeviationTile"){var u=t.oTileApi.url.addSystemToServiceUrl(t.oConfig.EVALUATION.ODATA_URL);t.getRunTimeODataModel(u,function(){if(t.KPI_VALUE_REQUIRED){t.fetchKpiValue(function(k,T){this.KPIVALUE=k;t.doProcess(k,T);},t.logError,r,b);}else{t.doProcess();}});}else{var u=t.oTileApi.url.addSystemToServiceUrl(t.oConfig.EVALUATION.ODATA_URL);t.getRunTimeODataModel(u,function(){if(t.KPI_VALUE_REQUIRED){t.doProcess(t.KPIVALUE,t.setThresholdValues());}else{t.doProcess(i,b);}});}},r,b);}},getRelativeTime:function(){var c=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();if(jQuery.type(this.cacheTime)=="date"){var t=this.cacheTime;}else{var t=new Date(parseInt(this.cacheTime.substr(6),10));}var r=sap.ushell.components.tiles.indicatorTileUtils.util.getTimeDifference(c-t);var a;switch(r.unit){case"minutes":var o=sap.ushell.components.tiles.indicatorTileUtils.util.getMillisecond(r.time,"minutes");c=c-o;a=new Date(c);break;case"hours":var o=sap.ushell.components.tiles.indicatorTileUtils.util.getMillisecond(r.time,"hours");c=c-o;a=new Date(c);break;case"days":var o=sap.ushell.components.tiles.indicatorTileUtils.util.getMillisecond(r.time,"days");c=c-o;a=new Date(c);break;}return a;},visibleHandler:function(i){if(!i){this.firstTimeVisible=false;sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.queryServiceUriODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.trendChartODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.comparisionChartODataRef);}if(i){this.refreshHandler(this);}},_getEvaluationThresholdMeasures:function(){var t=[];t.push(this.oConfig.EVALUATION.COLUMN_NAME);if(this.oConfig.EVALUATION.VALUES_SOURCE==="MEASURE"){var a=this.oConfig.EVALUATION_VALUES;if(a&&a.length){for(var i=0;i<a.length;i++){if((a[i]).COLUMN_NAME&&!((a[i]).FIXED)){t.push((a[i]).COLUMN_NAME);}}}}return t;},onExit:function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.queryServiceUriODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.trendChartODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.comparisionChartODataRef);}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.indicatorArea.AreaChartTile.controller')){jQuery.sap.declare('sap.ushell.components.tiles.indicatorArea.AreaChartTile.controller');(function(){"use strict";sap.ushell.components.tiles.generic.extend("sap.ushell.components.tiles.indicatorArea.AreaChartTile",{onInit:function(){this.KPI_VALUE_REQUIRED=false;},doProcess:function(r,i){this.onAfterFinalEvaluation(r,i);},scheduleJob:function(d){if(this.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(this.oConfig)){sap.ushell.components.tiles.indicatorTileUtils.util.scheduleFetchDataJob.call(this,this.oTileApi.visible.isVisible());}},onAfterFinalEvaluation:function(r,d){var t=this;var u=this.DEFINITION_DATA.EVALUATION.ODATA_URL;var E=this.DEFINITION_DATA.EVALUATION.ODATA_ENTITYSET;var m=this.DEFINITION_DATA.EVALUATION.COLUMN_NAME;var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.DEFINITION_DATA.EVALUATION_FILTERS,this.DEFINITION_DATA.ADDITIONAL_FILTERS);var f=this.DEFINITION_DATA.TILE_PROPERTIES.dimension;if(f==undefined){this.logError();return;}var g=this.DEFINITION_DATA.EVALUATION.GOAL_TYPE;var h=this.DEFINITION_DATA.EVALUATION_VALUES;var j=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);var k=t.oTileApi.configuration.getParameterValueAsString("timeStamp");var l=sap.ushell.components.tiles.indicatorTileUtils.util.isCacheValid(t.oConfig.TILE_PROPERTIES.id,k,t.chipCacheTime,t.chipCacheTimeUnit,t.tilePressed);var n=m;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){switch(g){case"MI":t.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");t.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");t.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");t.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");if(t.sWarningHigh&&t.sCriticalHigh&&t.sTarget){n+=","+t.sWarningHigh+","+t.sCriticalHigh+","+t.sTarget;}break;case"MA":t.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");t.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");t.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");t.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");if(t.sWarningLow&&t.sCriticalLow&&t.sTarget){n+=","+t.sWarningLow+","+t.sCriticalLow+","+t.sTarget;}break;case"RA":t.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");t.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");t.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");t.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");t.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");t.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");if(t.sWarningLow&&t.sCriticalLow&&t.sTarget&&t.sWarningHigh&&t.sCriticalHigh){n+=","+t.sWarningLow+","+t.sCriticalLow+","+t.sTarget+","+t.sWarningHigh+","+t.sCriticalHigh;}break;}}var o=sap.ushell.components.tiles.indicatorTileUtils.util.getBoolValue(r);if(!j||(!l&&t.oTileApi.visible.isVisible())||o||(d&&t.oTileApi.visible.isVisible())||t.getView().getViewData().refresh){if(t.kpiValueFetchDeferred){t.kpiValueFetchDeferred=false;var q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oTileApi.url.addSystemToServiceUrl(u),E,n,f,v);if(q){this.queryUriForTrendChart=q.uri;var w={};try{this.trendChartODataReadRef=q.model.read(q.uri,null,null,true,function(a){t.kpiValueFetchDeferred=true;if(a&&a.results&&a.results.length){if(q.unit[0]){t.unit=a.results[0][q.unit[0].name];t.CURRENCY_CODE=t.unit;w.unit=q.unit[0];w.unit.name=q.unit[0].name;}t.queryUriResponseForTrendChart=a;f=sap.ushell.components.tiles.indicatorTileUtils.util.findTextPropertyForDimension(t.oTileApi.url.addSystemToServiceUrl(u),E,f);a.results.splice(3);a.firstXlabel=a.results[0][f];a.lastXlabel=a.results[a.results.length-1][f];w.data=a;if(w&&w.data&&w.data.results&&w.data.results.length){for(var i=0;i<w.data.results.length;i++){delete w.data.results[i].__metadata;}}w.isCurM=t.isCurrencyMeasure(t.oConfig.EVALUATION.COLUMN_NAME);w.dimensionName=f;_(a,t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE);var c={};t.cacheTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();c.ChipId=t.oConfig.TILE_PROPERTIES.id;c.Data=JSON.stringify(w);c.CacheMaxAge=Number(t.chipCacheTime);c.CacheMaxAgeUnit=t.chipCacheTimeUnit;c.CacheType=1;var b=t.getLocalCache(c);if(t.DEFINITION_DATA.TILE_PROPERTIES.frameType==sap.suite.ui.commons.FrameType.TwoByOne){var x=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(x){if(!x.CachedTime){x.CachedTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();}var y=x.Data;if(y){y=JSON.parse(y);y.rightData=w;}x.Data=JSON.stringify(y);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,x);}else{var y={};y.rightData=w;b.Data=JSON.stringify(y);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,b);}t.cacheWriteData=w;t.getView().getViewData().deferredObj.resolve();}else{sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,b);var U=false;if(j){U=true;}if(t.chipCacheTime){sap.ushell.components.tiles.indicatorTileUtils.util.writeFrontendCacheByChipAndUserId(t.oTileApi,t.oConfig.TILE_PROPERTIES.id,c,U,function(a){if(a){t.cacheTime=a&&a.CachedTime;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,a);t.setTimeStamp();}if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){jQuery.proxy(t.setTimeStamp(t.cacheTime),t);}});}var z=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);t.oKpiTileView.oGenericTile.$().wrap("<a href ='"+z+"'/>");t.oKpiTileView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);t.updateDatajobScheduled=false;var A=t.oConfig.TILE_PROPERTIES.id+"data";var B=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(A);if(B){clearTimeout(B);B=undefined;}jQuery.proxy(t.scheduleJob(t.cacheTime),t);}}else{t.setNoData();}},function(a){t.kpiValueFetchDeferred=true;if(a&&a.response){t.logError("Data call failed");}});}catch(e){t.kpiValueFetchDeferred=true;t.logError(e);}}else{t.kpiValueFetchDeferred=true;t.logError();}}}else{if(j&&j.Data){try{var p;var s=t.oConfig&&t.oConfig.TILE_PROPERTIES&&t.oConfig.TILE_PROPERTIES.tileType;if(s.indexOf("DT-")==-1){p=j.Data&&JSON.parse(j.Data);}else{p=j.Data&&JSON.parse(j.Data);p=p.rightData;}if(p.unit){t.unit=p.data.results[0][p.unit.name];t.CURRENCY_CODE=t.unit;}t.cacheTime=j.CachedTime;if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){jQuery.proxy(t.setTimeStamp(t.cacheTime),t);}t.queryUriResponseForTrendChart=p.data;f=p.dimensionName;_(p.data,t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE);if(t.oConfig.TILE_PROPERTIES.frameType==sap.suite.ui.commons.FrameType.OneByOne){t.oKpiTileView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);}else{t.getView().getViewData().deferredObj.resolve();}jQuery.proxy(t.scheduleJob(t.cacheTime),t);}catch(e){t.logError(e);}}else{t.setNoData();}}function _(x,y){var z=[];var A=[];var B=[];var C=[];var D=[];var F=[];var G=x.firstXlabel;var H,I,J,K,L;var M=x.lastXlabel;var N=Number(x.results[0][m]);var O=Number(x.results[x.results.length-1][m]);var i;for(i in x.results){x.results[i][f]=Number(i);x.results[i][m]=Number(x.results[i][m]);t.sWarningHigh?x.results[i][t.sWarningHigh]=Number(x.results[i][t.sWarningHigh]):"";t.sCriticalHigh?x.results[i][t.sCriticalHigh]=Number(x.results[i][t.sCriticalHigh]):"";t.sCriticalLow?x.results[i][t.sCriticalLow]=Number(x.results[i][t.sCriticalLow]):"";t.sWarningLow?x.results[i][t.sWarningLow]=Number(x.results[i][t.sWarningLow]):"";t.sTarget?x.results[i][t.sTarget]=Number(x.results[i][t.sTarget]):"";t.sWarningHigh?B.push(x.results[i][t.sWarningHigh]):"";t.sCriticalHigh?C.push(x.results[i][t.sCriticalHigh]):"";t.sCriticalLow?D.push(x.results[i][t.sCriticalLow]):"";t.sWarningLow?F.push(x.results[i][t.sWarningLow]):"";z.push(x.results[i][f]);A.push(x.results[i][m]);}try{G=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(G);M=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(M);}catch(e){t.logError(e);}var P=Number(N);if(t.oConfig.EVALUATION.SCALING==-2){P*=100;}var Q=Math.min.apply(Math,A);var c=t.isCurrencyMeasure(t.oConfig.EVALUATION.COLUMN_NAME);var R=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(P,t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION,c,t.CURRENCY_CODE);if(t.oConfig.EVALUATION.SCALING==-2){R+=" %";}var S=R.toString();var T=Number(O);if(t.oConfig.EVALUATION.SCALING==-2){T*=100;}var U=Math.max.apply(Math,A);c=t.isCurrencyMeasure(t.oConfig.EVALUATION.COLUMN_NAME);var V=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(T,t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION,c,t.CURRENCY_CODE);if(t.oConfig.EVALUATION.SCALING==-2){V+=" %";}var W=V.toString();try{var X=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(Math.min.apply(Math,z));var Y=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(Math.max.apply(Math,z));}catch(e){t.logError(e);}if(y=="MEASURE"){(B.length!=0)?(t.firstwH=B[X])&&(t.lastwH=B[Y]):"";(C.length!=0)?(t.firstcH=C[X])&&(t.lastcH=C[Y]):"";(D.length!=0)?(t.firstcL=D[X])&&(t.lastcL=D[Y]):"";(F.length!=0)?(t.firstwL=F[X])&&(t.lastwL=F[Y]):"";}var Z={width:"100%",height:"100%",unit:t.unit||"",chart:{color:"Neutral",data:x.results},size:"Auto",minXValue:X,maxXValue:Y,minYValue:Q,maxYValue:U,firstXLabel:{label:G+"",color:"Neutral"},lastXLabel:{label:M+"",color:"Neutral"},firstYLabel:{label:S+"",color:"Neutral"},lastYLabel:{label:W+"",color:"Neutral"},minLabel:{},maxLabel:{}};switch(g){case"MA":for(i in h){if(h[i].TYPE=="CL"){Z.minThreshold={color:"Error"};var $={};$[f]="";$[m]=Number(h[i].FIXED);t.cl=Number(h[i].FIXED);Z.minThreshold.data=(y=="MEASURE")?x.results:[$];H=(y=="MEASURE")?t.sCriticalLow:m;}else if(h[i].TYPE=="WL"){Z.maxThreshold={color:"Good"};var $={};$[f]="";$[m]=Number(h[i].FIXED);Z.maxThreshold.data=(y=="MEASURE")?x.results:[$];I=(y=="MEASURE")?t.sWarningLow:m;t.wl=Number(h[i].FIXED);}else if(h[i].TYPE=="TA"){var $={};$[f]="";$[m]=Number(h[i].FIXED);Z.target={color:"Neutral"};Z.target.data=(y=="MEASURE")?x.results:[$];L=(y=="MEASURE")?t.sTarget:m;}}Z.innerMinThreshold={data:[]};Z.innerMaxThreshold={data:[]};if(y=="FIXED"){Z.firstYLabel.color=N<t.cl?"Error":((t.cl<=N)&&(N<=t.wl))?"Critical":(N>t.wl)?"Good":"Neutral";Z.lastYLabel.color=O<t.cl?"Error":((t.cl<=O)&&(O<=t.wl))?"Critical":(O>t.wl)?"Good":"Neutral";}else if(y=="MEASURE"&&t.firstwL&&t.lastwL&&t.firstcL&&t.lastcL){Z.firstYLabel.color=N<t.firstcL?"Error":((t.firstcL<=N)&&(N<=t.firstwL))?"Critical":(N>t.firstwL)?"Good":"Neutral";Z.lastYLabel.color=O<t.lastcL?"Error":((t.lastcL<=O)&&(O<=t.lastwL))?"Critical":(O>t.lastwL)?"Good":"Neutral";}break;case"MI":for(i in h){if(h[i].TYPE=="CH"){var $={};$[f]="";$[m]=Number(h[i].FIXED);t.ch=Number(h[i].FIXED);Z.maxThreshold={color:"Error"};Z.maxThreshold.data=(y=="MEASURE")?x.results:[$];I=(y=="MEASURE")?t.sCriticalHigh:m;}else if(h[i].TYPE=="WH"){var $={};$[f]="";$[m]=Number(h[i].FIXED);t.wh=Number(h[i].FIXED);Z.minThreshold={color:"Good"};Z.minThreshold.data=(y=="MEASURE")?x.results:[$];H=(y=="MEASURE")?t.sWarningHigh:m;}else if(h[i].TYPE=="TA"){var $={};$[f]="";$[m]=Number(h[i].FIXED);Z.target={color:"Neutral"};Z.target.data=(y=="MEASURE")?x.results:[$];L=(y=="MEASURE")?t.sTarget:m;}}if(y=="FIXED"){Z.firstYLabel.color=N>t.ch?"Error":((t.wh<=N)&&(N<=t.ch))?"Critical":(N<t.wh)?"Good":"Neutral";Z.lastYLabel.color=O>t.ch?"Error":((t.wh<=O)&&(O<=t.ch))?"Critical":(O<t.wh)?"Good":"Neutral";}else if(y=="MEASURE"&&t.firstwH&&t.lastwH&&t.firstcH&&t.lastcH){Z.firstYLabel.color=N>t.firstcH?"Error":((t.firstwH<=N)&&(N<=t.firstcH))?"Critical":(N<t.firstwH)?"Good":"Neutral";Z.lastYLabel.color=O>t.lastcH?"Error":((t.lastwH<=O)&&(O<=t.lastcH))?"Critical":(O<t.lastwH)?"Good":"Neutral";}Z.innerMaxThreshold={data:[]};Z.innerMinThreshold={data:[]};break;case"RA":for(i in h){if(h[i].TYPE=="CH"){var $={};$[f]="";$[m]=Number(h[i].FIXED);t.ch=Number(h[i].FIXED);Z.maxThreshold={color:"Error"};Z.maxThreshold.data=(y=="MEASURE")?x.results:[$];I=(y=="MEASURE")?t.sCriticalHigh:m;}else if(h[i].TYPE=="WH"){var $={};$[f]="";$[m]=Number(h[i].FIXED);t.wh=Number(h[i].FIXED);Z.innerMaxThreshold={color:"Good"};Z.innerMaxThreshold.data=(y=="MEASURE")?x.results:[$];K=(y=="MEASURE")?t.sWarningHigh:m;}else if(h[i].TYPE=="WL"){var $={};$[f]="";$[m]=Number(h[i].FIXED);t.wl=Number(h[i].FIXED);Z.innerMinThreshold={color:"Good"};Z.innerMinThreshold.data=(y=="MEASURE")?x.results:[$];J=(y=="MEASURE")?t.sWarningLow:m;}else if(h[i].TYPE=="CL"){var $={};$[f]="";$[m]=Number(h[i].FIXED);t.cl=Number(h[i].FIXED);Z.minThreshold={color:"Error"};Z.minThreshold.data=(y=="MEASURE")?x.results:[$];H=(y=="MEASURE")?t.sCriticalLow:m;}else if(h[i].TYPE=="TA"){var $={};$[f]="";$[m]=Number(h[i].FIXED);Z.target={color:"Neutral"};Z.target.data=(y=="MEASURE")?x.results:[$];L=(y=="MEASURE")?t.sTarget:m;}}if(y=="FIXED"){Z.firstYLabel.color=(N>t.ch||N<t.cl)?"Error":((t.wh<=N)&&(N<=t.ch))||((t.cl<=N)&&(N<=t.wl))?"Critical":((N>=t.wl)&&(N<=t.wh))?"Good":"Neutral";Z.lastYLabel.color=(O>t.ch||O<t.cl)?"Error":((t.wh<=O)&&(O<=t.ch))||((t.cl<=O)&&(O<=t.wl))?"Critical":((O>=t.wl)&&(O<=t.wh))?"Good":"Neutral";}else if(y=="MEASURE"&&t.firstwL&&t.lastwL&&t.firstcL&&t.lastcL&&t.firstwH&&t.lastwH&&t.firstcH&&t.lastcH){Z.firstYLabel.color=(N>t.firstcH||N<t.firstcL)?"Error":((t.firstwH<=N)&&(N<=t.firstcH))||((t.firstcL<=N)&&(N<=t.firstwL))?"Critical":((N>=t.firstwL)&&(N<=t.firstwH))?"Good":"Neutral";Z.lastYLabel.color=(O>t.lastcH||O<t.lastcL)?"Error":((t.lastwH<=O)&&(O<=t.lastcH))||((t.lastcL<=O)&&(O<=t.lastwL))?"Critical":((O>=t.lastwL)&&(O<=t.lastwH))?"Good":"Neutral";}break;}var a1=function(c1,a,b,y){return new sap.suite.ui.commons.MicroAreaChartItem({color:"{/"+c1+"/color}",points:{path:"/"+c1+"/data",template:new sap.suite.ui.commons.MicroAreaChartPoint({x:"{"+a+"}",y:"{"+b+"}"})}});};var b1=t.getView().oNVConfContS;b1.setTarget(a1("target",f,L));b1.setInnerMinThreshold(a1("innerMinThreshold",f,J));b1.setInnerMaxThreshold(a1("innerMaxThreshold",f,K));b1.setMinThreshold(a1("minThreshold",f,H));b1.setMaxThreshold(a1("maxThreshold",f,I));b1.setChart(a1("chart",f,m));t.setTextInTile();if(t.getView().getViewData().parentController){t.getView().getViewData().parentController._updateTileModel(Z);}else{t._updateTileModel(Z);}}},doDummyProcess:function(){var t=this;this.setTextInTile();t._updateTileModel({footer:"",description:"",width:"100%",height:"100%",chart:{color:"Good",data:[{day:0,balance:0},{day:30,balance:20},{day:60,balance:20},{day:100,balance:80}]},target:{color:"Error",data:[{day:0,balance:0},{day:30,balance:30},{day:60,balance:40},{day:100,balance:90}]},maxThreshold:{color:"Good",data:[{day:0,balance:0},{day:30,balance:40},{day:60,balance:50},{day:100,balance:100}]},innerMaxThreshold:{color:"Error",data:[]},innerMinThreshold:{color:"Neutral",data:[]},minThreshold:{color:"Error",data:[{day:0,balance:0},{day:30,balance:20},{day:60,balance:30},{day:100,balance:70}]},minXValue:0,maxXValue:100,minYValue:0,maxYValue:100,firstXLabel:{label:"June 123",color:"Error"},lastXLabel:{label:"June 30",color:"Error"},firstYLabel:{label:"0M",color:"Good"},lastYLabel:{label:"80M",color:"Critical"},minLabel:{},maxLabel:{}});this.oKpiTileView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.indicatorArea.AreaChartTile.view')){jQuery.sap.declare('sap.ushell.components.tiles.indicatorArea.AreaChartTile.view');(function(){"use strict";jQuery.sap.require('sap.ui.model.analytics.odata4analytics');sap.ui.getCore().loadLibrary("sap.suite.ui.commons");sap.ui.jsview("sap.ushell.components.tiles.indicatorArea.AreaChartTile",{getControllerName:function(){return"sap.ushell.components.tiles.indicatorArea.AreaChartTile";},createContent:function(c){this.setHeight('100%');this.setWidth('100%');var h="Lorem ipsum";var s="Lorem ipsum";var t=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.getViewData().chip);if(t.title&&t.subTitle){h=t.title;s=t.subTitle;}var b=function(n){return new sap.suite.ui.commons.MicroAreaChartItem({color:"Good",points:{path:"/"+n+"/data",template:new sap.suite.ui.commons.MicroAreaChartPoint({x:"{day}",y:"{balance}"})}});};var a=function(n){return new sap.suite.ui.commons.MicroAreaChartLabel({label:"{/"+n+"/label}",color:"{/"+n+"/color}"});};var g={subheader:s,header:h,footerNum:"",footerComp:"",scale:"",unit:"",value:8888,size:"Auto",frameType:"OneByOne",state:sap.suite.ui.commons.LoadState.Loading};this.oNVConfContS=new sap.suite.ui.commons.MicroAreaChart({width:"{/width}",height:"{/height}",size:"{/size}",target:b("target"),innerMinThreshold:b("innerMinThreshold"),innerMaxThreshold:b("innerMaxThreshold"),minThreshold:b("minThreshold"),maxThreshold:b("maxThreshold"),chart:b("chart"),minXValue:"{/minXValue}",maxXValue:"{/maxXValue}",minYValue:"{/minYValue}",maxYValue:"{/maxYValue}",firstXLabel:a("firstXLabel"),lastXLabel:a("lastXLabel"),firstYLabel:a("firstYLabel"),lastYLabel:a("lastYLabel"),minLabel:a("minLabel"),maxLabel:a("maxLabel")});this.oNVConfS=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:this.oNVConfContS});this.oGenericTile=new sap.suite.ui.commons.GenericTile({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[this.oNVConfS]});var G=new sap.ui.model.json.JSONModel();G.setData(g);this.oGenericTile.setModel(G);return this.oGenericTile;}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.indicatorDual.DualTile.view')){jQuery.sap.declare('sap.ushell.components.tiles.indicatorDual.DualTile.view');
//Copyright (c) 2013 SAP AG, All Rights Reserved
(function(){"use strict";sap.ui.getCore().loadLibrary("sap.suite.ui.commons");sap.ui.jsview("sap.ushell.components.tiles.indicatorDual.DualTile",{getControllerName:function(){return"sap.ushell.components.tiles.indicatorDual.DualTile";},createContent:function(c){this.setHeight('100%');this.setWidth('100%');var t=this;t.tileData;t.oGenericTileData={};sap.ushell.components.tiles.indicatorTileUtils.util.getParsedChip(t.getViewData().chip.configuration.getParameterValueAsString("tileConfiguration"),t.getViewData().chip.preview.isEnabled(),function(e){t.oConfig=e;});t.tileType=t.oConfig.TILE_PROPERTIES.tileType;t.oNumericContent=new sap.suite.ui.commons.NumericContent({value:"{/value}",scale:"{/scale}",unit:"{/unit}",indicator:"{/indicator}",size:"{/size}",formatterValue:"{/isFormatterValue}",truncateValueTo:5,valueColor:"{/valueColor}",nullifyValue:false});t.oLeftTileContent=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:t.oNumericContent});switch(t.tileType){case"DT-CM":var C=new sap.suite.ui.commons.ComparisonData({title:"{title}",value:"{value}",color:"{color}",displayValue:"{displayValue}"});t.oComparisionContent=new sap.suite.ui.commons.ComparisonChart({size:"{/size}",scale:"{/scale}",data:{template:C,path:"/data"}});t.oRightContent=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:t.oComparisionContent});break;case"DT-CT":var C=new sap.suite.ui.commons.ComparisonData({title:"{title}",value:"{value}",color:"{color}",displayValue:"{displayValue}"});t.oContributionContent=new sap.suite.ui.commons.ComparisonChart({size:"{/size}",scale:"{/scale}",data:{template:C,path:"/data"}});t.oRightContent=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:t.oContributionContent});break;case"DT-TT":var b=function(n){return new sap.suite.ui.commons.MicroAreaChartItem({color:"Good",points:{path:"/"+n+"/data",template:new sap.suite.ui.commons.MicroAreaChartPoint({x:"{day}",y:"{balance}"})}});};var a=function(n){return new sap.suite.ui.commons.MicroAreaChartLabel({label:"{/"+n+"/label}",color:"{/"+n+"/color}"});};var d=new sap.suite.ui.commons.MicroAreaChart({width:"{/width}",height:"{/height}",size:"{/size}",target:b("target"),innerMinThreshold:b("innerMinThreshold"),innerMaxThreshold:b("innerMaxThreshold"),minThreshold:b("minThreshold"),maxThreshold:b("maxThreshold"),chart:b("chart"),minXValue:"{/minXValue}",maxXValue:"{/maxXValue}",minYValue:"{/minYValue}",maxYValue:"{/maxYValue}",firstXLabel:a("firstXLabel"),lastXLabel:a("lastXLabel"),firstYLabel:a("firstYLabel"),lastYLabel:a("lastYLabel"),minLabel:a("minLabel"),maxLabel:a("maxLabel")});t.oRightContent=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",content:d});break;case"DT-AT":var B=new sap.suite.ui.commons.BulletChartData({value:"{value}",color:"{color}"});var o=new sap.suite.ui.commons.BulletChart({size:sap.suite.ui.commons.InfoTileSize.Auto,scale:"{/scale}",actual:{value:"{/actual/value}",color:"{/actual/color}"},targetValue:"{/targetValue}",actualValueLabel:"{/actualValueLabel}",targetValueLabel:"{/targetValueLabel}",thresholds:{template:B,path:"/thresholds"},state:"{/state}",showActualValue:"{/showActualValue}",showTargetValue:"{/showTargetValue}"});t.oRightContent=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:o});break;}t.oGenericTile=new sap.suite.ui.commons.GenericTile({subheader:"{/subheader}",frameType:"TwoByOne",size:"{/size}",header:"{/header}",tileContent:[t.oLeftTileContent,t.oRightContent]});t.oGenericTileModel=new sap.ui.model.json.JSONModel();t.oGenericTileModel.setData(t.oGenericTileData);t.oGenericTile.setModel(t.oGenericTileModel);return t.oGenericTile;}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.indicatorDualComparison.DualComparison.view')){jQuery.sap.declare('sap.ushell.components.tiles.indicatorDualComparison.DualComparison.view');
// Copyright (c) 2009-2014 SAP SE, All Rights Reserved
(function(){"use strict";jQuery.sap.require('sap.ui.model.analytics.odata4analytics');jQuery.sap.require('sap.ca.ui.model.format.NumberFormat');sap.ui.getCore().loadLibrary("sap.suite.ui.commons");sap.ui.jsview("tiles.indicatorDualComparison.DualComparison",{getControllerName:function(){return"tiles.indicatorDualComparison.DualComparison";},createContent:function(c){this.setHeight('100%');this.setWidth('100%');var t=this;t.tileData;t.oGenericTileData={};t.oNumericContent=new sap.suite.ui.commons.NumericContent({value:"{/value}",scale:"{/scale}",unit:"{/unit}",indicator:"{/indicator}",size:"{/size}",formatterValue:true,truncateValueTo:6,valueColor:"{/valueColor}"});t.oNumericTile=new sap.suite.ui.commons.TileContent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:t.oNumericContent});t.oCmprsDataTmpl=new sap.suite.ui.commons.ComparisonData({title:"{title}",value:"{value}",color:"{color}",displayValue:"{displayValue}"});t.oCmprsChrtTmpl=new sap.suite.ui.commons.ComparisonChart({size:"{/size}",scale:"{/scale}",data:{template:t.oCmprsDataTmpl,path:"/data"}});t.oComparisonTile=new sap.suite.ui.commons.TileContent({unit:"{/unit}",size:"{/size}",footer:"{/footerComp}",content:t.oCmprsChrtTmpl});t.oGenericTile=new sap.suite.ui.commons.GenericTile({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[t.oNumericTile,t.oComparisonTile]});t.oGenericTileModel=new sap.ui.model.json.JSONModel();t.oGenericTileModel.setData(t.oGenericTileData);t.oGenericTile.setModel(t.oGenericTileModel);return t.oGenericTile;}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.indicatorDualContribution.DualContribution.view')){jQuery.sap.declare('sap.ushell.components.tiles.indicatorDualContribution.DualContribution.view');(function(){"use strict";jQuery.sap.require('sap.ui.model.analytics.odata4analytics');jQuery.sap.require('sap.ca.ui.model.format.NumberFormat');sap.ui.getCore().loadLibrary("sap.suite.ui.commons");sap.ui.jsview("tiles.indicatorDualContribution.DualContribution",{getControllerName:function(){return"tiles.indicatorDualContribution.DualContribution";},createContent:function(c){this.setHeight('100%');this.setWidth('100%');var t=this;t.tileData;t.oGenericTileData={};t.oNumericContent=new sap.suite.ui.commons.NumericContent({value:"{/value}",scale:"{/scale}",indicator:"{/indicator}",size:"{/size}",formatterValue:true,truncateValueTo:6,valueColor:"{/valueColor}"});t.oNumericTile=new sap.suite.ui.commons.TileContent({unit:"{/unitNumeric}",size:"{/size}",footer:"{/footerNum}",content:t.oNumericContent});t.oCmprsDataTmpl=new sap.suite.ui.commons.ComparisonData({title:"{title}",value:"{value}",color:"{color}",displayValue:"{displayValue}"});t.oCmprsChrtTmpl=new sap.suite.ui.commons.ComparisonChart({size:"{/size}",scale:"{/scale}",data:{template:t.oCmprsDataTmpl,path:"/data"}});t.oComparisonTile=new sap.suite.ui.commons.TileContent({unit:"{/unitContribution}",size:"{/size}",footer:"{/footerComp}",content:t.oCmprsChrtTmpl});t.oGenericTile=new sap.suite.ui.commons.GenericTile({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[t.oNumericTile,t.oComparisonTile]});t.oGenericTileModel=new sap.ui.model.json.JSONModel();t.oGenericTileModel.setData(t.oGenericTileData);t.oGenericTile.setModel(t.oGenericTileModel);return t.oGenericTile;}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.indicatorDualDeviation.DualDeviation.view')){jQuery.sap.declare('sap.ushell.components.tiles.indicatorDualDeviation.DualDeviation.view');(function(){"use strict";jQuery.sap.require('sap.ui.model.analytics.odata4analytics');jQuery.sap.require('sap.ca.ui.model.format.NumberFormat');sap.ui.getCore().loadLibrary("sap.suite.ui.commons");sap.ui.jsview("tiles.indicatorDualDeviation.DualDeviation",{getControllerName:function(){return"tiles.indicatorDualDeviation.DualDeviation";},createContent:function(c){var t=this;this.setHeight('100%');this.setWidth('100%');this.getViewData().chip.preview;var h="Lorem ipsum";var s="Lorem ipsum";var a=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.getViewData().chip);if(a.title&&a.subTitle){h=a.title;s=a.subTitle;}var d={subheader:s,header:h,footerNum:"",footerComp:"",frameType:"TwoByOne",state:sap.suite.ui.commons.LoadState.Loading,scale:""};t.oNumericContent=new sap.suite.ui.commons.NumericContent({value:"{/value}",scale:"{/scale}",unit:"{/unit}",indicator:"{/indicator}",size:"{/size}",formatterValue:true,truncateValueTo:6,valueColor:"{/valueColor}"});t.oNumericTile=new sap.suite.ui.commons.TileContent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:t.oNumericContent});var b=new sap.suite.ui.commons.BulletChartData({value:"{value}",color:"{color}"});t.oBCTmpl=new sap.suite.ui.commons.BulletChart({size:sap.suite.ui.commons.InfoTileSize.Auto,scale:"{/scale}",actual:{value:"{/actual/value}",color:"{/actual/color}"},targetValue:"{/targetValue}",actualValueLabel:"{/actualValueLabel}",targetValueLabel:"{/targetValueLabel}",thresholds:{template:b,path:"/thresholds"},state:"{/state}",showActualValue:"{/showActualValue}",showTargetValue:"{/showTargetValue}"});var n=new sap.suite.ui.commons.TileContent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:t.oBCTmpl});t.oGenericTile=new sap.suite.ui.commons.GenericTile({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[t.oNumericTile,n]});var g=new sap.ui.model.json.JSONModel();g.setData(d);t.oGenericTile.setModel(g);return t.oGenericTile;}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.indicatorDualTrend.DualTrend.view')){jQuery.sap.declare('sap.ushell.components.tiles.indicatorDualTrend.DualTrend.view');(function(){"use strict";jQuery.sap.require('sap.ui.model.analytics.odata4analytics');jQuery.sap.require('sap.ca.ui.model.format.NumberFormat');sap.ui.getCore().loadLibrary("sap.suite.ui.commons");sap.ui.jsview("tiles.indicatorDualTrend.DualTrend",{getControllerName:function(){return"tiles.indicatorDualTrend.DualTrend";},createContent:function(c){this.setHeight('100%');this.setWidth('100%');var b=function(s){return new sap.suite.ui.commons.MicroAreaChartItem({color:"Good",points:{path:"/"+s+"/data",template:new sap.suite.ui.commons.MicroAreaChartPoint({x:"{day}",y:"{balance}"})}});};var a=function(s){return new sap.suite.ui.commons.MicroAreaChartLabel({label:"{/"+s+"/label}",color:"{/"+s+"/color}"});};var g={footer:"",header:"",subheader:""};var n=new sap.suite.ui.commons.MicroAreaChart({width:"{/width}",height:"{/height}",size:"{/size}",target:b("target"),innerMinThreshold:b("innerMinThreshold"),innerMaxThreshold:b("innerMaxThreshold"),minThreshold:b("minThreshold"),maxThreshold:b("maxThreshold"),chart:b("chart"),minXValue:"{/minXValue}",maxXValue:"{/maxXValue}",minYValue:"{/minYValue}",maxYValue:"{/maxYValue}",firstXLabel:a("firstXLabel"),lastXLabel:a("lastXLabel"),firstYLabel:a("firstYLabel"),lastYLabel:a("lastYLabel"),minLabel:a("minLabel"),maxLabel:a("maxLabel")});var N=new sap.suite.ui.commons.TileContent({unit:"{/unit}",size:"{/size}",content:n});var o=new sap.suite.ui.commons.NumericContent({value:"{/value}",scale:"{/scale}",unit:"{/unit}",indicator:"{/indicator}",size:"{/size}",formatterValue:true,truncateValueTo:6,valueColor:"{/valueColor}"});var d=new sap.suite.ui.commons.TileContent({unit:"{/unit}",size:"{/size}",content:o});this.oGenericTile=new sap.suite.ui.commons.GenericTile({subheader:"{/subheader}",frameType:"TwoByOne",size:"{/size}",header:"{/header}",tileContent:[d,N]});var G=new sap.ui.model.json.JSONModel();G.setData(g);this.oGenericTile.setModel(G);return this.oGenericTile;}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.indicatorHarveyBall.HarveyBallTile.view')){jQuery.sap.declare('sap.ushell.components.tiles.indicatorHarveyBall.HarveyBallTile.view');(function(){"use strict";jQuery.sap.require('sap.ui.model.analytics.odata4analytics');jQuery.sap.require('sap.ca.ui.model.format.NumberFormat');sap.ui.getCore().loadLibrary("sap.suite.ui.commons");sap.ui.jsview("tiles.indicatorHarveyBall.HarveyBallTile",{getControllerName:function(){},createContent:function(c){var m=new sap.suite.ui.commons.HarveyBallMicroChart({total:"{/value}",size:"{/size}",totalLabel:"{/totalLabel}",items:[new sap.suite.ui.commons.HarveyBallMicroChartItem({fraction:"{/fractionValue}",fractionLabel:"{/fractionLabel}",color:"{/color}"})]});var t=new sap.suite.ui.commons.TileContent({size:"{/size}",content:m});this.oTile=new sap.suite.ui.commons.GenericTile({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[t]});}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.indicatorcomparison.ComparisonTile.controller')){jQuery.sap.declare('sap.ushell.components.tiles.indicatorcomparison.ComparisonTile.controller');(function(){"use strict";sap.ushell.components.tiles.generic.extend("sap.ushell.components.tiles.indicatorcomparison.ComparisonTile",{onInit:function(){this.KPI_VALUE_REQUIRED=false;},doProcess:function(r,i){var t=this;this.setTextInTile();this.fetchChartData(r,i,function(k){this.CALCULATED_KPI_VALUE=k;this._updateTileModel({data:this.CALCULATED_KPI_VALUE});if(t.oConfig.TILE_PROPERTIES.frameType==sap.suite.ui.commons.FrameType.TwoByOne){t.oKpiTileView.oGenericTile.setFrameType(sap.suite.ui.commons.FrameType.TwoByOne);t.getView().getViewData().parentController._updateTileModel(this.getTile().getModel().getData());var c={};c.data=this.CALCULATED_KPI_VALUE;t.getView().getViewData().deferredObj.resolve();}else{t.oKpiTileView.oGenericTile.setFrameType(sap.suite.ui.commons.FrameType.OneByOne);t.oKpiTileView.oGenericTile.removeAllTileContent();t.oKpiTileView.oGenericTile.addTileContent(t.oKpiTileView.oNVConfS);var n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);t.oKpiTileView.oGenericTile.$().wrap("<a href ='"+n+"'/>");this.oKpiTileView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);}this.setToolTip(null,this.CALCULATED_KPI_VALUE,"COMP");if(this.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(this.oConfig)){sap.ushell.components.tiles.indicatorTileUtils.util.scheduleFetchDataJob.call(this,this.oTileApi.visible.isVisible());}},this.logError);},fetchChartData:function(r,a,s,E){function c(q,u){var w=false;if(q&&q.results&&q.results.length){for(var i=0,l=u.length;i<l&&!w;i++){w=q.results[0][u[i].COLUMN_NAME]!==null;}}return w;}var t=this;try{var b=this.oConfig.EVALUATION.ODATA_ENTITYSET;var m=this.oConfig.EVALUATION.COLUMN_NAME;var d=m;if(this.oConfig.TILE_PROPERTIES.COLUMN_NAMES){for(var j=0;j<this.oConfig.TILE_PROPERTIES.COLUMN_NAMES.length;j++){if(this.oConfig.TILE_PROPERTIES.COLUMN_NAMES[j].COLUMN_NAME!=this.oConfig.EVALUATION.COLUMN_NAME){d=d+","+this.oConfig.TILE_PROPERTIES.COLUMN_NAMES[j].COLUMN_NAME;}}}else{for(var j=0;j<this.oConfig.EVALUATION.COLUMN_NAMES.length;j++){if(this.oConfig.EVALUATION.COLUMN_NAMES[j].COLUMN_NAME!=this.oConfig.EVALUATION.COLUMN_NAME){d=d+","+this.oConfig.EVALUATION.COLUMN_NAMES[j].COLUMN_NAME;}}}var f=sap.ushell.components.tiles.indicatorTileUtils.util.getBoolValue(r);var g=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);var h=t.oTileApi.configuration.getParameterValueAsString("timeStamp");var k=sap.ushell.components.tiles.indicatorTileUtils.util.isCacheValid(t.oConfig.TILE_PROPERTIES.id,h,t.chipCacheTime,t.chipCacheTimeUnit,t.tilePressed);if(!g||(!k&&t.oTileApi.visible.isVisible())||f||(a&&t.oTileApi.visible.isVisible())||t.getView().getViewData().refresh){if(t.kpiValueFetchDeferred){t.kpiValueFetchDeferred=false;var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.oConfig.EVALUATION_FILTERS,this.oConfig.ADDITIONAL_FILTERS);var n=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oRunTimeODataModel,b,d,null,v,3);this.comparisionChartODataRef=n.model.read(n.uri,null,null,true,function(i){t.kpiValueFetchDeferred=true;var w={};if(n.unit){w.unit=n.unit;}if(c(i,t.oConfig.TILE_PROPERTIES.COLUMN_NAMES||t.oConfig.EVALUATION.COLUMN_NAMES)){t.oConfig.TILE_PROPERTIES.FINALVALUE=i;t.oConfig.TILE_PROPERTIES.FINALVALUE=t._processDataForComparisonChart(t.oConfig.TILE_PROPERTIES.FINALVALUE,d.split(",")[0],n.unit);w.data=t.oConfig.TILE_PROPERTIES.FINALVALUE;var l={};t.cacheTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();l.ChipId=t.oConfig.TILE_PROPERTIES.id;l.Data=JSON.stringify(w);l.CacheMaxAge=Number(t.chipCacheTime);l.CacheMaxAgeUnit=t.chipCacheTimeUnit;l.CacheType=1;var q=t.getLocalCache(l);t.updateDatajobScheduled=false;var u=t.oConfig.TILE_PROPERTIES.id+"data";var x=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(u);if(x){clearTimeout(x);x=undefined;}if(!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,q);var U=false;if(g){U=true;}if(t.chipCacheTime){sap.ushell.components.tiles.indicatorTileUtils.util.writeFrontendCacheByChipAndUserId(t.oTileApi,t.oConfig.TILE_PROPERTIES.id,l,U,function(i){if(i){t.cacheTime=i&&i.CachedTime;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,i);t.setTimeStamp();}if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){jQuery.proxy(t.setTimeStamp(t.cacheTime),t);}});}}else{var y=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(y){if(!y.CachedTime){y.CachedTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();}var z=y.Data;if(z){z=JSON.parse(z);z.rightData=w;}y.Data=JSON.stringify(z);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,y);}else{var z={};z.rightData=w;q.Data=JSON.stringify(z);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,q);}t.cacheWriteData=w;}s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else if(i.results.length==0){t.oConfig.TILE_PROPERTIES.FINALVALUE=i;if(sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id)){w=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);w.data=i;}else{w.data=i;}sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,w);s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);t.setNoData();}else{sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,{empty:"empty"});t.setNoData();}},function(i){t.kpiValueFetchDeferred=true;if(i&&i.response){jQuery.sap.log.error(i.message+" : "+i.request.requestUri);E.call(t,i);}});}}else{if(g&&g.Data){var o;var p=t.oConfig&&t.oConfig.TILE_PROPERTIES&&t.oConfig.TILE_PROPERTIES.tileType;if(p.indexOf("DT-")==-1){o=g.Data&&JSON.parse(g.Data);}else{o=g.Data&&JSON.parse(g.Data);o=o.rightData;}t.cacheTime=g.CachedTime;if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){jQuery.proxy(t.setTimeStamp(t.cacheTime),t);}if(o.data&&o.data.length){t.oConfig.TILE_PROPERTIES.FINALVALUE=o.data;s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else{t.oConfig.TILE_PROPERTIES.FINALVALUE=o.data;s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);t.setNoData();}}else{t.setNoData();}}}catch(e){t.kpiValueFetchDeferred=true;E.call(t,e);}},_processDataForComparisonChart:function(d,m,u){var f=[],L={},i,t,l;var a;var T=[];var b=this;var e=null;for(i=0;i<d.results.length;i++){var g=d.results[i];}T=sap.ushell.components.tiles.indicatorTileUtils.util.getAllMeasuresWithLabelText(this.oTileApi.url.addSystemToServiceUrl(this.oConfig.EVALUATION.ODATA_URL),this.oConfig.EVALUATION.ODATA_ENTITYSET);for(i=0,l=T.length;i<l;i++){t=T[i];L[t.key]=t.value;}var h=b.oConfig.TILE_PROPERTIES.COLUMN_NAMES||b.oConfig.EVALUATION.COLUMN_NAMES;for(i=0;i<h.length;i++){var j={};var k=h[i];j.value=Number(g[k.COLUMN_NAME]);var n=Number(g[k.COLUMN_NAME]);var o=false;var s=0;var p=b._getEvaluationThresholdMeasures();var I=jQuery.inArray(k.COLUMN_NAME,p);if(I>-1){o=true;s=b.oConfig.EVALUATION.SCALING;}if(b.oConfig.EVALUATION.SCALING==-2&&o){n*=100;}var c=b.isCurrencyMeasure(k.COLUMN_NAME);if(u&&u[i]&&g[u[i].name]){e=g[u[i].name];}a=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(n,s,b.oConfig.EVALUATION.SCALING,b.oConfig.EVALUATION.DECIMAL_PRECISION,c,e);if(b.oConfig.EVALUATION.SCALING==-2&&o){a+=" %";}j.displayValue=a.toString();if(u){if(u[i]&&g[u[i].name]){j.displayValue+=" "+g[u[i].name];}}j.color=k.semanticColor;j.title=L[k.COLUMN_NAME]||k.COLUMN_NAME;j.measure=k.COLUMN_NAME;j.isCurM=c;f.push(j);}return f;},doDummyProcess:function(){var t=this;this.setTextInTile();t._updateTileModel({value:8888,size:sap.suite.ui.commons.InfoTileSize.Auto,frameType:sap.suite.ui.commons.FrameType.OneByOne,state:sap.suite.ui.commons.LoadState.Loading,valueColor:sap.suite.ui.commons.InfoTileValueColor.Error,indicator:sap.suite.ui.commons.DeviationIndicator.None,title:"Liquidity Structure",footer:"Current Quarter",description:"Apr 1st 2013 (B$)",data:[{title:"Measure 1",value:1.2,color:"Good"},{title:"Measure 2",value:0.78,color:"Good"},{title:"Measure 3",value:1.4,color:"Error"}]});this.oKpiTileView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.indicatorcontribution.ContributionTile.controller')){jQuery.sap.declare('sap.ushell.components.tiles.indicatorcontribution.ContributionTile.controller');(function(){"use strict";sap.ushell.components.tiles.generic.extend("sap.ushell.components.tiles.indicatorcontribution.ContributionTile",{onInit:function(){this.KPI_VALUE_REQUIRED=false;},doProcess:function(r,i){var t=this;this.DEFINITION_DATA=this.oConfig;this._updateTileModel(this.DEFINITION_DATA);this.setTextInTile();this.fetchChartData(r,i,function(k){this.CALCULATED_KPI_VALUE=k;this._updateTileModel({data:this.CALCULATED_KPI_VALUE});if(t.oConfig.TILE_PROPERTIES.frameType==sap.suite.ui.commons.FrameType.TwoByOne){t.oKpiTileView.oGenericTile.setFrameType(sap.suite.ui.commons.FrameType.TwoByOne);t.oKpiTileView.oGenericTile.removeAllTileContent();t.getView().getViewData().parentController._updateTileModel(this.getTile().getModel().getData());t.getView().getViewData().deferredObj.resolve();}else{t.oKpiTileView.oGenericTile.setFrameType(sap.suite.ui.commons.FrameType.OneByOne);t.oKpiTileView.oGenericTile.removeAllTileContent();t.oKpiTileView.oGenericTile.addTileContent(t.oKpiTileView.oNVConfS);var n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);t.oKpiTileView.oGenericTile.$().wrap("<a href ='"+n+"'/>");this.oKpiTileView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);}this.setToolTip(null,this.CALCULATED_KPI_VALUE,"CONT");if(this.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(this.oConfig)){sap.ushell.components.tiles.indicatorTileUtils.util.scheduleFetchDataJob.call(this,this.oTileApi.visible.isVisible());}},this.logError);},fetchChartData:function(r,i,s,E){var t=this;try{var u=this.oConfig.EVALUATION.ODATA_URL;var a=this.oConfig.EVALUATION.ODATA_ENTITYSET;t.setThresholdValues();if(this.oConfig.TILE_PROPERTIES.semanticMeasure){var m=this.oConfig.EVALUATION.COLUMN_NAME+","+this.oConfig.TILE_PROPERTIES.semanticMeasure;}else{var m=this.oConfig.EVALUATION.COLUMN_NAME;}var b=null;var d=this.oConfig.TILE_PROPERTIES.dimension;this.oConfig.EVALUATION_VALUES;var c=sap.ushell.components.tiles.indicatorTileUtils.util.getBoolValue(r);var f=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);var g=t.oTileApi.configuration.getParameterValueAsString("timeStamp");var h=sap.ushell.components.tiles.indicatorTileUtils.util.isCacheValid(t.oConfig.TILE_PROPERTIES.id,g,t.chipCacheTime,t.chipCacheTimeUnit,t.tilePressed);if(!f||(!h&&t.oTileApi.visible.isVisible())||c||(i&&t.oTileApi.visible.isVisible())||t.getView().getViewData().refresh){if(t.kpiValueFetchDeferred){t.kpiValueFetchDeferred=false;var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.oConfig.EVALUATION_FILTERS,this.oConfig.ADDITIONAL_FILTERS);var o={};o["0"]=m+",asc";o["1"]=m+",desc";o["2"]=d+",asc";o["3"]=d+",desc";var j=o[this.oConfig.TILE_PROPERTIES.sortOrder||"0"].split(",");var k=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oRunTimeODataModel,a,m,d,v,3);if(this.oConfig.TILE_PROPERTIES.semanticMeasure){k.uri+="&$top=3&$orderby="+j[0]+" "+j[2];}else{k.uri+="&$top=3&$orderby="+j[0]+" "+j[1];}this.comparisionChartODataRef=k.model.read(k.uri,null,null,true,function(p){t.kpiValueFetchDeferred=true;var w={};if(p&&p.results&&p.results.length){if(k.unit[0]){t._updateTileModel({unit:p.results[0][k.unit[0].name]});b=k.unit[0].name;w.unit=k.unit[0];w.unit.name=k.unit[0].name;}d=sap.ushell.components.tiles.indicatorTileUtils.util.findTextPropertyForDimension(t.oTileApi.url.addSystemToServiceUrl(u),a,d);w.dimension=d;t.oConfig.TILE_PROPERTIES.FINALVALUE=p;t.oConfig.TILE_PROPERTIES.FINALVALUE=t._processDataForComparisonChart(t.oConfig.TILE_PROPERTIES.FINALVALUE,m.split(",")[0],d,b);w.data=t.oConfig.TILE_PROPERTIES.FINALVALUE;w.isCurM=t.isACurrencyMeasure(t.oConfig.EVALUATION.COLUMN_NAME);if(k.unit[0]){if(w&&w.data&&w.data.length){w.data[0][k.unit[0].name]=p.results[0][k.unit[0].name];}}var q={};t.cacheTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();q.ChipId=t.oConfig.TILE_PROPERTIES.id;q.Data=JSON.stringify(w);q.CacheMaxAge=Number(t.chipCacheTime);q.CacheMaxAgeUnit=t.chipCacheTimeUnit;q.CacheType=1;var x=t.getLocalCache(q);t.updateDatajobScheduled=false;var y=t.oConfig.TILE_PROPERTIES.id+"data";var z=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(y);if(z){clearTimeout(z);z=undefined;}if(!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,x);var U=false;if(f){U=true;}if(t.chipCacheTime){sap.ushell.components.tiles.indicatorTileUtils.util.writeFrontendCacheByChipAndUserId(t.oTileApi,t.oConfig.TILE_PROPERTIES.id,q,U,function(p){if(p){t.cacheTime=p&&p.CachedTime;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,p);}if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){jQuery.proxy(t.setTimeStamp(t.cacheTime),t);}});}}else{var A=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(A){if(!A.CachedTime){A.CachedTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();}var B=A.Data;if(B){B=JSON.parse(B);if(t.oKpiTileView.getViewName()=="tiles.indicatornumeric.NumericTile"){B.leftData=w;}else{B.rightData=w;}}A.Data=JSON.stringify(B);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,A);}else{var B={};B.rightData=w;x.Data=JSON.stringify(B);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,x);}t.cacheWriteData=w;}s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else if(p.results.length==0){t.oConfig.TILE_PROPERTIES.FINALVALUE=p;if(sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id)){w=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);w.data=p;}else{w.data=p;}sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,w);s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);t.setNoData();}else{sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,{empty:"empty"});t.setNoData();}},function(p){t.kpiValueFetchDeferred=true;if(p&&p.response){jQuery.sap.log.error(p.message+" : "+p.request.requestUri);E.call(t,p);}});}}else{if(f&&f.Data){var l;var n=t.oConfig&&t.oConfig.TILE_PROPERTIES&&t.oConfig.TILE_PROPERTIES.tileType;if(n.indexOf("DT-")==-1){l=f.Data&&JSON.parse(f.Data);}else{l=f.Data&&JSON.parse(f.Data);l=l.rightData;}t.cacheTime=f.CachedTime;if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){jQuery.proxy(t.setTimeStamp(t.cacheTime),t);}if(l.data&&l.data.length){if(l.unit){t._updateTileModel({unit:l.data[0][l.unit.name]});}d=l.dimension;t.oConfig.TILE_PROPERTIES.FINALVALUE=l.data;s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else if(l&&l.data&&l.data instanceof Array&&l.data.length==0){t.oConfig.TILE_PROPERTIES.FINALVALUE=l.data;s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);t.setNoData();}else{t.setNoData();}}else{t.setNoData();}}}catch(e){t.kpiValueFetchDeferred=true;E.call(t,e);}},_processDataForComparisonChart:function(d,m,a,u){var s=this.oConfig.TILE_PROPERTIES.semanticColorContribution;var f=[];var t;var b;for(var i=0;i<d.results.length;i++){var g=d.results[i];var h={};try{h.title=g[a].toString();}catch(e){h.title="";}h.value=Number(g[m]);var j=Number(g[m]);if(this.oConfig.EVALUATION.SCALING==-2){j*=100;}var c=this.isCurrencyMeasure(m);b=g[u];t=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(j,this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION,c,b);h.displayValue=t.toString();if(typeof s==='undefined'){h.color="Neutral";}else{h.color=s;}if(h&&u){h[u]=b;}f.push(h);}return f;},doDummyProcess:function(){var t=this;t.setTextInTile();t._updateTileModel({value:8888,size:sap.suite.ui.commons.InfoTileSize.Auto,frameType:sap.suite.ui.commons.FrameType.OneByOne,state:sap.suite.ui.commons.LoadState.Loading,valueColor:sap.suite.ui.commons.InfoTileValueColor.Error,indicator:sap.suite.ui.commons.DeviationIndicator.None,title:"US Profit Margin",footer:"Current Quarter",description:"Maximum deviation",data:[{title:"Americas",value:10,color:"Neutral"},{title:"EMEA",value:50,color:"Neutral"},{title:"APAC",value:-20,color:"Neutral"}]});this.oKpiTileView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.indicatordeviation.DeviationTile.controller')){jQuery.sap.declare('sap.ushell.components.tiles.indicatordeviation.DeviationTile.controller');(function(){"use strict";sap.ushell.components.tiles.generic.extend("sap.ushell.components.tiles.indicatordeviation.DeviationTile",{onInit:function(){this.KPI_VALUE_REQUIRED=true;},doProcess:function(k,t){var a=this;var f,b;var d=Number(k);var e=this.setThresholdValues();if(this.oConfig.EVALUATION.SCALING==-2){d*=100;}var c=this.isCurrencyMeasure(this.oConfig.EVALUATION.COLUMN_NAME);b=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(d),this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION,c,this.CURRENCY_CODE);this.CALCULATED_KPI_VALUE=Number(k);var g={};var h=this.getThresholdsObjAndColor(t).returnColor;var i={value:Number(k),color:h};g.actualValueLabel=b.toString();g.actual=i;g.thresholds=[];g.thresholds=this.getThresholdsObjAndColor(e).arrObj;var j=this.DEFINITION_DATA.EVALUATION_VALUES;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){var l=Number(e.targetValue);if(this.oConfig.EVALUATION.SCALING==-2){l*=100;}c=this.isCurrencyMeasure(this.oConfig.EVALUATION.COLUMN_NAME);f=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(l,this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION,c,this.CURRENCY_CODE);g.targetValue=Number(e.targetValue);g.targetValueLabel=f.toString();}else{for(var m=0;m<j.length;m++){if(j[m].TYPE==="TA"){var l=Number(j[m].FIXED);if(this.oConfig.EVALUATION.SCALING==-2){l*=100;}c=this.isCurrencyMeasure(this.oConfig.EVALUATION.COLUMN_NAME);f=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(l,this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION,c,this.CURRENCY_CODE);g.targetValue=Number(j[m].FIXED);g.targetValueLabel=f.toString();}}}if(this.oConfig.EVALUATION.SCALING==-2){g.scale="%";}this._updateTileModel(g);if(this.DEFINITION_DATA.TILE_PROPERTIES.frameType==sap.suite.ui.commons.FrameType.TwoByOne){a.getView().getViewData().parentController._updateTileModel(this.getTile().getModel().getData());a.getView().getViewData().deferredObj.resolve();sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(a.oConfig.TILE_PROPERTIES.id+"defferedRight",false);}else{var n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(a.oConfig,a.system);a.oKpiTileView.oGenericTile.$().wrap("<a href ='"+n+"'/>");this.oKpiTileView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);}this.setToolTip(h,d,"DT");if(!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(this.oConfig)){if(a.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(this.oConfig)){sap.ushell.components.tiles.indicatorTileUtils.util.scheduleFetchDataJob.call(this,this.oTileApi.visible.isVisible());}}},getThresholdsObjAndColor:function(t){try{var T={};T.arrObj=[];T.returnColor=sap.suite.ui.commons.InfoTileValueColor.Neutral;var i=this.DEFINITION_DATA.EVALUATION.GOAL_TYPE;var w,c,a,b;if(i==="MI"){a=Number(t.criticalHighValue)||0;b=Number(t.warningHighValue)||0;if(a&&b){a=window.parseFloat(a);b=window.parseFloat(b);T.arrObj.push({value:a,color:sap.suite.ui.commons.InfoTileValueColor.Error});T.arrObj.push({value:b,color:sap.suite.ui.commons.InfoTileValueColor.Critical});if(this.CALCULATED_KPI_VALUE<b){T.returnColor=sap.suite.ui.commons.InfoTileValueColor.Good;}else if(this.CALCULATED_KPI_VALUE<=a){T.returnColor=sap.suite.ui.commons.InfoTileValueColor.Critical;}else{T.returnColor=sap.suite.ui.commons.InfoTileValueColor.Error;}}}else if(i==="MA"){c=Number(t.criticalLowValue)||0;w=Number(t.warningLowValue)||0;if(c&&w){c=window.parseFloat(c);w=window.parseFloat(w);T.arrObj.push({value:c,color:sap.suite.ui.commons.InfoTileValueColor.Error});T.arrObj.push({value:w,color:sap.suite.ui.commons.InfoTileValueColor.Critical});if(this.CALCULATED_KPI_VALUE<c){T.returnColor=sap.suite.ui.commons.InfoTileValueColor.Error;}else if(this.CALCULATED_KPI_VALUE<=w){T.returnColor=sap.suite.ui.commons.InfoTileValueColor.Critical;}else{T.returnColor=sap.suite.ui.commons.InfoTileValueColor.Good;}}}else{a=Number(t.criticalHighValue)||0;b=Number(t.warningHighValue)||0;c=Number(t.criticalLowValue)||0;w=Number(t.warningLowValue)||0;if(w&&b&&c&&c){a=window.parseFloat(a);b=window.parseFloat(b);w=window.parseFloat(w);c=window.parseFloat(c);T.arrObj.push({value:a,color:sap.suite.ui.commons.InfoTileValueColor.Error});T.arrObj.push({value:b,color:sap.suite.ui.commons.InfoTileValueColor.Critical});T.arrObj.push({value:w,color:sap.suite.ui.commons.InfoTileValueColor.Critical});T.arrObj.push({value:c,color:sap.suite.ui.commons.InfoTileValueColor.Error});if(this.CALCULATED_KPI_VALUE<c||this.CALCULATED_KPI_VALUE>a){T.returnColor=sap.suite.ui.commons.InfoTileValueColor.Error;}else if((this.CALCULATED_KPI_VALUE>=c&&this.CALCULATED_KPI_VALUE<=w)||(this.CALCULATED_KPI_VALUE>=b&&this.CALCULATED_KPI_VALUE<=a)){T.returnColor=sap.suite.ui.commons.InfoTileValueColor.Critical;}else{T.returnColor=sap.suite.ui.commons.InfoTileValueColor.Good;}}}return T;}catch(e){this.logError(e);}},doDummyProcess:function(){var t=this;this.setTextInTile();t._updateTileModel({actual:{value:120,color:sap.suite.ui.commons.InfoTileValueColor.Good},targetValue:100,thresholds:[{value:0,color:sap.suite.ui.commons.InfoTileValueColor.Error},{value:50,color:sap.suite.ui.commons.InfoTileValueColor.Critical},{value:150,color:sap.suite.ui.commons.InfoTileValueColor.Critical},{value:200,color:sap.suite.ui.commons.InfoTileValueColor.Error}],showActualValue:true,showTargetValue:true});this.oKpiTileView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);}});}());};if(!jQuery.sap.isDeclared('sap.ushell.components.tiles.indicatornumeric.NumericTile.controller')){jQuery.sap.declare('sap.ushell.components.tiles.indicatornumeric.NumericTile.controller');(function(){"use strict";sap.ushell.components.tiles.generic.extend("sap.ushell.components.tiles.indicatornumeric.NumericTile",{onInit:function(){this.KPI_VALUE_REQUIRED=true;},doProcess:function(k,t){var a=this;this.CALCULATED_KPI_VALUE=k;this.DEFINITION_DATA.EVALUATION_VALUES;var b=this.getTrendColor(t);var d=this.getTrendIndicator(t.trendValue);var s="";var e=this.CALCULATED_KPI_VALUE;if(this.oConfig.EVALUATION.SCALING==-2){e*=100;this.getView().oNVConfContS.setFormatterValue(false);}var c=this.isCurrencyMeasure(this.oConfig.EVALUATION.COLUMN_NAME);s=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(e),this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION,c,this.CURRENCY_CODE);if(this.oConfig.EVALUATION.SCALING==-2){this._updateTileModel({scale:"%"});}this._updateTileModel({value:s.toString(),valueColor:b,indicator:d});if(a.oConfig.TILE_PROPERTIES.frameType==sap.suite.ui.commons.FrameType.OneByOne){this.oKpiTileView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);this.setToolTip(b,e,"NT");}else{a.getView().getViewData().parentController._updateTileModel(this.getTile().getModel().getData());a.getView().getViewData().deferredObj.resolve();sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(a.oConfig.TILE_PROPERTIES.id+"defferedLeft",false);}this.setToolTip(b,e,"NT");if(!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(this.oConfig)){if(a.chipCacheTime){sap.ushell.components.tiles.indicatorTileUtils.util.scheduleFetchDataJob.call(this,a.oTileApi.visible.isVisible());}}},doDummyProcess:function(){var t=this;this.setTextInTile();if(!(t.oConfig.BLANKTILE||t.oConfig.TILE_PROPERTIES.blankTile)){t._updateTileModel({value:"10.34",scale:"M",valueColor:sap.suite.ui.commons.InfoTileValueColor.Neutral,indicator:sap.suite.ui.commons.DeviationIndicator.None});}else{this.oKpiTileView.oNVConfContS.setIcon('sap-icon://BusinessSuiteInAppSymbols/icon-multiple-charts');}this.oKpiTileView.oGenericTile.setState(sap.suite.ui.commons.LoadState.Loaded);}});}());};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.Renderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.renderers.fiori2.Renderer");jQuery.sap.require('sap.ui.core.UIComponent');sap.ui.core.UIComponent.extend("sap.ushell.renderers.fiori2.Renderer",{metadata:{version:"1.44.6",dependencies:{version:"1.44.6",libs:["sap.ui.core","sap.m"],components:[]}}});sap.ushell.renderers.fiori2.Renderer.prototype.createContent=function(){var p=jQuery.sap.getUriParameters().get("appState")||jQuery.sap.getUriParameters().get("sap-ushell-config"),v=this.getComponentData()||{},P,a={applications:{"Shell-home":{}},rootIntent:"Shell-home"},V;if(p){if(!v.config){v.config={};}v.config.appState=p;}if(v.config){P=["enablePersonalization","enableTagFiltering","enableLockedGroupsCompactLayout","enableCatalogSelection","enableSearchFiltering","enableTilesOpacity","enableDragIndicator","enableActionModeMenuButton","enableActionModeMenuButton","enableActionModeFloatingButton","enableTileActionsIcon","enableHideGroups"];if(v.config.rootIntent===undefined){v.config.migrationConfig=true;}v.config=jQuery.extend(a,v.config);if(v.config.applications["Shell-home"]){P.forEach(function(s){var b=v.config[s];if(b!==undefined){v.config.applications["Shell-home"][s]=b;}if(s!=="enablePersonalization"){delete v.config[s];}});}}if(v.config&&v.config.customViews){Object.keys(v.config.customViews).forEach(function(s){var V=v.config.customViews[s];sap.ui.view(s,{type:V.viewType,viewName:V.viewName,viewData:V.componentData});});}V=sap.ui.view('mainShell',{type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.ushell.renderers.fiori2.Shell",viewData:v});sap.ushell.renderers.fiori2.utils.init(V.getController());this.shellCtrl=V.oController;this.oShellModel=sap.ushell.renderers.fiori2.ShellModel;return V;};sap.ushell.renderers.fiori2.Renderer.prototype.createExtendedShellState=function(s,c){return this.oShellModel.createExtendedShellState(s,c);};sap.ushell.renderers.fiori2.Renderer.prototype.applyExtendedShellState=function(s,c){this.oShellModel.applyExtendedShellState(s,c);};sap.ushell.renderers.fiori2.Renderer.prototype.showLeftPaneContent=function(i,c,s){if(typeof i==="string"){this.oShellModel.addLeftPaneContent([i],c,s);}else{this.oShellModel.addLeftPaneContent(i,c,s);}};sap.ushell.renderers.fiori2.Renderer.prototype.showHeaderItem=function(i,c,s){if(typeof i==="string"){this.oShellModel.addHeaderItem([i],c,s);}else{this.oShellModel.addHeaderItem(i,c,s);}};sap.ushell.renderers.fiori2.Renderer.prototype.showRightFloatingContainerItem=function(i,c,s){if(typeof i==="string"){this.oShellModel.addRightFloatingContainerItem([i],c,s);}else{this.oShellModel.addRightFloatingContainerItem(i,c,s);}};sap.ushell.renderers.fiori2.Renderer.prototype.showRightFloatingContainer=function(s){this.oShellModel.showRightFloatingContainer(s);};sap.ushell.renderers.fiori2.Renderer.prototype.showToolAreaItem=function(i,c,s){this.oShellModel.addToolAreaItem(i,c,s);};sap.ushell.renderers.fiori2.Renderer.prototype.showActionButton=function(i,c,s,I){var b=[],a=[],B;if(typeof i==="string"){i=[i];}b=i.filter(function(d){B=sap.ui.getCore().byId(d);return B instanceof sap.m.Button&&!(B instanceof sap.ushell.ui.launchpad.ActionItem);});a=i.filter(function(d){B=sap.ui.getCore().byId(d);return B instanceof sap.ushell.ui.launchpad.ActionItem;});if(b.length){this.convertButtonsToActions(b,c,s,I);}if(a.length){this.oShellModel.addActionButton(a,c,s,I);}};sap.ushell.renderers.fiori2.Renderer.prototype.showFloatingActionButton=function(i,c,s){if(typeof i==="string"){this.oShellModel.addFloatingActionButton([i],c,s);}else{this.oShellModel.addFloatingActionButton(i,c,s);}};sap.ushell.renderers.fiori2.Renderer.prototype.showHeaderEndItem=function(i,c,s){if(typeof i==="string"){this.oShellModel.addHeaderEndItem([i],c,s);}else{this.oShellModel.addHeaderEndItem(i,c,s);}};sap.ushell.renderers.fiori2.Renderer.prototype.setHeaderVisibility=function(v,c,s){this.oShellModel.setHeaderVisibility(v,c,s);};sap.ushell.renderers.fiori2.Renderer.prototype.showSubHeader=function(i,c,s){if(typeof i==="string"){this.oShellModel.addSubHeader([i],c,s);}else{this.oShellModel.addSubHeader(i,c,s);}};sap.ushell.renderers.fiori2.Renderer.prototype.showSignOutItem=function(c,s){this.oShellModel.showSignOutButton(c,s);};sap.ushell.renderers.fiori2.Renderer.prototype.showSettingsItem=function(c,s){this.oShellModel.showSettingsButton(c,s);};sap.ushell.renderers.fiori2.Renderer.prototype.setFooter=function(f){this.shellCtrl.setFooter(f);};sap.ushell.renderers.fiori2.Renderer.prototype.setFooterControl=function(c,C){var f=function(C){var V;if(c){jQuery.sap.require(c);V=jQuery.sap.getObject(c);}else{jQuery.sap.log.warning("You must specify control type in order to create it");}return new V(C);},i;i=this.createItem(C,undefined,undefined,f);if(this.lastFooterId){this.removeFooter();}this.lastFooterId=i.getId();this.shellCtrl.setFooter(i);return i;};sap.ushell.renderers.fiori2.Renderer.prototype.hideHeaderItem=function(i,c,s){if(typeof i==="string"){this.oShellModel.removeHeaderItem([i],c,s);}else{this.oShellModel.removeHeaderItem(i,c,s);}};sap.ushell.renderers.fiori2.Renderer.prototype.removeToolAreaItem=function(i,c,s){if(typeof i==="string"){this.oShellModel.removeToolAreaItem([i],c,s);}else{this.oShellModel.removeToolAreaItem(i,c,s);}};sap.ushell.renderers.fiori2.Renderer.prototype.removeRightFloatingContainerItem=function(i,c,s){if(typeof i==="string"){this.oShellModel.removeRightFloatingContainerItem([i],c,s);}else{this.oShellModel.removeRightFloatingContainerItem(i,c,s);}};sap.ushell.renderers.fiori2.Renderer.prototype.hideActionButton=function(i,c,s){if(typeof i==="string"){this.oShellModel.removeActionButton([i],c,s);}else{this.oShellModel.removeActionButton(i,c,s);}};sap.ushell.renderers.fiori2.Renderer.prototype.hideLeftPaneContent=function(i,c,s){if(typeof i==="string"){this.oShellModel.removeLeftPaneContent([i],c,s);}else{this.oShellModel.removeLeftPaneContent(i,c,s);}};sap.ushell.renderers.fiori2.Renderer.prototype.hideFloatingActionButton=function(i,c,s){if(typeof i==="string"){this.oShellModel.removeFloatingActionButton([i],c,s);}else{this.oShellModel.removeFloatingActionButton(i,c,s);}};sap.ushell.renderers.fiori2.Renderer.prototype.hideHeaderEndItem=function(i,c,s){if(typeof i==="string"){this.oShellModel.removeHeaderEndItem([i],c,s);}else{this.oShellModel.removeHeaderEndItem(i,c,s);}};sap.ushell.renderers.fiori2.Renderer.prototype.hideSubHeader=function(i,c,s){if(typeof i==="string"){this.oShellModel.removeSubHeader([i],c,s);}else{this.oShellModel.removeSubHeader(i,c,s);}};sap.ushell.renderers.fiori2.Renderer.prototype.removeFooter=function(){this.shellCtrl.removeFooter();if(this.lastFooterId){var f=sap.ui.getCore().byId(this.lastFooterId);if(f){f.destroy();}this.lastFooterId=undefined;}};sap.ushell.renderers.fiori2.Renderer.prototype.getCurrentViewportState=function(){return this.shellCtrl.getCurrentViewportState();};sap.ushell.renderers.fiori2.Renderer.prototype.addSubHeader=function(c,C,i,b,s){var f=function(C){var V;if(c){jQuery.sap.require(c);V=jQuery.sap.getObject(c);}else{jQuery.sap.log.warning("You must specify control type in order to create it");}return new V(C);},I;I=this.createItem(C,b,s,f);if(i){this.showSubHeader(I.getId(),b,s);}return I;};sap.ushell.renderers.fiori2.Renderer.prototype.addActionButton=function(c,C,i,b,s,I){var f=function(C){var V;if(c&&c!=="sap.m.Button"){jQuery.sap.require(c);V=jQuery.sap.getObject(c);}else{V=jQuery.sap.getObject("sap.ushell.ui.launchpad.ActionItem");}return new V(C);},o;o=this.createItem(C,b,s,f);if(i){this.showActionButton(o.getId(),b,s,I);}return o;};sap.ushell.renderers.fiori2.Renderer.prototype.addFloatingActionButton=function(c,C,i,b,s){var f=function(C){var V;if(c){jQuery.sap.require(c);V=jQuery.sap.getObject(c);}else{V=jQuery.sap.getObject(sap.m.Button);}return new V(C);},I;I=this.createItem(C,b,s,f);if(i){this.showFloatingActionButton(I.getId(),b,s);}return I;};sap.ushell.renderers.fiori2.Renderer.prototype.addLeftPaneContent=function(c,C,i,b,s){var f=function(C){var V;if(c){jQuery.sap.require(c);V=jQuery.sap.getObject(c);}else{jQuery.sap.log.warning("You must specify control type in order to create it");}return new V(C);},I;I=this.createItem(C,b,s,f);if(i){this.showLeftPaneContent(I.getId(),b,s);}return I;};sap.ushell.renderers.fiori2.Renderer.prototype.addHeaderItem=function(c,C,i,b,s){if(typeof(arguments[0])==='object'&&typeof(arguments[1])==='boolean'){C=arguments[0];i=arguments[1];b=arguments[2];s=arguments[3];}else{jQuery.sap.log.warning("sap.ushell.renderers.fiori2.Renderer: The parameter 'controlType' of the function 'addHeaderItem' is deprecated. Usage will be ignored!");}var p=C;p.showSeparator=false;var f=function(C){return new sap.ushell.ui.shell.ShellHeadItem(C);},I=this.createItem(p,b,s,f);if(i){this.showHeaderItem(I.getId(),b,s);}return I;};sap.ushell.renderers.fiori2.Renderer.prototype.addRightFloatingContainerItem=function(c,i,C,s){var f=function(c){return new sap.m.NotificationListItem(c);},I=this.createItem(c,C,s,f);if(i){this.showRightFloatingContainerItem(I.getId(),C,s);}return I;};sap.ushell.renderers.fiori2.Renderer.prototype.addToolAreaItem=function(c,i,C,s){var f=function(c){return new sap.ushell.ui.shell.ToolAreaItem(c);},I=this.createItem(c,C,s,f);if(i){this.showToolAreaItem(I.getId(),C,s);}return I;};sap.ushell.renderers.fiori2.Renderer.prototype.addHeaderEndItem=function(c,C,i,b,s){var p=C;p.showSeparator=false;var f=function(C){return new sap.ushell.ui.shell.ShellHeadItem(C);},I=this.createItem(p,b,s,f);if(i){this.showHeaderEndItem(I.getId(),b,s);}return I;};sap.ushell.renderers.fiori2.Renderer.prototype.getModelConfiguration=function(){return this.shellCtrl.getModelConfiguration();};sap.ushell.renderers.fiori2.Renderer.prototype.addEndUserFeedbackCustomUI=function(c,s){this.shellCtrl.addEndUserFeedbackCustomUI(c,s);};sap.ushell.renderers.fiori2.Renderer.prototype.addUserPreferencesEntry=function(e){return this.shellCtrl.addUserPreferencesEntry(e);};sap.ushell.renderers.fiori2.Renderer.prototype.setHeaderTitle=function(t,c,C){var i=null,l=sap.ushell.renderers.fiori2.Renderer.prototype.LaunchpadState;if(c){var f=function(C){var o;jQuery.sap.require(c);o=jQuery.sap.getObject(c);return new o(C);};i=this.createItem(C,false,[l.Home,l.App],f);}this.shellCtrl.setHeaderTitle(t,i);};sap.ushell.renderers.fiori2.Renderer.prototype.setLeftPaneVisibility=function(l,v){this.oShellModel.showShellItem("/showPane",l,v);};sap.ushell.renderers.fiori2.Renderer.prototype.showToolArea=function(l,v){this.oShellModel.showShellItem("/toolAreaVisible",l,v);};sap.ushell.renderers.fiori2.Renderer.prototype.setHeaderHiding=function(h){return this.oShellModel.setHeaderHiding(h);};sap.ushell.renderers.fiori2.Renderer.prototype.setFloatingContainerContent=function(c,C,s){this.shellCtrl.setFloatingContainerContent("floatingContainerContent",[c.getId()],C,s);};sap.ushell.renderers.fiori2.Renderer.prototype.setFloatingContainerVisibility=function(v){this.shellCtrl.setFloatingContainerVisibility(v);};sap.ushell.renderers.fiori2.Renderer.prototype.getFloatingContainerVisiblity=function(){return this.shellCtrl.getFloatingContainerVisibility();};sap.ushell.renderers.fiori2.Renderer.prototype.getRightFloatingContainerVisibility=function(){return this.shellCtrl.getRightFloatingContainerVisibility();};sap.ushell.renderers.fiori2.Renderer.prototype.setFloatingContainerDragSelector=function(e){this.shellCtrl.setFloatingContainerDragSelector(e);};sap.ushell.renderers.fiori2.Renderer.prototype.makeEndUserFeedbackAnonymousByDefault=function(e){this.shellCtrl.makeEndUserFeedbackAnonymousByDefault(e);};sap.ushell.renderers.fiori2.Renderer.prototype.showEndUserFeedbackLegalAgreement=function(s){this.shellCtrl.showEndUserFeedbackLegalAgreement(s);};sap.ushell.renderers.fiori2.Renderer.prototype.LaunchpadState={App:"app",Home:"home"};sap.ushell.renderers.fiori2.Renderer.prototype.createInspection=function(a,c,C,s){this.oShellModel.createInspection(a,c,C,s);};sap.ushell.renderers.fiori2.Renderer.prototype.createTriggers=function(t,c,s){this.oShellModel.createTriggers(t,c,s);};sap.ushell.renderers.fiori2.Renderer.prototype.convertButtonsToActions=function(i,c,s,I){var p={},b,t=this;i.forEach(function(a){b=sap.ui.getCore().byId(a);p.id=b.getId();p.text=b.getText();p.icon=b.getIcon();p.tooltip=b.getTooltip();if(b.mEventRegistry&&b.mEventRegistry.press){p.press=b.mEventRegistry.press[0].fFunction;}b.destroy();t.addActionButton("sap.ushell.ui.launchpad.ActionItem",p,true,c,s,I);});};sap.ushell.renderers.fiori2.Renderer.prototype.createItem=function(c,C,s,f){var i;if(c.id){i=sap.ui.getCore().byId(c.id);}if(!i){i=f(c);if(C){this.oShellModel.addElementToManagedQueue(i);}}return i;};sap.ushell.renderers.fiori2.Renderer.prototype.addEntryInShellStates=function(n,e,a,r,s){this.oShellModel.addEntryInShellStates(n,e,a,r,s);};sap.ushell.renderers.fiori2.Renderer.prototype.removeCustomItems=function(s,i,c,S){if(typeof i==="string"){this.oShellModel.removeCustomItems(s,[i],c,S);}else{this.oShellModel.removeCustomItems(s,i,c,S);}};sap.ushell.renderers.fiori2.Renderer.prototype.addCustomItems=function(s,i,c,S){if(typeof i==="string"){this.oShellModel.addCustomItems(s,[i],c,S);}else{this.oShellModel.addCustomItems(s,i,c,S);}};}());};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.compactCozy_selector.CompactCozySelector.view')){jQuery.sap.declare('sap.ushell.renderers.fiori2.compactCozy_selector.CompactCozySelector.view');(function(){"use strict";sap.ui.jsview("sap.ushell.renderers.fiori2.compactCozy_selector.CompactCozySelector",{createContent:function(c){var C=this._getCompactCozyListItemTemplate();this.translationBundle=sap.ushell.resources.i18n;this.oList=new sap.m.List('compactCozySelectorList',{includeItemInSelection:true,mode:"SingleSelectLeft",items:{path:"/options",template:C}});this.info=new sap.m.Text({text:this.translationBundle.getText("displayDensityInfo")}).addStyleClass("sapUiSmallMargin");return[this.oList,this.info];},getControllerName:function(){return"sap.ushell.renderers.fiori2.compactCozy_selector.CompactCozySelector";},_getCompactCozyListItemTemplate:function(){var t=this;var o=function(e){var i=e.srcControl;t.oController.setCurrentContentDensity(i.getBindingContext().getProperty("id"));};var i=new sap.m.StandardListItem({title:"{name}",selected:"{isSelected}"});i.addEventDelegate({onclick:o});return i;}});}());};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.defaultParameters_selector.DefaultParameters.view')){jQuery.sap.declare('sap.ushell.renderers.fiori2.defaultParameters_selector.DefaultParameters.view');(function(){"use strict";sap.ui.jsview("sap.ushell.renderers.fiori2.defaultParameters_selector.DefaultParameters",{createContent:function(c){},getControllerName:function(){return"sap.ushell.renderers.fiori2.defaultParameters_selector.DefaultParameters";}});}());};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.notifications.Notifications.controller')){jQuery.sap.declare('sap.ushell.renderers.fiori2.notifications.Notifications.controller');(function(){"use strict";sap.ui.controller("sap.ushell.renderers.fiori2.notifications.Notifications",{oPagingConfiguration:{MAX_NOTIFICATION_ITEMS_DESKTOP:400,MAX_NOTIFICATION_ITEMS_MOBILE:100,MIN_NOTIFICATION_ITEMS_PER_BUFFER:15,NOTIFICATION_ITEM_HEIGHT:(sap.ui.Device.system.phone||sap.ui.Device.system.tablet)?130:100,TAB_BAR_HEIGHT:100},onInit:function(){var i={};this.iMaxNotificationItemsForDevice=sap.ui.Device.system.desktop?this.oPagingConfiguration.MAX_NOTIFICATION_ITEMS_DESKTOP:this.oPagingConfiguration.MAX_NOTIFICATION_ITEMS_MOBILE;this.oNotificationsService=sap.ushell.Container.getService("Notifications");this.oSortingType=this.oNotificationsService.getOperationEnum();i[this.oSortingType.NOTIFICATIONS_BY_DATE_DESCENDING]=this.getInitialSortingModelStructure();i[this.oSortingType.NOTIFICATIONS_BY_DATE_ASCENDING]=this.getInitialSortingModelStructure();i[this.oSortingType.NOTIFICATIONS_BY_PRIORITY_DESCENDING]=this.getInitialSortingModelStructure();i[this.oSortingType.NOTIFICATIONS_BY_TYPE_DESCENDING]=this.getInitialSortingModelStructure();this.sCurrentSorting=this.oSortingType.NOTIFICATIONS_BY_DATE_DESCENDING;this.sCurrentTypeExpanded=undefined;this.getView().setModel(new sap.ui.model.json.JSONModel(i));this.getNextBuffer();this._oTopNotificationData=undefined;},shouldFetchMoreNotifications:function(){var h=this.getView().getModel().getProperty("/"+this.sCurrentSorting+"/hasMoreItemsInBackend"),l=this.getView().getModel().getProperty("/"+this.sCurrentSorting+"/listMaxReached");return h&&!l;},getNextBuffer:function(){var c=this.getItemsFromModel(this.sCurrentSorting),n,p,N;if(!this.shouldFetchMoreNotifications()){return;}N=this.getNumberOfItemsToFetchOnScroll();if(N===0){this.getView().getModel().setProperty("/"+this.sCurrentSorting+"/hasMoreItems",false);return;}if(c!==undefined){n=c.length;}if(n===0){this.addBusyIndicatorToTabFilter(true);}this.getView().getModel().setProperty("/"+this.sCurrentSorting+"/inUpdate",true);p=this.oNotificationsService.getNotificationsBufferBySortingType(this.sCurrentSorting,n,N);p.done(function(r){this.addBufferToModel(r);}.bind(this));p.fail(function(r){if((n)===0){this.handleError();}}.bind(this));},getNextBufferForType:function(){var s=this.sCurrentTypeExpanded,S=this.oSortingType.NOTIFICATIONS_BY_TYPE_DESCENDING,g=this.getGroupFromModel(s),c=g?g.aNotifications:undefined,n=0,p,h=g.hasMoreItems;if(!h){return;}if(c!==undefined){n=c.length;}this.getView().getModel().setProperty("/"+S+"/inUpdate",true);p=this.oNotificationsService.getNotificationsBufferInGroup(s,n,this.getBufferSize());p.done(function(r){this.addTypeBufferToModel(s,r);}.bind(this));p.fail(function(r){this.getNextBufferFailHandler(S);}.bind(this));},getTypesHeaders:function(){var c=this.getItemsFromModel(this.oSortingType.NOTIFICATIONS_BY_TYPE_DESCENDING),n,p,h=this.getView().getModel().getProperty("/"+this.oSortingType.NOTIFICATIONS_BY_TYPE_DESCENDING+"/hasMoreItems");if(!h){return;}if(c!==undefined){n=c.length;}if(n===0){this.addBusyIndicatorToTabFilter(true);}this.getView().getModel().setProperty("/"+this.oSortingType.NOTIFICATIONS_BY_TYPE_DESCENDING+"/inUpdate",true);p=this.oNotificationsService.getNotificationsGroupHeaders();p.done(function(r){this.addTypeHeadersToModel(r);}.bind(this));p.fail(function(r){}.bind(this));},addTypeHeadersToModel:function(r){var c=this.getItemsFromModel(this.oSortingType.NOTIFICATIONS_BY_TYPE_DESCENDING),C=c.length,R;this._oTopNotificationData=undefined;if(!r){return;}R=JSON.parse(r).value;R.forEach(function(i,a){i["hasMoreItems"]=true;i["aNotifications"]=[{"Id":"temp"}];});this.getView().getModel().setProperty("/"+this.oSortingType.NOTIFICATIONS_BY_TYPE_DESCENDING+"/aGroupHeaders",R);this.getView().getModel().setProperty("/"+this.oSortingType.NOTIFICATIONS_BY_TYPE_DESCENDING+"/inUpdate",false);if(C===0){this.removeBusyIndicatorToTabFilter(false);}},addBufferToModel:function(r){var c=this.getItemsFromModel(this.sCurrentSorting),C=c.length,m,h=r.length>=this.getNumberOfItemsToFetchOnScroll();this._oTopNotificationData=undefined;if(!r){this.getView().getModel().setProperty("/"+this.sCurrentSorting+"/hasMoreItemsInBackend",false);return;}this.getView().getModel().setProperty("/"+this.sCurrentSorting+"/hasMoreItemsInBackend",h);m=c.concat(r);this.getView().getModel().setProperty("/"+this.sCurrentSorting+"/aNotifications",m);this.getView().getModel().setProperty("/"+this.sCurrentSorting+"/inUpdate",false);if(m.length>=this.iMaxNotificationItemsForDevice){this.handleMaxReached();}if(C===0){this.removeBusyIndicatorToTabFilter(true);}},addTypeBufferToModel:function(t,r){var g=this.getGroupFromModel(t),G=this.getGroupIndexFromModel(t),a=this.getView().getModel().getProperty("/"+this.oSortingType.NOTIFICATIONS_BY_TYPE_DESCENDING+"/aGroupHeaders/"),m;this._oTopNotificationData=undefined;if(!r){return;}if(r.length<this.getBufferSize()){g["hasMoreItems"]=false;}m=g.aNotifications.concat(r);a[G].aNotifications=m;this.getView().getModel().setProperty("/"+this.oSortingType.NOTIFICATIONS_BY_TYPE_DESCENDING+"/aGroupHeaders/",a);this.getView().getModel().setProperty("/"+this.oSortingType.NOTIFICATIONS_BY_TYPE_DESCENDING+"/inUpdate",false);},keydownHandler:function(k,f){var j,n,c;switch(k.keyCode){case jQuery.sap.KeyCodes.DELETE:j=jQuery(document.activeElement);if(j.hasClass('sapUshellNotificationsListItem')){n=j.next();c=j.find(".sapMNLB-CloseButton")[0];sap.ui.getCore().byId(c.id).firePress();if(n){n.focus();}}break;}},notificationsUpdateCallback:function(d){var t=this,c,n,N;if(this.sCurrentSorting===this.oSortingType.NOTIFICATIONS_BY_TYPE_DESCENDING){this.oldNotificationsUpdateCallbackForType();d.resolve();return;}c=this.getItemsFromModel(this.sCurrentSorting);if(c!==undefined){n=c.length;}this.cleanModel();N=this.getNumberOfItemsToFetchOnUpdate(n);this.oNotificationsService.getNotificationsBufferBySortingType(this.sCurrentSorting,0,N).done(function(a){if(!a){return;}d.resolve();t.replaceItemsInModel(a,N);}).fail(function(a){jQuery.sap.log.error("Notifications control - call to notificationsService.getNotificationsBufferBySortingType failed: ",a,"sap.ushell.renderers.fiori2.notifications.Notifications");});},getSelectedList:function(){var s;if(this.sCurrentSorting===this.oSortingType.NOTIFICATIONS_BY_PRIORITY_DESCENDING){s=this.getView().oNotificationsListPriority;}else{s=this.getView().oNotificationsListDate;}return s;},isMoreCircleExist:function(){var s=this.getSelectedList(),i=s.getItems().length,l=s.getItems()[i-1];return!!i&&l.getMetadata().getName()==="sap.m.CustomListItem";},handleMaxReached:function(){var s=this.getSelectedList(),n=Math.floor(this.oNotificationsService.getNotificationsCount()),m=n-this.iMaxNotificationItemsForDevice,i=this.isMoreCircleExist();this.getView().getModel().setProperty("/"+this.sCurrentSorting+"/moreNotificationCount",m);this.getView().getModel().setProperty("/"+this.sCurrentSorting+"/listMaxReached",m>=0);if(m>0&&!i){s.addItem(this.getView().getMoreCircle(this.sCurrentSorting));}else if(m<=0&&i){s.removeItem(this.getView().oMoreListItem);}},reAddFailedGroup:function(g){var m=this.getView().getModel(),G=m.getProperty('/aNotificationsByType');G.splice(g.removedGroupIndex,0,g.oGroup);m.setProperty('/aNotificationsByType',G);},removeGroupFromModel:function(g){var m=this.getView().getModel(),G=m.getProperty('/aNotificationsByType'),r={oGroup:g,removedGroupIndex:undefined};G.some(function(o,i){if(o.Id===g.Id){r.removedGroupIndex=i;G.splice(i,1);m.setProperty('/aNotificationsByType',G);return true;}return false;});return r;},getNotificationsByTypeWithGroupHeaders:function(){var p=this.oNotificationsService.getNotificationsByTypeWithGroupHeaders(),t=this;p.fail(function(d){jQuery.sap.log.error("Notifications control - call to notificationsService.getNotificationsByTypeWithGroupHeaders failed: ",d,"sap.ushell.renderers.fiori2.notifications.Notifications");t.replaceBusyIndicatorWithNotificationsList();});p.done(function(n){var j=JSON.parse(n),a=j.value,r=[],l=-1;a.forEach(function(i,b){if(i.IsGroupHeader){r.push(i);l=l+1;}else{if(r[l]){if(!r[l].notifications){r[l].notifications=[];}r[l].notifications.push(i);}}});t.getView().getModel().setProperty('/aNotificationsByType',r);t.replaceBusyIndicatorWithNotificationsList();});},markRead:function(n){var p=this.oNotificationsService.markRead(n),t=this;p.fail(function(){sap.ushell.Container.getService('Message').error(sap.ushell.resources.i18n.getText('notificationsFailedMarkRead'));t.setMarkReadOnModel(n,false);});this.setMarkReadOnModel(n,true);},onExit:function(){this.getView().oBusyIndicator.destroy();},onBeforeRendering:function(){this.oNotificationsService.registerDependencyNotificationsUpdateCallback(this.notificationsUpdateCallback.bind(this),false);},executeAction:function(n,a){return this.oNotificationsService.executeAction(n,a);},executeBulkAction:function(n,a,A,g,N,p){var t=g,P=this.oNotificationsService.executeBulkAction(n,a),m,G=A,s=this.getView().getModel().getProperty(p+"/NotificationTypeDesc"),b=this;if(s===""){s=this.getView().getModel().getProperty(p+"/NotificationTypeKey");}P.fail(function(r){this.getView().getModel().setProperty(N+"/Busy",false);t.notifications.forEach(function(i,c){this.getView().getModel().setProperty(p+"/Busy",false);}.bind(this));if(r&&r.succededNotifications&&r.succededNotifications.length){r.succededNotifications.forEach(function(c,i){this.removeNotificationFromModel(c);}.bind(this));b.cleanModel();}if(r.succededNotifications.length===1){m=sap.ushell.resources.i18n.getText("notificationsPartialSuccessExecuteBulkAction",[G,r.succededNotifications.length,r.failedNotifications.length+r.succededNotifications.length,s,r.failedNotifications.length]);sap.m.MessageToast.show(m,{duration:4000});}else if(r.succededNotifications.length>1){m=sap.ushell.resources.i18n.getText("notificationsSingleSuccessExecuteBulkAction",[G,r.succededNotifications.length,r.failedNotifications.length+r.succededNotifications.length,s,r.failedNotifications.length]);sap.m.MessageToast.show(m,{duration:4000});}else{m=sap.ushell.resources.i18n.getText("notificationsFailedExecuteBulkAction");sap.ushell.Container.getService('Message').error(m);}}.bind(this));P.done(function(){m=sap.ushell.resources.i18n.getText("notificationsSuccessExecuteBulkAction",[G,s]);sap.m.MessageToast.show(m,{duration:4000});this.removeGroupFromModel(t);this.cleanModel();}.bind(this));},dismissNotification:function(n){var t=this,r=this.removeNotificationFromModel(n),p=this.oNotificationsService.dismissNotification(n);this.cleanModel();p.fail(function(){sap.ushell.Container.getService('Message').error(sap.ushell.resources.i18n.getText('notificationsFailedDismiss'));t.addNotificationToModel(r.obj,r.index);});},dismissBulkNotifications:function(n,g){var r=this.removeGroupFromModel(g),p=this.oNotificationsService.dismissBulkNotifications(n),R=r.oGroup.notifications;this.cleanModel();p.fail(function(o){sap.ushell.Container.getService('Message').error(sap.ushell.resources.i18n.getText('notificationsFailedExecuteBulkAction'));if(o.failedNotifications&&o.failedNotifications.length>0){var N=R.filter(function(a,i,A){return o.failedNotifications.indexOf(a.Id)>-1;});r.oGroup.notifications=N;this.reAddFailedGroup(r);}}.bind(this));},onListItemPress:function(n,s,a,p){var v=sap.ui.getCore().byId('viewPortContainer');if(hasher.getHash()===s+"-"+a){v.switchState("Center");}else{sap.ushell.utils.toExternalWithParameters(s,a,p);}this.markRead(n);},scrollToItem:function(t){var j=this._getJqNotificationObjects(),a=j[0],b=j[1],c=j[2],d=j[3],i,n,e,f,g;if(a.length>0&&b.length>0&&c.length>0&&d.length>0){i=d.outerHeight(true)-window.parseInt(d.css("margin-top").replace("px",""));n=this.getIndexInModelByItemId(t.topItemId);n=n?n:0;e=n*i+window.parseInt(d.css("margin-top").replace("px",""));f=window.parseInt(b.css("padding-top").replace("px",""))+window.parseInt(c.css("padding-top").replace("px",""));g=a.offset().top;a.scrollTop(e+f+g-t.offSetTop);}this._oTopNotificationData=undefined;},_getJqNotificationObjects:function(){var j=jQuery("#notificationIconTabBar-containerContent"),a=j.children(),b=a.children(),c=j.find("li").first();return[j,a,b,c];},getTopOffSet:function(){var t=0,j=this._getJqNotificationObjects()[0];if(j.children().length>0&&j.children().children().length>0){t+=j.children().outerHeight()-j.children().height();t+=j.children().children().outerHeight()-j.children().children().height();}return t;},getTopItemOnTheScreen:function(){var j=this._getJqNotificationObjects()[0],t=0,i,a=0,b=this;t=this.getTopOffSet();j.find("li").each(function(){a=jQuery(this).offset().top;if(a>=t){i=b.getItemNotificationId(this);return false;}});return{topItemId:i,offSetTop:a};},handleError:function(){this.removeBusyIndicatorToTabFilter(true);try{sap.ushell.Container.getService("Message").error(sap.ushell.resources.i18n.getText("errorOccurredMsg"));}catch(e){jQuery.sap.log.error("Getting Message service failed.");}},addBusyIndicatorToTabFilter:function(i){var t=this.getSelectedTabFilter(),I=this.getView().oIconTabBar;if(i){I.addStyleClass('sapUshellNotificationIconTabByTypeWithBusyIndicator');t.removeAllContent();t.addContent(this.getView().oBusyIndicator);}},removeBusyIndicatorToTabFilter:function(i){var t=this.getSelectedTabFilter(),s;if(t&&i){if(this.sCurrentSorting===this.oSortingType.NOTIFICATIONS_BY_PRIORITY_DESCENDING){s=this.getView().oNotificationsListPriority;}else{s=this.getView().oNotificationsListDate;}t.removeContent(this.getView().oBusyIndicator);t.addContent(s);}},replaceBusyIndicatorWithNotificationsList:function(){var v=this.getView(),t=v.oIconTabBar.getItems()[1];if(t.getContent()[0]===v.oBusyIndicator){t.removeContent(v.oBusyIndicator);t.addContent(v.oNotificationsListType);}},addNotificationToModel:function(n,i){var m=this.getView().getModel(),a=m.getProperty("/"+this.sCurrentSorting+"/aNotifications"),t=this.getView().oIconTabBar.getSelectedKey();a.splice(i,0,n);m.setProperty("/"+this.sCurrentSorting+"/aNotifications",a);if(t==="sapUshellNotificationIconTabByType"){this.getNotificationsByTypeWithGroupHeaders();}},removeNotificationFromModel:function(n){var m=this.getView().getModel(),t=this.getView().oIconTabBar.getSelectedKey(),i,g,a,N,r={};if(t==="sapUshellNotificationIconTabByDate"||t==="sapUshellNotificationIconTabByPrio"){N="/"+this.sCurrentSorting+"/aNotifications";a=m.getProperty(N);a.some(function(b,i,c){if(b.Id&&b.Id===n){r.obj=c.splice(i,1)[0];r.index=i;return true;}});m.setProperty(N,a);return r;}g=m.getProperty("/aNotificationsByType");for(i=0;i<g.length;i++){a=g[i].notifications;if(a.length===1&&a[0].Id===n){g.splice(i,1);}else{a.some(function(b,i,c){if(b.Id&&b.Id===n){r.obj=c.splice(i,1)[0];r.index=i;return true;}});g[i].notifications=a;}}m.setProperty("/aNotificationsByType",g);return r;},getIndexInModelByItemId:function(n){var N=this.getView().getModel().getProperty("/"+this.sCurrentSorting+"/aNotifications"),i;if(N===undefined||N.length===0){return 0;}for(i=0;i<N.length;i++){if(N[i].Id===n){return i;}}},cleanModel:function(){var t=this,s=this.getView().getModel().getProperty("/");if(this.sCurrentSorting===this.oSortingType.NOTIFICATIONS_BY_DATE_DESCENDING||this.sCurrentSorting===this.oSortingType.NOTIFICATIONS_BY_DATE_ASCENDING){this.getView().oIconTabBar.getItems()[1].removeAllContent();this.getView().oIconTabBar.getItems()[2].removeAllContent();}else if(this.sCurrentSorting===this.oSortingType.NOTIFICATIONS_BY_PRIORITY_DESCENDING){this.getView().oIconTabBar.getItems()[0].removeAllContent();this.getView().oIconTabBar.getItems()[1].removeAllContent();}else{this.getView().oIconTabBar.getItems()[2].removeAllContent();this.getView().oIconTabBar.getItems()[0].removeAllContent();}jQuery.each(s,function(i,a){if(i!==t.sCurrentSorting&&i!=="aNotificationsByType"){s[i]=t.getInitialSortingModelStructure();}});this.getView().getModel().setProperty("/",s);},replaceItemsInModel:function(r,n){var c=this.getItemsFromModel(this.sCurrentSorting),C=c.length,h=r.length>=n;if(C){this._oTopNotificationData=this.getTopItemOnTheScreen();}this.getView().getModel().setProperty("/"+this.sCurrentSorting+"/hasMoreItemsInBackend",h);this.getView().getModel().setProperty("/"+this.sCurrentSorting+"/aNotifications",r);this.getView().getModel().setProperty("/"+this.sCurrentSorting+"/inUpdate",false);this.handleMaxReached();},setMarkReadOnModel:function(n,i){var m=this.getView().getModel(),a=m.getProperty("/"+this.sCurrentSorting+"/aNotifications");a.some(function(b,c,d){if(b.Id&&b.Id===n){b.IsRead=i;return true;}});m.setProperty("/"+this.sCurrentSorting+"/aNotifications",a);},getNumberOfItemsInScreen:function(){var i,h=this.getWindowSize();i=(h-this.oPagingConfiguration.TAB_BAR_HEIGHT)/this.oPagingConfiguration.NOTIFICATION_ITEM_HEIGHT;return Math.ceil(i);},getBasicBufferSize:function(){return Math.max(this.getNumberOfItemsInScreen()*3,this.oPagingConfiguration.MIN_NOTIFICATION_ITEMS_PER_BUFFER);},getWindowSize:function(){return jQuery(window).height();},getNumberOfItemsToFetchOnScroll:function(){var c=this.getItemsFromModel(this.sCurrentSorting).length,b=this.getBasicBufferSize();if(c>=this.iMaxNotificationItemsForDevice){return 0;}if(c+b>this.iMaxNotificationItemsForDevice){return this.iMaxNotificationItemsForDevice-c;}return b;},getNumberOfItemsToFetchOnUpdate:function(n){var b=this.getBasicBufferSize(),N=Math.ceil(n/b),r;r=N>0?N*b:b;return r>this.iMaxNotificationItemsForDevice?this.iMaxNotificationItemsForDevice:r;},getItemsFromModel:function(s){if(s===undefined){s=this.sCurrentSorting;}return this.getView().getModel().getProperty("/"+s+"/aNotifications");},getItemsOfTypeFromModel:function(t){var g=this.getGroupFromModel(t);if(g){return g.aNotifications?g.aNotifications:[];}return[];},getGroupFromModel:function(t){var g=this.getView().getModel().getProperty("/"+this.oSortingType.NOTIFICATIONS_BY_TYPE_DESCENDING+"/aGroupHeaders/"),G;g.forEach(function(a,i){if(a.Id===t){G=a;return true;}});return G;},getGroupIndexFromModel:function(t){var g=this.getView().getModel().getProperty("/"+this.oSortingType.NOTIFICATIONS_BY_TYPE_DESCENDING+"/aGroupHeaders/"),i;g.forEach(function(a,b){if(a.Id===t){i=b;return true;}});return i;},getItemNotificationId:function(e){var i,I;i=sap.ui.getCore().byId(e.getAttribute("Id")).getBindingContext().sPath;I=this.getView().getModel().getProperty(i+"/Id");return I;},getInitialSortingModelStructure:function(){return{hasMoreItemsInBackend:true,listMaxReached:false,aNotifications:[],inUpdate:false,moreNotificationCount:""};},getSelectedTabFilter:function(){var t;if(this.sCurrentSorting===this.oSortingType.NOTIFICATIONS_BY_DATE_DESCENDING||this.sCurrentSorting===this.oSortingType.NOTIFICATIONS_BY_DATE_ASCENDING){t=this.getView().oIconTabBar.getItems()[0];}else if(this.sCurrentSorting===this.oSortingType.NOTIFICATIONS_BY_PRIORITY_DESCENDING){t=this.getView().oIconTabBar.getItems()[2];}else{t=this.getView().oIconTabBar.getItems()[1];}return t;},triggerRetrieveMoreDataForGroupNotifications:function(){if(!this.getModel().getProperty("/"+this.oSortingType.NOTIFICATIONS_BY_TYPE_DESCENDING+"/inUpdate")){var n=this.getItemsOfTypeFromModel(this.sCurrentTypeExpanded),a=n?n.length:0,b=a?this.getBufferSize():0,c=b*3/5,i=Math.floor(a-c),l=this.getView().oNotificationsListDate.getItems()[i],t=this.getTopOffSet();if(jQuery(l.getDomRef()).offset().top<=t){this.getNextBufferForType();}}},collapseOtherGroups:function(g){var l=this.getView().oNotificationsListType.getItems();l.forEach(function(i,a){if(i.getId()===g&&i.getCollapsed()){i.setCollapsed(false);}else if(i.getId()!==g&&!i.getCollapsed()){i.setCollapsed(true);}});},oldNotificationsUpdateCallbackForType:function(){var t=this;this.oNotificationsService.getNotifications().done(function(n){if(!n){return;}t.getNotificationsByTypeWithGroupHeaders();}).fail(function(d){jQuery.sap.log.error("Notifications control - call to notificationsService.getNotifications failed: ",d,"sap.ushell.renderers.fiori2.notifications.Notifications");});},handleEmptyList:function(){var i=this.getItemsFromModel(this.sCurrentSorting);this.getSelectedList().toggleStyleClass("sapContrast",!i.length);this.getSelectedList().toggleStyleClass("sapContrastPlus",!i.length);}});}());};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.SearchNavigationIntentObject')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.SearchNavigationIntentObject');(function(){"use strict";var _=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation");sap.ushell.renderers.fiori2.search.SearchNavigationObject.extend("sap.ushell.renderers.fiori2.search.SearchNavigationIntentObject",{constructor:function(p){sap.ushell.renderers.fiori2.search.SearchNavigationObject.prototype.constructor.apply(this,arguments);this._externalTarget=p.externalTarget;},performNavigation:function(){if(_){_.toExternal(this._externalTarget);}else{sap.ushell.renderers.fiori2.search.SearchNavigationObject.prototype.performNavigation.apply(this,arguments);}}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchFacet')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchFacet');(function(){"use strict";jQuery.sap.require('sap.m.List');sap.m.List.extend('sap.ushell.renderers.fiori2.search.controls.SearchFacet',{metadata:{properties:{eshRole:{type:"string",defaultValue:"datasource"}}},init:function(){this.data("sap-ui-fastnavgroup","false",true);},constructor:function(i,o){o=jQuery.extend({},{mode:sap.m.ListMode.SingleSelectMaster,showSeparators:sap.m.ListSeparators.None,includeItemInSelection:true,selectionChange:function(e){if(this.getEshRole()==="attribute"){this.handleItemPress(e);}},itemPress:function(e){if(this.getEshRole()==="datasource"){this.handleItemPress(e);}}},o);sap.m.List.prototype.constructor.apply(this,[i,o]);this.addStyleClass('sapUshellSearchFacet');},handleItemPress:function(e){var l=e.mParameters.listItem;var s=l.getBindingContext().getObject();if(l.getSelected()){this.getModel().addFilterCondition(s.filterCondition);}else{this.getModel().removeFilterCondition(s.filterCondition);}},renderer:'sap.m.ListRenderer',setEshRole:function(r){var t=this;var i={path:"items",template:new sap.ushell.renderers.fiori2.search.controls.SearchFacetItem(),groupHeaderFactory:function(g){var a=new sap.m.GroupHeaderListItem({title:g.key,upperCase:false});if(t.getModel().config.charts){a.setVisible(false);}return a;}};switch(r.toLowerCase()){default:case"datasource":this.setMode(sap.m.ListMode.SingleSelectMaster);this.setHeaderText(sap.ushell.resources.i18n.getText("searchIn"));break;case"attribute":this.setMode(sap.m.ListMode.MultiSelect);this.setHeaderText("");i.sorter=new sap.ui.model.Sorter("facetTitle",false,false);break;}this.bindAggregation("items",i);this.setProperty("eshRole",r);return this;},setModel:function(){return sap.m.List.prototype.setModel.apply(this,arguments);}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchFieldGroup')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchFieldGroup');(function(){"use strict";sap.ui.core.Control.extend("sap.ushell.renderers.fiori2.search.controls.SearchFieldGroup",{metadata:{properties:{"selectActive":{defaultValue:true,type:"boolean"},"inputActive":{defaultValue:true,type:"boolean"},"buttonActive":{defaultValue:true,type:"boolean"},"cancelButtonActive":{defaultValue:true,type:"boolean"}},aggregations:{"_flexBox":{type:"sap.m.FlexBox",multiple:false,visibility:"hidden"}}},constructor:function(){sap.ui.core.Control.prototype.constructor.apply(this,arguments);var t=this;t.initSelect();t.initInput();t.initButton();t.initCancelButton();t.initFlexBox();},setCancelButtonActive:function(a){if(a===this.getProperty('cancelButtonActive')){return;}this.setProperty('cancelButtonActive',a);this.initFlexBox();},initFlexBox:function(){if(!this.select){return;}var a=[];if(this.getSelectActive()){this.select.setLayoutData(new sap.m.FlexItemData({growFactor:0}));a.push(this.select);}if(this.getInputActive()){this.input.setLayoutData(new sap.m.FlexItemData({growFactor:1}));a.push(this.input);}if(this.getButtonActive()){this.button.setLayoutData(new sap.m.FlexItemData({growFactor:0}));a.push(this.button);}if(this.getCancelButtonActive()){this.cancelButton.setLayoutData(new sap.m.FlexItemData({growFactor:0}));a.push(this.cancelButton);}var f=this.getAggregation('_flexBox');if(!f){f=new sap.m.FlexBox({alignItems:sap.m.FlexAlignItems.Start,items:a});this.setAggregation('_flexBox',f);}else{f.removeAllAggregation('items');for(var i=0;i<a.length;++i){f.addItem(a[i]);}}},initSelect:function(){var t=this;t.select=new sap.ushell.renderers.fiori2.search.controls.SearchSelect(t.getId()+'-select',{});t.select.attachChange(function(){if(t.getAggregation("input")){var i=t.getAggregation("input");i.destroySuggestionRows();}});},initInput:function(){var t=this;t.input=new sap.ushell.renderers.fiori2.search.controls.SearchInput(t.getId()+'-input',{});},initButton:function(){var t=this;t.button=new sap.ushell.renderers.fiori2.search.controls.SearchButton(t.getId()+'-button',{tooltip:"{i18n>searchbox_tooltip}",ariaLabel:"{i18n>searchbox_tooltip}",press:function(e){var m=t.button.getModel();if(t.input.getValue()===""&&m.getDataSource().equals(m.getDefaultDataSource())){return;}m.invalidateQuery();t.input.destroySuggestionRows();t.input.triggerSearch(e);}});},initCancelButton:function(){this.cancelButton=new sap.m.Button({text:'{i18n>cancelBtn}'});this.cancelButton.addStyleClass("sapUshellSearchCancelButton");},setModel:function(m){this.select.setModel(m);this.input.setModel(m);this.button.setModel(m);this.cancelButton.setModel(m);},renderer:function(r,c){r.write('<div');r.writeControlData(c);r.addClass("SearchFieldGroup");r.writeClasses();r.write('>');r.renderControl(c.getAggregation('_flexBox'));r.write('</div>');}});}());};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchResultListItem')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchResultListItem');(function(){"use strict";var S=sap.ushell.renderers.fiori2.search.controls.SearchText;var a=sap.ushell.renderers.fiori2.search.controls.SearchLink;var b=sap.ushell.renderers.fiori2.search.SearchHelper;var c=sap.ushell.renderers.fiori2.search.SearchLogger;var f=sap.ushell.renderers.fiori2.search.controls.SearchRelatedObjectsToolbar;var n='\u2013';sap.ui.core.Control.extend("sap.ushell.renderers.fiori2.search.controls.SearchResultListItem",{metadata:{properties:{title:"string",titleUrl:"string",titleNavigation:"object",type:"string",imageUrl:"string",attributes:{type:"object",multiple:true},navigationObjects:{type:"object",multiple:true},selected:"boolean",expanded:"boolean",parentListItem:"object"},aggregations:{_titleLink:{type:"sap.ushell.renderers.fiori2.search.controls.SearchLink",multiple:false,visibility:"hidden"},_typeText:{type:"sap.ushell.renderers.fiori2.search.controls.SearchText",multiple:false,visibility:"hidden"},_selectionCheckBox:{type:"sap.m.CheckBox",multiple:false,visibility:"hidden"},_expandButton:{type:"sap.m.Button",multiple:false,visibility:"hidden"},_attributeLabels:{type:"sap.m.Label",multiple:true,visibility:"hidden"},_attributeValues:{type:"sap.ushell.renderers.fiori2.search.controls.SearchText",multiple:true,visibility:"hidden"},_relatedObjectActionsToolbar:{type:"sap.ushell.renderers.fiori2.search.controls.SearchRelatedObjectsToolbar",multiple:false,visibility:"hidden"},_titleLabeledByText:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"}}},init:function(){var t=this;t.setAggregation("_titleLink",new a({}).addStyleClass("sapUshellSearchResultListItem-Title").addStyleClass("sapUshellSearchResultListItem-MightOverflow").attachPress(function(E){var l="";var d=t.getTitleNavigation();if(d){l=d.getHref();}if(l&&l.length>0){try{var N=new c.NavigationEvent();N.addUserHistoryEntry(l);var m=sap.ushell.renderers.fiori2.search.getModelSingleton();m.analytics.logCustomEvent('FLP: Search','Launch Object',[l]);}catch(e){}var p=t._getPhoneSize();var w=$(window).width();if(w<=p){E.preventDefault();var g=t.fireNavigate(d);g();}}}));t.setAggregation("_typeText",new S().addStyleClass("sapUshellSearchResultListItem-Category").addStyleClass("sapUshellSearchResultListItem-MightOverflow"));t.setAggregation("_selectionCheckBox",new sap.m.CheckBox({select:function(e){t.setProperty("selected",e.getParameters().selected,true);}}));t.setAggregation("_expandButton",new sap.m.Button({type:sap.m.ButtonType.Transparent,press:function(e){t.toggleDetails();}}));t.setAggregation("_relatedObjectActionsToolbar",new f().addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar"));t.setAggregation("_titleLabeledByText",new sap.ui.core.InvisibleText());},renderer:function(r,C){C._renderer(r);},_renderer:function(r){this._resetPrecalculatedValues();this._renderContainer(r);this._renderAccessibilityInformation(r);},_renderContainer:function(r){var t=this;r.write('<div');r.writeControlData(t);r.addClass("sapUshellSearchResultListItem-Container");r.writeClasses();r.write('>');t._renderContentContainer(r);t._renderExpandButtonContainer(r);r.write('</div>');},_renderContentContainer:function(r){r.write('<div class="sapUshellSearchResultListItem-Content">');this._renderTitleContainer(r);this._renderAttributesContainer(r);r.write('</div>');},_renderExpandButtonContainer:function(r){var t=this;r.write('<div class="sapUshellSearchResultListItem-ExpandButtonContainer">');r.write('<div class="sapUshellSearchResultListItem-ExpandButton">');var i,d;var e=t.getProperty("expanded");if(e){i=sap.ui.core.IconPool.getIconURI("slim-arrow-up");d=sap.ushell.resources.i18n.getText("hideDetailBtn_tooltip");}else{i=sap.ui.core.IconPool.getIconURI("slim-arrow-down");d=sap.ushell.resources.i18n.getText("showDetailBtn_tooltip");}var g=t.getAggregation("_expandButton");g.setIcon(i);g.setTooltip(d);g.onAfterRendering=function(){sap.m.Button.prototype.onAfterRendering.apply(this,arguments);t.setAriaExpandedState();};r.renderControl(g);r.write('</div>');r.write('</div>');},_renderTitleContainer:function(r){var t=this;r.write('<div class="sapUshellSearchResultListItem-TitleAndImageContainer">');r.write('<div class="sapUshellSearchResultListItem-TitleContainer">');t._renderCheckbox(r);var d="";var e;var g=t.getTitleNavigation();if(g){d=g.getHref();e=g.getTarget();}var h=t.getAggregation("_titleLink");h.setHref(d);h.setText(t.getTitle());if(e){h.setTarget(e);}if(d.length==0){h.setEnabled(false);}r.renderControl(h);var i=t.getAggregation("_typeText");i.setText(t.getType());r.renderControl(i);r.write('</div>');t._renderImageForPhone(r);r.write('</div>');},_renderCheckbox:function(r){var t=this;r.write('<div class="sapUshellSearchResultListItem-CheckboxExpandContainer">');r.write('<div class="sapUshellSearchResultListItem-CheckboxContainer">');r.write('<div class="sapUshellSearchResultListItem-CheckboxAlignmentContainer">');var d=t.getAggregation("_selectionCheckBox");var s=t.getProperty("selected");d.setSelected(s);r.renderControl(d);r.write('</div>');r.write('</div>');r.write('</div>');},_renderImageForPhone:function(r){var t=this;if(t.getImageUrl()){r.write('<div class="sapUshellSearchResultListItem-TitleImage">');r.write('<div class="sapUshellSearchResultListItem-ImageContainerAlignmentHelper"></div>');r.write('<img class="sapUshellSearchResultListItem-Image" src="');r.write(t.getImageUrl());r.write('">');r.write('</div>');}},_renderAttributesContainer:function(r){var t=this;r.write('<div class="sapUshellSearchResultListItem-AttributesExpandContainer');var e=t.getProperty("expanded");if(e){r.write(" sapUshellSearchResultListItem-AttributesExpanded");}r.write('">');r.write('<div class="sapUshellSearchResultListItem-AttributesAndActions">');r.write('<ul class="sapUshellSearchResultListItem-Attributes">');t._renderImageAttribute(r);var i=t.getAttributes();t._renderAllAttributes(r,i);r.write('<div class="sapUshellSearchResultListItem-ExpandSpacerAttribute" aria-hidden="true"></div>');r.write('</ul>');t._renderRelatedObjectsToolbar(r);r.write('</div>');r.write('</div>');},_renderAllAttributes:function(r,d){var t=this;var e;var l;var v;var g,h;var i=0,j=0;var k=12;if(t.getImageUrl()){k--;}t.destroyAggregation("_attributeLabels");t.destroyAggregation("_attributeValues");for(;j<k&&i<d.length;i++){e=d[i];if(e.isTitle){continue;}l=e.name;v=e.value;if(l===undefined||v===undefined){continue;}if(!v||v===""){v=n;}r.write('<li class="sapUshellSearchResultListItem-GenericAttribute sapUshellSearchResultListItem-MainAttribute">');g=new sap.m.Label();g.setText(l);g.addStyleClass("sapUshellSearchResultListItem-AttributeKey");g.addStyleClass("sapUshellSearchResultListItem-MightOverflow");r.renderControl(g);h=new S();h.setText(v);h.addStyleClass("sapUshellSearchResultListItem-AttributeValue");h.addStyleClass("sapUshellSearchResultListItem-MightOverflow");r.renderControl(h);r.write('</li>');t.addAggregation("_attributeLabels",g,true);t.addAggregation("_attributeValues",h,true);j++;}var m=false;for(;i<d.length;i++){e=d[i];if(!e.whyfound){continue;}l=e.name;v=e.value;if(l===undefined||v===undefined){continue;}if(!v||v===""){v=n;}r.write('<li class="sapUshellSearchResultListItem-GenericAttribute sapUshellSearchResultListItem-WhyFoundAttribute">');g=new sap.m.Label();g.setText(l);g.addStyleClass("sapUshellSearchResultListItem-AttributeKey");g.addStyleClass("sapUshellSearchResultListItem-MightOverflow");r.renderControl(g);h=new S();h.setText(v);h.addStyleClass("sapUshellSearchResultListItem-AttributeValue");h.addStyleClass("sapUshellSearchResultListItem-MightOverflow");r.renderControl(h);r.write('</li>');t.addAggregation("_attributeLabels",g,true);t.addAggregation("_attributeValues",h,true);m=true;}if(m){r.write('<div class="sapUshellSearchResultListItem-GenericAttribute sapUshellSearchResultListItem-WhyFoundSpacerAttribute" aria-hidden="true"></div>');}},_renderImageAttribute:function(r){var t=this;if(!t.getImageUrl()){return;}r.write('<div class="sapUshellSearchResultListItem-GenericAttribute sapUshellSearchResultListItem-ImageAttribute');if(!t.getImageUrl()){r.write(' sapUshellSearchResultListItem-ImageAttributeHidden');}r.write('">');r.write('<div class="sapUshellSearchResultListItem-ImageContainer">');if(t.getImageUrl()){r.write('<img class="sapUshellSearchResultListItem-Image" src="');r.write(t.getImageUrl());r.write('">');}r.write('<div class="sapUshellSearchResultListItem-ImageContainerAlignmentHelper"></div>');r.write('</div>');r.write('</div>');},_renderRelatedObjectsToolbar:function(r){var t=this;var d=t.getNavigationObjects();if(!d||d.length==0){return;}t._showExpandButton=true;var e=t.getAggregation("_relatedObjectActionsToolbar");e.setProperty("navigationObjects",d);r.renderControl(e);},_renderAccessibilityInformation:function(r){var t=this;var p=t.getProperty("parentListItem");if(p){var l=t.getTitle()+", "+t.getType();var d=t.getAggregation("_titleLabeledByText");d.setText(l);r.renderControl(d);p.onAfterRendering=function(){sap.m.CustomListItem.prototype.onAfterRendering.apply(this,arguments);var e=$(this.getDomRef());e.attr("aria-labelledby",d.getId());};p.addEventDelegate({onsapspace:function(e){if(e.target===e.currentTarget){t.toggleDetails();}},onsapenter:function(E){if(E.target===E.currentTarget){var g="";var h=t.getTitleNavigation();if(h){g=h.getHref();}try{var N=new c.NavigationEvent();N.addUserHistoryEntry(g);var m=sap.ushell.renderers.fiori2.search.getModelSingleton();m.analytics.logCustomEvent('FLP: Search','Launch Object',[g]);}catch(e){}if(g&&g.length>0){var i=t.fireNavigate(h);i();}}}});}},_getExpandAreaObjectInfo:function(){var t=this;var r=$(t.getDomRef());var d=r.find(".sapUshellSearchResultListItem-AttributesExpandContainer");var e=r.find(".sapUshellSearchResultListItem-RelatedObjectsToolbar");var g=false;if(e.css("display")==="none"){e.css("display","block");g=true;}var h=d.height();var i=r.find(".sapUshellSearchResultListItem-AttributesAndActions").height();if(g){e.css("display","");}var j=[];r.find(".sapUshellSearchResultListItem-GenericAttribute").each(function(){var o=$(this);if(o.css("order")>2){j.push(this);}});var k=200;var l=k/10;var m={resultListItem:r,attributesExpandContainer:d,currentHeight:h,expandedHeight:i,elementsToFadeInOrOut:j,expandAnimationDuration:k,fadeInOrOutAnimationDuration:l,relatedObjectsToolbar:e};return m;},isShowingDetails:function(){var e=this._getExpandAreaObjectInfo();if(e.currentHeight<e.expandedHeight){return false;}return true;},showDetails:function(d){var t=this;if(t.isShowingDetails()){return;}var e=this._getExpandAreaObjectInfo();e.relatedObjectsToolbar.css("display","block");var r=t.getAggregation("_relatedObjectActionsToolbar");if(r){r._layoutToolbarElements();}e.attributesExpandContainer.animate({"height":e.expandedHeight},e.expandAnimationDuration,function(){t.setProperty("expanded",true,true);$(this).addClass("sapUshellSearchResultListItem-AttributesExpanded");$(this).css("height","");$(e.elementsToFadeInOrOut).css("opacity","");var i=sap.ui.core.IconPool.getIconURI("slim-arrow-up");var g=t.getAggregation("_expandButton");g.setTooltip(sap.ushell.resources.i18n.getText("hideDetailBtn_tooltip"));g.setIcon(i);g.rerender();e.relatedObjectsToolbar.css("display","");});$(e.elementsToFadeInOrOut).animate({"opacity":1},e.fadeInOrOutAnimationDuration);},hideDetails:function(d){var t=this;var r=$(t.getDomRef());if(!t.isShowingDetails()){return;}var e=this._getExpandAreaObjectInfo();var g=r.find(".sapUshellSearchResultListItem-MainAttribute").outerHeight(true)+r.find(".sapUshellSearchResultListItem-ExpandSpacerAttribute").outerHeight(true);var s=false;var h=e.attributesExpandContainer.animate({"height":g},{"duration":e.expandAnimationDuration,"progress":function(i,p,j){if(!s&&j<=e.fadeInOrOutAnimationDuration){s=true;var k=$(e.elementsToFadeInOrOut).animate({"opacity":0},e.fadeInOrOutAnimationDuration).promise();jQuery.when(h,k).done(function(){t.setProperty("expanded",false,true);e.attributesExpandContainer.removeClass("sapUshellSearchResultListItem-AttributesExpanded");$(e.elementsToFadeInOrOut).css("opacity","");var l=sap.ui.core.IconPool.getIconURI("slim-arrow-down");var m=t.getAggregation("_expandButton");m.setTooltip(sap.ushell.resources.i18n.getText("showDetailBtn_tooltip"));m.setIcon(l);m.rerender();});}}}).promise();},toggleDetails:function(d){if(this.isShowingDetails()){this.hideDetails(d);}else{this.showDetails(d);}},isSelectionModeEnabled:function(){var t=this;var i=false;var s=$(t.getDomRef()).find(".sapUshellSearchResultListItem-multiSelect-selectionBoxContainer");if(s){i=s.css("opacity")>0;}return i;},enableSelectionMode:function(d){var t=this;var s=$(t.getDomRef()).find(".sapUshellSearchResultListItem-multiSelect-innerContainer");var e=s.find(".sapUshellSearchResultListItem-multiSelect-selectionBoxContainer");var g=200;var h=false;s.animate({width:"2rem"},{"duration":g,"progress":function(i,p,r){if(!h&&p>0.5){e.css("display","");e.animate({opacity:"1.0"},g/2);h=true;}}});},disableSelectionMode:function(d){var t=this;var s=$(t.getDomRef()).find(".sapUshellSearchResultListItem-multiSelect-innerContainer");var e=s.find(".sapUshellSearchResultListItem-multiSelect-selectionBoxContainer");var g=200;e.animate({opacity:"0.0"},g/2,function(){e.css("display","none");});s.animate({width:"0"},g);},toggleSelectionMode:function(d){if(this.isSelectionModeEnabled()){this.disableSelectionMode(d);}else{this.enableSelectionMode(d);}},onAfterRendering:function(){var t=this;t.showOrHideExpandButton();var p=t._getPhoneSize();$(t.getDomRef()).bind('click',function(){var w=$(window).width();if(w<=p){var d="";var e=t.getTitleNavigation();if(e){d=e.getHref();}if(d&&d.length>0){var g=t.fireNavigate(e);g();}}});t.forwardEllipsis($(t.getDomRef()).find(".sapUshellSearchResultListItem-Title, .sapUshellSearchResultListItem-AttributeKey, .sapUshellSearchResultListItem-AttributeValue"));$(this.getDomRef()).find('.sapUshellSearchResultListItem-MightOverflow').on('mouseenter',function(){var d=$(this);var e=d.attr('title');if((this.offsetWidth<this.scrollWidth||this.offsetHeight<this.scrollHeight)&&!d.attr('title')){d.attr("title",d.text());}else if(e===d.text()){d.removeAttr('title');}}).on('mouseout',function(){var d=$(this);var e=d.attr('title');if(e===d.text()){d.removeAttr('title');}});},_getPhoneSize:function(){return 767;},_resetPrecalculatedValues:function(){this._visibleAttributes=undefined;this._detailsArea=undefined;this._showExpandButton=false;},showOrHideExpandButton:function(){var t=this;var e=$(t.getDomRef());var d=e.find(".sapUshellSearchResultListItem-ExpandButtonContainer");var i=d.css("visibility")!="hidden";var s=false;var g=e.find(".sapUshellSearchResultListItem-RelatedObjectsToolbar");s=g.length>0;if(!s){e.find(".sapUshellSearchResultListItem-MainAttribute,.sapUshellSearchResultListItem-WhyFoundAttribute").each(function(){if($(this).css("order")>2){s=true;return false;}});}if(i&&!s){d.css("visibility","hidden");d.attr("aria-hidden","true");t.setAriaExpandedState();}else if(!i&&s){d.css("visibility","");d.removeAttr("aria-hidden");t.setAriaExpandedState();}},setAriaExpandedState:function(){var t=this;var e=t.getAggregation("_expandButton");var d=$(e.getDomRef());var g=$(t.getDomRef());var h=t.getParentListItem()?$(t.getParentListItem().getDomRef()):g.closest("li");var i=g.find(".sapUshellSearchResultListItem-ExpandButtonContainer");if(i.css("visibility")=="hidden"){d.removeAttr("aria-expanded");h.removeAttr("aria-expanded");}else{var j=t.getProperty("expanded");if(j){d.attr("aria-expanded","true");h.attr("aria-expanded","true");}else{d.attr("aria-expanded","false");h.attr("aria-expanded","false");}}},fireNavigate:function(d){return function(){if(d){try{var u=d.getHref();var N=new c.NavigationEvent();N.addUserHistoryEntry(u);var m=sap.ushell.renderers.fiori2.search.getModelSingleton();m.analytics.logCustomEvent('FLP: Search','Launch Object',[u]);}catch(e){}d.performNavigation();}};},forwardEllipsis:function(o){o.each(function(i,d){b.forwardEllipsis4Whyfound(d);});}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchResultListItemDocument')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchResultListItemDocument');(function(){"use strict";sap.ushell.renderers.fiori2.search.controls.SearchResultListItem.extend("sap.ushell.renderers.fiori2.search.controls.SearchResultListItemDocument",{renderer:function(r,c){c._renderer(r);},_renderTitleContainer:function(r){var t=this;r.write('<div class="sapUshellSearchResultListItem-TitleAndImageContainer">');r.write('<div class="sapUshellSearchResultListItem-TitleContainer">');t._renderCheckbox(r);var a=t.getTitleUrl();var b=t.getAggregation("_titleLink");b.setHref(a);b.setText("DOCUMENT: "+t.getTitle());if(a.length==0){b.setEnabled(false);}r.renderControl(b);var c=t.getAggregation("_typeText");c.setText(t.getType());r.renderControl(c);r.write('</div>');t._renderImageForPhone(r);r.write('</div>');},_renderImageAttribute:function(r){var t=this;if(!t.getImageUrl()){return;}r.write('<div class="sapUshellSearchResultListItem-GenericAttribute sapUshellSearchResultListItem-ImageAttribute');if(!t.getImageUrl()){r.write(' sapUshellSearchResultListItem-ImageAttributeHidden');}r.write('">');r.write('<div class="sapUshellSearchResultListItem-ImageContainer">');if(t.getImageUrl()){r.write('<img class="sapUshellSearchResultListItem-Image" src="');r.write(t.getImageUrl());r.write('">');}r.write('<div class="sapUshellSearchResultListItem-ImageContainerAlignmentHelper"></div>');r.write('</div>');r.write('</div>');}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchTilesContainer')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchTilesContainer');(function(){"use strict";jQuery.sap.require('sap.m.Button');var K=sap.ushell.renderers.fiori2.search.controls.SearchTilesContainerKeyHandler;var T=sap.ushell.renderers.fiori2.search.controls.SearchTileHighlighter;sap.ui.core.Control.extend('sap.ushell.renderers.fiori2.search.controls.SearchTilesContainer',{metadata:{properties:{'totalLength':{type:'int',defaultValue:0},'maxRows':{type:'int',defaultValue:1},'highlightTerms':{type:'string',defaultValue:''},'enableKeyHandler':{type:'boolean',defaultValue:true},'resultList':{type:'sap.ushell.renderers.fiori2.search.controls.SearchResultList'}},aggregations:{'tiles':{type:'sap.ui.core.Control',multiple:true}},events:{showMore:{}}},constructor:function(){sap.ui.core.Control.prototype.constructor.apply(this,arguments);if(this.getEnableKeyHandler()){this.addEventDelegate(new K(this));}this.tileHighlighter=new T();this._previousTabHandler={onsaptabprevious:function(e){var t;if(jQuery(this.control.getDomRef()).prop("tagName").toLowerCase()==="button"){t=this.control.getDomRef();}else{var b=jQuery(this.control.getDomRef()).find("[role='option']");if(b.length>0){t=b[0];}}if(e.isMarked()||!t||e.target!==t){return;}this.resultList.forwardTab(false);e.setMarked();}};},setHighlightTerms:function(t){this.setProperty('highlightTerms',t,true);},delayedRerender:function(){var t=this;setTimeout(function(){t.rerender();},0);},renderer:function(r,c){var t=c.getTiles();if(!t||t.length===0){return;}r.write('<div');r.writeControlData(c);r.addClass('sapUshellSearchTileContainer');r.writeClasses();r.write('>');c.renderTiles(r,c);r.write('</div>');},logUsageAnalytics:function(t){var i,m,c;if(t.attachPress){t.attachPress(function(){m=sap.ushell.renderers.fiori2.search.getModelSingleton();m.analytics.logCustomEvent('FLP: Search','Launch App',[t.usageAnalyticsTitle,t.getTargetURL()]);m.analytics.logCustomEvent('FLP: Application Launch point','Search Results',[t.usageAnalyticsTitle,t.getTargetURL()]);});return;}if(t&&t.getContent){c=t.getContent();if(c.length!==1){return;}i=c[0];if(!i.attachPress){return;}i.attachPress(function(){m=sap.ushell.renderers.fiori2.search.getModelSingleton();m.analytics.logCustomEvent('FLP: Search','Launch App',[t.usageAnalyticsTitle,i.getTargetURL()]);m.analytics.logCustomEvent('FLP: Application Launch point','Search Results',[t.usageAnalyticsTitle,i.getTargetURL()]);});}},renderTiles:function(r,c){var t=c.getTiles();for(var i=0;i<t.length;i++){var a=t[i];c.logUsageAnalytics(a);c.registerAfterRenderingForTile(a);r.write('<div');r.addClass('sapUshellSearchTileWrapper');r.writeClasses();r.writeAttribute("title",sap.ushell.resources.i18n.getText("launchTile_tooltip"));r.write('>');r.renderControl(a);r.write('</div>');a.addEventDelegate(this._previousTabHandler,{resultList:c.getResultList(),control:a});}c.renderPlusTile(r,c);c.tileHighlighter.setHighlightTerms(c.getHighlightTerms());},renderPlusTile:function(r,c){r.write('<div');r.addClass('sapUshellSearchTileWrapper');r.addClass('sapUshellSearchShowMoreTile');r.writeClasses();r.writeAttribute('style','display:none');r.write('>');var b=new sap.m.Button({text:sap.ushell.resources.i18n.getText('showMoreApps'),tooltip:sap.ushell.resources.i18n.getText('showMoreApps'),press:function(){c.fireShowMore();}});b.addEventDelegate(this._previousTabHandler,{resultList:c.getResultList(),control:b});b.addStyleClass('sapUshellSearchShowMoreTileButton');b.addStyleClass('sapMGT');b.addStyleClass('OneByOne');r.renderControl(b);r.write('</div>');},onAfterRendering:function(e){this.limitTileSize();while(this.getNumberRows()>this.getMaxRows()){this.removeLastTile();}var c=this.getDomRef();var n=c.children.length-1;if(this.getTotalLength()>n){this.makePlusTileVisible();this.cutAtRow();}jQuery('.sapUshellSearchTileWrapper [tabindex]').attr('role','option');},limitTileSize:function(){var c=this.getDomRef();for(var i=0;i<c.children.length;++i){var t=c.children.item(i);if(!this.hasTileStyleClass(t)){t.classList.add('sapMGT');t.classList.add('OneByOne');}}},hasTileStyleClass:function(d){if(d.classList.contains('sapMGT')&&d.classList.contains('OneByOne')){return true;}if(d.children.length===1){return this.hasTileStyleClass(d.children.item(0));}return false;},getNumberDisplayedTiles:function(){var c=this.getDomRef();return c.children.length;},registerAfterRenderingForTile:function(t){var a=this;t.addEventDelegate({onAfterRendering:function(){a.tileHighlighter.highlight(t);}});},makePlusTileVisible:function(){var c=this.getDomRef();var p=c.children.item(c.children.length-1);p.style.display='inline-block';},removeLastTile:function(){var c=this.getDomRef();var l=c.children.item(c.children.length-2);l.parentNode.removeChild(l);},cutAtRow:function(){var c=this.getDomRef();while(!this.isLastRowCompletelyFilled()||this.getNumberRows()>this.getMaxRows()){if(c.children.length<=2){break;}this.removeLastTile();}},isLastRowCompletelyFilled:function(){var c=this.getDomRef();var t=this.getTilesPerRow();var a=-1;for(var i=0;i<t;++i){var b=c.children.item(c.children.length-1-i);if(b.style.display==='none'){t++;continue;}if(a<0){a=b.offsetLeft;continue;}if(b.offsetLeft>a){return false;}}return true;},getNumberRows:function(){var c=this.getDomRef();var t=-1;var a=0;for(var i=0;i<c.children.length-1;++i){var b=c.children.item(i);if(b.style.display==='none'){continue;}if(t<0||b.offsetLeft<=t){a++;}t=b.offsetLeft;}return a;},getTilesPerRow:function(){var c=this.getDomRef();var t=-1;var a=0;for(var i=0;i<c.children.length;++i){var b=c.children.item(i);if(b.style.display==='none'){continue;}if(b.offsetLeft<=t){return a;}a++;t=b.offsetLeft;}return a;}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.personalization.BrowserPersonalizationStorage')){(function(){"use strict";jQuery.sap.declare('sap.ushell.renderers.fiori2.search.personalization.BrowserPersonalizationStorage');var P=sap.ushell.renderers.fiori2.search.personalization.Personalizer;var m=sap.ushell.renderers.fiori2.search.personalization.BrowserPersonalizationStorage=function(){this.init.apply(this,arguments);};var B=m;m.prototype={init:function(){},getItem:function(k){if(!this._isStorageSupported()){throw'not supported storage';}return this._getStorage(k);},setItem:function(k,d){if(!this._isStorageSupported()){throw'not supported storage';}this._putStorage(k,d);},getPersonalizer:function(k){return new P(k,this);},_isStorageSupported:function(){if(jQuery.sap.storage&&jQuery.sap.storage.isSupported()){return true;}else{return false;}},_getStorage:function(k){return jQuery.sap.storage.get("Search.Personalization."+k);},_putStorage:function(k,s){jQuery.sap.storage.put("Search.Personalization."+k,s);}};m.getInstance=function(){return new jQuery.Deferred().resolve(new B());};})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.personalization.FLPPersonalizationStorage')){(function(){"use strict";jQuery.sap.declare('sap.ushell.renderers.fiori2.search.personalization.FLPPersonalizationStorage');var P=sap.ushell.renderers.fiori2.search.personalization.Personalizer;var S=sap.ushell.renderers.fiori2.search.SearchHelper;var m=sap.ushell.renderers.fiori2.search.personalization.FLPPersonalizationStorage=function(){this.init.apply(this,arguments);};var F=m;m.prototype={init:function(c){this.container=c;this.save=S.delayedExecution(this.save,2000);},save:function(){this.container.save();},getItem:function(k){k=this.limitLength(k);if(!this._isStorageSupported()){throw'not supported storage';}return this.container.getItemValue(k);},setItem:function(k,d){k=this.limitLength(k);if(!this._isStorageSupported()){throw'not supported storage';}this.container.setItemValue(k,d);this.save();},limitLength:function(k){return k.slice(-40);},getPersonalizer:function(k){return new P(k,this);},_isStorageSupported:function(){if(jQuery.sap.storage&&jQuery.sap.storage.isSupported()){return true;}else{return false;}}};m.getInstance=function(){var p=sap.ushell.Container.getService("Personalization");return p.getContainer("ushellSearchPersoServiceContainer").then(function(c){return new F(c);});};})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.personalization.MemoryPersonalizationStorage')){(function(){"use strict";jQuery.sap.declare('sap.ushell.renderers.fiori2.search.personalization.MemoryPersonalizationStorage');var P=sap.ushell.renderers.fiori2.search.personalization.Personalizer;var m=sap.ushell.renderers.fiori2.search.personalization.MemoryPersonalizationStorage=function(){this.init.apply(this,arguments);};var M=m;m.prototype={init:function(){this.dataMap={};},getItem:function(k){if(!this._isStorageSupported()){throw'not supported storage';}return this._getStorage(k);},setItem:function(k,d){if(!this._isStorageSupported()){throw'not supported storage';}this._putStorage(k,d);},getPersonalizer:function(k){return new P(k,this);},_isStorageSupported:function(){return true;},_getStorage:function(k){return this.dataMap[k];},_putStorage:function(k,s){this.dataMap[k]=s;}};m.getInstance=function(){return new jQuery.Deferred().resolve(new M());};})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.personalization.PersonalizationStorage')){(function(){"use strict";jQuery.sap.declare('sap.ushell.renderers.fiori2.search.personalization.PersonalizationStorage');var F=sap.ushell.renderers.fiori2.search.personalization.FLPPersonalizationStorage;var B=sap.ushell.renderers.fiori2.search.personalization.BrowserPersonalizationStorage;var M=sap.ushell.renderers.fiori2.search.personalization.MemoryPersonalizationStorage;var S=sap.ushell.renderers.fiori2.search.SearchConfiguration;var c=S.getInstance();sap.ushell.renderers.fiori2.search.personalization.PersonalizationStorage={instance:null,isLaunchpad:function(){try{return sap.ushell.Container.getService("Personalization")?true:false;}catch(e){return false;}},getInstance:function(){var t=this;if(this.instancePromise){return this.instancePromise;}switch(c.personalizationStorage){case'auto':if(this.isLaunchpad()){this.instancePromise=F.getInstance();}else{this.instancePromise=B.getInstance();}break;case'browser':this.instancePromise=B.getInstance();break;case'flp':this.instancePromise=F.getInstance();break;case'memory':this.instancePromise=M.getInstance();break;default:}this.instancePromise.then(function(i){t.instance=i;});return this.instancePromise;},getInstanceSync:function(){if(!this.instance){throw'No instance, call async method getInstance for getting the instance';}return this.instance;},isInitialized:function(){return!!this.instance;}};})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.suggestions.AppSuggestionProvider')){(function(){"use strict";var S=sap.ushell.renderers.fiori2.search.SearchHelper;var a=sap.ushell.renderers.fiori2.search.suggestions.SuggestionProvider;var b=sap.ushell.renderers.fiori2.search.suggestions.SuggestionTypeProps;jQuery.sap.declare('sap.ushell.renderers.fiori2.search.suggestions.AppSuggestionProvider');var m=sap.ushell.renderers.fiori2.search.suggestions.AppSuggestionProvider=function(){this.init.apply(this,arguments);};m.prototype=jQuery.extend(new a(),{init:function(p){a.prototype.init.apply(this,arguments);this.suggestApplications=S.refuseOutdatedRequests(this.suggestApplications);},abortSuggestions:function(){this.suggestApplications.abort();},combineSuggestionsWithIdenticalTitle:function(s){function J(k,v){if(k==="sina"){return undefined;}return v;}var c;var d={};for(var i=0;i<s.length;i++){c=s[i];var f=d[c.title+c.icon];if(f){if(!f.combinedSuggestionExists){var e={title:'combinedAppSuggestion'+i,sortIndex:f.sortIndex,url:"#Action-search&/searchterm="+c.title+"&datasource="+JSON.stringify(this.model.appDataSource,J),label:sap.ushell.resources.i18n.getText("suggestion_in_apps",c.label),icon:""};var g=sap.ushell.resources.i18n.getText("suggestion_in_apps",[""]);e.label=e.label.replace(g,"<i>"+g+"</i>");d[e.title+e.icon]=e;f.combinedSuggestionExists=true;}}else{c.sortIndex=i;d[c.title+c.icon]=c;}}s=[];for(var h in d){if(d.hasOwnProperty(h)){c=d[h];if(!c.combinedSuggestionExists){s.push(c);}}}s.sort(function(j,k){return j.sortIndex-k.sortIndex;});return s;},createShowMoreSuggestion:function(t){var c=sap.ushell.resources.i18n.getText("showAllNApps",t);c=c.replace(/"/g,"");var d=c;var l="<i>"+c+"</i>";return{title:c,tooltip:d,label:l,dataSource:this.model.appDataSource,labelRaw:this.model.getProperty("/uiFilter/searchTerms"),type:window.sinabase.SuggestionType.OBJECTDATA};},getSuggestions:function(){var t=this;var d=t.model.getDataSource();if(!d.equals(t.model.allDataSource)&&!d.equals(t.model.appDataSource)){return jQuery.when([]);}var s=t.model.getProperty('/uiFilter/searchTerms');return t.suggestApplications(s).then(function(r){var c=r.getElements();c=t.combineSuggestionsWithIdenticalTitle(c);jQuery.each(c,function(i,f){f.type=window.sinabase.SuggestionType.APPS;f.dataSource=t.model.appDataSource;f.position=b[window.sinabase.SuggestionType.APPS].position;});var e;if(t.model.isAllCategory()){e=b[window.sinabase.SuggestionType.APPS].limitDsAll;}else{e=b[window.sinabase.SuggestionType.APPS].limitDsApps;}c=c.slice(0,e);if(r.totalResults>e&&d.equals(t.model.appDataSource)){c.push(t.createShowMoreSuggestion(r.totalResults));}return c;});},suggestApplications:function(s){return sap.ushell.Container.getService("Search").queryApplications({searchTerm:s,searchInKeywords:true});}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.suggestions.DataSourceSuggestionProvider')){(function(){"use strict";var S=sap.ushell.renderers.fiori2.search.SearchHelper;var a=sap.ushell.renderers.fiori2.search.suggestions.SuggestionProvider;var b=sap.ushell.renderers.fiori2.search.suggestions.SuggestionTypeProps;var s=window.sinabase;jQuery.sap.declare('sap.ushell.renderers.fiori2.search.suggestions.DataSourceSuggestionProvider');var m=sap.ushell.renderers.fiori2.search.suggestions.DataSourceSuggestionProvider=function(){this.init.apply(this,arguments);};m.prototype=jQuery.extend(new a(),{init:function(p){a.prototype.init.apply(this,arguments);this.suggestDataSources=S.refuseOutdatedRequests(this.suggestDataSources);},abortSuggestions:function(){this.suggestDataSources.abort();},getSuggestions:function(){if(!this.model.isBusinessObjSearchEnabled()){return jQuery.when([]);}if(!this.model.getDataSource().equals(this.model.allDataSource)){return jQuery.when([]);}return this.suggestDataSources();},suggestDataSources:function(){var t=this;return t.model.getServerDataSources().then(function(d){if(jQuery.inArray(t.model.appDataSource,d)<0){d.unshift(t.model.appDataSource);}if(jQuery.inArray(t.model.allDataSource,d)<0){d.unshift(t.model.allDataSource);}var c=t.model.getProperty('/uiFilter/searchTerms');var e=c.replace(/\*/g,'');var T=new S.Tester(e);var o;var f;var g=[];for(var i=0;i<d.length;++i){var h=d[i];if(h.equals(t.model.getDataSource())){continue;}o=T.test(h.label);if(o.bMatch===true){f={};f.label='<i>'+sap.ushell.resources.i18n.getText("searchInPlaceholder",o.sHighlightedText)+'</i>';f.labelRaw='';f.dataSource=h;f.type=s.SuggestionType.DATASOURCE;f.position=b[s.SuggestionType.DATASOURCE].position;g.push(f);if(g.length===b[s.SuggestionType.DATASOURCE].limit){break;}}}return g;});}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.suggestions.SinaBaseSuggestionProvider')){(function(){"use strict";var S=sap.ushell.renderers.fiori2.search.suggestions.SuggestionProvider;jQuery.sap.declare('sap.ushell.renderers.fiori2.search.suggestions.SinaBaseSuggestionProvider');var m=sap.ushell.renderers.fiori2.search.suggestions.SinaBaseSuggestionProvider=function(){this.init.apply(this,arguments);};m.prototype=jQuery.extend(new S(),{init:function(){S.prototype.init.apply(this,arguments);},prepareSuggestionQuery:function(s){var t=this;t.suggestionQuery.resetResultSet();t.suggestionQuery.setSuggestionTerm(s);if(!t.suggestionQuery.getDataSource()||!t.model.getProperty('/uiFilter/dataSource').equals(t.suggestionQuery.getDataSource())){t.suggestionQuery.resetFilterConditions();}t.suggestionQuery.setDataSource(t.model.getProperty("/uiFilter/dataSource"));t.suggestionQuery.setSuggestionTypes(t.suggestionTypes);t.suggestionQuery.setTop(20);}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.suggestions.SinaSuggestionProvider')){(function(){"use strict";var S=sap.ushell.renderers.fiori2.search.SearchHelper;var a=sap.ushell.renderers.fiori2.search.suggestions.SinaBaseSuggestionProvider;var b=sap.ushell.renderers.fiori2.search.suggestions.SuggestionTypeProps;var s=window.sinabase;jQuery.sap.declare('sap.ushell.renderers.fiori2.search.suggestions.SinaSuggestionProvider');var m=sap.ushell.renderers.fiori2.search.suggestions.SinaSuggestionProvider=function(){this.init.apply(this,arguments);};m.prototype=jQuery.extend(new a(),{suggestionLimit:jQuery.device.is.phone?5:7,init:function(p){a.prototype.init.apply(this,arguments);this.getResultSet=S.refuseOutdatedRequests(this.getResultSet);this.dataSourceDeferred=null;},abortSuggestions:function(){this.getResultSet.abort();},getResultSet:function(){return this.suggestionQuery.getResultSet();},getSuggestions:function(){var t=this;this.suggestions=[];this.firstObjectDataSuggestion=true;this.numberSuggestionsByType={};for(var c in s.SuggestionType){this.numberSuggestionsByType[s.SuggestionType[c]]=0;}var d=t.model.getProperty('/uiFilter/searchTerms');if(this.suggestionTypes.length===1&&this.suggestionTypes.indexOf(s.SuggestionType.OBJECTDATA)>=0&&d.length<3){return jQuery.when(this.suggestions);}t.createAllAndAppDsSuggestions();if(!t.model.isBusinessObjSearchEnabled()){return jQuery.when(this.suggestions);}if(t.model.getDataSource().equals(t.model.appDataSource)){return jQuery.when(this.suggestions);}t.prepareSuggestionQuery(d);return t.getResultSet().then(function(r){var e=r.getElements();t.formatSinaSuggestions(e);return t.suggestions;});},createAllAndAppDsSuggestions:function(){if(this.suggestionTypes.indexOf(s.SuggestionType.DATASOURCE)<0){return;}if(!this.model.getDataSource().equals(this.model.allDataSource)){return;}var d=[];d.unshift(this.model.appDataSource);d.unshift(this.model.allDataSource);var c=this.model.getProperty('/uiFilter/searchTerms');var e=c.replace(/\*/g,'');var t=new S.Tester(e);for(var i=0;i<d.length;++i){var f=d[i];if(f.key===this.model.getDataSource().key){continue;}var T=t.test(f.label);if(T.bMatch===true){var g={};g.label='<i>'+sap.ushell.resources.i18n.getText("searchInPlaceholder",[""])+'</i> '+T.sHighlightedText;g.labelRaw='';g.dataSource=f;g.type=s.SuggestionType.DATASOURCE;g.position=b[s.SuggestionType.DATASOURCE].position;g.key=f.key;this.addSuggestion(g);}}},preFormatSuggestions:function(c){for(var i=0;i<c.length;++i){var d=c[i];d.position=b[d.type].position;if(d.type===s.SuggestionType.DATASOURCE){d.key=d.labelRaw.key;}else{d.key=d.labelRaw;}if(d.children){this.preFormatSuggestions(d.children);}}},formatSinaSuggestions:function(c){this.preFormatSuggestions(c);for(var i=0;i<c.length;++i){var d=c[i];if(!d.labelRaw){continue;}if(this.suggestionTermBuffer.hasTerm(d.key)){continue;}var n=this.numberSuggestionsByType[d.type];var l=b[d.type].limit;if(n>=l){continue;}switch(d.type){case s.SuggestionType.DATASOURCE:if(!this.model.getDataSource().equals(this.model.allDataSource)){continue;}d.label='<i>'+sap.ushell.resources.i18n.getText("searchInPlaceholder",[""])+'</i> '+d.label;this.addSuggestion(d);break;case s.SuggestionType.OBJECTDATA:this.formatObjectDataSuggestion(d);break;case s.SuggestionType.HISTORY:d.label=d.label;this.addSuggestion(d);break;default:break;}}return this.suggestions;},addSuggestion:function(c){this.suggestions.push(c);this.suggestionTermBuffer.addTerm(c.key);this.numberSuggestionsByType[c.type]+=1;},formatObjectDataSuggestion:function(c){if(this.model.getDataSource().equals(this.model.allDataSource)){if(this.firstObjectDataSuggestion){this.firstObjectDataSuggestion=false;c.label=this.assembleSearchInSuggestionLabel(c);this.addSuggestion(c);this.addChildSuggestions(c);}else{this.addSuggestion(c);}}else{this.addSuggestion(c);}},addChildSuggestions:function(c){if(!c.children){return;}var l=Math.min(c.children.length,b[s.SuggestionType.OBJECTDATA].limitDataSource,b[s.SuggestionType.OBJECTDATA].limit-1);for(var i=0;i<l;++i){var d=c.children[i];this.numberObjectDataSuggestions++;d.label=this.assembleSearchInSuggestionLabel(d);d.position=b[s.SuggestionType.OBJECTDATA].position;this.addSuggestion(d);}},assembleSearchInSuggestionLabel:function(c){return sap.ushell.resources.i18n.getText("resultsIn",['<span>'+c.label+'</span>',c.dataSource.labelPlural]);}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.suggestions.SuggestionHandler')){(function(){"use strict";var S=sap.ushell.renderers.fiori2.search.SearchHelper;var a=sap.ushell.renderers.fiori2.search.suggestions.SinaSuggestionProvider;var D=sap.ushell.renderers.fiori2.search.suggestions.DataSourceSuggestionProvider;var A=sap.ushell.renderers.fiori2.search.suggestions.AppSuggestionProvider;var T=sap.ushell.renderers.fiori2.search.suggestions.TimeMerger;jQuery.sap.declare('sap.ushell.renderers.fiori2.search.suggestions.SuggestionHandler');var s=sap.ushell.renderers.fiori2.search.suggestions;var b=function(){this.init.apply(this,arguments);};b.prototype={init:function(){this.terms={};},addTerm:function(t){t=t.trim().toLowerCase();this.terms[t]=true;},hasTerm:function(t){t=t.trim().toLowerCase();return!!this.terms[t];},clear:function(){this.terms={};}};s.SuggestionHandler=function(){this.init.apply(this,arguments);};s.SuggestionHandler.prototype={init:function(p){var t=this;t.model=p.model;t.sina=t.model.sina;t.suggestionProviders=[];t.suggestionTermBuffer=new b();t.keyboardRelaxationTime=400;t.uiUpdateInterval=500;t.uiClearOldSuggestionsTimeOut=1000;t.dataSourceSuggestionProvider=new D({model:t.model,sina:t.sina,suggestionTermBuffer:t.suggestionTermBuffer});t.appSuggestionProvider=new A({model:t.model,suggestionTermBuffer:t.suggestionTermBuffer});t.doSuggestionInternal=S.delayedExecution(t.doSuggestionInternal,t.keyboardRelaxationTime);t.timeMerger=new T();},abortSuggestions:function(c){if(c===undefined||c===true){this.model.setProperty("/suggestions",[]);}if(this.clearSuggestionTimer){clearTimeout(this.clearSuggestionTimer);this.clearSuggestionTimer=null;}this.doSuggestionInternal.abort();this.getSuggestionProviders().done(function(d){for(var i=0;i<d.length;++i){var e=d[i];e.abortSuggestions();}});this.timeMerger.abort();},getSuggestionProviders:function(){var t=this;if(t.suggestionProvidersDeferred){return t.suggestionProvidersDeferred;}var c=[t.appSuggestionProvider];if(!t.model.config.searchBusinessObjects){t.suggestionProvidersDeferred=jQuery.when(c);return t.suggestionProvidersDeferred;}t.suggestionProvidersDeferred=t.sina.sinaSystem().getServerInfo().then(function(d){c.push.apply(c,t.createSinaSuggestionProviders(d));return jQuery.when(c);},function(){return jQuery.when(c);});return t.suggestionProvidersDeferred;},createSinaSuggestionProviders:function(c){var p=[{suggestionTypes:[window.sinabase.SuggestionType.HISTORY],activeSuggestionTypes:[]},{suggestionTypes:[window.sinabase.SuggestionType.DATASOURCE],activeSuggestionTypes:[]},{suggestionTypes:[window.sinabase.SuggestionType.OBJECTDATA],activeSuggestionTypes:[]}];var d=c.services.Suggestions.suggestionTypes;var e;var f=false;for(var i=0;i<d.length;++i){var g=d[i];if(g===window.sinabase.SuggestionType.DATASOURCE){f=true;}for(var j=0;j<p.length;++j){e=p[j];if(e.suggestionTypes.indexOf(g)<0){continue;}e.activeSuggestionTypes.push(g);}}var h=[];for(var k=0;k<p.length;++k){e=p[k];if(e.activeSuggestionTypes.length===0){continue;}h.push(new a({model:this.model,sina:this.sina,suggestionTermBuffer:this.suggestionTermBuffer,suggestionQuery:this.model.suggestionQuery,suggestionTypes:e.activeSuggestionTypes}));}if(!f){h.push(this.dataSourceSuggestionProvider);}return h;},isSuggestionPopupVisible:function(){return jQuery('.searchSuggestion').filter(':visible').length>0;},doSuggestion:function(){var t=this;if(this.isSuggestionPopupVisible()){this.abortSuggestions(false);this.clearSuggestionTimer=setTimeout(function(){t.clearSuggestionTimer=null;t.model.setProperty("/suggestions",[]);},t.uiClearOldSuggestionsTimeOut);}else{this.abortSuggestions();}this.doSuggestionInternal();},doSuggestionInternal:function(){var t=this;var c=t.model.getProperty("/uiFilter/searchTerms");if(c.length===0){return;}if(c.trim()==='*'){return;}t.model.analytics.logCustomEvent('FLP: Search','Suggestion',[t.model.getProperty('/uiFilter/searchTerms'),t.model.getProperty('/uiFilter/dataSource').key]);t.suggestionTermBuffer.clear();t.getSuggestionProviders().done(function(d){var p=[];var f=true;var e=d.length;for(var i=0;i<d.length;++i){var g=d[i];p.push(g.getSuggestions());}t.timeMerger.abort();t.timeMerger=new T(p,t.uiUpdateInterval);t.timeMerger.process(function(r){e-=r.length;var s=[];for(var j=0;j<r.length;++j){var h=r[j];s.push.apply(s,h);}if(e>0&&s.length===0){return;}if(t.clearSuggestionTimer){clearTimeout(t.clearSuggestionTimer);t.clearSuggestionTimer=null;}t.insertSuggestions(s,f);f=false;});});},insertSuggestions:function(i,f){var s=this.model.getProperty('/suggestions');if(f){s=[];}var g=this._groupByPosition(i);for(var p in g){var c=g[p];this._insertSuggestions(s,c);}this.model.setProperty('/suggestions',s);},_groupByPosition:function(s){var g={};for(var i=0;i<s.length;++i){var c=s[i];var d=g[c.position];if(!d){d=[];g[c.position]=d;}d.push(c);}return g;},_insertSuggestions:function(s,i){if(i.length<=0){return;}var c=i[0];var d=0;for(;d<s.length;++d){var e=s[d];if(e.position>c.position){break;}}var f=[d,0];f.push.apply(f,i);s.splice.apply(s,f);}};})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.usageAnalytics_selector.UsageAnalyticsSelector.view')){jQuery.sap.declare('sap.ushell.renderers.fiori2.usageAnalytics_selector.UsageAnalyticsSelector.view');(function(){"use strict";jQuery.sap.require('sap.m.Label');sap.ui.jsview("sap.ushell.renderers.fiori2.usageAnalytics_selector.UsageAnalyticsSelector",{createContent:function(c){var f=sap.ui.Device.system.phone?'Start':'Center',F=sap.ui.Device.system.phone?'Wrap':'NoWrap',s=sap.ui.Device.system.phone?'Column':'Row',t=sap.ui.Device.system.phone?'Left':'Right';this.oLabel=new sap.m.Label({width:"11.75rem",textAlign:t,text:sap.ushell.resources.i18n.getText("allowTracking")+":"}).addStyleClass('sapUshellUsageAnalyticsSelectorLabel');this.oSwitchButton=new sap.m.Switch("usageAnalyticsSwitchButton",{type:sap.m.SwitchType.Default}).addStyleClass('sapUshellUsageAnalyticsSelectorSwitchButton');this.oMessage=new sap.m.Text({text:sap.ushell.Container.getService("UsageAnalytics").getLegalText()}).addStyleClass('sapUshellUsageAnalyticsSelectorLegalTextMessage');this.fBox=new sap.m.FlexBox({alignItems:f,wrap:F,direction:s,items:[this.oLabel,this.oSwitchButton]});this.vBox=new sap.m.VBox({items:[this.fBox,this.oMessage]});return this.vBox;},getControllerName:function(){return"sap.ushell.renderers.fiori2.usageAnalytics_selector.UsageAnalyticsSelector";}});}());};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.user_actions.user_preferences.UserSettings.controller')){jQuery.sap.declare('sap.ushell.renderers.fiori2.user_actions.user_preferences.UserSettings.controller');(function(){"use strict";sap.ui.controller("sap.ushell.renderers.fiori2.user_actions.user_preferences.UserSettings",{onInit:function(){var v=this.getView(),t=this;this.navBackButton=new sap.m.Button({icon:sap.ui.Device.system.phone?"sap-icon://nav-back":"sap-icon://menu2",press:function(e){if(sap.ui.Device.system.phone){v.getSplitApp().backDetail();t._handleNavButton();}else{if(v.getSplitApp().isMasterShown()){v.getSplitApp().hideMaster();}else{v.getSplitApp().showMaster();}}}});if(v&&v.getSplitApp()){v.getSplitApp().attachAfterMasterClose(t,function(){t._handleNavButton.apply(t);});v.getSplitApp().attachAfterMasterOpen(t,function(){t._handleNavButton.apply(t);});}},_handleNavButton:function(){var v=this.getView();if(v&&v.getSplitApp()&&v.getSplitApp().getCurrentDetailPage()){if(!v.getSplitApp().isMasterShown()){v.splitAppHeaderBar.addContentLeft(this.navBackButton);}else{if(sap.ui.Device.system.phone||sap.ui.Device.orientation.landscape){v.splitAppHeaderBar.removeAllContentLeft();}}}},getOriginalDialogContent:function(){if(!this.oInitialContent){var e;e=this.getEntryListControl();this.oInitialContent=new sap.ui.layout.VerticalLayout('userPreferencesLayout',{content:[e]}).addStyleClass("sapUshellUserSettingLayout");this.aDanglingControls.push(this.oInitialContent);}return this.oInitialContent;},createDetailPage:function(e,a,t,c){var b=this,v=b.getView(),o=new sap.m.ObjectHeader({title:t,backgroundDesign:sap.m.BackgroundDesign.Solid}).addStyleClass("sapUshellUserSettingDetailHeader");if(e==="userAccountEntry"){o.setIcon(b.getUserImage(sap.ui.core.IconPool.getIconURI("sap-icon://person-placeholder")));o.setTitle(sap.ushell.Container.getUser().getFullName());}var p=new sap.m.Page('detail'+c.getId(),{content:[o,c],showHeader:false});p.addStyleClass("sapUsheUserSettingDetaildPage");p.onAfterRendering=function(){b._handleNavButton();};v.aDanglingControls.push(p);v.getModel().setProperty(a+"/contentResult",p);v.getSplitApp().addDetailPage(p);b.navToDetail(p.getId());},getUserImage:function(d){var u=sap.ushell.Container.getUser().getImage();return u?u:d;},getListPressHandler:function(s,a){var t=this,i=true,b=s.getBindingContext().getPath(),v=this.getView(),c=v.getModel().getProperty(b+"/contentResult"),B=null,S=true,I=false,d=v.getModel().getProperty(b),f=d.contentFunc,C,k;if(sap.ui.Device.system.phone){s.setSelected(false);}if(c){t.navToDetail(c.getId(),a);t._handleNavButton();}else{if(typeof f==="function"){v.getModel().setProperty(b+"/isDirty",true);C=f();C.done(function(e){S=false;if(I===true){B.destroy();}if(e instanceof sap.ui.core.Control){t.createDetailPage.apply(t,[d.entryHelpID,b,d.title,e]);}else{i=false;}});C.fail(function(){S=false;if(I===true){B.destroy();}i=false;});C.always(function(){if(i===false){var e=new sap.m.FlexBox("userPrefErrorFlexBox",{height:"5rem",alignItems:sap.m.FlexAlignItems.Center,justifyContent:sap.m.FlexJustifyContent.Center,items:[new sap.m.Text("userPrefErrorText",{text:v.translationBundle.getText("loadingErrorMessage")})]});v.aDanglingControls.push(e);v.getModel().setProperty(b+"/contentResult",e);v.getSplitApp().addDetailPage(e);t.navToDetail(e.getId());}});if(S===true){B=new sap.m.BusyIndicator('userPrefLoadingBusyIndicator',{size:"2rem"});this.aDanglingControls.push(B);I=true;}}else{d.valueArgument().done(function(V){k=t._getKeyValueContent(d,V);t.createDetailPage(d.entryHelpID,b,d.title,k);}).fail(function(e){k=t._getKeyValueContent(d);t.createDetailPage(d.entryHelpID,b,d.title,k);});}}},_getKeyValueContent:function(e,E){var k,v,b,V=E?E:" ",f=sap.ui.Device.system.phone?'Start':'Center',F=sap.ui.Device.system.phone?'Wrap':'NoWrap',s=sap.ui.Device.system.phone?'Column':'Row';k=new sap.m.Label({text:e.title+":"}).addStyleClass('sapUshellUserSettingsDetailsKey');v=new sap.m.Input({value:V,editable:false}).addStyleClass('sapUshellUserSettingsDetailsValue');b=new sap.m.FlexBox({alignItems:f,wrap:F,direction:s,items:[k,v]});return b;},createMasterPages:function(){var t=this,e=t.getUserSettingsEntryTemplate();this.aDanglingControls=this.getView().aDanglingControls;this.oMasterEntryList=new sap.m.List('userSettingEnteryList',{items:{path:"/userPreferences/entries",template:e},mode:"SingleSelectMaster",select:function(a){t.getListPressHandler(a.getSource().getSelectedItem(),a.getId());}});var o=this.oMasterEntryList.onAfterRendering;this.oMasterEntryList.onAfterRendering=function(){var E=this.getItems();var a;o.apply(this,arguments);for(var i=0;i<E.length;i++){a=E[i].getBindingContext().getPath();t._setEntryValueResult(a);}if(!sap.ui.Device.system.phone){this.setSelectedItem(this.getItems()[0]);t.getListPressHandler(this.getSelectedItem());}};var p=new sap.m.Page("userSettingMaster",{showHeader:false,content:[this.oMasterEntryList]}).addStyleClass("sapUshellUserSettingMaster");t.aDanglingControls.push(this.oMasterEntryList,p);return p;},_setEntryValueResult:function(e){var v=this.getView(),m=v.getModel(),i=m.getProperty(e+"/editable"),a=m.getProperty(e+"/valueArgument"),V;if(typeof a==="function"){m.setProperty(e+"/valueResult",v.translationBundle.getText("genericLoading"));m.setProperty(e+"/editable",false);V=a();if(V){V.done(function(b){m.setProperty(e+"/editable",i);var c=true;if(m.getProperty(e+"/visible")!==undefined){c=m.getProperty(e+"/visible");}else if(m.getProperty(e+"/defaultVisibility")!==undefined){c=m.getProperty(e+"/defaultVisibility");}m.setProperty(e+"/visible",typeof(b)==='object'?!!b.value:c);m.setProperty(e+"/valueResult",typeof(b)==='object'?b.displayText:b);});V.fail(function(){m.setProperty(e+"/valueResult",v.translationBundle.getText("loadingErrorMessage"));});}}else if(!!a){m.setProperty(e+"/valueResult",a);m.setProperty(e+"/editable",i);}else{m.setProperty(e+"/valueResult",v.translationBundle.getText("loadingErrorMessage"));}},getUserSettingsEntryTemplate:function(){var t=this,i=new sap.m.StandardListItem({title:"{title}",description:"{valueResult}",icon:{path:"icon",formatter:function(e){if(e==="sap-icon://account"){e=t.getUserImage("sap-icon://account");}return e?e:"sap-icon://action-settings";}},type:sap.ui.Device.system.phone?"Navigation":"Inactive",visible:{parts:[{path:'visible'},{path:'defaultVisibility'},{path:'/userPreferences/profiling/length'}],formatter:function(v,d){if(this.getTitle()===sap.ushell.resources.i18n.getText("userProfiling")){var p=this.getModel().getProperty("/userPreferences/profiling");p.forEach(function(e,a){if(e.entryHelpID==="usageAnalytics"){if(!sap.ushell.Container.getService("UsageAnalytics").systemEnabled()||!sap.ushell.Container.getService("UsageAnalytics").isSetUsageAnalyticsPermitted()){p.splice(a,1);}}},this);return(p!==undefined&&p.length>0);}else{if(v!==undefined){return v;}else{return(d!==undefined)?d:true;}}}},customData:new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-label",value:{parts:[{path:'title'},{path:'valueResult'}],formatter:function(T,v){v=v?v:"";return T+" "+v;}},writeToDom:true})}).addStyleClass("sapUshellUserSettingMasterListItem");return i;},navToDetail:function(i,e){var v=this.getView(),s=v.getSplitApp();s.toDetail(i);if(e==="select"){this.applyFocus(i);}if(s.getMode()==="ShowHideMode"){s.hideMaster();}},applyFocus:function(i){if(!sap.ui.Device.phone){var e=jQuery.sap.byId(i).firstFocusableDomRef();if(e){jQuery.sap.focus(e);}}},onExit:function(){this.getView().aDanglingControls.forEach(function(c){if(c){if(c.destroyContent){c.destroyContent();}c.destroy();}});}});}());};if(!jQuery.sap.isDeclared('sap.ushell.services.AppConfiguration')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.AppConfiguration");function A(){var m={},c=null,C=null,I=[],a=[];sap.ui.getCore().getEventBus().subscribe("sap.ushell.renderers.fiori2.Renderer","appOpened",b,this);function b(e,E,D){C=D;if(a.length){for(var i=0;i<a.length;i++){a[i]();}a.length=0;}}this.addActivity=function(r){var u=sap.ushell.Container.getService("UserRecents");return u.addActivity(r);};this.getCurrentAppliction=function(o){return c;};this.getMetadata=function(o){if(!o){o=c;}if(o){var h=hasher&&hasher.getHash?hasher.getHash():'',k=this._processKey(h);if(!(m.hasOwnProperty(k))||!m[k].complete){this.addMetadata(o,k);}if(!m[k]){m[k]={complete:false};}if(!m[k].title){m[k].title=o.text||sap.ushell.resources.i18n.getText("default_app_title");}return m[k];}return{};};this._processKey=function(e){var i=e.split('?')[0],p=e.split('?')[1],S,P={},f,g='',h='',o;if(p){S=p.split('&');S.forEach(function(j){var k=j.split('=');P[k[0]]=k[1];});f=Object.keys(P).sort();f.forEach(function(k,j){h=j?'&':'?';g+=h+k+'='+P[k];});return i+g;}o=sap.ushell.Container.getService("URLParsing").parseShellHash(e);i=o?o.semanticObject+"-"+o.action:"";return i;};this.setCurrentApplication=function(o){c=o;if(a.length){a.length=0;}};this.setHeaderHiding=function(h){if(sap.ui.Device.system.phone){if(c===C){s(h);}else{a.push(function(){s(h);});}}else{jQuery.sap.log.warning("Application configuration could not be trigger setHeaderHiding on Shell as the running device is not a phone");}};function s(h){var r=sap.ushell.Container.getRenderer("fiori2");if(r){r.setHeaderHiding(h);}}this.addApplicationSettingsButtons=function(B){if(c&&C&&c.url&&C.url&&c.url===C.url){d(B);}else{a.push(function(){d(B);});}};function d(B){var i,e=[],r=sap.ushell.Container.getRenderer("fiori2");for(i=0;i<B.length;i++){var o=B[i];e.push(o.getId());o.setIcon(o.getIcon()||sap.ui.core.IconPool.getIconURI('customize'));if(sap.ushell.resources.i18n.getText("userSettings")===o.getProperty("text")){o.setProperty("text",sap.ushell.resources.i18n.getText("userAppSettings"));}o.setType(sap.m.ButtonType.Unstyled);}if(sap.ushell.Container&&r){if(I.length){r.hideActionButton(I,true);}I=e;r.showActionButton(e,true,undefined,true);}}this.setWindowTitle=function(t){window.document.title=t;};this.setIcons=function(i){jQuery.sap.setIcons(i);};this.getSettingsControl=function(){jQuery.sap.require("sap.ushell.ui.footerbar.SettingsButton");return new sap.ushell.ui.footerbar.SettingsButton();};this.getApplicationName=function(o){var M,e=(o&&o.additionalInformation)||null;if(e){M=/^SAPUI5\.Component=(.+)$/i.exec(e);if(M){return M[1];}}return null;};this.getApplicationUrl=function(o){var u=(o&&o.url)||null,S="P_TCODE",i;if(u){if(o.applicationType==="NWBC"&&u.indexOf(S)){return u;}i=u.indexOf("?");if(i>=0){u=u.slice(0,i);}if(u.slice(-1)!=='/'){u+='/';}}return u;};this.getPropertyValueFromConfig=function(o,p,r){var v;if(r&&o.hasOwnProperty(p+"Resource")){v=r.getText(o[p+"Resource"]);}else if(o.hasOwnProperty(p)){v=o[p];}return v;};this.getPropertyValueFromManifest=function(l,p,P){var M=p[P].manifestEntryKey,e=p[P].path,o=l.getManifestEntry(M);return jQuery.sap.getObject(e,undefined,o);};this.addMetadata=function(o,k){try{var e=this.getApplicationName(o),u=this.getApplicationUrl(o),l,f,p={"fullWidth":{"manifestEntryKey":"sap.ui","path":"fullWidth"},"hideLightBackground":{"manifestEntryKey":"sap.ui","path":"hideLightBackground"},"title":{"manifestEntryKey":"sap.app","path":"title"},"icon":{"manifestEntryKey":"sap.ui","path":"icons.icon"},"favIcon":{"manifestEntryKey":"sap.ui","path":"icons.favIcon"},"homeScreenIconPhone":{"manifestEntryKey":"sap.ui","path":"icons.phone"},"homeScreenIconPhone@2":{"manifestEntryKey":"sap.ui","path":"icons.phone@2"},"homeScreenIconTablet":{"manifestEntryKey":"sap.ui","path":"icons.tablet"},"homeScreenIconTablet@2":{"manifestEntryKey":"sap.ui","path":"icons.tablet@2"},"startupImage320x460":{"manifestEntryKey":"sap.ui","path":"icons.startupImage640x920"},"startupImage640x920":{"manifestEntryKey":"sap.ui","path":"icons.startupImage640x920"},"startupImage640x1096":{"manifestEntryKey":"sap.ui","path":"icons.startupImage640x1096"},"startupImage768x1004":{"manifestEntryKey":"sap.ui","path":"icons.startupImage768x1004"},"startupImage748x1024":{"manifestEntryKey":"sap.ui","path":"icons.startupImage748x1024"},"startupImage1536x2008":{"manifestEntryKey":"sap.ui","path":"icons.startupImage1536x2008"},"startupImage1496x2048":{"manifestEntryKey":"sap.ui","path":"icons.startupImage1496x2048"},"compactContentDensity":{"manifestEntryKey":"sap.ui5","path":"contentDensities.compact"},"cozyContentDensity":{"manifestEntryKey":"sap.ui5","path":"contentDensities.cozy"}},g,h,i,M,P,j,r,n=o&&o.componentHandle;if(k){if(!(m.hasOwnProperty(k))){m[k]={complete:false};}if(!m[k].complete){if(n){l=n.getMetadata();}else if(e){jQuery.sap.log.warning("No component handle available for '"+e+"'; SAPUI5 component metadata is incomplete",null,"sap.ushell.services.AppConfiguration");return;}if(l){f=l.getConfig();M=(l.getManifest()!==undefined);m[k].complete=true;if(f){j=f.resourceBundle||"";if(j){if(j.slice(0,1)!=='/'){j=u+j;}r=jQuery.sap.resources({url:j,locale:sap.ui.getCore().getConfiguration().getLanguage()});}}for(P in p){if(p.hasOwnProperty(P)){if(M){m[k][P]=this.getPropertyValueFromManifest(l,p,P);}if(f&&m[k][P]===undefined){m[k][P]=this.getPropertyValueFromConfig(f,P,r);}}}m[k].version=l.getVersion();m[k].libraryName=l.getLibraryName();}else if(sap.ushell.utils.isApplicationTypeNWBCRelated(o.applicationType)){var w="/~canvas;window=app/wda/",q=o.url.indexOf(w),W="/bc/gui/sap/its/webgui",t=o.url.indexOf(W);if(q>=0){m[k].libraryName=o.url.substring((q+w.length),o.url.indexOf("/",(q+w.length)));}m[k].complete=true;if(t>=0){var E="etransaction=",v=o.url.indexOf(E,t+W.length),x=o.url.indexOf("&",v),y=(x>=0)?x:o.url.length;m[k].libraryName=o.url.substring(v+E.length,y)+" (TCODE)";}}else{jQuery.sap.log.warning("No technical information for the given application could be determined",null,"sap.ushell.services.AppConfiguration");}}g=["favIcon","homeScreenIconPhone","homeScreenIconPhone@2","homeScreenIconTablet","homeScreenIconTablet@2","startupImage320x460","startupImage640x920","startupImage640x1096","startupImage768x1004","startupImage748x1024","startupImage1536x2008","startupImage1496x2048"];h=(u&&u[u.length-1]==='/')?u.substring(0,u.length-1):u;i=function(u){if(u.match(/^https?:\/\/.*/)){return false;}return u&&u[0]!=='/';};g.forEach(function(B){var O=m[k][B],F=null;if(O){F=i(O)?h+"/"+O:O;}m[k][B]=F;});}}catch(z){jQuery.sap.log.warning("Application configuration could not be parsed");}};}sap.ushell.services.AppConfiguration=new A();}());};if(!jQuery.sap.isDeclared('sap.ushell.services.AppState')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.AppState");var S,a,W=50;sap.ushell.services.AppState=function(A,c,p,C){this._oConfig=C;this._sSessionKey="";this._oAdapter=new sap.ushell.services.AppState.SequentializingAdapter(A);this._oAdapter=new sap.ushell.services.AppState.WindowAdapter(this,this._oAdapter,C);};sap.ushell.services.AppState.prototype._getSessionKey=function(){if(!this._sSessionKey){this._sSessionKey=this._getGeneratedKey();}return this._sSessionKey;};sap.ushell.services.AppState.prototype.getAppState=function(k){var d=new jQuery.Deferred(),t=this,A;this._loadAppState(k).done(function(k,D){A=new sap.ushell.services.AppState.AppState(t,k,false,D);d.resolve(A);}).fail(function(m){A=new sap.ushell.services.AppState.AppState(t,k);d.resolve(A);});return d.promise();};sap.ushell.services.AppState.prototype._getGeneratedKey=function(){var s=sap.ushell.Container.getService("Personalization").getGeneratedKey();s=("AS"+s).substring(0,40);return s;};sap.ushell.services.AppState.prototype.createEmptyAppState=function(c,t){var k=this._getGeneratedKey(),A,s="",b="";if(c){if(!(c instanceof sap.ui.core.UIComponent)){throw new Error("oComponent passed must be a UI5 Component");}if(c.getMetadata&&c.getMetadata()&&typeof c.getMetadata().getName==="function"){s=c.getMetadata().getName()||"";}if(!s&&c.getMetadata&&c.getMetadata().getLibraryName){s=c.getMetadata().getLibraryName();}if(c.getMetadata&&c.getMetadata()&&typeof c.getMetadata().getManifest==="function"&&typeof c.getMetadata().getManifest()==="object"&&typeof c.getMetadata().getManifest()["sap.app"]==="object"){b=c.getMetadata().getManifest()["sap.app"].ach||"";}}A=new sap.ushell.services.AppState.AppState(this,k,true,undefined,s,b,t);return A;};sap.ushell.services.AppState.prototype.createEmptyUnmodifiableAppState=function(c){var k=this._getGeneratedKey(),A;A=new sap.ushell.services.AppState.AppState(this,k,false);return A;};a=function(){var d=new jQuery.Deferred();this._oServiceInstance._saveAppState(this._sKey,this._sData,this._sAppName,this._sACHComponent,this._bTransient).done(function(){d.resolve();}).fail(function(m){d.reject(m);});return d.promise();};sap.ushell.services.AppState.AppState=function(s,k,m,d,A,b,t){this._oServiceInstance=s;this._sKey=k;this._sData=d;this._sAppName=A;this._sACHComponent=b;this._bTransient=t;if(m){this.setData=function(D){try{this._sData=JSON.stringify(D);}catch(e){jQuery.sap.log.error("Data can not be serialized","sap.ushell.services.AppState.AppState");this._sData=undefined;}};this.save=a.bind(this);}};sap.ushell.services.AppState.AppState.prototype.getData=function(){var o;if(this._sData===undefined||this._sData===""){return undefined;}try{o=JSON.parse(this._sData);}catch(e){jQuery.sap.log.error("Could not parse ["+this._sData+"]"+e);}return o;};sap.ushell.services.AppState.AppState.prototype.getKey=function(){return this._sKey;};sap.ushell.services.AppState.prototype._saveAppState=function(k,d,A,c,t){var s=this._getSessionKey();return this._oAdapter.saveAppState(k,s,d,A,c,t);};sap.ushell.services.AppState.prototype._loadAppState=function(k){return this._oAdapter.loadAppState(k);};function L(c){this.index=-1;this.capacity=c;this.array=[];}L.prototype._clear=function(){this.array=[];this.index=-1;};L.prototype.addAsHead=function(k,v){this.index=(this.index+1)%this.capacity;this.array[this.index]={key:k,value:v};};L.prototype.getByKey=function(k){var i,e;for(i=0;i<=this.capacity-1;i=i+1){e=(this.capacity+this.index-i)%this.capacity;if(this.array[e]&&this.array[e].key===k){return this.array[e];}}return undefined;};sap.ushell.services.AppState.WindowAdapter=function(s,b,c){var i=c&&c.config&&c.config.initialAppStates||{};var I=c&&c.config&&c.config.initialAppStatesPromise;this._oServiceInstance=s;this._oBackendAdapter=b;if(!sap.ushell.services.AppState.WindowAdapter.prototype.data){sap.ushell.services.AppState.WindowAdapter.prototype.data=new L(W);}if(I){I.then(function(i){if(typeof i==="object"){Object.keys(i).forEach(function(k){sap.ushell.services.AppState.WindowAdapter.prototype.data.addAsHead(k,i[k]);});}});}Object.keys(i).forEach(function(k){sap.ushell.services.AppState.WindowAdapter.prototype.data.addAsHead(k,i[k]);});};sap.ushell.services.AppState.WindowAdapter.prototype.saveAppState=function(k,s,d,A,c,t){this.sComponent=c;var D=new jQuery.Deferred();sap.ushell.services.AppState.WindowAdapter.prototype.data.addAsHead(k,d);if(this._oBackendAdapter&&!t){return this._oBackendAdapter.saveAppState(k,s,d,A,c);}D.resolve();return D.promise();};sap.ushell.services.AppState.WindowAdapter.prototype.loadAppState=function(k){var d=new jQuery.Deferred(),b=sap.ushell.services.AppState.WindowAdapter.prototype.data.getByKey(k);if(b){setTimeout(function(){d.resolve(k,b.value);},0);return d.promise();}if(this._oBackendAdapter){this._oBackendAdapter.loadAppState(k).done(function(k,D){sap.ushell.services.AppState.WindowAdapter.prototype.data.addAsHead(k,D);d.resolve(k,D);}).fail(d.reject.bind(d));return d.promise();}d.reject("AppState.js loadAppState: Application State could not be loaded");return d.promise();};S=function(){this.oLastPromise=new jQuery.Deferred();this.oLastPromise.resolve();};S.prototype.addToQueue=function(f){var n=new jQuery.Deferred();this.oLastPromise.always(function(){var r=f();r.done(function(){n.resolve.apply(n,arguments);}).fail(function(){n.reject.apply(n,arguments);});});this.oLastPromise=n;return n.promise();};sap.ushell.services.AppState._getSequentializer=function(){return new S();};sap.ushell.services.AppState.SequentializingAdapter=function(u){this._oSequentializer=new S();this._oUnderlyingAdapter=u;};sap.ushell.services.AppState.SequentializingAdapter.prototype.saveAppState=function(k,s,d,A,c){var f;f=this._oUnderlyingAdapter.saveAppState.bind(this._oUnderlyingAdapter,k,s,d,A,c);return this._oSequentializer.addToQueue(f);};sap.ushell.services.AppState.SequentializingAdapter.prototype.loadAppState=function(k){return this._oUnderlyingAdapter.loadAppState(k);};}());};if(!jQuery.sap.isDeclared('sap.ushell.services.NavTargetResolution')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.NavTargetResolution");sap.ushell.services.NavTargetResolution=function(A,c,p,s){var S=s&&s.config,I=function(){return!!(S&&S.enableClientSideTargetResolution);},r=function(h){var o=I()?this._resolveHashFragmentClientSide(h):A.resolveHashFragment(h);return o;},l,R=[{name:"DefaultAdapter",isApplicable:function(){return true;},resolveHashFragment:r.bind(this)}],C;this._isClientSideTargetResolutionEnabled=I;this._nextResolveHashFragment=function(a,h){var o,f;o=a.pop();if(o.isApplicable(h)){jQuery.sap.log.info("NavTargetResolution: custom resolver "+o.name+" resolves "+h);f=this._nextResolveHashFragment.bind(this,a);return o.resolveHashFragment(h,f);}return this._nextResolveHashFragment(a,h);};this._resolveHashFragmentClientSide=function(h){var H=this._validateHashFragment(h),f;if(!H.success){return new jQuery.Deferred().reject(h+" is not a valid hash fragment").promise();}f=H.hashFragmentWithoutHash;return this._resolveHashFragmentClientSideAndFixApplicationType(f);};this._resolveHashFragmentClientSideAndFixApplicationType=function(f){var d=new jQuery.Deferred();sap.ushell.Container.getService("ClientSideTargetResolution").resolveHashFragment(f).done(function(o){if(o&&o.applicationType==="SAPUI5"){o.applicationType="URL";}d.resolve(o);}).fail(function(){d.reject.apply(d,arguments);});return d.promise();};this._validateHashFragment=function(h){var H="",v={success:false};if(h&&h.charAt(0)!=="#"){throw new sap.ushell.utils.Error("Hash fragment expected in _validateHashFragment","sap.ushell.services.NavTargetResolution");}H=h.substring(1);if(H){v.success=true;}v.hashFragmentWithoutHash=H;return v;};this.expandCompactHash=function(h){var u=sap.ushell.Container.getService("URLParsing"),P,d=new jQuery.Deferred();P=u.parseShellHash(h);if(P&&P.params&&P.params["sap-intent-param"]){sap.ushell.Container.getService("AppState").getAppState(P.params["sap-intent-param"][0]).done(function(o){var v=o.getData("sap-intent-param"),H=h;if(v){H=sap.ushell.Container.getService("URLShortening").expandParamGivenRetrievalFunction(h,"sap-intent-param",function(){return v;});}d.resolve(H);}).fail(function(){d.resolve(h);});}else{d.resolve(h);}return d.promise();};var w=["NWBC","WDA","TR"];this._getNavigationMode=function(o){var a=o.additionalInformation,b=o.applicationType,d=sap.ushell.services.AppConfiguration.getCurrentAppliction()||{},u,U;if(o.navigationMode){return o.navigationMode;}if(w.indexOf(d.applicationType)>-1&&!d.explicitNavMode){return'newWindowThenEmbedded';}if((a===null||typeof a==="string"||typeof a==="undefined")&&b==="URL"){if(a&&a.indexOf("managed=")===0){if(a==="managed=FioriWave1"){return"embedded";}if(a==="managed="){return"newWindow";}return undefined;}if(a&&a.indexOf("SAPUI5.Component=")===0){u="[a-zA-Z0-9_]+";U=["^SAPUI5.Component=",u,"([.]",u,")*$"].join("");if(!(new RegExp(U)).test(a)){jQuery.sap.log.warning(["The UI5 component name in",a,"is not valid.","Please use names satisfying",U].join(" "));}return"embedded";}return"newWindow";}if(b==="NWBC"||b==="TR"){return"newWindowThenEmbedded";}return undefined;};this._adjustResolutionResultForUi5Components=function(o){var m,a;if(typeof o!=="object"){return;}delete o["sap.platform.runtime"];if(o&&o.applicationType&&o.applicationType==="SAPUI5"){o.applicationType="URL";}if((o.applicationType==="URL")){m=/^SAPUI5\.Component=(.*)/.exec(o.additionalInformation);a=m&&m[1];if(a){o.ui5ComponentName=a;}}};this._getSapSystem=function(h,o){var a;if(o&&o["sap-system"]){return o["sap-system"];}if(o&&o.url){a=jQuery.sap.getUriParameters(o.url).get("sap-system");if(a){return a;}}if(w.indexOf(o.applicationType)>=0&&h&&h.substring(1)){a=jQuery.sap.getUriParameters(h.substring(1)).get("sap-system");if(a){return a;}}return undefined;};this.resolveHashFragment=function(h){var d=new jQuery.Deferred(),a=/sap-ushell-enc-test=([^&]*)(&.*)?$/,m,b,e,t=this;sap.ushell.utils.addTime("resolveHashFragment");jQuery.sap.measure.average("sap.ushell.navigation.resolveHashFragment");this.expandCompactHash(h).done(function(H){if(H.indexOf("sap-ushell-enc-test")>=0){m=a.exec(H);if(m){b=m[1];if(b!=="A%20B%2520C"){sap.ushell.Container.getService("Message").error("This navigation is flagged as erroneous because"+" (likely the calling procedure) generated a wrong encoded hash."+" Please track down the encoding error and make sure to use the CrossApplicationNavigation service for navigation.","Navigation encoding wrong");}H=H.replace(/sap-ushell-enc-test=([^&]*)&/,"");H=H.replace(/(&|\?)sap-ushell-enc-test=([^&]*)$/,"");}}var P=t._invokeResolveHashChain(H);if(typeof A.processPostResolution==="function"){P=A.processPostResolution(H,P);}P.done(function(o){t._adjustResolutionResultForUi5Components(o);if(jQuery.isPlainObject(o)&&!o.hasOwnProperty("navigationMode")){o.navigationMode=t._getNavigationMode(o);}if(jQuery.isPlainObject(o)&&!o.hasOwnProperty("sap-system")){e=t._getSapSystem(h,o);if(e){o["sap-system"]=e;}}jQuery.sap.measure.end("sap.ushell.navigation.resolveHashFragment");sap.ushell.services.AppConfiguration.setCurrentApplication(o);d.resolve(o);}).fail(function(M){d.reject(M);});}).fail(function(M){d.reject(M);});return d.promise();};this._invokeResolveHashChain=function(h){var o=R.map(function(a){return a;});return this._nextResolveHashFragment(o,h).done(function(a){C=a;});};this.baseResolveHashFragment=r.bind(this);this._getGetLinksResolver=function(a){var g;if(this._isClientSideTargetResolutionEnabled()){g=this._getLinksClientSide.bind(this);return{resolver:g,warning:undefined,isGetSemanticObjectLinksCall:false};}g=A&&A.getLinks&&A.getLinks.bind(A);if(g){return{resolver:g,warning:undefined,isGetSemanticObjectLinksCall:false};}g=A&&A.getSemanticObjectLinks&&A.getSemanticObjectLinks.bind(A);if(g){return{resolver:g,warning:a.hasOwnProperty("action")?"the action argument was given, however, NavTargetResolutionAdapter does not implement getLinks method. Action will be ignored.":undefined,isGetSemanticObjectLinksCall:true};}return{resolver:undefined,warning:"Cannot determine resolver for getLinks method",isGetSemanticObjectLinksCall:undefined};};this.getLinks=function(a){var t=this;var b=a.semanticObject,P=a.params,i=a.ignoreFormFactor,o=a.ui5Component,d=a.appStateKey,e=a.compactIntents;var f,h,g=new jQuery.Deferred(),j,k;if(/\?/.test(b)){throw new Error("Parameter must not be part of semantic object");}f=(P===undefined)?undefined:JSON.parse(JSON.stringify(P));if(d){f=f||{};f["sap-xapp-state"]=encodeURIComponent(d);}h={target:{semanticObject:b,action:"dummyAction"},params:f};j=sap.ushell.Container.getService("ShellNavigation");j.hrefForExternal(h,true,o,true).done(function(m){f=m.params||f;var n=t._getGetLinksResolver(a);if(n.warning){jQuery.sap.log.warning("A problem occurred while determining the resolver for getLinks",n.warning,"sap.ushell.services.NavTargetResolution");}k=n.resolver;if(k){var H=function(E){g.reject(E);};var q=function(u){if(e){t._shortenGetSemanticObjectLinksResults(u,o).done(function(v){g.resolve(v);});}else{g.resolve(u);}};if(n.isGetSemanticObjectLinksCall){k(b,f,i).done(q).fail(H);}else{k(a).done(q).fail(H);}}else{g.resolve([]);}}).fail(function(m){g.reject(m);});return g.promise();};this.getDistinctSemanticObjects=function(){if(this._isClientSideTargetResolutionEnabled()){var o=sap.ushell.Container.getService("ClientSideTargetResolution");return o.getDistinctSemanticObjects();}if(A&&A.getDistinctSemanticObjects){return A.getDistinctSemanticObjects.call(A);}jQuery.sap.log.error("Cannot execute getDistinctSemanticObjects method","ClientSideTargetResolution must be enabled or NavTargetResolutionAdapter must implement getDistinctSemanticObjects method","sap.ushell.services.NavTargetResolution");return new jQuery.Deferred().reject("Cannot execute getDistinctSemanticObjects").promise();};this._getLinksClientSide=function(a){var d=new jQuery.Deferred(),o=new jQuery.Deferred(),u=sap.ushell.Container.getService("URLParsing");if((a.params||{}).hasOwnProperty("sap-intent-param")){var b="#"+a.semanticObject+"-"+"dummyAction?"+u.paramsToString(a.params);this.expandCompactHash(b).done(function(e){o.resolve(u.parseShellHash(e).params);}).fail(d.reject.bind(d));}else{o.resolve(a.params);}o.done(function(e){sap.ushell.Container.getService("ClientSideTargetResolution").getLinks(a).done(d.resolve.bind(d)).fail(d.reject.bind(d));});return d.promise();};this._shortenGetSemanticObjectLinksResults=function(g,o){var t=this,a=[],i=0,P=g.length,u=sap.ushell.Container.getService("URLParsing"),b=sap.ushell.Container.getService("ShellNavigation"),d=new jQuery.Deferred();g.forEach(function(e){var U=u.parseShellHash(e.intent),f=b.compactParams(U.params,undefined,o);a.push(f);a[i].done(function(h,j){a[h]={text:e.text,intent:"#"+U.semanticObject+"-"+U.action+"?"+u.paramsToString(j)};}.bind(t,i)).fail(function(h,m){jQuery.sap.log.warning("Cannot shorten GetSemanticObjectLinks result, using expanded form","Failure message: "+m+"; intent had title ''"+e.title+"'' and link ''"+e.intent+"'","sap.ushell.services.NavTargetResolution");a[h]={text:e.text,intent:e.intent};}.bind(t,i)).always(function(){P--;if(P===0){d.resolve(a);}});i++;});return d.promise();};this.isIntentSupported=function(i){var m={},o;if(this._isClientSideTargetResolutionEnabled()){o=sap.ushell.Container.getService("ClientSideTargetResolution");return o.isIntentSupported(i);}if(A.isIntentSupported){return A.isIntentSupported(i);}i.forEach(function(a){m[a]={supported:undefined};});return(new jQuery.Deferred()).resolve(m).promise();};this.isNavigationSupported=function(i){var u=sap.ushell.Container.getService("URLParsing"),d=new jQuery.Deferred(),a=[];a=i.map(function(o){if(typeof o==="string"){return o;}return"#"+u.constructShellHash(o);});this.isIntentSupported(a).done(function(o){var b=a.map(function(e){return o[e]||{supported:false};});d.resolve(b);}).fail(d.reject.bind(d));return d.promise();};this.registerCustomResolver=function(o){if(typeof o.name!=="string"){jQuery.sap.log.error("NavTargetResolution: Custom Resolver must have name {string} member");return false;}if(typeof o.isApplicable!=="function"){jQuery.sap.log.error("NavTargetResolution: Custom Resolver must have isApplicable member");return false;}if(typeof o.resolveHashFragment!=="function"){jQuery.sap.log.error("NavTargetResolution: Custom Resolver must have \"resolveHashFragment\" member");return false;}R.push(o);return true;};if(S&&jQuery.isArray(S.resolveLocal)){l=S.resolveLocal.map(function(a){return a.linkId;});this.registerCustomResolver({name:"localResolveNavigationResolver",cleanHash:function(h){if(h===""){return"#";}var a=sap.ushell.Container.getService("URLParsing").parseShellHash(h.substring(1));if(!a){return"#";}h="#"+a.semanticObject+"-"+a.action;return h;},_getIndex:function(o){var h=this.cleanHash(o);return l.indexOf(h.substring(1));},isApplicable:function(o){return this._getIndex(o)>=0;},resolveHashFragment:function(h){var d,i=this._getIndex(h),o,a,b,n;d=new jQuery.Deferred();o=JSON.parse(JSON.stringify(S.resolveLocal[i].resolveTo));a=sap.ushell.Container.getService("URLParsing").parseShellHash(h);if(a&&a.params){n=sap.ushell.Container.getService("URLParsing").paramsToString(a.params);if(n){b=o.url.indexOf('?')>=0;o.url=o.url+(b?"&":"?")+n;}}d.resolve(o);return d.promise();}});}this.registerCustomResolver({name:"StandaloneLocalResolver",aElement:undefined,cleanHash:function(h){if(h===""){return undefined;}var a=sap.ushell.Container.getService("URLParsing").parseShellHash(h.substring(1));if(!a){return undefined;}h="#"+a.semanticObject+"-"+a.action;return h;},isRunStandaloneHash:function(h){return typeof h==="string"&&h.indexOf("#Shell-runStandaloneApp")===0;},isApplicable:function(h){h=this.cleanHash(h);if(!h){return false;}return h==="#Test-url"||h==="#Test-local1"||h==="#Test-local2"||h==="#Test-config"||h==="#Test-clear"||this.isRunStandaloneHash(h);},parseUrl:function(u){if(!this.aElement){this.aElement=window.document.createElement('a');}this.aElement.href=u;return this.aElement;},resolveHashFragment:function(h){var d=new jQuery.Deferred(),b=null,t=this,e,P,L,f,g,n,i,o,F=h,u;h=this.cleanHash(h);if(!h){return false;}b={"#Test-config":{applicationType:"URL",url:"/sap/bc/ui5_ui5/ui2/ushell/test-resources/sap/ushell/demoapps/FioriSandboxConfigApp",additionalInformation:"SAPUI5.Component=sap.ushell.demoapps.FioriSandboxConfigApp"},"none":{applicationType:"URL",url:"",additionalInformation:""}};function j(K){if(localStorage){return localStorage[K];}return undefined;}function k(o,K){var e={},a;for(a in o){if(o.hasOwnProperty(a)){if(a!==K){e[a]=o[a];}}}return e;}function m(U){if(sap.ushell.utils.calculateOrigin(t.parseUrl(U))!==sap.ushell.utils.calculateOrigin(window.location)){return undefined;}var a=(new URI(t.parseUrl(U).href)).normalizePathname().pathname(),y=jQuery.sap.getObject("runStandaloneAppFolderWhitelist",0,S),E;if(!y){return undefined;}for(E in y){if(y.hasOwnProperty(E)){if(y[E]){if(E==="*"||a.indexOf((new URI(t.parseUrl(E).href)).normalizePathname().pathname())===0){return U;}}}}return undefined;}function q(K){return jQuery.sap.getUriParameters().get(K);}function v(a,K){return(a.params&&a.params[K]&&a.params[K][0])||q(K);}function x(K,V){if(localStorage){localStorage[K]=V;}}if(b[h]){e=b[h];}else if(h==="#Test-clear"){x("sap.ushell.#Test-local1",undefined);x("sap.ushell.#Test-local2",undefined);jQuery.sap.log.info("NavTargetResolution: Local storage keys for #Test have been cleared");e=b["#Test-config"];}else if(this.isRunStandaloneHash(h)){L={applicationType:"URL"};P=sap.ushell.Container.getService("URLParsing").parseShellHash(F);f=(v(P,"sap-ushell-SAPUI5.Component")&&"SAPUI5.Component="+v(P,"sap-ushell-SAPUI5.Component"))||(v(P,"sap-ushell-additionalInformation"));u=v(P,"sap-ushell-url")||"";o=k(P.params,"sap-ushell-SAPUI5.Component");o=k(o,"sap-ushell-additionalInformation");o=k(o,"sap-ushell-url");n=sap.ushell.Container.getService("URLParsing").paramsToString(o);i=u.indexOf('?')>=0;if(n){u=u+(i?(((u[u.length-1]!=="&")&&"&")||""):"?")+n;}L.url=m(u);L.additionalInformation=f;e=L;}else if(h==="#Test-local1"||h==="#Test-local2"||h==="#Test-url"){e=j("sap.ushell."+h);if(!e||e==="undefined"){L={applicationType:"URL"};}else{L=JSON.parse(e);}if((window.location.hostname==="localhost")||(S&&S.allowTestUrlComponentConfig)){g="sap-ushell-test-"+h.substring(6);f=q(g+"-additionalInformation");if(f){L.additionalInformation=f;}u=q(g+"-url");if(u){L.url=m(u);}}if(!L.url){jQuery.sap.log.info("NavTargetResolution: No configured app for "+h+" found ( local storage or url params sap-ushell-test-local1-url  sap-ushell-test-local1-additionalInfo  not supplied? ");jQuery.sap.log.info("NavTargetResolution: Defaulting to config app ...\n");d.reject("URL is not resolvable");return d.promise();}L.url=m(L.url);e=L;}if(e.url===undefined){d.reject("URL is not resolvable");return d.promise();}jQuery.sap.log.info("NavTargetResolution: As URL:  http://localhost:8080/sap/bc/ui5_ui5/ui2/ushell/shells/abap/FioriLaunchpad.html?sap-ushell-test-local1-url="+encodeURIComponent((e&&e.url)||"")+"&sap-ushell-test-local1-additionalInformation="+encodeURIComponent((e&&e.additionalInfo)||"")+"#Test-local1");jQuery.sap.log.info("NavTargetResolution: Resolving "+h+" to "+JSON.stringify(e));d.resolve(e);return d.promise();}});this.getCurrentResolution=function(){return C;};};}());};if(!jQuery.sap.isDeclared('sap.ushell.services.Personalization')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.Personalization");jQuery.sap.require('sap.ui.core.format.DateFormat');var c="sap.ushell.personalization#",I="ITEM#",v="VARIANTSET#",A="yyyyMMddHHmmss",d="ADMIN#",f="sap-ushell-container-scope",g="sap-ushell-container-storageUTCTimestamp",h="sap-ushell-container-expireUTCTimestamp";function j(C){return c+C;}sap.ushell.services.Personalization=function(a,C,P,b){this._oConfig=b;this._sSeed=jQuery.sap.getObject("config.seed",undefined,b)||"ABC";this._oAdapterWithBackendAdapter=new sap.ushell.services.Personalization.WindowAdapter(this,a);this._oAdapterWindowOnly=new sap.ushell.services.Personalization.WindowAdapter(this,undefined);this._supportsGetWithoutSubsequentLoad=(a&&a.supportsGetWithoutSubsequentLoad===true);this._oContainerMap=new sap.ushell.utils.Map();this._oPendingOperationsMap=new sap.ushell.utils.Map();};sap.ushell.services.Personalization.prototype.SAVE_DEFERRED_DROPPED="Deferred save dropped (OK) - Data superseeded by subsequent save";sap.ushell.services.Personalization.prototype.constants={keyCategory:{"FIXED_KEY":"FIXED_KEY","GENERATED_KEY":"GENERATED_KEY"},writeFrequency:{"HIGH":"HIGH","LOW":"LOW"}};sap.ushell.services.Personalization.prototype.getGeneratedKey=function(){var C="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",D=new Date().getTime().toString(),r="",s,a=0,i;while(this._sSeed.length<40){this._sSeed=this._sSeed+Math.random().toString().substring(2);}for(i=0;i<3;i=i+1){a=this._sSeed.charCodeAt(i)+31*a;a=a&a;r=r+C[Math.abs(a%36)];}s=Math.random().toString().substring(2)+D+Math.random().toString().substring(2)+D+"1234523413542345698772";for(i=0;i<37;i=i+1){a=this._sSeed.charCodeAt(i)+parseInt(s[i],10)+31*a;a=a&a;r=r+C[Math.abs(a%36)];}return r.substring(0,40);};sap.ushell.services.Personalization.prototype.getPersonalizer=function(P,s,C){return new sap.ushell.services.Personalizer(this,this._oAdapterWithBackendAdapter,P,s,C);};sap.ushell.services.Personalization.prototype.getTransientPersonalizer=function(){return new sap.ushell.services.TransientPersonalizer();};function k(e,a){var b;for(b in a){if(typeof a[b]!=='function'){if(a.hasOwnProperty(b)){if(b===e){return true;}}}}return false;}function l(s){var C=sap.ushell.services.Personalization.prototype.constants,D={validity:Infinity,keyCategory:C.keyCategory.GENERATED_KEY,writeFrequency:C.writeFrequency.HIGH,clientStorageAllowed:false};if(!s){return D;}D.validity=s&&s.validity;if(D.validity===null||D.validity===undefined||typeof D.validity!=="number"){D.validity=Infinity;}if(!(typeof D.validity==="number"&&((D.validity>=0&&D.validity<1000)||D.validity===Infinity))){D.liftime=Infinity;}D.keyCategory=k(s.keyCategory,C.keyCategory)?s.keyCategory:D.keyCategory;D.writeFrequency=k(s.writeFrequency,C.writeFrequency)?s.writeFrequency:D.writeFrequency;if(typeof s.clientStorageAllowed==='boolean'&&(s.clientStorageAllowed===true||s.clientStorageAllowed===false)){D.clientStorageAllowed=s.clientStorageAllowed;}return D;}function m(C,s,_,a){var P="",L,b;if(typeof C!=="string"){throw new sap.ushell.utils.Error("sContainerKey is not a string: sap.ushell.services.Personalization"," ");}if(C.length>40){jQuery.sap.log.error("Personalization Service container key (\""+C+"\") should be less than 40 characters [current :"+C.length+"]");}s=this._adjustScope(s);P=j(C);L=window["sap-ushell-config"]&&window["sap-ushell-config"].services&&window["sap-ushell-config"].services.ShellNavigation&&window["sap-ushell-config"].services.ShellNavigation.config&&window["sap-ushell-config"].services.ShellNavigation.config.reload;b=_;if(s&&s.validity===0){if(L){s.validity=1440;}else{b=a;}}return{oAdapterForScope:b,oScope:s,sPrefixedContainerKey:P};}sap.ushell.services.Personalization.prototype.getContainer=function(C,s,a){return this._createContainer(C,s,false,a);};sap.ushell.services.Personalization.prototype.createEmptyContainer=function(C,s,a){return this._createContainer(C,s,true,a);};sap.ushell.services.Personalization.prototype._createContainer=function(C,s,b,a){var D=new jQuery.Deferred(),r,L,e;r=this._adjustScopePickAdapter(C,s,this._oAdapterWithBackendAdapter,this._oAdapterWindowOnly);e=new sap.ushell.services.Personalization.ContextContainer(this,r.oAdapterForScope,r.sPrefixedContainerKey,r.oScope,a);if(b&&this._supportsGetWithoutSubsequentLoad){L=new jQuery.Deferred();L.resolve(e);}else{L=e.load();}L.fail(function(){D.reject();}).done(function(){if(b||e._isExpired()){e.clear();}D.resolve(e);});return D.promise();};sap.ushell.services.Personalization.prototype.delContainer=function(C,s){var D={},P,a="",t=this;s=t._adjustScope(s);a=j(C);D=new jQuery.Deferred();P=t._pendingContainerOperations_cancelAddNext(C,null);P.always(function(){t.getContainer(C,s).fail(function(){t._pendingContainerOperations_cancelAddNext(C,D);D.reject();}).done(function(b){var e;t._pendingContainerOperations_cancelAddNext(C,D);if(s.validity===0){e=t._oAdapterWindowOnly;}else{e=t._oAdapterWithBackendAdapter;}e.delAdapterContainer(a,s).fail(function(){D.reject();}).done(function(){D.resolve();});});});return D.promise();};sap.ushell.services.Personalization.prototype._pendingContainerOperations_flushAddNext=function(C,D){var P,s;P=this._oPendingOperationsMap.get(C);if(!P){P=new jQuery.Deferred();P.resolve();}if(D!==null){this._oPendingOperationsMap.put(C,D);}if(!P||P.state()!=="pending"){return P;}clearTimeout(P._sapTimeoutId);P._sapTimeoutId=undefined;if(typeof P._sapFnSave==="function"){s=P._sapFnSave;P._sapFnSave=undefined;s();}return P;};sap.ushell.services.Personalization.prototype._pendingContainerOperations_cancelAddNext=function(C,D){var P;P=this._oPendingOperationsMap.get(C);if(!P){P=new jQuery.Deferred();P.resolve();}if(D!==null){this._oPendingOperationsMap.put(C,D);}if(!P||P.state()!=="pending"){return P;}if(P._sapTimeoutId){clearTimeout(P._sapTimeoutId);P._sapTimeoutId=undefined;P.resolve(sap.ushell.services.Personalization.prototype.SAVE_DEFERRED_DROPPED);}return P;};sap.ushell.services.Personalization.prototype.getPersonalizationContainer=function(C){var P="",a={},D={};if(typeof C!=="string"){throw new sap.ushell.utils.Error("sContainerKey is not a string: sap.ushell.services.Personalization"," ");}P=j(C);if(this._oContainerMap.containsKey(P)){return this._oContainerMap.get(P).promise();}D=new jQuery.Deferred();a=new sap.ushell.services.PersonalizationContainer(this._oAdapterWithBackendAdapter,P);a.done(function(b){D.resolve(b);}).fail(function(b){D.reject(b);});this._oContainerMap.put(P,D);return D.promise();};sap.ushell.services.Personalization.prototype.delPersonalizationContainer=function(C){var D={},P="",t=this;P=j(C);D=new jQuery.Deferred();this.getPersonalizationContainer(C).fail(function(){D.reject();}).done(function(a){t._oAdapterWithBackendAdapter.delAdapterContainer(P).fail(function(){D.reject();}).done(function(){t._oContainerMap.remove(P);D.resolve();});});return D.promise();};sap.ushell.services.Personalization.prototype._adjustScope=l;sap.ushell.services.Personalization.prototype._adjustScopePickAdapter=m;sap.ushell.services.Personalizer=function(s,a,P,S,C){this._sPersContainer="";this._sPersItem="";this._sPersVariant=null;this._oAdapter=a;this._oService=s;this._oScope=S;this._oComponent=C;if(!P||!P.container||!P.item||typeof P.container!=="string"||typeof P.item!=="string"){throw new sap.ushell.utils.Error("Invalid input for oPersId: sap.ushell.services.Personalization"," ");}this._sPersContainer=P.container;this._sPersItem=P.item;};sap.ushell.services.Personalizer.prototype._getContainer=function(P){if(!this._oGetContainerPromise){this._oGetContainerPromise=this._oService.getContainer(P,this._oScope,this._oComponent);}return this._oGetContainerPromise;};sap.ushell.services.Personalizer.prototype.getPersData=function(){var D={},t=this;D=new jQuery.Deferred();this._getContainer(this._sPersContainer).fail(function(){D.reject();}).done(function(C){D.resolve(C.getItemValue(t._sPersItem));});D.fail(function(){jQuery.sap.log.error("Fail to get Personalization data for Personalizer container: "+t._sPersContainer);});return D.promise();};sap.ushell.services.Personalizer.prototype.setPersData=function(V){var D={},t=this;D=new jQuery.Deferred();this._getContainer(this._sPersContainer).fail(function(){D.reject();}).done(function(C){C.setItemValue(t._sPersItem,V);C.save().fail(function(){D.reject();}).done(function(){D.resolve();});});D.fail(function(){jQuery.sap.log.error("Fail to set Personalization data for Personalizer container: "+t._sPersContainer);});return D.promise();};sap.ushell.services.Personalizer.prototype.delPersData=function(){var D={},t=this,M;D=new jQuery.Deferred();this._oService.getPersonalizationContainer(this._sPersContainer).fail(function(){D.reject();}).done(function(C){C.delItem(t._sPersItem);C.save().fail(function(){D.reject();}).done(function(){D.resolve();});});M=D.promise();M.fail(function(){jQuery.sap.log.error("Fail to delete Personalization data for Personalizer container: "+this._sPersContainer);});return M;};sap.ushell.services.TransientPersonalizer=function(){this._oValue=undefined;};sap.ushell.services.TransientPersonalizer.prototype.getPersData=function(){var D;D=new jQuery.Deferred();D.resolve(this._oValue);return D.promise();};sap.ushell.services.TransientPersonalizer.prototype.setPersData=function(V){var D;D=new jQuery.Deferred();this._oValue=V;D.resolve();return D.promise();};sap.ushell.services.TransientPersonalizer.prototype.delPersData=function(){var D;D=new jQuery.Deferred();this._oValue=undefined;D.resolve();return D.promise();};sap.ushell.services.TransientPersonalizer.prototype.setValue=function(V){this._oValue=V;};sap.ushell.services.TransientPersonalizer.prototype.getValue=function(){return this._oValue;};sap.ushell.services.PersonalizationContainer=function(a,C){this._sContainerKey=C;this._oAdapterContainer={};this._aLoadedVariantSetKeys=[];this._aLoadedItemKeys=[];var D={},t=this;this._init();D=new jQuery.Deferred();if(!this._sContainerKey||typeof this._sContainerKey!=="string"){throw new sap.ushell.utils.Error("Invalid container key: sap.ushell.services.Personalization"," ");}this._oAdapterContainer=a.getAdapterContainer(this._sContainerKey);this.load().fail(function(){D.reject();}).done(function(){D.resolve(t);});return D.promise();};sap.ushell.services.PersonalizationContainer.prototype._init=function(){this._oVariantSetMap={};this._oItemMap={};this._aLoadedVariantSetKeys=[];this._aLoadedItemKeys=[];this._oVariantSetMap=new sap.ushell.utils.Map();this._oItemMap=new sap.ushell.utils.Map();};function n(O){if(O===undefined){return undefined;}try{return JSON.parse(JSON.stringify(O));}catch(e){return undefined;}}function o(O){if(O===undefined){return undefined;}try{return JSON.parse(O);}catch(e){return undefined;}}sap.ushell.services.PersonalizationContainer.prototype.load=function(){var D={},i=[],V=[],a=[],M=[],t=this;function b(a){var N=[],P=[];N=a.filter(function(s){return s.indexOf(I)!==0;});if(N.length===0){return a;}P=a.filter(function(s){return s.indexOf(I)===0;});N.forEach(function(s){var e={},q="";q=I+s;e=n(t._oAdapterContainer.getItemValue(s));t._oAdapterContainer.setItemValue(q,e);t._oAdapterContainer.delItem(s);if(jQuery.inArray(q,P)===-1){P.push(q);}});return P;}D=new jQuery.Deferred();if(!this._sContainerKey){throw new sap.ushell.utils.Error("Invalid container key: sap.ushell.services.Personalization"," ");}this._init();this._oAdapterContainer.load().fail(function(){D.reject();}).done(function(){i=t._oAdapterContainer.getItemKeys().splice(0);V=i.filter(function(s){return s.indexOf(v)===0;});V.forEach(function(s){var e={};e=new sap.ushell.services.PersonalizationContainerVariantSet(s,t._oAdapterContainer);t._oVariantSetMap.put(s,e);});a=i.filter(function(s){return s.indexOf(v)!==0;});M=b(a);M.forEach(function(s){t._oItemMap.put(s,n(t._oAdapterContainer.getItemValue(s)));});t._aLoadedVariantSetKeys=t._oVariantSetMap.keys().splice(0);t._aLoadedItemKeys=t._oItemMap.keys().splice(0);D.resolve();});return D.promise();};sap.ushell.services.PersonalizationContainer.prototype.save=function(){var s,i;this._serializeVariantSets();this._serializeItems();s=new jQuery.Deferred();function S(){s.resolve();}function a(){s.reject();}try{i=this._oAdapterContainer.save();i.fail(a);i.done(S);}catch(e){s.reject();}return s.promise();};sap.ushell.services.PersonalizationContainer.prototype.getItemKeys=function(){return this._oItemMap.keys().map(function(e){return e.replace(I,"","");});};sap.ushell.services.PersonalizationContainer.prototype.getItemValue=function(i){if(typeof i!=="string"){return undefined;}return this._oItemMap.get(I+i);};sap.ushell.services.PersonalizationContainer.prototype.containsItem=function(i){if(typeof i!=="string"){return undefined;}return this._oItemMap.containsKey(I+i);};sap.ushell.services.PersonalizationContainer.prototype.setItemValue=function(i,a){if(typeof i!=="string"){throw new sap.ushell.utils.Error("Parameter value of sItemKey is not a string: sap.ushell.services.Personalization"," ");}this._oItemMap.put(I+i,a);};sap.ushell.services.PersonalizationContainer.prototype.delItem=function(i){if(typeof i!=="string"){return undefined;}if(this.containsItem(i)){this._oItemMap.remove(I+i);}};sap.ushell.services.PersonalizationContainer.prototype._serializeItems=function(){var i=[],D=[],t=this;i=this._oItemMap.keys();i.forEach(function(s){t._oAdapterContainer.setItemValue(s,n(t._oItemMap.get(s)));});D=this._aLoadedItemKeys.filter(function(s){return!(i.indexOf(s)>-1);});D.forEach(function(s){t._oAdapterContainer.delItem(s);});};sap.ushell.services.PersonalizationContainer.prototype.getVariantSetKeys=function(){var V=[],P=[];P=this._oVariantSetMap.keys();V=P.map(function(e){return e.replace(v,"","");});return V;};sap.ushell.services.PersonalizationContainer.prototype.containsVariantSet=function(V){return this._oVariantSetMap.containsKey(v+V);};sap.ushell.services.PersonalizationContainer.prototype.getVariantSet=function(V){var P,a={};P=v+V;a=this._oVariantSetMap.get(P);return a;};sap.ushell.services.PersonalizationContainer.prototype.addVariantSet=function(V){var e={},a={},P="";if(this.containsVariantSet(V)){throw new sap.ushell.utils.Error("Container already contains a variant set with key '"+V+"': sap.ushell.services.Personalization"," ");}P=v+V;e={currentVariant:null,variants:{}};this._oAdapterContainer.setItemValue(P,e);a=new sap.ushell.services.PersonalizationContainerVariantSet(P,this._oAdapterContainer);this._oVariantSetMap.put(P,a);return a;};sap.ushell.services.PersonalizationContainer.prototype._serializeVariantSets=function(){var V=[],D=[],t=this;V=this._oVariantSetMap.keys();V.forEach(function(s){var a={},b={};a=t._oVariantSetMap.get(s);b=a._serialize();t._oAdapterContainer.setItemValue(s,n(b));});D=this._aLoadedVariantSetKeys.filter(function(s){return!(V.indexOf(s)>-1);});D.forEach(function(s){t._oAdapterContainer.delItem(s);});};sap.ushell.services.PersonalizationContainer.prototype.delVariantSet=function(V){var P="";P=v+V;this._oVariantSetMap.remove(P);return this._oAdapterContainer.delItem(P);};sap.ushell.services.Personalization.ContextContainer=function(s,a,C,S,b){this._oService=s;this._sContainerKey=C;this._oAdapterContainer={};this._oScope=S||sap.ushell.services.Personalization.prototype._adjustScope(S);this._aLoadedKeys=[];this._oUnmodifiableContainer=undefined;var e;if(!(b instanceof sap.ui.core.UIComponent)&&b!==undefined){throw new Error("oComponent passed must be a UI5 Component or must be undefined");}if(b&&b.getMetadata&&b.getMetadata().getLibraryName){e=b.getMetadata().getLibraryName();}this.clear();if(!this._sContainerKey||typeof this._sContainerKey!=="string"){throw new sap.ushell.utils.Error("Invalid container key: sap.ushell.services.Personalization"," ");}this._oAdapterContainer=a.getAdapterContainer(this._sContainerKey,this._oScope,e);return this;};sap.ushell.services.Personalization.ContextContainer.prototype.getValidity=function(){return this._oScope.validity;};sap.ushell.services.Personalization.ContextContainer.prototype.clear=function(){this._oItemMap={};this._aLoadedItemKeys=[];this._clear=true;this._oItemMap=new sap.ushell.utils.Map();};sap.ushell.services.Personalization.ContextContainer.prototype.load=function(){var D={},P,t=this;D=new jQuery.Deferred();if(!this._sContainerKey){throw new sap.ushell.utils.Error("Invalid container key: sap.ushell.services.Personalization"," ");}this.clear();P=this._oService._pendingContainerOperations_flushAddNext(this._sContainerKey,D);P.always(function(){t._oAdapterContainer.load().fail(function(){D.reject();}).done(function(){t._copyFromAdapter();if(t._isExpired()){t.clear();}D.resolve();});});return D.promise();};sap.ushell.services.Personalization.ContextContainer.prototype._copyFromAdapter=function(){var t=this,a;a=t._oAdapterContainer.getItemKeys().splice(0);a.forEach(function(i){t._oItemMap.put(i,JSON.stringify(t._oAdapterContainer.getItemValue(i)));});this._aLoadedItemKeys=t._oItemMap.keys().splice(0);};sap.ushell.services.Personalization.ContextContainer.prototype._isExpired=function(){var F,t,T;if(this.getValidity()===Infinity||this.getValidity()===0){return false;}t=this._getItemValueInternal(d,h);F=sap.ui.core.format.DateFormat.getDateInstance({pattern:A});T=F.format(this._getNow(),true);return t&&T>t;};sap.ushell.services.Personalization.ContextContainer.prototype._getNow=function(){return new Date();};sap.ushell.services.Personalization.ContextContainer.prototype._copyToAdapterUpdatingValidity=function(){var i=[],D=[],t=this,N,F,T,s;if(this._clear){i=this._oAdapterContainer.getItemKeys().splice(0);i.forEach(function(a){t._oAdapterContainer.delItem(a);});this._clear=false;}if(this.getValidity()===Infinity||this.getValidity()===0){this._delItemInternal(d,f);this._delItemInternal(d,h);this._delItemInternal(d,g);}else{F=sap.ui.core.format.DateFormat.getDateInstance({pattern:A});N=this._getNow();s=F.format(N,true);T=F.format(new Date(N.getTime()+this.getValidity()*60000),true);this._setItemValueInternal(d,f,this._oScope);this._setItemValueInternal(d,h,T);this._setItemValueInternal(d,g,s);}i=this._oItemMap.keys();i.forEach(function(a){t._oAdapterContainer.setItemValue(a,o(t._oItemMap.get(a)));});D=this._aLoadedItemKeys.filter(function(a){return!(i.indexOf(a)>-1);});D.forEach(function(a){t._oAdapterContainer.delItem(a);});};sap.ushell.services.Personalization.ContextContainer.prototype.save=function(){var s,P,t=this;this._copyToAdapterUpdatingValidity();s=new jQuery.Deferred();P=this._oService._pendingContainerOperations_cancelAddNext(this._sContainerKey,s);P.always(function(){try{t._oAdapterContainer.save().fail(function(){s.reject();}).done(function(){s.resolve();});}catch(e){s.reject();}});return s.promise();};sap.ushell.services.Personalization.ContextContainer.prototype.saveDeferred=function(a){var s,P,t=this;this._copyToAdapterUpdatingValidity();s=new jQuery.Deferred();P=this._oService._pendingContainerOperations_cancelAddNext(this._sContainerKey,s);function D(){P.always(function(){try{t._oAdapterContainer.save().fail(function(){s.reject();}).done(function(){s.resolve();});}catch(e){s.reject();}});}s._sapFnSave=D;s._sapTimeoutId=setTimeout(D,a);return s.promise();};sap.ushell.services.Personalization.ContextContainer.prototype.flush=function(){var s,P;this._copyToAdapterUpdatingValidity();s=new jQuery.Deferred();P=this._oService._pendingContainerOperations_flushAddNext(this._sContainerKey,s);P.fail(function(){s.reject();}).done(function(){s.resolve();});return s.promise();};sap.ushell.services.Personalization.ContextContainer.prototype.getItemKeys=function(){var F=this._oItemMap.keys().filter(function(s){return s.indexOf(I)===0;});return F.map(function(e){return e.replace(I,"","");});};sap.ushell.services.Personalization.ContextContainer.prototype._getInternalKeys=function(){return this._oItemMap.keys().splice(0);};sap.ushell.services.Personalization.ContextContainer.prototype.getItemValue=function(i){return this._getItemValueInternal(I,i);};sap.ushell.services.Personalization.ContextContainer.prototype._getItemValueInternal=function(P,i){if(typeof i!=="string"||typeof P!=="string"){return undefined;}return o(this._oItemMap.get(P+i));};sap.ushell.services.Personalization.ContextContainer.prototype.containsItem=function(i){if(typeof i!=="string"){return undefined;}return this._oItemMap.containsKey(I+i);};sap.ushell.services.Personalization.ContextContainer.prototype.setItemValue=function(i,a){this._setItemValueInternal(I,i,a);};sap.ushell.services.Personalization.ContextContainer.prototype._setItemValueInternal=function(i,s,a){if(typeof s!=="string"||typeof i!=="string"){throw new sap.ushell.utils.Error("Parameter value of sItemKey or sItemValue is not a string: sap.ushell.services.Personalization"," ");}if(s.length>40){jQuery.sap.log.error("Personalization Service item key/variant set name (\""+s+"\") should be less than 40 characters [current :"+s.length+"]");}this._oItemMap.put(i+s,JSON.stringify(a));};sap.ushell.services.Personalization.ContextContainer.prototype.delItem=function(i){this._delItemInternal(I,i);};sap.ushell.services.Personalization.ContextContainer.prototype._delItemInternal=function(P,i){if(typeof i!=="string"){return undefined;}if(typeof P!=="string"){return undefined;}this._oItemMap.remove(P+i);};sap.ushell.services.Personalization.ContextContainer.prototype.getKey=function(){return this._sContainerKey.substring(c.length);};sap.ushell.services.Personalization.ContextContainer.prototype.getUnmodifiableContainer=function(){var t=this;if(!this._oUnmodifiableContainer){this._oUnmodifiableContainer=(function(){var u={};["clear","delItem","flush","load","save","saveDeferred","setItemValue"].forEach(function(F){u[F]=function(N){throw new sap.ushell.utils.Error("Function "+N+" can't be called on unmodifiable container","sap.ushell.services.Personalization.ContextContainer"," ");}.bind(undefined,F);});["containsItem","getItemKeys","getItemValue","getUnmodifiableContainer","getValidity"].forEach(function(F){if(t[F]){u[F]=t[F].bind(t);}});return u;}());}return this._oUnmodifiableContainer;};sap.ushell.services.Personalization.VariantSetAdapter=function(C){this._oContextContainer=C;};sap.ushell.services.Personalization.VariantSetAdapter.prototype.save=function(){return this._oContextContainer.save();};sap.ushell.services.Personalization.VariantSetAdapter.prototype.getVariantSetKeys=function(){var P=this._oContextContainer._getInternalKeys(),V=[];V=P.map(function(e){return e.replace(v,"","");});return V;};sap.ushell.services.Personalization.VariantSetAdapter.prototype.containsVariantSet=function(V){return this.getVariantSetKeys().indexOf(V)>=0;};sap.ushell.services.Personalization.VariantSetAdapter.prototype.getVariantSet=function(V){var a=this._oContextContainer._getItemValueInternal(v,V);if(!a){return undefined;}return new sap.ushell.services.Personalization.VariantSet(V,this._oContextContainer);};sap.ushell.services.Personalization.VariantSetAdapter.prototype.addVariantSet=function(V){var e={},a={};if(this.containsVariantSet(V)){throw new sap.ushell.utils.Error("Container already contains a variant set with key '"+V+"': sap.ushell.services.Personalization"," ");}e={currentVariant:null,variants:{}};this._oContextContainer._setItemValueInternal(v,V,e);a=new sap.ushell.services.Personalization.VariantSet(V,this._oContextContainer);return a;};sap.ushell.services.Personalization.VariantSetAdapter.prototype.delVariantSet=function(V){this._oContextContainer._delItemInternal(v,V);};sap.ushell.services.Personalization.VariantSet=function(V,C){var s,a,b=new sap.ushell.utils.Map(),e=new sap.ushell.utils.Map(),i,q;this._oContextContainer=C;this._sVariantSetKey=V;this._oVariantSetData=this._oContextContainer._getItemValueInternal(v,this._sVariantSetKey);if(!Object.prototype.hasOwnProperty.call(this._oVariantSetData,"currentVariant")){throw new sap.ushell.utils.Error("Corrupt variant set data: sap.ushell.services.Personalization"," ");}if(Object.prototype.hasOwnProperty.call(this._oVariantSetData,"variants")){for(s in this._oVariantSetData.variants){if(Object.prototype.hasOwnProperty.call(this._oVariantSetData.variants,s)){a=this._oVariantSetData.variants[s].name;i=this._oVariantSetData.variants[s].variantData;if(b.containsKey(a)){throw new sap.ushell.utils.Error("Variant name already exists: sap.ushell.services.Personalization"," ");}else{b.put(a,s);q=new sap.ushell.services.PersonalizationContainerVariant(s,a,i);e.put(s,q);}}}}else{throw new sap.ushell.utils.Error("Corrupt variant set data: sap.ushell.services.Personalization"," ");}return this;};sap.ushell.services.Personalization.VariantSet.prototype._getVariantSet=function(){return this._oVariantSetData;};sap.ushell.services.Personalization.VariantSet.prototype._serialize=function(){this._oContextContainer._setItemValueInternal(v,this._sVariantSetKey,this._oVariantSetData);};sap.ushell.services.Personalization.VariantSet.prototype.getCurrentVariantKey=function(){return this._getVariantSet().currentVariant;};sap.ushell.services.Personalization.VariantSet.prototype.setCurrentVariantKey=function(V){this._getVariantSet().currentVariant=V;this._serialize();};sap.ushell.services.Personalization.VariantSet.prototype.getVariantKeys=function(){var V=new sap.ushell.utils.Map(),a=this._getVariantSet(this._sVariantSetKey),s;if(Object.prototype.hasOwnProperty.call(a,"variants")){for(s in a.variants){if(Object.prototype.hasOwnProperty.call(a.variants,s)){V.put(s,"dummy");}}}else{throw new sap.ushell.utils.Error("Corrupt variant set data: sap.ushell.services.Personalization"," ");}return V.keys();};sap.ushell.services.Personalization.VariantSet.prototype.getVariantNamesAndKeys=function(){var V=new sap.ushell.utils.Map(),a=new sap.ushell.utils.Map(),b=this._getVariantSet(this._sVariantSetKey),s,e;if(Object.prototype.hasOwnProperty.call(b,"variants")){for(s in b.variants){if(Object.prototype.hasOwnProperty.call(b.variants,s)){e=b.variants[s].name;if(V.containsKey(e)){throw new sap.ushell.utils.Error("Variant name already exists: sap.ushell.services.Personalization"," ");}else{V.put(e,s);}a.put(s,"dummy");}}}else{throw new sap.ushell.utils.Error("Corrupt variant set data: sap.ushell.services.Personalization"," ");}return V.entries;};sap.ushell.services.Personalization.VariantSet.prototype.getVariant=function(V){if(typeof V!=="string"){return undefined;}var a=this._getVariantSet(this._sVariantSetKey),s,b,e;if(Object.prototype.hasOwnProperty.call(a,"variants")&&Object.prototype.hasOwnProperty.call(a.variants,V)){s=a.variants[V].name;e=a.variants[V].variantData;b=new sap.ushell.services.Personalization.Variant(this,V,s,e);return b;}return undefined;};sap.ushell.services.Personalization.VariantSet.prototype.getVariantKeyByName=function(V){if(typeof V!=="string"){return undefined;}var a=this._getVariantSet(this._sVariantSetKey),s;if(Object.prototype.hasOwnProperty.call(a,"variants")){for(s in a.variants){if(Object.prototype.hasOwnProperty.call(a.variants,s)){if(V===a.variants[s].name){return s;}}}}else{throw new sap.ushell.utils.Error("Corrupt variant set data: sap.ushell.services.Personalization"," ");}return undefined;};sap.ushell.services.Personalization.VariantSet.prototype.containsVariant=function(V){var a=this._getVariantSet();if(typeof V!=="string"){return undefined;}return Object.prototype.hasOwnProperty.call(a,"variants")&&Object.prototype.hasOwnProperty.call(a.variants,V);};sap.ushell.services.Personalization.VariantSet.prototype.addVariant=function(V){var K=[],M=0,s="",e={};K=this.getVariantKeys();M=parseInt(K.sort(function(a,b){return a-b;}).reverse()[0],10);s=isNaN(M)?"0":(M+1).toString();if(K.indexOf(s)>=0){throw new sap.ushell.utils.Error("Variant key '"+s+"' already exists in variant set"+this._sVariantSetKey+"': sap.ushell.services.Personalization"," ");}if(typeof V!=="string"){throw new sap.ushell.utils.Error("Parameter value of sVariantName is not a string: sap.ushell.services.Personalization"," ");}if(this.getVariantKeyByName(V)!==undefined){throw new sap.ushell.utils.Error("Variant name '"+V+"' already exists in variant set '"+this._sVariantSetKey+"' (Old key: '"+this.getVariantKeyByName(V)+"' New key: '"+s+"') ': sap.ushell.services.Personalization"," ");}e=new sap.ushell.services.Personalization.Variant(this,s,V);this._getVariantSet(this._sVariantSetKey).variants[s]={name:V,variantData:{}};this._serialize();return e;};sap.ushell.services.Personalization.VariantSet.prototype.delVariant=function(V){var a;if(typeof V!=="string"){return undefined;}a=this._getVariantSet();if(a&&a.variants){delete this._oVariantSetData.variants[V];}this._serialize();};sap.ushell.services.PersonalizationContainerVariantSet=function(V,a){var b,s,e,i,q;this._sVariantSetKey=V;this._oAdapterContainer=a;this._oVariantNameMap=new sap.ushell.utils.Map();this._oVariantMap=new sap.ushell.utils.Map();b=n(this._oAdapterContainer.getItemValue(V));if(b.hasOwnProperty("currentVariant")){this._sCurrentVariantKey=b.currentVariant;}else{throw new sap.ushell.utils.Error("Corrupt variant set data: sap.ushell.services.Personalization"," ");}if(b.hasOwnProperty("variants")){for(s in b.variants){if(b.variants.hasOwnProperty(s)){e=b.variants[s].name;i=b.variants[s].variantData;if(this._oVariantNameMap.containsKey(e)){throw new sap.ushell.utils.Error("Variant name already exists: sap.ushell.services.Personalization"," ");}else{this._oVariantNameMap.put(e,s);q=new sap.ushell.services.PersonalizationContainerVariant(s,e,i);this._oVariantMap.put(s,q);}}}}else{throw new sap.ushell.utils.Error("Corrupt variant set data: sap.ushell.services.Personalization"," ");}return this;};sap.ushell.services.PersonalizationContainerVariantSet.prototype.getCurrentVariantKey=function(){return this._sCurrentVariantKey;};sap.ushell.services.PersonalizationContainerVariantSet.prototype.setCurrentVariantKey=function(V){this._sCurrentVariantKey=V;};sap.ushell.services.PersonalizationContainerVariantSet.prototype.getVariantKeys=function(){return this._oVariantMap.keys();};sap.ushell.services.PersonalizationContainerVariantSet.prototype.getVariantNamesAndKeys=function(){return JSON.parse(JSON.stringify(this._oVariantNameMap.entries));};sap.ushell.services.PersonalizationContainerVariantSet.prototype.getVariant=function(V){if(typeof V!=="string"){return undefined;}return this._oVariantMap.get(V);};sap.ushell.services.PersonalizationContainerVariantSet.prototype.getVariantKeyByName=function(V){if(typeof V!=="string"){return undefined;}return this._oVariantNameMap.get(V);};sap.ushell.services.PersonalizationContainerVariantSet.prototype.containsVariant=function(V){if(typeof V!=="string"){return undefined;}return this._oVariantMap.containsKey(V);};sap.ushell.services.PersonalizationContainerVariantSet.prototype.addVariant=function(V){var M=0,s="",e={};M=parseInt(this._oVariantMap.keys().sort(function(a,b){return a-b;}).reverse()[0],10);s=isNaN(M)?"0":(M+1).toString();if(this._oVariantMap.containsKey(s)){throw new sap.ushell.utils.Error("Variant key '"+s+"' already exists in variant set"+this._sVariantSetKey+"': sap.ushell.services.Personalization"," ");}if(typeof V!=="string"){throw new sap.ushell.utils.Error("Parameter value of sVariantName is not a string: sap.ushell.services.Personalization"," ");}if(this._oVariantNameMap.containsKey(V)){throw new sap.ushell.utils.Error("Variant name '"+V+"' already exists in variant set '"+this._sVariantSetKey+"' (Old key: '"+this._oVariantNameMap.get(V)+"' New key: '"+s+"') ': sap.ushell.services.Personalization"," ");}e=new sap.ushell.services.PersonalizationContainerVariant(s,V);this._oVariantMap.put(s,e);this._oVariantNameMap.put(V,s);return e;};sap.ushell.services.PersonalizationContainerVariantSet.prototype._serialize=function(){var V=[],a={},b={},t=this;a.currentVariant=this._sCurrentVariantKey;V=this.getVariantKeys();V.forEach(function(s){var e={};e=t._oVariantMap.get(s);b[s]=e._serialize();});a.variants=b;return a;};sap.ushell.services.PersonalizationContainerVariantSet.prototype.delVariant=function(V){var a=this._oVariantMap.get(V);if(a){this._oVariantNameMap.remove(a.getVariantName());this._oVariantMap.remove(V);}};sap.ushell.services.Personalization.Variant=function(V,s,a){if(typeof s!=="string"){throw new sap.ushell.utils.Error("Parameter value of sVariantKey is not a string: sap.ushell.services.Personalization"," ");}if(typeof a!=="string"){throw new sap.ushell.utils.Error("Parameter value of sVariantName is not a string: sap.ushell.services.Personalization"," ");}this._oVariantSet=V;this._sVariantKey=s;this._sVariantName=a;};sap.ushell.services.Personalization.Variant.prototype.getVariantKey=function(){return this._sVariantKey;};sap.ushell.services.Personalization.Variant.prototype.getVariantName=function(){return this._sVariantName;};sap.ushell.services.Personalization.Variant.prototype.setVariantName=function(V){var a=this._oVariantSet._getVariantSet(),b;if(typeof V!=="string"){throw new sap.ushell.utils.Error("Parameter value of sVariantName is not a string: sap.ushell.services.Personalization"," ");}if(this._oVariantSet.getVariantKeyByName(V)!==undefined){throw new sap.ushell.utils.Error("Variant with name '"+V+"' already exists in variant set '"+this._oVariantSet._sVariantSetKey+"': sap.ushell.services.Personalization"," ");}if(Object.prototype.hasOwnProperty.call(a,"variants")&&Object.prototype.hasOwnProperty.call(a.variants,this._sVariantKey)){b=a.variants[this._sVariantKey];b.name=V;this._sVariantName=V;this._oVariantSet._serialize();}else{throw new sap.ushell.utils.Error("Variant does not longer exist"," ");}};sap.ushell.services.Personalization.Variant.prototype.getItemValue=function(i){if(typeof i!=="string"){return undefined;}var a=this._oVariantSet._getVariantSet().variants[this._sVariantKey].variantData;return Object.prototype.hasOwnProperty.call(a,i)&&n(a[i]);};sap.ushell.services.Personalization.Variant.prototype.setItemValue=function(i,a){if(typeof i!=="string"){throw new sap.ushell.utils.Error("Parameter value of sItemKey is not a string: sap.ushell.services.Personalization"," ");}var b,e=this._oVariantSet._getVariantSet().variants&&this._oVariantSet._getVariantSet().variants[this._sVariantKey];if(!e){throw new sap.ushell.utils.Error("Variant does not longer exist"," ");}if(!e.variantData){e.variantData={};}b=e.variantData;b[i]=n(a);this._oVariantSet._serialize();};sap.ushell.services.Personalization.Variant.prototype.containsItem=function(i){if(typeof i!=="string"){return undefined;}var a=this.oAccess.variantSet._getVariantSet().variants[this._sVariantKey].variantData;return Object.prototype.hasOwnProperty.call(a,i);};sap.ushell.services.Personalization.Variant.prototype.getItemKeys=function(){var a=this._oVariantSet._getVariantSet().variants[this._sVariantKey].variantData,i,b=[];for(i in a){if(Object.prototype.hasOwnProperty.call(a,i)){b.push(i);}}b.sort();return b;};sap.ushell.services.Personalization.Variant.prototype.delItem=function(i){if(typeof i!=="string"){return undefined;}var a=this.oVariantSet._getVariantSet().variants[this._sVariantKey].variantData;delete a[i];this.oVariantSet._serialize();};sap.ushell.services.PersonalizationContainerVariant=function(V,s,a){if(typeof V!=="string"){throw new sap.ushell.utils.Error("Parameter value of sVariantKey is not a string: sap.ushell.services.Personalization"," ");}if(typeof s!=="string"){throw new sap.ushell.utils.Error("Parameter value of sVariantName is not a string: sap.ushell.services.Personalization"," ");}if(a&&typeof a!=="object"){throw new sap.ushell.utils.Error("Parameter value of sVariantName is not a string: sap.ushell.services.Personalization"," ");}this._oVariantKey=V;this._oVariantName=s;this._oItemMap=new sap.ushell.utils.Map();this._oItemMap.entries=a||{};};sap.ushell.services.PersonalizationContainerVariant.prototype.getVariantKey=function(){return this._oVariantKey;};sap.ushell.services.PersonalizationContainerVariant.prototype.getVariantName=function(){return this._oVariantName;};sap.ushell.services.PersonalizationContainerVariant.prototype.getItemValue=function(i){if(typeof i!=="string"){return undefined;}return this._oItemMap.get(i);};sap.ushell.services.PersonalizationContainerVariant.prototype.setItemValue=function(i,a){if(typeof i!=="string"){throw new sap.ushell.utils.Error("Parameter value of sItemKey is not a string: sap.ushell.services.Personalization"," ");}return this._oItemMap.put(i,a);};sap.ushell.services.PersonalizationContainerVariant.prototype.containsItem=function(i){if(typeof i!=="string"){return undefined;}return this._oItemMap.containsKey(i);};sap.ushell.services.PersonalizationContainerVariant.prototype.getItemKeys=function(){return this._oItemMap.keys();};sap.ushell.services.PersonalizationContainerVariant.prototype.delItem=function(i){if(typeof i!=="string"){return undefined;}return this._oItemMap.remove(i);};sap.ushell.services.PersonalizationContainerVariant.prototype._serialize=function(){var i=[],V={},a={},t=this;V.name=this.getVariantName();i=this._oItemMap.keys();i.forEach(function(s){a[s]=t.getItemValue(s);});V.variantData=a;return V;};sap.ushell.services.Personalization.WindowAdapter=function(s,b){this._oBackendAdapter=b;if(!sap.ushell.services.Personalization.WindowAdapter.prototype.data){sap.ushell.services.Personalization.WindowAdapter.prototype.data={};}};sap.ushell.services.Personalization.WindowAdapter.prototype.getAdapterContainer=function(C,s,a){var b=this._oBackendAdapter&&this._oBackendAdapter.getAdapterContainer(C,s,a);return new sap.ushell.services.Personalization.WindowAdapterContainer(C,s,b);};sap.ushell.services.Personalization.WindowAdapter.prototype.delAdapterContainer=function(C,s){var D=new jQuery.Deferred();delete sap.ushell.services.Personalization.WindowAdapter.prototype.data[C];if(this._oBackendAdapter){this._oBackendAdapter.delAdapterContainer(C,s).done(function(){D.resolve();}).fail(function(M){D.reject(M);});}else{D.resolve();}return D.promise();};sap.ushell.services.Personalization.WindowAdapterContainer=function(C,s,b){this._oBackendContainer=b;this._oItemMap=new sap.ushell.utils.Map();this._sContainerKey=C;};function p(C){var i,a=C.getItemKeys();for(i=0;i<a.length;i=i+1){C.delItem(a[i]);}}sap.ushell.services.Personalization.WindowAdapterContainer.prototype.load=function(){var D=new jQuery.Deferred(),i,a,t=this;if(sap.ushell.services.Personalization.WindowAdapter.prototype.data[this._sContainerKey]){this._oItemMap.entries=n(sap.ushell.services.Personalization.WindowAdapter.prototype.data[this._sContainerKey]);if(this._oBackendContainer){p(this._oBackendContainer);a=this.getItemKeys();for(i=0;i<a.length;i=i+1){this._oBackendContainer.setItemValue(a[i],this._oItemMap.get(a[i]));}}D.resolve();}else{if(this._oBackendContainer){this._oBackendContainer.load().done(function(){a=t._oBackendContainer.getItemKeys();for(i=0;i<a.length;i=i+1){t.setItemValue(a[i],t._oBackendContainer.getItemValue(a[i]));}sap.ushell.services.Personalization.WindowAdapter.prototype.data[t._sContainerKey]=n(t._oItemMap.entries);D.resolve();}).fail(function(M){D.reject(M);});}else{sap.ushell.services.Personalization.WindowAdapter.prototype.data[this._sContainerKey]={};D.resolve();}}return D.promise();};sap.ushell.services.Personalization.WindowAdapterContainer.prototype.save=function(){var D=new jQuery.Deferred();sap.ushell.services.Personalization.WindowAdapter.prototype.data[this._sContainerKey]=n(this._oItemMap.entries);if(this._oBackendContainer){this._oBackendContainer.save().done(function(){D.resolve();}).fail(function(M){D.reject(M);});}else{D.resolve();}return D.promise();};sap.ushell.services.Personalization.WindowAdapterContainer.prototype.getItemKeys=function(){return this._oItemMap.keys();};sap.ushell.services.Personalization.WindowAdapterContainer.prototype.containsItem=function(i){this._oItemMap.containsKey(i);};sap.ushell.services.Personalization.WindowAdapterContainer.prototype.getItemValue=function(i){return this._oItemMap.get(i);};sap.ushell.services.Personalization.WindowAdapterContainer.prototype.setItemValue=function(i,a){this._oItemMap.put(i,a);if(this._oBackendContainer){this._oBackendContainer.setItemValue(i,a);}};sap.ushell.services.Personalization.WindowAdapterContainer.prototype.delItem=function(i){this._oItemMap.remove(i);if(this._oBackendContainer){this._oBackendContainer.delItem(i);}};}());};if(!jQuery.sap.isDeclared('sap.ushell.services.ReferenceResolver')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.ReferenceResolver");function U(){this.getValue=function(r){var d=new jQuery.Deferred();var v;if(r==="User.env.sap-ui-legacy-date-format"){v=sap.ui.getCore().getConfiguration().getFormatSettings().getLegacyDateFormat();}if(r==="User.env.sap-ui-legacy-number-format"){v=sap.ui.getCore().getConfiguration().getFormatSettings().getLegacyNumberFormat();}if(r==="User.env.sap-ui-legacy-time-format"){v=sap.ui.getCore().getConfiguration().getFormatSettings().getLegacyTimeFormat();}if(r==="User.env.sap-language"){v=sap.ushell.Container.getUser().getLanguage();}if(r==="User.env.sap-languagebcp47"){v=sap.ushell.Container.getUser().getLanguageBcp47();}if(r==="User.env.sap-accessibility"){v=(sap.ushell.Container.getUser().getAccessibilityMode())?'X':undefined;}if(r==="User.env.sap-statistics"){v=(sap.ui.getCore().getConfiguration().getStatistics())?"true":undefined;}if(r==="User.env.sap-theme"){v=sap.ushell.Container.getUser().getTheme(sap.ushell.User.prototype.constants.themeFormat.THEME_NAME_PLUS_URL);}if(r==="User.env.sap-theme-name"){v=sap.ushell.Container.getUser().getTheme();}if(r==="User.env.sap-theme-NWBC"){v=sap.ushell.Container.getUser().getTheme(sap.ushell.User.prototype.constants.themeFormat.NWBC);}d.resolve({"value":v});return d.promise();};}sap.ushell.services.ReferenceResolver=function(c,p,C){this._getUserEnvReferenceResolver=function(){if(!this.oUserEnvReferenceResolver){this.oUserEnvReferenceResolver=new U();}return this.oUserEnvReferenceResolver;};this.resolveReferences=function(r){var t=this,d=new jQuery.Deferred(),u,R=[],a=true,D={},o={},b;var e=r.map(function(s){var f;if(s.indexOf("User.env.")===0){f=s;o[f]=1;}if(s.indexOf("UserDefault.")===0){f=t._extractAnyUserDefaultReferenceName(s);D[f]=1;}if(typeof f!=="string"){a=false;jQuery.sap.log.error("'"+s+"' is not a legal reference name","sap.ushell.services.ReferenceResolver");}return{full:s,name:f};});if(!a){return d.reject("One or more references could not be resolved").promise();}Object.keys(D).forEach(function(n){u=u||sap.ushell.Container.getService("UserDefaultParameters");R.push(u.getValue(n));});Object.keys(o).forEach(function(n){b=b||t._getUserEnvReferenceResolver();R.push(b.getValue(n));});jQuery.when.apply(jQuery,R).done(function(){var k={};var i=0,f=arguments;Object.keys(D).forEach(function(n){D[n]=f[i];i=i+1;});Object.keys(o).forEach(function(n){o[n]=f[i];i=i+1;});e.forEach(function(g){var m;if(g.full.indexOf("UserDefault.extended.")===0){m=t.mergeSimpleAndExtended(D[g.name]);if(!jQuery.isEmptyObject(m)){k[g.full]=m;}else{k[g.full]=undefined;}}else if(g.full.indexOf("UserDefault.")===0){k[g.full]=D[g.name].value;}else if(g.full.indexOf("User.env.")===0){k[g.full]=o[g.name].value;}});d.resolve(k);});return d.promise();};this._extractAnyUserDefaultReferenceName=function(r){var P=this.extractExtendedUserDefaultReferenceName(r);if(typeof P==="string"){return P;}return this.extractUserDefaultReferenceName(r);};this.extractExtendedUserDefaultReferenceName=function(r){if(typeof r!=="string"||r.indexOf("UserDefault.extended.")!==0){return undefined;}return r.replace(/^UserDefault[.]extended[.]/,"");};this.extractUserDefaultReferenceName=function(r){if(typeof r!=="string"||r.indexOf("UserDefault.")!==0||r.indexOf("UserDefault.extended.")===0){return undefined;}return r.replace(/^UserDefault[.]/,"");};this.mergeSimpleAndExtended=function(v){var m=jQuery.extend(true,{},v.extendedValue);if(typeof v.value==="string"){if(!jQuery.isArray(m.Ranges)){m.Ranges=[];}m.Ranges.push({"Sign":"I","Option":"EQ","Low":v.value,"High":null});}return m;};};sap.ushell.services.ReferenceResolver.hasNoAdapter=true;}());};if(!jQuery.sap.isDeclared('sap.ushell.services.UserRecents')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.UserRecents");sap.ushell.services.AppType={OVP:"OVP",SEARCH:"Search",FACTSHEET:"FactSheet",COPILOT:"Co-Pilot",APP:"Application",getDisplayName:function(a){switch(a){case this.OVP:case this.SEARCH:case this.FACTSHEET:case this.COPILOT:return a;default:return"App";}}};function R(m,e,C,l,s){var r=[],u=function(I,t){return r.some(function(o){var f;if(e(o.oItem,I)){o.oItem=I;o.iTimestamp=t;o.iCount=o.iCount+1;f=true;}else{f=false;}return f;});},i=function(I,t){var n={oItem:I,iTimestamp:t,iCount:1};if(r.length===m){r.sort(C);r.pop();}r.push(n);};this.newItem=function(I){var D=new jQuery.Deferred();var t=+new Date(),a;l().done(function(L){r=L||[];a=u(I,t);if(!a){i(I,t);}s(r).done(function(b){D.resolve(b);}).fail(function(){D.reject();});});return D.promise();};this.getRecentItems=function(){var D=new jQuery.Deferred();l().done(function(L){L=L||[];L.sort(C);r=L.slice(0,m);D.resolve(jQuery.map(r,function(o){return o.oItem;}));});return D.promise();};}function c(m,e,C,l,s){var M=30,r,u=function(I,t){return r.recentUsageArray.some(function(o){var f;if(e(o.oItem,I)){if((I.appType===o.oItem.appType)||(I.appType!==sap.ushell.services.AppType.APP)){jQuery.extend(o.oItem,I);o.iTimestamp=t;o.oItem.timestamp=t;o.mobile=undefined;o.tablet=undefined;o.desktop=undefined;if((I.appType===o.oItem.appType)||(I.appType!==sap.ushell.services.AppType.APP&&o.oItem.appType!==sap.ushell.services.AppType.APP)){o.aUsageArray[o.aUsageArray.length-1]+=1;o.iCount+=1;}r.recentUsageArray.sort(C);}f=true;}else{f=false;}return f;});},i=function(I,t,a){I.timestamp=t;if(a){I.icon=a;}var n={oItem:I,iTimestamp:t,aUsageArray:[1],iCount:1,mobile:undefined,tablet:undefined,desktop:undefined};if(r.recentUsageArray.length===m){r.recentUsageArray.pop();}r.recentUsageArray.unshift(n);};this.newItem=function(I){var D=new jQuery.Deferred();var t=+new Date(),a=this.getActivityIcon(I.appType,I.icon),A,b=this,f=this.getDayFromDateObj(new Date());l().done(function(L){r=b.getRecentActivitiesFromLoadedData(L);if(f!=r.recentDay){b.addNewDay();r.recentDay=f;}A=u(I,t);if(!A){i(I,t,a);}s(r).done(function(g){D.resolve(g);}).fail(function(){D.reject();});});return D.promise();};this.getActivityIcon=function(a,I){switch(a){case sap.ushell.services.AppType.SEARCH:return I?I:"sap-icon://search";case sap.ushell.services.AppType.COPILOT:return I?I:"sap-icon://co";default:return undefined;}};this.getRecentItemsHelper=function(a){var t=this,D=new jQuery.Deferred(),b,A,f,I=false,g=[],h=this.getDayFromDateObj(new Date()),j=function(L){var k=[],n=0,o;for(o=0;o<L.recentUsageArray.length&&(!a||n<a);o++){A=L.recentUsageArray[o];if(A[f]){k.push(A);n++;}}D.resolve(k);};if(sap.ui.Device.system.desktop){f="desktop";}else if(sap.ui.Device.system.tablet){f="tablet";}else{f="mobile";}l().done(function(L){r=t.getRecentActivitiesFromLoadedData(L);var n=false;if(h!=r.recentDay){t.addNewDay();r.recentDay=h;n=true;}for(b=0;b<r.recentUsageArray.length&&!I;b++){A=r.recentUsageArray[b];if(A[f]===undefined){g.push(A.oItem.appId);}else{I=true;}}if(g.length>0){sap.ushell.Container.getService("CrossApplicationNavigation").isIntentSupported(g).done(function(o){I=false;for(b=0;b<r.recentUsageArray.length&&!I;b++){A=r.recentUsageArray[b];if(A[f]===undefined){var k=o[A.oItem.appId];A[f]=k&&k.supported?true:false;}else{I=true;}}s(r).done(function(p){D.resolve(j(r));}).fail(function(){D.reject();});}).fail(function(k){D.reject(k);});}else{if(n){s(r).done(function(k){D.resolve(j(r));}).fail(function(){D.reject();});}else{D.resolve(j(r));}}});return D.promise();};this.getRecentItems=function(){var D=new jQuery.Deferred();this.getRecentItemsHelper(30).done(function(a){D.resolve(jQuery.map(a,function(o){return o.oItem;}));});return D.promise();};this.getFrequentItems=function(){var D=new jQuery.Deferred();this.getRecentItemsHelper().done(function(f){var g,w=0,F=[],A,p=f[0]?new Date(f[0].iTimestamp):undefined,h;for(g=0;g<f.length&&w<30;g++){A=f[g];if(A.iCount>1){F.push(A);}h=new Date(A.iTimestamp);if(p.toDateString()!=h.toDateString()){w++;p=h;}}F.sort(function(a,b){return b.iCount-a.iCount;});F=F.slice(0,30);D.resolve(jQuery.map(F,function(o){return o.oItem;}));});return D.promise();};this.addNewDay=function(){var a,b;for(a=0;a<r.recentUsageArray.length;a++){if(r.recentUsageArray[a].aUsageArray){b=r.recentUsageArray[a].aUsageArray;}else{b=[];r.recentUsageArray[a].aUsageArray=b;r.recentUsageArray[a].iCount=0;}b[b.length]=0;if(b.length>M){r.recentUsageArray[a].iCount-=b[0];b.shift();}}};this.getDayFromDateObj=function(a){return(a.getUTCFullYear()+"/"+(a.getUTCMonth()+1)+"/"+a.getUTCDate());};this.getRecentActivitiesFromLoadedData=function(a){var b;if(jQuery.isArray(a)){b={recentDay:null,recentUsageArray:a};}else{b=a||{recentDay:null,recentUsageArray:[]};}return b;}}function d(l,s){var a,t=this,m=30;this.init=function(){var t=this,p,b=this.getDayFromDateObj(this.getCurrentDate()),D=false;if(t._oInitDeferred===undefined){t._oInitDeferred=jQuery.Deferred();}if(!D||b!==a.recentDay){D=true;p=l();p.done(function(e){a=e||{recentDay:null,recentAppsUsageMap:{}};t.calculateInitialUsage(b);t._oInitDeferred.resolve(a);});p.fail(function(){jQuery.sap.log.error("UShell-lib ; RecentAppsUsage ; Load data in Init failed");t._oInitDeferred.reject();});}return this._oInitDeferred.promise();};this.calculateInitialUsage=function(b){var t=this;if(b!=a.recentDay){this.addNewDay();a.recentDay=b;setTimeout(function(){t.cleanUnusedHashes();},3000);this.saveAppsUsage(a);}};this.addAppUsage=function(h){if(!sap.ushell.utils.validHash(h)){return jQuery.Deferred().reject("Non valid hash").promise();}var p=this.init();p.done(function(){var A=a.recentAppsUsageMap[h]||[];if(A.length==0){A[0]=1;}else{A[A.length-1]+=1;}a.recentAppsUsageMap[h]=A;t.saveAppsUsage(a);});p.fail(function(){jQuery.sap.log.error("Ushell-lib ; addAppUsage ; Initialization falied!");});return p;};this.getAppsUsage=function(){var r,p,t=this,D=jQuery.Deferred();p=t.init();p.done(function(){r=t.summarizeUsage();D.resolve(r);});p.fail(function(){D.reject("Not initialized yet");});return D.promise();};this.summarizeUsage=function(){var u={},h,b,e,f=true;for(h in a.recentAppsUsageMap){u[h]=this.getHashUsageSum(h);if(f){b=e=u[h];f=false;}else{if(u[h]<e){e=u[h];}else if(u[h]>b){b=u[h];}}}return{usageMap:u,maxUsage:b,minUsage:e};};this.addNewDay=function(){var h,A;for(h in a.recentAppsUsageMap){A=a.recentAppsUsageMap[h];A[A.length]=0;if(A.length>m){A=A.shift();}}};this.cleanUnusedHashes=function(){var u,h;for(h in a.recentAppsUsageMap){u=t.getHashUsageSum(h);if(u==0){delete(a.recentAppsUsageMap[h]);}}};this.getHashUsageSum=function(h){var b=0,e,f=a.recentAppsUsageMap[h],g=f.length;for(e=0;e<g;e++){b+=f[e];}return b;};this.saveAppsUsage=function(o){var p=s(o);p.fail(function(){jQuery.sap.log.error("Ushell-lib ; saveAppsUsage ; Save action failed");});p.done(function(b){});return p;};this.getCurrentDate=function(){return new Date();};this.getDayFromDateObj=function(b){return(b.getUTCFullYear()+"/"+(b.getUTCMonth()+1)+"/"+b.getUTCDate());};}sap.ushell.services.UserRecents=function(){var r,o,a,A,b,p,e,s,f,D,g,l,S,h="RecentApps",i="RecentActivity",j="AppsUsage",k="RecentSearches",m="RecentDataSources",P="sap.ushell.services.UserRecents";this.addActivity=function(q){return a.newItem(q);};this.getRecentActivity=function(){return a.getRecentItems();};this.getFrequentActivity=function(){return a.getFrequentItems();};this.noticeDataSource=function(q){if((q&&q.objectName&&q.objectName.value&&q.objectName.value.toLowerCase()==="$$all$$")||(q.objectName&&q.objectName.toLowerCase&&q.objectName.toLowerCase()==="$$all$$")){return;}b.newItem(q);return b.getRecentItems();};this.getRecentDataSources=function(){return b.getRecentItems();};this.noticeSearch=function(q){r.newItem(q);return r.getRecentItems();};this.getRecentSearches=function(){return r.getRecentItems();};this.noticeApp=function(q){o.newItem(q);return o.getRecentItems();};this.getRecentApps=function(){return o.getRecentItems();};this.initAppsUsage=function(){A.init(new Date());};this.addAppUsage=function(q){var t=sap.ushell.utils.getBasicHash(q);A.addAppUsage(t);};this.getAppsUsage=function(){return A.getAppsUsage();};p=sap.ushell.Container.getService("Personalization");try{e=p.getPersonalizer({container:P,item:h});f=p.getPersonalizer({container:P,item:i});s=p.getPersonalizer({container:P,item:k});D=p.getPersonalizer({container:P,item:m});g=p.getPersonalizer({container:P,item:j});}catch(n){jQuery.sap.log.error("Personalization service does not work:");jQuery.sap.log.error(n.name+": "+n.message);}l=function(q){var t,u;try{t=q.getPersData();}catch(n){jQuery.sap.log.error("Personalization service does not work:");jQuery.sap.log.error(n.name+": "+n.message);u=new jQuery.Deferred();u.reject(n);t=u.promise();}return t;};S=function(q,L){var t;try{t=q.setPersData(L);}catch(n){jQuery.sap.log.error("Personalization service does not work:");jQuery.sap.log.error(n.name+": "+n.message);}return t;};r=new R(10,function(x,y){var q=false;if(x.oDataSource&&y.oDataSource){if(x.oDataSource.objectName&&y.oDataSource.objectName){q=((x.sTerm===y.sTerm)&&(x.oDataSource.objectName.value===y.oDataSource.objectName.value));}if(!x.oDataSource.objectName&&!y.oDataSource.objectName){q=(x.sTerm===y.sTerm);}}if(!x.oDataSource&&!y.oDataSource){q=(x.sTerm===y.sTerm);}return q;},function(x,y){return y.iTimestamp-x.iTimestamp;},l.bind(this,s),S.bind(this,s));b=new R(6,function(x,y){if(x.objectName&&y.objectName){return x.objectName.value===y.objectName.value;}return false;},function(x,y){return y.iTimestamp-x.iTimestamp;},l.bind(this,D),S.bind(this,D));o=new R(6,function(x,y){return x.semanticObject===y.semanticObject&&x.action===y.action;},function(x,y){return y.iTimestamp-x.iTimestamp;},l.bind(this,e),S.bind(this,e));a=new c(500,function(x,y){if(x.appType===y.appType){if(x.appType!==sap.ushell.services.AppType.APP){return x.url===y.url;}else{return x.appId===y.appId;}}else{if(x.appType===sap.ushell.services.AppType.APP||y.appType===sap.ushell.services.AppType.APP){return(x.appId===y.appId)&&(x.url===y.url);}else{return false;}}},function(x,y){return y.iTimestamp-x.iTimestamp;},l.bind(this,f),S.bind(this,f));A=new d(l.bind(this,g),S.bind(this,g));};sap.ushell.services.UserRecents.hasNoAdapter=true;}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.footerbar.AboutButton')){jQuery.sap.declare("sap.ushell.ui.footerbar.AboutButton");sap.ushell.ui.launchpad.ActionItem.extend("sap.ushell.ui.footerbar.AboutButton",{metadata:{library:"sap.ushell"}});(function(){"use strict";jQuery.sap.require('sap.ui.layout.form.SimpleForm');jQuery.sap.require('sap.m.ObjectHeader');jQuery.sap.require('sap.m.VBox');jQuery.sap.require('sap.m.Dialog');jQuery.sap.require('sap.m.Button');jQuery.sap.declare("sap.ushell.ui.footerbar.AboutButton");sap.ushell.ui.footerbar.AboutButton.prototype.init=function(){if(sap.ushell.ui.launchpad.ActionItem.prototype.init){sap.ushell.ui.launchpad.ActionItem.prototype.init.apply(this,arguments);}this.setIcon('sap-icon://hint');this.setText(sap.ushell.resources.i18n.getText("about"));this.setTooltip(sap.ushell.resources.i18n.getText("about"));this.attachPress(this.showAboutDialog);};sap.ushell.ui.footerbar.AboutButton.prototype.showAboutDialog=function(){jQuery.sap.require("sap.ushell.services.AppConfiguration");var t=sap.ushell.resources.i18n,m=sap.ushell.services.AppConfiguration.getMetadata(),s=new sap.ui.layout.form.SimpleForm({id:'aboutDialogFormID',editable:false,content:[new sap.m.Label({text:t.getText("technicalName")}),new sap.m.Text({text:m.libraryName||''}),new sap.m.Label({text:t.getText("fioriVersionFld")}),new sap.m.Text({text:m.version||''}),new sap.m.Label({text:t.getText("sapui5Fld")}),new sap.m.Text({text:(sap.ui.version||"")+(' ('+(sap.ui.buildinfo.buildtime||"")+')')||''}),new sap.m.Label({text:t.getText("userAgentFld")}),new sap.m.Text({text:navigator.userAgent||''}),new sap.m.Label({text:''})]}),h=new sap.m.ObjectHeader({title:m.title,icon:m.icon}).addStyleClass('sapUshellAboutDialogHeader'),d,v,o=new sap.m.Button({text:t.getText("okBtn"),press:function(){d.close();}});if(jQuery.isEmptyObject(m)||!m.icon){v=new sap.m.VBox({items:[s]});}else{v=new sap.m.VBox({items:[h,s]});}d=new sap.m.Dialog({id:"aboutContainerDialogID",title:t.getText("about"),contentWidth:"25rem",horizontalScrolling:false,leftButton:o,afterClose:function(){d.destroy();}});d.addContent(v);d.open();};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.footerbar.AboutButtonRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.footerbar.AboutButtonRenderer");jQuery.sap.require('sap.ui.core.Renderer');sap.ushell.ui.footerbar.AboutButtonRenderer=sap.ui.core.Renderer.extend(sap.ushell.ui.launchpad.ActionItemRenderer);}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.footerbar.ContactSupportButton')){jQuery.sap.declare("sap.ushell.ui.footerbar.ContactSupportButton");sap.ushell.ui.launchpad.ActionItem.extend("sap.ushell.ui.footerbar.ContactSupportButton",{metadata:{library:"sap.ushell"}});(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.footerbar.ContactSupportButton");sap.ushell.ui.footerbar.ContactSupportButton.prototype.init=function(){if(sap.ushell.ui.launchpad.ActionItem.prototype.init){sap.ushell.ui.launchpad.ActionItem.prototype.init.apply(this,arguments);}this.setIcon('sap-icon://email');this.setText(sap.ushell.resources.i18n.getText("contactSupportBtn"));this.attachPress(this.showContactSupportDialog);this.setEnabled();};sap.ushell.ui.footerbar.ContactSupportButton.prototype.showContactSupportDialog=function(){jQuery.sap.require("sap.ushell.services.Container");jQuery.sap.require("sap.ui.layout.form.SimpleForm");jQuery.sap.require("sap.ui.layout.form.SimpleFormLayout");jQuery.sap.require("sap.m.TextArea");jQuery.sap.require("sap.m.Link");jQuery.sap.require("sap.m.Label");jQuery.sap.require("sap.m.Text");jQuery.sap.require("sap.m.Dialog");jQuery.sap.require("sap.m.Button");jQuery.sap.require("sap.ushell.UserActivityLog");this.translationBundle=sap.ushell.resources.i18n;this.oClientContext=sap.ushell.UserActivityLog.getMessageInfo();this.oLink=new sap.m.Link({text:this.translationBundle.getText("technicalDataLink")});this.oBottomSimpleForm=new sap.ui.layout.form.SimpleForm("bottomForm",{editable:false,content:[this.oLink]});this.sendButton=new sap.m.Button("contactSupportSendBtn",{text:this.translationBundle.getText("sendBtn"),enabled:false,press:function(){var s=sap.ushell.Container.getService("SupportTicket"),t=this.oTextArea.getValue(),S={text:t,clientContext:this.oClientContext},p=s.createTicket(S);p.done(function(){sap.ushell.Container.getService("Message").info(this.translationBundle.getText("supportTicketCreationSuccess"));}.bind(this));p.fail(function(){sap.ushell.Container.getService("Message").error(this.translationBundle.getText("supportTicketCreationFailed"));}.bind(this));this.oDialog.close();}.bind(this)});this.cancelButton=new sap.m.Button("contactSupportCancelBtn",{text:this.translationBundle.getText("cancelBtn"),press:function(){this.oDialog.close();}.bind(this)});this.oTextArea=new sap.m.TextArea("textArea",{rows:7,liveChange:function(){if(/\S/.test(this.oTextArea.getValue())){this.sendButton.setEnabled(true);}else{this.sendButton.setEnabled(false);this.oTextArea.setValue("");}}.bind(this)});this.oTopSimpleForm=new sap.ui.layout.form.SimpleForm("topForm",{editable:false,content:[this.oTextArea],layout:sap.ui.layout.form.SimpleFormLayout.ResponsiveGridLayout});this.oDialog=new sap.m.Dialog({id:"ContactSupportDialog",title:this.translationBundle.getText("contactSupportBtn"),contentWidth:"29.6rem",leftButton:this.sendButton,rightButton:this.cancelButton,initialFocus:"textArea",afterOpen:function(){jQuery("#textArea").on("focusout",function(){window.scrollTo(0,0);});},afterClose:function(){this.oDialog.destroy();}.bind(this)}).addStyleClass("sapUshellContactSupportDialog");this.oTextArea.setPlaceholder(this.translationBundle.getText("txtAreaPlaceHolderHeader"));this.oLink.attachPress(this._embedLoginDetailsInBottomForm.bind(this));this.oDialog.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-label",value:this.translationBundle.getText("ContactSupportArialLabel"),writeToDom:true}));this.oDialog.addContent(this.oTopSimpleForm);this.oDialog.addContent(this.oBottomSimpleForm);this.oDialog.open();};sap.ushell.ui.footerbar.ContactSupportButton.prototype._embedLoginDetailsInBottomForm=function(){this.oDialog.removeContent(this.oBottomSimpleForm.getId());this.oBottomSimpleForm.destroy();var a="",u="",b="",B=[];if(this.oClientContext.navigationData.applicationInformation){a=this.oClientContext.navigationData.applicationInformation.applicationType;u=this.oClientContext.navigationData.applicationInformation.url;b=this.oClientContext.navigationData.applicationInformation.additionalInformation;}B.push(new sap.m.Text({text:this.translationBundle.getText("loginDetails")}).addStyleClass('sapUshellContactSupportHeaderInfoText'));B.push(new sap.m.Label({text:this.translationBundle.getText("userFld")}));B.push(new sap.m.Text({text:this.oClientContext.userDetails.fullName||''}));B.push(new sap.m.Label({text:this.translationBundle.getText("serverFld")}));B.push(new sap.m.Text({text:window.location.host}));if(this.oClientContext.userDetails.eMail&&this.oClientContext.userDetails.eMail!==''){B.push(new sap.m.Label({text:this.translationBundle.getText("eMailFld")}));B.push(new sap.m.Text({text:this.oClientContext.userDetails.eMail||''}));}B.push(new sap.m.Label({text:this.translationBundle.getText("languageFld")}));B.push(new sap.m.Text({text:this.oClientContext.userDetails.Language||''}));if(this.oClientContext.shellState==="app"||this.oClientContext.shellState==="standalone"){B.push(new sap.m.Text({text:''}));B.push(new sap.m.Text({text:this.translationBundle.getText("navigationDataFld")}).addStyleClass('sapUshellContactSupportHeaderInfoText'));B.push(new sap.m.Label({text:this.translationBundle.getText("hashFld")}));B.push(new sap.m.Text({text:this.oClientContext.navigationData.navigationHash||''}));B.push(new sap.m.Text({text:''}));B.push(new sap.m.Text({text:this.translationBundle.getText("applicationInformationFld")}).addStyleClass('sapUshellContactSupportHeaderInfoText'));B.push(new sap.m.Label({text:this.translationBundle.getText("applicationTypeFld")}));B.push(new sap.m.Text({text:a}));B.push(new sap.m.Label({text:this.translationBundle.getText("urlFld")}));B.push(new sap.m.Text({text:u}));B.push(new sap.m.Label({text:this.translationBundle.getText("additionalInfoFld")}));B.push(new sap.m.Text({text:b}));}this.oBottomSimpleForm=new sap.ui.layout.form.SimpleForm('technicalInfoBox',{layout:sap.ui.layout.form.SimpleFormLayout.ResponsiveLayout,content:B}).addStyleClass("sapUshellTechnicalInfoBox");if(sap.ui.Device.os.ios&&sap.ui.Device.system.phone){this.oBottomSimpleForm.addStyleClass("sapUshellContactSupportFixWidth");}var o=this.oBottomSimpleForm.onAfterRendering;this.oBottomSimpleForm.onAfterRendering=function(){o.apply(this,arguments);var n=jQuery(this.getDomRef());n.attr("tabIndex",0);jQuery.sap.delayedCall(700,n,function(){this.focus();});};this.oDialog.addContent(this.oBottomSimpleForm);};sap.ushell.ui.footerbar.ContactSupportButton.prototype.setEnabled=function(e){if(!sap.ushell.Container){if(this.getEnabled()){jQuery.sap.log.warning("Disabling 'Contact Support' button: unified shell container not initialized",null,"sap.ushell.ui.footerbar.ContactSupportButton");}e=false;}sap.ushell.ui.launchpad.ActionItem.prototype.setEnabled.call(this,e);};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.footerbar.ContactSupportButtonRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.footerbar.ContactSupportButtonRenderer");jQuery.sap.require('sap.ui.core.Renderer');sap.ushell.ui.footerbar.ContactSupportButtonRenderer=sap.ui.core.Renderer.extend(sap.ushell.ui.launchpad.ActionItemRenderer);}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.footerbar.EndUserFeedback')){jQuery.sap.declare("sap.ushell.ui.footerbar.EndUserFeedback");sap.ushell.ui.launchpad.ActionItem.extend("sap.ushell.ui.footerbar.EndUserFeedback",{metadata:{library:"sap.ushell",properties:{"showAnonymous":{type:"boolean",group:"Misc",defaultValue:true},"anonymousByDefault":{type:"boolean",group:"Misc",defaultValue:true},"showLegalAgreement":{type:"boolean",group:"Misc",defaultValue:true},"showCustomUIContent":{type:"boolean",group:"Misc",defaultValue:true},"feedbackDialogTitle":{type:"string",group:"Misc",defaultValue:null},"textAreaPlaceholder":{type:"string",group:"Misc",defaultValue:null}},aggregations:{"customUIContent":{type:"sap.ui.core.Control",multiple:true,singularName:"customUIContent"}}}});(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.footerbar.EndUserFeedback");sap.ushell.ui.footerbar.EndUserFeedback.prototype.init=function(){if(sap.ushell.ui.launchpad.ActionItem.prototype.init){sap.ushell.ui.launchpad.ActionItem.prototype.init.apply(this,arguments);}jQuery.sap.require("sap.ushell.services.Container");var u=sap.ushell.Container.getUser(),f=sap.ushell.utils.getFormFactor();this.oUserDetails={userId:u.getId(),eMail:u.getEmail()};this.translationBundle=sap.ushell.resources.i18n;this.oEndUserFeedbackService=sap.ushell.Container.getService("EndUserFeedback");this.appConfiguration=sap.ushell.services.AppConfiguration;this.oEndUserFeedbackModel=new sap.ui.model.json.JSONModel();this.oEndUserFeedbackModel.setData({feedbackViewTitle:this.translationBundle.getText("userFeedback_title"),legalAgreementViewTitle:this.translationBundle.getText("userFeedbackLegal_title"),textAreaPlaceholderText:this.translationBundle.getText("feedbackPlaceHolderHeader"),presentationStates:{showAnonymous:this.getShowAnonymous(),showLegalAgreement:this.getShowLegalAgreement(),showCustomUIContent:this.getShowCustomUIContent()},clientContext:{userDetails:jQuery.extend(true,{},this.oUserDetails),navigationData:{formFactor:f,applicationInformation:{},navigationHash:null}},isAnonymous:this.getAnonymousByDefault(),applicationIconPath:'',leftButton:{feedbackView:this.translationBundle.getText("sendBtn"),legalAgreementView:this.translationBundle.getText("approveBtn")},rightButton:{feedbackView:this.translationBundle.getText("cancelBtn"),legalAgreementView:this.translationBundle.getText("declineBtn")},states:{isLegalAgreementChecked:false,isRatingSelected:false,isInFeedbackView:true},technicalLink:{state:0,title:[this.translationBundle.getText("technicalDataLink"),this.translationBundle.getText("technicalDataLinkHide")]},textArea:{inputText:''},contextText:'',ratingButtons:[{text:sap.ushell.resources.i18n.getText("ratingExcellentText"),color:'sapUshellRatingLabelFeedbackPositiveText',iconSymbol:'sap-icon://BusinessSuiteInAppSymbols/icon-face-very-happy',id:'rateBtn1',index:1},{text:sap.ushell.resources.i18n.getText("ratingGoodText"),color:'sapUshellRatingLabelFeedbackPositiveText',iconSymbol:'sap-icon://BusinessSuiteInAppSymbols/icon-face-happy',id:'rateBtn2',index:2},{text:sap.ushell.resources.i18n.getText("ratingAverageText"),color:'sapUshellRatingLabelFeedbackNeutralText',iconSymbol:'sap-icon://BusinessSuiteInAppSymbols/icon-face-neutral',id:'rateBtn3',index:3},{text:sap.ushell.resources.i18n.getText("ratingPoorText"),color:'sapUshellRatingLabelFeedbackCriticalText',iconSymbol:'sap-icon://BusinessSuiteInAppSymbols/icon-face-bad',id:'rateBtn4',index:4},{text:sap.ushell.resources.i18n.getText("ratingVeyPoorText"),color:'sapUshellRatingLabelFeedbackNegativeText',iconSymbol:'sap-icon://BusinessSuiteInAppSymbols/icon-face-very-bad',id:'rateBtn5',index:5}],selectedRating:{text:'',color:'',index:0}});this.setIcon('sap-icon://marketing-campaign');this.setText(sap.ushell.resources.i18n.getText("endUserFeedbackBtn"));this.attachPress(this.ShowEndUserFeedbackDialog);this.setEnabled();};sap.ushell.ui.footerbar.EndUserFeedback.prototype.ShowEndUserFeedbackDialog=function(){this.updateModelContext();if(this.oDialog){this.updateTechnicalInfo();this.oDialog.open();return;}jQuery.sap.require("sap.ui.layout.form.SimpleForm");jQuery.sap.require("sap.ui.layout.HorizontalLayout");jQuery.sap.require("sap.ui.layout.VerticalLayout");jQuery.sap.require("sap.m.TextArea");jQuery.sap.require("sap.m.Link");jQuery.sap.require("sap.m.Label");jQuery.sap.require("sap.m.Text");jQuery.sap.require("sap.m.Dialog");jQuery.sap.require("sap.m.Button");jQuery.sap.require("sap.m.Image");var m=jQuery.sap.getModulePath("sap.ushell"),d=m+'/themes/base/img/launchpadDefaultIcon.jpg',i=this.oEndUserFeedbackModel.getProperty('/clientContext/navigationData/formFactor')==='desktop';this.oLegalAgreementInfoLayout=null;this.oBackButton=new sap.m.Button('endUserFeedbackBackBtn',{visible:{path:"/states/isInFeedbackView",formatter:function(I){return!I;}},icon:sap.ui.core.IconPool.getIconURI("nav-back"),press:function(){this.oEndUserFeedbackModel.setProperty('/states/isInFeedbackView',true);}.bind(this),tooltip:sap.ushell.resources.i18n.getText("feedbackGoBackBtn_tooltip")});this.oPopoverTitle=new sap.m.Text("PopoverTitle",{text:{parts:[{path:'/states/isInFeedbackView'},{path:'/feedbackViewTitle'}],formatter:function(I){return this.oEndUserFeedbackModel.getProperty(I?"/feedbackViewTitle":"/legalAgreementViewTitle");}.bind(this)}});this.oHeadBar=new sap.m.Bar({contentLeft:[this.oBackButton],contentMiddle:[this.oPopoverTitle]});this.oLogoImg=new sap.m.Image('sapFeedbackLogo',{src:d,width:'4.5rem',height:'4.5rem',visible:{path:'/applicationIconPath',formatter:function(b){return!b;}}});this.oAppIcon=new sap.ui.core.Icon('sapFeedbackAppIcon',{src:'{/applicationIconPath}',width:'4.5rem',height:'4.5rem',visible:{path:'/applicationIconPath',formatter:function(b){return!!b;}}}).addStyleClass("sapUshellFeedbackAppIcon");this.oContextName=new sap.m.Text('contextName',{text:'{/contextText}'});this.oContextLayout=new sap.ui.layout.HorizontalLayout('contextLayout',{content:[this.oLogoImg,this.oAppIcon,this.oContextName]});this.oRatingLabel=new sap.m.Label('ratingLabel',{required:true,text:sap.ushell.resources.i18n.getText("ratingLabelText")});this.oRatingSelectionText=new sap.m.Text('ratingSelectionText',{text:{path:'/selectedRating',formatter:function(s){if(this.lastSelectedColor){this.removeStyleClass(this.lastSelectedColor);}if(s.color){this.addStyleClass(s.color);}this.lastSelectedColor=s.color;return s.text;}}});this.oRatingButtonTemplate=new sap.m.Button({icon:'{iconSymbol}',height:'100%',width:'20%',tooltip:'{text}'});this.oRatingButtonTemplate.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-label",value:'{text}',writeToDom:true}));this.oRatingButtons=new sap.m.SegmentedButton('ratingButtons',{selectedButton:'noDefalut',buttons:{path:"/ratingButtons",template:this.oRatingButtonTemplate},select:function(e){var I=e.mParameters.id,p=sap.ui.getCore().byId(I).getBindingContext().getPath(),b=this.oEndUserFeedbackModel.getProperty(p);this.oEndUserFeedbackModel.setProperty('/selectedRating',{text:b.text,color:b.color,index:b.index});this.oEndUserFeedbackModel.setProperty('/states/isRatingSelected',true);}.bind(this)});this.oRatingButtons.addAriaLabelledBy("ratingLabel");this.oRatingButtons.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-required",value:'true',writeToDom:true}));if(i){this.oRatingIndicationLayout=new sap.ui.layout.HorizontalLayout('ratingIndicationLayout',{content:[this.oRatingLabel,this.oRatingSelectionText]});}else{this.oRatingIndicationLayout=new sap.ui.layout.VerticalLayout('ratingIndicationLayoutMob',{content:[this.oRatingLabel,this.oRatingSelectionText]});}this.oRatingLayout=new sap.ui.layout.VerticalLayout('ratingLayout',{width:"100%",content:[this.oRatingIndicationLayout,this.oRatingButtons]});this.oAnonymousCheckbox=new sap.m.CheckBox('anonymousCheckbox',{name:'anonymousCheckbox',visible:'{/presentationStates/showAnonymous}',text:sap.ushell.resources.i18n.getText("feedbackSendAnonymousText"),selected:!this.oEndUserFeedbackModel.getProperty("/isAnonymous"),select:function(e){var c=e.getParameter("selected");this._handleAnonymousSelection(!c);}.bind(this)});var a=(!this.oEndUserFeedbackModel.getProperty("/presentationStates/showAnonymous")||this.oEndUserFeedbackModel.getProperty("/isAnonymous"));this._handleAnonymousSelection(a);this.oLegalAgrementCheckbox=new sap.m.CheckBox('legalAgreement',{name:'legalAgreement',visible:'{/presentationStates/showLegalAgreement}',selected:'{/states/isLegalAgreementChecked}',text:this.translationBundle.getText("agreementAcceptanceText")});this.oLegalAgreeementLink=new sap.m.Link('legalAgreementLink',{text:this.translationBundle.getText("legalAgreementLinkText"),visible:'{/presentationStates/showLegalAgreement}',press:function(){var p=this.oEndUserFeedbackService.getLegalText();p.done(this._showLegalAgreementInfo.bind(this));}.bind(this)});this.aCustomUIContent=jQuery.extend([],this.getCustomUIContent());this.oCustomUILayout=new sap.ui.layout.VerticalLayout('customUILayout',{visible:{path:'/presentationStates/showCustomUIContent',formatter:function(s){return(s&&this.aCustomUIContent.length)?true:false;}.bind(this)},content:this.getCustomUIContent(),width:"100%"});this.oLegalLayout=new sap.ui.layout.VerticalLayout('legalLayout',{content:[this.oAnonymousCheckbox,this.oLegalAgrementCheckbox,this.oLegalAgreeementLink]});this.oTechnicalDataLink=new sap.m.Link('technicalDataLink',{text:{path:'/technicalLink/state',formatter:function(s){return this.getModel().getProperty('/technicalLink/title/'+s);}},press:function(){var _=this.oEndUserFeedbackModel.getProperty("/technicalLink/state");this.oEndUserFeedbackModel.setProperty('/technicalLink/state',Math.abs(_-1));this.oDialog.rerender();}.bind(this)});this.oTechnicalDataLayout=new sap.ui.layout.HorizontalLayout('technicalDataLayout',{content:[this.oTechnicalDataLink]});this.leftButton=new sap.m.Button("EndUserFeedbackLeftBtn",{text:{path:"/states/isInFeedbackView",formatter:function(I){return this.getModel().getProperty('/leftButton/'+(I?'feedbackView':'legalAgreementView'));}},enabled:{parts:[{path:'/states/isInFeedbackView'},{path:'/states/isLegalAgreementChecked'},{path:'/states/isRatingSelected'},{path:'/presentationStates/showLegalAgreement'}],formatter:function(I,b,c,s){return!I||(c&&(b||!s));}},press:function(){var I=this.oEndUserFeedbackModel.getProperty("/states/isInFeedbackView");if(I){var f={feedbackText:this.oEndUserFeedbackModel.getProperty('/textArea/inputText'),ratings:[{questionId:"Q10",value:this.oEndUserFeedbackModel.getProperty('/selectedRating/index')}],clientContext:this.oEndUserFeedbackModel.getProperty('/clientContext'),isAnonymous:this.oEndUserFeedbackModel.getProperty('/isAnonymous')},p=this.oEndUserFeedbackService.sendFeedback(f);p.done(function(){sap.ushell.Container.getService("Message").info(this.translationBundle.getText('feedbackSendToastTxt'));}.bind(this));p.fail(function(){sap.ushell.Container.getService("Message").error(this.translationBundle.getText('feedbackFailedToastTxt'));}.bind(this));this.oDialog.close();}else{this.oEndUserFeedbackModel.setProperty('/states/isInFeedbackView',true);this.oEndUserFeedbackModel.setProperty('/states/isLegalAgreementChecked',true);}}.bind(this)});this.rightButton=new sap.m.Button("EndUserFeedbackRightBtn",{text:{path:"/states/isInFeedbackView",formatter:function(I){return this.getModel().getProperty('/rightButton/'+(I?'feedbackView':'legalAgreementView'));}},press:function(){var I=this.oEndUserFeedbackModel.getProperty("/states/isInFeedbackView");if(I){this.oDialog.close();}else{this.oEndUserFeedbackModel.setProperty('/states/isInFeedbackView',true);this.oEndUserFeedbackModel.setProperty('/states/isLegalAgreementChecked',false);}}.bind(this)});this.oTextArea=new sap.m.TextArea("feedbackTextArea",{rows:6,value:'{/textArea/inputText}',placeholder:'{/textAreaPlaceholderText}'});this.oDialog=new sap.m.Dialog({id:"UserFeedbackDialog",contentWidth:"25rem",leftButton:this.leftButton,rightButton:this.rightButton,stretch:sap.ui.Device.system.phone,initialFocus:"textArea",afterOpen:function(){jQuery("#textArea").on("focusout",function(){window.scrollTo(0,0);});}}).addStyleClass("sapUshellEndUserFeedbackDialog");this.oDialog.setModel(this.oEndUserFeedbackModel);this.oDialog.setCustomHeader(this.oHeadBar);this.oDialog.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-label",value:this.translationBundle.getText("endUserFeedbackAreaLabel"),writeToDom:true}));this.oTechnicalInfoBoxLayout=this._createTechnicalDataContent();this.oFeedbackLayout=new sap.ui.layout.VerticalLayout('feedbackLayout',{visible:'{/states/isInFeedbackView}',content:[this.oContextLayout,this.oRatingLayout,this.oTextArea,this.oTechnicalDataLayout,this.oTechnicalInfoBoxLayout,this.oLegalLayout,this.oCustomUILayout]}).addStyleClass("sapUshellFeedbackLayout");this.oMainLayout=new sap.ui.layout.VerticalLayout("mainLayout",{editable:false,content:[this.oFeedbackLayout]});this.oDialog.addContent(this.oMainLayout);this.oDialog.open();};sap.ushell.ui.footerbar.EndUserFeedback.prototype._handleAnonymousSelection=function(i){var a=this.translationBundle.getText('feedbackAnonymousTechFld');this.oEndUserFeedbackModel.setProperty('/isAnonymous',i);this.oEndUserFeedbackModel.setProperty('/clientContext/userDetails/eMail',i?a:this.oUserDetails.eMail);this.oEndUserFeedbackModel.setProperty('/clientContext/userDetails/userId',i?a:this.oUserDetails.userId);};sap.ushell.ui.footerbar.EndUserFeedback.prototype._createTechnicalDataContent=function(){this.oTechnicalInfoBox=new sap.ui.layout.form.SimpleForm('feedbackTechnicalInfoBox',{layout:sap.ui.layout.form.SimpleFormLayout.ResponsiveLayout,content:this.getTechnicalInfoContent()});if(sap.ui.Device.os.ios&&sap.ui.Device.system.phone){this.oTechnicalInfoBox.addStyleClass("sapUshellContactSupportFixWidth");}var o=this.oTechnicalInfoBox.onAfterRendering;this.oTechnicalInfoBox.onAfterRendering=function(){o.apply(this,arguments);var n=jQuery(this.getDomRef());n.attr("tabIndex",0);jQuery.sap.delayedCall(700,n,function(){this.focus();});};return new sap.ui.layout.HorizontalLayout('technicalInfoBoxLayout',{visible:{path:'/technicalLink/state',formatter:function(s){return s===1;}},content:[this.oTechnicalInfoBox]});};sap.ushell.ui.footerbar.EndUserFeedback.prototype._createLegalAgreementLayout=function(l){this.oLegalText=new sap.m.TextArea('legalText',{cols:50,rows:22});this.oLegalText.setValue([l]);this.oLegalText.setEditable(false);var o=this.oLegalText.onAfterRendering;this.oLegalText.onAfterRendering=function(){if(o){o.apply(this,arguments);}var j=jQuery(this.getDomRef());j.find("textarea").attr("tabindex","0");};this.oLegalAgreementInfoLayout=new sap.ui.layout.VerticalLayout('legalAgreementInfoLayout',{visible:{path:"/states/isInFeedbackView",formatter:function(i){return!i;}},content:[this.oLegalText]});this.oMainLayout.addContent(this.oLegalAgreementInfoLayout);};sap.ushell.ui.footerbar.EndUserFeedback.prototype._showLegalAgreementInfo=function(l){this.oEndUserFeedbackModel.setProperty('/states/isInFeedbackView',false);if(!this.oLegalAgreementInfoLayout){this._createLegalAgreementLayout(l);}};sap.ushell.ui.footerbar.EndUserFeedback.prototype.addCustomUIContent=function(c){var i=c&&c.getMetadata&&c.getMetadata().getStereotype&&c.getMetadata().getStereotype()==='control';if(i){if(this.getShowCustomUIContent()){this.oEndUserFeedbackModel.setProperty('/presentationStates/showCustomUIContent',true);}this.addAggregation('customUIContent',c);}};sap.ushell.ui.footerbar.EndUserFeedback.prototype.setShowAnonymous=function(v){if(typeof v==='boolean'){this.oEndUserFeedbackModel.setProperty('/presentationStates/showAnonymous',v);this.setProperty('showAnonymous',v,true);}};sap.ushell.ui.footerbar.EndUserFeedback.prototype.setAnonymousByDefault=function(v){if(typeof v==='boolean'){this.oEndUserFeedbackModel.setProperty('/isAnonymous',v);this.setProperty('anonymousByDefault',v,true);}};sap.ushell.ui.footerbar.EndUserFeedback.prototype.setShowLegalAgreement=function(v){if(typeof v==='boolean'){this.oEndUserFeedbackModel.setProperty('/presentationStates/showLegalAgreement',v);this.setProperty('showLegalAgreement',v,true);}};sap.ushell.ui.footerbar.EndUserFeedback.prototype.setShowCustomUIContent=function(v){if(typeof v==='boolean'){this.oEndUserFeedbackModel.setProperty('/presentationStates/showCustomUIContent',v);this.setProperty('showCustomUIContent',v,true);}};sap.ushell.ui.footerbar.EndUserFeedback.prototype.setFeedbackDialogTitle=function(v){if(typeof v==='string'){this.oEndUserFeedbackModel.setProperty('/feedbackViewTitle',v);this.setProperty('feedbackDialogTitle',v,true);}};sap.ushell.ui.footerbar.EndUserFeedback.prototype.setTextAreaPlaceholder=function(v){if(typeof v==='string'){this.oEndUserFeedbackModel.setProperty('/textAreaPlaceholderText',v);this.setProperty('textAreaPlaceholder',v,true);}};sap.ushell.ui.footerbar.EndUserFeedback.prototype.updateModelContext=function(){var u=sap.ushell.Container.getService("URLParsing"),h,p,i,c,s,U;h=u.getShellHash(window.location);p=u.parseShellHash(h);i=(p!==undefined)?p.semanticObject+"-"+p.action:"";c=this.getModel().getProperty("/currentState/stateName");if(c==="home"||c==="catalog"){s=this.translationBundle.getText(c+'_title');}this.currentApp=this.appConfiguration.getCurrentAppliction();this.bHasAppName=(this.currentApp&&this.appConfiguration.getMetadata(this.currentApp)&&this.appConfiguration.getMetadata(this.currentApp).title);this.sAppIconPath=(this.currentApp&&this.appConfiguration.getMetadata(this.currentApp)&&this.appConfiguration.getMetadata(this.currentApp).icon);this.oEndUserFeedbackModel.setProperty('/contextText',this.bHasAppName?this.appConfiguration.getMetadata(this.currentApp).title:this.translationBundle.getText('feedbackHeaderText'));U=null;if(this.currentApp&&this.currentApp.url){U=this.currentApp.url.split('?')[0];}else if(c){U=this.translationBundle.getText("flp_page_name");}this.oEndUserFeedbackModel.setProperty('/clientContext/navigationData/applicationInformation',{url:U,additionalInformation:(this.currentApp&&this.currentApp.additionalInformation)?this.currentApp.additionalInformation:null,applicationType:(this.currentApp&&this.currentApp.applicationType)?this.currentApp.applicationType:null});this.oEndUserFeedbackModel.setProperty('/clientContext/navigationData/navigationHash',s?s:i);this.oEndUserFeedbackModel.setProperty('/selectedRating',{text:'',color:'',index:0});this.oEndUserFeedbackModel.setProperty('/states/isRatingSelected',false);this.oEndUserFeedbackModel.setProperty('/states/isLegalAgreementChecked',false);this.oEndUserFeedbackModel.setProperty('/technicalLink/state',0);this.oEndUserFeedbackModel.setProperty('/textArea/inputText','');this.oEndUserFeedbackModel.setProperty('/applicationIconPath',this.sAppIconPath);this._handleAnonymousSelection(this.oEndUserFeedbackModel.getProperty('/isAnonymous'));};sap.ushell.ui.footerbar.EndUserFeedback.prototype.updateTechnicalInfo=function(){this.oTechnicalInfoBox.destroyContent();this.oTechnicalInfoBox.removeAllContent();var t=this.getTechnicalInfoContent(),c;for(c in t){this.oTechnicalInfoBox.addContent(t[c]);}this.oRatingButtons.setSelectedButton('noDefalut');};sap.ushell.ui.footerbar.EndUserFeedback.prototype.getTechnicalInfoContent=function(){var f=[],F=this.oEndUserFeedbackModel.getProperty('/clientContext/navigationData/formFactor'),u=this.oEndUserFeedbackModel.getProperty('/clientContext/userDetails/userId'),e=this.oEndUserFeedbackModel.getProperty('/clientContext/userDetails/eMail'),a=this.oEndUserFeedbackModel.getProperty('/clientContext/navigationData/applicationInformation/url'),A=this.oEndUserFeedbackModel.getProperty('/clientContext/navigationData/applicationInformation/applicationType'),s=this.oEndUserFeedbackModel.getProperty('/clientContext/navigationData/applicationInformation/additionalInformation'),n=this.oEndUserFeedbackModel.getProperty('/clientContext/navigationData/navigationHash'),c=this.getModel().getProperty("/currentState/stateName"),d=(c==="home"||c==="catalog")?false:true;f.push(new sap.m.Text({text:this.translationBundle.getText("loginDetails")}).addStyleClass('sapUshellContactSupportHeaderInfoText'));f.push(u?new sap.m.Label({text:this.translationBundle.getText("userFld")}):null);f.push(u?new sap.m.Text('technicalInfoUserIdTxt',{text:'{/clientContext/userDetails/userId}'}):null);f.push(e?new sap.m.Label({text:this.translationBundle.getText("eMailFld")}):null);f.push(e?new sap.m.Text({text:'{/clientContext/userDetails/eMail}'}):null);f.push(F?new sap.m.Label({text:this.translationBundle.getText('formFactorFld')}):null);f.push(F?new sap.m.Text({text:'{/clientContext/navigationData/formFactor}'}):null);f.push(new sap.m.Text({text:''}));f.push(new sap.m.Text({text:this.translationBundle.getText(this.currentApp?'applicationInformationFld':'feedbackHeaderText')}).addStyleClass('sapUshellEndUserFeedbackHeaderInfoText').addStyleClass("sapUshellEndUserFeedbackInfoTextSpacing"));f.push(a&&d?new sap.m.Label({text:this.translationBundle.getText("urlFld")}):null);f.push(a&&d?new sap.m.Text({text:'{/clientContext/navigationData/applicationInformation/url}'}):null);f.push(A?new sap.m.Label({text:this.translationBundle.getText("applicationTypeFld")}):null);f.push(A?new sap.m.Text({text:'{/clientContext/navigationData/applicationInformation/applicationType}'}):null);f.push(s?new sap.m.Label({text:this.translationBundle.getText("additionalInfoFld")}):null);f.push(s?new sap.m.Text({text:'{/clientContext/navigationData/applicationInformation/additionalInformation}'}):null);f.push(n&&d?new sap.m.Label({text:this.translationBundle.getText("hashFld")}):null);f.push(n&&d?new sap.m.Text({text:'{/clientContext/navigationData/navigationHash}'}):null);return f.filter(Boolean);};sap.ushell.ui.footerbar.EndUserFeedback.prototype.setEnabled=function(e){if(!sap.ushell.Container){if(this.getEnabled()){jQuery.sap.log.warning("Disabling 'End User Feedback' button: unified shell container not initialized",null,"sap.ushell.ui.footerbar.EndUserFeedback");}e=false;}sap.ushell.ui.launchpad.ActionItem.prototype.setEnabled.call(this,e);};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.footerbar.EndUserFeedbackRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.footerbar.EndUserFeedbackRenderer");jQuery.sap.require('sap.ui.core.Renderer');sap.ushell.ui.footerbar.EndUserFeedbackRenderer=sap.ui.core.Renderer.extend(sap.ushell.ui.launchpad.ActionItemRenderer);}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.footerbar.HideGroupsButton')){jQuery.sap.declare("sap.ushell.ui.footerbar.HideGroupsButton");sap.ushell.ui.launchpad.ActionItem.extend("sap.ushell.ui.footerbar.HideGroupsButton",{metadata:{library:"sap.ushell",events:{"save":{}}}});sap.ushell.ui.footerbar.HideGroupsButton.M_EVENTS={'save':'save'};(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.footerbar.HideGroupsButton");sap.ushell.ui.footerbar.HideGroupsButton.prototype.init=function(){if(sap.ushell.ui.launchpad.ActionItem.prototype.init){sap.ushell.ui.launchpad.ActionItem.prototype.init.apply(this,arguments);}this.setIcon('sap-icon://group-2');this.setTooltip(sap.ushell.resources.i18n.getText("hideGroupsBtn_tooltip"));this.setText(sap.ushell.resources.i18n.getText("hideGroupsBtn_title"));this.attachPress(this.openHideGroupsDialog);};sap.ushell.ui.footerbar.HideGroupsButton.prototype.openHideGroupsDialog=function(){jQuery.sap.require("sap.m.Dialog");jQuery.sap.require("sap.m.Button");jQuery.sap.require("sap.m.Table");jQuery.sap.require("sap.m.Switch");var t=this;this.oModel=this.getModel();this.handleChange=function(a){var b=a.oSource.getParent(),g=b.getBindingContextPath(),c=this.oModel.getProperty(g);var d=jQuery.grep(this.aGroupsStates,function(G){return G.groupId===c.groupId;})[0];if(d){d.isGroupVisible=!d.isGroupVisible;}b.toggleStyleClass('sapUshellHideGroupsTableItem');b.getCells()[0].toggleStyleClass('sapUshellHideGroupsDisabledCell');}.bind(this);var s=function(a,l){return a&&!l;};this.groupsTableTemplate=new sap.m.ColumnListItem({cells:[new sap.m.Text({text:"{title}"}),new sap.m.Switch({visible:{parts:[{path:"isEnabled"},{path:"isGroupLocked"}],formatter:s},change:t.handleChange,customTextOff:" ",customTextOn:" ",tooltip:sap.ushell.resources.i18n.getText("hideGroups_switchTooltip")})]});this.groupsTable=new sap.m.Table("sapUshellHideGroupsTable",{backgroundDesign:sap.m.BackgroundDesign.Transparent,showSeparators:sap.m.ListSeparators.Inner,columns:[new sap.m.Column({vAlign:"Middle"}),new sap.m.Column({hAlign:sap.ui.core.TextAlign.Right,vAlign:"Middle",width:"4.94rem"})]});this.groupsTable.addStyleClass('sapUshellHideGroupsTable');var o=this.groupsTable.onAfterRendering;this.groupsTable.onAfterRendering=function(a){o.apply(t.groupsTable,arguments);var b=a.srcControl.mAggregations.items;if(b){var m=b[0].getModel(),i,g;for(i=0;i<b.length;i++){g=m.getProperty(b[i].getBindingContextPath());b[i].getCells()[1].setState(g.isGroupVisible);if(g&&g.isGroupLocked&&(g.tiles.length===0||!sap.ushell.utils.groupHasVisibleTiles(g.tiles))){b[i].setVisible(false);}else if(!b[i].getCells()[1].getState()){b[i].addStyleClass('sapUshellHideGroupsTableItem');b[i].getCells()[0].addStyleClass('sapUshellHideGroupsDisabledCell');}}}setTimeout(function(){jQuery('.sapMListTblRow').first().focus();},200);};this.groupsTable.setModel(this.getModel());var p=this.getModel().getProperty("/personalization");var e=[];if(!p){e.push(new sap.ui.model.Filter("tiles/length",sap.ui.model.FilterOperator.GT,0));}this.groupsTable.bindItems({path:"/groups",template:this.groupsTableTemplate,filters:e});this.saveButton=new sap.m.Button("saveBtn",{text:sap.ushell.resources.i18n.getText("okBtn"),press:function(){setTimeout(function(){var m=this.getModel();var g=t.aGroupsStates;if(g){var l=sap.ushell.Container.getService("LaunchPage");var h=[],i,a;for(i=0;i<g.length;i++){if(!g[i].isGroupVisible){a=l.getGroupId(g[i].object);h.push(a);}}l.hideGroups(h).done(function(){m.setProperty("/groups",g);t.handleToastMessage(h.length);t.fireSave();}).fail(function(){var b=new sap.ushell.ui.launchpad.EmbeddedSupportErrorMessage("HideGroupsErrorMessage",{title:sap.ushell.resources.i18n.getText("error"),content:new sap.m.Text({text:sap.ushell.resources.i18n.getText("hideGroups_error")})});b.open();});}}.bind(this),100);this.oDialog.close();}.bind(this)});this.handleToastMessage=function(n){var m="";if(typeof n===undefined){return;}if(n===0){m=sap.ushell.resources.i18n.getText("hideGroups_none");}else if(n===1){m=sap.ushell.resources.i18n.getText("hideGroups_single");}else{m=sap.ushell.resources.i18n.getText("hideGroups_multiple",n);}sap.ushell.Container.getService("Message").show(sap.ushell.services.Message.Type.INFO,m);};this.cancelButton=new sap.m.Button("CancelBtn",{text:sap.ushell.resources.i18n.getText("cancelBtn"),press:function(){if(t.aGroupsOriginalStates){var g=this.getModel().getProperty('/groups'),i;for(i=0;i<t.aGroupsOriginalStates.length;i++){if(g[i].groupId===t.aGroupsOriginalStates[i].groupId){g[i].isGroupVisible=t.aGroupsOriginalStates[i].isVisible;}}}this.oDialog.close();}.bind(this)});this.oDialog=new sap.m.Dialog({id:"groupsVisibilityDialog",title:sap.ushell.resources.i18n.getText("hideGroups_title"),contentWidth:"29.6rem",contentHeight:"36.07rem",stretch:sap.ui.Device.system.phone,content:this.groupsTable,beginButton:this.saveButton,endButton:this.cancelButton,initialFocus:"groupsVisibilityDialog",afterClose:function(){this.oDialog.destroy();}.bind(this)}).addStyleClass("sapUshellGroupsVisibilityDialog");this.oDialog.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-label",value:sap.ushell.resources.i18n.getText("hideGroupsDialog_ariaLabel"),writeToDom:true}));this.getModelStates=function(g){if(!g){return;}var S=[],i;for(i=0;i<g.length;i++){S.push({groupId:g[i].groupId,isVisible:g[i].isGroupVisible});}return S;};this.aGroupsStates=this.oModel.getProperty('/groups');this.aGroupsOriginalStates=this.getModelStates(this.aGroupsStates);this.oDialog.open();};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.footerbar.HideGroupsButtonRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.footerbar.HideGroupsButtonRenderer");jQuery.sap.require('sap.ui.core.Renderer');sap.ushell.ui.footerbar.HideGroupsButtonRenderer=sap.ui.core.Renderer.extend(sap.ushell.ui.launchpad.ActionItemRenderer);}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.footerbar.LogoutButton')){jQuery.sap.declare("sap.ushell.ui.footerbar.LogoutButton");sap.ushell.ui.launchpad.ActionItem.extend("sap.ushell.ui.footerbar.LogoutButton",{metadata:{library:"sap.ushell"}});(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.footerbar.LogoutButton");sap.ushell.ui.footerbar.LogoutButton.prototype.init=function(){if(sap.ushell.ui.launchpad.ActionItem.prototype.init){sap.ushell.ui.launchpad.ActionItem.prototype.init.apply(this,arguments);}this.setIcon('sap-icon://log');this.setTooltip(sap.ushell.resources.i18n.getText("signoutBtn_tooltip"));this.setText(sap.ushell.resources.i18n.getText("signoutBtn_title"));this.attachPress(this.logout);this.setEnabled();};sap.ushell.ui.footerbar.LogoutButton.prototype.logout=function(){jQuery.sap.require('sap.m.MessageBox');var s=true,i=false,l=new sap.ushell.ui.launchpad.LoadingDialog({text:""});sap.ushell.Container.getGlobalDirty().done(function(d){s=false;if(i===true){l.exit();l=new sap.ushell.ui.launchpad.LoadingDialog({text:""});}var _=function(d){var L={},r=sap.ushell.resources.i18n;if(d===sap.ushell.Container.DirtyState.DIRTY){L.message=r.getText('unsaved_data_warning_popup_message');L.icon=sap.m.MessageBox.Icon.WARNING;L.messageTitle=r.getText("unsaved_data_warning_popup_title");}else{L.message=r.getText('signoutConfirmationMsg');L.icon=sap.m.MessageBox.Icon.QUESTION;L.messageTitle=r.getText("signoutMsgTitle");}return L;};var L=_(d);sap.m.MessageBox.show(L.message,L.icon,L.messageTitle,[sap.m.MessageBox.Action.OK,sap.m.MessageBox.Action.CANCEL],function(a){if(a===sap.m.MessageBox.Action.OK){l.openLoadingScreen();l.showAppInfo(sap.ushell.resources.i18n.getText('beforeLogoutMsg'),null);sap.ushell.Container.logout();}},sap.ui.core.ElementMetadata.uid("confirm"));});if(s===true){l.openLoadingScreen();i=true;}};sap.ushell.ui.footerbar.LogoutButton.prototype.setEnabled=function(e){if(!sap.ushell.Container){if(this.getEnabled()){jQuery.sap.log.warning("Disabling 'Logout' button: unified shell container not initialized",null,"sap.ushell.ui.footerbar.LogoutButton");}e=false;}sap.ushell.ui.launchpad.ActionItem.prototype.setEnabled.call(this,e);};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.footerbar.LogoutButtonRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.footerbar.LogoutButtonRenderer");jQuery.sap.require('sap.ui.core.Renderer');sap.ushell.ui.footerbar.LogoutButtonRenderer=sap.ui.core.Renderer.extend(sap.ushell.ui.launchpad.ActionItemRenderer);}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.footerbar.UserPreferencesButton')){jQuery.sap.declare("sap.ushell.ui.footerbar.UserPreferencesButton");sap.ushell.ui.launchpad.ActionItem.extend("sap.ushell.ui.footerbar.UserPreferencesButton",{metadata:{library:"sap.ushell"}});(function(){"use strict";jQuery.sap.require('sap.m.Dialog');jQuery.sap.require('sap.m.Button');jQuery.sap.declare("sap.ushell.ui.footerbar.UserPreferencesButton");sap.ushell.ui.footerbar.UserPreferencesButton.prototype.init=function(){if(sap.ushell.ui.launchpad.ActionItem.prototype.init){sap.ushell.ui.launchpad.ActionItem.prototype.init.apply(this,arguments);}this.setIcon('sap-icon://person-placeholder');this.translationBundle=sap.ushell.resources.i18n;this.setText(this.translationBundle.getText("userSettings"));this.setTooltip(this.translationBundle.getText("settings_tooltip"));this.attachPress(this.showUserPreferencesDialog);};sap.ushell.ui.footerbar.UserPreferencesButton.prototype.createDialog=function(){var s;var c;var t=this;s=this._createSaveButton();c=this._createCancelButton();this.oDialog=new sap.m.Dialog({id:"userPreferencesDialog",title:"{/userPreferences/dialogTitle}",contentWidth:"29.6rem",content:null,contentHeight:"17rem",buttons:[s,c],afterClose:function(){this._destroyDialog();this.oUser.resetChangedProperties();}.bind(t),stretch:sap.ui.Device.system.phone}).addStyleClass("sapUshellUserPreferencesDialog");this._addDialogBackButton();this.oDialog.setModel(this.getModel());this.oDialog.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-label",value:t.translationBundle.getText("Settings_Dialog_Main_label"),writeToDom:true}));this.oDialog.addContent(this._getOriginalDialogContent());};sap.ushell.ui.footerbar.UserPreferencesButton.prototype._getOriginalDialogContent=function(){if(!this.oInitialContent){var u;var e;u=this._getUserDetailsControl();e=this._getEntryListControl();this.oInitialContent=new sap.ui.layout.VerticalLayout('userPreferencesLayout',{content:[u,e],width:"100%"});}return this.oInitialContent;};sap.ushell.ui.footerbar.UserPreferencesButton.prototype._getEntryListControl=function(){var e=this._getUserPrefEntriesTemplate();var x=this.getModel()&&this.getModel().getProperty('/enableHelp');var t=this,u=this.oUser.getFullName();var a=new sap.m.List('userPrefEnteryList',{items:{path:"/userPreferences/entries",template:e}});a.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-label",value:t.translationBundle.getText("Settings_EntryList_label")+u,writeToDom:true}));var o=a.onAfterRendering;a.onAfterRendering=function(){var E=this.getItems();var b;o.apply(this,arguments);for(var i=0;i<E.length;i++){b=E[i].getBindingContext().getPath();if(!t.getModel().getProperty(b+"/valueResult")){t._setEntryValueResult(b);}if(x){t._addXRayHelpId(b,E[i]);}}};return a;};sap.ushell.ui.footerbar.UserPreferencesButton.prototype._addXRayHelpId=function(e,l){var h=this.getModel().getProperty(e+"/entryHelpID");if(h){l.addStyleClass("help-id-"+h);}};sap.ushell.ui.footerbar.UserPreferencesButton.prototype._setEntryValueResult=function(e){var t=this;var i=this.getModel().getProperty(e+"/editable");var v=this.getModel().getProperty(e+"/valueArgument");if(typeof v==="function"){this.getModel().setProperty(e+"/valueResult",this.translationBundle.getText("genericLoading"));this.getModel().setProperty(e+"/editable",false);var V=v();V.done(function(a){t.getModel().setProperty(e+"/editable",i);t.getModel().setProperty(e+"/visible",typeof(a)==='object'?!!a.value:true);t.getModel().setProperty(e+"/valueResult",typeof(a)==='object'?a.displayText:a);});V.fail(function(){t.getModel().setProperty(e+"/valueResult",t.translationBundle.getText("loadingErrorMessage"));});}else if(!!v){this.getModel().setProperty(e+"/valueResult",v);this.getModel().setProperty(e+"/editable",i);}else{this.getModel().setProperty(e+"/valueResult",this.translationBundle.getText("loadingErrorMessage"));}};sap.ushell.ui.footerbar.UserPreferencesButton.prototype._getUserPrefEntriesTemplate=function(){var t=this;var p=function(e){var a=true;var b=e.getSource().getLabel();var c=e.getSource().getBindingContext().getPath();t.getModel().setProperty("/userPreferences/activeEntryPath",c);t._setDetailedEntryModeMode(true,c,b,c);t.oDialog.removeAllContent();var C=t.getModel().getProperty(c+"/contentResult");if(C){t.oDialog.addContent(C);}else{var B=null;var s=true,I=false;var d=t.getModel().getProperty(c+"/contentFunc");if(typeof d==="function"){t.getModel().setProperty(c+"/isDirty",true);var o=d();o.done(function(f){s=false;if(I===true){t.oDialog.removeAllContent();B.destroy();}if(f instanceof sap.ui.core.Control){t.getModel().setProperty(c+"/contentResult",f);t.oDialog.addContent(f);}else{a=false;}});o.fail(function(){s=false;if(I===true){t.oDialog.removeAllContent();B.destroy();}a=false;});o.always(function(){if(a===false){var E=new sap.m.FlexBox("userPrefErrorFlexBox",{height:"5rem",alignItems:sap.m.FlexAlignItems.Center,justifyContent:sap.m.FlexJustifyContent.Center,items:[new sap.m.Text("userPrefErrorText",{text:t.translationBundle.getText("loadingErrorMessage")})]});t.getModel().setProperty(c+"/contentResult",E);t.oDialog.addContent(E);}});if(s===true){B=new sap.m.BusyIndicator('userPrefLoadingBusyIndicator',{size:"2rem"});t.oDialog.addContent(B);I=true;}}}};var i=new sap.m.DisplayListItem({label:"{title}",value:"{valueResult}",tooltip:{path:"valueResult",formatter:function(v){return typeof(v)==='string'?v:"";}},type:{path:"editable",formatter:function(e){return(e===true)?"Navigation":"Inactive";}},visible:{path:"visible",formatter:function(v){return(v!==undefined)?v:true;}},press:p,customData:new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"aria-label",value:{parts:[{path:'title'},{path:'valueResult'}],formatter:function(T,v){v=v?v:"";return T+" "+v;}},writeToDom:true})});return i;};sap.ushell.ui.footerbar.UserPreferencesButton.prototype._getUserDetailsControl=function(){return new sap.m.ObjectIdentifier({title:this.oUser.getFullName(),text:this.oUser.getEmail()}).addStyleClass("sapUshellUserPrefUserIdentifier");};sap.ushell.ui.footerbar.UserPreferencesButton.prototype._createCancelButton=function(){var t=this;return new sap.m.Button({id:"cancelButton",text:{parts:['/userPreferences/entries'],formatter:function(e){var E=e.some(function(o){return o.editable;});return E>0?t.translationBundle.getText("cancelBtn"):t.translationBundle.getText("close");}},press:t._dialogCancelButtonHandler.bind(t),visible:true});};sap.ushell.ui.footerbar.UserPreferencesButton.prototype._createSaveButton=function(){var t=this;return new sap.m.Button({id:"saveButton",text:this.translationBundle.getText("saveBtn"),press:t._dialogSaveButtonHandler.bind(t),visible:{parts:['/userPreferences/entries'],formatter:function(e){return e.some(function(E){return E.editable;});}}});};sap.ushell.ui.footerbar.UserPreferencesButton.prototype._setDetailedEntryModeMode=function(i,e,a,b){this.getModel().setProperty("/userPreferences/isDetailedEntryMode",!!i);this.getModel().setProperty("/userPreferences/dialogTitle",a);};sap.ushell.ui.footerbar.UserPreferencesButton.prototype.showUserPreferencesDialog=function(){this.oUser=sap.ushell.Container.getUser();this.createDialog();this.oDialog.open();};sap.ushell.ui.footerbar.UserPreferencesButton.prototype._dialogBackButtonHandler=function(e){this.getModel().setProperty("/userPreferences/isDetailedEntryMode",false);this.getModel().setProperty("/userPreferences/dialogTitle",this.translationBundle.getText("userSettings"));this.oDialog.removeAllContent();this.oDialog.addContent(this._getOriginalDialogContent());this._setEntryValueResult(this.getModel().getProperty("/userPreferences/activeEntryPath"));this.getModel().setProperty("/userPreferences/activeEntryPath",null);};sap.ushell.ui.footerbar.UserPreferencesButton.prototype._destroyDialog=function(){this.oHeadBar.destroy();this.oInitialContent.destroy();this.oInitialContent=null;this._modelCleanUpToInitial();this._entriesCleanUp();this.oDialog.destroy();};sap.ushell.ui.footerbar.UserPreferencesButton.prototype._entriesCleanUp=function(){var e=this.getModel().getProperty("/userPreferences/entries");for(var i=0;i<e.length;i++){if(e[i].contentResult){e[i].contentResult.destroy();e[i].contentResult=null;}e[i].isDirty=false;e[i].valueResult=null;}this.getModel().setProperty("/userPreferences/entries",e);};sap.ushell.ui.footerbar.UserPreferencesButton.prototype._modelCleanUpToInitial=function(){this.getModel().setProperty("/userPreferences/isDetailedEntryMode",false);this.getModel().setProperty("/userPreferences/dialogTitle",this.translationBundle.getText("userSettings"));};sap.ushell.ui.footerbar.UserPreferencesButton.prototype._dialogSaveButtonHandler=function(){var s;s=this._saveUserPrefEntries();var t=this;var i=this.getModel().getProperty("/userPreferences/isDetailedEntryMode");if(i){this.getModel().setProperty("/userPreferences/activeEntryPath",null);}s.done(function(){t._showSaveMessageToast();});s.fail(function(f){jQuery.sap.require("sap.m.MessageBox");var e;var a="";if(f.length===1){e=t.translationBundle.getText("savingEntryError")+" ";}else{e=t.translationBundle.getText("savingEntriesError")+"\n";}f.forEach(function(b){e+=b.entry+"\n";a+="Entry: "+b.entry+" - Error message: "+b.message+"\n";});sap.m.MessageBox.show(e,{icon:sap.m.MessageBox.Icon.ERROR,title:t.translationBundle.getText("Error"),actions:[sap.m.MessageBox.Action.OK]});jQuery.sap.log.error("Failed to save the following entries",a,"sap.ushell.ui.footerbar.UserPreferencesButton");});this.oDialog.close();this._destroyDialog();};sap.ushell.ui.footerbar.UserPreferencesButton.prototype._dialogCancelButtonHandler=function(){var e=this.getModel().getProperty("/userPreferences/entries");for(var i=0;i<e.length;i++){if(e[i]&&e[i].onCancel){e[i].onCancel();}}this.oDialog.close();this._destroyDialog();};sap.ushell.ui.footerbar.UserPreferencesButton.prototype._saveUserPrefEntries=function(){var e=this.getModel().getProperty("/userPreferences/entries");var r=jQuery.Deferred();var w;var c;var t=0;var f=0;var s=0;var p=[];var a=[];var b;var d=function(){s++;r.notify();};var g=function(h){a.push({entry:b,message:h});f++;r.notify();};for(var i=0;i<e.length;i++){if(e[i]&&e[i].isDirty===true){c=e[i].onSave();c.done(d);b=e[i].title;c.fail(g);p.push(c);t++;}}w=jQuery.when.apply(null,p);w.done(function(){r.resolve();});r.progress(function(){if(f>0&&(f+s===t)){r.reject(a);}});return r.promise();};sap.ushell.ui.footerbar.UserPreferencesButton.prototype._addDialogBackButton=function(){var t=this;var b=new sap.m.Button('userPrefBackBtn',{visible:"{/userPreferences/isDetailedEntryMode}",icon:sap.ui.core.IconPool.getIconURI("nav-back"),press:t._dialogBackButtonHandler.bind(t),tooltip:this.translationBundle.getText("feedbackGoBackBtn_tooltip")});var d=new sap.m.Text("userPrefTitle",{text:"{/userPreferences/dialogTitle}"});this.oHeadBar=new sap.m.Bar({contentLeft:[b],contentMiddle:[d]});this.oDialog.setCustomHeader(this.oHeadBar);};sap.ushell.ui.footerbar.UserPreferencesButton.prototype._showSaveMessageToast=function(){jQuery.sap.require("sap.m.MessageToast");var m=this.translationBundle.getText("savedChanges");sap.m.MessageToast.show(m,{duration:3000,width:"15em",my:"center bottom",at:"center bottom",of:window,offset:"0 -50",collision:"fit fit"});};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.footerbar.UserPreferencesButtonRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.footerbar.UserPreferencesButtonRenderer");jQuery.sap.require('sap.ui.core.Renderer');sap.ushell.ui.footerbar.UserPreferencesButtonRenderer=sap.ui.core.Renderer.extend(sap.ushell.ui.launchpad.ActionItemRenderer);}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.CatalogTileContainer')){jQuery.sap.declare('sap.ushell.ui.launchpad.CatalogTileContainer');sap.ui.define("sap/ushell/ui/launchpad/CatalogTileContainer",["sap/ushell/ui/launchpad/TileContainer"],function(c){"use strict";return sap.ushell.ui.launchpad.TileContainer.extend("sap.ushell.ui.launchpad.CatalogTileContainer",{updateTiles:function(r){var n="tiles";if(this.isTreeBinding(n)){sap.ui.base.ManagedObject.prototype.updateAggregation.apply(this,arguments);}else{jQuery.sap.log.debug("Updating TileContainer. Reason: ",r);try{this.filterTiles();}catch(e){this.updateAggregation(n);}}}});});};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.CatalogTileContainerRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.launchpad.CatalogTileContainerRenderer");sap.ushell.ui.launchpad.CatalogTileContainerRenderer={};sap.ushell.ui.launchpad.CatalogTileContainerRenderer=sap.ui.core.Renderer.extend(sap.ushell.ui.launchpad.TileContainerRenderer);}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.HeaderTile')){jQuery.sap.declare("sap.ushell.ui.launchpad.HeaderTile");sap.ushell.ui.launchpad.Tile.extend("sap.ushell.ui.launchpad.HeaderTile",{metadata:{library:"sap.ushell",properties:{"headerLevel":{type:"sap.m.HeaderLevel",group:"Appearance",defaultValue:sap.m.HeaderLevel.H3},"headerText":{type:"string",group:"Appearance",defaultValue:null}}}});};if(!jQuery.sap.isDeclared('sap.ushell.ui.launchpad.PlusTile')){jQuery.sap.declare("sap.ushell.ui.launchpad.PlusTile");sap.ushell.ui.launchpad.Tile.extend("sap.ushell.ui.launchpad.PlusTile",{metadata:{library:"sap.ushell",properties:{"groupId":{type:"string",group:"Misc",defaultValue:''}},events:{"press":{}}}});sap.ushell.ui.launchpad.PlusTile.M_EVENTS={'press':'press'};(function(){"use strict";sap.ushell.ui.launchpad.PlusTile.prototype.init=function(){this.oIcon=new sap.ui.core.Icon({src:'sap-icon://add',tooltip:sap.ushell.resources.i18n.getText("openAppFinder_tooltip")});};sap.ushell.ui.launchpad.PlusTile.prototype.exit=function(){if(this.oIcon){this.oIcon.destroy();}};sap.ushell.ui.launchpad.PlusTile.prototype.onclick=function(){var g=this.getParent().getBindingContext().getObject();if(!g.object){return;}this.firePress();};sap.ushell.ui.launchpad.PlusTile.prototype.onsapspace=function(){this.firePress();};sap.ushell.ui.launchpad.PlusTile.prototype.onsapenter=function(){this.firePress();};sap.ushell.ui.launchpad.PlusTile.prototype.setGroupId=function(v){this.setProperty("groupId",v,true);return this;};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.shell.ShellAppTitle')){
/*!
 * ${copyright}
 */
jQuery.sap.declare('sap.ushell.ui.shell.ShellAppTitle');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.ui.core.IconPool');sap.ui.define("sap/ushell/ui/shell/ShellAppTitle",['jquery.sap.global','sap/m/Button','sap/ui/core/IconPool','sap/ushell/library','./ShellNavigationMenu'],function(q,B,I){"use strict";var S=B.extend("sap.ushell.ui.shell.ShellAppTitle",{metadata:{properties:{text:{type:"string",group:"Misc",defaultValue:null},tooltip:{type:"string",group:"Misc",defaultValue:null}},associations:{navigationMenu:{type:"sap.ushell.ui.shell.ShellNavigationMenu"}},events:{press:{},textChanged:{}}},renderer:{render:function(r,c){var n=c.getNavigationMenu();var t=c.getText();var v=false;if(n){var N=sap.ui.getCore().byId(n);v=N?N.getItems()&&N.getItems().length>0:false;c.bIconVisible=v;}r.write('<div ');r.writeControlData(c);r.addClass("sapUshellShellAppTitleContainer sapUshellAppTitle");if(v){r.write('tabindex="0" ');r.addClass("sapUshellAppTitleClickable");r.writeAttributeEscaped("role","button");r.writeAttributeEscaped("aria-haspopup","true");r.writeAttributeEscaped("aria-expanded","false");r.writeAttributeEscaped("aria-label",sap.ushell.resources.i18n.getText("ShellNavigationMenu_AriaLabel",[t]));}else{r.writeAttributeEscaped("aria-label",t);r.writeAttributeEscaped("aria-haspopup","false");}r.writeClasses();r.write(">");if(v){r.write("<div ");r.addClass("sapUshellShellHeadAction");r.writeClasses();r.write("><span class='sapUshellShellHeadActionImg sapUshellShellAppTitleHeadActionImg'>");r.renderControl(c.oIcon);r.write("</span>");r.write("</div>");}r.write('<h1 class="sapUshellHeadTitle" aria-level="1">');if(t){r.writeEscaped(t);}r.write("</h1>");r.write("</div>");}}});S.prototype.init=function(){if(B.prototype.init){B.prototype.init.apply(this,arguments);}this.oIcon=I.createControlByURI(sap.ui.core.IconPool.getIconURI("slim-arrow-down"));this.oIcon.addStyleClass("sapUshellAppTitleMenuIcon");if(sap.ui.Device.system.desktop){this.addEventDelegate({onkeydown:function(e){if(e.altKey&&e.keyCode==40){e.preventDefault();this.onclick();}}.bind(this)});}this._bTextChanged=false;};S.prototype.setText=function(t){this.setProperty("text",t,false);this._bTextChanged=true;};S.prototype.onAfterRendering=function(){if(this._bTextChanged){this.fireTextChanged();}this._bTextChanged=false;};S.prototype.onclick=function(E){if(!this.bIconVisible){return;}if(!this.oPopover){this.oPopover=new sap.m.Popover("sapUshellAppTitlePopover",{showHeader:false,showArrow:true,placement:sap.m.PlacementType.Bottom}).addStyleClass("sapUshellAppTitleNavigationMenuPopover");this.bAppTitleClick=false;var n=sap.ui.getCore().byId(this.getNavigationMenu());this.oPopover.addContent(n);this.oPopover.attachBeforeOpen(function(){n._beforeOpen();});this.oPopover.attachAfterOpen(function(){this.oPopover.$().on("touchmove.scrollFix",function(e){e.stopPropagation();});n._afterOpen();this._adjustAccProperties(true);}.bind(this));this.oPopover.attachBeforeClose(function(e){if(document.activeElement.id===this.getId()){this.bAppTitleClick=true;}}.bind(this));this.oPopover.attachAfterClose(function(e){this._adjustAccProperties(false);}.bind(this));}if(!sap.ui.Device.system.desktop){if(this.oPopover.isOpen()){this.oPopover.close();}else{this.oPopover.openBy(this);this.firePress();}}else{if(!this.bAppTitleClick){this.oPopover.openBy(this);this.firePress();}else{this.bAppTitleClick=false;}}};S.prototype._adjustAccProperties=function(i){var j=q(this.getDomRef());var i=!!i;j.attr("aria-expanded",i);};S.prototype.close=function(){if(this.oPopover&&this.oPopover.isOpen()){this.oPopover.close();}};S.prototype.setTooltip=function(t){this.oIcon.setTooltip(t);};S.prototype.onsapspace=S.prototype.onclick;S.prototype.onsapenter=S.prototype.onclick;S.prototype.exit=function(){var n=sap.ui.getCore().byId(this.getNavigationMenu());if(n){n.destroy();}if(this.oPopover){this.oPopover.destroy();}};return S;},true);};if(!jQuery.sap.isDeclared('sap.ushell.ui.shell.ShellHeader')){jQuery.sap.declare('sap.ushell.ui.shell.ShellHeader');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ushell/ui/shell/ShellHeader",['jquery.sap.global','sap/ushell/library','./ShellHeadItem','./ShellHeadUserItem','./ShellTitle','./ShellAppTitle'],function(q,S,a,b){"use strict";var s=0,n=0;var l;var L;var c;var d;var e=sap.ui.core.Control.extend("sap.ushell.ui.shell.ShellHeader",{MIN_PADDING_REM_VALUE_LARGE:3,MIN_PADDING_REM_VALUE_SMALL:1,MIN_PADDING_REM_VALUE_SMALL_FOR_SEARCH:0.5,MIN_REM_VALUE_FOR_SEARCH_CONTAINER_SIZE:9,APP_TITLE_MIN_VALUE:3,TITLE_MIN_VALUE:3,TITLE_MAX_WIDTH_VALUE:12,metadata:{properties:{logo:{type:"sap.ui.core.URI",defaultValue:""},showLogo:{type:"boolean",defaultValue:true},searchState:{type:"string",defaultValue:"COL"},ariaLabel:{type:"string",defaultValue:undefined},showSeparators:{type:"boolean",group:"Appearance",defaultValue:true}},aggregations:{headItems:{type:"sap.ushell.ui.shell.ShellHeadItem",multiple:true},headEndItems:{type:"sap.ushell.ui.shell.ShellHeadItem",multiple:true},search:{type:"sap.ui.core.Control",multiple:false},user:{type:"sap.ushell.ui.shell.ShellHeadUserItem",multiple:false},title:{type:"sap.ushell.ui.shell.ShellTitle",multiple:false},appTitle:{type:"sap.ushell.ui.shell.ShellAppTitle",multiple:false}},events:{searchSizeChanged:{}}},renderer:{render:function(r,h){var i=h.getId();r.write("<div");r.writeControlData(h);if(h.getAriaLabel()){r.writeAccessibilityState({label:h.getAriaLabel(),role:"banner"});}r.addClass("sapUshellShellHeader");r.writeClasses();r.write(">");r.write("<div id='",i,"-hdr-begin' class='sapUshellShellHeadBegin'>");this.renderHeaderItems(r,h,true);r.write("</div>");r.write("<div id='",i,"-hdr-center' class='sapUshellShellHeadCenter' >");this.renderTitle(r,h);if(h.getAppTitle()){this.renderAppTitle(r,h);}this.renderSearch(r,h);r.write("</div>");r.write("<div id='",i,"-hdr-end' class='sapUshellShellHeadEnd'>");this.renderHeaderItems(r,h,false);r.write("</div>");r.write("<div tabindex='0' id='sapUshellHeaderAccessibilityHelper'></div>");r.write("</div>");},renderSearch:function(r,h){var o=h.getSearch();r.write("<div id='",h.getId(),"-hdr-search-container'");r.writeAttribute("class","sapUshellShellSearch");r.addStyle("max-width",s+"rem");r.writeStyles();r.write(">");if(o){r.renderControl(o);}r.write("</div>");},renderTitle:function(r,h){var C="sapUshellShellHeadTitle";if(h.getAppTitle()){C="sapUshellShellHeadSubtitle";}r.write("<div id='",h.getId(),"-hdr-title' class='"+C+"'");r.write(">");r.renderControl(h.getTitle());r.write("</div>");},renderAppTitle:function(r,h){r.write("<div id='",h.getId(),"-hdr-appTitle' class='sapUshellShellHeadTitle'>");r.renderControl(h.getAppTitle());r.write("</div>");},renderHeaderItems:function(r,h,f){r.write("<div class='sapUshellShellHeadContainer'>");var t,u,U,I=f?h.getHeadItems():h.getHeadEndItems(),i;for(i=0;i<I.length;i++){I[i]._headerHideSeperators=!h.getShowSeparators();r.renderControl(I[i]);}u=h.getUser();if(!f&&u){r.write("<a tabindex='0'");r.writeElementData(u);r.addClass("sapUshellShellHeadAction sapUshellShellHeadSeparator");r.writeClasses();t=u.getTooltip_AsString();if(t){r.writeAttributeEscaped("title",t);}if(u.getAriaLabel()){r.writeAccessibilityState({label:u.getAriaLabel(),haspopup:"true",role:"button"});}r.write("><span id='",u.getId(),"-img' class='sapUshellShellHeadActionImg'></span>");r.write("<span id='"+u.getId()+"-name' class='sapUshellShellHeadActionName'");r.write(">");U=u.getUsername()||"";r.writeEscaped(U);r.write("</span><span class='sapUshellShellHeadActionExp'></span></a>");}r.write("</div>");if(f){this._renderLogo(r,h);}},_renderLogo:function(r,h){var f=sap.ushell.resources.i18n.getText("SHELL_LOGO_TOOLTIP"),i=h._getLogo(),C="";if(!h.getShowLogo()){C+="sapUshellShellHideIco";}else{C+="sapUshellShellIco";}r.write("<div class='"+C+"'");r.write(">");r.write("<img id='",h.getId(),"-icon'");r.writeAttributeEscaped("title",f);r.writeAttributeEscaped("alt",f);r.write("src='");r.writeEscaped(i);r.write("' style='",i?"":"display:none;","'></img>");r.write("</div>");}}});e.prototype.SearchState={COL:"COL",EXP:"EXP",EXP_S:"EXP_S"};e.prototype.init=function(){var t=this;this._rtl=sap.ui.getCore().getConfiguration().getRTL();this._handleMediaChange=function(p){if(!t.getDomRef()){return;}if(t.getSearchState()!=this.SearchState.COL){this._setMaxWidthForAppTitleAndTitle();t._handleSearchSizeChanged();return;}t._refresh();};sap.ui.Device.media.attachHandler(this._handleMediaChange,this,sap.ui.Device.media.RANGESETS.SAP_STANDARD);this._handleResizeChange=function(){if(!t.getDomRef()){return;}var u=this.getUser();if(t.getUser()){u._checkAndAdaptWidth(!t.$("hdr-search").hasClass("sapUshellShellHidden")&&!!t.getSearch());}if(t.getSearchState()!=this.SearchState.COL){this._setMaxWidthForAppTitleAndTitle();t._handleSearchSizeChanged();return;}t._refresh();};sap.ui.Device.resize.attachHandler(this._handleResizeChange,this);this.data("sap-ui-fastnavgroup","true",true);this.oTitle=null;};e.prototype.exit=function(){sap.ui.Device.media.detachHandler(this._handleMediaChange,this,sap.ui.Device.media.RANGESETS.SAP_STANDARD);delete this._handleMediaChange;sap.ui.Device.resize.detachHandler(this._handleResizeChange,this);delete this._handleResizeChange;if(this.oTitle){this.oTitle.destroy();}};e.prototype.onAfterRendering=function(){var t=this;this._refresh();this.$("icon").one('load',function(){t._refresh();});this.$("hdr-center").toggleClass("sapUshellShellAnim",this.getParent().getShowAnimation());var o=this.$("hdr-search-container");if(s!=n){if(this.getSearchState()==this.SearchState.COL){o.one('transitionend',function(){q(this).addClass("sapUshellShellSearchHidden");});}this._setSearchContainerMaxSize(n,false);var f={remSize:this._convertPxToRem(this.getSearchContainerRect(n).width),isFullWidth:this.isPhoneState()};this.fireSearchSizeChanged(f);}else if(this.getSearchState()==this.SearchState.COL){q(o).addClass("sapUshellShellSearchHidden");}};e.prototype.onThemeChanged=function(){if(this.getDomRef()){this.invalidate();}};e.prototype._getLogo=function(){var i=this.getLogo();if(!i){q.sap.require("sap.ui.core.theming.Parameters");i=sap.ui.core.theming.Parameters._getThemeImage(null,true);}return i;};e.prototype._handleSearchSizeChanged=function(){var f;if(this.getSearchState()==this.SearchState.COL){return;}else if(this.getSearchState()==this.SearchState.EXP){f=s;this._handleExpSearchState(f);}else if(this.getSearchState()==this.SearchState.EXP_S){f=this._handleExpSSearchState();this._setSearchContainerMaxSize(f);}var g={remSize:this._convertPxToRem(this.getSearchContainerRect(f).width),isFullWidth:this.isPhoneState()};this.fireSearchSizeChanged(g);};e.prototype._refresh=function(){var u=this.getUser();if(u){u._refreshImage();u._checkAndAdaptWidth(!!this.getSearch());}if(!this.hasStyleClass("sapUshellShellHideLogo")){this._saveLogoWidth();}this._setMaxWidthForAppTitleAndTitle();if(this.getSearchState()!=this.SearchState.COL){this._adjustHeaderWithSearch();}this._saveSearchPhoneStateThreshold();};e.prototype._saveLogoWidth=function(){var o=this.$("hdr-begin").find(".sapUshellShellIco");if(o){L=parseInt(o.css("padding-left"),10);c=parseInt(o.css("padding-right"),10);l=this.$("icon")[0].getBoundingClientRect().width;}};e.prototype._convertPxToRem=function(p){var r=parseFloat(sap.ui.core.theming.Parameters.get("sapUiFontSize"));return p/r;};e.prototype._convertRemToPx=function(r){var f=parseFloat(sap.ui.core.theming.Parameters.get("sapUiFontSize"));return r*f;};e.prototype._setMaxWidthForAppTitleAndTitle=function(){this._setMaxWidthForAppTitle();if(this.isLSize()){this._setMaxWidthForTitle();}else{this._setAppTitleFontSize();}};e.prototype._setMaxWidthForAppTitle=function(){var j=this.$("hdr-appTitle");var f=this.$("hdr-appTitle").find(".sapUshellHeadTitle");if(!j.length){return;}f.removeClass('sapUshellHeadTitleWithSmallerFontSize');j.css({'max-width':'none'});var C=this._calcCenterWidth();var t=0;if(this.isLSize()){var g=this.$("hdr-title");if(g.length){t=g[0].getBoundingClientRect().width;}}var p=this.isSSize()?this.MIN_PADDING_REM_VALUE_SMALL:this.MIN_PADDING_REM_VALUE_LARGE;var w=this._convertPxToRem(C-t)-2*p;var h=j.find('.sapUshellShellHeadAction');var A=h.length?this.APP_TITLE_MIN_VALUE+1.5:this.APP_TITLE_MIN_VALUE;if(w<A){w=A;}j.css({'max-width':w+"rem"});};e.prototype._calcCenterWidth=function(){var f=this.$("hdr-appTitle")[0].getBoundingClientRect();var h=this.$("hdr-begin")[0].getBoundingClientRect();var g=this.$("hdr-end")[0].getBoundingClientRect();var C;if(this._isOverlapping(h,f)||this._isOverlapping(f,g)){var i=h.width;var j=g.width;var k=this.$()[0].getBoundingClientRect().width;C=k-2*Math.max(i,j);}else{var m=this.$("hdr-center");var C=m[0].getBoundingClientRect().width;}return C;};e.prototype._setMaxWidthForTitle=function(){var j=this.$("hdr-title");if(!j.length){return;}j.css({'max-width':this.TITLE_MAX_WIDTH_VALUE+"rem",'opacity':1});var f=this.$("hdr-appTitle");if(!f||!f[0]){return;}var r=this._isOverlapping(j[0].getBoundingClientRect(),f[0].getBoundingClientRect(),this.MIN_PADDING_REM_VALUE_LARGE,false);if(r){var t=j[0].getBoundingClientRect().width;var T=this._convertPxToRem(t-r);if(T<this.TITLE_MIN_VALUE){j.css({'opacity':0});}else{j.css({'max-width':T+"rem"});}}};e.prototype._setAppTitleFontSize=function(){var A=this.$("hdr-appTitle").find(".sapUshellHeadTitle");if(A&&A[0]){var i=A[0].scrollWidth;var C=A[0].clientWidth;if(i>C){A.addClass('sapUshellHeadTitleWithSmallerFontSize');}}};e.prototype._adjustHeaderWithSearch=function(f){var j=this.$("hdr-appTitle");if(!j.length||j.css('opacity')=="0"||j.css('display')=="none"){return;}var g=j[0].getBoundingClientRect();var h;if(f){h=this.getSearchContainerRect(f);}else{var i=this.$("hdr-search-container");h=this.getSearchContainerRect(parseFloat(i.get(0).style.maxWidth));}var o=this._isOverlapping(g,h,this.MIN_PADDING_REM_VALUE_SMALL_FOR_SEARCH,true);if(!o){return;}else if(o){var A=g.width;j.css({'max-width':this._convertPxToRem(A-o)+"rem"});}};e.prototype.setAppTitle=function(A){A.attachTextChanged(this._handleAppTitleChange,this);this.setAggregation("appTitle",A,true);};e.prototype.removeAppTitle=function(A){A.detachedTextChanged(this._handleAppTitleChange);this.removeAggregation("appTitle");};e.prototype._handleAppTitleChange=function(){if(!this.getDomRef()){return;}if(this.getSearchState()!=this.SearchState.COL){this._setMaxWidthForAppTitleAndTitle();this._handleSearchSizeChanged();}};e.prototype.setTitleControl=function(t,i){this.oTitle=this.oTitle||sap.ui.getCore().byId("shellTitle");if(this.oTitle){this.oTitle.destroy();}this.oTitle=new sap.ushell.ui.shell.ShellTitle("shellTitle",{text:t,icon:sap.ui.core.IconPool.getIconURI("overflow")});this.oTitle.setInnerControl(i);this.setTitle(this.oTitle);};e.prototype.removeHeadItem=function(i){if(typeof i==='number'){i=this.getHeadItems()[i];}this.removeAggregation('headItems',i);};e.prototype.addHeadItem=function(i){this.addAggregation('headItems',i);};e.prototype.isPhoneState=function(){var f=sap.ui.Device.media.getCurrentRange(sap.ui.Device.media.RANGESETS.SAP_STANDARD).name;var E=true;var h=this.$().width();if(h<=d){E=false;}return(sap.ui.Device.system.phone||f=="Phone"||!E);};e.prototype.isLSize=function(){var f=sap.ui.Device.media.getCurrentRange(sap.ui.Device.media.RANGESETS.SAP_STANDARD).name;return(f=="Desktop");};e.prototype.isSSize=function(){var f=sap.ui.Device.media.getCurrentRange(sap.ui.Device.media.RANGESETS.SAP_STANDARD).name;return(sap.ui.Device.system.phone||f=="Phone");};e.prototype.getSearchContainerRect=function(m){var j=q("<div> </div>").css("max-width",m+"rem");var f=q("<div></div>").append(j).insertAfter(this.$("hdr-search-container"));j.addClass('sapUshellShellSearch');var t=j[0].getBoundingClientRect();f.remove();return t;};e.prototype.setSearchState=function(f,m,w){if(typeof f!=="string"||!this.SearchState.hasOwnProperty(f)){return;}this.requiredRemSize=m;this.setProperty('searchState',f,false);var g;if(f==this.SearchState.COL){g=this._handleColSearchState(true);}else if(f==this.SearchState.EXP){if(w==undefined||w==null){this.bWithOverlay=true;}else{this.bWithOverlay=w;}g=this._handleExpSearchState(m,true);}else if(f==this.SearchState.EXP_S){g=this._handleExpSSearchState(m,true);}this._setSearchContainerMaxSize(g,true);};e.prototype.getSearchAvailableSize=function(){var f=this._convertPxToRem(this._getSizeToAppTitle());var g=f-this._getMinPaddingRemSize();return(g>=0?g:0);};e.prototype._getSizeToAppTitle=function(){var C=this.$("hdr-center");var o=C[0];var A=this.$("hdr-appTitle").find(".sapUshellAppTitle");var f=A[0];var m;if(this._rtl){m=f?f.getBoundingClientRect().left-o.getBoundingClientRect().left:this._getSizeToTitle();}else{m=f?o.getBoundingClientRect().right-f.getBoundingClientRect().right:this._getSizeToTitle();}return m;};e.prototype._getSizeToTitle=function(){var C=this.$("hdr-center");var o=C[0];var t=this.$("hdr-title").find(".sapUshellHeadTitle");var T=t[0];var m;if(this._rtl){m=T?T.getBoundingClientRect().left-o.getBoundingClientRect().left:this._getSizeToLogo();}else{m=T?o.getBoundingClientRect().right-T.getBoundingClientRect().right:this._getSizeToLogo();}return m;};e.prototype._getSizeToLogo=function(){var C=this.$("hdr-center");var o=C[0];var f=o.getBoundingClientRect().width+this._getSearchButtonWidth();var g=this.$("hdr-begin").find(".sapUshellShellIco");var h=g[0];var i=false;if(this.hasStyleClass("sapUshellShellHideLogo")){i=true;}if(h&&i){var j=this._rtl?c:L;return f-l-j;}else{var j=this._rtl?L:c;return f+j;}};e.prototype._getMaxSize=function(){var C=this.$("hdr-center");var o=C[0];var f=this.$("hdr-begin").find(".sapUshellShellIco");var g=f[0];var h=false;if(this.hasStyleClass("sapUshellShellHideLogo")){h=true;}var i;if(g&&!h){var j=this._rtl?L:c;i=l+j;}else{i=0;}var m=o.getBoundingClientRect().width+this._getSearchButtonWidth()+i;return m;};e.prototype._getSearchButtonWidth=function(){var o=this.getHeadEndItems()[0];if(o&&o.getVisible()){var f=o.getDomRef();var i=f.getBoundingClientRect().width;return i;}return 0;};e.prototype._handleColSearchState=function(f){var g=this.getParent();if(g){g.removeStyleClass("sapUshellShellShowSearchOverlay");}this.removeStyleClass("sapUshellShellHideLogo");this.removeStyleClass("sapUshellShellHideSubtitle");this.removeStyleClass("sapUshellShellHideAppTitle");if(this.isPhoneState()){return this._handleColSearchStatePhone();}return 0;};e.prototype._handleExpSearchState=function(r,f){if(this.isPhoneState()){this._handleExpAndExpSSearchStatePhone();return r;}else{return this._handleExpSearchStateLargeScreen(r,f);}};e.prototype._handleExpSearchStateLargeScreen=function(r,f){var g;this.removeStyleClass("sapUshellShellHideForPhone");var h=this.getParent();if(h&&this.bWithOverlay){h.addStyleClass("sapUshellShellShowSearchOverlay");}var m=this._convertPxToRem(this._getMaxSize());var M=this._convertPxToRem(this._getSizeToTitle());var i=this._convertPxToRem(this._getSizeToAppTitle());var j=this._convertPxToRem(this._getSizeToLogo());if(r>m){this.addStyleClass("sapUshellShellHideLogo");this.addStyleClass("sapUshellShellHideSubtitle");this.addStyleClass("sapUshellShellHideAppTitle");g=m;}else if(r>j-this._getMinPaddingRemSize()){this.addStyleClass("sapUshellShellHideLogo");this.addStyleClass("sapUshellShellHideSubtitle");this.addStyleClass("sapUshellShellHideAppTitle");g=r;}else if(r>M-this._getMinPaddingRemSize()){this.addStyleClass("sapUshellShellHideSubtitle");this.addStyleClass("sapUshellShellHideAppTitle");this.removeStyleClass("sapUshellShellHideLogo");g=r;}else if(r>i-this._getMinPaddingRemSize()){this.addStyleClass("sapUshellShellHideAppTitle");this.removeStyleClass("sapUshellShellHideSubtitle");this.removeStyleClass("sapUshellShellHideLogo");g=r;}else{this.removeStyleClass("sapUshellShellHideAppTitle");this.removeStyleClass("sapUshellShellHideSubtitle");this.removeStyleClass("sapUshellShellHideLogo");g=r;}return g;};e.prototype._handleExpSSearchState=function(r,f){var g=this.getParent();if(g){g.removeStyleClass("sapUshellShellShowSearchOverlay");}if(this.isPhoneState()){this._handleExpAndExpSSearchStatePhone();return r;}else{var h=this._handleExpSSearchStateLargeScreen(r,f);if(h>this.requiredRemSize){h=this.requiredRemSize;}return h;}};e.prototype._handleExpSSearchStateLargeScreen=function(r,f){var g;this.removeStyleClass("sapUshellShellHideForPhone");var m=this._convertPxToRem(this._getSizeToAppTitle());if(m-this._getMinPaddingRemSize()<this.MIN_REM_VALUE_FOR_SEARCH_CONTAINER_SIZE){m=this.MIN_REM_VALUE_FOR_SEARCH_CONTAINER_SIZE+this._getMinPaddingRemSize();}if(!r){r=m;}if(r>m-this._getMinPaddingRemSize()){g=m-this._getMinPaddingRemSize();}else{g=r;}this.removeStyleClass("sapUshellShellHideLogo");this.removeStyleClass("sapUshellShellHideSubtitle");this.removeStyleClass("sapUshellShellHideAppTitle");return g;};e.prototype._handleExpAndExpSSearchStatePhone=function(){this.addStyleClass("sapUshellShellHideForPhone");var f=this.getParent();if(f&&this.getSearchState()==this.SearchState.EXP&&this.bWithOverlay){f.addStyleClass("sapUshellShellShowSearchOverlay");}};e.prototype._handleColSearchStatePhone=function(){this.removeStyleClass("sapUshellShellHideForPhone");return 0;};e.prototype._setSearchContainerMaxSize=function(f,g){if(!g){var o=this.$("hdr-search-container");o.css("max-width",f+"rem");s=n=f;}else{n=f;}this._adjustHeaderWithSearch(f);};e.prototype._getMinPaddingRemSize=function(){if(this._convertPxToRem(this._getSizeToAppTitle())<this.MIN_REM_VALUE_FOR_SEARCH_CONTAINER_SIZE){return this.MIN_PADDING_REM_VALUE_SMALL_FOR_SEARCH;}else{return this.MIN_PADDING_REM_VALUE_LARGE;}};e.prototype._saveSearchPhoneStateThreshold=function(){if(this.hasStyleClass("sapUshellShellHideForPhone")){return;}var i=this.getSearchAvailableSize();if(i==0){i=-this.MIN_PADDING_REM_VALUE_SMALL_FOR_SEARCH;}var m=this._maxRemToRemoveFromAppTitle();if(i+m<this.MIN_REM_VALUE_FOR_SEARCH_CONTAINER_SIZE){var h=this.$().width();d=h+this._convertRemToPx(this.MIN_REM_VALUE_FOR_SEARCH_CONTAINER_SIZE-i-m);}return d;};e.prototype._maxRemToRemoveFromAppTitle=function(){var j=this.$("hdr-appTitle");var f=j.find(".sapUshellHeadTitle");if(!j.length||!f.length){return 0;}var A=this._convertPxToRem(f[0].getBoundingClientRect().width);var m=(A-this.APP_TITLE_MIN_VALUE)>0?(A-this.APP_TITLE_MIN_VALUE):0;return m;};e.prototype._isOverlapping=function(f,g,p,P){if(!p){p=0;}if(this._rtl){var j=f.left;var h=g.right;if(P){j=j-this._convertRemToPx(p);}else{h=h+this._convertRemToPx(p);}if(j<h){return h-j;}}else{var i=f.right;var k=g.left;if(P){i=i+this._convertRemToPx(p);}else{k=k-this._convertRemToPx(p);}if(k<i){return i-k;}}return 0;};return e;},true);};if(!jQuery.sap.isDeclared('sap.ushell.ui.shell.ToolArea')){jQuery.sap.declare('sap.ushell.ui.shell.ToolArea');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.Device');sap.ui.define("sap/ushell/ui/shell/ToolArea",['jquery.sap.global','sap/ushell/library','sap/ui/Device','./ToolAreaItem'],function(q,l,D,T){"use strict";var a=sap.ui.core.Control.extend("sap.ushell.ui.shell.ToolArea",{metadata:{properties:{size:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:'56px'},textVisible:{type:"boolean",group:"Appearance",defaultValue:true}},aggregations:{toolAreaItems:{type:"sap.ushell.ui.shell.ToolAreaItem",multiple:true}}},renderer:{render:function(r,t){if(!t.getToolAreaItems().length){return;}else{var i=t.getId();r.write("<div");r.writeControlData(t);r.writeAttribute("class","sapUshellToolArea");r.write(">");r.write("<div id='",i,"-cntnt' class='sapUshellToolAreaContainer'>");this.renderToolAreaItems(r,t);r.write("</div>");}},renderToolAreaItems:function(r,t){var I=t.getToolAreaItems(),i;for(i=0;i<I.length;i++){r.write("<div");r.addClass("sapUshellToolAreaContent");if(I[i].getSelected()){r.addClass("sapUshellToolAreaItemSelected");}r.writeClasses();r.write(">");r.renderControl(I[i]);r.write("</div>");r.write("<div class='sapUshellToolAreaContentSeparator'></div>");}}}});a.prototype.init=function(){D.media.attachHandler(this._setSize,this);D.resize.attachHandler(this._setSize,this);};a.prototype.addToolAreaItem=function(t){var s=!!this.getToolAreaItems.length;if(!this.getVisible()){this.setVisible(true);}this.addAggregation("toolAreaItems",t,s);if(this.getDomRef()){var r=sap.ui.getCore().createRenderManager();r.renderControl(t);r.flush(this.getDomRef());r.destroy();}};a.prototype.removeToolAreaItem=function(i){var t=this.getToolAreaItems(),o=typeof i==='object'?i:t[i];this.removeAggregation("toolAreaItems",o);if(this.getToolAreaItems().length<1){this.setVisible(false);}};a.prototype.onBeforeRendering=function(){var I=this.getToolAreaItems(),i;this._bRenderText=I.length;for(i=0;i<I.length;i++){if(!I[i].getText()){this._bRenderText=false;}}};a.prototype._setSize=function(){var s=q(".sapUshellToolArea").width()/16;if(!this._bRenderText){this.setProperty("textVisible",false,true);s=q(".sapUshellToolAreaItm").height()/16;this.$().toggleClass("sapUshellToolAreaTextHidden",true);}this.setProperty("size",s+"rem",true);};a.prototype.onAfterRendering=function(){if(this.getToolAreaItems().length){this.setVisible(true);this._setSize();}};return a;},true);};if(!jQuery.sap.isDeclared('sap.ushell.ui.tile.DynamicTile')){
/*!
 * Copyright (c) 2009-2014 SAP SE, All Rights Reserved
 */
jQuery.sap.declare("sap.ushell.ui.tile.DynamicTile");sap.ushell.ui.tile.TileBase.extend("sap.ushell.ui.tile.DynamicTile",{metadata:{library:"sap.ushell",properties:{"numberValue":{type:"string",group:"Data",defaultValue:'0.0'},"numberState":{type:"sap.ushell.ui.tile.State",group:"Appearance",defaultValue:sap.ushell.ui.tile.State.Neutral},"numberUnit":{type:"string",group:"Data",defaultValue:null},"numberDigits":{type:"int",group:"Appearance",defaultValue:0},"stateArrow":{type:"sap.ushell.ui.tile.StateArrow",group:"Appearance",defaultValue:sap.ushell.ui.tile.StateArrow.None},"numberFactor":{type:"string",group:"Data",defaultValue:null}}}});};if(!jQuery.sap.isDeclared('sap.ushell.ui.tile.DynamicTileRenderer')){(function(){"use strict";jQuery.sap.require('sap.ui.core.Renderer');jQuery.sap.declare("sap.ushell.ui.tile.DynamicTileRenderer");jQuery.sap.require('sap.ushell.ui.tile.State');jQuery.sap.require('sap.ui.core.format.NumberFormat');sap.ushell.ui.tile.DynamicTileRenderer=sap.ui.core.Renderer.extend(sap.ushell.ui.tile.TileBaseRenderer);var t=sap.ushell.resources.i18n;sap.ushell.ui.tile.DynamicTileRenderer.renderPart=function(r,c){var n=c.getNumberValue(),a=c.getNumberFactor(),d=n.toString();var m=c.getIcon()?4:5;var s=this._shouldProcessDigits(d,c);if(d.length>m||s){var N=this._normalizeNumber(n,m,a,c);a=N.numberFactor;d=N.displayNumber;}else if(d!==""){var o=sap.ui.core.format.NumberFormat.getFloatInstance({maxFractionDigits:m});d=o.format(n);}r.write("<div");r.addClass("sapUshellDynamicTile");r.writeClasses();r.write(">");r.write("<div");r.addClass("sapUshellDynamicTileData");r.addClass((c.getNumberState()?"sapUshellDynamicTileData"+c.getNumberState():"sapUshellDynamicTileData"+sap.ushell.ui.tile.State.Neutral));r.writeClasses();r.write(">");r.write("<div class='sapUshellDynamicTileIndication'>");if(c.getStateArrow()){r.write("<div");r.addClass("sapUshellDynamicTileStateArrow");r.addClass("sapUshellDynamicTileData"+c.getStateArrow());r.writeClasses();r.write(">");r.write("</div>");}r.write('<br><div');r.addClass("sapUshellDynamicTileNumberFactor");r.writeClasses();r.writeAccessibilityState(c,{label:t.getText("TileUnits_lable")+a});r.write('>');r.writeEscaped(a);r.write('</div>');r.write("</div>");r.write('<div');r.addClass("sapUshellDynamicTileNumber");r.writeClasses();if(d&&d!==""){r.writeAccessibilityState(c,{label:t.getText("TileValue_lable")+d});r.write('>');r.writeEscaped(d);}else{r.write('>');r.writeEscaped(c.getNumberValue());}r.write('</div>');r.write("</div>");r.write("</div>");};sap.ushell.ui.tile.DynamicTileRenderer._normalizeNumber=function(n,m,a,c){var b;if(isNaN(n)){b=n;}else{var N=sap.ui.core.format.NumberFormat.getFloatInstance({maxFractionDigits:c.getNumberDigits()});if(!a){if(n>=1000000000){a='B';n/=1000000000;}else if(n>=1000000){a='M';n/=1000000;}else if(n>=1000){a='K';n/=1000;}}b=N.format(n);}var d=b;var e=d[m-1];m-=(e==='.'||e===',')?1:0;d=d.substring(0,m);return{displayNumber:d,numberFactor:a};};sap.ushell.ui.tile.DynamicTileRenderer._shouldProcessDigits=function(d,c){var n=c.getNumberDigits(),a;if(d.indexOf('.')!==-1){a=d.split(".")[1].length;if(a>n){return true;}}return false;};sap.ushell.ui.tile.DynamicTileRenderer.getInfoPrefix=function(c){return c.getNumberUnit();};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.tile.ImageTile')){jQuery.sap.declare("sap.ushell.ui.tile.ImageTile");sap.ushell.ui.tile.TileBase.extend("sap.ushell.ui.tile.ImageTile",{metadata:{library:"sap.ushell",properties:{"imageSource":{type:"string",group:"Appearance",defaultValue:null}}}});};if(!jQuery.sap.isDeclared('sap.ushell.ui.tile.ImageTileRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.tile.ImageTileRenderer");jQuery.sap.require('sap.ui.core.Renderer');sap.ushell.ui.tile.ImageTileRenderer=sap.ui.core.Renderer.extend(sap.ushell.ui.tile.TileBaseRenderer);sap.ushell.ui.tile.ImageTileRenderer.renderPart=function(r,c){r.write("<img");r.addClass("sapUshellImageTile");r.writeClasses();r.writeAttributeEscaped("src",c.getImageSource());r.write("/>");};}());};if(!jQuery.sap.isDeclared('sap.ushell.ui.tile.StaticTile')){jQuery.sap.declare("sap.ushell.ui.tile.StaticTile");sap.ushell.ui.tile.TileBase.extend("sap.ushell.ui.tile.StaticTile",{metadata:{library:"sap.ushell"}});};if(!jQuery.sap.isDeclared('sap.ushell.ui.tile.StaticTileRenderer')){(function(){"use strict";jQuery.sap.declare("sap.ushell.ui.tile.StaticTileRenderer");jQuery.sap.require('sap.ui.core.Renderer');sap.ushell.ui.tile.StaticTileRenderer=sap.ui.core.Renderer.extend(sap.ushell.ui.tile.TileBaseRenderer);sap.ushell.ui.tile.StaticTileRenderer.renderPart=function(r,c){r.write("<span");r.addClass("sapUshellStaticTile");r.writeClasses();r.write(">");r.write("</span>");};}());};if(!jQuery.sap.isDeclared('sap.ushell.adapters.local.AppStateAdapter')){(function(){"use strict";jQuery.sap.declare("sap.ushell.adapters.local.AppStateAdapter");sap.ushell.adapters.local.AppStateAdapter=function(s,p,c){this._oConfig=c&&c.config;};sap.ushell.adapters.local.AppStateAdapter.prototype._getPersonalizationService=function(){return sap.ushell.Container.getService("Personalization");};sap.ushell.adapters.local.AppStateAdapter.prototype.saveAppState=function(k,s,v,a,c){var p=this._getPersonalizationService(),d=new jQuery.Deferred();p.createEmptyContainer(k,{keyCategory:p.constants.keyCategory.GENERATED_KEY,writeFrequency:p.constants.writeFrequency.HIGH,clientStorageAllowed:false}).done(function(C){C.setItemValue("appStateData",v);C.save().done(function(){d.resolve();}).fail(function(m){d.reject(m);jQuery.sap.log.error(m);});}).fail(function(m){jQuery.sap.log.error(m);d.reject(m);});return d.promise();};sap.ushell.adapters.local.AppStateAdapter.prototype.loadAppState=function(k){var p=this._getPersonalizationService(),d=new jQuery.Deferred();p.getContainer(k,{keyCategory:p.constants.keyCategory.GENERATED_KEY,writeFrequency:p.constants.writeFrequency.HIGH,clientStorageAllowed:false}).done(function(c){var v=c.getItemValue("appStateData");d.resolve(k,v);}).fail(function(m){jQuery.sap.log.error(m);d.reject(m);});return d.promise();};}());};if(!jQuery.sap.isDeclared('sap.ushell.adapters.local.UserDefaultParameterPersistenceAdapter')){(function(){"use strict";jQuery.sap.declare("sap.ushell.adapters.local.UserDefaultParameterPersistenceAdapter");sap.ushell.adapters.local.UserDefaultParameterPersistenceAdapter=function(s,p,c){this._oConfig=c&&c.config;};sap.ushell.adapters.local.UserDefaultParameterPersistenceAdapter.prototype._getPersonalizationService=function(){return sap.ushell.Container.getService("Personalization");};sap.ushell.adapters.local.UserDefaultParameterPersistenceAdapter.prototype.saveParameterValue=function(p,v){var d=new jQuery.Deferred();if(!(typeof p==="string"&&p.length<=40&&/^[A-Za-z0-9.-_]+$/.exec(p))){jQuery.sap.log.error("Illegal Parameter Key, less than 40 characters and [A-Za-z0-9.-_]+ :\""+p+"\"");}this._getUDContainer().done(function(c){c.setItemValue(p,v);c.save().done(d.resolve.bind(d)).fail(d.reject.bind(d));}).fail(function(m){jQuery.sap.log.error(m);d.reject(m);});return d.promise();};sap.ushell.adapters.local.UserDefaultParameterPersistenceAdapter.prototype.deleteParameter=function(p,v){var d=new jQuery.Deferred();if(!(typeof p==="string"&&p.length<=40&&/^[A-Za-z0-9.-_]+$/.exec(p))){jQuery.sap.log.error("Illegal Parameter Key, less than 40 characters and [A-Za-z0-9.-_]+ :\""+p+"\"");}this._getUDContainer().done(function(c){c.delItem(p);c.save().done(d.resolve.bind(d)).fail(d.reject.bind(d));}).fail(function(m){jQuery.sap.log.error(m);d.reject(m);});return d.promise();};sap.ushell.adapters.local.UserDefaultParameterPersistenceAdapter.prototype.loadParameterValue=function(p){var d=new jQuery.Deferred();this._getUDContainer().done(function(c){var v=c.getItemValue(p);if(v){d.resolve(v);}else{d.reject("no value ");}}).fail(function(m){jQuery.sap.log.error(m);d.reject(m);});return d.promise();};sap.ushell.adapters.local.UserDefaultParameterPersistenceAdapter.prototype.getStoredParameterNames=function(){var d=new jQuery.Deferred();this._getUDContainer().done(function(c){var v=c.getItemKeys();d.resolve(v);}).fail(function(m){jQuery.sap.log.error(m);d.reject(m);});return d.promise();};sap.ushell.adapters.local.UserDefaultParameterPersistenceAdapter.prototype._getUDContainer=function(){var p=this._getPersonalizationService();if(this._oPromise){return this._oPromise;}this._oPromise=p.getContainer("sap.ushell.UserDefaultParameter",{keyCategory:p.constants.keyCategory.FIXED_KEY,writeFrequency:p.constants.writeFrequency.LOW,clientStorageAllowed:true});return this._oPromise;};}());};if(!jQuery.sap.isDeclared('sap.ushell.components.flp.Component')){jQuery.sap.declare("sap.ushell.components.flp.Component");if(window['sap-ui-debug']!==true){try{jQuery.sap.require('sap.fiori.flp-controls');}catch(e){jQuery.sap.log.warning('flp-controls failed to load: '+e.message);}}jQuery.sap.require('sap.ui.core.UIComponent');sap.ui.core.UIComponent.extend("sap.ushell.components.flp.Component",{metadata:{routing:{config:{viewType:"JS",controlAggregation:"pages",controlId:"navContainerFlp",clearAggregation:false,routerClass:sap.ushell.components.flp.CustomRouter},targets:{appFinder:{viewName:"sap.ushell.components.flp.launchpad.appfinder.AppFinder"},home:{viewName:"sap.ushell.components.flp.launchpad.dashboard.DashboardContent"}},routes:[{name:"home",target:'home',pattern:"home"}]},version:"1.44.6",library:"sap.ushell.components.flp",dependencies:{libs:["sap.m"]},config:{semanticObject:'Shell',action:'home',title:sap.ushell.resources.i18n.getText("homeBtn_tooltip"),fullWidth:true,hideLightBackground:true,compactContentDensity:true,cozyContentDensity:true}},PERS_KEY:"flp.settings.FlpSettings",parseOldCatalogParams:function(u){"use strict";var p=jQuery.sap.getUriParameters(u).mParams,v,k;for(k in p){if(p.hasOwnProperty(k)){v=p[k][0];p[k]=v.indexOf('/')!==-1?encodeURIComponent(v):v;}}return p;},handleNavigationFilter:function(n){"use strict";var s=sap.ushell.Container.getService("URLParsing").parseShellHash(n),p;if(s&&s.semanticObject==='shell'&&s.action==='catalog'){p=this.parseOldCatalogParams(n);setTimeout(function(){this.getRouter().navTo('appFinder',{'menu':'catalog',filters:JSON.stringify(p)});}.bind(this),0);return this.oShellNavigation.NavigationFilterStatus.Abandon;}return this.oShellNavigation.NavigationFilterStatus.Continue;},createContent:function(){"use strict";this.oRouter=this.getRouter();this.oModel=new sap.ui.model.json.JSONModel({animationMode:'full',groups:[],animationRendered:false,tagFiltering:true,searchFiltering:true,catalogSelection:true,tileActionModeEnabled:false,tileActionModeActive:false,isInDrag:false,rtl:sap.ui.getCore().getConfiguration().getRTL(),personalization:true,editTitle:false,tagList:[],selectedTags:[],userPreferences:{entries:[]},enableNotificationsPreview:false,previewNotificationItems:[],viewPortState:sap.ushell.Container.getRenderer('fiori2').getCurrentViewportState()});sap.ui.getCore().getEventBus().subscribe("sap.ushell.services.Notifications","enablePreviewNotificationChanged",this.enablePreviewNotificationChanged,this);this.oModel.setSizeLimit(10000);this.setModel(this.oModel);this.oConfig=this.getComponentData().config;this.oShellConfig=sap.ushell.renderers.fiori2.RendererExtensions.getConfiguration();sap.ui.getCore().getEventBus().subscribe('launchpad','afterSwitchState',this._handleShellViewPortSateChange,this);var n,m,h,H,s,p,c,P=(this.oConfig&&(this.oConfig.enablePersonalization||this.oConfig.enablePersonalization===undefined))&&(this.oShellConfig&&this.oShellConfig.enablePersonalization||this.oShellConfig.enablePersonalization===undefined);if(P){this.oRouter.addRoute({name:"catalog",target:'appFinder',pattern:"catalog/:filters:"});this.oRouter.addRoute({name:"appFinder",target:'appFinder',pattern:"appFinder/{menu}/:filters:"});}this.oRouter.addRoute({name:"all",target:'home',pattern:":all*:"});this._setConfigurationToModel(this.oConfig);var d={model:this.oModel,config:this.oConfig,router:this.oRouter};jQuery.sap.require("sap.ushell.components.flp.launchpad.DashboardManager");this.oDashboardManager=new sap.ushell.components.flp.launchpad.DashboardManager("dashboardMgr",d);jQuery.sap.require("sap.ushell.resources");this.setModel(sap.ushell.resources.i18nModel,"i18n");m=window.matchMedia("(min-width: 800px)");h=function(a){this.oModel.setProperty("/isPhoneWidth",!a.matches);}.bind(this);if(m.addListener){m.addListener(h);h(m);}sap.ui.getCore().getEventBus().subscribe("launchpad","togglePane",this._createAndAddGroupList,this);sap.ui.getCore().getEventBus().subscribe("sap.ushell.services.UsageAnalytics","usageAnalyticsStarted",function(){jQuery.sap.require("sap.ushell.components.flp.FLPAnalytics");});this.bContactSupportEnabled=sap.ushell.Container.getService("SupportTicket").isEnabled();if(this.bContactSupportEnabled){jQuery.sap.require("sap.ushell.UserActivityLog");sap.ushell.UserActivityLog.activate();}n=this.initNavContainer();this.setInitialConfiguration();this.oShellNavigation=sap.ushell.Container.getService("ShellNavigation");this.oShellNavigation.registerNavigationFilter(jQuery.proxy(this.handleNavigationFilter,this));H=hasher.getHash();s=sap.ushell.Container.getService("URLParsing").parseShellHash(H);if(s&&s.semanticObject==='shell'&&s.action==='catalog'){p=this.parseOldCatalogParams(H);c=this.getMetadata().getConfig();this.oShellNavigation.toExternal({target:{semanticObject:c.semanticObject,action:c.action}});this.getRouter().navTo('appFinder',{'menu':'catalog',filters:JSON.stringify(p)});}if(this.oConfig.enableHomePageSettings!==false){sap.ui.getCore().getEventBus().subscribe("launchpad","contentRendered",this._addFlpSettings,this);}return n;},_createAndAddGroupList:function(c,e,d){"use strict";if(d.currentContent&&(d.currentContent.indexOf('groupList')!==-1||!d.currentContent.length)){var C=this.oConfig,g=this.runAsOwner(function(){return this.oDashboardManager.getGroupListView(C);}.bind(this));if(!g.alreadyCreated){g.groupList.setModel(this.oModel);g.groupList.setModel(sap.ushell.resources.i18nModel,"i18n");sap.ushell.renderers.fiori2.RendererExtensions.setLeftPaneContent(g.groupList,"home");}}},_setConfigurationToModel:function(c){"use strict";var t=this,m=this.oModel,a,r=sap.ushell.Container.getRenderer('fiori2').getModelConfiguration(),e=r.enableNotificationsUI,n=sap.ushell.Container.getService("Notifications").isEnabled(),N=r.appState!=="embedded"&&r.appState!=="headerless"&&r.appState!=="merged"&&r.appState!=="standalone",d=sap.ui.Device,u=true,p=true,o,E=d.system.desktop||sap.ui.Device.system.tablet||sap.ui.Device.system.combi;if(n===true){o=sap.ushell.Container.getService("Notifications").getUserSettingsFlags();o.done(function(b){u=b.previewNotificationEnabled;t.oModel.setProperty("/userEnableNotificationsPreview",u);p=sap.ushell.Container.getService("Notifications").getPreviewNotificationEnabledConfig();t.oModel.setProperty("/configEnableNotificationsPreview",p);if(p&&e&&n&&E&&N&&u){t.oModel.setProperty("/enableNotificationsPreview",true);}});}if(c){if(c.enablePersonalization!==undefined&&this.oShellConfig.enablePersonalization!==undefined){m.setProperty("/personalization",c.enablePersonalization&&this.oShellConfig.enablePersonalization);}else if(c.enablePersonalization!==undefined){m.setProperty("/personalization",c.enablePersonalization);}else if(this.oShellConfig.enablePersonalization!==undefined){m.setProperty("/personalization",this.oShellConfig.enablePersonalization);}if(c.enableLockedGroupsCompactLayout!==undefined){m.setProperty("/enableLockedGroupsCompactLayout",c.enableLockedGroupsCompactLayout);}if(c.enableCatalogSelection!==undefined){m.setProperty("/catalogSelection",c.enableCatalogSelection);}if(c.enableTilesOpacity!==undefined){m.setProperty("/tilesOpacity",c.enableTilesOpacity);}if(c.enableDragIndicator!==undefined){m.setProperty("/enableDragIndicator",c.enableDragIndicator);}a=false;if(c.enableActionModeMenuButton!==undefined){m.setProperty("/actionModeMenuButtonEnabled",c.enableActionModeMenuButton);a=c.enableActionModeMenuButton;}if(c.enableRenameLockedGroup!==undefined){m.setProperty("/enableRenameLockedGroup",c.enableRenameLockedGroup);}else{m.setProperty("/enableRenameLockedGroup",false);}if(c.enableActionModeFloatingButton!==undefined){m.setProperty("/actionModeFloatingButtonEnabled",c.enableActionModeFloatingButton);a=a||c.enableActionModeFloatingButton;}m.setProperty("/tileActionModeEnabled",a);if(c.enableTileActionsIcon!==undefined){m.setProperty("/tileActionsIconEnabled",sap.ui.Device.system.desktop?c.enableTileActionsIcon:false);}if(c.enableHideGroups!==undefined){m.setProperty("/enableHideGroups",c.enableHideGroups);}if(c.title){m.setProperty("/title",c.title);}if(c.enableEasyAccess!=undefined&&!c.enableEasyAccess){m.setProperty("/enableEasyAccessSAPMenu",c.enableEasyAccess);m.setProperty("/enableEasyAccessUserMenu",c.enableEasyAccess);m.setProperty("/enableEasyAccessUserMenuSearch",c.enableEasyAccess);m.setProperty("/enableEasyAccessSAPMenuSearch",c.enableEasyAccess);}else{if(c.enableEasyAccessSAPMenu!==undefined){m.setProperty("/enableEasyAccessSAPMenu",c.enableEasyAccessSAPMenu);if(!c.enableEasyAccessSAPMenu){m.setProperty("/enableEasyAccessSAPMenuSearch",false);}else{if(c.enableEasyAccessSAPMenuSearch!==undefined){m.setProperty("/enableEasyAccessSAPMenuSearch",c.enableEasyAccessSAPMenuSearch);}else{m.setProperty("/enableEasyAccessSAPMenuSearch",true);}}}else{m.setProperty("/enableEasyAccessSAPMenu",c.enableEasyAccess);if(c.enableEasyAccessSAPMenuSearch!==undefined){m.setProperty("/enableEasyAccessSAPMenuSearch",c.enableEasyAccessSAPMenuSearch);}else{m.setProperty("/enableEasyAccessSAPMenuSearch",c.enableEasyAccess);}}if(c.enableEasyAccessUserMenu!==undefined){m.setProperty("/enableEasyAccessUserMenu",c.enableEasyAccessUserMenu);if(!c.enableEasyAccessUserMenu){m.setProperty("/enableEasyAccessUserMenuSearch",false);}else{if(c.enableEasyAccessUserMenuSearch!==undefined){m.setProperty("/enableEasyAccessUserMenuSearch",c.enableEasyAccessUserMenuSearch);}else{m.setProperty("/enableEasyAccessUserMenuSearch",true);}}}else{m.setProperty("/enableEasyAccessUserMenu",c.enableEasyAccess);if(c.enableEasyAccessUserMenuSearch!==undefined){m.setProperty("/enableEasyAccessUserMenuSearch",c.enableEasyAccessUserMenuSearch);}else{m.setProperty("/enableEasyAccessUserMenuSearch",c.enableEasyAccess);}}}if(c.enableSearchFiltering!==undefined){m.setProperty("/searchFiltering",c.enableSearchFiltering);}else if(c.enableCatalogSearch!==undefined){m.setProperty("/searchFiltering",c.enableCatalogSearch);}else{m.setProperty("/searchFiltering",true);}if(c.enableTagFiltering!==undefined){m.setProperty("/tagFiltering",c.enableTagFiltering);}else if(c.enableCatalogTagFilter!==undefined){m.setProperty("/tagFiltering",c.enableCatalogTagFilter);}else{m.setProperty("/tagFiltering",true);}if(c.sapMenuServiceUrl!==undefined){m.setProperty("/sapMenuServiceUrl",c.sapMenuServiceUrl);}if(c.userMenuServiceUrl!==undefined){m.setProperty("/userMenuServiceUrl",c.userMenuServiceUrl);}if(c.easyAccessNumbersOfLevels!==undefined){m.setProperty("/easyAccessNumbersOfLevels",c.easyAccessNumbersOfLevels);}var D=c.enableHomePageSettings!==false?this._getCurrentHomePageGroupDisplay():jQuery.Deferred().resolve();D.done(function(s){s=s||c.homePageGroupDisplay;if(s!==undefined){m.setProperty("/homePageGroupDisplay",s);}});m.setProperty("/enableHelp",!!this.oShellConfig.enableHelp);m.setProperty("/disableSortedLockedGroups",!!c.disableSortedLockedGroups);if(r.animationMode){m.setProperty("/animationMode",r.animationMode);}}},initNavContainer:function(c){"use strict";var n=new sap.m.NavContainer({id:"navContainerFlp",defaultTransitionName:'show'});return n;},setInitialConfiguration:function(){"use strict";this.oRouter.initialize();if(!sap.ui.Device.system.phone){sap.ushell.components.flp.ComponentKeysHandler.init(this.oModel,this.oRouter);sap.ushell.renderers.fiori2.AccessKeysHandler.registerAppKeysHandler(sap.ushell.components.flp.ComponentKeysHandler.handleFocusOnMe);var t=sap.ushell.resources.i18n,s=[];s.push({text:"Alt+H",description:t.getText("hotkeyHomePage")});if(this.oModel.getProperty("/personalization")){s.push({text:"Alt+A",description:t.getText("hotkeyAppFinder")});s.push({text:"Ctrl+Enter",description:t.getText("hotkeySaveEditing")});}sap.ushell.renderers.fiori2.AccessKeysHandler.registerAppShortcuts(sap.ushell.components.flp.ComponentKeysHandler.handleShortcuts,s);}sap.ui.getCore().getEventBus().publish("launchpad","initialConfigurationSet");},_handleShellViewPortSateChange:function(n,e,E){"use strict";var c=E?E.getParameter('to'):'';this.oModel.setProperty('/viewPortState',c);},enablePreviewNotificationChanged:function(c,e,d){"use strict";var r=sap.ushell.Container.getRenderer('fiori2').getModelConfiguration(),D=sap.ui.Device.system,E=r.enableNotificationsUI,C=this.oModel.getProperty("/configEnableNotificationsPreview"),n=sap.ushell.Container.getService("Notifications").isEnabled(),b=D.desktop||D.tablet||D.combi,N=r.appState!=="embedded"&&r.appState!=="headerless"&&r.appState!=="standalone",a;this.oModel.setProperty("/userEnableNotificationsPreview",d.bPreviewEnabled);a=C&&E&&n&&b&&N&&d.bPreviewEnabled;this.oModel.setProperty("/enableNotificationsPreview",a);},_addFlpSettings:function(){"use strict";if(this.bFlpSettingsAdded){return;}var r=sap.ushell.Container.getRenderer("fiori2"),R=sap.ushell.resources.i18n,t=this;var f;var e={title:R.getText('FlpSettings_entry_title'),entryHelpID:"flpSettingsEntry",value:function(){return jQuery.Deferred().resolve("");},content:function(){f=sap.ui.xmlview({viewName:"sap.ushell.components.flp.settings.FlpSettings",viewData:{initialDisplayMode:t.oModel.getProperty("/homePageGroupDisplay")||"scroll"}});return jQuery.Deferred().resolve(f);},onSave:function(){var d=f.getController().onSave();var D=t._getPersonalizer("homePageGroupDisplay").setPersData(d);D.fail(function(a){jQuery.sap.log.error("Failed to save the anchor bar mode in personalization",a,"sap.ushell.components.flp.settings.FlpSettings");});t.oModel.setProperty("/homePageGroupDisplay",d);return jQuery.Deferred().resolve();},onCancel:function(){return jQuery.Deferred().resolve();},icon:"sap-icon://home"};r.addUserPreferencesEntry(e);this.bFlpSettingsAdded=true;},_getCurrentHomePageGroupDisplay:function(){'use strict';var d=this._getPersonalizer('homePageGroupDisplay').getPersData();d.fail(function(e){jQuery.sap.log.error("Failed to load anchor bar state from the personalization",e,"sap.ushell.components.flp.settings.FlpSettings");});return d;},_getPersonalizer:function(i){"use strict";if(this.oPersonalizer){return this.oPersonalizer;}var p=sap.ushell.Container.getService("Personalization");var c=sap.ui.core.Component.getOwnerComponentFor(this);var s={keyCategory:p.constants.keyCategory.FIXED_KEY,writeFrequency:p.constants.writeFrequency.LOW,clientStorageAllowed:true};var P={container:this.PERS_KEY,item:i};this.oPersonalizer=p.getPersonalizer(P,s,c);return this.oPersonalizer;},exit:function(){"use strict";sap.ui.getCore().getEventBus().unsubscribe('launchpad','shellViewStateChanged',this._handleShellViewPortSateChange,this);this.oDashboardManager.destroy();}});};if(!jQuery.sap.isDeclared('sap.ushell.components.flp.launchpad.appfinder.Catalog.view')){jQuery.sap.declare('sap.ushell.components.flp.launchpad.appfinder.Catalog.view');(function(){"use strict";jQuery.sap.require('sap.ui.core.IconPool');jQuery.sap.require('sap.ui.core.HTML');sap.ui.jsview("sap.ushell.components.flp.launchpad.appfinder.Catalog",{oController:null,createContent:function(c){var t=this;this.oViewData=this.getViewData();this.parentComponent=this.oViewData.parentComponent;var m=this.parentComponent.getModel();this.setModel(m);this.setModel(this.oViewData.subHeaderModel,"subHeaderModel");this.oController=c;function i(l){return((l!==null)&&(l==="1x2"||l==="2x2"))||false;}function a(v){return parseInt(v,10)||0;}function g(e,k,G,l,n,p){var q;if(l){var r=sap.ushell.resources.i18n,u=$.inArray(n,G);q=r.getText(u!==-1?"removeAssociatedTileFromContextGroup":"addAssociatedTileToContextGroup",p);}else{q=G&&G.length?k:e;}return q;}var T=new sap.ushell.ui.appfinder.PinButton({icon:'sap-icon://pushpin-off',selected:{parts:["associatedGroups","associatedGroups/length","/groupContext/path","/groupContext/id"],formatter:function(e,k,G,l){if(G){var n=$.inArray(l,e);return n!==-1;}else{return!!k;}}},tooltip:{parts:["i18n>EasyAccessMenu_PinButton_UnToggled_Tooltip","i18n>EasyAccessMenu_PinButton_Toggled_Tooltip","associatedGroups","associatedGroups/length","/groupContext/path","/groupContext/id","/groupContext/title"],formatter:function(e,k,G,l,n,p,q){return g(e,k,G,n,p,q);}},press:[c.onTilePinButtonClick,c]});var A=new sap.ushell.ui.appfinder.PinButton({icon:'sap-icon://pushpin-off',selected:{parts:["associatedGroups","associatedGroups/length","/groupContext/path","/groupContext/id"],formatter:function(e,k,G,l){if(G){var n=$.inArray(l,e);return n!==-1;}else{return!!k;}}},tooltip:{parts:["i18n>EasyAccessMenu_PinButton_UnToggled_Tooltip","i18n>EasyAccessMenu_PinButton_Toggled_Tooltip","associatedGroups","associatedGroups/length","/groupContext/path","/groupContext/id","/groupContext/title"],formatter:function(e,k,G,l,n,p,q){return g(e,k,G,n,p,q);}},press:[c.onTilePinButtonClick,c]});this.oAppBoxesTemplate=new sap.ushell.ui.appfinder.AppBox({title:'{title}',icon:'{icon}',subtitle:'{subtitle}',url:'{url}',pinButton:A,press:[c.onAppBoxPressed,c]});A.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"tabindex",value:"-1",writeToDom:true}));A.addStyleClass("sapUshellPinButton");T.addCustomData(new sap.ushell.ui.launchpad.AccessibilityCustomData({key:"tabindex",value:"-1",writeToDom:true}));T.addStyleClass("sapUshellPinButton");this.oTileTemplate=new sap.ushell.ui.launchpad.Tile({tileViews:{path:"content",factory:function(I,e){return e.getObject();}},"long":{path:"size",formatter:i},index:{path:"id",formatter:a},tileCatalogId:"{id}",pinButton:T,press:[c.catalogTilePress,c],afterRendering:c.onTileAfterRendering});this.oCatalogSelect=new sap.m.List("catalogSelect",{visible:"{/catalogSelection}",name:"Browse",tooltip:"{i18n>catalogSelect_tooltip}",rememberSelections:true,mode:"SingleSelectMaster",items:{path:"/masterCatalogs",template:new sap.m.StandardListItem({type:"Active",title:"{title}"})},showNoData:false,itemPress:[c._handleCatalogListItemPress,c]});this.getCatalogSelect=function(){return this.oCatalogSelect;};var o=this.oCatalogSelect.onAfterRendering;this.oCatalogSelect.addEventDelegate({onsaptabnext:function(k){try{k.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.components.flp.ComponentKeysHandler.setFocusOnCatalogTile();}catch(e){}},onsapskipforward:function(k){try{k.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);sap.ushell.components.flp.ComponentKeysHandler.setFocusOnCatalogTile();}catch(e){}},onsapskipback:function(k){try{k.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.setIsFocusHandledByAnotherHandler(true);var l=sap.ui.getCore().byId("openCloseButtonAppFinderSubheader");if(l.getVisible()){l.focus();}else{sap.ushell.components.flp.ComponentKeysHandler.appFinderFocusMenuButtons(k);}}catch(e){}}});if(m.getProperty("/enableHelp")){this.oCatalogSelect.addStyleClass('help-id-catalogCategorySelect');}this.setCategoryFilterSelection=function(S){var e=t.getCatalogSelect(),k=e.getItems(),l=t.oController.oSubHeaderModel.getProperty('/tag/tagMode'),n=t.oController.oSubHeaderModel.getProperty('/search/searchMode'),p=S;if(n||l){e.setSelectedItem();}else{k.forEach(function(L,q){if(L.getTitle()===p){e.setSelectedItem(L);}});}};this.oCatalogSelect.onAfterRendering=function(){var S=t.oController.categoryFilter||sap.ushell.resources.i18n.getText('all');t.setCategoryFilterSelection(S);if(o){o.apply(this,arguments);}setTimeout(function(){var e=jQuery("#catalog, #userMenu, #sapMenu").filter("[tabindex=0]");if(e.length){e.eq(0).focus();}else{jQuery("#catalog").focus();}},0);};var b=this.oCatalogSelect._onAfterRenderingPopover;this.oCatalogSelect._onAfterRenderingPopover=function(){if(this._oPopover){this._oPopover.setFollowOf(false);}if(b){b.apply(this,arguments);}};var E=sap.ui.getCore().getEventBus();E.subscribe("launchpad","catalogContentLoaded",function(){this.splitApp.toMaster('catalogSelect','show');if(sap.ui.Device.system.phone){this.splitApp.toDetail(this._calculateDetailPageId());}},this);var d=new sap.ui.core.HTML("sapUshellCatalogAccessibilityTileText",{content:"<div style='height: 0px; width: 0px; overflow: hidden; float: left;'>"+sap.ushell.resources.i18n.getText("tile")+"</div>"});var C=new sap.ushell.ui.launchpad.CatalogEntryContainer({header:"{title}",customTilesContainer:{path:"customTiles",template:this.oTileTemplate,templateShareable:true},appBoxesContainer:{path:"appBoxes",template:this.oAppBoxesTemplate,templateShareable:true}});this.oMessagePage=new sap.m.MessagePage({visible:true,showHeader:false,text:sap.ushell.resources.i18n.getText('EasyAccessMenu_NoAppsToDisplayMessagePage_Text'),description:''});this.oCatalogsContainer=new sap.ushell.ui.launchpad.CatalogsContainer("catalogTiles",{categoryFilter:"{/categoryFilter}",catalogs:{path:"/catalogs",templateShareable:true,template:C},busy:true});this.oCatalogsContainer.addStyleClass('sapUshellCatalogTileContainer');this.oCatalogsContainer.addEventDelegate({onsaptabprevious:function(e){var k=sap.ui.getCore().byId("openCloseButtonAppFinderSubheader"),l=jQuery(e.srcControl.getDomRef());if(k.getVisible()&&!k.getPressed()&&!l.hasClass("sapUshellPinButton")){e.preventDefault();var n=sap.ui.getCore().byId("appFinderSearch");n.focus();}},onsapskipback:function(e){var k=sap.ui.getCore().byId("openCloseButtonAppFinderSubheader");if(k.getVisible()&&!k.getPressed()){e.preventDefault();k.focus();}}});this.oCatalogsContainer.onAfterRendering=function(){var e=sap.ui.getCore().byId('catalogTilesDetailedPage');if(!this.getBusy()){e.setBusy(false);jQuery.sap.measure.end("FLP:AppFinderLoadingStartToEnd");}else{e.setBusy(true);}jQuery("#catalogTilesDetailedPage-cont").scroll(function(){var p=sap.ui.getCore().byId('catalogTilesDetailedPage'),k=p.getScrollDelegate(),l=k.getScrollTop(),n=k.getMaxScrollTop();if(n-l<=30+t.oController.PagingManager.getTileHeight()){t.oController.allocateNextPage();}});};this.oCatalogEntrySearchContainer=new sap.ushell.ui.launchpad.CatalogEntryContainer({header:"{i18n>results_count}"});this.oCatalogEntrySearchContainer.addStyleClass('sapUshellCatalogTileContainer');this.oCatalogsSearchContainer=new sap.ushell.ui.launchpad.CatalogsContainer("catalogSearchContainer",{catalogs:[this.oCatalogEntrySearchContainer]});this.wrapCatalogsContainerInDetailPage=function(e,I){var D=new sap.m.Page(I,{showHeader:false,showFooter:false,showNavButton:false,content:[new sap.ushell.ui.launchpad.Panel({translucent:true,content:e}).addStyleClass("sapUshellCatalogPage")]});return D},this.getCatalogContainer=function(){return this.oCatalogsContainer;};new sap.m.Page({showHeader:false,showFooter:false,showNavButton:false,content:[new sap.ushell.ui.launchpad.Panel({translucent:true,content:[d,this.getCatalogContainer()]}).addStyleClass("sapUshellCatalogPage")]});var f=this.wrapCatalogsContainerInDetailPage([d,this.getCatalogContainer()],'catalogTilesDetailedPage'),h=new sap.m.Page('catalogMessagePage',{showHeader:false,showFooter:false,showNavButton:false,content:[this.oMessagePage]}),j=this.wrapCatalogsContainerInDetailPage([this.oCatalogsSearchContainer],'catalogTilesSearchPage');var s=new sap.m.BusyIndicator('catalogSelectBusyIndicator',{size:"1rem"});this.splitApp=new sap.m.SplitApp('catalogViewMasterDetail',{masterPages:[s,this.oCatalogSelect],detailPages:[f,j,h]});document.toSearch=function(){this.splitApp.toDetail('catalogTilesSearchPage');}.bind(this);document.toDetail=function(){this.splitApp.toDetail('catalogTilesDetailedPage');}.bind(this);document.toMessage=function(){this.splitApp.toDetail('catalogMessagePage');}.bind(this);return this.splitApp;},_calculateDetailPageId:function(){var s=this.getModel('subHeaderModel');var S=s.getProperty('/search/searchMode');var t=s.getProperty('/tag/tagMode');var i;if(S||t){i=this.getController().bSearchResults?'catalogTilesSearchPage':'catalogMessagePage';}else{i="catalogTilesDetailedPage";}return i;},getControllerName:function(){return"sap.ushell.components.flp.launchpad.appfinder.Catalog";}});}());};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.Shell.controller')){jQuery.sap.declare('sap.ushell.renderers.fiori2.Shell.controller');(function(){"use strict";jQuery.sap.require('sap.ui.core.IconPool');var c=true,a=true,b=false,u,s,m,n={embedded:"embedded",newWindowThenEmbedded:"newWindowThenEmbedded",newWindow:"newWindow",replace:"replace"},C={},B,d=['minimal','app','standalone','embedded','headerless','merged','home','blank'];sap.ui.controller("sap.ushell.renderers.fiori2.Shell",{oCoreExtLoadingDeferred:undefined,onInit:function(){a=true;b=false;c=true;var C=(this.getView().getViewData()?this.getView().getViewData().config:{})||{};this.bMeAreaSelected=false;this.oEndUserFeedbackConfiguration={showAnonymous:true,anonymousByDefault:true,showLegalAgreement:true,showCustomUIContent:true,feedbackDialogTitle:true,textAreaPlaceholder:true,customUIContent:undefined};this.bUserImageAlreadyLoaded=undefined;this.bMeAreaLoaded=false;this.bNotificationsSelected=false;C["enableBackGroundShapes"]=C.enableBackGroundShapes===undefined?true:C.enableBackGroundShapes;B=this._historyBackNavigation;this.initShellModel(C);this.getView().setModel(m);this.getView().setModel(sap.ushell.resources.i18nModel,"i18n");sap.ui.getCore().getEventBus().subscribe("externalSearch",this.externalSearchTriggered,this);this._setConfigurationToModel();sap.ui.getCore().getEventBus().subscribe("launchpad","contentRendered",this._loadCoreExt,this);sap.ui.getCore().getEventBus().subscribe("sap.ushell.renderers.fiori2.Renderer","appOpened",this.loadUserImage,this);sap.ui.getCore().getEventBus().subscribe("sap.ushell.renderers.fiori2.Renderer","appOpened",this.setBackGroundShapes,this);sap.ui.getCore().getEventBus().subscribe("launchpad","coreExtLoaded",this.checkEUFeedback,this);sap.ui.getCore().getEventBus().subscribe("launchpad","coreExtLoaded",this.loadMeAreaView,this);sap.ui.getCore().getEventBus().subscribe("sap.ushell.renderers.fiori2.Renderer","appOpened",this.checkEUFeedback,this);sap.ui.getCore().getEventBus().subscribe("sap.ushell.renderers.fiori2.Renderer","appOpened",this.delayedCloseLoadingScreen,this);sap.ui.getCore().getEventBus().subscribe("launchpad","toggleContentDensity",this.toggleContentDensity,this);sap.ui.getCore().getEventBus().subscribe("sap.ushell.renderers.fiori2.Renderer","appOpened",this._loadCoreExtNWBC,this);sap.ui.getCore().getEventBus().subscribe("sap.ushell.services.Notifications","onNewNotifications",this._handleAlerts,this);sap.ui.getCore().getEventBus().subscribe("launchpad","appClosed",this.logApplicationUsage,this);sap.ui.getCore().getEventBus().subscribe("launchpad","launchpadCustomRouterRouteMatched",this._centerViewPort,this);sap.ushell.Container.getService("AppLifeCycle");sap.ushell.Container.getService("UsageAnalytics").init(sap.ushell.resources.i18n.getText("usageAnalytics"),sap.ushell.resources.i18n.getText("i_agree"),sap.ushell.resources.i18n.getText("i_disagree"),sap.ushell.resources.i18n.getText("remind_me_later"));u=sap.ushell.Container.getService("UserRecents");if(sap.ushell.Container.getService("Notifications").isEnabled()===true){m.setProperty("/enableNotifications",true);sap.ushell.Container.getService("Notifications").init();if(C.enableNotificationsUI===true){m.setProperty("/enableNotificationsUI",true);sap.ushell.Container.getService("Notifications").registerDependencyNotificationsUpdateCallback(this.notificationsCountUpdateCallback.bind(this),true);}}this.history=new sap.ushell.renderers.fiori2.History();this.oViewPortContainer=sap.ui.getCore().byId("viewPortContainer");this.oNotificationsCountButton=sap.ui.getCore().byId("NotificationsCountButton");this.oFiori2LoadingDialog=sap.ui.getCore().byId("Fiori2LoadingDialog");this.oShellNavigation=sap.ushell.Container.getService("ShellNavigation");this.oShellNavigation.registerNavigationFilter(jQuery.proxy(this._handleEmptyHash,this));this.oShellNavigation.init(jQuery.proxy(this.doHashChange,this));this.oShellNavigation.registerNavigationFilter(jQuery.proxy(this.handleDataLoss,this));sap.ushell.Container.getService("Message").init(jQuery.proxy(this.doShowMessage,this));sap.ushell.Container.setLogonFrameProvider(this._getLogonFrameProvider());this.bContactSupportEnabled=sap.ushell.Container.getService("SupportTicket").isEnabled();sap.ushell.renderers.fiori2.AccessKeysHandler.init(m);window.onbeforeunload=function(){if(sap.ushell.Container&&sap.ushell.Container.getDirtyFlag()){if(!sap.ushell.resources.browserI18n){sap.ushell.resources.browserI18n=sap.ushell.resources.getTranslationModel(window.navigator.language).getResourceBundle();}return sap.ushell.resources.browserI18n.getText("dataLossExternalMessage");}};if(m.getProperty("/contentDensity")){this._applyContentDensityClass();}if(m.getProperty("/enableNotificationsUI")===true){s.addHeaderEndItem(["NotificationsCountButton"],false,["home","app","minimal"],true);}sap.ui.Device.media.attachHandler(this.onScreenSizeChange.bind(this),null,sap.ui.Device.media.RANGESETS.SAP_STANDARD);this.onScreenSizeChange(sap.ui.Device.media.getCurrentRange(sap.ui.Device.media.RANGESETS.SAP_STANDARD));this.initShellUIService();if(this.getView().oShellNavigationMenu){this.getView().oShellNavigationMenu.setModel(m);}sap.ui.getCore().attachThemeChanged(this.redrawBackGroundShapes);},initShellModel:function(C){s=sap.ushell.renderers.fiori2.ShellModel;s.init(C);m=s.getModel();},redrawBackGroundShapes:function(){if(C.enableBackGroundShapes){sap.ushell.CanvasShapesManager.drawShapes();}},setBackGroundShapes:function(){if(!b&&C.enableBackGroundShapes){b=true;sap.ushell.CanvasShapesManager.drawShapes();}},initShellUIService:function(){jQuery.sap.require("sap.ushell.ui5service.ShellUIService");this.oShellUIService=new sap.ushell.ui5service.ShellUIService({scopeObject:this.getOwnerComponent(),scopeType:"component"});this.oShellUIService._attachHierarchyChanged(this.onHierarchyChange.bind(this));this.oShellUIService._attachTitleChanged(this.onTitleChange.bind(this));this.oShellUIService._attachRelatedAppsChanged(this.onRelatedAppsChange.bind(this));this.oShellUIService._attachBackNavigationChanged(this.onBackNavigationChange.bind(this));this.oUserStatus=new sap.ushell.ui5service.UserStatus({scopeObject:this.getOwnerComponent(),scopeType:"component"});},onHierarchyChange:function(e){this.isHierarchyChanged=true;var h=e.getParameters().data,H,E,o;if(!h){h=[];}H=this.getHierarchyDefaultValue();E=h.concat(H);o=m.getProperty("/currentState");if(o&&o.stateName==="home"){s.updateStateProperty("application/hierarchy",E,false,["home"]);}s.updateStateProperty("application/hierarchy",E,true);},onTitleChange:function(e){this.isTitleChanged=true;var t=e.getParameters().data,o;if(!t){t=this.getTitleDefaultValue();}o=m.getProperty("/currentState");if(o&&o.stateName==="home"){s.updateStateProperty("application/title",t,false,["home"]);}s.updateStateProperty("application/title",t,true);window.document.title=t;},onBackNavigationChange:function(e){this.isBackNavigationChanged=true;var f=e.getParameters().data,m=this.getModel(),o=m.getProperty('/currentState/');if(f){B=f;if(o.stateName==='minimal'||o.stateName==='standalone'||o.stateName==='embedded'){sap.ushell.Container.getRenderer('fiori2').showHeaderItem('backBtn',true);}}else{B=this._historyBackNavigation;}},onRelatedAppsChange:function(e){this.isRelatedAppsChanged=true;var r=e.getParameters().data,o;if(!r){r=[];}o=m.getProperty("/currentState");if(o&&o.stateName==="home"){s.updateStateProperty("application/relatedApps",r,false,["home"]);}s.updateStateProperty("application/relatedApps",r,true);},getHierarchyDefaultValue:function(){var h=[],o=m.getProperty("/currentState");if(o&&(o.stateName==="app"||o.stateName==="embedded")){h=[{icon:"sap-icon://home",title:sap.ushell.resources.i18n.getText("actionHomePage"),intent:C.rootIntent?"#"+C.rootIntent:"#"}];}return h;},getTitleDefaultValue:function(){var t="",e=sap.ushell.services.AppConfiguration.getMetadata();if(e&&e.title){t=e.title;}return t;},getAppIcon:function(){var i="sap-icon://folder",e=sap.ushell.services.AppConfiguration.getMetadata();if(e&&e.icon){i=e.icon;}return i;},_handleAlerts:function(e,E,N){var i,f=(this.getModel().getProperty("/currentState").stateName==="home"&&this.oViewPortContainer.getCurrentState()==='Center'),g=sap.ui.Device.system.phone;if(this.oViewPortContainer.getCurrentState()!=='RightCenter'&&(!f||g)){for(i=0;i<N.length;i++){this.handleNotification(N[i]);}}},handleNotification:function(N){var A=sap.ushell.Container.getRenderer("fiori2").addRightFloatingContainerItem({press:function(e){var v=sap.ui.getCore().byId('viewPortContainer');if(hasher.getHash()===N.NavigationTargetObject+"-"+N.NavigationTargetAction){v.switchState("Center");}else{sap.ushell.utils.toExternalWithParameters(N.NavigationTargetObject,N.NavigationTargetAction,N.NavigationTargetParams);}sap.ushell.Container.getService("Notifications").markRead(N.Id);},datetime:sap.ushell.resources.i18n.getText("notification_arrival_time_now"),title:N.SensitiveText?N.SensitiveText:N.Text,unread:N.IsRead,priority:"High",hideShowMoreButton:true},true,true);setTimeout(function(){sap.ushell.Container.getRenderer("fiori2").removeRightFloatingContainerItem(A.getId(),true);},3500);},_createActionButtons:function(){var o,e,E,U=sap.ui.getCore().byId("userSettingsBtn"),A=sap.ui.getCore().byId("aboutBtn")||new sap.ushell.ui.footerbar.AboutButton("aboutBtn");if(!U){U=new sap.ushell.ui.launchpad.ActionItem("userSettingsBtn",{id:"userSettingsBtn",text:sap.ushell.resources.i18n.getText("userSettings"),icon:'sap-icon://action-settings'});}jQuery.sap.require('sap.ushell.ui.footerbar.ContactSupportButton');jQuery.sap.require('sap.ushell.ui.footerbar.EndUserFeedback');o=sap.ui.getCore().byId("ContactSupportBtn")||new sap.ushell.ui.footerbar.ContactSupportButton("ContactSupportBtn",{visible:this.bContactSupportEnabled});E=m.getProperty('/showEndUserFeedback');if(E){e=sap.ui.getCore().byId("EndUserFeedbackBtn")||new sap.ushell.ui.footerbar.EndUserFeedback("EndUserFeedbackBtn",{showAnonymous:this.oEndUserFeedbackConfiguration.showAnonymous,anonymousByDefault:this.oEndUserFeedbackConfiguration.anonymousByDefault,showLegalAgreement:this.oEndUserFeedbackConfiguration.showLegalAgreement,showCustomUIContent:this.oEndUserFeedbackConfiguration.showCustomUIContent,feedbackDialogTitle:this.oEndUserFeedbackConfiguration.feedbackDialogTitle,textAreaPlaceholder:this.oEndUserFeedbackConfiguration.textAreaPlaceholder,customUIContent:this.oEndUserFeedbackConfiguration.customUIContent});}if(m.getProperty("/enableHelp")){U.addStyleClass('help-id-loginDetails');A.addStyleClass('help-id-aboutBtn');if(E){e.addStyleClass('help-id-EndUserFeedbackBtn');}o.addStyleClass('help-id-contactSupportBtn');}this.getView().aDanglingControls.push(o,U,A);if(E){this.getView().aDanglingControls.push(e);}},_isCompactContentDensity:function(){var i,U,f;if(!sap.ui.Device.support.touch){i=true;}else if(!sap.ui.Device.system.combi){i=false;}else{try{f=sap.ushell.Container.getService("UserInfo");U=f.getUser();}catch(e){jQuery.sap.log.error("Getting UserInfo service failed.");U=sap.ushell.Container.getUser();}i=(U.getContentDensity()==='compact')?true:false;}return i;},_applyContentDensity:function(i){if(i===undefined){i=this._isCompactContentDensity();}var e=sap.ushell.services.AppConfiguration.getMetadata(),A;A=e.compactContentDensity===undefined?true:e.compactContentDensity;if(i&&!A){i=false;}else if(A&&!e.cozyContentDensity){i=true;}this._applyContentDensityClass(i);},_applyContentDensityClass:function(i){if(i===undefined){i=this._isCompactContentDensity();}if(i){jQuery('body').removeClass('sapUiSizeCozy');jQuery('body').addClass('sapUiSizeCompact');}else{jQuery('body').removeClass('sapUiSizeCompact');jQuery('body').addClass('sapUiSizeCozy');}},toggleContentDensity:function(e,E,D){var i=D.contentDensity==="compact";this._applyContentDensity(i);},checkEUFeedback:function(){if(!this.bFeedbackServiceChecked){this.bFeedbackServiceChecked=true;try{sap.ushell.Container.getService("EndUserFeedback").isEnabled().done(function(){m.setProperty('/showEndUserFeedback',true);}).fail(function(){m.setProperty('/showEndUserFeedback',false);});}catch(e){jQuery.sap.log.error("EndUserFeedback adapter is not found",e.message||e);m.setProperty('/showEndUserFeedback',false);}}},loadMeAreaView:function(){if(!sap.ui.getCore().byId('meArea')&&!this.bMeAreaLoaded){this.bMeAreaLoaded=true;var M=sap.ui.view("meArea",{viewName:"sap.ushell.renderers.fiori2.meArea.MeArea",type:'JS',viewData:this.getView().getViewData()});this._createActionButtons();this._setUserPrefModel();this.oViewPortContainer.addLeftViewPort(M);this.oViewPortContainer.navTo('leftViewPort',M.getId());}},notificationsCountUpdateCallback:function(D){var t=this,v=this.oViewPortContainer.getCurrentState(),i=v==="RightCenter"?true:false;if((D===undefined)||(!i)){this._updateBadge();}else{D.done(function(){t._updateBadge();});}},_updateBadge:function(){var e;sap.ushell.Container.getService("Notifications").getUnseenNotificationsCount().done(function(N){e=parseInt(N,10);m.setProperty('/notificationsCount',e);}).fail(function(f){jQuery.sap.log.error("Shell.controller - call to notificationsService.getCount failed: ",f,"sap.ushell.renderers.lean.Shell");});},_handleEmptyHash:function(h){h=(typeof h==="string")?h:"";h=h.split("?")[0];if(h.length===0){var v=this.getView()?this.getView().getViewData():{};C=v.config||{};if(C.migrationConfig){return this.oShellNavigation.NavigationFilterStatus.Continue;}if(C.rootIntent){setTimeout(function(){hasher.setHash(C.rootIntent);},0);return this.oShellNavigation.NavigationFilterStatus.Abandon;}}return this.oShellNavigation.NavigationFilterStatus.Continue;},_setConfigurationToModel:function(){var v=this.getView().getViewData(),e,f;if(v){C=v.config||{};}if(C){if(C.states){f=m.getProperty('/states');for(e in C.states){if(C.states.hasOwnProperty(e)){f[e]=C.states[e];}}m.setProperty('/states',f);}if(C.appState==="headerless"||C.appState==="merged"||C.appState==="blank"){m.setProperty("/personalization",false);C.enablePersonalization=false;}else if(C.enablePersonalization!==undefined){m.setProperty("/personalization",C.enablePersonalization);}if(C.changeEndUserFeedbackTitle!==undefined){this.oEndUserFeedbackConfiguration.feedbackDialogTitle=C.changeEndUserFeedbackTitle;}if(C.changeEndUserFeedbackPlaceholder!==undefined){this.oEndUserFeedbackConfiguration.textAreaPlaceholder=C.changeEndUserFeedbackPlaceholder;}if(C.showEndUserFeedbackAnonymousCheckbox!==undefined){this.oEndUserFeedbackConfiguration.showAnonymous=C.showEndUserFeedbackAnonymousCheckbox;}if(C.makeEndUserFeedbackAnonymousByDefault!==undefined){this.oEndUserFeedbackConfiguration.anonymousByDefault=C.makeEndUserFeedbackAnonymousByDefault;}if(C.showEndUserFeedbackLegalAgreement!==undefined){this.oEndUserFeedbackConfiguration.showLegalAgreement=C.showEndUserFeedbackLegalAgreement;}if(C.enableSetTheme!==undefined){m.setProperty("/setTheme",C.enableSetTheme);}m.setProperty("/contentDensity",C.enableContentDensity===undefined?true:C.enableContentDensity);if(C.title){m.setProperty("/title",C.title);}if(C.migrationConfig!==undefined){m.setProperty("/migrationConfig",C.migrationConfig);}if(C.enableUserDefaultParameters!==undefined){m.setProperty("/userDefaultParameters",C.enableUserDefaultParameters);}if(C.disableHomeAppCache!==undefined){m.setProperty("/disableHomeAppCache",C.disableHomeAppCache);}m.setProperty("/enableHelp",!!C.enableHelp);m.setProperty("/searchAvailable",(C.enableSearch!==false));if(C.animationMode){m.setProperty("/animationMode",C.animationMode);}s.updateStateProperty("headerHiding",false,false,["home","app"]);}},getModelConfiguration:function(){var v=this.getView().getViewData(),o,S;if(v){o=v.config||{};S=jQuery.extend({},o);}delete S.applications;return S;},_getLogonFrameProvider:function(){var v=this.getView();return{create:function(){return v.createIFrameDialog();},show:function(){v.showIFrameDialog();},destroy:function(){v.destroyIFrameDialog();}};},onExit:function(){sap.ui.getCore().getEventBus().unsubscribe("externalSearch",this.externalSearchTriggered,this);sap.ui.getCore().getEventBus().unsubscribe("launchpad","contentRendered",this._loadCoreExt,this);sap.ui.getCore().getEventBus().unsubscribe("launchpad","toggleContentDensity",this.toggleContentDensity,this);sap.ui.getCore().getEventBus().unsubscribe("sap.ushell.renderers.fiori2.Renderer","appOpened",this.loadUserImage,this);sap.ui.getCore().getEventBus().unsubscribe("sap.ushell.renderers.fiori2.Renderer","appOpened",this.setBackGroundShapes,this);sap.ui.getCore().getEventBus().unsubscribe("sap.ushell.renderers.fiori2.Renderer","appOpened",this.checkEUFeedback,this);sap.ui.getCore().getEventBus().unsubscribe("sap.ushell.renderers.fiori2.Renderer","appOpened",this.delayedCloseLoadingScreen,this);sap.ui.getCore().getEventBus().unsubscribe("sap.ushell.renderers.fiori2.Renderer","appOpened",this._loadCoreExtNWBC,this);sap.ui.getCore().getEventBus().unsubscribe("launchpad","coreExtLoaded",this.checkEUFeedback,this);sap.ui.getCore().getEventBus().unsubscribe("launchpad","coreExtLoaded",this.loadMeAreaView,this);sap.ui.getCore().getEventBus().unsubscribe("sap.ushell.services.Notifications","onNewNotifications",this._handleAlerts,this);sap.ui.getCore().getEventBus().unsubscribe("launchpad","appClosed",this.logApplicationUsage,this);sap.ui.getCore().getEventBus().unsubscribe("launchpad","launchpadCustomRouterRouteMatched",this._centerViewPort,this);sap.ui.Device.media.detachHandler(this.onScreenSizeChange.bind(this),null,sap.ui.Device.media.RANGESETS.SAP_STANDARD);this.oShellNavigation.hashChanger.destroy();this.getView().aDanglingControls.forEach(function(o){if(o.destroyContent){o.destroyContent();}o.destroy();});sap.ushell.UserActivityLog.deactivate();if(sap.ushell.Container){if(sap.ushell.Container.getService("Notifications").isEnabled()===true){sap.ushell.Container.getService("Notifications").destroy();}}s.destroy();s=undefined;},getAnimationType:function(){return"show";},onCurtainClose:function(e){jQuery.sap.log.warning("Closing Curtain",e);},handleDataLoss:function(e,o){if(!a){a=true;this.closeLoadingScreen();return this.oShellNavigation.NavigationFilterStatus.Custom;}if(sap.ushell.Container.getDirtyFlag()){if(!sap.ushell.resources.browserI18n){sap.ushell.resources.browserI18n=sap.ushell.resources.getTranslationModel(window.navigator.language).getResourceBundle();}if(confirm(sap.ushell.resources.browserI18n.getText("dataLossInternalMessage"))){sap.ushell.Container.setDirtyFlag(false);return this.oShellNavigation.NavigationFilterStatus.Continue;}a=false;hasher.setHash(o);return this.oShellNavigation.NavigationFilterStatus.Custom;}return this.oShellNavigation.NavigationFilterStatus.Continue;},doShowMessage:function(t,M,p){jQuery.sap.require("sap.m.MessageToast");jQuery.sap.require("sap.m.MessageBox");if(t===sap.ushell.services.Message.Type.ERROR){if(sap.ushell.Container.getService("SupportTicket").isEnabled()&&M!==sap.ushell.resources.i18n.getText("supportTicketCreationFailed")){try{jQuery.sap.require("sap.ushell.ui.launchpad.EmbeddedSupportErrorMessage");var f=new sap.ushell.ui.launchpad.EmbeddedSupportErrorMessage("EmbeddedSupportErrorMessage",{title:p.title||sap.ushell.resources.i18n.getText("error"),content:new sap.m.Text({text:M})});f.open();}catch(e){sap.m.MessageBox.show(M,sap.m.MessageBox.Icon.ERROR,p.title||sap.ushell.resources.i18n.getText("error"));}}else{sap.m.MessageBox.show(M,sap.m.MessageBox.Icon.ERROR,p.title||sap.ushell.resources.i18n.getText("error"));}}else if(t===sap.ushell.services.Message.Type.CONFIRM){if(p.actions){sap.m.MessageBox.show(M,sap.m.MessageBox.Icon.QUESTION,p.title,p.actions,p.callback);}else{sap.m.MessageBox.confirm(M,p.callback,p.title);}}else{sap.m.MessageToast.show(M,{duration:p.duration||3000});}},_isColdStart:function(){if(this.history.getHistoryLength()<=1){return true;}this._isColdStart=function(){return false;};return false;},_setEnableHashChange:function(v){a=v;},_logRecentActivity:function(r){if(C&&C.enableRecentActivity){setTimeout(function(){if(sap.ushell.Container){sap.ushell.services.AppConfiguration.addActivity(r);}},700);}},_logOpenAppAction:function(f){if(C&&C.enableTilesOpacity&&C.enableRecentActivity){setTimeout(function(){if(sap.ushell.Container){u.addAppUsage(f);}},700);}},doHashChange:function(S,A,o,O,p){jQuery.sap.measure.start("FLP:ShellController.doHashChange","doHashChange","FLP");var t=this,i,f;sap.ushell.utils.addTime("ShellControllerHashChange");this.lastApplicationFullHash=O?o+O:o;if(!a){a=true;this.closeLoadingScreen();return;}if(p){this.hashChangeFailure(this.history.getHistoryLength(),p.message,null,"sap.ushell.renderers.fiori2.Shell.controller",false);return;}if(sap.m.InstanceManager&&c){sap.m.InstanceManager.closeAllDialogs();sap.m.InstanceManager.closeAllPopovers();}c=true;this.openLoadingScreen();if(sap.ushell.utils.getParameterValueBoolean("sap-ushell-no-ls")){this.closeLoadingScreen();}i=this.history.getHistoryLength();f=this.fixShellHash(S);this.history.hashChange(f,o);this.currentAppBeforeNav=sap.ushell.services.AppConfiguration.getCurrentAppliction();this._resolveHashFragment(f).done(function(r,P){var I=P?P.semanticObject+"-"+P.action:"",C=t._getConfig(),e,T=r&&r.ui5ComponentName,g=!!T,h=r&&r.componentHandle;r=t._calculateNavigationMode(P,f,r);if(r&&(r.navigationMode===n.newWindow||sap.ushell.utils.isNativeWebGuiNavigation(r))){t._openAppInNewWindowAndRestore(r);return;}if(t.getModel().getProperty("/migrationConfig")){C.migrationConfig=false;t.getModel().setProperty("/migrationConfig",false);if(r&&f==='#'){C.rootIntent="";}else if(f==='#'){setTimeout(function(){hasher.setHash(C.rootIntent);},0);return;}}if(h){t._initiateApplication(r,f,P,i);return;}if(!g){t._initiateApplication(r,f,P,i);return;}if(C&&C.applications&&C.applications[I]){r.applicationConfiguration=C.applications[I];}e=t._getExistingAppAndDestroyIfNotRoot(I);if(e){t._initiateApplication(r,f,P,i);return;}else{sap.ui.getCore().getEventBus().publish("sap.ushell.components.container.ApplicationContainer","_prior.newUI5ComponentInstantion",{name:T});jQuery.sap.measure.start("FLP:ShellController.UI5createComponent","UI5 createComponent","FLP");sap.ushell.Container.getService("Ui5ComponentLoader").createComponent(r,P,t._createWaitForRendererCreatedPromise()).done(function(R){jQuery.sap.measure.end("FLP:ShellController.UI5createComponent");t._initiateApplication(r,f,P,i);}).fail(function(E){t.hashChangeFailure(i,"Failed to load U5 component for navigation intent "+f,E,"sap.ushell.renderers.fiori2.Shell.controller",false);});}}).fail(function(M){t.hashChangeFailure(i,"Failed to resolve navigation target: \""+f+"\"",M,"sap.ushell.renderers.fiori2.Shell.controller",false);});jQuery.sap.measure.end("FLP:ShellController.doHashChange");},_initiateApplication:function(r,f,p,o){jQuery.sap.measure.start("FLP:ShellController._initiateApplication","_initiateApplication","FLP");var M=sap.ushell.services.AppConfiguration.getMetadata(r);window.document.title=M.title;if(this.bContactSupportEnabled){sap.ushell.UserActivityLog.activate();}this._logOpenAppAction(f);try{this.navigate(p,f,M,r);}catch(e){if(e.stack){jQuery.sap.log.error("Application initialization (Intent: \n"+f+"\n failed due to an Exception:\n"+e.stack);}this.hashChangeFailure(o,e.name,e.message,M?M.title:"",false);}finally{if(r&&r.coreResourcesFullyLoaded&&!this._pluginLoadingTriggered){this._pluginLoadingTriggered=true;jQuery.sap.log.info("Triggering load of 'RendererExtension' plug-ins after application initialization",null,"sap.ushell.renderers.fiori2.Shell");sap.ushell.Container.getService("PluginManager").loadPlugins("RendererExtensions");}}jQuery.sap.measure.end("FLP:ShellController._initiateApplication");},_resolveHashFragment:function(S){jQuery.sap.measure.start("FLP:ShellController._resolveHashFragment","_resolveHashFragment","FLP");var r,p,P=sap.ushell.Container.getService("URLParsing").parseShellHash(S),D=new jQuery.Deferred(),C=this._getConfig();p=P&&P.params||{};if(P&&P.contextRaw&&P.contextRaw==="navResCtx"&&p&&p.additionalInformation&&(p.additionalInformation[0]||p.additionalInformation[0]==="")&&p.applicationType&&p.applicationType[0]&&p.url&&p.url[0]&&p.navigationMode&&(p.navigationMode[0]||p.additionalInformation[0]==="")){p=P.params||{};r={additionalInformation:p.additionalInformation[0],applicationType:p.applicationType[0],url:p.url[0],navigationMode:p.navigationMode[0]};if(p.title){r.text=p.title[0];}D.resolve(r,P);}else{if(window["sap-ushell-async-libs-promise-directstart"]){window["sap-ushell-async-libs-promise-directstart"].then(function(o){D.resolve(o.resolvedHashFragment,P);delete window["sap-ushell-async-libs-promise-directstart"];},function(M){D.reject(M);delete window["sap-ushell-async-libs-promise-directstart"];});return D.promise();}sap.ushell.Container.getService("NavTargetResolution").resolveHashFragment(S).done(function(r){if(P&&(P.semanticObject+"-"+P.action)===C.rootIntent){r.navigationMode="embedded";}jQuery.sap.measure.end("FLP:ShellController._resolveHashFragment");D.resolve(r,P);}).fail(function(M){D.reject(M);});}return D.promise();},_calculateNavigationMode:function(p,f,r){if(!r){return undefined;}var N=r.navigationMode;if(N===n.newWindowThenEmbedded){if(this._isColdStart()||(p.contextRaw&&p.contextRaw==="navResCtx")||this.history.backwards){r.navigationMode=n.embedded;}else{r.navigationMode=n.newWindow;if(!sap.ushell.utils.isNativeWebGuiNavigation(r)){r.url=encodeURI(f);}}return r;}if(N===n.newWindow&&this._isColdStart()){r.navigationMode=n.replace;return r;}return r;},_handleConditionalNavigation:function(p,f,M,r){var N=r.navigationMode;if(N===n.newWindowThenEmbedded){if(this._isColdStart()||(p.contextRaw&&p.contextRaw==="navResCtx")||this.history.backwards){r.navigationMode=n.embedded;this.navigate(p,f,M,r);}else{r.navigationMode=n.newWindow;r.url=encodeURI(f);this.navigate(p,f,M,r);}return true;}if(N===n.newWindow&&this._isColdStart()){r.navigationMode=n.replace;this.navigate(p,f,M,r);return true;}return false;},_usesNavigationRedirect:function(o){if(!o){return new jQuery.Deferred().reject().promise();}var t=this,e=o.getInstance({});if(e&&typeof e.navigationRedirect==="function"){var D=new jQuery.Deferred();var N=e.navigationRedirect();if(N&&typeof N.then==="function"){N.then(function(f){jQuery.sap.log.warning("Performing navigation redirect to hash "+f);e.destroy();t.history.pop();sap.ushell.Container.getService("ShellNavigation").toExternal({target:{shellHash:f}},undefined,false);D.resolve(true);},function(){D.reject();});return D.promise();}}return new jQuery.Deferred().reject().promise();},navigate:function(p,f,M,r){jQuery.sap.measure.start("FLP:ShellController.navigate","navigate","FLP");var N=(jQuery.isPlainObject(r)?r.navigationMode:null),t=this;if(N===null){if(this._isColdStart()){hasher.setHash("");return;}a=false;this.history.pop();this._windowHistoryBack(1);return;}r=this._calculateNavigationMode(p,f,r);N=(jQuery.isPlainObject(r)?r.navigationMode:null);if(N===n.embedded){var D=this._usesNavigationRedirect(r.componentHandle);D.fail(function(){t._handleEmbeddedNavMode(f,p,M,r);if(p&&p.contextRaw==="navResCtx"){jQuery.sap.log.error(" This path will no longer be supported in 1.40");a=false;if(p&&p.params&&p.params.original_intent&&p.params.original_intent[0]){hasher.replaceHash(p.params.original_intent[0]);t.history._history[0]=p.params.original_intent[0];}}});jQuery.sap.measure.end("FLP:ShellController.navigate");return;}if(N===n.replace){a=false;this._changeWindowLocation(r.url);return;}if(N===n.newWindow){this._openAppInNewWindowAndRestore(r);return;}this.hashChangeFailure(this.history.getHistoryLength(),"Navigation mode is not recognized",null,"sap.ushell.renderers.fiori2.Shell.controller",false);},_openAppInNewWindowAndRestore:function(r){a=false;if(sap.ushell.utils.isNativeWebGuiNavigation(r)){try{var U=sap.ushell.utils.appendUserIdToUrl("sap-user",r.url);var E=sap.ushell.utils.getPrivateEpcm();E.doNavigate(U);}catch(e){if(e.stack){jQuery.sap.log.error("Application initialization failed due to an Exception:\n"+e.stack);}this.hashChangeFailure(this.history.getHistoryLength(),e.name,e.message,r.text,false);}}else{this._openAppNewWindow(r.url);}this.history.pop();var v=r.componentHandle&&r.componentHandle.getInstance&&r.componentHandle.getInstance({});if(v){v.destroy();}this._windowHistoryBack(1);sap.ushell.services.AppConfiguration.setCurrentApplication(this.currentAppBeforeNav);return;},_handleEmbeddedNavMode:function(f,p,M,r){jQuery.sap.measure.start("FLP:ShellController._handleEmbeddedNavMode","_handleEmbeddedNavMode","FLP");var A,i,l,I,e;this.resetShellUIServiceHandlers();this.setAppIcons(M);A='-'+p.semanticObject+'-'+p.action;l=(r.applicationType==="NWBC"||r.applicationType==="TR");I=f==="#"||(C.rootIntent&&C.rootIntent===p.semanticObject+"-"+p.action);if(I&&!this.oHomeApp&&!C.disableHomeAppCache){this._saveHomePageComponent();}e=p?p.semanticObject+"-"+p.action:"";if(l&&!r.explicitNavMode){if(r.applicationType==="NWBC"&&C.appState&&C.appState==="headerless"){this.switchViewState("headerless");}else{this.switchViewState("minimal");}}else if(I){this.switchViewState("home");this.oShellUIService.setBackNavigation();}else{this.switchViewState("app");}i=this.getWrappedApplication(e,M,r,A,r.fullWidth||M.fullWidth||l);if(I&&!C.disableHomeAppCache){if(!this.oViewPortContainer.getInitialCenterViewPort()){this.oViewPortContainer.setInitialCenterViewPort(i);}}this.oViewPortContainer.navTo('centerViewPort',i.getId(),'show');this._centerViewPort();jQuery.sap.measure.end("FLP:ShellController._handleEmbeddedNavMode");},_centerViewPort:function(){this.oViewPortContainer.switchState("Center");},_getExistingAppAndDestroyIfNotRoot:function(i){var e;e=this.oViewPortContainer&&(this.oViewPortContainer.getViewPortControl('centerViewPort',"application"+'-'+i)||this.oViewPortContainer.getViewPortControl('centerViewPort',"applicationShellPage"+'-'+i));if(e&&i!==C.rootIntent){this.oViewPortContainer.removeCenterViewPort(e.getId(),true);e.destroy();return null;}else if(e){return e;}},getWrappedApplication:function(i,M,r,A,f){jQuery.sap.measure.start("FLP:ShellController.getWrappedApplication","getWrappedApplication","FLP");var I,e,o,t=this;e=this._getExistingAppAndDestroyIfNotRoot(i,A);if(e){this.closeLoadingScreen();return e;}jQuery.sap.require('sap.ushell.components.container.ApplicationContainer');setTimeout(function(){setTimeout(function(){var g;if(m.getProperty("/currentState/stateName")==="app"){g="shellAppTitle";}sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell(g);setTimeout(function(){t.readNavigationEnd();},500);},100);sap.ui.getCore().getEventBus().publish("launchpad","appOpening",r);jQuery.sap.log.info('app is being opened');},0);if(C.applications){r.applicationConfiguration=C.applications[i];}o=this._getAppContainer(A,r);r.sShellHash=i;this.publishNavigationStateEvents(o,r);if(f){if(!M.hideLightBackground){o.addStyleClass('sapMShellGlobalInnerBackground');}I=o;}else{jQuery.sap.require("sap.m.Shell");I=new sap.m.Shell("applicationShellPage"+A,{logo:sap.ui.resource('sap.ui.core','themes/base/img/1x1.gif'),title:M.title,showLogout:false,app:o}).addStyleClass("sapUshellApplicationPage");if(!M.title){I.addStyleClass("sapUshellApplicationPageNoHdr");}}this._applyContentDensity();o.onfocusin=function(){sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusOnShell=false;sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusPassedToExternalHandlerFirstTime=false;};o.onfocusout=function(){sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusOnShell=true;sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusPassedToExternalHandlerFirstTime=true;};this.oViewPortContainer.addCenterViewPort(I);setTimeout(function(){t.closeLoadingScreen();},0);jQuery.sap.measure.end("FLP:ShellController.getWrappedApplication");return I;},resetShellUIServiceHandlers:function(){this.isHierarchyChanged=false;this.isTitleChanged=false;this.isRelatedAppsChanged=false;this.isBackNavigationChanged=false;},_publicEventDataFromResolutionResult:function(A){var p={};if(!A){return A;}["applicationType","ui5ComponentName","url","additionalInformation","text"].forEach(function(P){p[P]=A[P];});Object.freeze(p);return p;},onAppAfterRendering:function(A){setTimeout(function(){sap.ui.getCore().getEventBus().publish("launchpad","appOpened",A);jQuery.sap.log.info('app was opened');},0);var o=this._publicEventDataFromResolutionResult(A);sap.ushell.renderers.fiori2.utils.publishExternalEvent("appOpened",o);if(this.oShellUIService){if(!this.isHierarchyChanged){this.oShellUIService.setHierarchy();}if(!this.isTitleChanged){this.oShellUIService.setTitle();}if(!this.isRelatedAppsChanged){this.oShellUIService.setRelatedApps();}if(!this.isBackNavigationChanged){this.oShellUIService.setBackNavigation();}}s.updateStateProperty("application/icon",this.getAppIcon(),true);s.updateStateProperty("application/showNavMenuTitle",this.bNavMenuTitleVisible,true);},_getAppContainer:function(A,r){if(!this.oShellUIService){this.initShellUIService();}r.shellUIService=this.oShellUIService.getInterface();var o=new sap.ushell.components.container.ApplicationContainer("application"+A,r);return o;},_saveHomePageComponent:function(){if(this.oHomeApp){return;}var t=this,e="sap.ushell.components.container.ApplicationContainer",l=function(E,f,D){t.oHomeApp=D.component;sap.ui.getCore().getEventBus().unsubscribe(e,'componentCreated',l);};sap.ui.getCore().getEventBus().subscribe(e,'componentCreated',l);},hashChangeFailure:function(h,M,D,e,E){this.reportError(M,D,e);this.closeLoadingScreen();this.delayedMessageError(sap.ushell.resources.i18n.getText("fail_to_start_app_try_later"));c=false;if(h===0){hasher.setHash("");}else{if(jQuery.sap.getUriParameters().get("bFallbackToShellHome")){hasher.setHash("");}else{a=E;this._windowHistoryBack(1);}}},reportError:function(M,D,e){jQuery.sap.log.error(M,D,e);},delayedMessageError:function(M){setTimeout(function(){if(sap.ushell.Container!==undefined){sap.ushell.Container.getService("Message").error(M);}},0);},fixShellHash:function(S){if(!S){S='#';}else if(S.charAt(0)!=='#'){S='#'+S;}return S;},publishNavigationStateEvents:function(A,o){var e,i=A.getId?A.getId():"",t=this;var f=sap.ushell.services.AppConfiguration.getMetadata(),I=f.icon,T=f.title;A.addEventDelegate({onAfterRendering:this.onAppAfterRendering.bind(this,o)});e=A.exit;A.exit=function(){if(e){e.apply(this,arguments);}t._applyContentDensity();setTimeout(function(){var E=jQuery.extend(true,{},o);delete E.componentHandle;E["appId"]=i;E["usageIcon"]=I;E["usageTitle"]=T;sap.ui.getCore().getEventBus().publish("launchpad","appClosed",E);jQuery.sap.log.info('app was closed');},0);var p=t._publicEventDataFromResolutionResult(o);sap.ushell.renderers.fiori2.utils.publishExternalEvent("appClosed",p);};},_openAppNewWindow:function(U){var e=window.open(U);if(!e){var f=sap.ushell.resources.i18n.getText("fail_to_start_app_popup_blocker");this.delayedMessageError(f);}},_windowHistoryBack:function(S){window.history.back(S);},_changeWindowLocation:function(U){window.location.href=U;},setAppIcons:function(M){jQuery.sap.measure.start("FLP:ShellController.setAppIcons","setAppIcons","FLP");var e=jQuery.sap.getModulePath("sap.ushell"),l=(M&&M.homeScreenIconPhone)||(e+'/themes/base/img/launchicons/57_iPhone_Desktop_Launch.png'),L=(M&&M["homeScreenIconPhone@2"])||(e+'/themes/base/img/launchicons/114_iPhone-Retina_Web_Clip.png'),o=(M&&M.homeScreenIconTablet)||(e+'/themes/base/img/launchicons/72_iPad_Desktop_Launch.png'),f=(M&&M["homeScreenIconTablet@2"])||(e+'/themes/base/img/launchicons/144_iPad_Retina_Web_Clip.png'),F=(M&&M.favIcon)||(this._getDefaultFavIcon()),g=this.getFavIconHref();if(sap.ui.Device.os.ios){jQuery.sap.setIcons({'phone':l,'phone@2':L,'tablet':o,'tablet@2':f,'favicon':F,'precomposed':true});}else if(g!==F){jQuery.sap.setIcons({'phone':'','phone@2':'','tablet':'','tablet@2':'','favicon':F,'precomposed':true});}jQuery.sap.measure.end("FLP:ShellController.setAppIcons");},_getDefaultFavIcon:function(){jQuery.sap.require("sap.ui.core.theming.Parameters");var f=sap.ui.core.theming.Parameters.get('@sapFavicon');if(f){var e=/url[\s]*\('?"?([^\'")]*)'?"?\)/.exec(f);if(e){f=e[1];}else if(f==="''"||f==="none"){f=null;}}if(!f){var M=jQuery.sap.getModulePath("sap.ushell");return M+'/themes/base/img/launchpad_favicon.ico';}return f;},handleEndItemsOverflow:function(p){var e=this.getModel().getProperty("/currentState/headEndItems");if(p.name==='Phone'){if(e.indexOf("endItemsOverflowBtn")===-1){s.addHeaderEndItem(["endItemsOverflowBtn"],false,["home","app"]);}}else{if(e.indexOf("endItemsOverflowBtn")>-1){s.removeHeaderEndItem(["endItemsOverflowBtn"],false,["home","app"]);}var P=sap.ui.getCore().byId('headEndItemsOverflow');if(P){P.destroy();}}},isHeadEndItemOverflow:function(){var e=this.getModel().getProperty("/currentState/headEndItems");if(e.indexOf("endItemsOverflowBtn")===-1){return false;}else{return e.length>3;}},isHeadEndItemInOverflow:function(e){return e!=="ENDITEMSOVERFLOWBTN"&&!this.isHeadEndItemNotInOverflow(e);},isHeadEndItemNotInOverflow:function(e){if(this.isHeadEndItemOverflow()){if(e==="NOTIFICATIONSCOUNTBUTTON"||e==="ENDITEMSOVERFLOWBTN"){return true;}else{return false;}}else{if(e==="ENDITEMSOVERFLOWBTN"){return false;}else{return true;}}},pressEndItemsOverflow:function(e){if(!sap.ui.Device.system.desktop){var o=m.getProperty("/currentState").headerHiding;if(o){m.setProperty("/currentState/headerHiding",false);}}var p=sap.ui.getCore().byId('headEndItemsOverflow');function f(){p.close();}var i;if(p){i=p.getContent()[0];}else{var F=new sap.ui.model.Filter('','EQ','a');F.fnTest=this.isHeadEndItemInOverflow.bind(this);i=new sap.ui.layout.VerticalLayout({content:{path:"/currentState/headEndItems",filters:[F],factory:function(I,g){var h=sap.ui.getCore().byId(g.getObject());h.detachPress(f);h.attachPress(f);return h;}}});p=new sap.m.Popover("headEndItemsOverflow",{placement:sap.m.PlacementType.Bottom,showHeader:false,showArrow:false,content:i}).addStyleClass("sapUshellPopupContainer");i.updateAggregation=this.getView().updateShellAggregation;p.setModel(m);this.getView().aDanglingControls.push(p);p.attachAfterClose(p,function(){if(!sap.ui.Device.system.desktop){if(o){m.setProperty("/currentState/headerHiding",o);}}});}if(p.isOpen()){p.close();}else{i.updateAggregation("content");p.openBy(e.getSource());}},getFavIconHref:function(){return jQuery('link').filter('[rel="shortcut icon"]').attr('href')||'';},externalSearchTriggered:function(e,E,D){m.setProperty("/searchTerm",D.searchTerm);D.query=D.searchTerm;},onAfterNavigate:function(e){this.closeLoadingScreen();var h=this.oViewPortContainer.getInitialCenterViewPort(),f=e.getParameter("fromId"),F=e.getParameter("from");if(f&&f!==h){this.oViewPortContainer.removeCenterViewPort(f,true);F.destroy();}sap.ushell.utils.addTime("ShellController.onAfterNavigate");if(e.mParameters&&e.mParameters.toId===h){sap.ui.getCore().byId("configBtn").focus();if(this.oHomeApp&&this.oHomeApp.setInitialConfiguration){this.oHomeApp.setInitialConfiguration();}}},logApplicationUsage:function(e,N,A){if(C&&C.enableRecentActivity){var i=A.appId,I=i,r={};r.title=A.usageTitle;r.appType=sap.ushell.services.AppType.APP;r.url='#'+this.lastApplicationFullHash;if(i.indexOf('-')>0){I=i.substr(i.indexOf('-')+1);}r.appId='#'+I;if(I==="Action-search"){r.appType=sap.ushell.services.AppType.SEARCH;}this._logRecentActivity(r);}},openLoadingScreen:function(){jQuery.sap.measure.start("FLP:ShellController.openLoadingScreen","openLoadingScreen","FLP");if(this.oFiori2LoadingDialog){var A=m.getProperty('/animationMode');var A=A||'full';this.oFiori2LoadingDialog.openLoadingScreen(A);}jQuery.sap.measure.end("FLP:ShellController.openLoadingScreen");},closeLoadingScreen:function(){if(this.oFiori2LoadingDialog){this.oFiori2LoadingDialog.closeLoadingScreen();}},readNavigationEnd:function(){var A=document.getElementById("sapUshellLoadingAccessibilityHelper-loadingComplete");if(A){A.setAttribute("aria-live","polite");A.innerHTML=sap.ushell.resources.i18n.getText("loadingComplete");setTimeout(function(){A.setAttribute("aria-live","off");A.innerHTML="";},0);}},delayedCloseLoadingScreen:function(){setTimeout(function(){this.closeLoadingScreen();}.bind(this),600);},togglePane:function(e){var S=e.getSource(),f=S.getSelected();sap.ui.getCore().getEventBus().publish("launchpad","togglePane",{currentContent:S.getModel().getProperty("/currentState/paneContent")});if(e.getParameter("id")==="categoriesBtn"){S.getModel().setProperty("/currentState/showCurtainPane",!f);}else{S.getModel().setProperty("/currentState/showPane",!f);}},toggleNotificationsView:function(e){var S=e.getSource(),N,o=sap.ushell.Container.getService("Notifications"),f=sap.ui.getCore().byId("notifications-preview-container");this.bMeAreaSelected=false;var M=sap.ui.getCore().byId("meAreaHeaderButton");if(M){M.setSelected(false);jQuery(M.getDomRef()).attr("aria-pressed","false");}if(!sap.ui.getCore().byId('notificationsView')){N=sap.ui.view("notificationsView",{viewName:"sap.ushell.renderers.fiori2.notifications.Notifications",type:'JS',viewData:{}});this.oViewPortContainer.addRightViewPort(N);}this.bNotificationsSelected=S.getSelected();if(this.bNotificationsSelected){this._switchViewPortStateByControl(S,"Center");}else{this.getView().getModel().setProperty("/notificationsCount",0);if(f){f.setFloatingContainerItemsVisiblity(false);var i=f.getFloatingContainerItems().length;setTimeout(function(){this.oViewPortContainer.navTo('rightViewPort',"notificationsView",'show');this._switchViewPortStateByControl(S,"RightCenter");sap.ui.getCore().getEventBus().publish("launchpad","notificationViewOpened");}.bind(this),300+(i*100));}else{this.oViewPortContainer.navTo('rightViewPort',"notificationsView",'show');this._switchViewPortStateByControl(S,"RightCenter");sap.ui.getCore().getEventBus().publish("launchpad","notificationViewOpened");}}this.bNotificationsSelected=!this.bNotificationsSelected;S.setSelected(this.bNotificationsSelected);o.notificationsSeen();this.getView().getModel().setProperty("/notificationsCount",0);jQuery(S.getDomRef()).attr("aria-pressed",this.bNotificationsSelected);jQuery(S.getDomRef()).attr("aria-label",sap.ushell.resources.i18n.getText("NotificationToggleButtonCollapsedNoNotifications"));},toggleMeAreaView:function(e){var S=e.getSource(),f=S.getSelected(),m=this.getModel(),g=m.getProperty('/currentState/stateName');this.bMeAreaSelected=!f;if(g==='embedded'||g==='embedded-home'||g==='standalone'||g==='blank-home'||g==='blank'){if(!f){this.loadMeAreaView();}this._showActionsInPopOver(S);}else{this._switchToMeAreaView(S);}var N=sap.ui.getCore().byId("NotificationsCountButton");if(N&&this.bNotificationsSelected){this.bNotificationsSelected=false;N.setSelected(false);jQuery(N.getDomRef()).attr("aria-pressed","false");}jQuery(S.getDomRef()).attr("aria-pressed",this.bMeAreaSelected);},_showActionsInPopOver:function(o){var m=this.getModel(),e=m.getProperty('/currentState/actions');if(!this.oActionsPopover){this.oActionsLayout=new sap.ui.layout.VerticalLayout();this.oActionsPopover=new sap.m.Popover("sapUshellActionsPopover",{showHeader:false,placement:sap.m.PlacementType.Bottom,content:this.oActionsLayout}).addStyleClass("sapUshellPopupContainer");}this.oActionsLayout.removeAllContent();this._createActionButtons();e.forEach(function(A,i){var f=sap.ui.getCore().byId(A);if(f&&f.setActionType){this.oActionsLayout.addContent(f);f.setActionType('standard');f.addStyleClass('sapUshellStandardActionItem');}}.bind(this));this.oActionsPopover.openBy(o);this.oActionsPopover.setModel(m);},_switchToMeAreaView:function(o){var e=o.getSelected();if(e){this._switchViewPortStateByControl(o,"Center");}else{this._switchViewPortStateByControl(o,"LeftCenter");this.loadMeAreaView();}},_switchViewPortStateByControl:function(o,S){var e=false,v=this.oViewPortContainer;if(o&&o.setEnabled&&typeof o.setEnabled==="function"){e=true;}if(e){o.addStyleClass("sapUshellShellHeadItemOverrideDisableStyle");o.setEnabled(false);}function A(){o.setEnabled(true);o.removeStyleClass("sapUshellShellHeadItemOverrideDisableStyle");v.detachAfterSwitchStateAnimationFinished(A);}if(e){v.attachAfterSwitchStateAnimationFinished(A);}v.switchState(S);},onScreenSizeChange:function(p){this.validateShowLogo(p);this.handleNavMenuTitleVisibility(p);this._handleHomeAndBackButtonsVisibility(p);this.handleEndItemsOverflow(p);},_handleHomeAndBackButtonsVisibility:function(p){var m=sap.ushell.renderers.fiori2.ShellModel.getModel(),i=m.getProperty('/currentViewPortState')==='Center',e=sap.ui.Device.media.getCurrentRange(sap.ui.Device.media.RANGESETS.SAP_STANDARD).name,h=sap.ui.getCore().byId("homeBtn"),o=sap.ui.getCore().byId("backBtn"),H=e==="Desktop",f=e!=="Phone"||i;if(h){h.setVisible(H);}if(o){o.setVisible(f);}},validateShowLogo:function(p){var e;var f=this.getModel().getProperty('/currentState/stateName');var i=f==='merged'||f==='headerless'||f==='headerless-home'||f==='merged-home';if(p){e=p.name;}else{e=sap.ui.Device.media.getCurrentRange(sap.ui.Device.media.RANGESETS.SAP_STANDARD).name;}var S=true;if(e==="Phone"&&!this.bMeAreaSelected||i){S=false;}s.updateStateProperty("showLogo",S,false,["home","app","blank","blank-home"],true);},handleNavMenuTitleVisibility:function(p){this.bNavMenuTitleVisible=false;if(p.name!=="Desktop"){this.bNavMenuTitleVisible=true;}s.updateStateProperty("application/showNavMenuTitle",this.bNavMenuTitleVisible,true);},navigateFromShellApplicationNavigationMenu:function(i){this.oViewPortContainer.switchState("Center");hasher.setHash(i);var S=sap.ui.getCore().byId("shellAppTitle");if(S){S.close();}},loadUserImage:function(){if(!this.bUserImageAlreadyLoaded){this.getView().loadUserImage();this.bUserImageAlreadyLoaded=true;}},_loadCoreExtNWBC:function(S,e,A){if(A&&A.applicationType=="NWBC"){setTimeout(this._loadCoreExt,2000);}},_loadCoreExt:function(){var A=jQuery.sap.isDeclared('sap.fiori.core',true)||jQuery.sap.isDeclared('sap.fiori.core-ext-light',true),M=window['sap-ui-debug']===true?'sap/fiori/core-ext-light-dbg.js':'sap/fiori/core-ext-light.js',t=this;function l(){if(!t._pluginLoadingTriggered){t._pluginLoadingTriggered=true;jQuery.sap.log.info("Triggering load of 'RendererExtension' plug-ins after loading core-ext module (after home page content rendered)",null,"sap.ushell.renderers.fiori2.Shell");sap.ushell.Container.getService("PluginManager").loadPlugins("RendererExtensions");}}if(A){l();return;}this.oCoreExtLoadingDeferred=new jQuery.Deferred();jQuery.sap._loadJSResourceAsync(M).then(function(){l();t.oCoreExtLoadingDeferred.resolve();t._publishCoreExtLoadedEvent();}).catch(function(){l();jQuery.sap.log.warning('failed to load sap.fiori.core-ext-light');t.oCoreExtLoadingDeferred.reject();});},_publishCoreExtLoadedEvent:function(){setTimeout(function(){sap.ui.getCore().getEventBus().publish("launchpad","coreExtLoaded");},0);},getCurrentViewportState:function(){var v=m.getProperty('/currentViewPortState');return v;},makeEndUserFeedbackAnonymousByDefault:function(e){this.oEndUserFeedbackConfiguration.anonymousByDefault=e;},showEndUserFeedbackLegalAgreement:function(S){this.oEndUserFeedbackConfiguration.showLegalAgreement=S;},setFloatingContainerDragSelector:function(e){jQuery(e).addClass("sapUshellShellFloatingContainerSelector");if(this.oFloatingUIActions){this.oFloatingUIActions.delete();}this.oFloatingUIActions=new sap.ushell.UIActions({containerSelector:".sapUiBody",wrapperSelector:'.sapUshellShellFloatingContainerWrapper',draggableSelector:'.sapUshellShellFloatingContainerWrapper',rootSelector:".sapUiBody",cloneClass:"sapUshellFloatingContainer-clone",dragCallback:this._handleFloatingContainerUIStart.bind(this),endCallback:this._handleFloatingContainerDrop.bind(this),moveTolerance:3,switchModeDelay:1000,isLayoutEngine:false,isTouch:false,elementToCapture:e,debug:jQuery.sap.debug()}).enable();},_handleFloatingContainerDrop:function(e,f,D){var F=f.firstChild?sap.ui.getCore().byId(f.firstChild.id):undefined,g=jQuery.sap.storage(jQuery.sap.storage.Type.local,"com.sap.ushell.adapters.local.FloatingContainer"),w=jQuery(window).width(),W=jQuery(window).height(),p=D.deltaX/w,P=D.deltaY/W,o=f.style.visibility,O=f.style.display,i=parseFloat(f.style.left.replace("%","")),h=parseFloat(f.style.top.replace("%",""));f.style.visibility='hidden';f.style.display='block';if(typeof(i)==='number'){p=i+100*D.deltaX/w;}if(typeof(h)==='number'){P=h+100*D.deltaY/W;}f.setAttribute("style","left:"+p+"%;top:"+P+"%;position:absolute;");f.visibility=o;f.display=O;g.put("floatingContainerStyle",f.getAttribute("style"));if(F){F.handleDrop();}},_handleFloatingContainerUIStart:function(f,g){var h=g;h.style.display="none";if(window.getSelection){var i=window.getSelection();try{i.removeAllRanges();}catch(e){}}},setFloatingContainerVisibility:function(v){this.getView().getOUnifiedShell().setFloatingContainerVisible(v);},getFloatingContainerVisibility:function(){return this.getView().getOUnifiedShell().getFloatingContainerVisible();},setFloatingContainerContent:function(p,i,e,S){var f=document.querySelector(".sapUshellShellFloatingContainerWrapper"),g=jQuery.sap.storage(jQuery.sap.storage.Type.local,"com.sap.ushell.adapters.local.FloatingContainer");if(g.get("floatingContainerStyle")){f.setAttribute("style",g.get("floatingContainerStyle"));}else{var h=jQuery(".sapUshellShellHeadItm").position()?jQuery(".sapUshellShellHeadItm").position().left:0;var l=(jQuery(window).width()-jQuery("#shell-floatingContainer").width()-h)*100/jQuery(window).width();var t=jQuery(".sapUshellShellHeadContainer").height()*100/jQuery(window).height();f.setAttribute("style","left:"+l+"%;"+"top:"+t+"%;position:absolute;");}s.setFloatingContainerContent(p,i,e,S);},getRightFloatingContainerVisibility:function(){var r=this.getView().getOUnifiedShell().getRightFloatingContainer(),R=r&&r.getVisible();return R;},setHeaderTitle:function(t,i){if(typeof t!=="string"){throw new Error("sTitle type is invalid");}this.getView().getOUnifiedShell().getHeader().setTitleControl(t,i);},addEndUserFeedbackCustomUI:function(o,S){if(o){this.oEndUserFeedbackConfiguration.customUIContent=o;}if(S===false){this.oEndUserFeedbackConfiguration.showCustomUIContent=S;}},setFooter:function(f){if(typeof f!=="object"||!f.getId){throw new Error("oFooter value is invalid");}if(this.getView().oShellPage.getFooter()!==null){jQuery.sap.log.warning("You can only set one footer. Replacing existing footer: "+this.getView().oShellPage.getFooter().getId()+", with the new footer: "+f.getId()+".");}this.getView().oShellPage.setFooter(f);},removeFooter:function(){if(this.getView().oShellPage.getFooter()===null){jQuery.sap.log.warning("There is no footer to remove.");return;}this.getView().oShellPage.setFooter(null);},addUserPreferencesEntry:function(e){this._validateUserPrefEntryConfiguration(e);this._updateUserPrefModel(e);},addUserProfilingEntry:function(e){this._validateUserPrefEntryConfiguration(e);this._updateProfilingModel(e);},_validateUserPrefEntryConfiguration:function(e){if((!e)||(typeof e!=="object")){throw new Error("object oConfig was not provided");}if(!e.title){throw new Error("title was not provided");}if(!e.value){throw new Error("value was not provided");}if(typeof e.entryHelpID!=="undefined"){if(typeof e.entryHelpID!=="string"){throw new Error("entryHelpID type is invalid");}else{if(e.entryHelpID===""){throw new Error("entryHelpID type is invalid");}}}if(e.title&&typeof e.title!=="string"){throw new Error("title type is invalid");}if(typeof e.value!=="function"&&typeof e.value!=="string"&&typeof e.value!=="number"){throw new Error("value type is invalid");}if(e.onSave&&typeof e.onSave!=="function"){throw new Error("onSave type is invalid");}if(e.content&&typeof e.content!=="function"){throw new Error("content type is invalid");}if(e.onCancel&&typeof e.onCancel!=="function"){throw new Error("onCancel type is invalid");}},switchViewState:function(S,e){var A=S;if(S==='home'&&(C.appState==='embedded'||C.appState=='headerless'||C.appState=='merged'||C.appState=='blank')){A=C.appState+'-home';}else if(S==='app'&&d.indexOf(C.appState)>=0){A=C.appState;}var o=s.switchState(A,e);if(S==="searchResults"){m.setProperty("/lastSearchScreen",'');if(!hasher.getHash().indexOf("Action-search")===0){var f=sap.ui.getCore().getModel("searchModel");hasher.setHash("Action-search&/searchTerm="+f.getProperty("/uiFilter/searchTerms")+"&dataSource="+JSON.stringify(f.getProperty("/uiFilter/dataSource").getJson()));}}this._handleHomeAndBackButtonsVisibility();sap.ui.getCore().getEventBus().publish("launchpad","shellViewStateChanged",o);},_navBack:function(){this.bMeAreaSelected=false;B();},_historyBackNavigation:function(){window.history.back();},_updateUserPrefModel:function(e){var f=this._getModelEntryFromEntryObject(e),g=m.getProperty("/userPreferences/entries");g.push(f);g=this._reorderUserPrefEntries(g);m.setProperty("/userPreferences/entries",g);},_updateProfilingModel:function(e){var f=this._getModelEntryFromEntryObject(e),g=m.getProperty("/userPreferences/profiling")||[];g.push(f);m.setProperty("/userPreferences/profiling",g);},_getModelEntryFromEntryObject:function(e){return{"entryHelpID":e.entryHelpID,"title":e.title,"editable":e.content?true:false,"valueArgument":e.value,"valueResult":null,"onSave":e.onSave,"onCancel":e.onCancel,"contentFunc":e.content,"contentResult":null,"icon":e.icon};},pressActionBtn:function(e){if(!sap.ui.Device.system.desktop){var o=m.getProperty("/currentState").headerHiding;if(o){m.setProperty("/currentState/headerHiding",false);}}var A=sap.ui.getCore().byId('headActions');if(!A){this._createActionButtons();var f=new sap.ui.model.Filter('','EQ','a');f.fnTest=function(g){var h=m.getProperty("/currentState/actions"),i,j;for(j=0;j<h.length;j++){i=h[j];if(i.toUpperCase()==g){return!!sap.ui.getCore().byId(i);}}};A=new sap.m.ActionSheet("headActions",{placement:sap.m.PlacementType.Bottom,buttons:{path:"/currentState/actions",filters:[f],factory:function(i,g){var h=sap.ui.getCore().byId(g.getObject());if(h&&h.setActionType){h.setActionType("standart");}return h;}}});A.updateAggregation=this.getView().updateShellAggregation;A.setModel(m);this.getView().aDanglingControls.push(A);A.attachAfterClose(A,function(){if(!sap.ui.Device.system.desktop){if(o){m.setProperty("/currentState/headerHiding",o);}}});}A.updateAggregation("buttons");A.openBy(e.getSource());},_setUserPrefModel:function(){var e=m.getProperty("/userPreferences/entries");var D=this._getUserPrefDefaultModel();D.entries=D.entries.concat(e);D.entries=this._reorderUserPrefEntries(D.entries);m.setProperty("/userPreferences",D);},_reorderUserPrefEntries:function(e){var f,t;for(var i=0;i<e.length;i++){if(e[i].entryHelpID==="flpSettingsEntry"){f=i;}else if(e[i].entryHelpID==="themes"){t=i;}if(f!=undefined&&t!=undefined){var g=e.splice(f,1);e.splice(t+1,0,g[0]);break;}}return e;},_getUserPrefDefaultModel:function(){var t=this;var U=sap.ushell.Container.getUser();jQuery.sap.require('sap.ushell.renderers.fiori2.search.userpref.SearchPrefs');var S=sap.ushell.renderers.fiori2.search.userpref.SearchPrefs;var e=S.getEntry();e.isSearchPrefsActive().done(function(o){if(!o){return;}t.addUserProfilingEntry(e);});function G(v,o,q,r,w,x,y,z,A,D,m,E,F){this.view=null;this.getView=function(){if(!this.view||!sap.ui.getCore().byId(v)){if(q==="xml"){this.view=sap.ui.xmlview(v,o);}else{this.view=sap.ui.jsview(v,o);}}if(m){this.view.setModel(m);}return this.view;};return{entryHelpID:r,title:w,valueResult:null,onSave:x?x.bind(this):function(){if(this.getView().getController().onSave){return this.getView().getController().onSave();}return;}.bind(this),onCancel:y?y.bind(this):function(){if(this.getView().getController().onCancel){return this.getView().getController().onCancel();}return;}.bind(this),contentFunc:z?z.bind(this):function(){if(this.getView().getController().getContent){return this.getView().getController().getContent();}return;}.bind(this),valueArgument:A?A.bind(this):function(){var H=jQuery.Deferred(),t=this;setTimeout(function(){if(t.getView().getController().getValue){t.getView().getController().getValue().done(function(I){H.resolve(I);});}},0);return H.promise();}.bind(this),editable:typeof D==="function"?D():D,contentResult:null,icon:E,defaultVisibility:F};}var f=new G("userPrefThemeSelector","sap.ushell.renderers.fiori2.theme_selector.ThemeSelector","xml","themes",sap.ushell.resources.i18n.getText("Appearance"),function(){var o=this.getView().getController().onSave();o.done(function(){if(m.getProperty("/tilesOpacity")===true){sap.ushell.utils.handleTilesOpacity();}});return o;},undefined,undefined,undefined,function(){if(m.getProperty("/setTheme")!==undefined){return m.getProperty("/setTheme")&&U.isSetThemePermitted();}else{return U.isSetThemePermitted();}},this.getView().getModel(),"sap-icon://palette");var g=new G("userPrefUsageAnalyticsSelector","sap.ushell.renderers.fiori2.usageAnalytics_selector.UsageAnalyticsSelector","js","usageAnalytics",sap.ushell.resources.i18n.getText("usageAnalytics"),undefined,undefined,undefined,undefined,sap.ushell.Container.getService("UsageAnalytics").isSetUsageAnalyticsPermitted());var h=new G("defaultParametersSelector","sap.ushell.renderers.fiori2.defaultParameters_selector.DefaultParameters","js",undefined,sap.ushell.resources.i18n.getText("defaultsValuesEntry"),undefined,undefined,undefined,undefined,true,undefined,undefined,false);var i=new G("userProfilingView","sap.ushell.renderers.fiori2.profiling.UserProfiling","js","userProfiling",sap.ushell.resources.i18n.getText("userProfiling"),undefined,undefined,undefined,undefined,false,this.getView().getModel(),"sap-icon://user-settings",false);function L(){this.view=null;this.getView=function getView(){if(!this.languageRegionSelector){this.languageRegionSelector=sap.ui.jsview("languageRegionSelector","sap.ushell.renderers.fiori2.userPreferences.LanguageRegionSelector");}return this.languageRegionSelector;};var o=function(){var w=this.getView().getController().onSave();return w;}.bind(this);var q=function(){return this.getView().getController().onCancel();}.bind(this);var r=function(){return this.getView().getController().getContent();}.bind(this);var v=function(){return this.getView().getController().getValue();}.bind(this);return{entryHelpID:"language",title:sap.ushell.resources.i18n.getText("languageRegionTit"),editable:true,valueArgument:v,valueResult:null,onSave:o,onCancel:q,contentFunc:r,contentResult:null,icon:"sap-icon://globe"};}function j(){this.view=null;this.getView=function getView(){if(!this.userAccountSelector){this.userAccountSelector=sap.ui.jsview("UserAccountSelector","sap.ushell.renderers.fiori2.userAccount.UserAccountSelector");}return this.userAccountSelector;};var o=function(){var w=this.getView().getController().onSave();return w;}.bind(this);var q=function(){return this.getView().getController().onCancel();}.bind(this);var r=function(){return this.getView().getController().getContent();}.bind(this);var v=function(){return this.getView().getController().getValue();}.bind(this);return{entryHelpID:"userAccountEntry",title:sap.ushell.resources.i18n.getText("UserAccountFld"),editable:true,valueArgument:v,valueResult:null,onSave:o,onCancel:q,contentFunc:r,contentResult:null,icon:"sap-icon://account"};}var k=[new j(),f,new L()],p=[];p.push(g);k.push(i);if(m.getProperty("/enableNotifications")===true){var N=sap.ushell.Container.getService("Notifications")._getNotificationSettingsAvalability(),l;l=new G("notificationSettings","sap.ushell.renderers.fiori2.notifications.Settings","js",undefined,sap.ushell.resources.i18n.getText("notificationSettingsEntry_title"),undefined,undefined,undefined,undefined,true,undefined,"sap-icon://ui-notifications",false);k.push(l);N.done(function(o){if(o.settingsAvailable){l.visible=true;m.getProperty("/userPreferences/entries").every(function(q,r){if(q.title===sap.ushell.resources.i18n.getText("notificationSettingsEntry_title")){m.setProperty("/userPreferences/entries/"+r+"/visible",true);return false;}return true;});}});}if(m.getProperty("/userDefaultParameters")){k.push(h);}return{dialogTitle:sap.ushell.resources.i18n.getText("userSettings"),isDetailedEntryMode:false,activeEntryPath:null,entries:k,profiling:p};},onAfterViewPortSwitchState:function(e){var t=e.getParameter("to");var S=sap.ui.getCore().byId("shellAppTitle");m.setProperty("/currentViewPortState",t);if(this.applicationKeyHandler){sap.ushell.renderers.fiori2.AccessKeysHandler.registerAppKeysHandler(this.applicationKeyHandler);this.applicationKeyHandler=undefined;}sap.ui.getCore().getEventBus().publish("launchpad","afterSwitchState",e);if(t==="Center"){S.setVisible(true);this.bMeAreaSelected=false;}else{S.setVisible(false);if(t==="Right"){this.bMeAreaSelected=false;}else if(t=="RightCenter"){this.applicationKeyHandler=sap.ushell.renderers.fiori2.AccessKeysHandler.getAppKeysHandler();sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusOnShell=false;sap.ushell.renderers.fiori2.AccessKeysHandler.registerAppKeysHandler(sap.ui.getCore().byId("notificationsView").getController().keydownHandler.bind(sap.ui.getCore().byId("notificationsView")));}}this.validateShowLogo();this._handleHomeAndBackButtonsVisibility();},getModel:function(){return m;},_getConfig:function(){return C?C:{};},_createWaitForRendererCreatedPromise:function(){var p,r;r=sap.ushell.Container.getRenderer();if(r){jQuery.sap.log.debug("Shell controller._createWaitForRendererCreatedPromise: shell renderer already created, return empty array.");return[];}else{p=new Promise(function(e,f){var o;o=function(){jQuery.sap.log.info("Shell controller: resolving component waitFor promise after shell renderer created event fired.");e();sap.ushell.Container.detachRendererCreatedEvent(o);};r=sap.ushell.Container.getRenderer();if(r){jQuery.sap.log.debug("Shell controller: resolving component waitFor promise immediately (shell renderer already created");e();}else{sap.ushell.Container.attachRendererCreatedEvent(o);}});return[p];}}});}());};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.SearchIntentsResolver')){(function(){"use strict";var S=sap.ushell.renderers.fiori2.search.SearchNavigationIntentObject;jQuery.sap.declare('sap.ushell.renderers.fiori2.search.SearchIntentsResolver');var m=sap.ushell.renderers.fiori2.search.SearchIntentsResolver=function(){this.init.apply(this,arguments);};m.prototype={init:function(a){this._oCrossAppNav=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation");this._model=a;},resolveIntents:function(r){var t=this;var d=new $.Deferred();if(!t._oCrossAppNav){d.resolve();return d.promise();}t._model.sina.sinaSystem().getServerInfo().then(function(s){var a=false;if(s&&s.rawServerInfo&&s.rawServerInfo.Services){for(var i=0;i<s.rawServerInfo.Services.length;++i){var b=s.rawServerInfo.Services[i];if(b.Service==='Search'){for(var j=0;j<b.Capabilities.length;++j){var c=b.Capabilities[j];if(c.Capability==='SemanticObjectType'){a=true;break;}}break;}}}else{a=true;}if(!a){d.resolve();}else{var p=[];for(var k=0;k<r.length;k++){var e=r[k];if(e.semanticObjectType&&e.semanticObjectType.length>0){var f=t._doResolveIntents(e);p.push(f);}}$.when.apply(null,p).always(function(g){d.resolve();});}});return d.promise();},_doResolveIntents:function(r){var t=this;if(r.titleNavigationIsOldURL){r.titleNavigation=undefined;}var p,o=new $.Deferred();if(t._oCrossAppNav.getLinks){p=t._oCrossAppNav.getLinks({semanticObject:r.semanticObjectType,params:r.semanticObjectTypeAttrs,withAtLeastOneUsedParam:true,sortResultOnTexts:true});}else{p=t._oCrossAppNav.getSemanticObjectLinks(r.semanticObjectType,r.semanticObjectTypeAttrs);}p.done(function(a){var f="-displayFactSheet";var b=r.titleNavigation!==undefined;var s;if(r.systemId&&r.client){s="sap-system=sid("+r.systemId+"."+r.client+")";}r.intents=[];if(!r.navigationObjects){r.navigationObjects=[];}for(var i=0;i<a.length;i++){var c=a[i];var d=c.intent;if(s){if(d.indexOf('?')===-1){d+="?";}else{d+="&";}d+=s;}var e={target:{shellHash:d}};var g=t._oCrossAppNav.hrefForExternal(e);var n=new S({text:c.text,href:g,externalTarget:e});if(!b&&c.intent.substring(c.intent.indexOf("-"),c.intent.indexOf("?"))===f){r.uri=g;r.titleNavigation=n;b=true;}else{c.target=e.target;c.externalHash=g;r.intents.push(c);r.navigationObjects.push(n);}}o.resolve();});p.fail(function(a){o.resolve();});return o;}};})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.SearchModel')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.SearchModel');(function(g){"use strict";jQuery.sap.require('sap.ushell.renderers.fiori2.search.SearchFacetsFormatter');jQuery.sap.require('sap.ushell.renderers.fiori2.search.FacetItem');var s=g.sap;var S=s.ushell.renderers.fiori2.search.SearchHelper;var a=s.ushell.renderers.fiori2.search.SearchResultListFormatter;var T=s.ushell.renderers.fiori2.search.SearchTabStripsFormatter.Formatter;var b=s.ushell.renderers.fiori2.search.suggestions.SuggestionHandler;var c=s.ushell.renderers.fiori2.search.SearchConfiguration;var p=s.ushell.renderers.fiori2.search.personalization.PersonalizationStorage;var d=s.ushell.renderers.fiori2.search.SearchNavigationObject;s.ushell.renderers.fiori2.search.getModelSingleton=function(){if(!s.ushell.renderers.fiori2.search.oModel){s.ushell.renderers.fiori2.search.oModel=new s.ushell.renderers.fiori2.search.SearchModel();}return s.ushell.renderers.fiori2.search.oModel;};s.ui.model.json.JSONModel.extend("sap.ushell.renderers.fiori2.search.SearchModel",{constructor:function(f){var t=this;f=f||{};s.ui.model.json.JSONModel.prototype.constructor.apply(t,[]);t.config=c.getInstance();t.setSizeLimit(200);t.sina=t.config.getSina();this.suggestionQuery=this.sina.createSuggestionQuery();t.suggestionHandler=new b({model:this});t.query=t.sina.createPerspectiveQuery({templateFactsheet:true});if(t.config.multiSelect){t.query.setIncludeFacetsWithFilters(true);}t.setProperty('/uiFilter',t.sina.createFilter());t.resetFilterConditions(false);t.createAllAndAppDataSource();t.query.getResultSet=S.refuseOutdatedRequests(t.query.getResultSet,'search');t.searchApplications=S.refuseOutdatedRequests(t.searchApplications,'search');t.oFacetFormatter=new s.ushell.renderers.fiori2.search.SearchFacetsFormatter();t.tabStripFormatter=new T(t.allDataSource);t.dataSourceTree=t.tabStripFormatter.tree;t.pageSize=10;t.appTopDefault=20;t.boTopDefault=t.pageSize;t.setProperty('/isQueryInvalidated',true);t.setProperty('/isBusy',false);t.setProperty('/tableColumns',[]);t.setProperty('/tableSortableColumns',[]);t.setProperty('/tableResults',[]);t.setProperty('/results',[]);t.setProperty('/appResults',[]);t.setProperty('/boResults',[]);t.setProperty('/count',0);t.setProperty('/boCount',0);t.setProperty('/appCount',0);t.setProperty('/facets',[]);t.setProperty('/dataSources',[t.allDataSource,t.appDataSource]);t.setProperty('/currentPersoServiceProvider',null);t.setProperty('/businessObjSearchEnabled',true);t.setProperty('/suggestions',[]);t.setProperty('/resultToDisplay',S.loadResultViewType());t.setProperty('/displaySwitchVisibility',false);t.setProperty('/documentTitle','Search');t.setProperty('/top',t.boTopDefault);t.setProperty('/orderBy',{});t.setProperty('/facetVisibility',false);t.setProperty('/focusIndex',0);t.setProperty('/fuzzy',false);t.setProperty('/errors',[]);t.setProperty('/isErrorPopovered',false);t.setProperty('/defaultDataSource',t.allDataSource);t.resetDataSource(false);t.setProperty('/multiSelectionAvailable',false);t.setProperty('/multiSelectionEnabled',false);t.setProperty('/multiSelection/actions',[]);t.initBusinessObjSearch();try{t.analytics=s.ushell.Container.getService("UsageAnalytics");}catch(e){}if(!t.analytics){t.analytics={logCustomEvent:function(){}};}},initBusinessObjSearch:function(){var t=this;if(!t.config.searchBusinessObjects){t.setDataSource(t.appDataSource,false);t.setProperty('/businessObjSearchEnabled',false);t.setProperty('/facetVisibility',false);t.setProperty('/defaultDataSource',t.appDataSource);return;}t.sina.sinaSystem().getServerInfo().done(function(e){t.serverInfo=e;t.loadDataSources();}).fail(function(){t.setDataSource(t.appDataSource,false);t.setProperty('/businessObjSearchEnabled',false);t.setProperty('/facetVisibility',false);t.setProperty('/defaultDataSource',t.appDataSource);});},initPersonalization:function(){var t=this;if(this.initPersonalizationPromise){return this.initPersonalizationPromise;}this.initPersonalizationPromise=p.getInstance().then(function(f){var h=false;try{h=f.getItem('search-facet-panel-button-state');}catch(e){}t.setFacetVisibility(h,false);},function(){return jQuery.Deferred().resolve(true);});return this.initPersonalizationPromise;},isBusinessObjSearchConfigured:function(){try{var f=window['sap-ushell-config'].renderers.fiori2.componentData.config;return f.searchBusinessObjects!=='hidden';}catch(e){return true;}},isBusinessObjSearchEnabled:function(){return this.getProperty('/businessObjSearchEnabled');},setProperty:function(n,v,C,A){var t=this;var r=s.ui.model.json.JSONModel.prototype.setProperty.apply(this,arguments);switch(n){case'/boResults':case'/appResults':t.calculateResultList();break;case'/appCount':case'/boCount':r=t.setProperty('/count',t.getProperty('/appCount')+t.getProperty('/boCount'));break;default:break;}return r;},setFuzzy:function(f){if(f===true){this.query.addOption(g.sinabase.QueryOptions.FUZZY);}else{this.query.removeOption(g.sinabase.QueryOptions.FUZZY);}this.setProperty("/fuzzy",f);},getPersonalizationStorageInstance:function(){return p.getInstanceSync();},getSearchBoxTerm:function(){return this.getProperty('/uiFilter/searchTerms');},setSearchBoxTerm:function(e,f){var t=this;var h=e.replace(/^\s+/,"");this.setProperty('/uiFilter/searchTerms',h);this.calculateSearchButtonStatus();if(h.length===0){return;}if(f||f===undefined){t._firePerspectiveQuery();}},getLastSearchTerm:function(){return this.query.getSearchTerms();},setFacetVisibility:function(v,f){if(s.ui.Device.system.phone){v=false;}this.setProperty('/facetVisibility',v);try{this.getPersonalizationStorageInstance().setItem('search-facet-panel-button-state',v);}catch(e){}if((f||f===undefined)&&v){this._firePerspectiveQuery({preserveFormerResults:true});}},getFacetVisibility:function(){return this.getProperty('/facetVisibility');},getTop:function(){return this.getProperty('/top');},setTop:function(t,f){this.setProperty('/top',t);if(f||f===undefined){this._firePerspectiveQuery({preserveFormerResults:true});}},resetTop:function(){this.setProperty('/focusIndex',0);if(this.isAppCategory()){this.setTop(this.appTopDefault,false);}else{this.setTop(this.boTopDefault,false);}},getOrderBy:function(){return this.getProperty('/orderBy');},setOrderBy:function(o,f){this.setProperty('/orderBy',o);if(f||f===undefined){this._firePerspectiveQuery({preserveFormerResults:true});}},resetOrderBy:function(f){this.setProperty('/orderBy',{});if(f||f===undefined){this._firePerspectiveQuery({preserveFormerResults:true});}},isEqualOrderBy:function(o,e){if(jQuery.isEmptyObject(o)&&jQuery.isEmptyObject(e)){return true;}else if(o.orderBy===e.orderBy&&o.sortOrder===e.sortOrder){return true;}else{return false;}},getDocumentTitle:function(){var e=this.getSearchBoxTerm();var f=this.getDataSource().label;var t;if(this.getDataSource().equals(this.allDataSource)){t=s.ushell.resources.i18n.getText('searchTileTitleProposalAll',[e]);}else{t=s.ushell.resources.i18n.getText('searchTileTitleProposal',[e,f]);}return t;},resetQuery:function(){S.hasher.reset();this.resetTop();this.setSearchBoxTerm('');this.resetDataSource(false);this.resetFilterConditions(false);this.query.resetFilterConditions();this.query.setSearchTerms('random-jgfhfdskjghrtekjhg');this.setProperty('/facets',[]);this.setProperty('/results',[]);this.setProperty('/appResults',[]);this.setProperty('/boResults',[]);this.setProperty('/count',0);this.setProperty('/boCount',0);this.setProperty('/appCount',0);},createAllAndAppDataSource:function(){this.allDataSource=this.sina.getRootDataSource();this.allDataSource.label=s.ushell.resources.i18n.getText("label_all");this.allDataSource.labelPlural=s.ushell.resources.i18n.getText("label_all");this.appDataSource=this.sina.createDataSource({objectName:"$$APPS$$",label:s.ushell.resources.i18n.getText("label_apps"),labelPlural:s.ushell.resources.i18n.getText("label_apps"),type:'Apps',name:'Apps',sina:this.sina});},loadDataSources:function(){var t=this;t.getServerDataSources().done(function(e){if(!jQuery.isArray(e)){e=[];}e=e.slice();e.splice(0,0,t.appDataSource);e.splice(0,0,t.allDataSource);t.setProperty("/dataSources",e);t.updateDataSourceList(t.getDataSource());t.setProperty("/searchTermPlaceholder",t.calculatePlaceholder());var f=t.getProperty('/uiFilter/dataSource/key');t.setProperty('/uiFilter/dataSource/key','');t.setProperty('/uiFilter/dataSource/key',f);});},resetDataSource:function(f){this.setDataSource(this.getDefaultDataSource(),f);},isAllCategory:function(){var e=this.getProperty("/uiFilter/dataSource");return e.equals(this.allDataSource);},isOtherCategory:function(){var e=this.getProperty("/uiFilter/dataSource");return e.getType().toLowerCase()==="category"&&!this.isAllCategory();},isAppCategory:function(){var e=this.getProperty("/uiFilter/dataSource");return e.equals(this.appDataSource);},getDataSource:function(){return this.getProperty("/uiFilter/dataSource");},getDefaultDataSource:function(){return this.getProperty("/defaultDataSource");},setDataSource:function(e,f){this.updateDataSourceList(e);this.getProperty("/uiFilter").setDataSource(e);this.setProperty("/searchTermPlaceholder",this.calculatePlaceholder());this.resetTop();this.calculateSearchButtonStatus();if(f||f===undefined){this._firePerspectiveQuery();}},getServerDataSources:function(){var t=this;if(t.getDataSourcesDeffered){return t.getDataSourcesDeffered;}t.getDataSourcesDeffered=t.sina.getDataSources().then(function(e){return jQuery.grep(e,function(f){return f.getType()!=='Category';});},function(e){e.keep=true;e.type='warning';e.message=s.ushell.resources.i18n.getText('searchScopeDeterminationErrorMessage');t.normalSearchErrorHandling(e);});return t.getDataSourcesDeffered;},notifyFilterChanged:function(){jQuery.each(this.aBindings,function(i,e){if(e.sPath==='/uiFilter/defaultConditionGroup'){e.checkUpdate(true);}});},addFilterCondition:function(f,e){if(f.attribute||f.conditions){this.getProperty("/uiFilter").addFilterCondition(f);}else{this.setDataSource(f,false);}if(e||e===undefined){this._firePerspectiveQuery({preserveFormerResults:false});}this.notifyFilterChanged();},removeFilterCondition:function(f,e){if(f.attribute||f.conditions){this.getProperty("/uiFilter").removeFilterCondition(f);}else{this.setDataSource(f,false);}if(e||e===undefined){this._firePerspectiveQuery({preserveFormerResults:true});}this.notifyFilterChanged();},resetFilterConditions:function(f){this.getProperty("/uiFilter").resetFilterConditions();if(f||f===undefined){this._firePerspectiveQuery();}this.notifyFilterChanged();},doSuggestion:function(){this.suggestionQuery.setFilter(this.getProperty('/uiFilter').clone());this.suggestionHandler.doSuggestion();},abortSuggestions:function(){this.suggestionHandler.abortSuggestions();},_firePerspectiveQuery:function(e,f){var t=this;this.setProperty('/isBusy',true);var h=function(){return t._doFirePerspectiveQuery(e,f);};this.initPersonalization().then(h).always(function(){t.setProperty('/isBusy',false);});},_doFirePerspectiveQuery:function(e,f){var t=this;var h,i;if(jQuery.isPlainObject(e)){h=e.deserialization;i=e.preserveFormerResults;}else{h=e?e:undefined;i=f?f:undefined;}var u=this.getProperty('/uiFilter');if(u.equals(this.query.getFilter())&&this.getTop()===this.query.getTop()&&this.isEqualOrderBy(this.getOrderBy(),this.query.getOrderBy())&&this.calculateRequestsEntities().length===this.query.requestedEntities.length&&!this.getProperty('/isQueryInvalidated')){return(new jQuery.Deferred()).resolve();}if((this.query.getFilter().getDataSource()&&!u.getDataSource().equals(this.query.getFilter().getDataSource()))||(this.query.getFilter().getSearchTerms()&&u.getSearchTerms()!==this.query.getFilter().getSearchTerms())){this.resetOrderBy(false);}if(!h){if(u.getSearchTerms()!==this.query.getFilter().getSearchTerms()||!u.defaultConditionGroup.equals(this.query.getFilter().defaultConditionGroup)||!u.getDataSource().equals(this.query.getFilter().getDataSource())){this.resetTop();}}if(u.getSearchTerms()!==this.query.getFilter().getSearchTerms()||!u.defaultConditionGroup.equals(this.query.getFilter().defaultConditionGroup)){this.tabStripFormatter.invalidate(this.getDataSource());}if(this.getProperty('/isQueryInvalidated')===true){this.query.resetResultSet();this.setProperty('/isQueryInvalidated',false);}this.query.setFilter(this.getProperty('/uiFilter').clone());this.query.setTop(this.getTop());this.query.setOrderBy(this.getOrderBy());this.query.setRequestedEntities(this.calculateRequestsEntities());this.cleanErrors();this.setProperty("/queryFilter",this.query.getFilter());s.ui.getCore().getEventBus().publish("allSearchStarted");this.abortSuggestions();S.abortRequests('search');this.calculateVisibility();if(!h){this.updateSearchURLSilently();}this.analytics.logCustomEvent('FLP: Search','Search',[this.getProperty('/uiFilter/searchTerms'),this.getProperty('/uiFilter/dataSource').key]);var j=this.getDataSource();return jQuery.when.apply(null,[this.normalSearch(i),this.appSearch()]).then(function(){t.setProperty('/tabStrips',t.tabStripFormatter.format(j,t.perspective,t));return t.oFacetFormatter.getFacets(j,t.perspective,t).then(function(k){t.setProperty('/facets',k);});}).always(function(){document.title=t.getDocumentTitle();s.ui.getCore().getEventBus().publish("allSearchFinished");});},calculateRequestsEntities:function(){if(this.getDataSource().getType()==='Category'||this.getFacetVisibility()){return['SearchResults','Facets','TotalCount'];}else{return['SearchResults','TotalCount'];}},appSearch:function(){var t=this;this.setProperty("/appResults",[]);this.setProperty("/appCount",0);if(!this.isAllCategory()&&!this.isAppCategory()){return jQuery.when(true);}var e=this.query.getFilter().getDataSource().equals(this.allDataSource)?this.appTopDefault:this.query.getTop();return this.searchApplications(this.query.getFilter().getSearchTerms(),e,0).then(function(r){t.setProperty("/appCount",r.totalResults);t.setProperty("/appResults",r.getElements());},function(){return jQuery.when(true);});},searchApplications:function(e,t,f){return s.ushell.Container.getService("Search").queryApplications({searchTerm:e,searchInKeywords:true,top:t,skip:f});},normalSearch:function(e){var t=this;if(!e){t.resetAndDisableMultiSelection();}if(!t.isBusinessObjSearchEnabled()||t.isAppCategory()){this.setProperty("/boResults",[]);this.setProperty("/boCount",0);return jQuery.when(true);}t.setFuzzy(false);return this.query.getResultSet().then(function(f){if(f.getSearchResultSet().totalcount<1&&t.serverInfo.services.Search.capabilities.OptionFuzzy&&t.query.getFilter().getSearchTerms()!=='*'){t.setProperty("/boResults",[]);t.setProperty("/boCount",0);t.setFuzzy(true);return t.query.getResultSet().then(function(h){t.perspective=h;return t._afterSearchPrepareResultList(t.perspective,e);},function(h){t.normalSearchErrorHandling(h);t.perspective=null;return jQuery.when(true);});}t.perspective=f;return t._afterSearchPrepareResultList(t.perspective,e);},function(f){t.normalSearchErrorHandling(f);t.perspective=null;return jQuery.when(true);});},_prepareTableResults:function(r){var t=this;var e=r;var i,j,f;for(i=0;i<e.length;i++){var h=e[i].itemattributes;if(h.length>0){f=1;for(j=0;j<e[i].itemattributes.length;j++){if(j<=11){e[i].itemattributes[j].indexInTable=f;f++;}}if(!h[0].isTitle){e[i].itemattributes.unshift({name:e[i].dataSourceName,value:e[i].$$Name$$,key:"DATASOURCE_AS_COLUMN_KEY",isTitle:true,isSortable:false,uri:e[i].uri,titleNavigation:e[i].titleNavigation,onlyUsedInTable:true,indexInTable:0});}if(e[i].navigationObjects!==undefined&&e[i].navigationObjects.length>0&&!h[h.length-1].hasIntents){e[i].itemattributes.splice(f,0,{name:s.ushell.resources.i18n.getText("intents"),navigationObjects:e[i].navigationObjects,key:"RELATED_OBJECTS",isNavigationObjects:true,isSortable:false,onlyUsedInTable:true,indexInTable:f});}}}t.setProperty("/tableResults",e);var l=[];var m=[];var n=e[0];var o="";if(n){var q=n.itemattributes;for(i=0;i<q.length;i++){if(q[i].indexInTable!==undefined&&q[i].key!==undefined){o=q[i].key;if(o===escape(o).replace(/[^\w\s]/gi,'')){l.push({"name":q[i].name,"key":o,"index":q[i].indexInTable});if(q[i].isSortable){m.push({"name":q[i].name,"key":o,"selected":t.getProperty("/orderBy").orderBy===o});}}else{t.pushError({type:"warning",title:s.ushell.resources.i18n.getText("keyOfAttributeHasForbiddenCharacters"),description:s.ushell.resources.i18n.getText("keyOfAttributeHasForbiddenCharactersDetail",o)});}}}t.setProperty("/tableColumns",l);var u=n.titleattributes;for(var k=u.length-1;k>=0;k--){if(u[k].key!==undefined){o=u[k].key;if(o===escape(o).replace(/[^\w\s]/gi,'')){if(u[k].isSortable){m.unshift({"name":n.dataSourceName===u[k].name?n.dataSourceName:n.dataSourceName+" / "+u[k].name,"key":o,"selected":t.getProperty("/orderBy").orderBy===o});}}else{t.pushError({type:"warning",title:s.ushell.resources.i18n.getText("keyOfAttributeHasForbiddenCharacters"),description:s.ushell.resources.i18n.getText("keyOfAttributeHasForbiddenCharactersDetail",o)});}}}m.unshift({"name":s.ushell.resources.i18n.getText("defaultRank"),"key":"ushellSearchDefaultSortItem","selected":jQuery.isEmptyObject(t.getProperty("/orderBy"))});t.setProperty("/tableSortableColumns",m);}},_afterSearchPrepareResultList:function(e,f){var t=this;var i;var h=[];if(f){var _=t.getProperty("/boResults");for(i=0;i<_.length;i++){if(_[i].expanded||_[i].selected){h.push(_[i]);}}}t.setProperty("/boResults",[]);t.setProperty("/boCount",0);var k=new a();var n=k.format(e.getSearchResultSet(),this.query.filter.searchTerms);var l;for(i=0;i<n.length;i++){l=n[i];if(l.uri){l.titleNavigation=new d({href:l.uri});l.titleNavigationIsOldURL=true;}}for(i=0;i<n.length;i++){l=n[i];if(!l.navigationObjects){l.navigationObjects=[];}if(l.suvlink&&l.suvlink.value){var m=new d({text:l.suvlink.label,href:l.suvlink.value,target:"_blank"});l.navigationObjects.push(m);}}var o=new s.ushell.renderers.fiori2.search.SearchIntentsResolver(t);var q=o.resolveIntents(n);q.done(function(r){if(!t.isAllCategory()&&!t.isOtherCategory()&&!t.isAppCategory()){t._prepareTableResults(n);}if(h&&h.length>0){var R=t.sina.ResultElementKeyStatus;var u=[];for(i=0;i<n.length;i++){var l=n[i];if(l.keystatus===R.OK){for(var j=0;j<h.length;j++){var v=h[j];if(v.keystatus===R.OK&&v.key===l.key){l.selected=v.selected;l.expanded=v.expanded;h.splice(j,1);break;}}}else{u.push(l);}}if(u.length>0){var w=[];var x="";for(i=0;i<u.length;i++){var y=u[i].dataSource.key;if(jQuery.inArray(y,w)<0){w.push(y);x+=y+"\n";}}t.pushError({type:"warning",title:s.ushell.resources.i18n.getText("preserveFormerResultErrorTitle"),description:s.ushell.resources.i18n.getText("preserveFormerResultErrorDetails",x)});}}var z=t.getDataSource();if(z.getType().toLowerCase()==="businessobject"){var A=[];for(i=0;i<n.length;i++){var B=n[i];var C=B.semanticObjectType;if(!C){A=[];break;}if(jQuery.inArray(C,A)==-1){A.push(C);}}if(A.length==1){z.semanticObjectType=A[0];}else if(A.length>1){z.semanticObjectTypes=A;}}t.setProperty("/boCount",e.getSearchResultSet().totalcount);t.setProperty("/boResults",n);t.enableOrDisableMultiSelection();});return q;},resetAndDisableMultiSelection:function(){this.setProperty("/multiSelectionAvailable",false);this.setProperty("/multiSelectionEnabled",false);},enableOrDisableMultiSelection:function(){var e=this.getDataSource();var f=this.config.getDataSourceConfig(e);var h=new f.searchResultListSelectionHandlerControl();if(h){this.setProperty("/multiSelectionAvailable",h.isMultiSelectionAvailable());}else{this.setProperty("/multiSelectionAvailable",false);}},_endWith:function(e,f){return e.indexOf(f,e.length-f.length)!==-1;},calculatePlaceholder:function(){var t=this;if(t.isAllCategory()){return s.ushell.resources.i18n.getText("search");}else{return s.ushell.resources.i18n.getText("searchInPlaceholder",t.getDataSource().labelPlural);}},updateDataSourceList:function(n){var e=this.getProperty('/dataSources');while(e.length>0&&!e[0].equals(this.allDataSource)){e.shift();}if(n.equals(this.allDataSource)||n.equals(this.appDataSource)){return;}if(n&&n.key){if(n.key.indexOf('~')>=0){return;}}for(var i=0;i<e.length;++i){var f=e[i];if(f.equals(n)){return;}}e.unshift(n);this.setProperty('/dataSources',e);},invalidateQuery:function(){this.setProperty('/isQueryInvalidated',true);},autoStartApp:function(){var t=this;if(t.getProperty("/appCount")&&t.getProperty("/appCount")===1&&t.getProperty("/count")&&t.getProperty("/count")===1){var A=t.getProperty("/appResults");if(A&&A.length>0&&A[0]&&A[0].url&&t.getProperty('/uiFilter/searchTerms')&&A[0].tooltip&&t.getProperty('/uiFilter/searchTerms').toLowerCase().trim()===A[0].tooltip.toLowerCase().trim()){if(A[0].url[0]==='#'){window.location.href=A[0].url;}else{window.open(A[0].url,'_blank');}}}},getResultToDisplay:function(){return this.getProperty('/resultToDisplay');},setResultToDisplay:function(t){this.setProperty('/resultToDisplay',t);S.saveResultViewType(t);},calculateVisibility:function(){var t=this;if(t.isAppCategory()){t.setResultToDisplay("appSearchResult");t.setProperty('/displaySwitchVisibility',false);}else if(t.isAllCategory()||t.isOtherCategory()){t.setResultToDisplay("searchResultList");t.setProperty('/displaySwitchVisibility',false);}else{var r=t.getResultToDisplay();if(!(r==="searchResultList"||r==="searchResultTable")){t.setResultToDisplay("searchResultList");}t.setProperty('/displaySwitchVisibility',true);}},calculateSearchButtonStatus:function(){if(this.getDataSource().equals(this.getProperty('/defaultDataSource'))&&this.getSearchBoxTerm().length===0){this.setProperty('/searchButtonStatus','close');}else{this.setProperty('/searchButtonStatus','search');}},calculateResultList:function(){var t=this;var r=[];var e=t.getProperty('/boResults');if(e&&e.length){r.push.apply(r,e);}var f=t.getProperty('/appResults');if(f&&f.length>0){var h={type:'appcontainer',tiles:f};if(r.length>0){if(r.length>3){r.splice(3,0,h);}else{r.push(h);}}else{r=[h];}}s.ui.model.json.JSONModel.prototype.setProperty.apply(this,['/results',r]);},getDebugInfo:function(){var t=['\n'];if(this.serverInfo){t.push('Search Backend System:');t.push('System:'+this.serverInfo.systemid);t.push('Client:'+this.serverInfo.sapclient);t.push('');}t.push('See also Enterprise Search Setup Documentation:');t.push('http://help.sap.com/saphelp_uiaddon10/helpdata/en/57/7d77c891954c21a19c242694e83177/frameset.htm');return t.join('\n');},getErrors:function(){return this.getProperty('/errors');},cleanErrors:function(){this.setProperty('/errors',jQuery.grep(this.getProperty('/errors'),function(e){return e.keep;}));},pushError:function(e){var t=this;e.title=e.title==="[object Object]"?s.ushell.resources.i18n.getText('searchError'):e.title;var f=this.getProperty('/errors');f.push(e);t.setProperty('/errors',f);},isInaError:function(f){var i;try{i=jQuery.parseJSON(f.responseText);}catch(e){return false;}if(i&&i.Error){return i;}else{return false;}},normalSearchErrorHandling:function(e){var f=["ESH_FED_MSG016"];if(!e){return;}if(e.status===500){jQuery.sap.log.error(e.responseText);this.pushError({type:"error",title:e.statusText,description:e.responseText+this.getDebugInfo(),keep:e.keep});return;}var h=this.isInaError(e);if(h){var j=true;var k='';var l='';if(e.message){k+=e.message+' ';}if(h.Error){if(h.Error.Message){k+=''+h.Error.Message;}if(h.Error.Code){k+=' (Code '+h.Error.Code+').';}}if(h.ErrorDetails){l+='';for(var i=0;i<h.ErrorDetails.length;i++){l+=h.ErrorDetails[i].Message+' (Code '+h.ErrorDetails[i].Code+')';if(f.indexOf(h.ErrorDetails[i].Code)!==-1){j=false;}}}jQuery.sap.log.error(k+' Details: '+l);if(j){this.pushError({type:e.type||"error",title:k,description:l+this.getDebugInfo(),keep:e.keep});}return;}this.pushError({type:"error",title:e.toString(),description:e.toString()+this.getDebugInfo(),keep:e.keep});},createSearchURL:function(){var h="#Action-search";var u=this.getProperty('/uiFilter').getJson();h+="&/searchterm="+encodeURIComponent(u.searchTerms);h+="&datasource="+encodeURIComponent(JSON.stringify(u.dataSource));h+="&top="+this.getTop();h+="&filter="+encodeURIComponent(JSON.stringify(u.defaultConditionGroup));return h;},updateSearchURLSilently:function(){var h=this.createSearchURL();S.hasher.setHash(h);},deserializeURL:function(){if(S.getHashFromUrl().indexOf('#Action-search')!==0){return;}if(!S.hasher.hasChanged()){return;}var P=S.getUrlParameters();if($.isEmptyObject(P)){return;}var u={};if(P.searchterm){u.searchTerms=P.searchterm;}if(P.datasource){u.dataSource=JSON.parse(P.datasource);}else{this.resetDataSource(false);}if(P.top){var t=parseInt(P.top,10);this.setTop(t,false);}this.resetFilterConditions(false);if(P.filter){u.defaultConditionGroup=JSON.parse(P.filter);}this.getProperty("/uiFilter").setJson(u);if(u.dataSource&&u.dataSource.name&&u.dataSource.name==='Apps'){this.setDataSource(this.appDataSource,false);}this.calculateSearchButtonStatus();this._firePerspectiveQuery(true);}});})(window);};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.SearchShellHelper')){(function(){"use strict";var S=sap.ushell.renderers.fiori2.search.controls.SearchFieldGroup;jQuery.sap.declare('sap.ushell.renderers.fiori2.search.SearchShellHelper');var m=sap.ushell.renderers.fiori2.search.SearchShellHelper={};var s=sap.ushell.renderers.fiori2.search.SearchHelper;jQuery.extend(m,{init:function(){var t=this;sap.ushell.Container.getService("Search")._getCatalogTiles();t.oModel=sap.ushell.renderers.fiori2.search.getModelSingleton();t.oShellHeader=sap.ui.getCore().byId('shell-header');t.oSearchFieldGroup=new S("searchFieldInShell");t.oSearchFieldGroup.setModel(t.oModel);t.oShellHeader.setSearch(t.oSearchFieldGroup);t.setSearchState('COL');this.setSearchState=s.delayedExecution(this.setSearchState,300);t.oSearchInput=t.oSearchFieldGroup.input;t.oSearchInput.setValue(t.oModel.getSearchBoxTerm());t.oSearchSelect=t.oSearchFieldGroup.select;var l=new sap.ui.core.InvisibleText("selectLabel",{text:sap.ushell.resources.i18n.getText("searchIn")});if(l){t.oSearchSelect.addAriaLabelledBy("selectLabel");}t.oSearchSelect.setTooltip(sap.ushell.resources.i18n.getText("searchInTooltip"));t.oSearchSelect.addEventDelegate({onAfterRendering:function(e){jQuery('#searchFieldInShell-select-icon').attr('title',sap.ushell.resources.i18n.getText("searchIn"));}},t.oSearchSelect);t.oSearchSelect.setTooltip(sap.ushell.resources.i18n.getText("searchIn"));t.oSearchSelect.attachChange(function(){t.focusInputField();});t.oSearchButton=t.oSearchFieldGroup.button;t.oSearchButton.bindProperty("type",{parts:[{path:'/searchButtonStatus'}],formatter:function(a){if(a==='search'){return sap.m.ButtonType.Emphasized;}else{return sap.m.ButtonType.Default;}}});t.oSearchButton.attachPress(function(){t.handleClickSearchButton();});t.oSearchButton.addEventDelegate({onAfterRendering:function(){var a=jQuery("div.sapUshellShellSearchHidden").length===0;var b=t.oModel.getProperty("/searchButtonStatus")==="close";var $=jQuery(t.oSearchButton.getDomRef());if(a){if(b){$.attr("aria-pressed",true);}else{$.removeAttr("aria-pressed");}}else{$.attr("aria-pressed",false);}}});t.oSearchCancelButton=t.oSearchFieldGroup.cancelButton;t.oSearchCancelButton.attachPress(function(){t.setSearchState('COL');window.setTimeout(function(){sap.ui.getCore().byId('sf').focus();},1000);});this.oSearchFieldGroup.setCancelButtonActive(false);t.registerFocusHandler();jQuery(document).on('keydown',function(e){if(e.keyCode===27){e.preventDefault();if(s.isSearchAppActive()){return;}if(t.oSearchInput){if(t.oSearchInput.getValue()===""){t.setSearchState('COL');}else if(t.oSearchInput.getValue()===" "){t.oSearchInput.setValue("");}}}});sap.ui.getCore().getEventBus().subscribe("allSearchFinished",t.onAllSearchFinished,t);sap.ui.getCore().byId('viewPortContainer').attachAfterNavigate(t.onAfterNavigate,t);sap.ui.getCore().getEventBus().subscribe("sap.ushell","appComponentLoaded",function(){var o=sap.ui.getCore().byId('searchContainerResultsView');if(o&&o.oFocusHandler){o.oFocusHandler.setFocus();}});t.oShellHeader.attachSearchSizeChanged(this.sizeSearchFieldChanged.bind(this));},sizeSearchFieldChanged:function(e){var a=e.mParameters.remSize;var l=20;if(a<=l){this.oSearchSelect.setDisplayMode('icon');}else{this.oSearchSelect.setDisplayMode('default');}l=9;if(a<l){this.oSearchButton.setVisible(false);}else{this.oSearchButton.setVisible(true);}if(e.getParameter('isFullWidth')){this.oSearchFieldGroup.setCancelButtonActive(true);this.oSearchFieldGroup.addStyleClass('sapUshellSearchInputFullWidth');}else{this.oSearchFieldGroup.setCancelButtonActive(false);this.oSearchFieldGroup.removeStyleClass('sapUshellSearchInputFullWidth');}},sizeChanged:function(p){switch(p.name){case"Phone":this.oSearchFieldGroup.setCancelButtonActive(true);break;case"Tablet":this.oSearchFieldGroup.setCancelButtonActive(false);break;case"Desktop":this.oSearchFieldGroup.setCancelButtonActive(false);break;default:break;}},makeDelayed:function(f){return s.delayedExecution(f,0);},registerFocusHandler:function(){var r=true;if(!r){return;}var t=this;var a=t.oSearchInput.getModel();t.oSearchInput.addEventDelegate({onAfterRendering:function(){var i=jQuery(t.oSearchInput.getDomRef()).find('input')[0];var $=jQuery(i);$.on('focus',function(e){t.log('raw_in',document.activeElement);if(!t.isFocusHandlerActive){return;}t.setSearchState('EXP');});$.on('blur',t.makeDelayed(function(e){t.log('raw_out',document.activeElement);if(!t.isFocusHandlerActive){return;}if(t.isInSearchBox(document.activeElement)){return;}if(!s.isSearchAppActive()&&t.oSearchInput.getValue().length===0&&a.getDataSource().equals(a.getDefaultDataSource())){t.setSearchState('COL');}else{t.setSearchState('EXP_S');}}));}});t.oSearchSelect.addEventDelegate({onAfterRendering:function(){var d=t.oSearchSelect.getDomRef();d.addEventListener('focus',function(e){t.log('raw_in_select',document.activeElement);if(!t.isFocusHandlerActive){return;}t.setSearchState.abort();});d.addEventListener('blur',t.makeDelayed(function(e){t.log('raw_out_select',document.activeElement);if(!t.isFocusHandlerActive){return;}if(t.isInSearchBox(document.activeElement)){return;}if(t.oSearchInput.getValue().length===0&&a.getDataSource().equals(a.getDefaultDataSource())){t.setSearchState('COL');}else{t.setSearchState('EXP_S');}}));}});t.oSearchButton.addEventDelegate({onAfterRendering:function(){var d=t.oSearchButton.getDomRef();d.addEventListener('focus',function(e){t.log('raw_in_button',document.activeElement);if(!t.isFocusHandlerActive){return;}t.setSearchState.abort();});d.addEventListener('blur',t.makeDelayed(function(e){t.log('raw_out_button',document.activeElement);if(!t.isFocusHandlerActive){return;}if(t.isInSearchBox(document.activeElement)){return;}if(t.oSearchInput.getValue().length===0&&a.getDataSource().equals(a.getDefaultDataSource())){t.setSearchState('COL');}else{t.setSearchState('EXP_S');}}));}});this.enableFocusHandler(true);},isInSearchBox:function(e){if(!e){return false;}var a=['searchFieldInShell'];var c=['sapMPopoverCont'];while(e){if(e.getAttribute){var b=e.getAttribute('id');if(b){for(var j=0;j<a.length;++j){var d=a[j];if(b.indexOf(d)>=0){return true;}}}for(var i=0;i<c.length;++i){var f=c[i];if(e.classList.contains(f)){return true;}}}e=e.parentNode;}return false;},enableFocusHandler:function(a){this.isFocusHandlerActive=a;if(!a&&this.setSearchState.abort){this.setSearchState.abort();}},setSearchState:function(a,b){if(sap.ui.getCore().byId('searchFieldInShell')===undefined){return;}if(this.oShellHeader.getSearchState()===a){return;}if(a==='COL'){this.enableFocusHandler(false);}else{this.enableFocusHandler(true);}this.log('set search state',a,document.activeElement);switch(a){case'COL':this.oModel.abortSuggestions();this.oShellHeader.setSearchState(a,35);this.oSearchCancelButton.setVisible(false);sap.ui.getCore().byId('sf').setVisible(true);break;case'EXP_S':this.oModel.abortSuggestions();this.oShellHeader.setSearchState(a,35);this.oSearchCancelButton.setVisible(true);sap.ui.getCore().byId('sf').setVisible(false);break;case'EXP':var w=!s.isSearchAppActive()||this.oModel.getProperty("/boCount")>0||this.oModel.getProperty("/appCount")>0;this.oShellHeader.setSearchState(a,35,w);this.oSearchCancelButton.setVisible(true);sap.ui.getCore().byId('sf').setVisible(false);if(!b){this.focusInputField();}break;default:break;}},onShellSearchButtonPressed:function(e){if(sap.ui.getCore().byId('searchFieldInShell')===undefined){this.init();}else if(!s.isSearchAppActive()){this.resetModel();}this.setSearchState('EXP');},handleClickSearchButton:function(){if(this.oSearchInput.getValue()===""&&this.oModel.getDataSource().equals(this.oModel.getDefaultDataSource())){this.setSearchState('COL');window.setTimeout(function(){sap.ui.getCore().byId('sf').focus();},1000);}},focusInputField:function(){var t=this;if(t.focusInputFieldTimeout){window.clearTimeout(t.focusInputFieldTimeout);t.focusInputFieldTimeout=null;}var d=function(r){t.focusInputFieldTimeout=null;var a=t.oSearchInput.getDomRef();if(a&&jQuery(a).is(':visible')&&!sap.ui.getCore().getUIDirty()){t.oSearchInput.focus();return;}if(r>0){t.focusInputFieldTimeout=window.setTimeout(function(){d(--r);},100);}};d(5);},getDefaultOpen:function(){return this.defaultOpen;},setDefaultOpen:function(d){this.defaultOpen=d;},getSearchInput:function(){return this.oSearchFieldGroup.input;},onAfterNavigate:function(e){if(e.getParameter('toId')!=='shellPage-Action-search'&&e.getParameter('toId')!=='applicationShellPage-Action-search'){return;}var o=sap.ui.getCore().byId('searchContainerResultsView');if(o&&o.oFocusHandler){o.oFocusHandler.setFocus();}sap.ui.getCore().getEventBus().publish("searchLayoutChanged");},onAllSearchFinished:function(){this.oSearchInput.setValue(this.oModel.getSearchBoxTerm());this.log('search finished');this.setSearchState('EXP_S');},resetModel:function(){this.oSearchInput.setValue('');this.oModel.resetQuery();},logSwitch:false,log:function(){if(!this.logSwitch){return;}var l=function(e){var c=e.getAttribute('id');if(c){return c;}else{return'unknown_id';}};var a=function(e){var r=[];for(var i=0;i<e.classList.length;++i){r.push(e.classList.item(i));}return r.join(',');};var p=['--'];for(var i=0;i<arguments.length;++i){var b=arguments[i];if(b&&b.getAttribute){p.push(l(b)+','+a(b));continue;}if(b){p.push(b);continue;}p.push('undef');}}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.container.App.controller')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.container.App.controller');jQuery.sap.require('sap.m.MessageToast');var SearchShellHelper=sap.ushell.renderers.fiori2.search.SearchShellHelper;sap.ui.controller("sap.ushell.renderers.fiori2.search.container.App",{onInit:function(){"use strict";this.oShellNavigation=sap.ushell.Container.getService("ShellNavigation");this.oShellNavigation.hashChanger.attachEvent("hashChanged",this.hashChanged);if(SearchShellHelper.oSearchFieldGroup===undefined){SearchShellHelper.init();}SearchShellHelper.setSearchState('EXP_S');if(sap.ui.Device.system.tablet||sap.ui.Device.system.phone){sap.ushell.services.AppConfiguration.setHeaderHiding(false);}},hashChanged:function(e){"use strict";var m=sap.ushell.renderers.fiori2.search.getModelSingleton();m.deserializeURL();},onExit:function(){"use strict";this.oShellNavigation.hashChanger.detachEvent("hashChanged",this.hashChanged);if(SearchShellHelper.getDefaultOpen()!==true){SearchShellHelper.setSearchState('COL');}else{SearchShellHelper.setSearchState('EXP');}if(sap.ui.Device.system.tablet||sap.ui.Device.system.phone){sap.ushell.services.AppConfiguration.setHeaderHiding(true);}if(this.oView.oPage.oFacetDialog){this.oView.oPage.oFacetDialog.destroy();}}});};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.container.App.view')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.container.App.view');(function(g){"use strict";jQuery.sap.require('sap.m.Bar');sap.ui.jsview("sap.ushell.renderers.fiori2.search.container.App",{createContent:function(){var t=this;if(!this.oModel){this.oModel=sap.ushell.renderers.fiori2.search.getModelSingleton();}this.setModel(sap.ushell.resources.i18nModel,"i18n");this.oSearchResults=sap.ui.view({id:"searchContainerResultsView",tooltip:"{i18n>searchResultsView_tooltip}",viewName:"sap.ushell.renderers.fiori2.search.container.Search",type:sap.ui.core.mvc.ViewType.JS});this.oSearchResults.setModel(t.oModel);this.oSearchResults.setAppView(t);var s=new sap.m.Bar({contentLeft:[t.oSearchResults.assembleFilterButton(),t.oSearchResults.assembleDataSourceTapStrips()],contentRight:t.oSearchResults.assembleSearchToolbar()});s.addStyleClass('sapUshellSearchBar');var f=new sap.ushell.renderers.fiori2.search.controls.SearchFilterBar({visible:{parts:[{path:'/facetVisibility'},{path:'/uiFilter/defaultConditionGroup'}],formatter:function(a,b){if(!a&&b&&b.conditions&&b.conditions.length>0){return true;}else{return false;}}}});this.oModel.deserializeURL();this.oPage=this.pageFactory("searchPage",this.oSearchResults,s,f);this.oSearchResults.reorgTabBarSequence();return this.oPage;},beforeExit:function(){},pageFactory:function(i,c,h,s){var t=this;var p=new sap.m.Page({id:i,customHeader:h,subHeader:s,content:[c],enableScrolling:true,showFooter:{parts:['/multiSelectionAvailable','/multiSelectionActions','/errors/length'],formatter:function(m,a,n){return m||n>0;}},showHeader:true,showSubHeader:{parts:[{path:'/facetVisibility'},{path:'/uiFilter/defaultConditionGroup'}],formatter:function(f,a){if(!f&&a&&a.conditions&&a.conditions.length>0){return true;}else{return false;}}}});p.setModel(t.oModel);var e=["onAfterHide","onAfterShow","onBeforeFirstShow","onBeforeHide","onBeforeShow"];var d={};t.createFooter(p);jQuery.each(e,function(I,E){d[E]=jQuery.proxy(function(a){jQuery.each(this.getContent(),function(I,c){c._handleEvent(a);});},p);});p.addEventDelegate(d);if(!sap.ui.Device.system.desktop){p._bUseIScroll=true;}return p;},getControllerName:function(){return"sap.ushell.renderers.fiori2.search.container.App";},createFooter:function(p){var t=this;if(jQuery.device.is.phone){return;}var m=new sap.m.ToggleButton({icon:"sap-icon://multi-select",tooltip:sap.ushell.resources.i18n.getText("toggleSelectionModeBtn"),press:function(){var c=t.oBar.getContent();var i,a;if(this.getPressed()){t.oSearchResults.resultList.enableSelectionMode();t.oModel.setProperty("/multiSelectionEnabled",true);for(i=0;i<c.length;i++){a=c[i];if(a.hasStyleClass("sapUshellSearchResultList-multiSelectionActionButton")){t.oBar.removeContent(a);}}var d=t.oModel.getDataSource();var b=t.oModel.config.getDataSourceConfig(d);var s=new b.searchResultListSelectionHandlerControl();var h=s.actionsForDataSource();t.oModel.setProperty("/multiSelectionActions",h);for(i=0;i<h.length;i++){var k=h[i];var l=new sap.m.Button({text:k.text,press:function(){var r=t.oModel.getProperty("/results");var j=[];for(var i=0;i<r.length;i++){var o=r[i];if(o.selected){j.push(o);}}k.action(j);},visible:{parts:[{path:'/multiSelectionEnabled'}],mode:sap.ui.model.BindingMode.OneWay}});l.setModel(t.oModel);l.addStyleClass("sapUshellSearchResultList-multiSelectionActionButton");t.oBar.insertContent(l,2);}}else{var n=t.oSearchResults.resultList.disableSelectionMode();n.done(function(){t.oModel.setProperty("/multiSelectionEnabled",false);t.oModel.setProperty("/multiSelectionActions",undefined);var r=t.oModel.getProperty("/boResults");if(r){for(var j=0;j<r.length;j++){var o=r[j];o.selected=false;}}for(i=0;i<c.length;i++){a=c[i];if(a.hasStyleClass("sapUshellSearchResultList-multiSelectionActionButton")){t.oBar.removeContent(a);}}});}},visible:{parts:[{path:'/multiSelectionAvailable'}],mode:sap.ui.model.BindingMode.OneWay}});m.setModel(this.oModel);m.addStyleClass("sapUshellSearchResultList-toggleMultiSelectionButton");var e=new sap.m.MessagePopover({placement:"Top"}).setModel(this.oModel);e.bindAggregation("items","/errors",function(i,C){var a=new sap.m.MessagePopoverItem({title:"{title}",description:"{description}"});switch(C.oModel.getProperty(C.sPath).type.toLowerCase()){case"error":a.setType(sap.ui.core.MessageType.Error);break;case"warning":a.setType(sap.ui.core.MessageType.Warning);break;default:a.setType(sap.ui.core.MessageType.Information);}return a;});var E=new sap.m.Button("searchErrorButton",{icon:sap.ui.core.IconPool.getIconURI("alert"),text:{parts:[{path:'/errors/length'}],formatter:function(l){return l;}},visible:{parts:[{path:'/errors/length'}],formatter:function(l){return l>0;},mode:sap.ui.model.BindingMode.OneWay},type:sap.m.ButtonType.Emphasized,tooltip:sap.ushell.resources.i18n.getText('errorBtn'),press:function(){e.openBy(E);}});E.addDelegate({onAfterRendering:function(){if(!t.oModel.getProperty('/isErrorPopovered')){E.firePress();t.oModel.setProperty('/isErrorPopovered',true);}}});E.setLayoutData(new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.NeverOverflow}));m.setLayoutData(new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.NeverOverflow}));var c=[E,new sap.m.ToolbarSpacer(),m];t.oBar=new sap.m.OverflowToolbar({content:c}).addStyleClass("MyBar");var f=p.getFooter();if(f&&f.destroy){f.destroy();}p.setFooter(t.oBar);}});}(window));};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.container.ComponentControl')){(function(){"use strict";jQuery.sap.declare('sap.ushell.renderers.fiori2.search.container.ComponentControl');var m=sap.ushell.renderers.fiori2.search.container.ComponentControl={};jQuery.extend(m,{init:function(){this.oSearchFieldGroup=new sap.ushell.renderers.fiori2.search.controls.SearchFieldGroup("searchFieldGroup");this.oSearchResults=sap.ui.view({id:"searchContainerResultsView",viewName:"sap.ushell.renderers.fiori2.search.container.Search",type:sap.ui.core.mvc.ViewType.JS});this.oSearchBar=new sap.m.Bar({visible:{parts:[{path:'/count'},{path:'/facetVisibility'}],formatter:function(c,f){if(f){return c!==0;}else{return c!==0;}}},contentLeft:[this.oSearchResults.assembleFilterButton(),this.oSearchResults.assembleDataSourceTapStrips()],contentRight:this.oSearchResults.assembleSearchToolbar(true)});this.oSearchBar.addStyleClass('sapUshellSearchBar');this.oFilterBar=new sap.ushell.renderers.fiori2.search.controls.SearchFilterBar({visible:{parts:[{path:'/facetVisibility'},{path:'/uiFilter/defaultConditionGroup'}],formatter:function(f,a){if(!f&&a&&a.conditions&&a.conditions.length>0){return true;}else{return false;}}}});this.oSearchPage=new sap.m.Page({id:'searchPage',customHeader:this.oSearchBar,subHeader:this.oFilterBar,content:[this.oSearchResults],enableScrolling:true,showFooter:false,showHeader:true,showSubHeader:{parts:[{path:'/facetVisibility'},{path:'/uiFilter/defaultConditionGroup'}],formatter:function(f,a){if(!f&&a&&a.conditions&&a.conditions.length>0){return true;}else{return false;}}}});}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.container.Search.controller')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.container.Search.controller');(function(){"use strict";sap.ui.controller("sap.ushell.renderers.fiori2.search.container.Search",{onInit:function(){var t=this;sap.ui.getCore().getEventBus().subscribe("allSearchStarted",t.getView().onAllSearchStarted,t.getView());sap.ui.getCore().getEventBus().subscribe("allSearchFinished",t.getView().onAllSearchFinished,t.getView());},onExit:function(){var t=this;sap.ui.getCore().getEventBus().unsubscribe("allSearchStarted",t.getView().onAllSearchStarted,t.getView());sap.ui.getCore().getEventBus().unsubscribe("allSearchFinished",t.getView().onAllSearchFinished,t.getView());}});}());};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.CustomSearchResultListItem')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.CustomSearchResultListItem');(function(){"use strict";sap.ushell.renderers.fiori2.search.controls.SearchResultListItem.extend("sap.ushell.renderers.fiori2.search.controls.CustomSearchResultListItem",{metadata:{properties:{content:{type:"sap.ushell.renderers.fiori2.search.controls.CustomSearchResultListItemContent"}}},init:function(){sap.ushell.renderers.fiori2.search.controls.SearchResultListItem.prototype.init.apply(this,arguments);},setupCustomContentControl:function(){var c=this.getContent();c.setTitle(this.getTitle());c.setTitleUrl(this.getTitleUrl());c.setType(this.getType());c.setImageUrl(this.getImageUrl());c.setAttributes(this.getAttributes());c.setIntents(this.getIntents());},renderer:function(r,c){c.setupCustomContentControl();sap.ushell.renderers.fiori2.search.controls.SearchResultListItemRenderer.render.apply(this,arguments);},onAfterRendering:function(){sap.ushell.renderers.fiori2.search.controls.SearchResultListItem.prototype.onAfterRendering.apply(this,arguments);this.getContent().getTitleVisibility();}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchNoResultScreen')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchNoResultScreen');(function(){"use strict";var S=sap.ushell.renderers.fiori2.search.SearchShellHelper;var a=sap.ushell.renderers.fiori2.search.SearchConfiguration;sap.ui.core.Control.extend("sap.ushell.renderers.fiori2.search.controls.SearchNoResultScreen",{metadata:{properties:{searchBoxTerm:"string"}},renderer:function(r,c){var s=S.getSearchInput();var b=s.getAriaDescriptionIdForNoResults();var e=$('<div>').text(c.getSearchBoxTerm()).html();r.write('<div class="sapUshellSearch-no-result"');r.writeControlData(c);r.write('>');r.write('<div class="sapUshellSearch-no-result-icon">');r.writeIcon(sap.ui.core.IconPool.getIconURI("travel-request"));r.write('</div><div class="sapUshellSearch-no-result-text" role="alert">');r.write('<div ');if(b){r.write('id="'+b+'" ');}r.write('class="sapUshellSearch-no-result-info">'+sap.ushell.resources.i18n.getText("no_results_info",e));r.write('</div>');c.renderAppFinderLink(r,c);r.write('<div class="sapUshellSearch-no-result-tips">'+sap.ushell.resources.i18n.getText("no_results_tips")+'</div> ');r.write('</div></div>');},renderAppFinderLink:function(r,c){if(!a.getInstance().isLaunchpad()){return;}var m=c.getModel();if(!m.getDataSource().equals(m.appDataSource)){return;}var l=sap.ushell.resources.i18n.getText('no_results_link_appfinder','xxxx');var i=l.indexOf('xxxx');var p=l.slice(0,i);var s=l.slice(i+4);r.write('<div class="sapUshellSearch-no-result-info">');r.write(p);var b=new sap.m.Link({text:sap.ushell.resources.i18n.getText('appFinderTitle'),press:function(){var C=sap.ushell.Container.getService('CrossApplicationNavigation');C.toExternal({target:{shellHash:'#Shell-home&/appFinder/catalog'}});}});r.renderControl(b);r.write(s);r.write('</div>');}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.userpref.SearchPrefsModel')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.userpref.SearchPrefsModel');(function(){"use strict";jQuery.sap.require('sap.ui.model.json.JSONModel');var S=sap.ushell.renderers.fiori2.search.SearchConfiguration;var p='sap.ushell.renderers.fiori2.search.userpref.SearchPrefsModel';sap.ui.model.json.JSONModel.extend(p,{constructor:function(a){var t=this;sap.ui.model.json.JSONModel.prototype.constructor.apply(t,[]);t.config=S.getInstance();t.sina=t.config.getSina();this.reset();},personalizationPolicyOptOut:'Opt-Out',personalizationPolicyOptIn:'Opt-In',personalizationPolicyEnforced:'Enforced',personalizationPolicyDisabled:'Disabled',personalizationPolicies:['Opt-Out','Opt-In','Enforced','Disabled'],isSearchPrefsActive:function(){if(!this.config.searchBusinessObjects||!this.config.enableSearch){return jQuery.when(false);}return this.sina.getSystem().getServerInfo().then(function(s){s=s.rawServerInfo;for(var i=0;i<s.Services.length;++i){var a=s.Services[i];if(a.Service==='PersonalizedSearch'){return jQuery.when(true);}}return jQuery.when(false);},function(){return jQuery.when(false);});},reset:function(){this.initializedDeferred=null;this.setData({searchPrefsActive:false,sessionUserActive:false,personalizationPolicy:'Enforced'});},asyncInit:function(){var t=this;if(t.initializedDeferred){return t.initializedDeferred;}t.initializedDeferred=t.isSearchPrefsActive().then(function(i){t.setProperty('/searchPrefsActive',i);if(!i){return jQuery.when(true);}return t.loadPreferences();});return t.initializedDeferred;},loadPreferences:function(){var t=this;t.searchConfiguration=t.sina.getSearchConfiguration();return t.searchConfiguration.load().then(function(c){var s=c.Data.PersonalizedSearch.SessionUserActive;t.setProperty('/sessionUserActive',s);var a=c.Data.PersonalizedSearch.PersonalizationPolicy;if(t.personalizationPolicies.indexOf(a)<0){a=this.personalizationPolicyDisabled;}t.setProperty('/personalizationPolicy',a);switch(a){case t.personalizationPolicyEnforced:t.setProperty('/explanationText',sap.ushell.resources.i18n.getText('sp.explanationPolicyEnforced'));break;case t.personalizationPolicyDisabled:t.setProperty('/explanationText',sap.ushell.resources.i18n.getText('sp.explanationPolicyDisabled'));break;default:t.setProperty('/explanationText','');}});},savePreferences:function(){var a=this.getProperty('/personalizationPolicy');var s=this.getProperty('/searchPrefsActive');if(!s||a===this.personalizationPolicyEnforced||a===this.personalizationPolicyDisabled){return jQuery.when(true);}var t=this;var d={"SearchConfiguration":{"Action":"Update","Data":{"PersonalizedSearch":{"SessionUserActive":t.getProperty('/sessionUserActive')}}}};return t.searchConfiguration.save(d);},resetProfile:function(){return this.sina.emptyUserHistory();}});})();};if(!jQuery.sap.isDeclared('sap.ushell.services.CrossApplicationNavigation')){(function(){"use strict";jQuery.sap.declare("sap.ushell.services.CrossApplicationNavigation");jQuery.sap.require('jquery.sap.storage');sap.ushell.services.CrossApplicationNavigation=function(c,p,s){var a,S;if(s&&s.config){S=s.config;}function g(t,C){var r,d,e,o,f,h;if(typeof t!=="string"&&!jQuery.isPlainObject(t)&&t!==undefined){jQuery.sap.log.error("Unexpected input type",null,"sap.ushell.services.CrossApplicationNavigation");return undefined;}if(t===undefined){return undefined;}var n;if(C){if(typeof C.getComponentData!=="function"||!jQuery.isPlainObject(C.getComponentData())||!C.getComponentData().startupParameters||!jQuery.isPlainObject(C.getComponentData().startupParameters)){jQuery.sap.log.error("Cannot call getComponentData on component","the component should be an application root component","sap.ushell.services.CrossApplicationNavigation");}else{h=C.getComponentData().startupParameters;if(h.hasOwnProperty("sap-system")){e=h["sap-system"][0];}if(h.hasOwnProperty("sap-ushell-next-navmode")){n=h["sap-ushell-next-navmode"][0];}}}else{r=sap.ushell.Container.getService("NavTargetResolution").getCurrentResolution();if(r&&r["sap-system"]){e=r["sap-system"];}else if(r&&r.url){e=jQuery.sap.getUriParameters(r.url).get("sap-system");}if(r&&r["sap-ushell-next-navmode"]){n=r["sap-ushell-next-navmode"];}else if(r&&r.url){n=jQuery.sap.getUriParameters(r.url).get("sap-ushell-next-navmode");}}if(jQuery.isPlainObject(t)){o=jQuery.extend(true,{},t);if(!e&&!n){return o;}if(o.target&&o.target.shellHash){if(typeof o.target.shellHash==="string"){o.target.shellHash=g(o.target.shellHash,C);}return o;}o.params=o.params||{};if(e&&!Object.prototype.hasOwnProperty.call(o.params,"sap-system")){o.params["sap-system"]=e;}if(n&&!Object.prototype.hasOwnProperty.call(o.params,"sap-ushell-navmode")){o.params["sap-ushell-navmode"]=[n];}return o;}else{f=t;if(!(e||n)){return f;}if(e&&!/[?&]sap-system=/.test(f)){d=(f.indexOf("?")>-1)?"&":"?";f+=d+"sap-system="+e;}if(n&&!/[?&]sap-ushell-navmode=/.test(f)){d=(f.indexOf("?")>-1)?"&":"?";f+=d+"sap-ushell-navmode="+n;}return f;}}function b(t){var d,C,e;if(localStorage&&localStorage["sap-ushell-enc-test"]==="false"){return t;}if(!S||!S["sap-ushell-enc-test"]){if(localStorage&&localStorage["sap-ushell-enc-test"]!=="true"){return t;}}if(typeof t!=="string"&&!jQuery.isPlainObject(t)&&t!==undefined){jQuery.sap.log.error("Unexpected input type",null,"sap.ushell.services.CrossApplicationNavigation");return undefined;}if(t===undefined){return undefined;}if(jQuery.isPlainObject(t)){C=jQuery.extend(true,{},t);if(C.target&&C.target.shellHash){if(typeof C.target.shellHash==="string"){if(C.target.shellHash!=="#"&&C.target.shellHash!==""){C.target.shellHash=b(C.target.shellHash);}}return C;}C.params=C.params||{};C.params["sap-ushell-enc-test"]=["A B%20C"];return C;}else{e=t;if(!/[?&]sap-system=/.test(e)){d=(e.indexOf("?")>-1)?"&":"?";e+=d+"sap-ushell-enc-test="+encodeURIComponent("A B%20C");}return e;}}this.hrefForExternal=function(A,C,d){var o;if(sap.ushell&&sap.ushell.services&&sap.ushell.Container&&typeof sap.ushell.Container.getService==="function"&&sap.ushell.Container.getService("ShellNavigation")){o=g(A,C);o=b(o);return sap.ushell.Container.getService("ShellNavigation").hrefForExternal(o,undefined,C,d);}jQuery.sap.log.debug("Shell not available, no Cross App Navigation");if(d){return(new jQuery.Deferred()).resolve("").promise();}return"";};this.expandCompactHash=function(h){return sap.ushell.Container.getService("NavTargetResolution").expandCompactHash(h);};this.backToPreviousApp=function(){if(this.isInitialNavigation()){this.toExternal({target:{shellHash:"#"},writeHistory:false});return;}this.historyBack();};this.historyBack=function(){window.history.back();};this.isInitialNavigation=function(){var o=sap.ushell&&sap.ushell.Container&&typeof sap.ushell.Container.getService==="function"&&sap.ushell.Container.getService("ShellNavigation");if(!o){jQuery.sap.log.debug("ShellNavigation service not available","This will be treated as the initial navigation","sap.ushell.services.CrossApplicationNavigation");return true;}var i=o.isInitialNavigation();if(typeof i==="undefined"){return true;}return i;};this.toExternal=function(A,C){var o,w=A.writeHistory;if(sap.ushell&&sap.ushell.services&&sap.ushell.Container&&typeof sap.ushell.Container.getService==="function"&&sap.ushell.Container.getService("ShellNavigation")){o=g(A,C);o=b(o);delete o.writeHistory;sap.ushell.Container.getService("ShellNavigation").toExternal(o,C,w);return;}jQuery.sap.log.debug("Shell not avialable, no Cross App Navigation");return;};this.hrefForAppSpecificHash=function(A){if(sap.ushell&&sap.ushell.services&&sap.ushell.Container&&typeof sap.ushell.Container.getService==="function"&&sap.ushell.Container.getService("ShellNavigation")){return sap.ushell.Container.getService("ShellNavigation").hrefForAppSpecificHash(A);}jQuery.sap.log.debug("Shell not available, no Cross App Navigation; fallback to app-specific part only");return"#"+encodeURI(A);};this.getSemanticObjectLinks=function(d,P,i,C,A,e){var m,o,E;m=g({params:P},C).params;m=b({params:m}).params;o=sap.ushell.Container.getService("NavTargetResolution");var v;if(jQuery.isArray(d)){v=[];d.forEach(function(f){v.push([{semanticObject:f[0],params:f[1],ignoreFormFactor:!!f[2],ui5Component:f[3],appStateKey:f[4],compactIntents:!!(f[5])}]);});}else{v={semanticObject:d,params:m,ignoreFormFactor:i,ui5Component:C,appStateKey:A,compactIntents:!!e};}E=sap.ushell.utils.invokeUnfoldingArrayArguments(o.getLinks.bind(o),[v]);return E;};this.getLinks=function(A){var e;e=sap.ushell.utils.invokeUnfoldingArrayArguments(this._getLinks.bind(this),[A]);return e;};this._getLinks=function(n){var N,P,o=sap.ushell.Container.getService("NavTargetResolution");if(typeof n==="undefined"){n={};}N=jQuery.extend(true,{},n);N.compactIntents=!!N.compactIntents;N.action=N.action||undefined;P=g({params:N.params},N.ui5Component).params;P=b({params:P}).params;if(N.appStateKey){P["sap-xapp-state"]=[N.appStateKey];delete N.appStateKey;}N.params=P;return o.getLinks(N);};this.getDistinctSemanticObjects=function(){var o=sap.ushell.Container.getService("NavTargetResolution");return o.getDistinctSemanticObjects();};this.isIntentSupported=function(i,C){var d=new jQuery.Deferred(),o={},e=i.map(function(I){var f=g(I,C);o[f]=I;return f;});sap.ushell.Container.getService("NavTargetResolution").isIntentSupported(e).done(function(I){var m={};Object.keys(I).forEach(function(k){m[o[k]]=I[k];});d.resolve(m);}).fail(d.reject.bind(d));return d.promise();};this.isNavigationSupported=function(i,C){var d=i.map(function(I){return g(I,C);});return sap.ushell.Container.getService("NavTargetResolution").isNavigationSupported(d);};this.isUrlSupported=function(u){var d=new jQuery.Deferred(),U,h;if(typeof u!=="string"){d.reject();return d.promise();}U=sap.ushell.Container.getService("URLParsing");if(U.isIntentUrl(u)){h=U.getHash(u);this.isIntentSupported(["#"+h]).done(function(r){if(r["#"+h]&&r["#"+h].supported){d.resolve();}else{d.reject();}}).fail(function(){d.reject();});}else{d.resolve();}return d.promise();};this.createComponentInstance=function(i,C,o){var d,u,e,f;if(!C){C={};}else{f=Object.keys(C).length;if(f>1||(f===1&&!C.componentData)){throw"`oConfig` argument should either be an empty object or contain only the `componentData` property.";}}if(C.componentData){delete C.componentData.startupParameters;delete C.componentData.config;delete C.componentData["sap-xapp-state"];}d=sap.ushell.Container;u=d.getService("URLParsing");e=u.constructShellHash(u.parseShellHash(i));if(!e){return new jQuery.Deferred(function(D){D.reject("Navigation intent invalid!");}).promise();}return d.getService("NavTargetResolution").resolveHashFragment("#"+e).then(function(r){if(r.applicationType!==sap.ushell.components.container.ApplicationType.URL&&!(/^SAPUI5\.Component=/.test(r.additionalInformation))){return new jQuery.Deferred(function(D){D.reject("The resolved target mapping is not of type UI5 component.");}).promise();}r=jQuery.extend(true,{},r,C);if(!r.ui5ComponentName&&r.additionalInformation){r.ui5ComponentName=r.additionalInformation.replace(/^SAPUI5\.Component=/,"");}return new jQuery.Deferred(function(D){var h=d.getService("Ui5ComponentLoader");if(o){o.runAsOwner(function(){j(r);});}else{j(r);}function j(A){A.loadDefaultDependencies=false;h.createComponent(A).then(function(k){D.resolve(k.componentHandle.getInstance());},function(E){E=E||"";jQuery.sap.log.error("Cannot create UI5 component: "+E,E.stack,"sap.ushell.services.CrossApplicationNavigation");D.reject(E);});}}).promise();});};this.createEmptyAppState=function(A){if(!a){a=sap.ushell.Container.getService("AppState");}if(!(A instanceof sap.ui.core.UIComponent)){throw new Error("oAppComponent passed must be a UI5 Component");}return a.createEmptyAppState(A);};this.getStartupAppState=function(A){this._checkComponent(A);var C=A.getComponentData()&&A.getComponentData()["sap-xapp-state"]&&A.getComponentData()["sap-xapp-state"][0];return this.getAppState(A,C);};this._checkComponent=function(A){if(!(A instanceof sap.ui.core.UIComponent)){throw new Error("oComponent passed must be a UI5 Component");}};this.getAppState=function(A,d){var C,D=new jQuery.Deferred();this._checkComponent(A);if(!a){a=sap.ushell.Container.getService("AppState");}if(typeof d!=="string"){if(d!==undefined){jQuery.sap.log.error("Illegal Argument sAppStateKey ");}setTimeout(function(){C=a.createEmptyUnmodifiableAppState(A);D.resolve(C);},0);return D.promise();}return a.getAppState(d);};this.getAppStateData=function(A){return sap.ushell.utils.invokeUnfoldingArrayArguments(this._getAppStateData.bind(this),[A]);};this._getAppStateData=function(A){var d=new jQuery.Deferred();if(!a){a=sap.ushell.Container.getService("AppState");}if(typeof A!=="string"){if(A!==undefined){jQuery.sap.log.error("Illegal Argument sAppStateKey ");}setTimeout(function(){d.resolve(undefined);},0);}else{a.getAppState(A).done(function(o){d.resolve(o.getData());}).fail(d.resolve.bind(d,undefined));}return d.promise();};this.saveMultipleAppStates=function(A){var r=[],d=new jQuery.Deferred();A.forEach(function(o){r.push(o.save());});jQuery.when.apply(this,r).done(function(){d.resolve(r);}).fail(function(){d.reject("save failed");});return d.promise();};};sap.ushell.services.CrossApplicationNavigation.hasNoAdapter=true;}());};if(!jQuery.sap.isDeclared('sap.ushell.services.SmartNavigation')){(function(s,q){"use strict";var g=(function(){var C=Object.create(null,{"":{value:0|0}});return a;function a(b){var H,i;if(C[b]){return C[b];}H=0|0;i=b.length;while(i--){H=(H<<5)-H+(b.charCodeAt(i)|0);H|=0;}C[b]=H;return H;}})();S.hasNoAdapter=true;q.sap.declare('sap.ushell.services.SmartNavigation');s.ui.define("sap/ushell/services/SmartNavigation",["sap/ushell/services/AppConfiguration","sap/ushell/services/Personalization","sap/ushell/services/URLParsing","sap/ushell/services/CrossApplicationNavigation"],function(a){return new S(a);});s.ushell.services.SmartNavigation=S;function S(a){var A;if(S.instance){return S.instance;}A=Object.create(null);Object.defineProperty(S,"instance",{value:Object.create(null,{getLinks:{value:function(Q){var P,o;var C=s.ushell.Container.getService("CrossApplicationNavigation");var b=s.ushell.Container.getService("Personalization");var i=C.getLinks(Q);var j=a.getCurrentAppliction().sShellHash;if(!j){q.sap.log.warning("Call to SmartNavigation#getLinks() simply "+"delegated to CrossApplicationNavigation#getLinks()"+" because oAppConfiguration#getCurrentAppliction()#sShellHash"+" evaluates to undefined.");return i;}j="#"+j;P=f(j);o=c(P,A,b);return q.when(i,o.getFrequentItems()).then(function(l,F){var u;if(F.length===0){return l;}u=s.ushell.Container.getService("URLParsing");p(l,F,u);return l.sort(function(L,O){return O.clickCount-L.clickCount;});});}},toExternal:{value:function(o){var _=arguments;var D;var T=o.target;var b=function(){var i=s.ushell.Container.getService("CrossApplicationNavigation");return i.toExternal.apply(i,_);};var C=a.getCurrentAppliction().sShellHash;if(!C){q.sap.log.warning("Call to SmartNavigation#toExternal() simply "+"delegated to CrossApplicationNavigation#toExternal()"+" because oAppConfiguration#getCurrentAppliction()#sShellHash"+" evaluates to undefined.");return q.when(b());}C="#"+C;if(T.shellHash){D=h(s.ushell.Container.getService("URLParsing"),T.shellHash);}else{D="#"+T.semanticObject+"-"+T.action;}return t(C,D,A,s.ushell.Container.getService("Personalization")).then(b);}},constructor:{value:S}})});return S.instance;}function t(C,D,a,P){var b=f(C);return c(b,a,P).newItem({appId:D});}function p(l,F,u){m(l,F,u);}function m(l,F,u){var a=Object.create(null);F.forEach(function(A){a[A.appId]=A;});l.forEach(function(L){var b=h(u,L.intent);var o=a[b];L.clickCount=o?o.count:0;});}function c(P,a,o){var b;var A=a[P];if(!A){b=o.getPersonalizer({container:P,item:"data"},{keyCategory:o.constants.keyCategory.FIXED_KEY,writeFrequency:o.constants.writeFrequency.HIGH,clientStorageAllowed:true});A=new R(500,e,d,b.getPersData.bind(b),b.setPersData.bind(b));a[P]=A;}return A;}function e(a,o){return a.appId===o.appId;}function d(a,o){return o.iCount-a.iCount||o.iTimestamp-a.iTimestamp;}function f(a){return"ushell.smartnav."+g(a);}function h(u,i){var T=u.parseShellHash(i);return"#"+T.semanticObject+"-"+T.action;}function R(M,E,C,l,i){var j=30,r;var u=function(o,T){return r.recentUsageArray.some(function(a){if(!E(a.oItem,o)){return false;}q.extend(a.oItem,o);a.iTimestamp=T;a.oItem.timestamp=T;a.aUsageArray[a.aUsageArray.length-1]+=1;a.iCount+=1;a.oItem.count=a.iCount;r.recentUsageArray.sort(C);return true;});};var I=function(o,T){var n={oItem:o,iTimestamp:T,aUsageArray:[1],iCount:1};o.timestamp=T;if(r.recentUsageArray.length===M){r.recentUsageArray.pop();}r.recentUsageArray.unshift(n);};this.newItem=function(o){var D=new q.Deferred();var T=Date.now(),a,b=this,k=this.getDayFromDateObj(new Date());l().done(function(L){r=b.getRecentActivitiesFromLoadedData(L);if(k!==r.recentDay){b.addNewDay();r.recentDay=k;}a=u(o,T);if(!a){I(o,T);}i(r).done(function(n){D.resolve(n);}).fail(function(){D.reject();});});return D.promise();};this.getRecentItemsHelper=function(a){var b=this,D=new q.Deferred(),k=this.getDayFromDateObj(new Date()),n=function(L){var o=[],A=0,v;for(v=0;v<L.recentUsageArray.length&&(!a||A<a);v++){o.push(L.recentUsageArray[v]);A++;}D.resolve(o);};l().done(function(L){r=b.getRecentActivitiesFromLoadedData(L);var o=false;if(k!==r.recentDay){b.addNewDay();r.recentDay=k;o=true;}if(o){i(r).done(function(v){D.resolve(n(r));}).fail(function(){D.reject();});}else{D.resolve(n(r));}});return D.promise();};this.getFrequentItems=function(){var D=new q.Deferred();this.getRecentItemsHelper().done(function(k){var n,w=0,F=[],A,o=k[0]?new Date(k[0].iTimestamp):undefined,v;for(n=0;n<k.length&&w<30;n++){A=k[n];if(A.iCount>0){F.push(A);}v=new Date(A.iTimestamp);if(o.toDateString()!==v.toDateString()){w++;o=v;}}F.sort(function(a,b){return b.iCount-a.iCount;});F=F.slice(0,30);D.resolve(q.map(F,function(a){a.oItem.count=a.iCount;return a.oItem;}));});return D.promise();};this.addNewDay=function(){var a,b;for(a=0;a<r.recentUsageArray.length;a++){b=r.recentUsageArray[a].aUsageArray;if(!b){b=[];r.recentUsageArray[a].aUsageArray=b;r.recentUsageArray[a].iCount=0;}b.push(0);if(b.length>j){r.recentUsageArray[a].iCount-=b[0];b.shift();}}};this.getDayFromDateObj=function(a){return(a.getUTCFullYear()+"/"+(a.getUTCMonth()+1)+"/"+a.getUTCDate());};this.getRecentActivitiesFromLoadedData=function(a){var b;if(q.isArray(a)){b={recentDay:null,recentUsageArray:a};}else{b=a||{recentDay:null,recentUsageArray:[]};}return b;};}})(sap,jQuery);};if(!jQuery.sap.isDeclared('sap.ushell.ui.shell.ShellLayout')){
/*!
 * ${copyright}
 */
jQuery.sap.declare('sap.ushell.ui.shell.ShellLayout');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.core.Control');sap.ui.define("sap/ushell/ui/shell/ShellLayout",['jquery.sap.global','sap/ui/Device','sap/ui/core/Control','sap/ushell/library','./ShellHeader','./SplitContainer','./ToolArea','./RightFloatingContainer','./FloatingContainer','./ShellFloatingActions'],function(q,D,C,S,a,T,b){"use strict";var c=C.extend("sap.ushell.ui.shell.ShellLayout",{metadata:{properties:{headerHiding:{type:"boolean",group:"Appearance",defaultValue:false},headerVisible:{type:"boolean",group:"Appearance",defaultValue:true},toolAreaVisible:{type:"boolean",group:"Appearance",defaultValue:false},floatingContainerVisible:{type:"boolean",group:"Appearance",defaultValue:false},backgroundColorForce:{type:"boolean",group:"Appearance",defaultValue:true},showBrandLine:{type:"boolean",group:"Appearance",defaultValue:true},showAnimation:{type:"boolean",group:"Appearance",defaultValue:true},enableCanvasShapes:{type:"boolean",group:"Appearance",defaultValue:false}},aggregations:{header:{type:"sap.ushell.ui.shell.ShellHeader",multiple:false},toolArea:{type:"sap.ushell.ui.shell.ToolArea",multiple:false},rightFloatingContainer:{type:"sap.ushell.ui.shell.RightFloatingContainer",multiple:false},canvasSplitContainer:{type:"sap.ushell.ui.shell.SplitContainer",multiple:false},floatingActionsContainer:{type:"sap.ushell.ui.shell.ShellFloatingActions",multiple:false}},associations:{floatingContainer:{type:"sap.ushell.ui.shell.FloatingContainer",multiple:false}}}});c._SIDEPANE_WIDTH_PHONE=13;c._SIDEPANE_WIDTH_TABLET=13;c._SIDEPANE_WIDTH_DESKTOP=15;c._HEADER_ALWAYS_VISIBLE=true;c._HEADER_AUTO_CLOSE=true;c._HEADER_TOUCH_TRESHOLD=15;if(D.browser.chrome&&D.browser.version<36){c._HEADER_TOUCH_TRESHOLD=10;}c.prototype.init=function(){this._rtl=sap.ui.getCore().getConfiguration().getRTL();this._showHeader=true;this._iHeaderHidingDelay=3000;this._useStrongBG=false;D.media.attachHandler(this._handleMediaChange,this,D.media.RANGESETS.SAP_STANDARD);};c.prototype.exit=function(){D.media.detachHandler(this._handleMediaChange,this,D.media.RANGESETS.SAP_STANDARD);};c.prototype.onAfterRendering=function(){var t=this;function h(B){var e=q.event.fix(B);if(q.sap.containsOrEquals(t.getDomRef("hdr"),e.target)){t._timedHideHeader(e.type==="focus");}}if(window.addEventListener&&!c._HEADER_ALWAYS_VISIBLE){var H=this.getDomRef("hdr");H.addEventListener("focus",h,true);H.addEventListener("blur",h,true);}this.getCanvasSplitContainer()._applySecondaryContentSize();this._setSidePaneWidth();this.renderFloatingContainer();};c.prototype.renderFloatingContainer=function(){var o=sap.ui.getCore().byId(this.getFloatingContainer()),f=document.getElementById("sapUshellFloatingContainerWrapper"),d=document.getElementsByTagName('body');if(!f){f=document.createElement("DIV");f.setAttribute("id",'sapUshellFloatingContainerWrapper');f.setAttribute("class",'sapUshellShellFloatingContainerWrapper');d[0].appendChild(f);}if(o&&!o.getDomRef()){q('#sapUshellFloatingContainerWrapper').toggleClass("sapUshellShellHidden",true);o.placeAt("sapUshellFloatingContainerWrapper");}};c.prototype.onThemeChanged=function(){this._refreshAfterRendering();};(function(){function _(s){if(s._startY===undefined||s._currY===undefined){return;}var y=s._currY-s._startY;if(Math.abs(y)>c._HEADER_TOUCH_TRESHOLD){s._doShowHeader(y>0);s._startY=s._currY;}}if(D.support.touch){c._HEADER_ALWAYS_VISIBLE=false;c.prototype.ontouchstart=function(e){this._startY=e.touches[0].pageY;if(this._startY>2*48){this._startY=undefined;}this._currY=this._startY;};c.prototype.ontouchend=function(){_(this);this._startY=undefined;this._currY=undefined;};c.prototype.ontouchcancel=c.prototype.ontouchend;c.prototype.ontouchmove=function(e){this._currY=e.touches[0].pageY;_(this);};}})();c.prototype.setHeaderHiding=function(e){e=!!e;return this._modifyAggregationOrProperty(function(r){return this.setProperty("headerHiding",e,r);},function(){this._doShowHeader(!e?true:this._showHeader);});};c.prototype.setHeaderHidingDelay=function(d){this._iHeaderHidingDelay=d;return this;};c.prototype.getHeaderHidingDelay=function(){return this._iHeaderHidingDelay;};c.prototype.setToolAreaVisible=function(v){this.setProperty("toolAreaVisible",!!v,true);this.getToolArea().$().toggleClass("sapUshellShellHidden",!v);this.getCanvasSplitContainer()._applySecondaryContentSize();return this;};c.prototype.setFloatingContainerVisible=function(v){this.setProperty("floatingContainerVisible",!!v,true);if(this.getDomRef()){q('.sapUshellShellFloatingContainerWrapper').toggleClass("sapUshellShellHidden",!v);}return this;};c.prototype.setFloatingContainer=function(o){this.setAssociation('floatingContainer',o,true);};c.prototype.setHeaderVisible=function(h){this.setProperty("headerVisible",!!h,true);this.$().toggleClass("sapUshellShellNoHead",!h);return this;};c.prototype._setStrongBackground=function(u){this._useStrongBG=!!u;this.$("strgbg").toggleClass("sapUiStrongBackgroundColor",this._useStrongBG);};c.prototype._modifyAggregationOrProperty=function(u,d){var r=!!this.getDomRef();var e=u.apply(this,[r]);if(r&&d){if(d instanceof sap.ushell.ui.shell.shell_ContentRenderer){d.render();}else{d.apply(this);}}return e;};c.prototype._doShowHeader=function(s){var w=this._showHeader;this._showHeader=this._isHeaderHidingActive()?!!s:true;this.$().toggleClass("sapUshellShellHeadHidden",!this._showHeader).toggleClass("sapUshellShellHeadVisible",this._showHeader);if(this._showHeader){this._timedHideHeader();}if(w!==this._showHeader&&this._isHeaderHidingActive()){q.sap.delayedCall(500,this,function(){try{var r=document.createEvent("UIEvents");r.initUIEvent("resize",true,false,window,0);window.dispatchEvent(r);}catch(e){q.sap.log.error(e);}});}};c.prototype._timedHideHeader=function(d){if(this._headerHidingTimer){q.sap.clearDelayedCall(this._headerHidingTimer);this._headerHidingTimer=null;}if(d||!c._HEADER_AUTO_CLOSE||!this._isHeaderHidingActive()||this._iHeaderHidingDelay<=0){return;}this._headerHidingTimer=q.sap.delayedCall(this._iHeaderHidingDelay,this,function(){if(this._isHeaderHidingActive()&&this._iHeaderHidingDelay>0&&!q.sap.containsOrEquals(this.getDomRef("hdr"),document.activeElement)){this._doShowHeader(false);}});};c.prototype._isHeaderHidingActive=function(){if(c._HEADER_ALWAYS_VISIBLE||!this.getHeaderHiding()||sap.ushell.ui.shell.shell_iNumberOfOpenedShellOverlays>0||!this.getHeaderVisible()){return false;}return true;};c.prototype._setSidePaneWidth=function(r){var s=this.getCanvasSplitContainer();if(s){if(!r){r=D.media.getCurrentRange(D.media.RANGESETS.SAP_STANDARD).name;}var w=c["_SIDEPANE_WIDTH_"+r.toUpperCase()]+"rem";s.setSecondaryContentSize(w);}};c.prototype._handleMediaChange=function(p){if(!this.getDomRef()){return false;}this._setSidePaneWidth(p.name);this.getCanvasSplitContainer()._applySecondaryContentSize();};c.prototype._refreshAfterRendering=function(){var d=this.getDomRef();if(!d){return false;}this._timedHideHeader();return true;};return c;},true);};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.Shell.view')){jQuery.sap.declare('sap.ushell.renderers.fiori2.Shell.view');
// Copyright (c) 2009-2014 SAP SE, All Rights Reserved
(function(){"use strict";sap.ui.jsview("sap.ushell.renderers.fiori2.Shell",{createContent:function(c){var t=this,v=this.getViewData()||{},C=v.config||{},s=(C.appState==="embedded")?true:false,S=function(i,A){return sap.ui.getCore().byId(A.getObject());},f=new sap.ushell.ui.launchpad.Fiori2LoadingDialog({id:"Fiori2LoadingDialog",text:""}),o=new sap.ushell.ui.shell.ShellHeadItem({id:"configBtn",tooltip:"{i18n>showGrpsBtn_tooltip}",ariaLabel:"{i18n>showGrpsBtn_tooltip}",icon:sap.ui.core.IconPool.getIconURI("menu2"),selected:{path:"/currentState/showPane"},press:[c.togglePane,c]}),b=sap.ui.getCore().getConfiguration().getRTL()?"feeder-arrow":"nav-back",h=new sap.ushell.ui.shell.ShellHeadItem({id:"homeBtn",tooltip:"{i18n>homeBtn_tooltip}",ariaLabel:"{i18n>homeBtn_tooltip}",icon:sap.ui.core.IconPool.getIconURI("home"),target:C.rootIntent?"#"+C.rootIntent:"#"}),B=new sap.ushell.ui.shell.ShellHeadItem({id:"backBtn",tooltip:"{i18n>backBtn_tooltip}",ariaLabel:"{i18n>backBtn_tooltip}",icon:sap.ui.core.IconPool.getIconURI(b),press:c._navBack.bind(c)}),V;B.setShowSeparator(false);h.setShowSeparator(false);h.addEventDelegate({onsapskipback:function(i){if(sap.ushell.renderers.fiori2.AccessKeysHandler.getAppKeysHandler()){i.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusOnShell=false;}},onsapskipforward:function(i){if(sap.ushell.renderers.fiori2.AccessKeysHandler.getAppKeysHandler()){i.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusOnShell=false;}}});o.addEventDelegate({onsapskipforward:function(i){if(sap.ushell.renderers.fiori2.AccessKeysHandler.getAppKeysHandler()){i.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusOnShell=false;}},onfocusin:function(){sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusOnShell=true;sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusPassedToExternalHandlerFirstTime=true;}});this.aDanglingControls=[];var a,d,n,m,e;V=this.initViewPortContainer(c);if(C.enableNotificationsUI===true){n=new sap.ushell.ui.shell.ShellHeadItem({id:"NotificationsCountButton",icon:sap.ui.core.IconPool.getIconURI("ui-notifications"),floatingNumber:{parts:["/notificationsCount"],formatter:function(i){var A=this.getDomRef(),D="";if(A){if(i>0){D=sap.ushell.resources.i18n.getText("NotificationToggleButtonCollapsed",i);}else{D=sap.ushell.resources.i18n.getText("NotificationToggleButtonCollapsedNoNotifications");}A.setAttribute("aria-label",D);}return i;}},visible:"{/enableNotifications}",selected:{path:"/currentViewPortState",formatter:function(i){if(i==='RightCenter'){return true;}return false;}},press:[c.toggleNotificationsView,c],showSeparator:false,tooltip:sap.ushell.resources.i18n.getText("NotificationToggleButtonExpanded")});d=n.onAfterRendering;n.onAfterRendering=function(){if(d){d.apply(this,arguments);}jQuery(this.getDomRef()).attr("aria-pressed",c.bNotificationsSelected);if(this.getDisplayFloatingNumber()>0){jQuery(this.getDomRef()).attr("aria-label",sap.ushell.resources.i18n.getText("NotificationToggleButtonCollapsed",this.getDisplayFloatingNumber()));}else{jQuery(this.getDomRef()).attr("aria-label",sap.ushell.resources.i18n.getText("NotificationToggleButtonCollapsedNoNotifications"));}};n.addEventDelegate({onsapskipforward:function(i){sap.ushell.renderers.fiori2.AccessKeysHandler.bForwardNavigation=true;i.preventDefault();jQuery("#sapUshellHeaderAccessibilityHelper").focus();},onsaptabnext:function(i){sap.ushell.renderers.fiori2.AccessKeysHandler.bForwardNavigation=true;i.preventDefault();jQuery("#sapUshellHeaderAccessibilityHelper").focus();},onsapskipback:function(i){if(sap.ushell.renderers.fiori2.AccessKeysHandler.getAppKeysHandler()){i.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusOnShell=false;}}});this.aDanglingControls.push(n);}m=new sap.ushell.ui.shell.ShellHeadItem({id:"meAreaHeaderButton",tooltip:sap.ushell.Container.getUser().getFullName(),icon:'sap-icon://person-placeholder',selected:{path:"/currentViewPortState",formatter:function(i){if(i==='LeftCenter'){return true;}return false;}},press:[c.toggleMeAreaView,c],visible:true,showSeparator:false,ariaLabel:"{i18n>MeAreaToggleButtonAria}"});e=m.onAfterRendering;m.onAfterRendering=function(){if(e){e.apply(this,arguments);}jQuery(this.getDomRef()).attr("aria-pressed",c.bMeAreaSelected);};m.addEventDelegate({onsapskipforward:function(i){sap.ushell.renderers.fiori2.AccessKeysHandler.bForwardNavigation=true;i.preventDefault();jQuery("#sapUshellHeaderAccessibilityHelper").focus();},onsaptabprevious:function(i){var A=sap.ui.getCore().byId('viewPortContainer'),D=A.getCurrentState(),G;switch(D){case"LeftCenter":G=jQuery("#meAreaIconTabBar-content li:first");if(G.length>0){G[0].focus();}else{if(C.enableRecentActivity){jQuery("#meAreaIconTabBar .sapMITBText")[0].focus();}else{i.preventDefault();jQuery('.sapUshellActionItem:last')[0].focus();}}break;case"RightCenter":break;case"Center":if(sap.ushell.renderers.fiori2.AccessKeysHandler.getAppKeysHandler()){i.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusOnShell=false;}break;}},onsapskipback:function(i){var A=sap.ui.getCore().byId('viewPortContainer'),D=A.getCurrentState(),N;switch(D){case"LeftCenter":i.preventDefault();N=jQuery("#meAreaIconTabBar .sapMITBSelected");if(N.length===0){N=jQuery(".sapUshellActionItem");}N[0].focus();break;case"RightCenter":break;case"Center":if(sap.ushell.renderers.fiori2.AccessKeysHandler.getAppKeysHandler()){i.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusOnShell=false;}break;}}});this.aDanglingControls.push(m);if(C.enablePersonalization!==false){var O=new sap.ushell.ui.launchpad.ActionItem("openCatalogBtn",{text:sap.ushell.resources.i18n.getText("open_appFinderBtn"),icon:'sap-icon://sys-find',actionType:'action',press:function(){jQuery.sap.measure.start("FLP:AppFinderLoadingStartToEnd","AppFinderLoadingStartToEnd","FLP");setTimeout(function(){var i=sap.ushell.Container.getService("CrossApplicationNavigation");i.toExternal({target:{shellHash:"#Shell-home&/appFinder/catalog"}});},!!sap.ui.Device.system.desktop?0:500);},visible:!C.disableAppFinder});if(C.enableHelp){O.addStyleClass('help-id-openCatalogActionItem');}this.aDanglingControls.push(O);}var E=new sap.ushell.ui.shell.ShellHeadItem({id:"endItemsOverflowBtn",tooltip:"{i18n>shellHeaderOverflowBtn_tooltip}",ariaLabel:"{i18n>shellHeaderOverflowBtn_tooltip}",icon:"sap-icon://overflow",press:[c.pressEndItemsOverflow,c],visible:true,showSeparator:false});this.aDanglingControls.push(E);var g=new sap.ushell.ui.shell.SplitContainer({id:'shell-split',showSecondaryContent:{path:"/currentState/showPane"},secondaryContent:{path:"/currentState/paneContent",factory:S},content:V,subHeader:{path:"/currentState/subHeader",factory:S}});var j=new sap.ushell.ui.shell.ToolArea({id:'shell-toolArea',toolAreaItems:{path:"/currentState/toolAreaItems",factory:S}});var r=new sap.ushell.ui.shell.RightFloatingContainer({id:'right-floating-container',top:'6.875',hideItemsAfterPresentation:true,visible:'{/currentState/showRightFloatingContainer}',floatingContainerItems:{path:"/currentState/RightFloatingContainerItems",factory:S}});var k=new sap.ushell.ui.shell.FloatingContainer({id:'shell-floatingContainer',content:{path:"/currentState/floatingContainerContent",factory:S}});var l=new sap.ushell.ui.shell.ShellTitle("shellTitle",{text:{path:"/title"}});var p;var H=function(I,A){var D=A.getProperty("icon");var T=A.getProperty("title");var G=A.getProperty("subtitle");var J=A.getProperty("intent");if(!D){D="sap-icon://circle-task-2";}var L=(new sap.m.StandardListItem({type:sap.m.ListType.Active,title:T,description:G,icon:D,customData:[new sap.ui.core.CustomData({key:"intent",value:J})],press:function(K){var M=K.getSource().getCustomData();if(M&&M.length>0){for(var i=0;i<M.length;i++){if(M[i].getKey()==="intent"){var N=M[i].getValue();if(N&&N[0]==="#"){c.navigateFromShellApplicationNavigationMenu(N);return;}}}}}})).addStyleClass("sapUshellNavigationMenuListItems");return L;};var R=function(i,A){var I=A.getProperty("icon");var T=A.getProperty("title");var D=A.getProperty("subtitle");var G=A.getProperty("intent");if(!D&&!I){I="sap-icon://documents";}return new sap.ushell.ui.shell.NavigationMiniTile({title:T,subtitle:D,icon:I,intent:G,press:function(){var J=this.getIntent();if(J&&J[0]==='#'){c.navigateFromShellApplicationNavigationMenu(J);}}});};var q=new sap.ushell.ui.shell.ShellNavigationMenu("shellNavigationMenu",{title:"{/currentState/application/title}",icon:"{/currentState/application/icon}",showTitle:{path:"/currentState/application/showNavMenuTitle"},items:{path:"/currentState/application/hierarchy",factory:H.bind(this)},miniTiles:{path:"/currentState/application/relatedApps",factory:R.bind(this)}});this.oShellNavigationMenu=q;p=new sap.ushell.ui.shell.ShellAppTitle({id:"shellAppTitle",text:"{/currentState/application/title}",tooltip:sap.ushell.resources.i18n.getText("shellNavMenu_openMenuTooltip"),navigationMenu:q});p.addEventDelegate({onsapskipforward:function(i){if(sap.ushell.renderers.fiori2.AccessKeysHandler.getAppKeysHandler()){i.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusOnShell=false;}}});var F=new sap.ui.model.Filter('','EQ','a'),u,U,w;F.fnTest=c.isHeadEndItemNotInOverflow.bind(c);u=new sap.ushell.ui.shell.ShellHeader({id:'shell-header',showLogo:{path:"/currentState/showLogo"},headItems:{path:"/currentState/headItems",factory:S},headEndItems:{path:"/currentState/headEndItems",factory:S,filters:[F]},title:l,appTitle:p,showSeparators:false});w=new sap.ushell.ui.shell.ShellFloatingActions({id:'shell-floatingActions',floatingActions:{path:"/currentState/floatingActions",factory:S}});U=new sap.ushell.ui.shell.ShellLayout({id:"shell",header:u,toolArea:j,rightFloatingContainer:r,floatingContainerVisible:false,floatingContainer:k,canvasSplitContainer:g,toolAreaVisible:{path:"/currentState/toolAreaVisible"},floatingActionsContainer:w,headerHiding:{path:"/currentState/headerHiding"},headerVisible:{path:"/currentState/headerVisible"},backgroundColorForce:false,showBrandLine:false,showAnimation:false,enableCanvasShapes:C.enableBackGroundShapes===undefined?true:C.enableBackGroundShapes});U._setStrongBackground(true);this.setOUnifiedShell(U);if(a){u.setUser(a);}if(k){var x=k.onAfterRendering;k.onAfterRendering=function(){if(x){x.apply(this,arguments);}var i=sap.ui.getCore().byId("shell"),M=i.getModel();this.setModel(M);}}if(u){var y=u.onAfterRendering;u.onAfterRendering=function(){if(y){y.apply(this,arguments);}if(this.getModel().getProperty("/enableHelp")){jQuery('#actionsBtn').addClass('help-id-actionsBtn');jQuery('#configBtn').addClass('help-id-configBtn');jQuery('#homeBtn').addClass('help-id-homeBtn');}jQuery(".sapUshellHeadTitle").removeAttr("tabindex",0);var i=jQuery("#sapUshellHeaderAccessibilityHelper");i.focusin(function(A){var D=sap.ui.getCore().byId('viewPortContainer'),G=D.getCurrentState(),I;if(sap.ushell.renderers.fiori2.AccessKeysHandler.bForwardNavigation){switch(G){case"Center":var J=sap.ushell.renderers.fiori2.AccessKeysHandler;if(J.getAppKeysHandler()){setTimeout(function(){J.fnExternalKeysHandler(A,J.bFocusPassedToExternalHandlerFirstTime);J.bFocusOnShell=false;},0)}else{var K=jQuery(":focusable").filter("[tabindex!='-1']"),L=K.index(document.activeElement),I=K.eq(L+1);if(!I.length){I=K[0];}}break;case"LeftCenter":I=jQuery("#logoutBtn");if(I.length===0){I=jQuery("#userStatusOpener");}break;case"RightCenter":I=jQuery("#sapUshellNotificationIconTabByDate");sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusOnShell=false;break;}}else{var M=sap.ui.getCore().byId("shell-header"),N=M.getHeadEndItems(),P=N[N.length-1];I=P;}setTimeout(function(){if(I){I.focus();}},0);});};}this.oShellPage=this.pageFactory("shellPage",U,true);if(s){u.setLogo(sap.ui.resource('sap.ui.core','themes/base/img/1x1.gif'));}else{this.initShellBarLogo(u);}this.setDisplayBlock(true);this.aDanglingControls=this.aDanglingControls.concat([sap.ui.getCore().byId('shell-floatingContainer'),sap.ui.getCore().byId('viewPortContainer'),this.oShellPage,f,h,B,o]);U.updateAggregation=this.updateShellAggregation;u.updateAggregation=this.updateShellAggregation;j.updateAggregation=this.updateShellAggregation;r.updateAggregation=this.updateShellAggregation;w.updateAggregation=this.updateShellAggregation;g.updateAggregation=this.updateShellAggregation;var z=(C.enableSearch!==false);if(z){t.oShellSearchBtn=new sap.ushell.ui.shell.ShellHeadItem({id:"sf",tooltip:"{i18n>searchbox_tooltip}",text:"{i18n>searchBtn}",ariaLabel:"{i18n>searchbox_tooltip}",icon:sap.ui.core.IconPool.getIconURI("search"),visible:true,showSeparator:false,press:function(i){if(!t.searchShellHelper){jQuery.sap.require('sap.ushell.renderers.fiori2.search.SearchShellHelper');t.searchShellHelper=sap.ushell.renderers.fiori2.search.SearchShellHelper;}t.searchShellHelper.onShellSearchButtonPressed(i);}});if(C.openSearchAsDefault){if(!t.searchShellHelper){jQuery.sap.require('sap.ushell.renderers.fiori2.search.SearchShellHelper');t.searchShellHelper=sap.ushell.renderers.fiori2.search.SearchShellHelper;t.searchShellHelper.init();}t.searchShellHelper.setDefaultOpen(true);t.searchShellHelper.openSearch(false,false);}t.oShellSearchBtn.addEventDelegate({onsapskipforward:function(i){i.preventDefault();jQuery("#sapUshellHeaderAccessibilityHelper").focus();},onsapskipback:function(i){i.preventDefault();jQuery("#sapUshellHeaderAccessibilityHelper").focus();},onAfterRendering:function(){jQuery("#sf").attr("aria-pressed",false);}});t.aDanglingControls.push(t.oShellSearchBtn);}this.logonIFrameReference=null;return new sap.m.App({pages:this.oShellPage});},getOUnifiedShell:function(){return this.oUnifiedShell;},setOUnifiedShell:function(u){this.oUnifiedShell=u;},loadUserImage:function(){var u=sap.ushell.Container.getUser(),i=u.getImage();if(i){this._setUserImage(i);}u.attachOnSetImage(this._setUserImage);},_setUserImage:function(p){var u=(typeof p)==='string'?p:p.mParameters,a=sap.ui.getCore().byId('actionsBtn'),m=sap.ui.getCore().byId('meAreaHeaderButton'),h={'Cache-Control':'no-cache, no-store, must-revalidate','Pragma':'no-cache','Expires':'0'};jQuery.ajax({url:u,headers:h,success:function(){if(a){a.setImage(u);}if(m){m.setIcon(u);}},error:function(){jQuery.sap.log.error("Could not load user image from: "+u,"","sap.ushell.renderers.fiori2.Shell.view");}});},_getIconURI:function(i){var r=null;if(i){var m=/url[\s]*\('?"?([^\'")]*)'?"?\)/.exec(i);if(m){r=m[1];}}return r;},initShellBarLogo:function(s){var m=jQuery.sap.getModulePath("sap.ushell");jQuery.sap.require("sap.ui.core.theming.Parameters");var i=sap.ui.core.theming.Parameters.get("sapUiGlobalLogo");if(i){i=this._getIconURI(i);if(!i){s.setLogo(m+'/themes/base/img/sap_55x27.png');}}var t=this;sap.ui.getCore().attachThemeChanged(function(){if(s.bIsDestroyed){return;}var n=sap.ui.core.theming.Parameters.get("sapUiGlobalLogo");if(n){n=t._getIconURI(n);if(n){s.setLogo(n);}else{s.setLogo(m+'/themes/base/img/sap_55x27.png');}}else{s.setLogo(m+'/themes/base/img/sap_55x27.png');}});},initViewPortContainer:function(c){var v=new sap.ushell.ui.launchpad.ViewPortContainer({id:"viewPortContainer",defaultState:sap.ushell.ui.launchpad.ViewPortState.Center,afterNavigate:jQuery.proxy(c.onAfterNavigate,c),afterSwitchState:jQuery.proxy(c.onAfterViewPortSwitchState,c)});return v;},updateShellAggregation:function(n){var b=this.mBindingInfos[n],a=this.getMetadata().getJSONKeys()[n],c;jQuery.each(this[a._sGetter](),jQuery.proxy(function(i,v){this[a._sRemoveMutator](v);},this));jQuery.each(b.binding.getContexts(),jQuery.proxy(function(i,v){c=b.factory(this.getId()+"-"+i,v)?b.factory(this.getId()+"-"+i,v).setBindingContext(v,b.model):"";this[a._sMutator](c);},this));},disableBouncing:function(p){p.onBeforeRendering=function(){sap.m.Page.prototype.onBeforeRendering.apply(p);var s=this._oScroller,o=s.onAfterRendering;s.onAfterRendering=function(){o.apply(s);if(s._scroller){s._scroller.options.bounce=false;}};};return p;},getControllerName:function(){return"sap.ushell.renderers.fiori2.Shell";},pageFactory:function(i,c,d){var p=new sap.m.Page({id:i,showHeader:false,content:c,enableScrolling:!!sap.ui.Device.system.desktop}),e=["onAfterHide","onAfterShow","onBeforeFirstShow","onBeforeHide","onBeforeShow"],D={};jQuery.each(e,function(I,E){D[E]=jQuery.proxy(function(a){jQuery.each(this.getContent(),function(I,c){c._handleEvent(a);});},p);});p.addEventDelegate(D);if(d&&sap.ui.Device.system.desktop){this.disableBouncing(p);}return p;},createIFrameDialog:function(){var d=null,l=this.logonIFrameReference,c;var _=function(){if(l){l.remove();}return jQuery('<iframe id="SAMLDialogFrame" src="" frameborder="0" height="100%" width="100%"></iframe>');};var a=function(){d.addStyleClass('sapUshellSamlDialogHidden');jQuery('#sap-ui-blocklayer-popup').addClass('sapUshellSamlDialogHidden');};this.destroyIFrameDialog();var b=new sap.m.Button({text:sap.ushell.resources.i18n.getText("samlCloseBtn"),press:function(){sap.ushell.Container.cancelLogon();}});var h=new sap.ui.core.HTML("SAMLDialogFrame");this.logonIFrameReference=_();h.setContent(this.logonIFrameReference.prop('outerHTML'));d=new sap.m.Dialog({id:"SAMLDialog",title:sap.ushell.resources.i18n.getText("samlDialogTitle"),contentWidth:"50%",contentHeight:"50%",rightButton:b}).addStyleClass("sapUshellIframeDialog");c=sap.ushell.Container.getService("SupportTicket").isEnabled();if(c){jQuery.sap.require("sap.ushell.ui.footerbar.ContactSupportButton");var C=new sap.ushell.ui.footerbar.ContactSupportButton();C.setWidth('150px');C.setIcon('');d.setLeftButton(C);}d.addContent(h);d.open();a();this.logonIFrameReference=jQuery('#SAMLDialogFrame');return this.logonIFrameReference[0];},destroyIFrameDialog:function(){var d=sap.ui.getCore().byId('SAMLDialog');if(d){d.destroy();}this.logonIFrameReference=null;},showIFrameDialog:function(){var d=sap.ui.getCore().byId('SAMLDialog');if(d){d.removeStyleClass('sapUshellSamlDialogHidden');jQuery('#sap-ui-blocklayer-popup').removeClass('sapUshellSamlDialogHidden');}}});}());};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.SearchFacetDialogModel')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.SearchFacetDialogModel');(function(g){"use strict";sap.ushell.renderers.fiori2.search.SearchModel.extend("sap.ushell.renderers.fiori2.search.SearchFacetDialogModel",{constructor:function(){var t=this;sap.ushell.renderers.fiori2.search.SearchModel.prototype.constructor.apply(t,[]);t.aAllowedAccessUsage=["AutoFacet"];t.facetQuery=t.sina.createPerspectiveQuery({templateFactsheet:true});t.chartQuery=t.sina.createChartQuery();t.aFilters=[];},prepareFacetList:function(){var t=this;var m=t.getDataSource().getMetaDataSync();t.setProperty('/facetDialog',t.oFacetFormatter.getDialogFacetsFromMetaData(m,t));},facetDialogSingleCall:function(p){var t=this;t.chartQuery.setDataSource(t.getDataSource());t.chartQuery.setSkip(0);t.chartQuery.setTop(1);t.chartQuery.dimensions=[];t.chartQuery.addDimension(p.sAttribute);t.chartQuery.setAttributeLimit(p.sAttributeLimit);if(t.getProperty("/fuzzy")){t.chartQuery.addOption(g.sinabase.QueryOptions.FUZZY);}else{t.chartQuery.removeOption(g.sinabase.QueryOptions.FUZZY);}return t.chartQuery.getResultSet().then(function(r){var f=t.oFacetFormatter.getDialogFacetsFromChartQuery(r,t);var F=jQuery.extend(true,{},f);f.items4pie=F.items;var a=0,b=0,c=0,d=0;for(var i=0;i<f.items4pie.length;i++){if(i<9){f.items4pie[i].pieReady=true;if(f.items4pie[i].value>0){a+=f.items4pie[i].value;}}else{f.items4pie[i].pieReady=false;if(f.items4pie[i].value>0){b+=f.items4pie[i].value;}}}c=b*100/(a+b);c=Math.ceil(c);d=a/9;d=Math.floor(d);if(c>0){var n=f.items4pie[0].clone([true,true]);n.value=d;n.label=sap.ushell.resources.i18n.getText("facetPieChartOverflowText2",[c,9]);n.pieReady=true;n.valueLabel=""+d;n.isPieChartDummy=true;f.items4pie.push(n);}for(var j=0;j<f.items4pie.length;j++){f.items4pie[j].percentageMissingInBigPie=c;}t.setProperty(p.sBindingPath+"/items4pie",f.items4pie);t.setProperty(p.sBindingPath+"/items",f.items);});},resetFacetQueryFilterConditions:function(){var t=this;t.facetQuery.resetFilterConditions();},resetChartQueryFilterConditions:function(){var t=this;t.chartQuery.resetFilterConditions();},hasFilterCondition:function(f){var t=this;for(var i=0;i<t.aFilters.length;i++){if(t.aFilters[i].filterCondition.equals&&t.aFilters[i].filterCondition.equals(f)){return true;}}return false;},hasFilter:function(i){var t=this;var f=i.filterCondition;return t.hasFilterCondition(f);},addFilter:function(i){var t=this;if(!t.hasFilter(i)){t.aFilters.push(i);}},removeFilter:function(a){var t=this;var f=a.filterCondition;for(var i=0;i<t.aFilters.length;i++){if(t.aFilters[i].filterCondition.equals&&t.aFilters[i].filterCondition.equals(f)){t.aFilters.splice(i,1);return;}}},changeFilterAdvaced:function(a,A){var t=this;var f=a.filterCondition;for(var i=0;i<t.aFilters.length;i++){if(t.aFilters[i].filterCondition.equals&&t.aFilters[i].filterCondition.equals(f)){t.aFilters[i].advanced=A;return;}}},getAttributeDataType:function(d){switch(d){case"Double":return"number";case"Timestamp":return"date";case"String":return"string";case"Text":return"text";default:return"string";}}});})(window);};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.controls.SearchFacetFilter')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.controls.SearchFacetFilter');(function(){"use strict";sap.ushell.renderers.fiori2.search.controls.SearchFacetTabBar.extend('my.IconTabBar',{renderer:'sap.ushell.renderers.fiori2.search.controls.SearchFacetTabBarRenderer',setEshRole:function(){var a=this.getItems();for(var i=0;i<a.length;++i){var b=a[i];var f=b.getContent()[0];f.setEshRole.apply(f,arguments);}},getEshRole:function(){var i=this.getItems();var a=i[0];var f=a.getContent()[0];return f.getEshRole.apply(f,arguments);},attachSelectionChange:function(){}});sap.ui.core.Control.extend('sap.ushell.renderers.fiori2.search.controls.SearchFacetFilter',{metadata:{properties:{title:"string"},aggregations:{"facets":{multiple:true}}},init:function(){this.data("sap-ui-fastnavgroup","true",true);},constructor:function(o){var t=this;o=jQuery.extend({},{},o);sap.ui.core.Control.prototype.constructor.apply(this,[o]);this.bindAggregation('facets','/facets',function(){if(t.getModel().config.charts){if(arguments[1].sPath!=="/facets/0"){var b={};b.id='barChart'+arguments[0];var i=new my.IconTabBar({items:[new sap.m.IconTabFilter({text:sap.ushell.resources.i18n.getText("facetList"),icon:"sap-icon://list",key:'list'+arguments[0],content:new sap.ushell.renderers.fiori2.search.controls.SearchFacet('list'+arguments[0])}),new sap.m.IconTabFilter({text:sap.ushell.resources.i18n.getText("facetBarChart"),icon:"sap-icon://horizontal-bar-chart",key:'barChart'+arguments[0],content:new sap.ushell.renderers.fiori2.search.controls.SearchFacetBarChart(b)}),new sap.m.IconTabFilter({text:sap.ushell.resources.i18n.getText("facetPieChart"),icon:"sap-icon://pie-chart",key:'pieChart'+arguments[0],content:new sap.ushell.renderers.fiori2.search.controls.SearchFacetPieChart('pieChart'+arguments[0])})]});i.addStyleClass("sapUshellSearchFacetIconTabBar");return i;}else{return new sap.ushell.renderers.fiori2.search.controls.SearchFacet(arguments[0]);}}else{return new sap.ushell.renderers.fiori2.search.controls.SearchFacet(arguments[0]);}});},fireReset:function(){this.getModel().resetFilterConditions(false);this.getModel().setDataSource(this.getModel().allDataSource,true);},renderer:function(r,c){function a(d){return function(e){var f=sap.ui.getCore().byId($($(this.getDomRef()).closest(".sapUshellSearchFacet")[0]).attr("id"));var F=new sap.ushell.renderers.fiori2.search.SearchFacetDialogModel();F.setData(c.getModel().getData());F.prepareFacetList();var d=null;if(f&&f.getBindingContext()&&f.getBindingContext().getObject()&&f.getBindingContext().getObject().dimension){d=f.getBindingContext().getObject().dimension;}var D=new sap.ushell.renderers.fiori2.search.controls.SearchFacetDialog({selectedAttribute:d});D.setModel(F);D.setModel(c.getModel(),'searchModel');D.open();var p=c.getParent().getParent().getParent().getParent();p.oFacetDialog=D;};}r.write("<div");r.writeControlData(c);r.addClass("sapUshellSearchFacetFilter");r.writeClasses();r.write('>');for(var i=0,l=c.getFacets().length;i<l;i++){var f=c.getFacets()[i];if(i===0){f.setEshRole("datasource");}else{f.setEshRole("attribute");f.attachSelectionChange(null,function(){jQuery(c.showAllBtn.getDomRef()).hide();});if(i===1){f.setHeaderText(sap.ushell.resources.i18n.getText("filterBy"));}var s=new sap.m.Link({text:"{i18n>showMore}",press:a(),visible:{parts:[{path:'/uiFilter/dataSource'}],formatter:function(d){return d.getType().toLowerCase()!=="category";}}});s.setModel(c.getModel());if(!c.getModel().config.charts){var b=new sap.m.CustomListItem({content:s});b.addStyleClass('sapUshellSearchFacetShowMoreLink');b.addEventDelegate({onAfterRendering:function(e){var d=jQuery(jQuery(e.srcControl.getDomRef()).find(".sapMLIBSelectM:first"));d.remove();}});f.addItem(b);}}r.renderControl(f);}if(c.getFacets().length>1||c.getModel().getDataSource().type==='BusinessObject'){r.write("<div>");c.showAllBtn=new sap.m.Button({text:"{showAllFilters}",press:a(),visible:false});c.showAllBtn.setModel(c.getModel("i18n"));c.showAllBtn.addStyleClass("sapUshellSearchFacetFilterShowAllFilterBtn");r.renderControl(c.showAllBtn);r.write("</div>");}r.write("</div>");},onAfterRendering:function(){if(this.getModel().getProperty('/count')>0){if((this.showAllBtn&&this.getFacets().length>1)&&!this.getModel().isOtherCategory()&&!this.getModel().isAllCategory()&&!this.getModel().isAppCategory()){this.showAllBtn.setVisible(true);this.showAllBtn.rerender();}}var a=$('.searchFacetFilter .searchFacet').first().find('ul');var b=a.find('li');a.attr('role','tree');b.attr('role','treeitem');}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.userpref.SearchPrefs')){(function(){"use strict";var S=sap.ushell.renderers.fiori2.search.userpref.SearchPrefsModel;jQuery.sap.declare('sap.ushell.renderers.fiori2.search.userpref.SearchPrefs');var m=sap.ushell.renderers.fiori2.search.userpref.SearchPrefs={};jQuery.extend(m,{model:new S(),getEntry:function(){var t=this;return{title:sap.ushell.resources.i18n.getText('sp.userProfiling'),editable:true,isSearchPrefsActive:t.model.isSearchPrefsActive.bind(t.model),value:function(){t.model.reset();return t.model.asyncInit().then(function(){return t.model.getProperty('/sessionUserActive')?sap.ushell.resources.i18n.getText('sp.on'):sap.ushell.resources.i18n.getText('sp.off');});},onSave:function(){return t.model.savePreferences();},onCancel:function(){},content:function(){return t.model.asyncInit().then(function(){var u=sap.ui.view({id:'searchPrefsView',type:sap.ui.core.mvc.ViewType.JS,viewName:'sap.ushell.renderers.fiori2.search.userpref.SearchPrefsDialog'});u.setModel(t.model);return u;});}};}});})();};if(!jQuery.sap.isDeclared('sap.ushell.renderers.fiori2.search.container.Search.view')){jQuery.sap.declare('sap.ushell.renderers.fiori2.search.container.Search.view');(function(g){"use strict";jQuery.sap.require('sap.m.BusyDialog');jQuery.sap.require('sap.m.TablePersoController');jQuery.sap.require('sap.ui.vbm.AnalyticMap');jQuery.sap.require('sap.ui.vbm.Spot');var S=sap.ushell.renderers.fiori2.search.controls.SearchLayout;var a=sap.ushell.renderers.fiori2.search.controls.SearchResultListContainer;var b=sap.ushell.renderers.fiori2.search.controls.SearchResultList;var c=sap.ushell.renderers.fiori2.search.controls.SearchResultTable;var d=sap.ushell.renderers.fiori2.search.controls.SearchNoResultScreen;var s=sap.ushell.renderers.fiori2.search.SearchHelper;var f=sap.ushell.renderers.fiori2.search.controls.SearchLabel;var h=sap.ushell.renderers.fiori2.search.controls.SearchLink;var j=sap.ushell.renderers.fiori2.search.SearchLogger;var k=sap.ushell.renderers.fiori2.search.controls.SearchResultListItem;var C=sap.ushell.renderers.fiori2.search.controls.CustomSearchResultListItem;sap.ui.jsview("sap.ushell.renderers.fiori2.search.container.Search",{createContent:function(o){var t=this;t.centerArea=t.assembleCenterArea();var e=new sap.m.MessageStrip({text:sap.ushell.resources.i18n.getText('did_you_mean','{/queryFilter/searchTerms}'),showIcon:true,class:'sapUiMediumMarginBottom',visible:{parts:[{path:'/fuzzy'},{path:'/boCount'}],formatter:function(i,l){if(i===true&&l>0){return true;}else{return false;}}}});var r=new a({centerAreaHeader:null,centerArea:t.centerArea,didYouMeanBar:e,totalCountBar:t.assembleCountLabel(),noResultScreen:new d({searchBoxTerm:{parts:[{path:'/queryFilter/searchTerms'}],formatter:function(i){return i;}},visible:{parts:[{path:'/count'},{path:'/isBusy'}],formatter:function(i,l){return i===0&&!l;}}})});t.searchLayout=new S({resultListContainer:r,busyIndicator:new sap.m.BusyDialog(),isBusy:'{/isBusy}',showFacets:{parts:[{path:'/count'},{path:'/facetVisibility'},{path:'/uiFilter/defaultConditionGroup'}],formatter:function(i,l,m){if(!l){return false;}var n=m&&m.conditions&&m.conditions.length>0;if(i===0&&!n){return false;}return true;}},vertical:false,facets:new sap.ushell.renderers.fiori2.search.controls.SearchFacetFilter()});t.searchLayout.addStyleClass('sapUshellSearchLayout');t.searchContainer=new sap.ushell.renderers.fiori2.search.controls.DivContainer({content:[t.searchLayout],cssClass:'sapUshellSearchContainer'});t.oFocusHandler=new s.SearchFocusHandler(t);return t.searchContainer;},assembleFilterButton:function(){var t=this;var e=new sap.m.ToggleButton({icon:sap.ui.core.IconPool.getIconURI("filter"),tooltip:{parts:[{path:'/facetVisibility'}],formatter:function(i){return i?sap.ushell.resources.i18n.getText("hideFacetBtn_tooltip"):sap.ushell.resources.i18n.getText("showFacetBtn_tooltip");}},pressed:'{/facetVisibility}',press:function(){if(this.getPressed()){t.getModel().setFacetVisibility(true);}else{t.getModel().setFacetVisibility(false);}},visible:{parts:[{path:'/businessObjSearchEnabled'},{path:'/count'}],formatter:function(i,l){if(l===0){return false;}return!sap.ui.Device.system.phone&&i;}}});e.addStyleClass('searchBarFilterButton');return e;},searchToolbarEntryVisibility:{parts:[{path:'/count'}],formatter:function(e){return e!==0&&!sap.ui.Device.system.phone;}},assembleCountLabel:function(){var l=new sap.m.Label({visible:{parts:[{path:'/count'}],formatter:function(e){return e!==0;}},text:{parts:[{path:'/count'}],formatter:function(e){if(typeof e!=='number'){return"";}var i=s.formatInteger(e);return sap.ushell.resources.i18n.getText("results")+' ('+i+')';}}});l.addStyleClass('sapUshellSearchTotalCountSelenium');return l;},assembleSearchToolbar:function(w){var t=this;var e=t.assembleDisplaySwitchTapStrips();var i=new sap.m.Button({icon:"sap-icon://sort",tooltip:"{i18n>sortTable}",type:sap.m.ButtonType.Transparent,enabled:{parts:[{path:'/displaySwitchVisibility'},{path:'/count'},{path:'/tableSortableColumns'}],formatter:function(n,o,p){return n&&o!==0&&p.length>1;}},press:function(n){t.tableSortDialog.open();},visible:jQuery.extend({},this.searchToolbarEntryVisibility)});var l=new sap.m.Button("tablePersonalizeButton",{icon:"sap-icon://action-settings",tooltip:"{i18n>personalizeTable}",type:sap.m.ButtonType.Transparent,enabled:{parts:[{path:'/resultToDisplay'}],formatter:function(r){return r==="searchResultTable";}},press:function(n){t.oTablePersoController.openDialog();},visible:jQuery.extend({},this.searchToolbarEntryVisibility)});if(!w){var m=this.assembleShareButton();return[e,i,l,m];}else{return[e,i,l];}},assembleShareButton:function(){var t=this;var B=new sap.ushell.ui.footerbar.AddBookmarkButton({beforePressHandler:function(){var i={url:document.URL,title:t.getModel().getDocumentTitle(),icon:sap.ui.core.IconPool.getIconURI("search")};B.setAppData(i);}});B.setWidth('auto');var e=new sap.m.Button();e.setIcon("sap-icon://email");e.setText(sap.ushell.resources.i18n.getText("eMailFld"));e.attachPress(function(){sap.m.URLHelper.triggerEmail(null,t.getModel().getDocumentTitle(),document.URL);});e.setWidth('auto');var A=new sap.m.ActionSheet({placement:'Bottom',buttons:[B,e]});var o=new sap.m.Button({icon:'sap-icon://action',tooltip:sap.ushell.resources.i18n.getText('shareBtn'),press:function(){A.openBy(o);}});return o;},assembleDataSourceTapStrips:function(){var t=this;var e=new sap.m.OverflowToolbar({design:sap.m.ToolbarDesign.Transparent,visible:{parts:[{path:'/facetVisibility'},{path:'/count'},{path:'/businessObjSearchEnabled'}],formatter:function(i,m,n){return!i&&m>0&&n;}}});e.data("sap-ui-fastnavgroup","false",true);e.addStyleClass('searchTabStrips');t.tabBar=e;var l=new sap.ui.core.InvisibleText({text:"Data Sources"}).toStatic();e.addDependent(l);e.addAriaLabelledBy(l);e.bindAggregation('content','/tabStrips/strips',function(I,o){var m=new sap.m.ToggleButton({text:'{labelPlural}',type:{parts:[{path:'/tabStrips/selected'}],formatter:function(i){var p=this.getBindingContext().getObject();if(p.equals(i)===true){return sap.m.ButtonType.Transparent;}else{return sap.m.ButtonType.Transparent;}}},pressed:{parts:[{path:'/tabStrips/selected'}],formatter:function(i){var p=this.getBindingContext().getObject();return p.equals(i);}},press:function(p){this.setType(sap.m.ButtonType.Transparent);if(this.getBindingContext().getObject().equals(t.getModel().getProperty('/tabStrips/selected'))){this.setPressed(true);return;}var B=t.tabBar.getContent();for(var i=0;i<B.length;i++){if(B[i].getId()!==this.getId()){B[i].setType(sap.m.ButtonType.Transparent);if(B[i].getPressed()===true){B[i].setPressed(false);}}}t.getModel().setDataSource(this.getBindingContext().getObject());}});var n=new sap.ui.core.InvisibleText({text:o.getProperty("labelPlural")+", "+sap.ushell.resources.i18n.getText("dataSource")}).toStatic();m.addAriaLabelledBy(n);m.addDependent(n);return m;});e._setupItemNavigation=function(){if(!this.theItemNavigation){this.theItemNavigation=new sap.ui.core.delegate.ItemNavigation();this.addDelegate(this.theItemNavigation);}this.theItemNavigation.setCycling(false);this.theItemNavigation.setRootDomRef(this.getDomRef());var m=[];var n=this.getContent();for(var i=0;i<n.length;i++){if(!$(n[i].getDomRef()).attr("tabindex")){var o="-1";if(n[i].getPressed&&n[i].getPressed()){o="0";}$(n[i].getDomRef()).attr("tabindex",o);}m.push(n[i].getDomRef());}var p=this.getAggregation("_overflowButton");if(p&&p.getDomRef){var _=p.getDomRef();m.push(_);$(_).attr("tabindex","-1");}this.theItemNavigation.setItemDomRefs(m);};e.addEventDelegate({onAfterRendering:function(E){var t=this;t.getAggregation("_overflowButton").addEventDelegate({onAfterRendering:function(E){t._setupItemNavigation();}},t.getAggregation("_overflowButton"));t._setupItemNavigation();}},e);return e;},reorgTabBarSequence:function(){if(!this.tabBar){return;}var e=new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.High});var n=new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.NeverOverflow});var B=this.tabBar.getContent();for(var i=0;i<B.length;i++){if(this.getModel().getProperty('/tabStrips/selected').equals(B[i].getBindingContext().getObject())){B[i].setLayoutData(n);}else{B[i].setLayoutData(e);}}},assembleDisplaySwitchTapStrips:function(){var t=this;var o=new sap.m.SegmentedButton('ResultViewType',{selectedKey:{parts:[{path:'/resultToDisplay'}],formatter:function(r){if(r==="searchResultTable"){return"table";}else if(r==="searchResultList"){return"list";}else if(r==="searchResultMap"){return"map";}}},items:[new sap.m.SegmentedButtonItem({icon:"sap-icon://list",tooltip:sap.ushell.resources.i18n.getText("displayList"),key:"list"}),new sap.m.SegmentedButtonItem({icon:"sap-icon://table-view",tooltip:sap.ushell.resources.i18n.getText("displayTable"),key:"table"}),new sap.m.SegmentedButtonItem({icon:"sap-icon://map",tooltip:sap.ushell.resources.i18n.getText("displayMap"),key:"map",visible:false})],enabled:{parts:[{path:'/displaySwitchVisibility'},{path:'/count'}],formatter:function(e,i){return e&&i!==0;}},select:function(e){var i=e.mParameters.key;var m=t.getModel();switch(i){case"list":m.setProperty('/resultToDisplay',"searchResultList");t.searchResultMap.setVisible(false);break;case"table":m.setProperty('/resultToDisplay',"searchResultTable");t.searchResultMap.setVisible(false);break;case"map":m.setProperty('/resultToDisplay',"searchResultMap");t.searchResultMap.setVisible(true);break;default:m.setProperty('/resultToDisplay',"searchResultList");}m.enableOrDisableMultiSelection();}.bind(this),visible:jQuery.extend({},this.searchToolbarEntryVisibility)});o.addEventDelegate({onBeforeRendering:function(e){if(t.getModel().config.maps){o.getItems()[2].setVisible(true);}}});return o;},assembleCenterArea:function(){var t=this;t.tableSortDialog=t.assembleSearchResultSortDialog();var e=t.assembleSearchResultList();t.searchResultTable=t.assembleSearchResultTable();t.searchResultTable.addDelegate({onBeforeRendering:function(){t.updateTableLayout();}});t.searchResultMap=t.assembleSearchResultMap();t.appSearchResult=t.assembleAppSearch();t.showMoreFooter=t.assembleShowMoreFooter();return[t.tableSortDialog,e,t.searchResultTable,t.searchResultMap,t.appSearchResult,t.showMoreFooter];},assembleSearchResultSortDialog:function(){var t=this;var e=new sap.m.ViewSettingsDialog({sortDescending:{parts:[{path:"/orderBy"}],formatter:function(o){return jQuery.isEmptyObject(o)||o.sortOrder==="DESC";}},confirm:function(i){var p=[];p=i.getParameters();if(p.sortItem){var o=t.getModel();if(p.sortItem.getKey()==="ushellSearchDefaultSortItem"){o.resetOrderBy();e.setSortDescending(true);}else{o.setOrderBy({orderBy:p.sortItem.getKey(),sortOrder:p.sortDescending===true?"DESC":"ASC"});}}},cancel:function(i){var l=t.getModel().getOrderBy().orderBy===undefined?"ushellSearchDefaultSortItem":t.getModel().getOrderBy().orderBy;this.setSelectedSortItem(l);}});e.bindAggregation("sortItems","/tableSortableColumns",function(p,D){return new sap.m.ViewSettingsItem({key:"{key}",text:"{name}",selected:"{selected}"});});return e;},assembleSearchResultTable:function(){var t=this;var r=new c("ushell-search-result-table",{mode:{parts:[{path:'/multiSelectionEnabled'}],formatter:function(m){return m===true?sap.m.ListMode.MultiSelect:sap.m.ListMode.None;}},noDataText:'{i18n>noCloumnsSelected}',visible:{parts:[{path:'/resultToDisplay'},{path:'/count'}],formatter:function(e,i){return e==="searchResultTable"&&i!==0;}},rememberSelections:false});r.bindAggregation("columns","/tableColumns",function(p,D){var e=D.getObject();var i=new sap.m.Column(e.key,{header:new sap.m.Label({text:"{name}",tooltip:"{name}"}),visible:{parts:[{path:'index'}],formatter:function(l){return l<5;}}});return i;});r.bindAggregation("items","/tableResults",function(p,D){return t.assembleTableItems(D);});r.addEventDelegate({onAfterRendering:function(){t.updatePersoServiceAndController();}});return r;},assembleTableItems:function(D){var t=this;var o=D.getObject();if(o.type==='footer'){return new sap.m.CustomListItem({visible:false});}else{return t.assembleTableMainItems(o,D.getPath());}},assembleTableMainItems:function(D,p){var t=this;t.oCrossAppNav=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation");var e=p+"/itemattributes";var l=new sap.m.ColumnListItem({selected:"{selected}"});l.bindAggregation("cells",e,function(e,m){if(m.getObject().isTitle){var n="";var o;var q=m.getObject().titleNavigation;if(q){n=q.getHref();o=q.getTarget();}var r=(n&&n.length>0)?true:false;var u=new h({text:"{value}",tooltip:{parts:[{path:'value'}],formatter:function(z){return $("<div>"+z+"</div>").text();}},enabled:r,href:n,press:function(){var n="";var q=m.getObject().titleNavigation;if(q){n=q.getHref();}var N=new j.NavigationEvent();N.addUserHistoryEntry(n);var z=sap.ushell.renderers.fiori2.search.getModelSingleton();z.analytics.logCustomEvent('FLP: Search','Launch Object',[n]);}});if(o){u.setTarget(o);}return u;}else if((m.getObject().isNavigationObjects)){var v=m.getObject().navigationObjects;var w=[];var x={};for(var i=0;i<v.length;i++){var y=v[i];x=new sap.m.Button({text:y.getText(),tooltip:y.getText(),press:function(){y.performNavigation();}});w.push(x);}return new sap.m.Button({icon:"sap-icon://action",press:function(){var z=new sap.m.ActionSheet({buttons:w});z.openBy(this);}});}else{return new f({text:"{value}",tooltip:{parts:[{path:'value'}],formatter:function(z){return $("<div>"+z+"</div>").text();}}});}});return l;},onRegionClick:function(e){},onRegionContextMenu:function(e){},assembleSearchResultMap:function(){var o;var e="yPAjYBbnvu87r-bURAc-";var i="m3WAJo5rFmc5BG1IxJ3d2w";var m={"MapProvider":[{"name":"HEREMAPS","type":"","description":"","tileX":"256","tileY":"256","maxLOD":"20","copyright":"Tiles Courtesy of HERE Maps","Source":[{"id":"s1","url":"http://1.maps.nlp.nokia.com/maptile/2.1/maptile/newest/normal.day/{LOD}/{X}/{Y}/256/png?app_code="+i+"&app_id="+e},{"id":"s2","url":"http://2.maps.nlp.nokia.com/maptile/2.1/maptile/newest/normal.day/{LOD}/{X}/{Y}/256/png?app_code="+i+"&app_id="+e}]}],"MapLayerStacks":[{"name":"DEFAULT","MapLayer":{"name":"layer1","refMapProvider":"HEREMAPS","opacity":"1.0","colBkgnd":"RGB(255,255,255)"}}]};o=new sap.ui.vbm.GeoMap({legendVisible:false,scaleVisible:false.$anchorScroll,refMapLayerStack:'DEFAULT',mapConfiguration:m,visible:false});o.setMapConfiguration(m);return o;},doDataCall:function(o){$.get('/es/map').then(function(r){var e=[];for(var i=0;i<r.length;++i){var l=r[i].City;var m=JSON.parse(r[i].LOC_4326_GEOJSON);var n=m.coordinates[0];var p=m.coordinates[1];var q=new sap.ui.vbm.Spot({position:n+';'+p+';0',text:l});e.push(q);}var t=new sap.ui.vbm.Spots({items:e});o.addVo(t);});},assembleShowMoreFooter:function(){var t=this;var e=new sap.m.Button({text:"{i18n>showMore}",type:sap.m.ButtonType.Transparent,press:function(){var o=t.getModel();o.setProperty('/focusIndex',o.getTop());var n=o.getTop()+o.pageSize;o.setTop(n);}});e.addStyleClass('sapUshellResultListMoreFooter');var i=new sap.m.FlexBox({visible:{parts:[{path:'/boCount'},{path:'/boResults'}],formatter:function(l,m){return m.length<l;}},justifyContent:sap.m.FlexJustifyContent.Center});i.addStyleClass('sapUshellResultListMoreFooterContainer');i.addItem(e);return i;},assembleSearchResultList:function(){var t=this;t.resultList=new b({mode:sap.m.ListMode.None,width:"auto",showNoData:false,visible:{parts:[{path:'/resultToDisplay'},{path:'/count'}],formatter:function(r,e){return r==="searchResultList"&&e!==0;}}});t.resultList.bindAggregation("items","/results",function(p,o){return t.assembleListItem(o);});return t.resultList;},assembleAppSearch:function(){var t=this;var e=new sap.ushell.renderers.fiori2.search.controls.SearchTilesContainer({maxRows:99999,totalLength:'{/appCount}',visible:{parts:[{path:'/resultToDisplay'},{path:'/count'}],formatter:function(r,i){return r==="appSearchResult"&&i!==0;}},highlightTerms:'{/uiFilter/searchTerms}',showMore:function(){var m=t.getModel();m.setProperty('/focusIndex',e.getNumberDisplayedTiles()-1);var n=m.getTop()+m.pageSize*e.getTilesPerRow();m.setTop(n);}});e.bindAggregation('tiles','/appResults',function(i,o){return t.getTileView(o.getObject().tile);});e.addStyleClass('sapUshellSearchTileResultList');sap.ui.getCore().getEventBus().subscribe('searchLayoutChanged',function(){e.delayedRerender();},this);return e;},assembleTitleItem:function(D){var i=new sap.m.CustomListItem();var t=new sap.m.Label({text:"{title}"});t.addStyleClass('bucketTitle');i.addStyleClass('bucketTitleContainer');i.addContent(new sap.m.HBox({items:[t]}));return i;},assembleAppContainerResultListItem:function(D,p){var t=this;var e=new sap.ushell.renderers.fiori2.search.controls.SearchTilesContainer({maxRows:sap.ui.Device.system.phone?2:1,totalLength:'{/appCount}',highlightTerms:'{/uiFilter/searchTerms}',enableKeyHandler:false,resultList:t.resultList,showMore:function(){var m=t.getModel();m.setDataSource(m.appDataSource);}});e.bindAggregation('tiles','tiles',function(i,o){return t.getTileView(o.getObject().tile);});var l=new sap.m.CustomListItem({content:e});l.addStyleClass('sapUshellSearchResultListItem');l.addStyleClass('sapUshellSearchResultListItemApps');l.addEventDelegate({onAfterRendering:function(E){var i=$(l.getDomRef());i.removeAttr("tabindex");i.removeAttr("role");i.attr("aria-hidden","true");}},l);sap.ui.getCore().getEventBus().subscribe('searchLayoutChanged',function(){e.delayedRerender();},this);return l;},assembleResultListItem:function(D,p){var e=this.getModel().config.getDataSourceConfig(D.dataSource);var i={title:"{$$Name$$}",titleUrl:"{uri}",titleNavigation:"{titleNavigation}",type:"{dataSource/label}",imageUrl:"{imageUrl}",attributes:"{itemattributes}",navigationObjects:"{navigationObjects}",selected:"{selected}",expanded:"{expanded}"};var l;if(e.searchResultListItemControl){l=new e.searchResultListItemControl(i);}else if(e.searchResultListItemContentControl){i.content=new e.searchResultListItemContentControl();l=new C(i);}else{l=new k(i);}var m=new sap.m.CustomListItem({content:l});m.addStyleClass('sapUshellSearchResultListItem');if(l.setParentListItem){l.setParentListItem(m);}return m;},assembleListItem:function(o){var t=this;var D=o.getObject();if(D.type==='title'){return t.assembleTitleItem(D);}else if(D.type==='footer'){return new sap.m.CustomListItem();}else if(D.type==='appcontainer'){return t.assembleAppContainerResultListItem(D,o.getPath());}else{return t.assembleResultListItem(D,o.getPath());}},getTileView:function(t){try{var i=t.getContract('types');i.setType('tile');}catch(e){}var v=sap.ushell.Container.getService('LaunchPage').getCatalogTileView(t);if(t.getTitle){v.usageAnalyticsTitle=t.getTitle();}else{v.usageAnalyticsTitle='app';}return v;},onAllSearchStarted:function(){},onAllSearchFinished:function(){var t=this;t.reorgTabBarSequence();t.oFocusHandler.setFocus();var v=sap.ui.getCore().byId('viewPortContainer');if(v&&v.switchState){v.switchState('Center');}},updatePersoServiceAndController:function(){var t=this;var m=t.getModel();var e=m.getDataSource().key;if(!t.oTablePersoController){var p=m.getPersonalizationStorageInstance();t.oTablePersoController=new sap.m.TablePersoController({table:sap.ui.getCore().byId("ushell-search-result-table"),persoService:p.getPersonalizer('search-result-table-state-'+e)}).activate();t.oTablePersoController.refresh();}if(t.oTablePersoController&&t.oTablePersoController.getPersoService().getKey()!=='search-result-table-state-'+e){t.oTablePersoController.setPersoService(m.getPersonalizationStorageInstance().getPersonalizer('search-result-table-state-'+e));t.oTablePersoController.refresh();}},updateTableLayout:function(){var t=this;if(t.searchResultTable){var e=t.searchResultTable.getColumns();var v=0;for(var i=0;i<e.length;i++){if(e[i].getVisible()){v++;}}if(v<=3){t.searchResultTable.setFixedLayout(false);}else{t.searchResultTable.setFixedLayout(true);}}},setAppView:function(A){var t=this;t.oAppView=A;if(t.oTilesContainer){t.oTilesContainer.setAppView(A);}},getControllerName:function(){return"sap.ushell.renderers.fiori2.search.container.Search";}});}(window));};
